(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1028:function(t,E,b){function a(B,Q,U){this.oRb=null;this.uF={};this.gSb=this.ex=null;k.ULS.sendTraceTag(537159566,0,50,"BorderFormatManager: Request new instance");this.$=B;this.q4d=a.G5c;this.r4d=a.borderStyleSolidLine;this.Hg=Q;this.Va=U;A.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")||this.$.da.Ga(296,this);this.JU=new c(this.$,this.Hg);this.KC=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",
!1);k.ULS.sendTraceTag(537159565,0,50,"BorderFormatManager: register BorderFormatManager with ServiceName 296")}function c(B,Q){var U=this;this.dHb=this.ribbonCommandInfo=this.cellFormat=this.Cr=this.qb=this.ha=null;this.dsc=!1;this.WIf=this.ILa=this.cFd=this.c8d=this.rza=this.Ama=null;this.k1b=this.Zta=this.cJf=0;this.borderStyle=this.d_a=this.borderColor=null;this.gB=!1;this.g1a=this.nab=null;this.s0=function(){if(!U.gB||K.g(U.$).kz)U.gB=!1,K.g(U.$).kz=!1,U.Zta=0,K.g(U.$).ig.wo(v.a.x4),1===U.$.Ka.bH()&&
(K.g(U.$).jV(A.EwaSettings.isChangeGateEnabled("OfficeVSO:6713439_FixCloneRangeArray")?O.d(U.cFd):y.a.clone(U.cFd),U.cJf,U.$.pa?U.$.pa.sheetName:null,null,U.WIf.clone(),null,null,0,I.a.sjh,!0),K.g(U.$).lSa(!0)),U.tv(),U.WXd(),U.Tj(),U.dsc=!1,U.Ama=null,U.rza=null,U.Cr&&(U.Cr.cancel(),U.Cr.dispose()),k.ULS.sendTraceTag(537159516,0,50,"DrawBorderBehavior.ResetBehavior : Ending ResetBehavior ")};this.onPointerDown=function(X){try{if(X=U.Sd(X),K.g(U.$).kz=!0,U.Ama={},U.rza={},U.nab=null,U.xpb(U.k1b),
2===X.nb){var P=K.g(U.$).ha.Ln(X.clientPoint,X.yb,5,void 0,void 0,!1);P&&(U.ILa=P,U.g1a=P,U.o9i())}}catch(ea){K.g(U.$).kz=!1}return!0};this.xh=function(X){try{X=U.Sd(X);var P=K.g(U.$).ha.Ln(X.clientPoint,X.yb,5,void 0,void 0,!1),ea=K.g(U.$).Ea.Lr(P);if(!U.dHb||ea&&(ea.ZJ!==U.dHb.ZJ||ea.YJ!==U.dHb.YJ))if(U.gB=!0,U.dHb=ea,P){var ia=new J.Range(U.ILa.top,U.ILa.left,U.ILa.top,U.ILa.left,!0,!1);ia.union(P);ia=K.g(U.$).ha.jWh(ia);U.o1b(P);U.dUf(U.nab,ia);if(U.bottomRightCorner(ia.bottom,ia.right))return k.ULS.sendTraceTag(537159515,
0,15,"DrawBorderBehavior.OnPointerMove - Bottom-right corner of sheet reached, cannot expand further."),!1;var da=new J.Range(ia.top,ia.left,ia.bottom+1,ia.right+1,!0,!1),xa=K.g(U.$).Y$("DrawBorderBehavior.OnPointerMove",[da]);if(U.Ama&&U.rza)for(;xa.$$mn();){var Z=xa.$$cu(),ha=Z.cell.getRange().toString();ha in U.Ama&&1!==U.Zta||(U.Ama[ha]=Z,U.rza[ha]=Z.cell.EM())}U.nab=da;U.g1a=ia;K.g(U.$).jV([ia],0,U.$.pa.sheetName,null,ia.topLeft,null,null,0,I.a.pjh,!0);U.Hg.Zda(K.g(U.$),-1690267012,U.cellFormat,
!0,null,[ia])}return!0}catch(ya){return K.g(U.$).kz=!1}};this.Ff=function(X){X=U.Sd(X);(X=K.g(U.$).ha.Ln(X.clientPoint,X.yb,5,void 0,void 0,!1))?U.gB&&(U.o1b(X),U.ILa.union(X),3===U.Zta?U.xpb(0):U.xpb(U.k1b),K.g(U.$).jV([U.ILa],0,U.$.pa.sheetName,null,null,null,null,0,I.a.qjh,!0),U.Hg.formatCells(-1690267012,U.cellFormat,U.ribbonCommandInfo)):(3===U.Zta?U.xpb(0):U.xpb(U.k1b),K.g(U.$).jV([U.g1a],0,U.$.pa.sheetName,null,null,null,null,0,I.a.rjh,!0),U.Hg.formatCells(-1690267012,U.cellFormat,U.ribbonCommandInfo));
U.gB=!1;U.WXd();U.Ama=null;U.rza=null;return!0};this.onKeyDown=function(X){X=U.Sd(X);if(U.gB||[17,16,18,20].includes(X.Ca.keyCode))return!0;U.s0();return!1};this.onKeyUp=function(X){X=U.Sd(X);if(X.Ca.keyCode===w.a.pL&&U.gB)return U.gB=!1,U.dUf(U.nab,U.g1a,!0),U.WXd(),!0;if(U.gB||X.Ca.keyCode===w.a.l8||X.Ca.keyCode===w.a.c1d||X.Ca.keyCode===w.a.b1d||[17,16,18,20,37,39,38,40,33,34,9,13].includes(X.Ca.keyCode)||X.Ca.keyCode===w.a.Qkg||X.Ca.keyCode===w.a.Mkg||X.Ca.keyCode===w.a.Ikg)return!0;U.s0();return!1};
this.lR=function(X,P){K.g(U.$).kz&&!U.f9h.includes(P.Ed.command)&&(k.ULS.sendTraceTag(537159512,0,50,"DrawBorderBehavior.OnCommandExecutionStarting : Command Triggered : "+P.Ed+" "),U.s0())};this.$=B;this.Hg=Q}function d(B){B.FOf()}function e(){this.iconName=this.title=this.key=null}function h(B,Q,U,X,P,ea,ia,da){this.rmg=B;this.smg=Q;this.qmg=U;this.Ega=X;this.Zxg=P;this.fug=ea;this.Ujb=ia;this.ctg=da}b.r(E);t=b(0);var k=b(15),n=b(1035),f=b(946),v=b(5),m=b(76),x=b(53),l=b(208),u=b(34),A=b(1),z=b(14);
h.gRg=function(){return new h("BorderStyleSolidLine",1945,1,"1","",1,8,0)};h.cRg=function(){return new h("BorderStyleDashedLine",1946,3,"1","5,3",1,8,0)};h.dRg=function(){return new h("BorderStyleDottedLine",1947,4,"1","1,1",1,8,0)};h.fRg=function(){return new h("BorderStyleMediumLine",1948,2,"2","",1,8,0)};h.hRg=function(){return new h("BorderStyleThickLine",1949,5,"3","",1,8,0)};h.eRg=function(){return new h("BorderStyleDoubleLine",1950,6,"1","",2,8,3)};of.Object.defineProperties(h.prototype,{lue:{configurable:!0,
enumerable:!0,get:function(){return this.rmg}},i1b:{configurable:!0,enumerable:!0,get:function(){return this.smg}},kue:{configurable:!0,enumerable:!0,get:function(){return this.qmg}},width:{configurable:!0,enumerable:!0,get:function(){return this.Ega}},yHj:{configurable:!0,enumerable:!0,get:function(){return this.Zxg}},gGi:{configurable:!0,enumerable:!0,get:function(){return this.fug}},lineHeight:{configurable:!0,enumerable:!0,get:function(){return this.Ujb}},yti:{configurable:!0,enumerable:!0,get:function(){return this.ctg}}});
Object(t.a)(h,"BorderLineStyleProperties",null,[]);Object(t.a)(e,"BorderLineStyleProps",null,[]);d.prototype.getBorderLineStyleProps=function(){var B=b(1028).BorderFormatManager.c_a,Q=Array(Object.keys(B).length),U=0,X;for(X in B){var P=X,ea=B[X];Q[U]=new e;Q[U].key=P;P=ea;Q[U].title=z.a.instance.ga(P.i1b);Q[U].iconName=P.lue;U++}return Q};Object(t.a)(d,"BorderMenuController",null,[803]);var y=b(278),w=b(86),D=b(249),H=b(13),F=b(109),J=b(24),S=b(47),N=b(45),T=b(220),G=b(11),I=b(95),K=b(21),L=b(33),
O=b(41);c.prototype.HAg=function(B){k.ULS.sendTraceTag(537159517,0,50,"DrawBorderBehavior.ActivateBehavior : Starting ActivateBehavior ");this.ha=K.g(this.$).ha;this.qb=K.g(this.$).qb;this.ribbonCommandInfo=B;this.cFd=A.EwaSettings.isChangeGateEnabled("OfficeVSO:6713439_FixCloneRangeArray")?O.d(this.ha.sa.selectedRanges):y.a.clone(this.ha.sa.selectedRanges);this.cJf=this.ha.sa.Qr;this.WIf=this.ha.sa.activeCell.clone();this.qb&&this.qb.Gjd();this.fv();this.Pi()};c.prototype.dispose=function(){this.s0();
this.dHb=this.ribbonCommandInfo=this.cellFormat=null};c.prototype.xpb=function(B){var Q=b(1028).BorderFormatManager;this.cellFormat={};var U={};this.borderColor=this.borderColor||Q.G5c;var X=l.a.XG(this.borderColor,!1);U.Color=[X,X,X,X];A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&this.d_a&&(U.ThemeBorderColor=[this.d_a,this.d_a,this.d_a,this.d_a],U.ColorTypeOption=1);X=b(1028).BorderFormatManager.c_a;this.borderStyle=this.borderStyle||Q.borderStyleSolidLine;Q=X[this.borderStyle].kue;
U.LineStyle=[Q,Q,Q,Q];this.cellFormat.BorderFormat=U;this.cellFormat.ValidMembers=128;this.cellFormat.Border=B};c.prototype.fv=function(){for(var B=ik(K.g(this.$).hn),Q=B.next();!Q.done;Q=B.next())D.a.instance.ra(H.a.pointerDown,Q.value.domElement,this.onPointerDown);F.KeyInputManager.instance.ra(H.a.Lb,document.documentElement,this.onKeyDown);F.KeyInputManager.instance.ra(H.a.Fd,document.documentElement,this.onKeyUp)};c.prototype.o9i=function(){for(var B=ik(K.g(this.$).hn),Q=B.next();!Q.done;Q=B.next())Q=
Q.value,D.a.instance.ra(H.a.sj,Q.domElement,this.xh),D.a.instance.ra(H.a.Hf,Q.domElement,this.Ff);D.a.instance.ra(H.a.Hf,document.documentElement,this.Ff);D.a.instance.ra(H.a.jy,document.documentElement,this.Ff);this.dsc=!0};c.prototype.tv=function(){try{for(var B=ik(K.g(this.$).hn),Q=B.next();!Q.done;Q=B.next())D.a.instance.Ba(H.a.pointerDown,Q.value.domElement,this.onPointerDown);F.KeyInputManager.instance.Ba(H.a.Lb,document.documentElement,this.onKeyDown);F.KeyInputManager.instance.Ba(H.a.Fd,document.documentElement,
this.onKeyUp)}catch(U){K.g(this.$).kz=!1,k.ULS.sendTraceTag(537159514,0,10,"DrawBorderBehavior.UnregisterHandlers: Unregistering of Handlers failed with Exception "+U)}};c.prototype.WXd=function(){if(this.dsc)try{this.dsc=!1;for(var B=ik(K.g(this.$).hn),Q=B.next();!Q.done;Q=B.next()){var U=Q.value;D.a.instance.Ba(H.a.sj,U.domElement,this.xh);D.a.instance.Ba(H.a.Hf,U.domElement,this.Ff)}D.a.instance.Ba(H.a.Hf,document.documentElement,this.Ff);D.a.instance.Ba(H.a.jy,document.documentElement,this.Ff)}catch(X){K.g(this.$).kz=
!1,k.ULS.sendTraceTag(537159513,0,10,"DrawBehavior.UnregisterDrawHandlersForMouse: Unregistering of Handlers failed with Exception "+X)}};c.prototype.Pi=function(){this.$.xa.Mf(this.s0);K.g(this.$).Wb.Ak(this.s0);K.g(this.$).UD(this.s0);this.$.Ka.RFa(this.lR)};c.prototype.Tj=function(){this.$.xa.ug(this.s0);K.g(this.$).Wb.vk(this.s0);K.g(this.$).yF(this.s0);this.$.Ka.Sza(this.lR)};c.prototype.dUf=function(B,Q,U){U=void 0===U?!1:U;if(B&&this.Ama&&this.rza)for(B=K.g(this.$).Y$("DrawBorderBehavior.ApplyBordersOnPreviewCells",
[B]);B.$$mn();){var X=B.$$cu().cell.getRange();if(U||!Q.contains(X)||1===this.Zta){X=X.toString();var P=u.a.yc(this.Ama,X);if(P){var ea=u.a.yc(this.rza,X);this.setBorders(P,ea);delete this.Ama[X];delete this.rza[X]}}}};c.prototype.setBorders=function(B,Q){var U=B.cell,X=U.getRange();U.mbb();X.right!==this.nab.right&&(U=new J.Range(X.top,X.left-1,X.bottom,X.left-1,!0,!1),K.g(this.$).Ea.Lr(U).kQa(3));X.bottom!==this.nab.bottom&&(U=new J.Range(X.top-1,X.left,X.top-1,X.right,!0,!1),K.g(this.$).Ea.Lr(U).kQa(1));
if(null===Q||void 0===Q?0:Q.Borders.length){var P={};U=0;for(var ea=Array(4),ia=Array(4),da=0;4>da;da++)ea[da]=1,ia[da]=0;Q=ik(Q.Borders);for(da=Q.next();!da.done;da=Q.next()){da=da.value;var xa=da.BorderPosition;ea[xa]=da.BorderLineStyle;var Z=new T.a(da.Color.Red,da.Color.Green,da.Color.Blue);ia[xa]=Z.oS();U|=G.HelperMethods.K3a(da.BorderPosition)}P.LineStyle=ea;P.Color=ia;P={BorderFormat:P};P.Border=U;this.Hg.xtj(B,P,X)}};c.prototype.o1b=function(B){var Q=this,U=new J.Range(Math.max(1,B.top-1),
Math.max(1,B.left-1),B.bottom+1,B.right+1,!1,!1);K.g(this.$).UQ(U)||this.Cr&&this.Cr.Mp||(this.Cr=S.a.instance.create(function(){K.g(Q.$).er(U,60,I.a.njh)},40,N.a.ojh))};c.prototype.bottomRightCorner=function(B,Q){return 1048576<=B||16384<=Q?!0:!1};c.prototype.Sd=function(B){return L.a(this.$).Sd(B)};of.Object.defineProperties(c.prototype,{f9h:{configurable:!0,enumerable:!0,get:function(){return this.c8d||(this.c8d=[1256700402,-1756763834,-1418159950,-236759591,-2118943501,1981159862,395594266,-1502853784,
-111689794,-1059615499,-1027730316,-1104934572,1872288872,2045211913,1504715724,46555851,-70383382,-28797232])}}});Object(t.a)(c,"DrawBorderBehavior",null,[6]);b.d(E,"BorderFormatManager",function(){return a});a.prototype.b5e=function(B,Q){k.ULS.sendTraceTag(537159564,0,50,"HandleBorderCommand : Begin handling, Command being executed: "+Q.command.toString());var U={},X={};var P=l.a.XG(this.s3,!1);X.Color=[P,P,P,P];this.KC&&this.pta&&(X.ThemeBorderColor=[this.pta,this.pta,this.pta,this.pta],X.ColorTypeOption=
1);B=-600086683===Q.command?"OutsideBorders":B[m.a.Mc];X.LineStyle=u.a.yc(a.fIf,B);X.LineStyle?k.ULS.sendTraceTag(537159562,0,50,"RibbonCommand.Border is using the BorderFormat information, the predefined borderStyle requested is "+B):(P=a.c_a[this.XHa].kue,X.LineStyle=[P,P,P,P],k.ULS.sendTraceTag(537159563,0,50,"RibbonCommand.Border is using the BorderFormat information, the custom borderStyle requested is "+this.XHa));P=u.a.Tp(a.eQg,B,0);k.ULS.sendTraceTag(40732555,0,50,"RibbonCommand.Border is using the BorderFormat information, the border type requested is "+
B+", the border color selected is "+this.s3);U.BorderFormat=X;4!==P&&8!==P||!this.$.pa.displayRtl||(P=4===P?8:4);U.ValidMembers=128;U.Border=P;this.Hg.formatCells(-1690267012,U,Q);k.ULS.sendTraceTag(537159561,0,50,"HandleBorderCommand : Successfully handled, Command executed: "+Q.command.toString());return!0};a.prototype.Thd=function(B,Q,U){k.ULS.sendTraceTag(537159560,0,50,"RibbonCommand:"+B.toString()+" is being executed, the previous border color is "+this.s3);if(this.KC){if((Q.SqmControlId||"").includes("ThemeColorPicker")){var X=
this.themesManager.getThemeColor(Q.Color);var P=X.themeIndex;var ea=X.qBa;X.returnValue?(this.gSb={},this.pta.ThemeColorIndex=P,this.pta.ThemeColorRow=ea):this.gSb=null}else this.gSb=null;this.JU.d_a=this.pta}this.q4d=-1803452024===B?a.G5c:Q.Color;this.JU.borderColor=this.s3;this.bLe(U);this.$.hf();k.ULS.sendTraceTag(40944211,0,50,"RibbonCommand:"+B.toString()+" is being executed, the updated border color is "+this.s3);return!0};a.prototype.C4h=function(B){k.ULS.sendTraceTag(537159559,0,50,"RibbonPopulateCommand.PopulateBorderStyle command Invoked");
var Q=this.Va.kq(),U=this.Va.Bc();Q.pc.push(U);var X=this.Va.nC("StyleDashGallery",1,"Size120by20");U.buttons.push(X);U=a.c_a;for(var P in U){var ea=P,ia=U[P],da=z.a.instance.ga(ia.i1b);X.Dt(ea,-2118943501,"QueryBorderStyle",ia.i1b,ea,ea,void 0,void 0,da)}k.ULS.sendTraceTag(537159557,0,50,"RibbonPopulateCommand, Invoke BuildMenuProps");B.MenuItems=Q.bE();k.ULS.sendTraceTag(537159556,0,50,"RibbonPopulateCommand handled")};a.prototype.$2h=function(B,Q){k.ULS.sendTraceTag(537159555,0,50,"RibbonCommand.BorderStyle: Begin handling, Current Border Style is "+
this.XHa);B=B[m.a.Mc];if(a.Api(B))this.r4d=B,k.ULS.sendTraceTag(537159554,0,50,"RibbonCommand.BorderStyle: Updated Border Style is "+this.XHa);else return k.ULS.sendTraceTag(537159553,0,15,"RibbonCommand.BorderStyle: Invalid Border Style encountered, Requested Border Style : "+B),!0;this.JU.borderStyle=this.XHa;this.bLe(Q);this.$.hf();k.ULS.sendTraceTag(40944220,0,50,"RibbonCommand.BorderStyle: Successfully handled Current Border Style is "+this.XHa);return!0};a.prototype.Xhd=function(B){k.ULS.sendTraceTag(537159552,
0,50,"HandleDrawBorderCommand : Begin handling, Command being executed: "+B.command.toString());this.BTc(B,64,this.s3,107,1);return!0};a.prototype.Yhd=function(B){k.ULS.sendTraceTag(537159523,0,50,"HandleDrawBorderGridCommand : Begin handling, Command being executed: "+B.command.toString());this.BTc(B,112,this.s3,108,2);return!0};a.prototype.p5e=function(B){k.ULS.sendTraceTag(537159522,0,50,"HandleEraseBorderCommand : Begin handling, Command being executed: "+B.command.toString());this.BTc(B,112,
"white",109,3);return!0};a.prototype.G4h=function(B){this.fsj(this.gQg,B,B.MenuItemId?B.MenuItemId:a.borderStyleSolidLine)};a.prototype.fsj=function(B,Q,U){U in B?(B=B[U],k.ULS.sendTraceTag(537159521,0,50,"HandleQueryBorderStyleCommand:SetIcon command "+U),this.hsj(Q,B)):k.ULS.sendTraceTag(537159520,0,15,"HandleQueryBorderStyleCommand: cannot find dashes '"+U+"' in BorderLineStyleButtons dictionary")};a.prototype.R4h=function(B,Q){var U=B[m.a.Mc];return"DrawBorder"===U?this.Xhd(Q):"DrawBorderGrid"===
U?this.Yhd(Q):"EraseBorder"===U?this.p5e(Q):this.b5e(B,Q)};a.prototype.FOf=function(){this.oRb||this.iRg()};a.prototype.oKh=function(){return new d(this)};a.prototype.iRg=function(){this.oRb={};var B=0,Q=a.c_a,U={},X;for(X in Q){U.Qea=Q[X];var P=U.Qea.lue;z.a.instance.ga(U.Qea.i1b);var ea=function(ia){return function(){return appChrome.buildBorderStyleIconNew(ia.Qea.yHj,ia.Qea.width,ia.Qea.gGi,ia.Qea.lineHeight,ia.Qea.yti)}}(U);this.oRb[P]=P;this.ebb(P,ea);B++;U={Qea:U.Qea}}};a.prototype.ebb=function(B,
Q){if(!(B in this.uF)){var U={};Q=Q();U[B]=Q;appChrome.api.registerIconProvider(function(){return U});this.uF[B]=!0}return B};a.prototype.hsj=function(B,Q){B.MenuItemId&&(B[n.a.On]=B.MenuItemId===this.XHa,B[f.a.Icon]=Q)};a.prototype.BTc=function(B,Q,U,X,P){k.ULS.sendTraceTag(537159519,0,50,"BorderFormatManager.ActivateDrawBorderBehavior : Starting ActivateDrawBorderBehavior ");this.aYg(B,P)?(k.ULS.sendTraceTag(537159518,0,50,"BorderFormatManager.CheckDrawBorderBehaviorTriggered : Toggled Ribbon menu button "),
this.JU.s0()):(K.g(this.$).kz&&this.JU.s0(),x.a.current&&(X=String.format(v.a.vta,x.a.current.So(X)),K.g(this.$).ig.wo(X)),this.JU.k1b=Q,this.JU.borderColor=U,K.g(this.$).kz=!0,this.JU.HAg(B),this.JU.Zta=P)};a.prototype.bLe=function(B){if(B)switch(this.JU.Zta){case 2:this.Yhd(B);break;default:this.Xhd(B)}};a.prototype.aYg=function(B,Q){return this.JU.Zta===Q&&-236759591!==B.command&&-2118943501!==B.command?!0:!1};a.Api=function(B){return B?B in a.fIf||B in a.c_a:!1};of.Object.defineProperties(a.prototype,
{XHa:{configurable:!0,enumerable:!0,get:function(){return this.r4d}},s3:{configurable:!0,enumerable:!0,get:function(){return this.q4d}},pta:{configurable:!0,enumerable:!0,get:function(){return this.gSb}},themesManager:{configurable:!0,enumerable:!0,get:function(){this.ex||(this.ex=this.$.da.za(422));return this.ex}},gQg:{configurable:!0,enumerable:!0,get:function(){this.FOf();return this.oRb}}});of.Object.defineProperties(a,{c_a:{configurable:!0,enumerable:!0,get:function(){var B={};return a.D2d||
(a.D2d=(B.BorderStyleSolidLine=h.gRg(),B.BorderStyleDashedLine=h.cRg(),B.BorderStyleDottedLine=h.dRg(),B.BorderStyleMediumLine=h.fRg(),B.BorderStyleThickLine=h.hRg(),B.BorderStyleDoubleLine=h.eRg(),B))}},eQg:{configurable:!0,enumerable:!0,get:function(){var B={};return a.C2d||(a.C2d=(B.NoBorder=0,B.BottomBorder=1,B.TopBorder=2,B.LeftBorder=4,B.RightBorder=8,B.OutsideBorders=64,B.AllBorders=112,B.ThickOutsideBorders=64,B.InsideBorders=48,B.InsideHorizontalBorders=16,B.InsideVerticalBorders=32,B.BottomDoubleBorder=
1,B.ThickBottomBorder=1,B.TopBottomBorder=3,B.TopThickBottomBorder=3,B.TopDoubleBottomBorder=3,B))}},fIf:{configurable:!0,enumerable:!0,get:function(){var B={};return a.Sde||(a.Sde=(B.ThickOutsideBorders=[2,2,2,2],B.BottomDoubleBorder=[1,6,1,1],B.ThickBottomBorder=[1,2,1,1],B.TopBottomBorder=a.Rdh,B.TopThickBottomBorder=[1,2,1,1],B.TopDoubleBottomBorder=[1,6,1,1],B))}}});a.C2d=null;a.D2d=null;a.Sde=null;a.G5c="black";a.borderStyleSolidLine="BorderStyleSolidLine";a.Rdh=[1,1,1,1];Object(t.a)(a,"BorderFormatManager",
null,[686])},1058:function(t,E,b){function a(y,w,D){window.performance.measure(y,w,D);w=window.performance.getEntriesByName(y);w.length||v.ULS.sendTraceTag(537167063,0,10,"ContextMenuHelper.MeasureTime: measure name ["+y+"] returned no measures.");return w[w.length-1]?w[w.length-1].duration:-1}function c(){if(m.a.spb){var y=a("OnContextMenuHandling","ContextMenuPerf.A","ContextMenuPerf.B"),w=a("PrepInfraWork","ContextMenuPerf.B","ContextMenuPerf.C1"),D=a("EWAPopulation","ContextMenuPerf.C2","ContextMenuPerf.D");
v.ULS.sendTraceTag(537167064,0,50,"ContextMenuHelper.ReportPerformanceIfSupported: OnContextMenuHandling=["+y+"], PrepInfraWork=["+w+"], EWAPopulation =["+D+"]")}}function d(y,w){A.HelperMethods.IYc&&window.performance.mark(w)}function e(y){y=z.g(y).ha.sa;return y.rg&&(y.Vc.isRow||y.Vc.We)}function h(y){return y.Ab.n5(y.ha.sa.activeCell)}function k(y,w,D,H,F){y=H.Xj("ContextMenuHelper.FindFirstCellInViewportArea",y,w,D);try{for(y.$$rst();y.$$mn();){var J=y.$$cu();if(J&&n(J,H,F))return J.cell}}finally{y&&
y.dispose()}return null}function n(y,w,D){var H=w.rtl,F=D.isChromeRtl;y=y.cell;return(D=z.g(D).OJ(y))?(D=D.topLeft,H=D.x+=H===F?y.offsetWidth:0,F=D.y+=y.offsetHeight,w.view.visibleArea.contains(new l.a(H,F,0,0))):!1}function f(y,w){var D=y.Ub(null);if((null===D||void 0===D?0:D.cell.tk)&&n(D,y,w))return y.getCellBounds(D.cell);D=y.ha.sa.activeCell;return(w=k(new u.Range(D.top,D.left,x.a.uh,D.left,!1,!1),2,!0,y,w)||k(new u.Range(1,D.left,D.top,D.left,!1,!1),2,!1,y,w)||k(new u.Range(D.top,D.right,D.top,
x.a.Eh,!1,!1),1,!0,y,w)||k(new u.Range(D.top,1,D.top,D.right,!1,!1),1,!1,y,w)||null)&&w.tk?y.getCellBounds(w):Sys.UI.DomElement.getBounds(y.Tva.hc)}b.d(E,"i",function(){return"ContextMenuPerf.A"});b.d(E,"b",function(){return"ContextMenuPerf.B"});b.d(E,"d",function(){return"ContextMenuPerf.C1"});b.d(E,"a",function(){return"ContextMenuPerf.C2"});b.d(E,"c",function(){return"ContextMenuPerf.D"});b.d(E,"e",function(){return f});b.d(E,"f",function(){return h});b.d(E,"g",function(){return e});b.d(E,"h",
function(){return d});b.d(E,"j",function(){return c});var v=b(15),m=b(337),x=b(9),l=b(60),u=b(24),A=b(11),z=b(21)},1059:function(t,E,b){function a(){}b.d(E,"a",function(){return a});t=b(0);a.edit="Edit";a.clipboard="Clipboard";a.copy="Copy";a.color="Color";a.iOg="AutoFill";a.Zjj="RowOperations";a.o0g="ColumnOperations";a.UXj="ViewModeRowOperations";a.TXj="ViewModeColumnOperations";a.hyperlink="Hyperlink";a.openHyperlink="OpenHyperlink";a.jwj="ShapeStyle";a.bDh="FloatingObjectClipboard";a.dHf="PivotTableCopyDelete";
a.fHf="PivotTableFieldListActions";a.rxe="CellFloatie";a.fwj="ShapeFloatie";a.contextMenu="ContextMenu";a.j2h="GridContextMenu";a.vZi="PivotTableContextMenu";a.cDh="FloatingObjectContextMenu";a.dXg="CellRTEFloatie";a.s1f="ShapeRTEFloatie";Object(t.a)(a,"FloatieGroupIdentifiers",null,[])},1060:function(t,E,b){function a(x,l,u){var A=m.call(this,l)||this;A.$Q=!1;A.ekc=!1;A.ANa=null;A._selectedRowListBox=null;A.Hn=null;A.$yf=function(z){return A.onItemClick(z)};A.OAd=function(z){f.g(z.Ca);A.raiseEvent(a.M4a);
A.raiseEvent(a.tOd);return!0};A.onScroll=function(z){f.g(z);A.lGd();A.raiseEvent(a.M4a)};A.onBlur=function(z){f.g(z);A.lGd()};A.onPointerDown=function(){A.lGd();A.raiseEvent(a.M4a);A.raiseEvent(a.xPa);return!1};A.cFb=function(z){var y=z.Ca;if(y.button===Sys.UI.MouseButton.leftButton||y.button===Sys.UI.MouseButton.rightButton||k.EwaSettings.isChangeGateEnabled("OfficeVSO:6154487_EnableTouchInputInDVDropDown")&&y.type.includes("touch"))A.Pk=A.Lac(y),A.onPointerDown(z);A.raiseEvent(a.Prd);return!1};
A.ib=x;A.gCb=u;A.bBa(!0);return A}b.d(E,"a",function(){return a});t=b(0);var c=b(87),d=b(236),e=b(13),h=b(249);E=b(248);var k=b(1),n=b(12),f=b(69),v=b(21),m=E.a;$k(a,m);a.prototype.S9=function(x){this.get_events().addHandler(a.M4a,x)};a.prototype.sda=function(x){this.get_events().removeHandler(a.M4a,x)};a.prototype.RZb=function(x){this.get_events().addHandler(a.ykd,x)};a.prototype.Wsc=function(x){this.get_events().removeHandler(a.ykd,x)};a.prototype.Nnb=function(x){this.get_events().addHandler(a.tOd,
x)};a.prototype.XIb=function(x){this.get_events().removeHandler(a.tOd,x)};a.prototype.Lnb=function(x){this.get_events().addHandler(a.xPa,x)};a.prototype.UIb=function(x){this.get_events().removeHandler(a.xPa,x)};a.prototype.jVc=function(x){this.get_events().addHandler(a.Prd,x)};a.prototype.tJd=function(x){this.get_events().removeHandler(a.Prd,x)};a.prototype.dispose=function(){this.R7(!1);this.bBa(!1);c.a.oc([this.ANa]);this.ANa=null;m.prototype.dispose.call(this)};a.prototype.Lac=function(x){return n.DOMElementExtensions.hed(x.target,
"tr",!0)};a.prototype.mB=function(x){if(x){if(!this.Pk){var l=this.Hn;if(!l||!l.rows.length)return;this.Pk=l.rows[0];0<x?x--:x++}l=this.Pk;for(var u=0,A=Math.abs(x);u<A;u++)if(0>x){if(!l.previousSibling)break;l=l.previousSibling}else{if(!l.nextSibling)break;l=l.nextSibling}l&&(this.Pk=l)}};a.prototype.rnb=function(x,l){n.DOMElementExtensions.toggleCssClass(x,this.gCb.ListTableClassInTouch,l)};a.prototype.R7=function(x){var l=this.Hn;l&&(x&&!this.ekc?(d.a.instance.ra(e.a.click,l,this.$yf),d.a.instance.ra(e.a.$j,
l,this.OAd),h.a.instance.ra(e.a.pointerDown,l,this.cFb),this.ekc=!0):this.ekc&&(d.a.instance.Ba(e.a.click,l,this.$yf),d.a.instance.Ba(e.a.$j,l,this.OAd),h.a.instance.Ba(e.a.pointerDown,l,this.cFb),this.ekc=!1))};a.prototype.wBa=function(x){var l=null;x&&(l=n.DOMElementExtensions.Bj(x,this.gCb.ListCellClass))&&l.classList.toggle(this.gCb.ListCellSelectedClass);return l};a.prototype.bBa=function(x){this.Rf&&(x&&!this.$Q?(this.ANa=this.je.Td(this.Rf),this.ANa.ka("scroll",this.onScroll),this.ANa.ka("blur",
this.onBlur),h.a.instance.ra(e.a.pointerDown,this.domElement,this.onPointerDown),this.$Q=!0):this.$Q&&(c.a.Ia(this.ANa),this.ANa=null,h.a.instance.Ba(e.a.pointerDown,this.domElement,this.onPointerDown),this.$Q=!1))};a.prototype.onItemClick=function(x){return this.OAd(x)};a.prototype.cvc=function(x){if(x){var l=x.offsetTop,u=this.Rf.scrollTop;l<u?this.$Wf(!0):l+x.offsetHeight>u+this.Rf.clientHeight&&this.$Wf(!1)}};a.prototype.$Wf=function(x){this.Rf.scrollTop=x?this.Pk.offsetTop:this.Pk.offsetTop+
this.Pk.offsetHeight-this.Rf.clientHeight};a.prototype.lGd=function(){v.g(this.$).isEditing&&this.raiseEvent(a.ykd)};of.Object.defineProperties(a.prototype,{Pk:{configurable:!0,enumerable:!0,get:function(){return this._selectedRowListBox},set:function(x){this.wBa(this._selectedRowListBox);x?(this._selectedRowListBox=x,this.wBa(this._selectedRowListBox),this.cvc(x)):this._selectedRowListBox=null}},x_:{configurable:!0,enumerable:!0,get:function(){return this.gCb.ListCellClass}},ica:{configurable:!0,
enumerable:!0,get:function(){return this.gCb.ListTableClass}},JH:{configurable:!0,enumerable:!0,get:function(){return 8}},$Cb:{configurable:!0,enumerable:!0,get:function(){return 5}},dkc:{configurable:!0,enumerable:!0,get:function(){return 24}},ckc:{configurable:!0,enumerable:!0,get:function(){return 35}},Rf:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},$:{configurable:!0,enumerable:!0,get:function(){return this.ib}}});a.M4a="GotFocus";a.ykd="IgnoreBlur";a.tOd="SetCell";a.xPa=
"PointerDown";a.Prd="ItemPointerDown";Object(t.a)(a,"ListBox",E.a,[648,6])},1126:function(t,E,b){function a(){}b.d(E,"a",function(){return a});t=b(0);var c=b(22);a.prototype.compare=function(d,e){return c.a.compare(d,e,!0)};Object(t.a)(a,"IgnoreCaseComparer",null,[572])},1127:function(t,E,b){function a(h,k){this.Ea=h;this.M2a=k}b.d(E,"a",function(){return a});t=b(0);var c=b(24),d=b(11),e=b(211);a.prototype.ZKb=function(h,k,n){var f=k.Border;k=k.BorderFormat;var v=0,m=!1;if(0===f)h.cell.mbb(),this.pIb(h.cell.getRange());
else{for(var x=0;3>=x;x++)a.txj(h,n,x,f)&&(v|=d.HelperMethods.K3a(x),this.qYd(h.cell.getRange(),x,k),m=!0);d.HelperMethods.RQ(f,16)&&!e.c(h,0,n)&&(v|=2,this.qYd(h.cell.getRange(),0,k),m=!0);d.HelperMethods.RQ(f,32)&&!e.c(h,2,n)&&(v|=4,this.qYd(h.cell.getRange(),2,k),m=!0);m&&(n=h.cell.Tt.jf,d.HelperMethods.RQ(v,2)&&this.K2f(h,n,0)&&(v&=-3),d.HelperMethods.RQ(v,1)&&this.J2f(h,n,1)&&(v&=-2),d.HelperMethods.RQ(v,4)&&this.K2f(h,n,2)&&(v&=-5),d.HelperMethods.RQ(v,8)&&this.J2f(h,n,3)&&(v&=-9),h.cell.setBorders(k,
v,!1))}};a.prototype.uQ=function(h,k){h=a.AWe(h,k);return h.isValidRange?(h=this.Ea.Tua(h))&&h.length?h:null:null};a.prototype.pIb=function(h){for(var k=0;3>=k;k++){var n=a.AWe(h,k);if(n.isValidRange&&(n=this.Ea.Tua(n))&&n.length)for(var f=a.H0e(k),v=0;v<n.length;v++)n[v].kQa(f)}};a.prototype.qYd=function(h,k,n){if(h=this.uQ(h,k))for(var f=a.H0e(k),v=d.HelperMethods.K3a(f),m=0;m<h.length;m++){var x=h[m];this.lgi(x,f)&&a.setBorders(x,n,v,k,f)}};a.prototype.lgi=function(h,k){var n=h.Tt.jf,f=h.getRange();
f=this.uQ(f,k);var v=!1,m=!1,x=!1,l=!1;f&&(v=a.G6a(f,!0),m=a.G6a(f,!1),l=a.$od(f),x=1===f.length?!0:!1);switch(k){case 0:return a.Cfi(h,n,l,m,x);case 1:return a.zfi(h,n,l,v,x);case 2:return a.Afi(h,n,l,v,x);case 3:return a.Bfi(h,n,l,m,x)}return!1};a.prototype.K2f=function(h,k,n){if(!h.cell.XM)return!1;var f=h.range,v=this.uQ(f,n),m=e.c(h,n,k),x=!1;k=0===n?f.top<k.top:f.left<k.left;!a.Xzb(h.cell)&&v&&1!==v.length&&(x=(0===n?a.G6a(v,!0):a.G6a(v,!1))?!1:!0);return!m&&x||k?!0:!1};a.prototype.J2f=function(h,
k,n){var f=h.cell,v=this.uQ(f.getRange(),n);h=e.c(h,n,k);k=!1;if(v){var m=a.G6a(v,!0),x=a.G6a(v,!1),l=m&&!x;x=x&&!m;1!==n||a.VAb(f)?3!==n||a.Mzb(f)||a.Axj(f,v,x,l)&&(k=!0):a.zxj(f,v,m,x)&&(k=!0)}return!h&&k||a.Xzb(f)?!0:!1};a.bRg=function(h,k,n){var f={};f.LineStyle=Array(4);f.LineStyle[n]=h.LineStyle[k];f.Color=Array(4);f.Color[n]=h.Color[k];return f};a.Obf=function(h,k,n,f,v){return d.HelperMethods.RQ(h,v)&&e.c(k,n,f)};a.txj=function(h,k,n,f){return a.Obf(f,h,n,k,d.HelperMethods.K3a(n))||a.Obf(f,
h,n,k,64)||112===f};a.setBorders=function(h,k,n,f,v){k=a.bRg(k,f,v);h.setBorders(k,n,!1)};a.AWe=function(h,k){switch(k){case 0:return new c.Range(h.top-1,h.left,h.top-1,h.right,!1,!1);case 2:return new c.Range(h.top,h.left-1,h.bottom,h.left-1,!1,!1);case 1:return new c.Range(h.bottom+1,h.left,h.bottom+1,h.right,!1,!1);case 3:return new c.Range(h.top,h.right+1,h.bottom,h.right+1,!1,!1)}return h};a.H0e=function(h){switch(h){case 0:return 1;case 2:return 3;case 1:return 0;default:return 2}};a.G6a=function(h,
k){for(var n=0;n<h.length;n++){var f=h[n];if(f.XM)return k?a.Mzb(f):a.VAb(f)}return!1};a.Xzb=function(h){var k=h.Tt.jf,n=h.getRange();return h.XM&&(n.top<k.top||n.bottom>k.bottom||n.left<k.left||n.right>k.right)?!0:!1};a.$od=function(h){for(var k=0;k<h.length;k++)if(a.Xzb(h[k]))return!0;return!1};a.zxj=function(h,k,n,f){if(!h.XM){if(!n||a.$od(k))return!0}else if(a.Mzb(h)&&(1===k.length&&a.nMg(h,k[0])||!n))return!0;return f};a.Axj=function(h,k,n,f){if(!h.XM){if(!n||a.$od(k))return!0}else if(a.VAb(h)&&
(1===k.length&&a.oMg(h,k[0])||!n))return!0;return h.Ska||f};a.Cfi=function(h,k,n,f,v){var m=h.getRange();return a.Mzb(h)?a.Xzb(h)||v:k.top===m.top||!f||n};a.zfi=function(h,k,n,f,v){var m=h.getRange();return a.Mzb(h)?k.bottom===m.bottom&&v:f&&!n||k.bottom===m.bottom};a.Afi=function(h,k,n,f,v){var m=h.getRange();return a.VAb(h)?a.Xzb(h)||v:k.left===m.left||!f||n};a.Bfi=function(h,k,n,f,v){var m=h.getRange();return h.Ska?!1:a.VAb(h)?k.right===m.right&&v:f&&!n||k.right===m.right};a.Mzb=function(h){return 0<
h.getRange().right-h.getRange().left};a.VAb=function(h){return 0<h.getRange().bottom-h.getRange().top};a.oMg=function(h,k){h=h.getRange();k=k.getRange();return h.top===k.top&&h.bottom===k.bottom};a.nMg=function(h,k){h=h.getRange();k=k.getRange();return h.left===k.left&&h.right===k.right};Object(t.a)(a,"BorderModelAccessorHelper",null,[])},1129:function(t,E,b){function a(n,f){var v=k.call(this,f.textBox.domElement)||this;v.FXc=null;v.HHi=function(){v.nzd()};v.Swf=function(m,x){v.Ef(m,x)};v.Wwf=function(m,
x){v.Fh(m,x)};v.ib=n;v.DI=f;f.vY&&(f.vY.add(v),f.Ak(v.Wwf),f.um(v.Swf));return v}b.d(E,"a",function(){return a});t=b(0);var c=b(87);E=b(94);var d=b(47),e=b(45),h=b(69),k=E.a;$k(a,k);a.prototype.dispose=function(){var n=this.DI;if(null===n||void 0===n?0:n.vY)n.vY.remove(this),n.vk(this.Wwf),n.Nl(this.Swf);c.a.Ia(this.FXc);this.DI=null;k.prototype.dispose.call(this)};a.prototype.Jh=function(n,f){switch(f){case -1470715894:case -1231471547:this.hU(!1);break;default:if(this.PFd(n,f))return h.g(n),!0;
a.hli(f)||this.hU(!1)}return!1};a.prototype.hU=function(){c.a.Ia(this.FXc);this.FXc=d.a.instance.create(this.HHi,10,e.a.Gti)};a.prototype.Fh=function(){this.hU(!1)};a.hli=function(n){switch(n){case 137938150:case -798660877:case 742457698:case 2091832999:return!0}return!1};of.Object.defineProperties(a.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.ib}},Ya:{configurable:!0,enumerable:!0,get:function(){return this.DI}}});Object(t.a)(a,"ListAutoCompleteBehavior",E.a,[651,6])},
1293:function(t,E,b){function a(){c.a.ti('.ewa-ac{position:absolute;z-index:102;margin-top:1px;width:auto}.ewa-ac .ewa-ac-param{white-space:nowrap;margin-bottom:3px;direction:ltr}.ewa-ac .ewa-ac-param function_param_table{position:absolute}.ewa-ac .ewa-ac-param .ewa-function-help-link{text-decoration:underline}.ewa-lb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#262626;font-size:12px;font-family:"Segoe UI";z-index:102;height:auto;margin:0 8px;touch-action:manipulation;vertical-align:middle}.ewa-lb.ewa-fb-refactor{position:relative;margin:0}.ewa-lb table{left:0;right:0;border-collapse:collapse}.ewa-lb table td{white-space:nowrap}.ewa-lb table td div.clip16x16{margin:0 0 0 2px}.ewa-lb table td.list-item{height:24px;padding:0 8px}.ewa-lb table td.list-item-selected{background-color:#d3f0e0}@media screen and (-ms-high-contrast:active){.ewa-lb table td.list-item-selected{border:2px solid #fff}}.ewa-lb table.list-table-touch td.list-item{height:35px}div#suggested_cells_list_box{margin:0}div#suggested_cells_list_box .list-table .ewa-suggested-cell-name{float:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}@font-face{font-family:"Segoe UI Semibold";font-weight:600;src:local("Segoe UI Semibold"),local("Segoe UI")}.ewa-lb table td.columnName-header{color:#666;font-size:12px;font-family:"Segoe UI Semibold";text-align:left;padding:3px 8px;text-overflow:ellipsis}.ewa-tt{background-color:#f7f7f7;border:1px solid #a2a6ab;color:#444;height:auto;vertical-align:middle;width:auto;z-index:102;font-size:8pt;margin:0;padding-bottom:3px;padding-top:2px}.ewa-root-ltr .ewa-tt{text-align:left;padding-left:5px;padding-right:7px}.ewa-root-rtl .ewa-tt{text-align:right;padding-left:7px;padding-right:5px}.ewa-dlg-function-link-container .ewa-fdb-help-link,.ewa-tt-rtl .ewa-fdb-help-link,.ewa-tt-ltr .ewa-fdb-help-link{color:#00f;text-decoration:underline}.ewa-function-link-container .ewa-function-udf-name,.ewa-function-link-container-udf .ewa-function-help-link{display:none}.ewa-root.rtl .ewa-function-link-container{text-align:left}')}
b.d(E,"a",function(){return a});var c=b(567)},1294:function(t,E,b){function a(c,d){this.command=0;this.selectedRanges=null;this.command=c;this.selectedRanges=d}b.d(E,"a",function(){return a});t=b(0);a.prototype.Us=function(){return this.command};Object(t.a)(a,"MacroRecorderRangeOperationAppliedPayload",null,[430])},1295:function(t,E,b){function a(){c.a.ti(".TabsContainer{width:100%}.TabTitlesContainer{width:100%;display:table;table-layout:fixed;padding:0}.TabTitlesContainer>.TabTitle{display:table-cell;text-align:center}.TabTitlesContainer>.TabTitle:hover:not(.TabTitleActive){font-weight:bold}.TabTitleText{text-decoration:none}div#dataFieldCustomLabel,div#dataFieldSourceLabel{font-weight:600;padding-left:10px}div#summarizeValuesByControlBody{background-color:#fff;padding:10px}.valueFielsSettingsControlTitle{font-weight:bold;border-bottom:1px solid #a2a6ab}div#summarizeValuesByControlBody>.summarizeValuesByControlDescription{font-weight:600}div#summarizeValuesByControlBody>select{width:100%}div#showValueAsControlBody{background-color:#fff;padding:10px}select#showValueAsSelect{width:100%;margin-bottom:5px}select#showValueAsBaseFieldSelect{width:100%}select#showValueAsBaseItemSelect{width:100%;overflow:hidden}div#showValueAsControlBody>.showValueAsControlSelectRegion{width:48%;display:inline-block;position:relative}div#showValueAsControlBody>.showValueAsControlSelectRegionSeparator{width:4%;display:inline-block}.showValueAsControlSelectRegion>div{width:100%}input#valueFieldsSettingsFieldName{width:273px}div#valueFieldSettingTabs{width:380px}")}
b.d(E,"a",function(){return a});var c=b(567)},1296:function(t,E,b){b.d(E,"a",function(){return"FieldInfoListContextLoaded"});b.d(E,"k",function(){return"GetFieldInfoListContextOperationFailed"});b.d(E,"f",function(){return"Days from Today"});b.d(E,"i",function(){return"Total Weekdays from Today"});b.d(E,"j",function(){return"Years from Today"});b.d(E,"e",function(){return"Day of the Week"});b.d(E,"h",function(){return"Month of the Year"});b.d(E,"g",function(){return"End of Month"});b.d(E,"c",function(){return"Next Month"});
b.d(E,"d",function(){return"Next Week"});b.d(E,"b",function(){return"Next Day"})},1297:function(t,E,b){function a(){c.a.ti(".ewa-dv{position:relative;z-index:100;width:auto}.ewa-dv-buttonarea{position:absolute;border:0;padding:1;z-index:100;margin:0;overflow:hidden;width:auto;height:auto}.ewa-dv-listbutton{margin:0;cursor:pointer}.ewa-dv-listbutton span.clip17x17{display:inline-block;margin:0}.ewa-dlb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:100;height:auto;margin:0}.ewa-dlb table{left:0;right:0;border-collapse:collapse;empty-cells:show}.ewa-dlb table td{white-space:nowrap;padding:0 2px 0 2px}.ewa-dlb table.list-table td.list-item{height:24px}.ewa-dlb table.list-table td.list-item-selected{height:24px;background-color:#d3f0e0;color:#444}.ewa-dlb table.list-table-touch td.list-item{height:35px}.ewa-dlb table.list-table-touch td.list-item-selected{height:35px;background-color:#d3f0e0;color:#444}@media screen and (-ms-high-contrast:active){.ewa-dlb table.list-table td.list-item-selected{background-color:highlight;-ms-high-contrast-adjust:none;color:highlighttext}}.ewa-dpb{position:absolute;border:1px solid #a2a6ab;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:99;margin:0;max-width:230px}.ewa-dpb p{padding:0 2px 0 2px;margin:0;border-collapse:collapse;width:230px}.ewa-dv-ltr .ewa-dpb p{text-align:left}.ewa-dv-rtl .ewa-dpb p{text-align:right}.ewa-dpb p.dv-prompt-title{font-weight:bold}.ewa-dpb p.dv-prompt-message{word-wrap:break-word;overflow:hidden}")}
b.d(E,"a",function(){return a});var c=b(567)},1298:function(t,E,b){function a(){c.a.ti(".DataValidationDialogPanel{min-width:0}.DataValidationDialogPanel .TabTitlesContainer{width:300px}.DataValidationDialogPanel div#WACDialogBodyPanel{height:312px}.TabTitlesContainer{border-bottom:solid 1px #c3cbd0}.TabTitle{text-align:center;cursor:default}.TabTitleText{display:inline-block}.TabTitleActive{color:#217346;font-weight:bold}.TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}.DataValidationEditTabContent{padding-top:7px}.DataValidationButtonPanel{float:none}.AppRtl .DataValidationButtonPanel{float:none}.DataValidationButtonClearAll{float:left;margin-left:0;margin-right:10px}.AppRtl .DataValidationButtonClearAll{float:right;margin-left:10px;margin-right:0}.DataValidationRow{margin-bottom:10px;display:table}.DataValidationNonBorderRow{margin-bottom:8px;display:table}.DataValidationEditElementLabel{width:95px;display:inline-block;margin-top:4px;margin-bottom:4px;vertical-align:top}.DataValidationEditElement{display:inline-block;margin-top:0;margin-bottom:0;padding:1px;font-size:9pt;font:inherit;border:solid 1px #c3cbd0}.DataValidationEditNoBorderElement{display:inline-block;margin-top:0;margin-bottom:0;font-size:9pt;font:inherit;width:210px;height:22px}.DataValidationEditSelect{width:calc(210px + 4px);height:calc(22px + 4px);padding:0;color:#000}.DataValidationEditSelect:disabled{color:graytext}.DataValidationEditSelectFocus:focus{outline:-webkit-focus-ring-color auto 5px !important}.DataValidationEditInput{width:210px;height:22px}.DataValidationEditTextArea{width:210px;height:50px;resize:none;overflow-y:auto;overflow-x:hidden}.DataValidationEditErrorMessage{margin-bottom:-15px;margin-top:-6px;font-size:9pt;color:#d90000;width:300px;height:65px}.DataValidationEditCheckBoxWithText{margin-top:0;margin-bottom:0;display:inline-block}.DataValidationEditCheckBoxNoText{margin-top:6px;margin-bottom:0;display:inline-block}.DataValidationEditRadio{margin-top:0;margin-bottom:0}.DataValidationEditLabel{margin-top:5px;margin-bottom:0;display:inline-block}div#listDescriptionSubDivID{height:37px;width:210px}label#listDescriptionLabelId{font-size:8pt;margin-top:0}div#ignoreBlankCheckboxDivID{margin-bottom:8px}")}
b.d(E,"a",function(){return a});var c=b(567)},1300:function(t,E,b){function a(){c.a.ti(".ewa-facp-text-box{position:absolute}")}b.d(E,"a",function(){return a});var c=b(567)},1301:function(t,E,b){b.d(E,"b",function(){return"MinorThemeFont"});b.d(E,"a",function(){return"MajorThemeFont"})},1303:function(t,E,b){function a(){c.a.ti('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}')}
b.d(E,"a",function(){return a});var c=b(567)},1304:function(t,E,b){function a(m){var x=v.call(this,document.createElement("div"))||this;x.zIa=!1;x.AIa=!1;x.yIa=!1;x.wIa=!1;x.xIa=!1;x.$Q=!1;x.DI=null;x.visible=void 0;x.Bnc=function(l,u){x.$s(l,u)};x.zLa=function(){x.Ya.textBox.XJ=!0};x.Nya=function(){x.Ly(!0)};x.zuf=function(){x.Ya.textBox.focus()};x.vh=function(){k.g(x.$).inRangePicker||(x.isListVisible=!1)};x.$=m;k.g(m)&&k.g(m).ha&&k.g(x.$).ha.hJ(x.vh);x.Ck=d.a.V4();x.s6a=e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixKeydownLayoutTrashingBottleneck",
!1);return x}b.d(E,"a",function(){return a});t=b(0);E=b(248);var c=b(5),d=b(36),e=b(1),h=b(11),k=b(21),n=b(33),f=b(4),v=E.a;$k(a,v);a.prototype.get_visible=function(){return this.s6a?void 0!==this.visible?this.visible:this.visible=v.prototype.get_visible.call(this):v.prototype.get_visible.call(this)};a.prototype.set_visible=function(m){if(!this.s6a)return v.prototype.set_visible.call(this,m);if(this.visible===m)return m;this.visible=m;return v.prototype.set_visible.call(this,m)};a.prototype.$s=function(){this.NBa(!1);
this.It.$s()};a.prototype.dispose=function(){this.$&&k.g(this.$)&&k.g(this.$).ha&&k.g(this.$).ha.IK(this.vh);this.$=null;v.prototype.dispose.call(this)};a.prototype.Jh=function(m,x,l){m=!1;if((this.Y0a||(void 0===l?0:l))&&!this.Rwa()&&this.get_visible()&&this.isListVisible)switch(this.Ck&&this.DBc(x),x){case 1872288872:this.isListVisible=!1;m=!0;break;case -798660877:this.It.mB(1);m=!0;break;case 137938150:this.It.mB(-1);m=!0;break;case 2091832999:this.It.mB(this.JH-1);m=!0;break;case 742457698:this.It.mB(-(this.JH-
1));m=!0;break;case 125627505:m=this.Ly(!1);break;case 267796030:d.a.V4()&&(m=this.Ly(!1))}return m};a.prototype.NBa=function(m){if(this.isListVisible||m){var x=k.g(this.$);m=x.domElement;var l=this.DI.textBox.domElement,u=n.a(this.$).hi(l.offsetHeight),A=n.a(this.$).hi(l.offsetTop),z=n.a(this.$).hi(l.offsetWidth);l=n.a(this.$).hi(l.offsetLeft);x=x.pj;var y=f.AFrameworkApplication.ta&&f.AFrameworkApplication.ta.Qa.Qf,w=$get(this.$.zb+c.a.$_a,this.$.domElement);y&&(w=document.getElementById("EditorContainer"));
var D=new Sys.UI.Point(x?this.It.Q$b:0,x?this.LEh:a.G2h);u=w.offsetTop+D.y+(d.a.YM(this.$)&&x?0:u+A);this.$.Fba||(A=$get(c.a.sGa,this.$.domElement),u+=A&&!y?A.offsetHeight:0);A=this.domElement;A.style.top=h.HelperMethods.nc(u);l=w.offsetLeft+l+D.x;!d.a.YM(this.$)&&this.$.isChromeRtl?A.style.right=h.HelperMethods.nc(x?this.It.Q$b:m.offsetLeft+m.offsetWidth-l-z):A.style.left=h.HelperMethods.nc(l)}};a.prototype.OSa=function(m){this.It&&(m&&!this.$Q?(this.It.S9(this.zuf),this.It.RZb(this.zLa),this.It.Nnb(this.Nya),
this.$Q=!0):this.$Q&&(this.It.sda(this.zuf),this.It.Wsc(this.zLa),this.It.XIb(this.Nya),this.$Q=!1))};a.prototype.DBc=function(m){switch(m){case -798660877:case 137938150:case 2091832999:case 742457698:this.zIa=!0;break;case 125627505:this.yIa=!0;break;case 267796030:d.a.V4()&&(this.wIa=!0)}};of.Object.defineProperties(a.prototype,{JH:{configurable:!0,enumerable:!0,get:function(){return this.It.JH}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return this.It.isListVisible},set:function(m){this.It.isListVisible=
m}},Ya:{configurable:!0,enumerable:!0,get:function(){return this.DI},set:function(m){(this.DI=m)&&this.DI.v_d.add(this)}},LEh:{configurable:!0,enumerable:!0,get:function(){return d.a.YM(this.$)?-5:-40}}});a.Q$b=0;a.G2h=1;Object(t.a)(a,"AutoCompleteControl",E.a,[614])},1305:function(t,E,b){function a(d,e,h,k){e=void 0===e?0:e;h=void 0===h?"":h;k=void 0===k?"":k;var n=c.call(this)||this;n.length=d;n.selectedIndex=e;n.JF=h;n.description=k;return n}b.d(E,"a",function(){return a});t=b(0);var c=Sys.EventArgs;
$k(a,c);Object(t.a)(a,"ListEventArgs",Sys.EventArgs,[])},1306:function(t,E,b){function a(A,z){A=u.call(this,A,z,new l.a(e.a.listItem,e.a.hCb,e.a.kCb,e.a.lCb))||this;A.jdc=!1;A.nq=null;A.Llb=null;A.fVe=!1;A.visible=void 0;A.bBa(!0);A.fVe=v.EwaSettings.isChangeGateEnabled("OfficeVSO:5893822_FixFormulaBarXOffsetCrash");A.s6a=v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixKeydownLayoutTrashingBottleneck",!1);return A}b.d(E,"a",function(){return a});t=b(0);var c=b(15),d=b(27);E=b(1060);
var e=b(996),h=b(5),k=b(76),n=b(36),f=b(12),v=b(1),m=b(117),x=b(21),l=b(1128),u=E.a;$k(a,u);a.prototype.gya=function(){var A=460,z=x.g(this.$),y=z.domElement,w=this.mTa.style,D=this.Rf.offsetTop+this.Pk.offsetHeight*this.Pk.sectionRowIndex-this.Rf.scrollTop;w.width="auto";w.whiteSpace="nowrap";w.position="absolute";var H=y.offsetLeft+y.offsetWidth-(this.domElement.offsetLeft+this.Rf.offsetLeft+this.Rf.offsetWidth+3);y=this.domElement.offsetLeft-3-(y.offsetLeft+this.Q$b);A=Math.min(this.mTa.offsetWidth,
A,Math.max(H,y));f.DOMElementExtensions.uv(this.mTa,A);w.whiteSpace="";w.position="absolute";D+3>this.Rf.offsetTop+this.Rf.offsetHeight||D<this.Rf.offsetTop||(A=this.Rf.offsetLeft-3-this.mTa.offsetWidth,w=this.Rf.offsetLeft+this.Rf.offsetWidth+3,f.DOMElementExtensions.updatePosition(this.mTa,y>H!==z.rtl?A:w,D,!1))};a.prototype.mB=function(A){u.prototype.mB.call(this,A);this.gya()};a.prototype.$s=function(){this.gya()};a.prototype.Tra=function(){var A=this.Hn,z=this.Rf,y=3===k.a.Cb||d.a.Wo,w=y?this.$Cb:
this.JH;this.isListVisible=!0;z.style.height="auto";this.AGa.set_visible(!0);this.rnb(A,y);this.nq.length>w?(f.DOMElementExtensions.vI(z,Math.floor(z.offsetHeight*w/this.nq.length)),z.style.overflowY="auto"):v.EwaSettings.eAb()||(z.style.height="auto",z.style.overflowY="hidden");f.DOMElementExtensions.uv(z,A.offsetWidth+(this.nq.length>w?m.a.hv:0))};of.Object.defineProperties(a.prototype,{Q$b:{configurable:!0,enumerable:!0,get:function(){if(n.a.YM(this.$)){var A=document.getElementById(this.$.zb+
h.a.eVe);return!this.fVe||A?f.DOMElementExtensions.getBoundingClientRect(A).x:0}A=v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddNamedRange",!1)?document.getElementById(h.a.ixd):document.getElementById(this.$.zb+h.a.ixd+"-"+h.a.wrf);c.ULS.shipAssertTag(537170323,0,!!A||this.$.$M,"AutoCompleteListBox.FormulaBarXOffset : Can't find the name box combobox element.");return A?A.offsetWidth:0}},fe:{configurable:!0,enumerable:!0,get:function(){return this.Llb},set:function(A){this.Llb=A}},
isListVisible:{configurable:!0,enumerable:!0,get:function(){return this.s6a?void 0!==this.visible?this.visible&&0<this.nq.length:(this.visible=f.DOMElementExtensions.isVisible(this.Rf))&&0<this.nq.length:f.DOMElementExtensions.isVisible(this.Rf)&&0<this.nq.length},set:function(A){this.s6a&&this.visible===A||(f.DOMElementExtensions.setVisible(this.Rf,A),f.DOMElementExtensions.setVisible(this.mTa,A),this.s6a&&(this.visible=A));var z=x.g(this.$).view;A?this.jdc||(z.Is(this.AGa.Bnc),this.jdc=!0):(this.nq.length=
0,this.jdc&&(z.Gq(this.AGa.Bnc),this.jdc=!1))}}});Object(t.a)(a,"AutoCompleteListBox",E.a,[])},1307:function(t,E,b){function a(l,u,A,z,y,w,D,H,F,J){var S=x.call(this,document.createElement("a"))||this;S.Lm=!1;S.Zc=function(N){S.raiseEvent("ClickButton",N);return!0};S.onKeyDown=function(N){S.raiseEvent("KeyDown",N);return!1};S.sw=function(){S.hovered=!0;S.raiseEvent("PointerOver");return!1};S.BN=function(){S.hovered=!1;S.raiseEvent("PointerOut");return!1};S.onBlur=function(N){m.g(N);S.focused=!1;S.raiseEvent("Blur")};
S.onFocus=function(N){m.g(N);S.focused=!0;S.raiseEvent("Focus")};S.Llh=H;S.Vgh=F;S.MI=a.lb(S.domElement,u,A,z,y,w,D,J);S.zc.ka("contextmenu",function(N){m.g(N)});S.enable();S.hovered=!1;S.focused=!1;l.appendChild(S.domElement);return S}b.d(E,"a",function(){return a});t=b(0);var c=b(236),d=b(13),e=b(109),h=b(249);E=b(248);var k=b(627),n=b(5),f=b(53),v=b(12),m=b(69),x=E.a;$k(a,x);a.prototype.$Uc=function(l){this.get_events().addHandler("ClickButton",l)};a.prototype.gJd=function(l){this.get_events().removeHandler("ClickButton",
l)};a.prototype.lVc=function(l){this.get_events().addHandler("KeyDown",l)};a.prototype.uJd=function(l){this.get_events().removeHandler("KeyDown",l)};a.prototype.e_b=function(l){this.get_events().addHandler("PointerOver",l)};a.prototype.FJd=function(l){this.get_events().removeHandler("PointerOver",l)};a.prototype.d_b=function(l){this.get_events().addHandler("PointerOut",l)};a.prototype.EJd=function(l){this.get_events().removeHandler("PointerOut",l)};a.prototype.ynb=function(l){this.get_events().addHandler("Blur",
l)};a.prototype.GIb=function(l){this.get_events().removeHandler("Blur",l)};a.prototype.S9=function(l){this.get_events().addHandler("Focus",l)};a.prototype.sda=function(l){this.get_events().removeHandler("Focus",l)};a.prototype.enable=function(){this.domElement&&(this.domElement.classList.remove(k.a.qU),this.domElement.style.cursor="",c.a.instance.ra(d.a.click,this.domElement,this.Zc),e.KeyInputManager.instance.ra(d.a.Lb,this.domElement,this.onKeyDown),h.a.instance.ra(d.a.pointerOver,this.domElement,
this.sw),h.a.instance.ra(d.a.pointerOut,this.domElement,this.BN),this.zc.Zm("blur")||this.zc.ka("blur",this.onBlur),this.zc.Zm("focus")||this.zc.ka("focus",this.onFocus),this.domElement.title=this.Llh,this.Lm=!0)};a.prototype.disable=function(){this.domElement&&(this.domElement.classList.add(k.a.qU),this.domElement.style.cursor="",this.isEnabled&&(c.a.instance.Ba(d.a.click,this.domElement,this.Zc),e.KeyInputManager.instance.Ba(d.a.Lb,this.domElement,this.onKeyDown),h.a.instance.Ba(d.a.pointerOver,
this.domElement,this.sw),h.a.instance.Ba(d.a.pointerOut,this.domElement,this.BN)),this.domElement.title=this.Vgh,this.Lm=!1)};a.prototype.dispose=function(){this.isEnabled&&(c.a.instance.Ba(d.a.click,this.domElement,this.Zc),e.KeyInputManager.instance.Ba(d.a.Lb,this.domElement,this.onKeyDown),h.a.instance.Ba(d.a.pointerOver,this.domElement,this.sw),h.a.instance.Ba(d.a.pointerOut,this.domElement,this.BN),this.Lm=!1);v.DOMElementExtensions.setVisible(this.domElement,!1);x.prototype.dispose.call(this)};
a.lb=function(l,u,A,z,y,w,D,H){l.removeAttribute("Href");l.setAttribute(n.a.Gd,n.a.Js);l.className=u;l.tabIndex=H;u=document.createElement("span");u.className=D;u.classList.add(A);u.tabIndex=-1;l.appendChild(u);l=document.createElement("img");l.src=f.a.df(z);l.className=y;l.alt=w;l.tabIndex=-1;u.appendChild(l);return l};of.Object.defineProperties(a.prototype,{pl:{configurable:!0,enumerable:!0,get:function(){return this.MI}},isEnabled:{configurable:!0,enumerable:!0,get:function(){return this.Lm}}});
Object(t.a)(a,"ListButton",E.a,[637,6])},1347:function(t,E,b){function a(){l.initData();rc.a.Fa(function(Ta){m.ka(Ta);c.ka(Ta);l.ka(Ta);d.ka(Ta)})}function c(Ta){var Cb=Ib.call(this)||this;Cb.$=Ta;Cb.Eb();return Cb}function d(Ta,Cb,jc){var tc=this;this.qyc={};this.Ad=!1;this.Il=function(kd,Rd){tc.showContextMenu(void 0===Rd?null:Rd)};this.dwf=function(kd,Rd){Rd.mBi===d.k2h&&Oa.g(tc.$).focus()};this.lR=function(kd,Rd){kd=tc.$.Ka.Saa(Rd.Ed.command);(null===kd||void 0===kd?0:kd.dismissesContextualUI)&&
tc.E3()};this.m6=function(){tc.$.da.BU(342);ca.TaskExtensions.Aa(Ba.GetServiceTaskFactory.create(tc.$.da,338,tc.$.la,3),function(kd){kd=kd.result;for(var Rd=ik(tc.qyc),pe=Rd.next();!pe.done;pe=Rd.next())pe.value.oOf(kd)},tc.$.la)};this.$=Ta;this.contextMenuController=jc;this.y6d=new e(this.$);Ta.da.Ga(8,this);for(jc=0;jc<Cb.length;jc++)this.qyc[d.F3g[jc]]=Cb[jc];this.ha=Oa.g(Ta).ha;this.ha.IZb(this.Il);this.$.Ka.OYa(this.dwf);pf.a.instance.xuj();Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&
this.$.Ka.RFa(this.lR);Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.B2(this.m6)}function e(Ta){this.VSe=null;this.$=Ta;this.S8a=new n;Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||(this.VSe=new h(this.$))}function h(Ta){var Cb=this;this.PZa=null;this.rRd=!1;this.YBb=0;this.X8c=1;this.EMe=0;this.ZEb=function(jc){Cb.NKf(jc.domElement,jc.hashCode)};
this.EOf=function(jc){for(var tc=0;window.performance.now()-jc<Cb.Dnh&&0<Cb.PZa.length;)Cb.eme(Cb.PZa.shift()),tc++;V.ULS.sendTraceTag(537167052,1,50,"FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Batch number: "+Cb.X8c+", Events Registered in this frame: "+tc+", Events in queue: "+Cb.PZa.length);0<Cb.PZa.length?Cb.YBb=window.requestAnimationFrame(Cb.EOf):(V.ULS.sendTraceTag(537167051,1,50,"FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Finished batch number: "+Cb.X8c+", Total time in MS: "+
(window.performance.now()-Cb.EMe)),Cb.X8c++,Cb.YBb=0)};this.onPointerDown=function(jc){Zb.a.slim(jc.Ca.rawEvent);return!1};this.$=Ta;this.gridView=Oa.g(this.$);this.v$h();this.Dnh=this.$.ya.AutoFilterEventRegistrationTimeLimit}function k(){this.Ld=this.hte=this.cell=null}function n(){this.Tdc={}}function f(){this.menuModel=null;this.uFe=0}function v(){this.dictionary=this.Ed=null}function m(Ta){var Cb=Cf.call(this)||this;Cb.u$e=!1;Cb.pld=function(){var jc;(jc=Cb.$.da.za(342))?Cb.pb(jc):Cb.$.bB(function(tc){tc.Wec().then(function(kd){(jc=
Cb.$.da.za(342))?Cb.pb(jc):(jc=new x(Cb.$,kd),Cb.pb(Cb.$.da.Ga(342,jc)))})})};Cb.$=Ta;Cb.Eb();return Cb}function x(Ta,Cb){this.nrb=Cb;this.$=Ta}function l(Ta){return dd.call(this,Ta)||this}function u(Ta,Cb,jc,tc){Ta=Tc.call(this,Ta,"PopulateTimeSlicerLevelMenu",-227942804,1634477200,u.UKj,!0,!1,u.NJb,Cb,jc,!1,tc)||this;Ta.b1a=0;Ta.Fsa=null;Ta.rKa=null;Ta.lKe=null;return Ta}function A(Ta,Cb,jc){this.type=Ta;this.A3g=Cb;this.mr=jc}function z(Ta,Cb,jc,tc){return Fc.call(this,Ta,"PopulateSlicerContextMenu",
-1920954846,723126814,"SlicerContextMenu",!0,!1,"SlicerContextMenuRootName",Cb,jc,!0,tc)||this}function y(Ta,Cb,jc,tc){Ta=db.call(this,Ta,"PopulateSheetOpsContextMenu",274207288,-1497523576,ke,!0,!1,"SheetTabContextMenuRootName",Cb,jc,!1,tc)||this;Ta.Vgc=!1;Ta.xic=!1;return Ta}function w(Ta,Cb,jc,tc){Cb=Nd.call(this,Ta,"PopulateRichTextContextMenu",679816325,1151222423,ge,!0,!1,ge,Cb,jc,!0,tc)||this;Cb.grid=Oa.g(Ta);return Cb}function D(Ta,Cb,jc,tc){Cb=Ed.call(this,Ta,"PopulateTableFieldListContextMenu",
-751848458,-1085236154,cd,!0,!1,"TableFieldListContextMenuRoot",Cb,jc,!1,tc)||this;Cb.G5b=null;Cb.Fyd=0;Cb.JEa=null;Cb.grid=Oa.g(Ta);return Cb}function H(){}function F(Ta,Cb,jc,tc){var kd=Ge.call(this,Ta,"PopulatePivotTableContextMenu",-1475408662,1114549926,ee,!0,!1,"PivotTableContextMenuRootName",Cb,jc,!0,tc)||this;kd.rc=null;kd.activeCell=null;kd.M_d=null;kd.Hic=!1;kd.cod=!1;kd.expandCollapse=!1;kd.refresh=!1;kd.lZ=!1;kd.De=null;kd.Tz=null;kd.E0a=null;kd.rb=null;kd.kab=null;kd.Lba=!1;kd.dNi=function(Rd){Rd&&
!Wa.a.Dg(Rd.Errors)&&kd.rc&&(kd.rc.Go=Rd.Result,kd.cLb());kd.showPivotTableContextMenu()};kd.cNi=function(){};kd.NQi=function(){kd.Tbb()};kd.MQi=function(){kd.Tbb()};kd.GHi=function(){kd.Tbb()};kd.FHi=function(){kd.Tbb()};kd.cy=function(){kd.gYd();kd.Lba=!1};kd.Bq=function(){if(kd.Lba){V.ULS.sendTraceTag(537167E3,0,50,"PivotTableContextMenu.OnAfterAllBlocksUpdated: Context menu was closed after changes were made by other users");var Rd=kd.rc;kd.grid.Ab.Ro(kd.grid.ha.sa.activeCell)!==Rd&&(kd.Tbb(),
kd.C7h())}};kd.Uih=new DOMParser;kd.Dxj=!0;kd.grid=Oa.g(Ta);kd.plc=!0;return kd}function J(Ta,Cb,jc,tc){return X.call(this,Ta,"PopulatePivotContextMenu",2123758504,912277356,Cb,jc,tc)||this}function S(Ta,Cb,jc,tc){Ta=Nb.call(this,Ta,"PopulateFieldWellContextMenu",1374696078,495005930,sd,!0,!1,sd,Cb,jc,!1,tc)||this;Ta.cell=null;Ta.co=null;Ta.so=null;Ta.externalSourceIndex=-1;Ta.h0d=-1;Ta.zSa=0;Ta.Cyc=-1;Ta.qL=null;Ta.isOlap=!1;Ta.zV=!1;Ta.P2a=!1;return Ta}function N(Ta,Cb,jc,tc,kd,Rd,pe,le,Wd){var ve=
Uc.call(this,kd,lb.a.instance.mb(61),!0,2,!0)||this;ve.o3f=!0;ve.kje=null;ve.oSa=null;ve.Rfa=null;ve.psb=null;ve.j5c=null;ve.PRc=null;ve.AHi=function(Se){Kd.a.any(Se.Errors,function(Ve){return-103190598===Ve.MessageId})&&ve.SSa.Fij()};ve.NNi=function(Se){Se&&!Hb.a(Se)&&(Se=Se.Result,ve.j5c.innerHTML=lb.a.instance.ga(1090)+re.a.yg(Se.ValueFieldSourceName),ve.isOlap&&!ve.zV?(ve.SSa.enabled=!1,ve.Rfa.activeTab=ve.Rfa.Bzc-1):(ve.SSa.enabled=!0,ve.Rfa.activeTab=0),ve.SSa.ptj(Se.PivotValueFieldSettingsSummarizeValueByInfo),
ve.oSa.qtj(Se.PivotValueFieldShowValueAsInitialInfo),ve.qf())};ve.cell=Ta;ve.so=Cb;ve.externalSourceIndex=jc;ve.Xfg=tc;ve.Ed=Rd;ve.aia=pe;ve.isOlap=le;ve.zV=Wd;return ve}function T(Ta){Ta=Tb.call(this,Ta)||this;Ta.Gde=null;Ta.get_visible=Ta.Rja;Ta.set_visible=Ta.Hna;Ta.kka();return Ta}function G(){}function I(Ta,Cb,jc,tc,kd,Rd,pe,le){var Wd=Kb.call(this,Ta)||this;Wd.iF=null;Wd.f6b=null;Wd.U0b=null;Wd.p2d=null;Wd.q2d=null;Wd.G4d=null;Wd.kwf=function(){var ve=parseInt(Wd.z3.fe.value,10);Wd.OVg(ve)?
(Wd.WT.Rp.disabled=!0,Wd.vP.Rp.disabled=!0,Wd.vP.clear(),I.Lbf(ve)?(Wd.WT.Rp.disabled=!1,Wd.EOb(!0)):I.Mbf(ve)?(Wd.WT.Rp.disabled=!1,Wd.vP.Rp.disabled=!1,Wd.EOb(!0),Wd.glf()):Wd.EOb(!1)):(ve=Wa.a.Xc(1,0,0,1120,0,7896227,"FormatRequiresBaseFieldsOrBaseItems"),lc.a(Wd.$).pr([ve]),Wd.z3.Jij())};Wd.LHi=function(){0>Wd.WT.selectedIndex||Wd.vP.Rp.disabled||(Wd.EOb(!0),Wd.glf())};Wd.ONi=function(ve){Wd.iF.eeb();Wd.vP.Rp.style.overflowY="scroll";if(ve&&!Hb.a(ve)){ve=ve.Result;Wd.vP.clear();for(var Se=ik(ve.BaseItems),
Ve=Se.next();!Ve.done;Ve=Se.next())Ve=Ve.value,Wd.vP.WL(Ve.DisplayString,Ve.Id.toString(),Ve.Id===ve.SelectedBaseItem);Wd.EOb(!1)}};Wd.get_visible=Wd.Rja;Wd.set_visible=Wd.Hna;Wd.$=Cb;Wd.cell=jc;Wd.so=tc;Wd.externalSourceIndex=kd;Wd.Ed=Rd;Wd.aia=pe;Wd.gli=le;Wd.ZTj=Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:4859461_DisableOKButtonWhenLoadingIndictorIsOn");Wd.kka();return Wd}function K(){}function L(Ta,Cb,jc,tc,kd){this.externalSourceIndex=0;this.pivotFieldTitle=this.activeCell=null;this.summarizeBy=
0;this.showAsValueParameters=null;this.externalSourceIndex=Ta;this.activeCell=Cb;this.pivotFieldTitle=jc;this.summarizeBy=tc;this.showAsValueParameters=kd}function O(Ta,Cb,jc){this.baseItemIndex=this.baseFieldIndex=this.dataFormat=0;this.dataFormat=Ta;this.baseFieldIndex=Cb;this.baseItemIndex=jc}function B(){}function Q(){}function U(Ta,Cb,jc,tc){return X.call(this,Ta,"PopulateFieldListPivotMenu",-1793121409,1378457149,Cb,jc,tc,ld)||this}function X(Ta,Cb,jc,tc,kd,Rd,pe,le){le=void 0===le?qd:le;var Wd=
Jd.call(this,Ta,Cb,jc,tc,le,!0,!1,"PivotFilterMenuRootName",kd,Rd,!1,pe)||this;Wd.B5b=null;Wd.Bjf=null;Wd.Dmb=null;Wd.pivotData=null;Wd.Pyd=null;Wd.Emc=null;Wd.iEb=0;Wd.A2b=0;Wd.sY=0;Wd.asb=null;Wd.RMi=function(ve,Se){if(Se)if(Hb.a(ve))Wd.Svd(Se,!1);else if(ve=ve.Result){Wd.Lsb=ea.kfd(Se,Wd.$,Wd.pivotData.cell,Wd.sY);var Ve=Wd.hqf(ve.MenuModel.Sections);Wd.asb=Ve;X.jN.set(Wd.pivotData.cell,Se,Ve,Wd.sY);Sd.a(Wd.$).nHj(ve);Wd.Svd(Se,!0)}};Wd.QMi=function(ve,Se){Wd.Svd(Se,!1)};Wd.ff=function(ve,Se){X.jN.O7b(Se.ed.hash)};
Wd.Dm=function(ve,Se){X.jN.O7b(Se.ed.hash)};Wd.Fza=null;Wd.Qyd=Wd.iEb=-1;Wd.Mxe=Wd.A2b=-1;Wd.Rpe=Wd.sY=0;Wd.Sx=Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");X.jN||(X.jN=new ea(Wd.$),Oa.g(Wd.$).Ea.Hs(Wd.ff),Oa.g(Wd.$).Ea.vG(Wd.Dm),Oa.g(Wd.$).Ea.Sga(Wd.ff));return Wd}function P(){this.cell=null;this.dataSourceIndex=0;this.so=this.pivotName=null}function ea(Ta){this.$=Ta;this.jN={}}function ia(Ta,Cb,jc,tc){Ta=Ie.call(this,Ta,"PopulateFieldListContextMenu",-1045020714,-170383950,
Le,!0,!1,Le,Cb,jc,!1,tc)||this;Ta.co=null;Ta.qL=null;Ta.b_=!1;Ta.zV=!1;Ta.isOlap=!1;Ta.KUd=!1;return Ta}function da(Ta,Cb,jc,tc){Ta=xa.call(this,Ta,Cb,jc,tc,"PopulateChartContextMenu",-498523270,1640762262,we)||this;Ta.OAa=!1;Ta.Zva=!1;Ta.lZ=!1;Ta.refresh=!1;Ta.isPivotChart=!1;return Ta}function xa(Ta,Cb,jc,tc,kd,Rd,pe,le,Wd,ve){le=void 0===le?Ab.a.y3g:le;Ta=Sc.call(this,Ta,void 0===kd?"PopulateFloatingObjectContextMenu":kd,void 0===Rd?-2017893763:Rd,void 0===pe?1350204367:pe,le,void 0===Wd?!0:Wd,
void 0===ve?!1:ve,le,Cb,jc,!0,tc)||this;Ta.floatingObject=null;Ta.nb=0;Ta.plc=!0;return Ta}function Z(Ta,Cb,jc,tc){Ta=Jc.call(this,Ta,"PopulateAutoFilterFieldListContextMenu",474690375,216058793,Z.Yzh,!0,!1,Z.NJb,Cb,jc,!1,tc)||this;Ta.dm=null;return Ta}function ha(){}function ya(Ta,Cb){Ta=va.call(this,Ta,2,0,null)||this;Ta.gte=Cb;return Ta}function va(Ta,Cb,jc,tc){this.Jtg=Ta;this.Xng=Cb;this.aog=jc;this.hyg=tc}function bb(){}function ba(Ta,Cb,jc,tc){var kd=xb.call(this,Ta,"PopulateAutoFilterContextMenu",
1675506831,1651433993,Mc,!0,!1,"AutoFilterContextMenuRoot",Cb,jc,!1,tc)||this;kd.asb=null;kd.sheetName=null;kd.pTa=null;kd.HWc=null;kd.Alf=!1;kd.Q2a=!1;kd.UGb=null;kd.OMb=null;kd.g$c=null;kd.dcc=null;kd.qPa=null;kd.LFe=null;kd.P$a=null;kd.I4c=null;kd.VV=function(){kd.Ayc();kd.$.ea.pn(kd.VV)};kd.xMi=function(Rd){function pe(Rb,Lc,od){kd.I4c=$a.o(kd.$.oa.va,ve,wa.b(Rb,Se),kd.Q2a?wa.a(Lc,Ve):Lc,od,null,Va);return kd.I4c}kd.Q2a||Ub.b(kd.$).yd(yb.a.Wxf,kd.em(),void 0,!0);var le={};kd.$.Oj(le);var Wd=kd.$.ea.isNamedObjectViewMode,
ve=Ka.a.Wh(kd.HWc);ve.SheetName=Wd?le.NamedObjectName:le.SheetName;ve.NamedObjectView=Wd;le=!!Rd.searchText;Wd=586;kd.Q2a&&(le&&(ve.ItemListOptions=kd.g6g(Rd.searchText),Wd=597),Rd={},Ub.b(kd.$).yd(yb.a.Wxf,(Rd.UserOperation=Wd.toString(),Rd),void 0,!0));var Se=kd.uAd(le),Ve=kd.yMi(),Va=kd.$.oa.va.Pb();kd.LFe=Va.RequestId;kd.Q2a&&kd.dcc&&!kd.dcc.dequeueUtcTime&&(kd.$.userOperationManager.Hta(kd.dcc),kd.$Vg());Rd=Yb.EwaSettings.Zb()?new dc.a(Wd,0,pe,80):new Jb.a(Wd,0,pe,16);kd.dcc=kd.$.userOperationManager.Sb(Rd,
null);kd.P$a=kd.I4c;kd.qPa=kd.LFe};kd.onMenuItemClick=function(Rd,pe,le){Ub.b(kd.$).yd(yb.a.rRi,kd.em(),void 0,!0);var Wd={};pe=(Wd.CommandValueId=pe,Wd.MenuItemId=pe,Wd.InputMethod=le,Wd.TopCellAddress=kd.pTa,Wd);Wd=new nb.a(Rd,le,kd.$.isEditMode?2:1,19,null);kd.$.Ka.Kb(Wd,pe);V.ULS.sendTraceTag(537167131,0,50,"AutoFilterContextMenu::OnMenuItemClick "+Rd+", "+le)};kd.wHi=function(Rd){if(Rd.checkedItems&&Rd.checkedItems.length){Ub.b(kd.$).yd(yb.a.ouf,kd.em(),void 0,!0);var pe=Ka.a.Wh(kd.HWc),le={};
kd.$.Oj(le);le.FirstRow=0;le.FirstColumn=pe.Column;var Wd=kd.$.ea.isNamedObjectViewMode;pe.NamedObjectView=Wd;pe.SheetName=Wd?le.NamedObjectName:le.SheetName;var ve=function(Va){if(hb.a.yxc(Va)){var Rb=hb.a.wac(Va);kd.BMa?hb.a.wQa(Xb.a.applyItemFilter,Rb.MessageIdName,uc.a.ksa,!0,hb.a.isSessionEndingError(Rb.MessageId)):V.ULS.sendTraceTag(537167129,0,10,"AutoFilterContextMenu::OnApplyFilterByValue failed with AutoFilterException -"+Rb.MessageIdName)}Hb.a(Va)||(V.ULS.sendTraceTag(537167128,0,50,"AutoFilterContextMenu::OnApplyFilterByValue service call succeeded"),
Ub.b(kd.$).yd(yb.a.Qxf,kd.em(),void 0,!0),Va=Object(Aa.a)(new oa,{isSuccess:!0}),kd.OMb.onApplyFilterByValueFinish(Va),kd.nL(kd.pTa))},Se=kd.n3c(pe,le),Ve=new dc.a(208,0,function(Va,Rb,Lc){return $a.a(kd.$.oa.va,Se,Rd.checkedItems,wa.b(Va,ve),Rb,Lc,null,null)},6,function(){return new eb.a(Rd.checkedItems,Se)});kd.j4f(function(){kd.$.userOperationManager.Sb(Ve,null)})}else V.ULS.sendTraceTag(537167130,0,15,"AutoFilterContextMenu::OnApplyFilterByValue Received Zero checked items to apply filter on")};
kd.YLg=function(Rd){var pe=oc.o(kd.pTa,kd.$),le=oc.v(kd.pTa,kd.$),Wd=Object(Aa.a)(new cb.a,{SortConditionType:Rd.type,RowColOffset:pe.FirstColumn-le.FirstColumn,SortColor:Rd.color,SortIconSet:Rd.icon.IconSet,SortIcon:Rd.icon.Icon,IsAscending:!0}),ve={SortOptions:Object(Aa.a)(new Sa.a,{OperationType:1,ActiveCell:pe,SelectedRange:le,SortConditions:[Wd],SortTopToBottom:!0,GuessHeader:!0,IsCaseSensitive:!1}),SelectedRange:le,OriginalActiveCell:pe,ShouldRestoreSelection:!1};ve.ShouldPromptNamedSheetViewTeachingDialog=
Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures");V.ULS.sendTraceTag(537167119,0,50,"AutoFilterContextMenu.ApplySortByColorOrIcon: Aplying Sort, type: "+Rd.type);Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures")?(Rd={},kd.$.Cd(-1089513346,vb.a.Cb,19,(Rd.CustomSortCommandData=ve,Rd))):kd.j4f(function(){var Se={};kd.$.Cd(1659552324,vb.a.Cb,19,(Se.CustomSortCommandData=ve,Se))})};kd.BMa=hb.a.Fmd();kd.Sx=Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");
return kd}function fa(){this.top=this.left=0}function ra(){this.onMenuItemClick=this.applyFilterByValueRequest=this.getFilterByValueItemsRequest=null;this.autoFilterMenuWidth=0;this.applySortByColorOrIconRequest=null}function pa(){this.autoFilterMenu=this.targetPoint=null}function Za(){this.filterByValueItems=null;this.hasMoreRecords=!1;this.searchText=null}function Ua(){this.selectedSortIcon=this.selectedSortFontColor=this.selectedSortCellColor=this.getColorName=this.icons=this.fontColors=this.cellColors=
null}function Ma(){this.displayText=null;this.state=0;this.children=this.parent=this.key=null;this.indentationLevel=0;this.expanded=!1}function oa(){this.isSuccess=!1}function ja(){this.Title=this.MenuItems=this.Id=null;this.DisplayType=0}function ta(){this.Disabled=!1;this.RibbonCommand=this.Identifier=this.Type=0;this.SubMenu=this.Label=this.CommandData=null;this.IsChecked=!1;this.TooltipText=this.Id=this.IconName=null}function aa(){this.Sections=this.Id=null}var ma=b(0),Ea=b(915),Ha=b(155),Aa=
b(7),V=b(15),La=b(83),Ra=b(4),pb=b(162),cb=b(1287),Sa=b(1285),Db=b(938),Ab=b(5),Wb=b(502),ub=b(633),vb=b(76),Ka=b(54),eb=b(1125),yb=b(133),oc=b(41),Jb=b(572),dc=b(177),$a=b(62),Ba=b(50),la=b(972),ka=b(151),ca=b(37),Ia=b(121),jb=b(220),nb=b(91),Na=b(69),sa=b(34),Wa=b(31),Hb=b(299),Yb=b(1),Sb=b(187),lb=b(14),wb=b(61),wa=b(298),Oa=b(21),Ub=b(134),hb=b(993),Xb=b(994),Gc=b(126),uc=b(112),Nc=b(51),Fb=b(33),ob=b(451);Object(ma.a)(aa,"AutoFilterMenu",null,[]);Object(ma.a)(ta,"MenuItem",null,[]);Object(ma.a)(ja,
"MenuSection",null,[]);Object(ma.a)(oa,"ApplyFilterByValueResponse",null,[]);Object(ma.a)(Ma,"FilterByValueItem",null,[]);Object(ma.a)(Ua,"GetColorsAndIconsResponse",null,[]);Object(ma.a)(Za,"GetFilterByValueItemsResponse",null,[]);Object(ma.a)(pa,"ShowSortFilterMenuParams",null,[]);Object(ma.a)(ra,"SortFilterControllerFactoryParams",null,[]);Object(ma.a)(fa,"TargetPoint",null,[]);var zb=b(58),ib=b(207),fc=b(36),Ic=b(163),Yc=b(226),Mc=Ab.a.s3g,xb=Db.a;$k(ba,xb);ba.prototype.executeCommand=function(Ta,
Cb,jc){var tc=this;Ta=Cb.command;switch(Ta){case 1701016594:return Db.a.iyh(jc),zb.Task.Ua(!0);case 966232027:if(Yb.EwaSettings.xl()){var kd=new pb.a;ca.TaskExtensions.Aa(Ba.GetServiceTaskFactory.Ra(this.$.da,8,9,0),function(Rd){tc.n6e(Cb,jc,Rd.result);kd.setResult(!0)},this.la,3).continueWith(function(){kd.setResult(!1)},5,this.la,Yc.a.instance);return kd.task}this.n6e(Cb,jc);return zb.Task.Ua(!0);default:return Sb.a(Ta)}};ba.prototype.n6e=function(Ta,Cb,jc){var tc=this,kd=Cb.domEvent;if(Na.e(kd.rawEvent)&&
(Na.g(kd),kd.target)){var Rd=new ka.a(this.$.xa);if(Rd.Ud(4096)||Rd.Ud(2048)){var pe=Ka.a.Wh(Cb[vb.a.Wf]);this.L2f(pe)&&(this.Alf?this.stc(kd,kd.target,pe,Ta,jc):(this.UGb=function(){tc.L2f(pe)&&(tc.lci(),tc.stc(kd,kd.target,pe,Ta,jc),tc.Q2a=Yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FilterByValueSearch",!1),tc.Alf=!0)},this.Ayc()))}}};ba.prototype.Ac=function(Ta,Cb,jc){if(Ta=!!jc)switch(Cb.command){case 1701016594:case 966232027:Yb.EwaSettings.xl()||Wb.a(this.$)||(Ta=!1,V.ULS.sendTraceTag(537167137,
0,15,"AutoFilterContextMenu.CanExecuteCommand: ContextMenuManager is not ready. RibbonCommand was "+Nc.b().Xh(Cb.command)));break;default:Ta=!1}return Ta};ba.prototype.RDd=function(Ta){Ta.MenuSectionList.push.apply(Ta.MenuSectionList,kk(this.asb))};ba.prototype.lci=function(){var Ta=this;ob.a(function(){Ta.OMb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController(Object(Aa.a)(new ra,{getFilterByValueItemsRequest:Ta.xMi,applyFilterByValueRequest:Ta.wHi,onMenuItemClick:Ta.onMenuItemClick,
autoFilterMenuWidth:ba.fte,applySortByColorOrIconRequest:Ta.YLg}))});this.g$c=La.a.instance.nh("Common.IExternalUICommandDefinitionMapping")||new ub.a(this.$.zb,this.$)};ba.prototype.stc=function(Ta,Cb,jc,tc,kd){Ub.b(this.$).yd(yb.a.stc,this.em(),void 0,!0);V.ULS.shipAssertTag(537167135,0,!!jc,"Attempt at opening AutoFilterContextMenu failed, autoFilterData is null.");Ta=this.OJh(jc,kd);tc=Sys.UI.DomElement.getBounds(Cb);Cb=tc.x+tc.width;tc=tc.y;if(this.Sx&&!jc.IsHeaderSnapped){if(Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")&&
!Db.a.jnd(this.$,jc.Cell))return;jc=Db.a.wdd(this.$,jc.Cell,!0);Cb=jc.x;tc=jc.y}jc=Oa.g(this.$).rtl?new Sys.UI.Point(Cb-Fb.a(this.$).iGa(ba.fte),tc):new Sys.UI.Point(Cb,tc);jc=Fb.a(this.$).Ija(jc);jc=Object(Aa.a)(new pa,{targetPoint:Object(Aa.a)(new fa,{left:jc.x,top:jc.y}),autoFilterMenu:Ta});this.OMb.showSortFilterMenu(jc);this.$.Cd(-544117314,-1,0,null)};ba.prototype.L2f=function(Ta){return Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5819197_CheckActiveItemBeforeRenderingAutofilterMenu")&&Ta.Cell.SheetName?
Oa.g(this.$).k5?Ta.Cell.SheetName===this.$.pa.name:Ta.Cell.SheetName===this.$.pa.sheetName:!0};ba.prototype.OJh=function(Ta,Cb){return(Ta=this.PJh(Ta,Cb))?this.HJf(Ta):null};ba.prototype.HJf=function(Ta){for(var Cb=[],jc=ik(Ta.Sections),tc=jc.next();!tc.done;tc=jc.next())tc=tc.value,Object(Ic.f)(this.$)&&Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:6122433_NSVTitleEnabled")&&tc.Title===lb.a.instance.ga(1938)||(tc=this.l2i(tc),Cb.push(tc));return Object(Aa.a)(new aa,{Id:Ta.Id,Sections:Cb})};ba.prototype.l2i=
function(Ta){for(var Cb=[],jc=ik(Ta.MenuItems),tc=jc.next();!tc.done;tc=jc.next())if(tc=tc.value,2===tc.Identifier)this.HWc=tc.CommandData;else switch(tc.Type){case 3:case 2:Cb.push(this.j2i(tc,2===tc.Type));break;case 1:Cb.push(this.k2i(tc))}return Object(Aa.a)(new ja,{MenuItems:Cb,DisplayType:Ta.DisplayType,Id:this.bHh(Ta)})};ba.prototype.k2i=function(Ta){var Cb=this.cWe(Ta);var jc=Cb.label;var tc=Cb.vLa;Cb=this.HJf(Ta.SubMenu);var kd=this.TVe(Ta);tc=this.g$c.sbc(tc);jc=jc||Ta.Label;return Object(Aa.a)(new ta,
{Disabled:Ta.Disabled,Type:Ta.Type,Identifier:Ta.Identifier,Id:kd,CommandData:Ta.CommandData,Label:jc,SubMenu:Cb,IsChecked:Ta.IsChecked,IconName:"MissingIcon_20"===tc?null:tc})};ba.prototype.j2i=function(Ta,Cb){var jc=this.fac(Ta,Cb&&Ta.IsChecked);Cb=jc.label;var tc=jc.vLa;jc=jc.mr;var kd=this.scd(Ta,Cb);tc=this.g$c.sbc(tc);return Object(Aa.a)(new ta,{Disabled:Ta.Disabled,Type:Ta.Type,Identifier:Ta.Identifier,Id:kd,RibbonCommand:jc,CommandData:Ta.CommandData,Label:Cb||Ta.Label,SubMenu:null,IsChecked:Ta.IsChecked,
IconName:"MissingIcon_20"===tc?null:tc})};ba.prototype.PJh=function(Ta,Cb){var jc;this.pTa=jc=oc.C(Ta.Cell);this.sheetName=this.$.pa.sheetName;Cb=Cb||Wb.a(this.$);if(Ta.IsHeaderSnapped)jc=Cb.V9b.aRh(jc);else{Cb=Oa.g(this.$).Ea.tKa(jc);if(!Cb)return this.BMa?hb.a.wQa(Xb.a.ZLf,Gc.a.t2h,uc.a.QZa,!0,!1):V.ULS.sendTraceTag(537167134,0,10,"AutoFilterContextMenu.GetAutoFilterMenuProps: gridModelCellProxy that is supposed to hold model is null. Range requested "+jc+", visible range: "+Oa.g(this.$).view.visibleArea),
null;jc=Cb.autoFilterMenu}if(!jc)return this.BMa?hb.a.wQa(Xb.a.ZLf,Gc.a.iBi,uc.a.QZa,!0,!1):V.ULS.sendTraceTag(537167133,0,10,"AutoFilterContextMenu.GetMenuPropsFromCachedBlock: a cell that's supposed to have an autofilter menu returned a null menu."),null;this.Lsb=Ta.Cell.FirstRow+"_"+Ta.Cell.FirstColumn;return jc};ba.prototype.Ayc=function(){var Ta=this;if(this.$.ea.Lg){var Cb=Ba.GetServiceTaskFactory.Ra(this.$.da,283,284,1);ca.TaskExtensions.Aa(Cb,function(){Ta.BMa?Cb.result.vn.loadScript("sortFilter").then(function(){Ta.UGb()},
function(jc){wb.a.hk(jc,"AutoFilterContextMenu.SortFilterScriptLoad");hb.a.wQa(Xb.a.Ayc,Gc.a.JEj,uc.a.QZa,!1,!1)}):ca.TaskExtensions.Aa(ib.c(Cb.result.vn.loadScript("sortFilter")),function(){Ta.UGb()},Ta.$.la,3)},this.$.la,3)}else this.$.ea.jl(this.VV)};ba.prototype.g6g=function(Ta){var Cb={};Cb.SearchText=Ta;Cb.Page=1;Cb.DateNodeType=-1;return Cb};ba.prototype.$Vg=function(){this.qPa&&(V.ULS.sendTraceTag(537167132,0,15,"AutoFilterContextMenu.CancelGetAutoFilterItemListWebRequest Cancelling pending getAutoFilterItemList request with ID="+
this.qPa),$a.h(this.$.oa.va,this.qPa,null,null,null),this.qPa=null);this.P$a&&(Ra.AFrameworkApplication.nd.mu(this.P$a.Gt),this.P$a=null)};ba.prototype.uAd=function(Ta){var Cb=this;return function(jc){Cb.qPa=null;Cb.P$a=null;if(hb.a.yxc(jc)){var tc=hb.a.wac(jc);Cb.BMa?hb.a.wQa(Ta?Xb.a.searchAutoFilterItemList:Xb.a.getAutoFilterItemList,tc.MessageIdName,uc.a.QZa,!0,!0):V.ULS.sendTraceTag(537167127,0,10,"AutoFilterContextMenu::OnGetFilterByValueItemsSuccessCallback failed with AutoFilterException -"+
tc.MessageIdName)}if(!Hb.a(jc)){V.ULS.sendTraceTag(537167126,0,50,"AutoFilterContextMenu::OnGetFilterByValueItems service call succeeded");jc=jc.Result;tc=new sa.a(!0);var kd=jc.AutoFilterDateNodes?!0:!1;jc.AutoFilterItems&&tc.add("AutoFilterItemsCount",jc.AutoFilterItems.length);kd&&tc.add("AutoFilterDateItemsCount",jc.AutoFilterDateNodes.length);tc.add("Location","contextMenu");Ub.b(Cb.$).yd(yb.a.uAd,tc.au,void 0,!0);tc=Cb.Q2a?Object(Aa.a)(new Za,{filterByValueItems:Cb.eCe(jc),hasMoreRecords:jc.ItemListMaxExceeded,
searchText:jc.SearchText}):Object(Aa.a)(new Za,{filterByValueItems:Cb.eCe(jc),hasMoreRecords:jc.ItemListMaxExceeded});Cb.OMb.onGetFilterByValueItemsFinish(tc);Ta||(V.ULS.shipAssertTag(529063959,0,null!==jc.FontColors&&null!==jc.CellColors&&null!==jc.Icons&&null!==jc.SelectedSortFontColors&&null!==jc.SelectedSortCellColors&&null!==jc.SelectedSortIcons,"AutoFilterContextMenu.onGetFilterByValueItemsSuccessCallback: SortByColor items should not be null"),jc=Object(Aa.a)(new Ua,{fontColors:jc.FontColors,
cellColors:jc.CellColors,icons:jc.Icons,selectedSortFontColor:0<jc.SelectedSortFontColors.length?jc.SelectedSortFontColors[0]:null,selectedSortCellColor:0<jc.SelectedSortCellColors.length?jc.SelectedSortCellColors[0]:null,selectedSortIcon:0<jc.SelectedSortIcons.length?jc.SelectedSortIcons[0]:null,getColorName:Cb.getColorName}),Cb.OMb.onGetColorsAndIconsFinish(jc))}}};ba.prototype.yMi=function(){var Ta=this;return function(Cb){Ta.qPa=null;Ta.P$a=null;Cb=Ia.a.xf(Cb.data);V.ULS.sendTraceTag(537167125,
0,10,"AutoFilterContextMenu.OnGetFilterByValueItemsFailureCallback Errors: ["+Wa.a.Cc(Cb)+"].")}};ba.prototype.eCe=function(Ta){var Cb=this.U3g(Ta),jc=this.a4g(Ta.AutoFilterItems),tc=[],kd=0;Ta.HasBlanks&&(Ta=ba.B3c(lb.a.instance.ga(781),Ta.IsBlanksSelected?1:0,Ab.a.ete),tc[kd++]=Ta);Cb=ik(Cb);for(Ta=Cb.next();!Ta.done;Ta=Cb.next())Ta=Ta.value,tc[kd++]=Ta;jc=ik(jc);for(Ta=jc.next();!Ta.done;Ta=jc.next())Cb=Ta.value,tc[kd++]=Cb;return tc};ba.prototype.U3g=function(Ta){var Cb=[];if(!Ta.AutoFilterDateNodes||
!Ta.AutoFilterDateNodes.length)return Cb;for(var jc=[this.j4a(Ta.YearKeys,Ta.YearValues),this.j4a(Ta.MonthKeys,Ta.MonthValues),this.j4a(Ta.DayKeys,Ta.DayValues),this.j4a(Ta.HourKeys,Ta.HourValues),this.j4a(Ta.MinuteKeys,Ta.MinuteValues),this.j4a(Ta.SecondKeys,Ta.SecondValues)],tc=!1,kd=!1,Rd=0,pe=null,le=Array(6),Wd=null,ve=ik(Ta.AutoFilterDateNodes),Se=ve.next();!Se.done;Se=ve.next()){Se=Se.value;le[0]&&(Wd.Year!==Se.Year?(tc=!0,Rd=0,pe=null):Wd.Month!==Se.Month?(kd=!0,Rd=1,pe=le[0]):Wd.Day!==Se.Day?
(Rd=2,pe=le[1]):Ta.ShowTime&&(Wd.Hour!==Se.Hour?(Rd=3,pe=le[2]):Wd.Minute!==Se.Minute?(Rd=4,pe=le[3]):(Rd=5,pe=le[4])));for(;6>Rd;){switch(Rd){case 0:var Ve=Se.Year;Wd=jc[0].getItem(Ve.toString());break;case 1:Ve=Se.Month;Wd=jc[1].getItem(Ve.toString());break;case 2:Ve=Se.Day;Wd=jc[2].getItem(Ve.toString());break;case 3:Ve=Se.Hour;Wd=jc[3].getItem(Ve.toString());break;case 4:Ve=Se.Minute;Wd=jc[4].getItem(Ve.toString());break;case 5:Ve=Se.Second;Wd=jc[5].getItem(Ve.toString());break;default:throw Error.invalidOperation("Unknown AutoFilterDateNodeType.");
}Wd=ba.B3c(Wd,-1!==Se.NodeType&&Rd>=Se.NodeType?1:0,pe?pe.key+";"+Ve:Ab.a.IXc+Ve,!1,[]);pe=pe?pe.children:Cb;pe=pe[pe.length]=Wd;le[Rd]=Wd;switch(Rd){case 5:Rd=6;break;case 2:Rd=Ta.ShowTime?Rd+1:6;break;default:Rd++}}Wd=Se}tc||(le[0].expanded=!0,kd||(le[1].expanded=!0));return Cb};ba.prototype.a4g=function(Ta){var Cb=[];if(!Ta)return Cb;var jc=0;Ta=ik(Ta);for(var tc=Ta.next();!tc.done;tc=Ta.next())tc=tc.value,Cb[jc++]=ba.B3c(tc.DisplayString,tc.Selected?1:0,Ab.a.JXc+tc.DisplayString);return Cb};ba.prototype.j4a=
function(Ta,Cb){var jc=new sa.a(!0);if(!Ta||!Cb)return jc;for(var tc=Ta.length<Cb.length?Ta.length:Cb.length,kd=0;kd<tc;kd++)jc.add(Ta[kd].toString(),Cb[kd]);return jc};ba.prototype.n3c=function(Ta,Cb){var jc={};jc.Location=Cb;jc.FieldId=Ta.Id.toString();jc.DataSourceIndex=-1;jc.FilterType=Ta.AutoFilterType;jc.AnchorType=0;jc.ChartId=null;jc.AnchorValue1=-1;jc.AnchorValue2=-1;jc.Property=Ta.RichProperty;return jc};ba.prototype.nL=function(Ta){fc.a.Oba(this.$)&&ca.TaskExtensions.Aa(Ba.GetServiceTaskFactory.Ra(this.$.da,
430,431,1),function(Cb){Cb.result.vea(Ta);V.ULS.sendTraceTag(537167123,306,50,"AutoFilterContextMenu:TriggerPivotTableHandRaise Trigger hand raise from filter context menu.")},this.$.la,3)};ba.prototype.em=function(){var Ta={};return Ta.Location="contextMenu",Ta};ba.prototype.getColorName=function(Ta){return la.a.sKa(jb.a.WG(Ta))};ba.prototype.j4f=function(Ta){ca.TaskExtensions.Aa(Ba.GetServiceTaskFactory.Ra(this.$.da,309,310,3),function(Cb){Cb.result.RAa().continueWith(function(jc){jc.result&&Ta()})},
this.$.la,3)};ba.B3c=function(Ta,Cb,jc,tc,kd){Ta=void 0===Ta?null:Ta;Cb=void 0===Cb?0:Cb;jc=void 0===jc?null:jc;tc=void 0===tc?!1:tc;kd=void 0===kd?null:kd;return Object(Aa.a)(new Ma,{displayText:Ta?Db.a.rh(Ta):Ta,state:Cb,key:jc,parent:null,children:kd,indentationLevel:0,expanded:tc})};of.Object.defineProperties(ba.prototype,{xw:{configurable:!0,enumerable:!0,get:function(){return"PopulateAutoFilterContextMenu"}},tB:{configurable:!0,enumerable:!0,get:function(){return Ab.a.XLf}}});ba.fte=268;Object(ma.a)(ba,
"AutoFilterContextMenu",Db.a,[]);var wc=b(946),Ob=b(85),nc=b(192),mb=b(67),ic=b(19);bb.RSe=26;bb.lad=[230,231,0,99,0,95,94];Object(ma.a)(bb,"Constants",null,[]);of.Object.defineProperties(va.prototype,{Mki:{configurable:!0,enumerable:!0,get:function(){return 3===this.q5b}},soi:{configurable:!0,enumerable:!0,get:function(){return 4===this.q5b&&!!this.subMenu}},subMenu:{configurable:!0,enumerable:!0,get:function(){return this.hyg}},lqf:{configurable:!0,enumerable:!0,get:function(){return this.Jtg}},
q5b:{configurable:!0,enumerable:!0,get:function(){return this.Xng}},X4c:{configurable:!0,enumerable:!0,get:function(){return this.aog}}});Object(ma.a)(va,"FiltersMenuData",null,[]);$k(ya,va);Object(ma.a)(ya,"AutoFilterFiltersMenuData",va,[]);ha.TJj=[new va(100,2,0,null),new va(101,2,1,null),new va(0,3,0,null),new va(172,2,2,null),new va(174,2,4,null),new va(0,3,0,null),new va(176,2,6,null),new va(177,2,7,null),new va(0,3,0,null),new va(108,0,0,null)];ha.VFi=[new va(100,2,0,null),new va(101,2,1,null),
new va(0,3,0,null),new va(102,2,8,null),new va(103,2,10,null),new va(104,2,12,null),new va(0,3,0,null),new va(105,1,0,null),new ya(106,1),new ya(107,2),new va(0,3,0,null),new va(108,0,0,null)];ha.Vch=[new va(100,2,0,null),new va(0,3,0,null),new va(112,2,10,null),new va(113,2,8,null),new va(104,2,12,null),new va(0,3,0,null),new ya(110,8),new ya(109,9),new ya(111,10),new va(0,3,0,null),new ya(115,11),new ya(114,12),new ya(116,13),new va(0,3,0,null),new ya(117,14),new ya(118,15),new ya(119,16),new va(0,
3,0,null),new ya(120,17),new ya(121,18),new ya(122,19),new va(0,3,0,null),new ya(123,20),new ya(124,21),new ya(125,22),new va(0,3,0,null),new ya(126,23),new va(127,2,12,[new ya(128,24),new ya(129,25),new ya(130,26),new ya(131,27),new va(0,3,0,null),new ya(132,28),new ya(133,29),new ya(134,30),new ya(135,31),new ya(136,32),new ya(137,33),new ya(138,34),new ya(139,35),new ya(140,36),new ya(141,37),new ya(142,38),new ya(143,39)]),new va(0,3,0,null),new va(108,0,0,null)];Object(ma.a)(ha,"Constants",null,
[]);var qc=b(1126),hc=b(77),Jc=Db.a;$k(Z,Jc);Z.prototype.executeCommand=function(Ta,Cb,jc){Ta=Cb.command;switch(Ta){case -699941697:this.applyAutoFilterFieldList(Cb,jc);break;case 216058793:break;case -1494291901:break;default:return Sb.a(Ta)}return zb.Task.Ua(!0)};Z.prototype.mdd=function(Ta,Cb){return!Ta||Ta.length<=Cb?(V.ULS.sendTraceTag(537167117,0,10,"AutoFilterFieldListContextMenu:GetCommandId - incomplete id list"),-1):parseInt(Ta[Cb],10)};Z.prototype.xFd=function(Ta,Cb,jc,tc,kd,Rd){var pe=
this.mdd(kd,Rd);0>pe&&V.ULS.sendTraceTag(537167116,0,10,"AutoFilterFieldListContextMenu:ProcessCommand - command id not found");switch(bb.lad[pe]){case 99:Ta=new nb.a(-2058042992,Cb.method,Cb.mode,Cb.Ne,Cb.tabName);this.dm.AG.Ttb(this.$,tc,0,Ta);break;case 230:Ta=new nb.a(504133448,Cb.method,Cb.mode,Cb.Ne,Cb.tabName);this.dm.AG.Ttb(this.$,tc,0,Ta);break;case 231:Ta=new nb.a(-798968736,Cb.method,Cb.mode,Cb.Ne,Cb.tabName);this.dm.AG.Ttb(this.$,tc,0,Ta);break;case 235:Ta=new nb.a(-1677817820,Cb.method,
Cb.mode,Cb.Ne,Cb.tabName);this.dm.AG.Ttb(this.$,tc,0,Ta);break;case 95:this.XJf(Ta,Cb,tc,jc,kd,Rd+1);break;case 94:this.dm.AG.tsi(this.$,tc)}};Z.prototype.XJf=function(Ta,Cb,jc,tc,kd,Rd){var pe=this.mdd(kd,Rd);0>pe&&V.ULS.sendTraceTag(537167115,0,10,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand - command id not found");if(!tc||pe>=tc.length)V.ULS.sendTraceTag(537167114,0,15,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand() - no menuData.");else switch(tc=tc[pe],tc.q5b){case 1:this.dm.AG.Osi(this.$,
jc);break;case 2:(kd=Object(Ob.a)(ya,tc))?(Ta=new nb.a(-2058042992,Cb.method,Cb.mode,Cb.Ne,Cb.tabName),this.dm.AG.Ttb(this.$,jc,kd.gte,Ta)):this.dm.AG.qkf(this.$,Ta,jc,tc.X4c);break;case 0:this.dm.AG.qkf(this.$,Ta,jc,tc.X4c);break;case 4:this.XJf(Ta,Cb,jc,tc.subMenu,kd,Rd+1)}};Z.prototype.applyAutoFilterFieldList=function(Ta,Cb){var jc=Cb[wc.a.NF];if(jc)if(jc=jc.split(mb.a.IU),3>jc.length)V.ULS.sendTraceTag(537167112,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - unexpected SourceIdControl string.");
else{var tc=this.mdd(jc,1),kd=this.gKa(tc),Rd=this.gqf(tc).returnValue;Rd?this.xFd(Cb,Ta,Rd,kd,jc,2):V.ULS.sendTraceTag(537167111,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - menu data not found for index "+tc.toString()+mb.a.IU)}else V.ULS.sendTraceTag(537167113,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - SourceIdControl string is null.")};Z.prototype.Ac=function(Ta,Cb){if(Ta=this.$.isEditMode)switch(Cb.command){case 216058793:break;case -699941697:break;
case -1494291901:Ta=!0;break;default:Ta=!1}return Ta};Z.prototype.M0=function(Ta,Cb,jc){this.$.isEditMode&&((this.dm=Object(Ob.a)(567,jc))||V.ULS.sendTraceTag(537167110,0,10,"AutoFilterFieldListContextMenu:ShowDropDown() - filterInfoManager not found."),this.UY(),Jc.prototype.M0.call(this,Ta,Cb,null,null,!0))};Z.prototype.v3c=function(){if(!this.dm||!this.dm.Hk||1!==this.dm.Hk.length)return V.ULS.sendTraceTag(537167109,0,15,"AutoFilterFieldListContextMenu:CreateContextMenuItemList() - incorrect fields list."),
null;var Ta=this.dm.Hk[0],Cb=new nc.a;Cb.add(lb.a.instance.ga(251));Cb=hc.OBc(hc.concat(Cb,hc.select(hc.asEnumerable(Ta.FieldInfoDataList),function(jc){return jc.Name})),function(jc){return jc},new qc.a);return hc.toArray(Cb)};Z.prototype.fieldIndex=function(Ta){if(!this.dm||!this.dm.Hk||1!==this.dm.Hk.length||!this.dm.Hk[0].FieldInfoDataList)return-1;for(var Cb=0;Cb<this.dm.Hk[0].FieldInfoDataList.length;++Cb)if(this.dm.Hk[0].FieldInfoDataList[Cb].Name===Ta)return Cb;return-1};Z.prototype.gKa=function(Ta){return 0>
Ta||!this.dm||!this.dm.Hk||1!==this.dm.Hk.length||!this.dm.Hk[0].FieldInfoDataList||this.dm.Hk[0].FieldInfoDataList.length<Ta?null:this.dm.Hk[0].FieldInfoDataList[Ta].Name};Z.prototype.UY=function(){var Ta=this,Cb=this.v3c();if(!Cb||!Cb.length)return null;for(var jc=this.Va,tc=jc.Bc(),kd={},Rd=0;Rd<Cb.length;kd={mgb:kd.mgb},++Rd){var pe=Cb[Rd];kd.mgb=0<Rd?this.fieldIndex(pe):-1;for(var le=Z.N5f+kd.mgb.toString()+mb.a.IU,Wd=null,ve=this.dm.AG.e6h(0<Rd?pe:null),Se=this.E3c(jc,ve,Z.N5f+kd.mgb.toString(),
pe),Ve={},Va=0;Va<bb.lad.length;Ve={hQb:Ve.hQb,lgb:Ve.lgb},++Va){var Rb=bb.lad[Va],Lc=le+Va.toString();Wd||(Wd=jc.Bc());switch(Rb){case 230:Wd.buttons.push(jc.Oc(223,Lc,-699941697,this.dm.AG.doi(0<Rd?pe:null)?ic.a.$8b:ic.a.$Ia,8,230,!1,null));break;case 231:Wd.buttons.push(jc.Oc(224,Lc,-699941697,this.dm.AG.eoi(0<Rd?pe:null)?ic.a.a9b:ic.a.aJa,8,231,!1,null));break;case 235:Wd.buttons.push(jc.Oc(225,Lc,-699941697,ic.a.Y8b,1,235,!1,null));break;case 99:Rb=this.zSg(pe);Lc=jc.LHa(Lc+(ve?".enabled":".disabled"),
Rb,-699941697,null,"None",null,!ve,void 0,!0);Lc.bS("Image16by16",8,ic.a.B2a);Wd.buttons.push(Lc);break;case 95:Ve.hQb=void 0;Ve.lgb=void 0;var od=function(yd,ce){return function(){var $d=Ta.gqf(yd.mgb);ce.hQb=$d.$Se;ce.lgb=$d.isChecked;return $d}}(kd,Ve)().returnValue;if(!od)return null;Rb=this.E3c(jc,Ve.lgb&&ve,Lc,Ve.hQb);Lc=this.hWe(Rb.menu,jc,Lc+mb.a.IU,od,Ve.lgb&&ve);Rb.menu.pc.push(Lc);Wd.buttons.push(Rb);break;case 0:Wd&&(Se.menu.pc.push(Wd),Wd=null);break;default:Lc=jc.LHa(Lc,lb.a.instance.ga(Rb),
-699941697,null,"None",null,!1,void 0,!0),this.fZf(Lc,ve&&94===Rb&&this.dm.AG.filter(),lb.a.instance.ga(Rb)),Wd.buttons.push(Lc)}}Se.menu.pc.push(Wd);tc.buttons.push(Se)}Cb=jc.kq(this.menuId);Cb.pc.push(tc);return Cb};Z.prototype.hWe=function(Ta,Cb,jc,tc,kd){for(var Rd=null,pe=0;pe<tc.length;++pe){var le=tc[pe],Wd=jc+pe.toString(),ve=!1;switch(le.q5b){case 1:ve=kd&&this.dm.AG.Ih.IsTop10;break;case 2:ve=Object(Ob.a)(ya,le);ve=kd&&this.dm.AG.xhi(ve?ve.gte:0,le.X4c);break;case 0:ve=kd&&this.dm.AG.Ih.IsCustomSupportedAndNotPresent}Rd||
(Rd=Cb.Bc());if(le.Mki)Rd&&(Ta.pc.push(Rd),Rd=null);else if(le.soi){var Se=lb.a.instance.ga(le.lqf);Se=this.E3c(Cb,ve,Wd,Se);Se.menu.pc.push(this.hWe(Se.menu,Cb,Wd+mb.a.IU,le.subMenu,ve));Rd.buttons.push(Se)}else le=lb.a.instance.ga(le.lqf),Wd=Cb.LHa(Wd,le,-699941697,null,"None",null,!1,void 0,!0),this.fZf(Wd,ve,le),Rd.buttons.push(Wd)}return Rd};Z.prototype.fZf=function(Ta,Cb,jc){Cb?Ta.bS("Image16by16",8,ic.a.sua):Ta.bS("None",0,null);Ta.$R(jc);Ta.label=jc};Z.prototype.E3c=function(Ta,Cb,jc,tc){return Cb?
Ta.w3c(jc,this.menuId,tc,798637440,8,ic.a.sua):Ta.Tv(jc,this.menuId,tc,798637440)};Z.prototype.gh=function(Ta){return!Ta||!Ta.length};Z.prototype.gqf=function(Ta){var Cb=0>Ta?0:this.dm.Hk[0].FieldInfoDataList[Ta].MajorityDataTypeForField;var jc=null;Ta=this.dm.AG.d6h(Cb);switch(Cb){case 0:jc=96;Cb=ha.TJj;break;case 1:jc=95;Cb=ha.VFi;break;case 2:jc=97;Cb=ha.Vch;break;default:return V.ULS.sendTraceTag(537167108,0,10,"AutoFilterFieldListContextMenu:MenuDataForDataType() - unknown data type."),{returnValue:null,
$Se:jc,isChecked:Ta}}jc=lb.a.instance.ga(jc);return{returnValue:Cb,$Se:jc,isChecked:Ta}};Z.prototype.zSg=function(Ta){return!Ta||this.gh(Ta.trim())?lb.a.instance.ga(98):Ta.length>bb.RSe?String.format(lb.a.instance.mb(155),Ta.substring(0,bb.RSe)):String.format(lb.a.instance.mb(156),Ta)};of.Object.defineProperties(Z.prototype,{xw:{configurable:!0,enumerable:!0,get:function(){return"PopulateAutoFilterFieldListContextMenu"}},tB:{configurable:!0,enumerable:!0,get:function(){return Ab.a.YLf}}});Z.Yzh=Ab.a.r3g;
Z.NJb="AutoFilterFieldListContextMenuRoot";Z.N5f="ApplyAutoFilterFieldList.";Object(ma.a)(Z,"AutoFilterFieldListContextMenu",Db.a,[]);var rd=b(620),md=b(1059),Cc=b(11),fd=b(122),Cd=b(395),Sc=Db.a;$k(xa,Sc);xa.prototype.executeCommand=function(Ta,Cb,jc){Ta=Object(Ob.a)(rd.a,jc.eventArgs);switch(Cb.command){case -1372040782:jc=Oa.g(this.$).ha.Oa.Yb;V.ULS.shipAssertTag(537167048,0,!!jc);jc&&(this.floatingObject=jc.floatingObject,this.nb=Cb.method,Cb=this.Xac(Ta),this.hp(Cb,!0,Ta.nb));break;case 848910589:Ta&&
(Cb=[md.a.s1f],Ta=new Sys.UI.Point(Ta.Ca.clientX,Ta.Ca.clientY),this.showFloatie(Cb,new Sys.UI.Bounds(Ta.x,Ta.y,0,0),2))}return zb.Task.Ua(!0)};xa.prototype.Ac=function(Ta,Cb,jc){switch(Cb.command){case -1372040782:return!!jc&&this.Ehf(Ta);case 848910589:return Ta=Oa.g(this.$).ha.Oa.Yb,!!jc&&!!Ta&&Ta.isEditing;default:return!1}};xa.prototype.Ehf=function(Ta){switch(Ta){case 8:case 2:case 64:case 4:case 256:return!0;default:return!1}};xa.prototype.kUc=function(Ta,Cb,jc){Cd.a(this.$)?Oa.g(this.$).eb.Ji||
(Fb.a(this.$).FRd()?jc.buttons.push(Ta.lb(265)):jc.buttons.push(Ta.lb(264))):(this.$.isEditMode&&3===this.nb&&!this.z$b()&&jc.buttons.push(Ta.lb(101)),5!==this.floatingObject.type||fd.a.uH(this.floatingObject.xb)||this.floatingObject.xb.IsGroup||(Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&this.vqd()?jc.buttons.push(Ta.lb(186)):jc.buttons.push(Ta.lb(147))),this.z$b()||this.vqd()||jc.buttons.push(Ta.lb(146)),Yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeFOZOrder",
!1)&&(this.dGh(jc),this.FHh(jc)),Yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&0===this.floatingObject.type&&jc.buttons.push(Ta.lb(287)),Yb.EwaSettings.ma(167)&&0===this.floatingObject.type&&jc.buttons.push(Ta.lb(249)),5===this.floatingObject.type&&Oa.g(this.$).ha.Oa.Yb.r5()&&this.$.Lka&&this.$.gha&&jc.buttons.push(Ta.lb(273)))};xa.prototype.iKa=function(Ta){var Cb=[];if(Cd.a(this.$))return Cb;3===Ta?(Ta=!!this.$.pe.get(5)&&this.floatingObject.IUd(),this.z$b()||
(this.$.isEditMode?(Ta&&Cb.push(md.a.bDh),5===Oa.g(this.$).ha.Oa.pC.floatingObject.type&&Cb.push(md.a.jwj)):Ta&&Cb.push(md.a.copy)),Cb.push(md.a.cDh)):2===Ta&&(Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:4840604_JsCrashInGetFloatieGroupsForSelection")?Oa.g(this.$).ha.Oa.Yb&&this.X_e(Oa.g(this.$).ha.Oa.Yb,Cb):this.X_e(Oa.g(this.$).ha.Oa.pC,Cb));return Cb};xa.prototype.UY=function(){var Ta=this.Va,Cb=Ta.kq(this.menuId),jc=Cd.a(this.$);if(this.$.isEditMode){var tc=Ta.Bc();this.kUc(Ta,Cb,tc);Cb.pc.push(tc)}this.$.pe.get(5)&&
this.floatingObject.IUd()&&!this.z$b()&&!jc&&(tc=Ta.Bc(),this.$Bg(Ta,tc),Cb.pc.push(tc));(tc=this.$.xa.pa)&&tc.Kd&&(tc=tc.Kd.Ux||tc.Kd.eK,!Yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||0!==this.floatingObject.type||this.$.ea.isNamedObjectViewMode||jc||this.$.isMobileMode||tc||(jc=Ta.Bc(),this.YDg(Ta,jc),Cb.pc.push(jc)));return Cb};xa.prototype.Xac=function(Ta){var Cb=Oa.g(this.$).ha.Oa.Yb;Ta=Ta&&1!==Ta.nb&&Ta.clientPoint?Ta.clientPoint:Sys.UI.DomElement.getLocation(Cb.domElement);
var jc=this.$.domElement,tc=Oa.g(this.$).rtl;(Cb=Cc.HelperMethods.AC(Cb.dg.domElement,jc,tc))?(Ta.y=Math.max(Ta.y,Cb.y),Ta.x=Math.max(Ta.x,Cb.x)):V.ULS.sendTraceTag(537167047,5,15,"FloatingObjectContextMenu.GetContextMenuClientPoint sheetContentDivLocation is null if the offset parent is null. IsShuttingdown : "+Ra.AFrameworkApplication.zg);return Ta};xa.prototype.vqd=function(){var Ta=Oa.g(this.$).ha.Oa.Yb;return!!Ta&&Ta.isEditing};xa.prototype.$Bg=function(Ta,Cb){if(this.$.isEditMode){Cb.buttons.push(Ta.lb(42));
Cb.buttons.push(Ta.lb(43));var jc=this.$.da.za(254,!0);(jc&&2===jc.JBb()||Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&this.vqd())&&Cb.buttons.push(Ta.lb(44))}else Cb.buttons.push(Ta.lb(43))};xa.prototype.YDg=function(Ta,Cb){Cb.buttons.push(Ta.lb(274))};xa.prototype.z$b=function(){return Yb.EwaSettings.ma(467)&&!!Oa.g(this.$).ha.Oa.yo};xa.prototype.X_e=function(Ta,Cb){5===Ta.floatingObject.type?Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&
Ta.isEditing?Cb.push(md.a.s1f):Cb.push(md.a.fwj):Cb.push(Db.a.fUe)};xa.prototype.dGh=function(Ta){var Cb=this.Va.Bc();Cb.buttons.push(this.Va.lb(282));Cb.buttons.push(this.Va.lb(281));var jc=this.Va.Tv("BringToFront","BringToFrontMenuId",lb.a.instance.ga(821),-1777747317);jc.menu.pc.push(Cb);Ta.buttons.push(jc)};xa.prototype.FHh=function(Ta){var Cb=this.Va.Bc();Cb.buttons.push(this.Va.lb(284));Cb.buttons.push(this.Va.lb(283));var jc=this.Va.Tv("SendToBack","SendToBackMenuId",lb.a.instance.ga(822),
-1777747317);jc.menu.pc.push(Cb);Ta.buttons.push(jc)};of.Object.defineProperties(xa.prototype,{xw:{configurable:!0,enumerable:!0,get:function(){return"PopulateFloatingObjectContextMenu"}},tB:{configurable:!0,enumerable:!0,get:function(){return Ab.a.fMf}}});Object(ma.a)(xa,"FloatingObjectContextMenu",Db.a,[]);var Md=b(1010),bc=b(103),xe=b(629),Je=b(573),we=Ab.a.u3g;$k(da,xa);da.prototype.executeCommand=function(Ta,Cb,jc){var tc=this.$;this.nb=Cb.method;Cb=jc[da.T_c];if(!(Ta&68)){if(!Cb){if(8===Ta)Cb=
Je.a(tc).Pc;else{var kd=Oa.g(tc).ha.Oa.Yb;if(null===kd||void 0===kd?0:kd.floatingObject)Cb=kd.floatingObject.Pc}if(!Cb)return zb.Task.Ua(!0)}this.isPivotChart=!!(Cb.Attributes&4)}if(this.isPivotChart||tc.isEditMode)if(this.refresh=this.lZ=this.Zva=this.OAa=!1,kd=Oa.g(this.$).ha.Oa.Yb,V.ULS.shipAssertTag(537167107,0,!!kd),kd){this.floatingObject=kd.floatingObject;kd=xe.a(tc);if(null===kd||void 0===kd?0:kd.bRd)this.OAa=kd=bc.f(tc.mg),this.Zva=!kd;kd=tc.ic;this.lZ=!!Md.a(tc)&&!!Cb&&!!(Cb.Attributes&
512)&&!(Ta&8)&&kd.N2(32768);kd.allowManualDataRefresh&&kd.allowInteractivity&&(this.refresh=!0);Ta=this.Xac(Object(Ob.a)(rd.a,jc.eventArgs));this.hp(Ta,!0)}return zb.Task.Ua(!0)};da.prototype.Ac=function(Ta,Cb,jc){return-149612405===Cb.command&&!!jc&&this.Ehf(Ta)};da.prototype.kUc=function(Ta,Cb,jc){this.isPivotChart&&(this.refresh&&jc.buttons.push(Ta.lb(100)),this.lZ&&jc.buttons.push(Ta.lb(99)),this.OAa?jc.buttons.push(Ta.lb(59)):this.Zva&&jc.buttons.push(Ta.lb(58)));xa.prototype.kUc.call(this,Ta,
Cb,jc)};of.Object.defineProperties(da.prototype,{xw:{configurable:!0,enumerable:!0,get:function(){return"PopulateChartContextMenu"}},tB:{configurable:!0,enumerable:!0,get:function(){return Ab.a.$Lf}}});of.Object.defineProperties(da,{T_c:{configurable:!0,enumerable:!0,get:function(){return"chartMetaData"}}});Object(ma.a)(da,"ChartContextMenu",xa,[]);var de=b(12),Le=Ab.a.w3g,Ie=Db.a;$k(ia,Ie);ia.prototype.executeCommand=function(Ta,Cb,jc){Ta=Cb.command;switch(Ta){case 330754562:Cb=jc.domElement;this.isOlap=
jc.isOlap;this.qL=jc.versionkey;this.co=jc.fieldItem;this.b_=jc.isChart;this.zV=jc.isPpm;this.KUd="supportsImplicitMeasures"in jc?jc.supportsImplicitMeasures:!1;Oa.g(this.$).xo(!0);Cb=de.DOMElementExtensions.getBounds(Cb);Cb=new Sys.UI.Point(Cb.x+Cb.width,Cb.y+Cb.height/2);"isKeyboardInput"in jc&&jc.isKeyboardInput?this.hp(Cb,!1,1):this.hp(Cb,!1);break;case 926905850:this.KUd&&this.co&&5===this.co.TypeTag&&!this.co.IsCollapsible&&V.ULS.sendTraceTag(537167057,0,50,"Add implicit measurement from field list.");
xe.a(this.$).DJ(this.co,8,-1,this.qL,Cb);break;case -67292059:xe.a(this.$).DJ(this.co,1,-1,this.qL,Cb);break;case 745182485:xe.a(this.$).DJ(this.co,2,-1,this.qL,Cb);break;case 359279088:xe.a(this.$).DJ(this.co,4,-1,this.qL,Cb);break;case 547535945:xe.a(this.$).i6i(this.co);break;default:return Sb.a(Ta)}return zb.Task.Ua(!0)};ia.prototype.Ac=function(Ta,Cb,jc){Ta=!1;switch(Cb.command){case 330754562:Ta=!!jc;break;case 926905850:case -67292059:case 745182485:case 359279088:case 547535945:Ta=!0}return Ta};
ia.prototype.UY=function(){var Ta=this.Va.kq(this.menuId);this.G_i(Ta);this.b_||this.isOlap||this.F_i(Ta);return Ta};ia.prototype.G_i=function(Ta){var Cb=this.Va,jc=Cb.Bc(),tc=!1;Yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&(tc=this.isOlap&&!this.zV&&this.KUd&&5===this.co.TypeTag&&!this.co.IsCollapsible);3!==this.co.TypeTag&&37!==this.co.TypeTag||this.co.IsSet?17===this.co.TypeTag||this.zV?(jc.buttons.push(Cb.lb(79)),jc.buttons.push(Cb.lb(this.b_?91:80)),
jc.buttons.push(Cb.lb(this.b_?92:81)),jc.buttons.push(Cb.lb(82))):13===this.co.TypeTag||this.co.IsSet?(jc.buttons.push(Cb.lb(83)),jc.buttons.push(Cb.lb(this.b_?91:80)),jc.buttons.push(Cb.lb(this.b_?92:81)),jc.buttons.push(Cb.lb(86))):(jc.buttons.push(Cb.lb(79)),jc.buttons.push(Cb.lb(this.b_?91:80)),jc.buttons.push(Cb.lb(this.b_?92:81)),jc.buttons.push(Cb.lb(tc?82:86))):(jc.buttons.push(Cb.lb(83)),jc.buttons.push(Cb.lb(this.b_?93:84)),jc.buttons.push(Cb.lb(this.b_?94:85)),jc.buttons.push(Cb.lb(82)));
Ta.pc.push(jc)};ia.prototype.F_i=function(Ta){var Cb=this.Va.Bc();Cb.buttons.push(this.Va.lb(78));Ta.pc.push(Cb)};of.Object.defineProperties(ia.prototype,{xw:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldListContextMenu"}},tB:{configurable:!0,enumerable:!0,get:function(){return Ab.a.HGd}}});Object(ma.a)(ia,"FieldListContextMenu",Db.a,[]);var jf=b(445),df=b(64);ea.prototype.get=function(Ta,Cb,jc){var tc=this.Qag(Ta,"PivotFilterContextMenuCache.Get");return tc&&this.jN[tc]?this.jN[tc][ea.kfd(Cb,
this.$,Ta,jc)]:null};ea.prototype.set=function(Ta,Cb,jc,tc){var kd=this.Qag(Ta,"PivotFilterContextMenuCache.Set");kd&&(this.jN[kd]||(this.jN[kd]={}),this.jN[kd][ea.kfd(Cb,this.$,Ta,tc)]=jc)};ea.prototype.O7b=function(Ta){Ta in this.jN&&this.jN[Ta]&&(this.jN[Ta]=null)};ea.prototype.Qag=function(Ta,Cb){return df.f(this.$.pa)?this.$.activeItemName:(Ta=this.IOj(Ta,Cb))?Ta.Ld:null};ea.prototype.IOj=function(Ta,Cb){Ta=oc.C(Ta);Ta=Oa.g(this.$).Ea.nva(Ta,this.$.activeItemName);V.ULS.shipAssertTag(537167008,
0,!!Ta,"PivotFilterContextMenuBase.TryGetBlockModelProxyFromCell: Can't query the menuCache as block wasn't found in the BlockManager (returned null). Called from: "+Cb);return Ta};ea.kfd=function(Ta,Cb,jc,tc){return Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&0===tc?Cb.pa.index+"_"+Ta.id+"_"+jc.FirstRow.toString()+"_"+jc.FirstColumn.toString():Cb.pa.index+"_"+Ta.id};Object(ma.a)(ea,"PivotFilterContextMenuCache",null,[]);Object(ma.a)(P,"ShowPivotFilterData",null,[]);var Be=
b(499),Sd=b(1505),vc=b(53),qd=Ab.a.SBe,Jd=Db.a;$k(X,Jd);X.prototype.m$c=function(Ta,Cb){var jc=this,tc=Ta.rawEvent,kd=Ta.cell,Rd=Ta.requiresConfirmation;Be.a(this.$).ux(Rd,function(pe){if(pe){pe=tc?new Sys.UI.DomEvent(tc):null;jc.pivotData=new P;jc.pivotData.pivotName=Ta.pivotName;jc.pivotData.dataSourceIndex=Ta.dataSourceIndex;jc.pivotData.cell=kd;jc.pivotData.so=Ta.optionalPivotMenuAnchorParameter;if(jc.pivotData.so&&0<jc.pivotData.so.AnchorType){jc.Emc=Ta.objectId;jc.iEb=Ta.objectVersion;var le=
jc.pivotData.so.AnchorType;if(4===le||5===le||6===le||11===le||9===le||10===le||8===le)jc.Dmb=Ta.location}else jc.Pyd=jc.Emc=null,jc.Qyd=jc.iEb=-1;Oa.g(jc.$).xo(!0);jc.$.Oj(kd);jc.M0(pe,pe?pe.target:Ta.domElement,jc.pivotData,Cb,jc.fMa())}});return!0};X.prototype.M0=function(Ta,Cb,jc,tc){var kd=this;if(Object(jf.a)(P,jc)){this.pivotData=jc;this.B5b=Cb;this.Bjf=Ta;this.A2b=this.pivotData.so?this.pivotData.so.AnchorValue1:-1;this.sY=this.pivotData.so?this.pivotData.so.AnchorType:0;var Rd=!1,pe=null;
pe=X.jN.get(this.pivotData.cell,Cb,this.sY);Rd=!!pe;var le=!0;switch(this.sY){case 4:case 5:case 6:this.Fza=new Sys.UI.Point(this.Dmb.x,this.Dmb.y);le=!1;break;case 7:var Wd=Sys.UI.DomElement.getBounds(Cb);le=Wd.x+(0<=Wd.x?0:Wd.width);Wd=Wd.y+(0<=Wd.y?0:Wd.height);this.Fza=new Sys.UI.Point(0<=le?le:0,0<=Wd?Wd:0);le=!1;break;case 8:case 10:case 9:case 11:this.Fza=new Sys.UI.Point(this.Dmb.x,this.Dmb.y);break;default:this.Fza=null}Rd&&this.Emc===this.Pyd&&this.iEb===this.Qyd&&this.A2b===this.Mxe&&this.sY===
this.Rpe?(V.ULS.sendTraceTag(537167042,0,50,"PivotFilterContextMenuBase.ShowDropDown: rendering pivot filter context menu from menu cache"),this.asb=pe,this.Fza?this.hp(this.Fza,this.fMa()):this.Sx?(!Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")||Db.a.jnd(this.$,this.pivotData.cell))&&this.hp(Db.a.wdd(this.$,this.pivotData.cell,!1),this.fMa()):Jd.prototype.M0.call(this,Ta,Cb,jc,tc,this.fMa())):1!==X.jPh(Cb)&&(le&&(Cb.parentNode.menuFetchStates=1,this.Kqj(Cb),
this.OYf(!0)),this.$.userOperationManager.Sb(new dc.a(126,0,function(ve,Se,Ve){var Va=kd.$;return $a.q(Va.oa.va,kd.pivotData.cell,kd.pivotData.dataSourceIndex,kd.pivotData.pivotName,Va.domElement.id,Va.isChromeRtl,Va.workbookContext.NovMode,wa.b(ve,kd.RMi),wa.a(Se,kd.QMi),Ve,Cb,kd.pivotData.so)},16),tc))}};X.prototype.RDd=function(Ta){Ta.MenuSectionList.push.apply(Ta.MenuSectionList,kk(this.asb))};X.prototype.Svd=function(Ta,Cb){Ta.parentNode.menuFetchStates=2;this.OYf(!1);if(Cb){if(this.B5b!==Ta||
this.jBi())this.hp(this.Fza,this.fMa());else if(this.Sx&&!this.Fza){if(Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")&&!Db.a.jnd(this.$,this.pivotData.cell))return;this.hp(Db.a.wdd(this.$,this.pivotData.cell,!1),this.fMa())}else Jd.prototype.M0.call(this,this.Bjf,Ta,null,null,this.fMa());this.Pyd=this.Emc;this.Qyd=this.iEb;this.Rpe=this.sY;this.Mxe=this.A2b}};X.prototype.fMa=function(){return 8!==this.sY&&9!==this.sY&&10!==this.sY&&11!==this.sY};X.prototype.jBi=
function(){switch(this.pivotData.so?this.pivotData.so.AnchorType:0){case 1:case 2:case 3:case 4:case 5:case 6:case 7:return!0;default:return!1}};X.prototype.OYf=function(Ta){var Cb=this.B5b;if(Cb){if(Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5041973_FixDropdownImageDisappearing")){var jc=de.DOMElementExtensions.vZ(Cb,"ewaprevsrc","");jc=!!jc&&"null"!==jc}else jc=!!de.DOMElementExtensions.vZ(Cb,"ewaprevsrc","");Ta&&jc||!Ta&&!jc||(Ta?(Cb.setAttribute("ewaprevsrc",Cb.src),Cb.src=vc.a.current.So(98)):
(Ta=de.DOMElementExtensions.vZ(Cb,"ewaprevsrc",""),Cb.src=Ta,Cb.setAttribute("ewaprevsrc",null)))}};X.prototype.Kqj=function(Ta){this.B5b=Ta};X.jPh=function(Ta){var Cb=Ta.parentNode.menuFetchStates;void 0===Cb&&(Ta.parentNode.menuFetchStates=0);return Cb};X.jN=null;Object(ma.a)(X,"PivotFilterContextMenuBase",Db.a,[]);var ld="FieldList"+Ab.a.SBe;$k(U,X);U.prototype.executeCommand=function(Ta,Cb,jc){return this.m$c(jc,Cb)?zb.Task.Ua(!0):Sb.a(Cb.command)};U.prototype.Ac=function(Ta,Cb,jc){return-1065117584===
Cb.command&&!!jc};of.Object.defineProperties(U.prototype,{xw:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldListPivotMenu"}},tB:{configurable:!0,enumerable:!0,get:function(){return Ab.a.dMf}}});Object(ma.a)(U,"FieldListPivotContextMenu",X,[]);var Kd=b(278),re=b(29),ie=b(87),ef=b(949);Object(ma.a)(Q,"PivotValueFieldSettingsApplyData",null,[]);B.Ach="dataFieldCustomLabel";B.bGe="dataFieldSourceLabel";B.PSd="showValueAsSelect";B.NSd="showValueAsBaseFieldSelect";B.OSd="showValueAsBaseItemSelect";
B.XZd="valueFieldsSettingsFieldName";B.Yfg="valueFieldSettingTabs";Object(ma.a)(B,"CssElementIds",null,[]);var Fe=b(118);Object(ma.a)(O,"MacroRecorderPivotFieldShowValueAsParameters",null,[]);L.prototype.getActiveCell=function(){return this.activeCell};Object(ma.a)(L,"MacroRecorderPivotValueFieldSettingAppliedPayload",null,[430]);var bf=b(248);Object(ma.a)(K,"PivotValueFieldShowValueAsApplyData",null,[]);var Oe=b(948),lc=b(43),Fa="<div id='showValueAsControlBody'><label for='"+B.PSd+"' class='"+Fe.a.Dn+
" valueFielsSettingsControlTitle'>{0}</label><div><select size=1 id='"+B.PSd+"' class='"+Fe.a.xC+"'></select></div><div class='showValueAsControlSelectRegion'><label for='"+B.NSd+"'>{1}</label><div><select size=6 id='"+B.NSd+"' class='"+Fe.a.xC+"'></select></div></div><div class='showValueAsControlSelectRegionSeparator'></div><div class='showValueAsControlSelectRegion'><label for='"+B.OSd+"'>{2}</label><div><select size=6 id='"+B.OSd+"' class='"+Fe.a.xC+"'></select></div></div></div>",Kb=bf.a;$k(I,
Kb);I.prototype.Rja=function(){return this.isVisible};I.prototype.Hna=function(Ta){return this.isVisible=Ta};I.prototype.setFocus=function(){de.DOMElementExtensions.setFocus(this.z3.Rp)};I.prototype.render=function(Ta){Ta.appendChild(this.domElement)};I.prototype.dispose=function(){ie.a.oc([this.z3,this.WT,this.vP,this.f6b,this.U0b]);Kb.prototype.dispose.call(this)};I.prototype.qtj=function(Ta){ie.a.oc([this.f6b,this.U0b]);this.z3.clear();for(var Cb=ik(Ta.DataFormatTypes),jc=Cb.next();!jc.done;jc=
Cb.next())jc=jc.value,this.z3.WL(I.tNh(jc),jc.toString(),jc===Ta.SelectedDataFormat);this.f6b=this.je.Td(this.z3.domElement);this.f6b.ka("change",this.kwf);this.WT.clear();Cb=ik(Ta.BaseFieldList);for(jc=Cb.next();!jc.done;jc=Cb.next())jc=jc.value,this.WT.WL(jc.DisplayString,jc.Id.toString(),jc.Id===Ta.SelectedBaseField);this.U0b=this.je.Td(this.z3.domElement);this.U0b.ka("change",this.LHi);this.iF=this.aia.Vrb(this.vP.Rp.parentNode,1E3,null,"",739);this.kwf(null)};I.prototype.HQ=function(Ta){this.z3.HQ(Ta);
this.WT.HQ(Ta);this.vP.HQ(Ta)};I.prototype.kka=function(){this.domElement.innerHTML=String.format(Fa,lb.a.instance.ga(1109),lb.a.instance.ga(1110),lb.a.instance.ga(1111));this.G4d=new Oe.a(de.DOMElementExtensions.getElementById(this.domElement,B.PSd),!1);this.p2d=new Oe.a(de.DOMElementExtensions.getElementById(this.domElement,B.NSd),!1);this.q2d=new Oe.a(de.DOMElementExtensions.getElementById(this.domElement,B.OSd),!1)};I.prototype.OVg=function(Ta){return this.gli||!I.Lbf(Ta)&&!I.Mbf(Ta)?!0:!!this.WT.count};
I.prototype.getValueFieldSettingsShowValueAsBaseItemsInfo=function(){var Ta=this;this.$.userOperationManager.Sb(new dc.a(108,0,function(Cb,jc,tc){var kd=Ta.$.oa.va,Rd=parseInt(Ta.WT.fe.value,10);Cb=wa.b.call(null,Cb,Ta.ONi);var pe=$a.M(kd,Ta.cell,Ta.externalSourceIndex,Ta.so);pe.selectedBaseField=Rd;return $a.g(kd,"GetPivotValueFieldSettingsShowValueAsBaseItems",pe,Cb,jc,tc,null,4)},16),this.Ed)};I.prototype.glf=function(){this.vP.clear();this.WT.fe&&(this.iF.ESa(),this.vP.Rp.style.overflowY="hidden",
this.getValueFieldSettingsShowValueAsBaseItemsInfo())};I.prototype.EOb=function(Ta){var Cb=document.getElementById("WACDialogActionButton");this.ZTj&&Cb&&(Cb.disabled=Ta)};I.tNh=function(Ta){switch(Ta){case 0:return lb.a.instance.ga(1112);case 1:return lb.a.instance.ga(1113);case 2:return lb.a.instance.ga(1114);case 3:return lb.a.instance.ga(1115);case 4:return lb.a.instance.ga(1116);case 5:return lb.a.instance.ga(1117);case 6:return lb.a.instance.ga(1118);case 7:return lb.a.instance.ga(1119);case 8:return lb.a.instance.ga(1121);
case 9:return lb.a.instance.ga(1122);case 10:return lb.a.instance.ga(1123);case 11:return lb.a.instance.ga(1124);case 12:return lb.a.instance.ga(1125);case 13:return lb.a.instance.ga(1126);case 14:return lb.a.instance.ga(1127);default:return""}};I.Lbf=function(Ta){return 11===Ta||12===Ta||14===Ta||13===Ta||4===Ta};I.Mbf=function(Ta){return 1===Ta||3===Ta||2===Ta};of.Object.defineProperties(I.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return lb.a.instance.ga(1108)}},lwb:{configurable:!0,
enumerable:!0,get:function(){var Ta=this.z3.fe?parseInt(this.z3.fe.value,10):-1,Cb=this.WT.fe?parseInt(this.WT.fe.value,10):-1,jc=this.vP.fe?parseInt(this.vP.fe.value,10):-1;return Object(Aa.a)(new K,{SelectedDataFormat:0<=Ta?Ta:-1,SelectedBaseField:Cb,SelectedBaseItem:jc})}},WT:{configurable:!0,enumerable:!0,get:function(){return this.p2d}},vP:{configurable:!0,enumerable:!0,get:function(){return this.q2d}},z3:{configurable:!0,enumerable:!0,get:function(){return this.G4d}}});Object(ma.a)(I,"ShowValueAsControl",
bf.a,[545,6]);Object(ma.a)(G,"PivotValueFieldSummarizeValueByApplyData",null,[]);var gb="<div id='summarizeValuesByControlBody'><label class='"+(Fe.a.Dn+" valueFielsSettingsControlTitle' for='pivotDataFieldSelect'>{0}</label><div id='pivotDataFieldSelectDescription' class='")+(Fe.a.Dn+" summarizeValuesByControlDescription'>{1}</div><div><select class='")+(Fe.a.xC+"' size=6 id='pivotDataFieldSelect' style='width: 100%' "+Ab.a.yG+"='pivotDataFieldSelectDescription'></select></div></div>"),Tb=bf.a;$k(T,
Tb);T.prototype.Rja=function(){return this.isVisible};T.prototype.Hna=function(Ta){return this.isVisible=Ta};T.prototype.setFocus=function(){de.DOMElementExtensions.setFocus(this.$k.Rp)};T.prototype.render=function(Ta){Ta.appendChild(this.domElement)};T.prototype.dispose=function(){ie.a.Ia(this.$k);Tb.prototype.dispose.call(this)};T.prototype.focus=function(){de.DOMElementExtensions.setFocus(this.$k.Rp)};T.prototype.ptj=function(Ta){this.$k.LTd();for(var Cb=ik(Ta.AggregationTypes),jc=Cb.next();!jc.done;jc=
Cb.next()){jc=jc.value;var tc=jc===Ta.SelectedAggregation;this.$k.iUc(T.WIh(jc),jc.toString(),tc,"")}this.$k.Z7c();this.$k.Rp.disabled=Ta.AggregationsDisabled};T.prototype.Fij=function(){this.$k.Gij()};T.prototype.kka=function(){this.domElement.innerHTML=String.format(gb,lb.a.instance.ga(1092),lb.a.instance.ga(1093));this.Gde=new Oe.a(de.DOMElementExtensions.getElementById(this.domElement,T.aHf),!1)};T.WIh=function(Ta){switch(Ta){case 0:return lb.a.instance.ga(1095);case 1:return lb.a.instance.ga(1096);
case 2:return lb.a.instance.ga(1097);case 3:return lb.a.instance.ga(1098);case 4:return lb.a.instance.ga(1099);case 5:return lb.a.instance.ga(1100);case 6:return lb.a.instance.ga(1101);case 7:return lb.a.instance.ga(1102);case 8:return lb.a.instance.ga(1103);case 9:return lb.a.instance.ga(1104);case 10:return lb.a.instance.ga(1105);case 11:return lb.a.instance.ga(1106);default:return""}};of.Object.defineProperties(T.prototype,{lwb:{configurable:!0,enumerable:!0,get:function(){var Ta=this.$k.fe?parseInt(this.$k.fe.value,
10):-1;return Object(Aa.a)(new G,{Aggregation:0<=Ta?Ta:-1})}},title:{configurable:!0,enumerable:!0,get:function(){return lb.a.instance.ga(1107)}},enabled:{configurable:!0,enumerable:!0,get:function(){return!this.$k.Rp.disabled},set:function(Ta){this.$k.Rp.disabled=!Ta}},$k:{configurable:!0,enumerable:!0,get:function(){return this.Gde}}});T.aHf="pivotDataFieldSelect";Object(ma.a)(T,"SummarizeValuesByControl",bf.a,[545,6]);var pc=b(221),Xc=b(505),pd=b(1450),Uc=ef.a;$k(N,Uc);N.prototype.dispose=function(){this.j5c=
this.psb=this.oSa=this.PRc=null;ie.a.Ia(this.Rfa);this.Rfa=null;Uc.prototype.dispose.call(this)};N.prototype.initialize=function(){var Ta="<div id='"+B.bGe+"' class='"+Fe.a.Dn+"'></div><div id='"+B.Ach+"' class='"+Fe.a.Dn+"'><label for='"+B.XZd+"'>{0}</label><input type='text' id='"+B.XZd+"' value='{1}' class='"+Fe.a.xC+" UIFont' /></div><div id='"+B.Yfg+"'></div>";Ta=String.format(Ta,lb.a.instance.ga(1091),re.a.yg(this.Xfg));this.Hb.innerHTML=Ta;this.Ae||(this.A2(),this.Dl());this.kje=[-103190598];
this.J0h();Uc.prototype.initialize.call(this)};N.prototype.close=function(Ta){1===Ta&&(this.o3f=!1);Uc.prototype.close.call(this,Ta)};N.prototype.cIe=function(Ta){this.NQ=Ta;this.domElement.disabled=Ta;for(var Cb=["input","option","select"],jc=0,tc=Cb.length;jc<tc;++jc)for(var kd=this.domElement.getElementsByTagName(Cb[jc]),Rd=0;Rd<kd.length;++Rd)kd[Rd].disabled=Ta};N.prototype.Dl=function(){this.psb=document.getElementById(B.XZd);this.j5c=de.DOMElementExtensions.getElementById(this.Hb,B.bGe);var Ta=
de.DOMElementExtensions.getElementById(this.Hb,B.Yfg);this.PRc=new T(document.createElement("div"));this.oSa=new I(document.createElement("div"),this.$,this.cell,this.so,this.externalSourceIndex,this.Ed,this.aia,!this.isOlap);var Cb;this.Rfa=new pd.a(Ta,(Cb=new nc.a,Cb.add(this.SSa),Cb.add(this.oSa),Cb));this.Rfa.zRf()};N.prototype.bEd=function(){var Ta=new N(this.cell,this.so,this.externalSourceIndex,this.Xfg,this.$,this.Ed,this.aia,this.isOlap,this.zV);Ta.initialize();Ta.qf()};N.prototype.Ofb=function(){var Ta=
new Xc.a;if(!this.o3f)return Ta.isValid=!0,Ta;this.psb.value.length?Ta.isValid=!0:(this.cIe(!0),Ta.error=Wa.a.Xc(1,0,754,769,0,1783218700,"PivotTableValueFieldNoBlank"),this.NQ=!0,this.Ae||(this.Ty.disabled=!0),Ta.isValid=!1);return Ta};N.prototype.q5e=function(){this.NQ=!1;this.Ae||(this.Ty.disabled=!1);this.cIe(!1)};N.prototype.zya=function(Ta){var Cb=new nb.a(2105621672,0,this.$.Jc,30,null);this.$.Ka.Kb(Cb);this.DW(5,Ta.nb,"Number Format");return!0};N.prototype.rn=function(){this.vBa=String.format(lb.a.instance.mb(61),
null);Uc.prototype.rn.call(this)};N.prototype.setFocus=function(){if(this.Ae){var Ta=de.DOMElementExtensions.getElementById(this.Hb,T.aHf);pc.a.$Ac(Ta)}else this.Rfa.setFocus()};N.prototype.Zi=function(){var Ta=this,Cb=this.oSa.lwb,jc=new O(Cb.SelectedDataFormat,Cb.SelectedBaseField,Cb.SelectedBaseItem);return function(){return new L(Ta.externalSourceIndex,Ta.cell,Ta.psb.value,Ta.SSa.lwb.Aggregation,jc)}};N.prototype.Ny=function(){var Ta=this,Cb=Object(Aa.a)(new Q,{PivotValueFieldSummarizeValueByApplyData:this.SSa.lwb,
PivotValueFieldShowValueAsApplyData:this.oSa.lwb,PivotValueFieldTitle:this.psb.value});return function(jc,tc,kd){var Rd=Ta.$.oa.va;jc=wa.b(jc,Ta.AHi);var pe=$a.M(Rd,Ta.cell,Ta.externalSourceIndex,Ta.so);pe.pivotValueFieldSettingsApplyData=Cb;return $a.g(Rd,"ApplyPivotValueFieldSettings",pe,jc,tc,kd,null,0)}};N.prototype.HQ=function(Ta){var Cb=this;this.$.da.Za(40,function(){Cb.oSa.HQ(Ta)})};N.prototype.J0h=function(){var Ta=this;this.$.userOperationManager.Sb(new dc.a(123,0,function(Cb,jc,tc){var kd=
Ta.$.oa.va;Cb=wa.b.call(null,Cb,Ta.NNi);var Rd=$a.M(kd,Ta.cell,Ta.externalSourceIndex,Ta.so);return $a.g(kd,"GetPivotValueFieldSettingsInitial",Rd,Cb,jc,tc,null,4)},16),this.Ed)};of.Object.defineProperties(N.prototype,{mc:{configurable:!0,enumerable:!0,get:function(){return"ValueFieldSettingsDialog"}},Jea:{configurable:!0,enumerable:!0,get:function(){return this.kje}},EDb:{configurable:!0,enumerable:!0,get:function(){return this.Rfa}},SSa:{configurable:!0,enumerable:!0,get:function(){return this.PRc}},
vv:{configurable:!0,enumerable:!0,get:function(){return 560}}});Object(ma.a)(N,"ValueFieldSettingsDialog",ef.a,[]);var sd=Ab.a.x3g,Nb=Db.a;$k(S,Nb);S.prototype.executeCommand=function(Ta,Cb,jc,tc){var kd=this;Ta=Cb.command;switch(Ta){case -1453503574:tc=jc.domElement;this.co=jc.fieldItem;this.h0d=jc.zoneCount;this.zSa=jc.sourceAxis;this.Cyc=jc.sourceAxisPos;this.so=jc.optionalPivotMenuAnchorParameter;this.qL=jc.versionkey;this.isOlap=jc.isOlap;this.zV=jc.isPpm;this.P2a="fieldItemsupportsImplicitMeasures"in
jc?jc.fieldItemsupportsImplicitMeasures:!1;this.cell=jc.cell;this.externalSourceIndex=jc.externalSourceIndex;Oa.g(this.$).xo(!0);tc=de.DOMElementExtensions.getBounds(tc);Ta=new Sys.UI.Point(tc.x,tc.y+tc.height);this.$.isChromeRtl&&(Ta.x+=tc.width);"isKeyboardInput"in jc&&jc.isKeyboardInput?this.hp(Ta,!1,1):this.hp(Ta,!1);break;case 495005930:break;case -1170196828:xe.a(this.$).DJ(this.co,this.zSa,this.Cyc-1,this.qL,Cb);break;case -889576107:xe.a(this.$).DJ(this.co,this.zSa,this.Cyc+2,this.qL,Cb);
break;case 2033235475:xe.a(this.$).DJ(this.co,this.zSa,this.h0d,this.qL,Cb);break;case 389774337:xe.a(this.$).DJ(this.co,this.zSa,0,this.qL,Cb);break;case -96230454:xe.a(this.$).DJ(this.co,4,-1,this.qL,Cb);break;case 74086617:xe.a(this.$).DJ(this.co,1,-1,this.qL,Cb);break;case 1529312473:xe.a(this.$).DJ(this.co,2,-1,this.qL,Cb);break;case 563292088:this.P2a&&V.ULS.sendTraceTag(537167056,0,50,"Move a field into values area as implicit measurement.");xe.a(this.$).DJ(this.co,8,-1,this.qL,Cb);break;case -1092351914:xe.a(this.$).DJ(this.co,
0,-1,this.qL,Cb);break;case -2141589616:var Rd=Ba.GetServiceTaskFactory.Ra(this.$.da,12,477,tc.Kja());return ca.TaskExtensions.Aa(Rd,function(){(new N(kd.cell,kd.so,kd.externalSourceIndex,kd.co.Name,kd.$,Cb,Rd.result,kd.isOlap,kd.zV)).initialize()},this.la);default:return Sb.a(Ta)}return zb.Task.Ua(!0)};S.prototype.Ac=function(Ta,Cb,jc){Ta=!1;switch(Cb.command){case -1453503574:Ta=!!jc;break;case 495005930:case -1170196828:case -889576107:case 2033235475:case 389774337:case -96230454:case 74086617:case 1529312473:case 563292088:case -1092351914:case -2141589616:Ta=
!0}return Ta};S.prototype.UY=function(){var Ta=this.Va.kq(this.menuId);this.N_i(Ta,this.Cyc,this.h0d);this.O_i(Ta,this.zSa);this.P_i(Ta);8===this.zSa&&this.L_i(Ta);return Ta};S.prototype.N_i=function(Ta,Cb,jc){var tc=this.Va,kd=tc.Bc();Cb||Cb!==jc-1?!Cb&&Cb<jc-1?(kd.buttons.push(tc.lb(64)),kd.buttons.push(tc.lb(61)),kd.buttons.push(tc.lb(66)),kd.buttons.push(tc.lb(63))):0<Cb&&Cb<jc-1?(kd.buttons.push(tc.lb(60)),kd.buttons.push(tc.lb(61)),kd.buttons.push(tc.lb(62)),kd.buttons.push(tc.lb(63))):0<Cb&&
Cb===jc-1&&(kd.buttons.push(tc.lb(60)),kd.buttons.push(tc.lb(65)),kd.buttons.push(tc.lb(62)),kd.buttons.push(tc.lb(67))):(kd.buttons.push(tc.lb(64)),kd.buttons.push(tc.lb(65)),kd.buttons.push(tc.lb(66)),kd.buttons.push(tc.lb(67)));Ta.pc.push(kd)};S.prototype.O_i=function(Ta,Cb){var jc=this.Va,tc=jc.Bc(),kd=1!==Cb&&(!this.isOlap||this.zV||8!==Cb||this.P2a),Rd=2!==Cb&&(!this.isOlap||this.zV||8!==Cb||this.P2a),pe=8!==Cb&&-2!==this.co.PivotTableIndex&&(!this.isOlap||this.zV||this.P2a);tc.buttons.push(jc.lb(4===
Cb||this.co.IsSet||-2===this.co.PivotTableIndex||this.isOlap&&!this.zV&&8===Cb&&!this.P2a?72:68));8===this.so.AnchorType||10===this.so.AnchorType?(tc.buttons.push(jc.lb(kd?95:97)),tc.buttons.push(jc.lb(Rd?96:98))):(tc.buttons.push(jc.lb(kd?69:73)),tc.buttons.push(jc.lb(Rd?70:74)));tc.buttons.push(jc.lb(pe?71:75));Ta.pc.push(tc)};S.prototype.P_i=function(Ta){var Cb=this.Va.Bc();Cb.buttons.push(this.Va.lb(76));Ta.pc.push(Cb)};S.prototype.L_i=function(Ta){var Cb=this.Va.Bc();Cb.buttons.push(this.Va.lb(77));
Ta.pc.push(Cb)};of.Object.defineProperties(S.prototype,{xw:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldWellContextMenu"}},tB:{configurable:!0,enumerable:!0,get:function(){return Ab.a.IGd}}});Object(ma.a)(S,"FieldWellContextMenu",Db.a,[]);var Ja=b(1428);$k(J,X);J.prototype.executeCommand=function(Ta,Cb,jc){var tc=!1,kd=Cb.command;switch(kd){case 37023044:tc=this.m$c(jc,Cb);break;case 541421805:case -569786022:tc=this.Hid(Ta,Cb)}return tc?zb.Task.Ua(!0):Sb.a(kd)};J.prototype.Ac=
function(Ta,Cb,jc){Ta=!1;switch(Cb.command){case 37023044:Ta=!!jc;break;case 541421805:case -569786022:Ta=!0}return Ta};J.prototype.Hid=function(Ta,Cb){var jc=8===Ta,tc=this.$,kd=Je.a(tc),Rd=Oa.g(tc).ha.Oa.Yb,pe=Ta=null;jc&&kd?(Ta=kd.chartId,pe=kd.Pc):!jc&&Rd&&(Ta=Rd.floatingObject.id,pe=Rd.floatingObject.Pc);return J.Rre(pe,260)?(jc={},tc.Oj(jc),jc.FirstColumn=jc.FirstRow=-1,tc={},pe=(tc.rawEvent=null,tc.pivotName=null,tc.cell=jc,tc.requiresConfirmation=J.Rre(pe,64),tc.dataSourceIndex=pe.ExternalSourceIndex,
tc),Rd?(kd=Rd.floatingObject,pe.domElement=Rd.domElement,pe.objectId=kd.id,pe.objectVersion=kd.version):kd&&(pe.domElement=kd.pl,pe.objectId=kd.chartId,pe.objectVersion=kd.Oxe),Rd={AnchorType:7},Rd.ChartId=Ta,Rd.AnchorValue1=-1,Rd.AnchorValue2=-1,pe.optionalPivotMenuAnchorParameter=Rd,this.m$c(pe,Cb)):!1};J.Rre=function(Ta,Cb){return(Ta.Attributes&Cb)===Cb};of.Object.defineProperties(J.prototype,{xw:{configurable:!0,enumerable:!0,get:function(){return"PopulatePivotContextMenu"}},tB:{configurable:!0,
enumerable:!0,get:function(){return Ab.a.jMf}}});Object(ma.a)(J,"PivotFilterContextMenu",X,[]);var Lb=b(1503),ec=b(1058),Zb=b(154),Oc=b(394),td=b(259),Gd=b(28),Pd=b(22),ee=Ab.a.B3g,Ec=ee+".RemoveField",$c=ee+".Subtotal",id=ee+".ClearFilter",vd=ee+".LayoutSameColumn",he=ee+".LayoutNextColumn",Ge=Db.a;$k(F,Ge);F.prototype.executeCommand=function(Ta,Cb,jc){Cb=Cb.command;Ta=null;this.grid=Oa.g(this.$);this.activeCell=oc.o(this.grid.ha.sa.activeCell,this.$);if(this.$.isEditMode&&(this.rc=this.grid.Ab.Ro(this.grid.ha.sa.activeCell),
!this.rc))return V.ULS.sendTraceTag(537167007,0,10,"No PivotTable range found."),ca.TaskExtensions.eba();this.M_d=this.$.oa.va;this.E0a=Object(Ob.a)(rd.a,jc.eventArgs);switch(Cb){case 671488277:this.mzj()?this.dVh():(this.Tbb(),this.showPivotTableContextMenu());break;case 1801458190:this.performPivotTableOperation(1801458190,1);break;case -2016405815:this.performPivotTableOperation(-2016405815,6);break;case 671485366:this.performPivotTableOperation(671485366,7);break;case 772221736:this.performPivotTableOperation(772221736,
8);break;case 1600778266:this.performPivotTableOperation(1600778266,2);break;case -556893687:this.performPivotTableOperation(-556893687,3);break;case -1966978671:this.performPivotTableOperation(-1966978671,4);break;case -1951357930:this.performPivotTableOperation(-1951357930,5);break;case -1390365353:this.performPivotTableOperation(-1390365353,9);break;case -1457478532:this.performPivotTableOperation(-1457478532,10);break;case -771066011:this.Tz.PivotValueFieldSummarizeValueByApplyData.Aggregation=
2;this.applyValueFieldSettingsToPivotTable(-771066011,!0);break;case 1746132849:this.Tz.PivotValueFieldSummarizeValueByApplyData.Aggregation=1;this.applyValueFieldSettingsToPivotTable(1746132849,!0);break;case 1475494885:this.Tz.PivotValueFieldSummarizeValueByApplyData.Aggregation=6;this.applyValueFieldSettingsToPivotTable(1475494885);break;case 376946683:this.Tz.PivotValueFieldSummarizeValueByApplyData.Aggregation=11;this.applyValueFieldSettingsToPivotTable(376946683,!0);break;case 835007294:this.Tz.PivotValueFieldSummarizeValueByApplyData.Aggregation=
3;this.applyValueFieldSettingsToPivotTable(835007294,!0);break;case 929115636:this.Tz.PivotValueFieldSummarizeValueByApplyData.Aggregation=4;this.applyValueFieldSettingsToPivotTable(929115636,!0);break;case 1935475057:this.Tz.PivotValueFieldSummarizeValueByApplyData.Aggregation=5;this.applyValueFieldSettingsToPivotTable(1935475057,!0);break;case 588680636:this.Tz.PivotValueFieldSummarizeValueByApplyData.Aggregation=7;this.applyValueFieldSettingsToPivotTable(588680636);break;case -910892852:this.Tz.PivotValueFieldSummarizeValueByApplyData.Aggregation=
8;this.applyValueFieldSettingsToPivotTable(-910892852);break;case -1255320719:this.Tz.PivotValueFieldSummarizeValueByApplyData.Aggregation=0;this.applyValueFieldSettingsToPivotTable(-1255320719,!0);break;case 1668427539:this.Tz.PivotValueFieldSummarizeValueByApplyData.Aggregation=9;this.applyValueFieldSettingsToPivotTable(1668427539);break;case -1751371357:this.Tz.PivotValueFieldSummarizeValueByApplyData.Aggregation=10;this.applyValueFieldSettingsToPivotTable(-1751371357);break;case -841863025:this.PRa(0,
0);this.applyValueFieldSettingsToPivotTable(-841863025);break;case -178796371:this.PRa(7,0);this.applyValueFieldSettingsToPivotTable(-178796371);break;case 786592977:this.PRa(6,0);this.applyValueFieldSettingsToPivotTable(786592977);break;case 767774849:this.PRa(5,0);this.applyValueFieldSettingsToPivotTable(767774849);break;case 282586693:this.PRa(9,0);this.applyValueFieldSettingsToPivotTable(282586693);break;case -1067664355:this.PRa(10,0);this.applyValueFieldSettingsToPivotTable(-1067664355);break;
case -2031744961:jc=Number.parseInvariant(jc.MenuItemId.split(".")[2]);this.PRa(11,jc);this.applyValueFieldSettingsToPivotTable(-2031744961);break;case -1007663920:this.applyPivotSort(1);break;case 234234584:this.applyPivotSort(2);break;case 1194992911:this.$.Cd(-1556797033,vb.a.Cb,8,null);break;case 1514686611:this.Asi();break;case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:jc=Number.parseInvariant(jc.MenuItemId);this.FZg(jc);break;case 1778578888:jc=Number.parseInvariant(jc.MenuItemId);
this.JLg(jc);break;case 2059542618:this.performPivotTableOperation(2059542618,11);break;case 713270357:this.performPivotTableOperation(713270357,12);break;case -1842411134:this.performPivotTableOperation(-1842411134,13);break;case 2054968064:this.performPivotTableOperation(2054968064,14);break;default:Ta=Sb.a(Cb)}return Ta||ca.TaskExtensions.eba()};F.prototype.Ac=function(Ta,Cb){Ta=!1;switch(Cb.command){case 671488277:Ta=ec.f(this.grid);break;case 1801458190:case -2016405815:case 671485366:case 772221736:Ta=
!0;break;case 1600778266:Ta=!0;break;case -556893687:Ta=!0;break;case -1966978671:Ta=!0;break;case -1951357930:Ta=!0;break;case -1390365353:case -1457478532:Ta=!0;break;case -249874296:case -771066011:case 1746132849:case 1475494885:case 376946683:case 835007294:case 929115636:case 1935475057:case 588680636:case -910892852:case -1255320719:case 1668427539:case -1751371357:Ta=!0;break;case -1128612833:case -841863025:case -178796371:case 767774849:case 786592977:case 282586693:case -1067664355:case -2031744961:Ta=
!0;break;case -1007663920:case 234234584:case 1194992911:Ta=!0;break;case 1514686611:case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:case 1778578888:Ta=!0;break;case 2059542618:case 713270357:case -1842411134:case 2054968064:Ta=Yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)}return Ta};F.prototype.mzj=function(){if(!this.$.isEditMode||this.rc.Egc)return!1;var Ta=this.l2f(!1);return Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:6214209_EnableFullRightClickMenuForExtNativePT")?
!this.rc.isOlap||Ta:!this.rc.qpd()||Ta};F.prototype.Nc=function(Ta,Cb){var jc=!1;switch(Cb){case -249874296:case -1128612833:case 1801458190:case -1951357930:case -1390365353:case -1457478532:case 1600778266:case -556893687:case -1966978671:case 1514686611:case 1778578888:jc=this.dS();break;case -1007663920:case 234234584:jc=this.Uxj()||this.dS();break;case 1194992911:jc=this.Vxj()||this.dS();break;case 1217404289:jc=!Lb.j(this.rb.LabelOrDateFilterType)||this.dS();break;case -743135194:jc=!Lb.m(this.rb.ValueFilterType)&&
!Lb.l(this.rb.ValueFilterType)||this.dS();break;case 771421327:jc=0===this.rb.LabelOrDateFilterType&&0===this.rb.ValueFilterType&&!this.rb.HasManualFilter||this.dS();break;case 1015867427:jc=!Lb.i(this.rb.LabelOrDateFilterType)||this.dS();break;case 1105960559:jc=!Lb.k(this.rb.LabelOrDateFilterType)||this.dS()}return jc||Ge.prototype.Nc.call(this,Ta,Cb)};F.prototype.Tbb=function(){this.kab=this.rb=this.De=null};F.prototype.wUd=function(){this.grid.nP(this.Bq);this.$.Ka.OYa(this.cy)};F.prototype.gYd=
function(){this.grid.LK(this.Bq);this.$.Ka.QIb(this.cy)};F.prototype.cLb=function(){if(this.rc&&this.rc.Go){this.De=this.rc.Go;this.rb=this.rc.abc();if(this.a3f()){var Ta=this.rc.TK[4===this.De.CellType?this.rc.l5c-1:this.De.CurrentFieldIndex-1];Ta&&(this.kab=-2===Ta.Index?this.rc.gGe:Ta.Caption)}this.mai();this.rb&&8===this.De.CellArea&&(this.Tz.PivotValueFieldSummarizeValueByApplyData.Aggregation=this.rb.DataFieldAggregationType,this.Tz.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=this.rb.DataFieldFormatType,
this.Tz.PivotValueFieldShowValueAsApplyData.SelectedBaseField=this.rb.BaseFieldIndex,this.Tz.PivotValueFieldTitle=this.rb.Caption)}};F.prototype.l2f=function(Ta){return this.rc?this.rc.isOlap&&!this.rc.z7a(!Ta):!1};F.prototype.byj=function(){var Ta=Yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1);return 1!==this.rb.MeasureType&&(!this.rc.sgf||Ta&&2===this.rb.MeasureType)};F.prototype.UY=function(){var Ta=this.Va.kq(this.menuId),Cb=this.Va.Bc(),jc=Oa.g(this.$).Ub(null);
if(this.rc)this.De&&this.rc.Go&&this.De!==this.rc.Go&&V.ULS.shipAssertTag(537167006,0,!1,"CurrentCellInfo is out of sync with cell info from PivotTable Range"),this.rb&&this.rb!==this.rc.abc()&&V.ULS.shipAssertTag(537167005,0,!1,"CurrentField is out of sync with field from PivotTable Range");else return Ta;this.hGh(Ta);if(this.$.isEditMode){this.refresh&&this.yHh(Ta);if(this.De&&this.rb){var tc=this.Va.Bc();this.NHh(tc);this.wGh(tc);Ta.pc.push(tc)}this.lZ&&Cb.buttons.push(this.Va.lb(99));this.De&&
this.rb&&this.UGh(Ta);if(this.expandCollapse){tc=this.Va.Tv("ContextMenu.PivotExpandCollapse",null,lb.a.instance.ga(1156),589118293);var kd=this.Va.Bc();kd.buttons.push(this.Va.lb(243));kd.buttons.push(this.Va.lb(244));kd.buttons.push(this.Va.lb(245));kd.buttons.push(this.Va.lb(246));tc.menu.pc.push(kd);tc&&0<kd.buttons.length&&Cb.buttons.push(tc)}this.De&&(tc=this.Va.Bc(),Yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)&&this.eHh(tc),this.zHh(tc),0<tc.buttons.length&&
Ta.pc.push(tc));this.De&&this.rb&&8===this.De.CellArea&&8!==this.De.CellType&&(tc=this.Va.Bc(),this.byj()&&this.PHh(tc),3!==this.De.CellType&&this.KHh(tc),Ta.pc.push(tc));!this.rc.isOlap&&""!==(null===jc||void 0===jc?void 0:jc.text)&&this.De&&0===this.De.CellType&&Yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)&&this.JHh(Ta);this.Rli()?Cb.buttons.push(this.Va.lb(257)):Cb.buttons.push(this.Va.lb(258));this.cod?Cb.buttons.push(this.Va.lb(59)):Cb.buttons.push(this.Va.lb(58))}Ta.pc.push(Cb);
return Ta};F.prototype.JRd=function(){return this.rb&&this.rb.Caption?20<this.rb.Caption.length:!1};F.prototype.ced=function(Ta){return this.rb&&this.rb.Caption?Ta?this.rb.Caption.substring(0,20)+"...":this.rb.Caption:""};F.prototype.ova=function(Ta){return Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5548525_FixLoggingColumnNameInButtonId")?Pd.a.hashCode(Ta).toString():Ta};F.prototype.NHh=function(Ta){if(this.De&&this.rb&&4!==this.De.CellArea){var Cb=this.pja(this.$G("PivotTableContextMenu.Sort",
this.ova(this.rb.Caption)),-1777747317,0,0!==this.rb.SortInfo,lb.a.instance.ga(229)),jc=this.Va.Bc();jc.buttons.push(this.Od("PivotTableContextMenu.SortAscending",-1007663920,0,1===this.rb.SortInfo,lb.a.instance.ga(230)));jc.buttons.push(this.Od("PivotTableContextMenu.SortDescending",234234584,0,2===this.rb.SortInfo,lb.a.instance.ga(231)));1!==this.De.CellArea&&2!==this.De.CellArea||jc.buttons.push(this.Od("PivotTableContextMenu.SortByValue",1194992911,0,3===this.rb.SortInfo||4===this.rb.SortInfo,
lb.a.instance.ga(156)));Cb.menu.pc.push(jc);Cb&&0<jc.buttons.length&&Ta.buttons.push(Cb)}};F.prototype.wGh=function(Ta){if(this.De&&this.rb&&(1===this.De.CellArea||2===this.De.CellArea)){var Cb=this.lzj(),jc=this.pja(this.$G("PivotTableContextMenu.Filter",this.ova(this.rb.Caption)),-1777747317,0,Cb,lb.a.instance.ga(654)),tc=this.Va.Bc(),kd="",Rd=this.JRd(),pe=String.format(lb.a.instance.mb(156),this.ced(Rd));Rd&&(kd=String.format(lb.a.instance.mb(156),this.rb.Caption));Cb=this.ova(this.rb.Caption)+
"."+(Cb?"enabled":"disabled");kd=this.Od(this.$G(id,Cb),771421327,0,!1,pe,"0",kd,8,ic.a.B2a);Cb=this.ova(this.rb.Caption)+"."+this.rb.LabelOrDateFilterType.toString();this.rb.IsDateField?(pe=this.pja(this.$G("PivotTableContextMenu.DateFilter",Cb),-1777747317,0,0!==this.rb.LabelOrDateFilterType,lb.a.instance.ga(97)),this.kGh(pe.menu)):(pe=this.pja(this.$G("PivotTableContextMenu.LabelFilter",Cb),-1777747317,0,0!==this.rb.LabelOrDateFilterType,lb.a.instance.ga(652)),this.TGh(pe.menu));Cb=this.ova(this.rb.Caption)+
"."+this.rb.ValueFilterType.toString();Cb=this.pja(this.$G("PivotTableContextMenu.ValueFilter",Cb),-1777747317,0,0!==this.rb.ValueFilterType,lb.a.instance.ga(653));this.aIh(Cb.menu);Rd=this.Va.Bc();Rd.buttons.push(this.Od("PivotTableContextMenu.ManualFilter",1514686611,0,this.rb.HasManualFilter,lb.a.instance.ga(94)));tc.buttons.push(kd);tc.buttons.push(pe);tc.buttons.push(Cb);jc.menu.pc.push(tc);jc.menu.pc.push(Rd);jc&&0<tc.buttons.length&&Ta.buttons.push(jc)}};F.prototype.kGh=function(Ta){Ta.pc.push(this.ybc(!0,
!1));Ta.pc.push(this.xNh());Ta.pc.push(this.wNh());Ta.pc.push(this.oPh());Ta.pc.push(this.rPh());Ta.pc.push(this.pPh());Ta.pc.push(this.qPh());Ta.pc.push(this.sPh());Ta.pc.push(this.tPh());Ta.pc.push(this.kNh())};F.prototype.$Fh=function(Ta){Ta.pc.push(this.ybc(!0,!0));Ta.pc.push(this.cWh());Ta.pc.push(this.nTh())};F.prototype.TGh=function(Ta){Ta.pc.push(this.ybc(!0,!1));Ta.pc.push(this.VYe(!0));Ta.pc.push(this.UJh());Ta.pc.push(this.uMh());Ta.pc.push(this.VXe(!0));Ta.pc.push(this.cXe(!0))};F.prototype.aIh=
function(Ta){Ta.pc.push(this.ybc(!1,!1));Ta.pc.push(this.VYe(!1));Ta.pc.push(this.VXe(!1));Ta.pc.push(this.cXe(!1));Ta.pc.push(this.E_h())};F.prototype.E_h=function(){var Ta=this.Va.Bc();Ta.buttons.push(this.Od("PivotTableContextMenu.Top10",-1611233597,0,Lb.l(this.rb.ValueFilterType),lb.a.instance.ga(105)));return Ta};F.prototype.uMh=function(){var Ta=this.Va.Bc();this.rb&&(Ta.buttons.push(this.Od("PivotTableContextMenu.Contains",786260386,0,10===this.rb.LabelOrDateFilterType,lb.a.instance.ga(655),
"10")),Ta.buttons.push(this.Od("PivotTableContextMenu.DoesNotContain",786260386,0,11===this.rb.LabelOrDateFilterType,lb.a.instance.ga(656),"11")));return Ta};F.prototype.UJh=function(){var Ta=this.Va.Bc();this.rb&&(Ta.buttons.push(this.Od("PivotTableContextMenu.BeginsWith",786260386,0,6===this.rb.LabelOrDateFilterType,lb.a.instance.ga(657),"6")),Ta.buttons.push(this.Od("PivotTableContextMenu.DoesNotBeginWith",786260386,0,7===this.rb.LabelOrDateFilterType,lb.a.instance.ga(658),"7")),Ta.buttons.push(this.Od("PivotTableContextMenu.EndsWith",
786260386,0,8===this.rb.LabelOrDateFilterType,lb.a.instance.ga(659),"8")),Ta.buttons.push(this.Od("PivotTableContextMenu.DoesNotEndWith",786260386,0,9===this.rb.LabelOrDateFilterType,lb.a.instance.ga(660),"9")));return Ta};F.prototype.VYe=function(Ta){var Cb=this.Va.Bc();if(this.rb){var jc=Ta?Lb.c:Lb.f;Cb.buttons.push(this.Od(this.$G("PivotTableContextMenu.Equals",jc),786260386,0,Ta?4===this.rb.LabelOrDateFilterType:18===this.rb.ValueFilterType,lb.a.instance.ga(100),Ta?"4":"18"));Cb.buttons.push(this.Od(this.$G("PivotTableContextMenu.DoesNotEqual",
jc),786260386,0,Ta?5===this.rb.LabelOrDateFilterType:19===this.rb.ValueFilterType,lb.a.instance.ga(101),Ta?"5":"19"))}return Cb};F.prototype.VXe=function(Ta){var Cb=this.Va.Bc();if(this.rb){var jc=Ta?Lb.c:Lb.f;Cb.buttons.push(this.Od(this.$G("PivotTableContextMenu.GreaterThan",jc),786260386,0,Ta?12===this.rb.LabelOrDateFilterType:20===this.rb.ValueFilterType,lb.a.instance.ga(102),Ta?"12":"20"));Cb.buttons.push(this.Od(this.$G("PivotTableContextMenu.GreaterThanOrEqualTo",jc),786260386,0,Ta?13===this.rb.LabelOrDateFilterType:
21===this.rb.ValueFilterType,lb.a.instance.ga(661),Ta?"13":"21"));Cb.buttons.push(this.Od(this.$G("PivotTableContextMenu.LessThan",jc),786260386,0,Ta?14===this.rb.LabelOrDateFilterType:22===this.rb.ValueFilterType,lb.a.instance.ga(103),Ta?"14":"22"));Cb.buttons.push(this.Od(this.$G("PivotTableContextMenu.LessThanOrEqualTo",jc),786260386,0,Ta?15===this.rb.LabelOrDateFilterType:23===this.rb.ValueFilterType,lb.a.instance.ga(662),Ta?"15":"23"))}return Cb};F.prototype.cXe=function(Ta){var Cb=this.Va.Bc();
if(this.rb){var jc=Ta?Lb.c:Lb.f;Cb.buttons.push(this.Od(this.$G("PivotTableContextMenu.Between",jc),786260386,0,Ta?16===this.rb.LabelOrDateFilterType:24===this.rb.ValueFilterType,lb.a.instance.ga(104),Ta?"16":"24"));Cb.buttons.push(this.Od(this.$G("PivotTableContextMenu.NotBetween",jc),786260386,0,Ta?17===this.rb.LabelOrDateFilterType:25===this.rb.ValueFilterType,lb.a.instance.ga(663),Ta?"17":"25"))}return Cb};F.prototype.ybc=function(Ta,Cb){var jc=this.Va.Bc();if(this.rb){var tc=lb.a.instance.ga(98),
kd=Ta?this.rb.LabelOrDateFilterType.toString():this.rb.ValueFilterType.toString(),Rd=["PivotTableContextMenu.ClearFilter",this.ova(this.rb.Caption),kd];Ta=Ta?this.rb.IsDateField?Cb?1015867427:1105960559:1217404289:-743135194;Rd.push(Ta.toString());Rd=Rd.join(".");tc=this.Od(Rd,Ta,0,!1,tc,kd,tc,8,ic.a.B2a);jc.buttons.push(tc)}return jc};F.prototype.xNh=function(){var Ta=this.Va.Bc();this.rb&&Ta.buttons.push(this.Od(this.$G("PivotTableContextMenu.Equals",Lb.d),786260386,0,26===this.rb.LabelOrDateFilterType,
lb.a.instance.ga(100),"26"));return Ta};F.prototype.wNh=function(){var Ta=this.Va.Bc();this.rb&&(Ta.buttons.push(this.Od("PivotTableContextMenu.Before",786260386,0,27===this.rb.LabelOrDateFilterType,lb.a.instance.ga(112),"27")),Ta.buttons.push(this.Od("PivotTableContextMenu.After",786260386,0,28===this.rb.LabelOrDateFilterType,lb.a.instance.ga(113),"28")),Ta.buttons.push(this.Od("PivotTableContextMenu.Between",786260386,0,29===this.rb.LabelOrDateFilterType,lb.a.instance.ga(104),"29")));return Ta};
F.prototype.oPh=function(){var Ta=this.Va.Bc();this.rb&&(Ta.buttons.push(this.Od("PivotTableContextMenu.Tomorrow",1778578888,0,30===this.rb.LabelOrDateFilterType,lb.a.instance.ga(110),"30")),Ta.buttons.push(this.Od("PivotTableContextMenu.Today",1778578888,0,31===this.rb.LabelOrDateFilterType,lb.a.instance.ga(109),"31")),Ta.buttons.push(this.Od("PivotTableContextMenu.Yesterday",1778578888,0,32===this.rb.LabelOrDateFilterType,lb.a.instance.ga(111),"32")));return Ta};F.prototype.rPh=function(){var Ta=
this.Va.Bc();this.rb&&(Ta.buttons.push(this.Od("PivotTableContextMenu.NextWeek",1778578888,0,33===this.rb.LabelOrDateFilterType,lb.a.instance.ga(115),"33")),Ta.buttons.push(this.Od("PivotTableContextMenu.ThisWeek",1778578888,0,34===this.rb.LabelOrDateFilterType,lb.a.instance.ga(114),"34")),Ta.buttons.push(this.Od("PivotTableContextMenu.LastWeek",1778578888,0,35===this.rb.LabelOrDateFilterType,lb.a.instance.ga(116),"35")));return Ta};F.prototype.pPh=function(){var Ta=this.Va.Bc();this.rb&&(Ta.buttons.push(this.Od("PivotTableContextMenu.NextMonth",
1778578888,0,36===this.rb.LabelOrDateFilterType,lb.a.instance.ga(117),"36")),Ta.buttons.push(this.Od("PivotTableContextMenu.ThisMonth",1778578888,0,37===this.rb.LabelOrDateFilterType,lb.a.instance.ga(118),"37")),Ta.buttons.push(this.Od("PivotTableContextMenu.LastMonth",1778578888,0,38===this.rb.LabelOrDateFilterType,lb.a.instance.ga(119),"38")));return Ta};F.prototype.qPh=function(){var Ta=this.Va.Bc();this.rb&&(Ta.buttons.push(this.Od("PivotTableContextMenu.NextQuarter",1778578888,0,39===this.rb.LabelOrDateFilterType,
lb.a.instance.ga(120),"39")),Ta.buttons.push(this.Od("PivotTableContextMenu.ThisQuarter",1778578888,0,40===this.rb.LabelOrDateFilterType,lb.a.instance.ga(121),"40")),Ta.buttons.push(this.Od("PivotTableContextMenu.LastQuarter",1778578888,0,41===this.rb.LabelOrDateFilterType,lb.a.instance.ga(122),"41")));return Ta};F.prototype.sPh=function(){var Ta=this.Va.Bc();this.rb&&(Ta.buttons.push(this.Od("PivotTableContextMenu.NextYear",1778578888,0,42===this.rb.LabelOrDateFilterType,lb.a.instance.ga(123),"42")),
Ta.buttons.push(this.Od("PivotTableContextMenu.ThisYear",1778578888,0,43===this.rb.LabelOrDateFilterType,lb.a.instance.ga(124),"43")),Ta.buttons.push(this.Od("PivotTableContextMenu.LastYear",1778578888,0,44===this.rb.LabelOrDateFilterType,lb.a.instance.ga(125),"44")));return Ta};F.prototype.tPh=function(){var Ta=this.Va.Bc();if(this.rb){Ta.buttons.push(this.Od("PivotTableContextMenu.YearToDate",1778578888,0,45===this.rb.LabelOrDateFilterType,lb.a.instance.ga(126),"45"));var Cb=this.pja("PivotTableContextMenu.AllDatesInThePeriod",
1778578888,0,Lb.i(this.rb.LabelOrDateFilterType),lb.a.instance.ga(127));this.$Fh(Cb.menu);Ta.buttons.push(Cb)}return Ta};F.prototype.kNh=function(){var Ta=this.Va.Bc();this.rb&&Ta.buttons.push(this.Od("PivotTableContextMenu.CustomFilter",786260386,0,this.izj(this.rb.LabelOrDateFilterType),lb.a.instance.ga(108),"26"));return Ta};F.prototype.cWh=function(){var Ta=this.Va.Bc();this.rb&&(Ta.buttons.push(this.Od("PivotTableContextMenu.Quarter1",1778578888,0,46===this.rb.LabelOrDateFilterType,lb.a.instance.ga(128),
"46")),Ta.buttons.push(this.Od("PivotTableContextMenu.Quarter2",1778578888,0,47===this.rb.LabelOrDateFilterType,lb.a.instance.ga(129),"47")),Ta.buttons.push(this.Od("PivotTableContextMenu.Quarter3",1778578888,0,48===this.rb.LabelOrDateFilterType,lb.a.instance.ga(130),"48")),Ta.buttons.push(this.Od("PivotTableContextMenu.Quarter4",1778578888,0,49===this.rb.LabelOrDateFilterType,lb.a.instance.ga(131),"49")));return Ta};F.prototype.nTh=function(){var Ta=this.Va.Bc();this.rb&&(Ta.buttons.push(this.Od("PivotTableContextMenu.January",
1778578888,0,50===this.rb.LabelOrDateFilterType,lb.a.instance.ga(132),"50")),Ta.buttons.push(this.Od("PivotTableContextMenu.February",1778578888,0,51===this.rb.LabelOrDateFilterType,lb.a.instance.ga(133),"51")),Ta.buttons.push(this.Od("PivotTableContextMenu.March",1778578888,0,52===this.rb.LabelOrDateFilterType,lb.a.instance.ga(134),"52")),Ta.buttons.push(this.Od("PivotTableContextMenu.April",1778578888,0,53===this.rb.LabelOrDateFilterType,lb.a.instance.ga(135),"53")),Ta.buttons.push(this.Od("PivotTableContextMenu.May",
1778578888,0,54===this.rb.LabelOrDateFilterType,lb.a.instance.ga(136),"54")),Ta.buttons.push(this.Od("PivotTableContextMenu.June",1778578888,0,55===this.rb.LabelOrDateFilterType,lb.a.instance.ga(137),"55")),Ta.buttons.push(this.Od("PivotTableContextMenu.July",1778578888,0,56===this.rb.LabelOrDateFilterType,lb.a.instance.ga(138),"56")),Ta.buttons.push(this.Od("PivotTableContextMenu.August",1778578888,0,57===this.rb.LabelOrDateFilterType,lb.a.instance.ga(139),"57")),Ta.buttons.push(this.Od("PivotTableContextMenu.September",
1778578888,0,58===this.rb.LabelOrDateFilterType,lb.a.instance.ga(140),"58")),Ta.buttons.push(this.Od("PivotTableContextMenu.October",1778578888,0,59===this.rb.LabelOrDateFilterType,lb.a.instance.ga(141),"59")),Ta.buttons.push(this.Od("PivotTableContextMenu.November",1778578888,0,60===this.rb.LabelOrDateFilterType,lb.a.instance.ga(142),"60")),Ta.buttons.push(this.Od("PivotTableContextMenu.December",1778578888,0,61===this.rb.LabelOrDateFilterType,lb.a.instance.ga(143),"61")));return Ta};F.prototype.UGh=
function(Ta){var Cb=this.Va.Bc();if(this.a3f()){var jc=this.rc.TK[4===this.De.CellType?this.rc.l5c-1:this.De.CurrentFieldIndex-1];if(jc&&this.kab){var tc=this.Va.Tv("ContextMenu.PivotTableLayout",null,lb.a.instance.ga(650),-1777747317);var kd=this.Va.Bc(),Rd=String.format(lb.a.instance.mb(165),this.kab),pe=String.format(lb.a.instance.mb(166),this.kab);kd.buttons.push(this.Od(he,-1457478532,0,!jc.IsCompactLayout,Rd));kd.buttons.push(this.Od(vd,-1390365353,0,jc.IsCompactLayout,pe));tc.menu.pc.push(kd);
tc&&Cb.buttons.push(tc)}}if(1===this.De.CellArea||2===this.De.CellArea)this.rb.Caption&&(jc="",kd=this.JRd(),tc=String.format(lb.a.instance.mb(159),this.ced(kd)),kd&&(jc=String.format(lb.a.instance.mb(159),this.rb.Caption)),1===this.De.CellArea?(jc=this.pja("ContextMenu.PivotTableSubtotal",1801458190,0,this.rb.ShowSubtotal,tc),tc=this.Va.Bc(),tc.buttons.push(this.Va.lb(259)),tc.buttons.push(this.Od("ContextMenu.PivotTableSubtotalOnTop",671485366,642,this.rb.ShowSubtotal&&this.rb.ShowSubtotalAtTop)),
tc.buttons.push(this.Od("ContextMenu.PivotTableSubtotalOnBottom",772221736,643,this.rb.ShowSubtotal&&!this.rb.ShowSubtotalAtTop)),jc.menu.pc.push(tc),jc&&0<tc.buttons.length&&Cb.buttons.push(jc)):(kd=kd?this.$G($c,this.ova(tc)):$c,Cb.buttons.push(this.Od(kd,1801458190,0,this.rb.ShowSubtotal,tc,null,jc)))),Cb.buttons.push(this.Od("ContextMenu.RepeatItemLabels",-556893687,645,this.rb.RepeatItemLabels));1===this.De.CellArea&&Cb.buttons.push(this.Od("ContextMenu.PivotBlankLineAfterEachItem",1600778266,
644,this.rb.ShowBlankLineAfterEachItem));Ta.pc.push(Cb)};F.prototype.JHh=function(Ta){var Cb=this.Va.Bc();Cb.buttons.push(this.Va.lb(247));Ta.pc.push(Cb)};F.prototype.eHh=function(Ta){if(this.$.isEditMode&&this.grid){var Cb=this.grid.ha.sa.activeRange;if(Cb.top===Cb.bottom&&Cb.left===Cb.right&&0!==this.De.MoveItemsMenuState){Cb=this.pja("PivotTableContextMenu.Move",-1777747317,0,!1,lb.a.instance.ga(73));var jc=this.Va.Bc();this.eac(jc,"PivotTableContextMenu.MoveToBeginning",2059542618,String.format(lb.a.instance.mb(162),
this.De.MoveItemName),0===(this.De.MoveItemsMenuState&1));this.eac(jc,"PivotTableContextMenu.MoveUp",713270357,String.format(lb.a.instance.mb(163),this.De.MoveItemName),0===(this.De.MoveItemsMenuState&2));this.eac(jc,"PivotTableContextMenu.MoveDown",-1842411134,String.format(lb.a.instance.mb(160),this.De.MoveItemName),0===(this.De.MoveItemsMenuState&4));this.eac(jc,"PivotTableContextMenu.MoveToEnd",2054968064,String.format(lb.a.instance.mb(161),this.De.MoveItemName),0===(this.De.MoveItemsMenuState&
8));Cb.menu.pc.push(jc);Ta.buttons.push(Cb)}}};F.prototype.zHh=function(Ta){var Cb="",jc="",tc=!1;3===this.De.CellType?Cb=lb.a.instance.ga(647):8===this.De.CellType?this.rc&&(Cb=String.format(lb.a.instance.mb(164),this.rc.gGe)):this.rb&&((tc=this.JRd())&&(jc=String.format(lb.a.instance.mb(164),this.rb.Caption)),Cb=String.format(lb.a.instance.mb(164),this.ced(tc)));Cb&&(tc=tc?this.$G(Ec,this.ova(Cb)):Ec,Cb=this.Od(tc,-1951357930,0,!1,Cb,null,jc,8,ic.a.L9c),Ta.buttons.push(Cb))};F.prototype.hGh=function(Ta){var Cb=
this.Va.Bc();Cb.buttons.push(this.Va.lb(43));this.rb&&this.De&&this.$.isEditMode&&(0===this.De.CellType||4===this.De.CellType)&&Cb.buttons.push(this.Va.lb(136));Ta.pc.push(Cb)};F.prototype.yHh=function(Ta){var Cb=this.Va.Bc();Cb.buttons.push(this.Va.lb(100));Ta.pc.push(Cb)};F.prototype.PHh=function(Ta){var Cb=2===this.rb.MeasureType&&!this.rb.IsNumeric,jc=this.Va.Tv("ContextMenu.SummarizeValuesBy",null,lb.a.instance.ga(648),-249874296),tc=this.Va.Bc();tc.buttons.push(this.Od("ContextMenu.SummarizeValuesBySum",
-1255320719,1095,0===this.rb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Cb));tc.buttons.push(this.Od("ContextMenu.SummarizeValuesByCount",1746132849,1096,1===this.rb.DataFieldAggregationType));tc.buttons.push(this.Od("ContextMenu.SummarizeValuesByAverage",-771066011,1097,2===this.rb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Cb));tc.buttons.push(this.Od("ContextMenu.SummarizeValuesByMax",835007294,1098,3===this.rb.DataFieldAggregationType,void 0,void 0,void 0,void 0,
void 0,Cb));tc.buttons.push(this.Od("ContextMenu.SummarizeValuesByMin",929115636,1099,4===this.rb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Cb));tc.buttons.push(this.Od("ContextMenu.SummarizeValuesByProduct",1935475057,1100,5===this.rb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,this.l2f(!0)||Cb));2!==this.rb.MeasureType&&(tc.buttons.push(this.Od("ContextMenu.SummarizeValuesByCountNumbers",1475494885,1101,6===this.rb.DataFieldAggregationType)),tc.buttons.push(this.Od("ContextMenu.SummarizeValuesByStdDeviation",
588680636,1102,7===this.rb.DataFieldAggregationType)),tc.buttons.push(this.Od("ContextMenu.SummarizeValuesByStdDeviationPercent",-910892852,1103,8===this.rb.DataFieldAggregationType)),tc.buttons.push(this.Od("ContextMenu.SummarizeValuesByVariant",1668427539,1104,9===this.rb.DataFieldAggregationType)),tc.buttons.push(this.Od("ContextMenu.SummarizeValuesByVariantPercent",-1751371357,1105,10===this.rb.DataFieldAggregationType)));this.rc&&this.rc.qpd()&&tc.buttons.push(this.Od("ContextMenu.SummarizeValuesByDistinctCountPPM",
376946683,1106,11===this.rb.DataFieldAggregationType));jc.menu.pc.push(tc);Ta.buttons.push(jc)};F.prototype.KHh=function(Ta){var Cb=this.Va.Tv("ContextMenu.ShowValuesAs",null,lb.a.instance.ga(649),-1128612833),jc=this.Va.Bc();jc.buttons.push(this.Od("ContextMenu.ShowValuesAsNoCalculation",-841863025,1112,0===this.rb.DataFieldFormatType));jc.buttons.push(this.Od("ContextMenu.ShowValuesAsPercentOfGrandTotal",-178796371,1119,7===this.rb.DataFieldFormatType));jc.buttons.push(this.Od("ContextMenu.ShowValuesAsPercentOfColumnTotal",
786592977,1118,6===this.rb.DataFieldFormatType));jc.buttons.push(this.Od("ContextMenu.ShowValuesAsPercentOfRowTotal",767774849,1117,5===this.rb.DataFieldFormatType));jc.buttons.push(this.Od("ContextMenu.ShowValuesAsPercentOfParentRowTotal",282586693,1122,9===this.rb.DataFieldFormatType));jc.buttons.push(this.Od("ContextMenu.ShowValuesAsParentColumnTotal",-1067664355,1123,10===this.rb.DataFieldFormatType));if(this.rc&&this.rc.TK&&0<this.rc.TK.length||this.rc.M$&&0<this.rc.M$.length){for(var tc=this.pja("ContextMenu.ShowValuesAsPercentOfParentTotal",
-1128612833,1124,11===this.rb.DataFieldFormatType),kd=this.Va.Bc(),Rd=this.OHh(),pe=0;pe<Rd.length;pe++){var le=Rd[pe];kd.buttons.push(this.Od("ContextMenu.ShowValuesAsPercentOfParentTotal."+le.Caption,-2031744961,1124,11===this.rb.DataFieldFormatType&&this.rb.BaseFieldIndex===le.Index,le.Caption,"ContextMenu.ShowValuesAsPercentOfParentTotal."+le.Index))}tc.menu.pc.push(kd);jc.buttons.push(tc)}Cb.menu.pc.push(jc);Ta.buttons.push(Cb)};F.prototype.showPivotTableContextMenu=function(){this.cod=!0;this.expandCollapse=
this.lZ=this.refresh=!1;var Ta=this.$,Cb=Oa.g(Ta),jc=Be.a(Ta).wKa();if(jc){var tc=xe.a(Ta);if(null===tc||void 0===tc?0:tc.bRd)this.cod=bc.f(Ta.mg);tc=Ta.ic;this.lZ=jc.supportsBIExplore&&!!Md.a(Ta)&&tc.N2(32768);tc.allowInteractivity&&(Ta=Cb.Ub(null),(null===Ta||void 0===Ta?0:Ta.cell)&&(Ta.cell.LZc||Ta.cell.Y2f)&&(this.expandCollapse=!0),tc.allowManualDataRefresh&&(this.refresh=!0))}Ta=null;jc=1;this.E0a&&1!==this.E0a.nb?(Ta=new Sys.UI.Point(this.E0a.clientPoint.x,this.E0a.clientPoint.y),jc=this.E0a.nb):
(Cb=ec.e(Cb,this.$))&&(Ta=new Sys.UI.Point(Cb.x+(this.$.isChromeRtl?0:Cb.width),Cb.y+Cb.height));vb.a.Cb=jc;this.Hic=3===jc;this.hp(Ta,!0,jc);this.Lba=!0;this.wUd()};F.prototype.C7h=function(){var Ta=new nb.a(1114549926,0,this.$.Jc,19,null);this.$.Ka.Kb(Ta)};F.prototype.dVh=function(){var Ta=this;if(this.rc&&this.rc.Go){var Cb=this.rc.Go.CurrentCol;if(this.rc.Go.CurrentRow===this.activeCell.FirstRow&&Cb===this.activeCell.FirstColumn){this.cLb();this.showPivotTableContextMenu();return}}Cb=new dc.a(228,
0,function(jc,tc,kd){return td.k(Ta.$.oa.va,Ta.activeCell,wa.b(jc,Ta.dNi),wa.a(tc,Ta.cNi),kd,null)},16);this.$.userOperationManager.Sb(Cb,null)};F.prototype.Rli=function(){if(fc.a.rd(this.$)){var Ta=this.$.da.za(441);if(Ta)return Ta.Jr}else if(Ta=this.$.da.za(346))return Ta.Jr;return!1};F.prototype.$G=function(Ta,Cb){return Ta+"."+Cb};F.prototype.performPivotTableOperation=function(Ta,Cb){var jc=this,tc=Gd.a.Ta.Jb;if(!this.rc||!this.rb&&this.De&&3!==this.De.CellType)this.gj();else{var kd=this.rc.isOlap;
Be.a(this.$).ux(kd,function(Rd){Rd&&jc.$.Sb(Ta,function(pe,le,Wd){var ve=jc.M_d,Se=jc.activeCell,Ve=jc.rb?jc.rb.Caption:null,Va=jc.kab;pe=wa.b(pe,jc.NQi);le=wa.a(le,jc.MQi);var Rb=jc.$.oa.va.Pb();Rb=ve.Na(41,void 0===Rb?null:Rb);Rb.activeCell=Se;Rb.operationType=Cb;Rb.fieldCaption=Ve;Rb.prevFieldCaption=Va;return $a.g(ve,"ExecutePivotTableOperation",Rb,pe,le,Wd,null,0)},tc,0,4,229)})}};F.prototype.applyValueFieldSettingsToPivotTable=function(Ta,Cb){var jc=this;Cb=void 0===Cb?!1:Cb;var tc=Gd.a.Ta.Jb;
this.rc&&this.rb?(Cb&&2===this.rb.MeasureType&&V.ULS.sendTraceTag(537167002,0,50,"change aggregation type for an implicit measure from right click context menu."),Cb=this.rc.isOlap,Be.a(this.$).ux(Cb,function(kd){kd&&jc.$.Sb(Ta,function(Rd,pe,le){var Wd=jc.M_d,ve=jc.activeCell,Se=jc.Tz;Rd=wa.b(Rd,jc.GHi);pe=wa.a(pe,jc.FHi);var Ve=jc.$.oa.va.Pb();Ve=Wd.Na(41,void 0===Ve?null:Ve);Ve.activeCell=ve;Ve.pivotValueFieldSettingsApplyData=Se;return $a.g(Wd,"ApplyValueFieldSettingsToPivotTable",Ve,Rd,pe,le,
null,0)},tc,0,4,231)})):this.gj()};F.prototype.Od=function(Ta,Cb,jc,tc,kd,Rd,pe,le,Wd,ve){kd=void 0===kd?null:kd;Rd=void 0===Rd?null:Rd;pe=void 0===pe?null:pe;le=void 0===le?8:le;Wd=void 0===Wd?null:Wd;ve=void 0===ve?!1:ve;tc&&(Ta+=".Checked");ve&&(Ta+=".Disabled");this.Va.Omd(Ta)&&this.Va.yId(Ta);jc=kd||lb.a.instance.ga(jc);Ta=this.Va.LHa(Ta,jc,Cb,null,"None",Rd,ve,null);Ta.ewc(null);pe&&Ta.$R(pe);tc?Ta.bS("Image16by16",3,ic.a.uaa):Wd?Ta.bS("Image16by16",le,Wd):Ta.R2b();return Ta};F.prototype.pja=
function(Ta,Cb,jc,tc,kd){jc=(void 0===kd?null:kd)||lb.a.instance.ga(jc);this.Va.Omd(Ta)?this.Va.yId(Ta):this.Va.yId(Ta+".Checked");tc&&(Ta+=".Checked");this.Dxj&&(jc=this.Uih.parseFromString(jc,"text/html").body.innerText);Ta=this.Va.w3c(Ta,null,jc,Cb,3,ic.a.uaa);Ta.J9e=tc;!tc&&Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:4877664_HidePivotTableContextMenuFlyoutCheckmark")&&Ta.R2b();return Ta};F.prototype.mai=function(){this.Tz=Object(Aa.a)(new Q,{PivotValueFieldSummarizeValueByApplyData:Object(Aa.a)(new G,
{Aggregation:-1}),PivotValueFieldShowValueAsApplyData:Object(Aa.a)(new K,{SelectedDataFormat:-1,SelectedBaseField:-1,SelectedBaseItem:-1}),PivotValueFieldTitle:null})};F.prototype.PRa=function(Ta,Cb){this.Tz.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=Ta;this.Tz.PivotValueFieldShowValueAsApplyData.SelectedBaseField=Cb;this.Tz.PivotValueFieldShowValueAsApplyData.SelectedBaseItem=-1};F.prototype.OHh=function(){var Ta=[];if(this.rc&&this.rc.M$&&0<this.rc.M$.length)for(var Cb=ik(this.rc.M$),
jc=Cb.next();!jc.done;jc=Cb.next())(jc=jc.value)&&Ta.push(jc);if(this.rc&&this.rc.TK&&0<this.rc.TK.length)for(Cb=ik(this.rc.TK),jc=Cb.next();!jc.done;jc=Cb.next())(jc=jc.value)&&Ta.push(jc);Ta.sort(function(tc,kd){return tc.Index-kd.Index});return Ta};F.prototype.a3f=function(){if(!this.De||!this.rc||!this.rc.TK)return!1;var Ta=1===this.De.CellArea||4===this.De.CellType&&this.De.IsRowAxis,Cb=4===this.De.CellType?0<this.rc.l5c:0<this.De.CurrentFieldIndex;return 1<this.rc.TK.length&&Ta&&Cb};F.prototype.iKa=
function(Ta){var Cb=[];3===Ta?this.$.isEditMode?Cb.push.apply(Cb,[md.a.dHf,md.a.fHf,md.a.vZi]):Cb.push.apply(Cb,[md.a.copy]):2===Ta&&Cb.push(md.a.rxe);return Cb};F.prototype.gj=function(){var Ta=Wa.a.Xc(1,0,0,651,0,104573951,"PivotTableContextMenuOperationFailure");lc.a(this.$).gj(Ta)};F.prototype.lzj=function(){return this.rb?0!==this.rb.LabelOrDateFilterType||0!==this.rb.ValueFilterType||this.rb.HasManualFilter:!1};F.prototype.izj=function(Ta){return 62<=Ta&&65>=Ta};F.prototype.Asi=function(){if(this.activeCell&&
this.rb&&this.rc){var Ta={};Ta.cell=this.activeCell;Ta.dataSourceIndex=this.rc.externalSourceIndex;Ta.fieldId=this.rb.Index.toString();Ta.isOlap=this.rc.isOlap;Ta.confirmationRequired=this.rc.confirmationRequiredForDataOps;this.$.Cd(492140419,vb.a.Cb,19,{showPivotFilterDialogCommandData:Ta})}};F.prototype.FZg=function(Ta){var Cb=this;this.activeCell&&this.rb&&this.rc&&this.$.userOperationManager.Sb(new dc.a(153,0,function(jc,tc,kd){return $a.B(Cb.$.oa.va,Cb.activeCell,Cb.rc.externalSourceIndex,Cb.rb.Index.toString(),
Ta,jc,tc,kd,null,null)}),null)};F.prototype.JLg=function(Ta){var Cb=this;!(30>Ta||61<Ta)&&this.activeCell&&this.rb&&this.rc&&this.$.userOperationManager.Sb(new dc.a(152,0,function(jc,tc,kd){return $a.e(Cb.$.oa.va,Cb.activeCell,Cb.rc.externalSourceIndex,Cb.rb.Index.toString(),Ta,jc,tc,kd,null,null)}),null)};F.prototype.applyPivotSort=function(Ta){var Cb=this;if(this.rc&&this.rb&&this.activeCell&&this.De){var jc=1===this.De.CellArea||2===this.De.CellArea;8===this.De.CellArea?Oc.a(this.$.userOperationManager,
function(tc,kd,Rd){return td.b(Cb.$.oa.va,Cb.activeCell,Ta,Cb.rb.Caption,tc,kd,Rd,null)},function(tc){return new dc.a(1015,0,tc,void 0,null)},null):jc&&(jc=1===this.De.CellArea?1:2,this.$.ma(696)?Zb.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.rc.externalSourceIndex,this.rb.Index.toString(),this.rb.Caption,this.rc.isOlap?"":this.rb.Caption,jc,1===Ta):Zb.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.rc.externalSourceIndex,this.rb.Index.toString(),
1===Ta))}};F.prototype.dS=function(){return!this.rc||!this.rc.isActionable};F.prototype.Uxj=function(){return(this.De||this.rc)&&4!==this.De.CellType&&(0!==this.De.CellType||8!==this.De.CellArea||this.rc.M$&&this.rc.M$.length||this.rc.TK&&this.rc.TK.length)?!1:!0};F.prototype.Vxj=function(){return this.De&&this.rc&&(1===this.De.CellArea||2===this.De.CellArea)&&this.rc.vPb&&this.rc.vPb.length?!1:!0};F.prototype.eac=function(Ta,Cb,jc,tc,kd){Ta.buttons.push(this.Od(Cb,jc,0,!1,tc,null,null,8,null,kd))};
of.Object.defineProperties(F.prototype,{xw:{configurable:!0,enumerable:!0,get:function(){return"PopulatePivotTableContextMenu"}},tB:{configurable:!0,enumerable:!0,get:function(){return Ab.a.kMf}}});Object(ma.a)(F,"PivotTableContextMenu",Db.a,[]);H.prototype.compare=function(Ta,Cb){return(Ta||"").localeCompare(Cb||"",void 0,{numeric:!0,sensitivity:"accent"})};Object(ma.a)(H,"DigitsAsNumberComparer",null,[572]);var Ze=b(1296),gf=b(160),Df=b(361),mc=b(277),sc=b(24),hd=b(188),cd=Ab.a.D3g,Ed=Db.a;$k(D,
Ed);D.prototype.executeCommand=function(Ta,Cb,jc){Ta=Cb.command;switch(Ta){case 639960842:this.applyTableFieldList(jc);this.DK.Bda();break;case -1085236154:V.ULS.sendTraceTag(537166999,0,50,"TableFieldListContextMenu:TableFieldListContextMenuClose, ColWithEntities, "+this.Fyd);this.DK.Bda();break;case 1833782813:this.DK.showCallout();break;default:return Sb.a(Ta)}return zb.Task.Ua(!0)};D.prototype.applyTableFieldList=function(Ta){var Cb=Ta.MenuItemId.toString();Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5239502_UpdatePulloutFieldNameContainingSplChars")&&
(Cb=Cb.replace("'","''"),Cb=Cb.replace("[","'["),Cb=Cb.replace("]","']"));var jc=Object(Ob.a)(String,Ta.SourceControlId),tc={};tc.PulloutField=Cb;tc.PulloutCardPath=Ta.SourceCardKeyPath;tc.PulloutCardSourceRow=Ta.SourceCardRow;tc.PulloutCardSourceColumn=Ta.SourceCardColumn;if(this.DK.cN){V.ULS.sendTraceTag(38887748,0,50,"Table Pullout operation started");tc.ParameterType=2;Ta=Ta.ColumnIndex;if(void 0===Ta||null===Ta){if(void 0===jc||null===jc){V.ULS.shipAssertTag(537166998,0,!1,"TableFieldListContextMenu: ApplyTableFieldList, must specifiy ColumnIndex or SourceControlId");
return}Ta=0<=this.DK.mKf?this.DK.mKf:parseInt(jc.substring(20+Cb.length+1,jc.length),10);if(isNaN(Ta)){V.ULS.shipAssertTag(537166997,0,!1,"TableFieldListContextMenu:ApplyTableFieldListMalformatHTMLAttribute, Attribute, "+jc);return}}tc.PulloutRichColumnSourceIndex=Ta;if(this.JEa.iJg){this.YJg(Cb,tc);return}}else V.ULS.sendTraceTag(38887749,0,50,"Grid Pullout operation started"),tc.ParameterType=4,jc=this.DK.selectedRange.right,fc.a.izb()&&this.JEa.snd&&(tc.ParameterType=8,Ta=this.DK.Hla.top,Ta=sc.Range.KP(jc)+
Ta,Cb==Ze.f?(Cb="=DAYS("+Ta+", TODAY())",hd.a("DateFormulaPulledOut_DaysFromToday")):Cb==Ze.i?(Cb="=IF(TODAY() < "+Ta+", NETWORKDAYS(TODAY(), "+Ta+"), NETWORKDAYS("+Ta+", TODAY()))",hd.a("DateFormulaPulledOut_WeekdaysFromToday")):Cb==Ze.j?(Cb="=IF(TODAY() < "+Ta+", DATEDIF(TODAY(), "+Ta+', "Y"), DATEDIF('+Ta+', TODAY(), "Y"))',hd.a("DateFormulaPulledOut_YearsFromToday")):Cb==Ze.e?(Cb="=TEXT("+Ta+', "dddd")',hd.a("DateFormulaPulledOut_DayOfWeek")):Cb==Ze.h?(Cb="=TEXT("+Ta+', "mmmm")',hd.a("DateFormulaPulledOut_MonthOfYear")):
Cb==Ze.g?(Cb="EOMONTH("+Ta+", 0)",Cb="=DATE(YEAR("+Cb+"), MONTH("+Cb+"), DAY("+Cb+"))",hd.a("DateFormulaPulledOut_EndOfMonth")):Cb==Ze.c?(Cb="EDATE("+Ta+", 1)",Cb="=DATE(YEAR("+Cb+"), MONTH("+Cb+"), DAY("+Cb+"))",hd.a("DateFormulaPulledOut_AddOneMonth")):Cb==Ze.d?(Cb="="+Ta+" + 7",hd.a("DateFormulaPulledOut_AddOneWeek")):Cb==Ze.b&&(Cb="="+Ta+" + 1",hd.a("DateFormulaPulledOut_AddOneDay"))),void 0!==tc.PulloutCardSourceColumn&&null!==tc.PulloutCardSourceColumn&&(jc=tc.PulloutCardSourceColumn+1),tc.PulloutRichColumnSourceIndex=
jc;this.JOd(Cb,tc)};D.prototype.JOd=function(Ta,Cb,jc){jc=void 0===jc?0:jc;V.ULS.sendTraceTag(537166996,0,50,"TableFieldListContextMenu:ApplyTableFieldList, ColWithEntities, "+this.Fyd+", SelectedColumnIndex, "+Cb.PulloutRichColumnSourceIndex);Ta=Object(Aa.a)(new mc.a,{Text:Ta});this.grid.setCell(Ta,this.DK.Hla,0,127,Cb,jc);this.grid.focus();this.G5b=null;this.DK.Bda();this.DK.Ehj()};D.prototype.Ac=function(Ta,Cb,jc){if(Ta=this.$.isEditMode&&Yb.EwaSettings.ma(136)&&!!this.DK)switch(Cb.command){case -1085236154:break;
case 639960842:Ta=!!jc;break;case 1833782813:Ta=this.DK.vwa&&this.DK.XBb;break;default:Ta=!1}return Ta};D.prototype.M0=function(Ta,Cb,jc){this.$.isEditMode&&(this.G5b=this.$Gh(Object(Ob.a)(564,jc)),Ed.prototype.M0.call(this,Ta,Cb,null,null,!1))};D.prototype.UY=function(){return this.G5b};D.prototype.v3c=function(Ta){if(!this.DK||!Ta||!Ta.Hk)return V.ULS.shipAssertTag(537166994,0,!!this.DK,"TableFieldListContextMenu:CreateContextMenuItemList PulloutManager null"),V.ULS.shipAssertTag(537166993,0,!!Ta,
"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager null"),Ta&&V.ULS.shipAssertTag(537166992,0,!!Ta.Hk,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager.FieldInfoListContextList null"),null;var Cb=new nc.a;Ta=ik(Ta.Hk);for(var jc=Ta.next();!jc.done;jc=Ta.next()){var tc=jc.value;jc=new nc.a;jc.add(tc.ColumnName);jc.add(tc.ColumnIndex.toString());var kd=new nc.a,Rd=null;fc.a.izb()&&this.JEa.snd?kd=hc.toList(hc.select(hc.asEnumerable(tc.FieldInfoDataList),function(pe){return pe.Name})):
(Rd=Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5860557_CompareDigitsAsNumberRichDataProperties")?new H:new qc.a,kd=hc.OBc(hc.concat(kd,hc.select(hc.asEnumerable(tc.FieldInfoDataList),function(pe){return pe.Name})),function(pe){return pe},Rd));tc=new nc.a;tc.add(hc.toArray(hc.concat(jc,kd)));Cb=hc.toList(hc.concat(Cb,tc))}return hc.toArray(Cb)};D.prototype.$Gh=function(Ta){var Cb=this.v3c(Ta);if(!Cb||!Cb.length)return this.G5b=null;Ta=this.Va;var jc=Ta.kq(this.menuId),tc=Ta.Bc(),kd=1<Cb.length,
Rd=fc.a.izb()&&this.JEa.snd;this.Fyd=Cb.length;Cb=ik(Cb);for(var pe=Cb.next();!pe.done;pe=Cb.next()){var le=pe.value;Rd?tc.title="Calculate Date Information":kd||(tc.title=le[0]);pe=Ta.Bc();for(var Wd=2,ve=le.length;Wd<ve;++Wd)!Rd||le[Wd]!=Ze.f&&le[Wd]!=Ze.g||(jc.pc.push(tc),tc=Ta.Bc()),(kd?pe.buttons:tc.buttons).push(Ta.LHa("ApplyTableFieldList."+le[Wd]+"."+le[1],le[Wd],639960842,null,"None",le[Wd],!1,void 0,!0));kd&&(le=Ta.Tv("ApplyTableFieldList."+le[0],this.menuId,le[0],798637440),le.menu.pc.push(pe),
tc.buttons.push(le))}jc.pc.push(tc);return jc};D.prototype.YJg=function(Ta,Cb){var jc=this,tc=Wa.a.Xc(12,1,0,897,0,2007340793,"RichValuePulloutIntoNonEmptyRange");if(Yb.EwaSettings.oz()){var kd=new Df.a(this.$,tc);kd.oP(function(){2===kd.returnValue&&jc.JOd(Ta,Cb,8)})}else{var Rd=new gf.ErrorDialog(this.$,tc);Rd.oP(function(){2===Rd.returnValue&&jc.JOd(Ta,Cb,8)});Rd.qf()}};of.Object.defineProperties(D.prototype,{xw:{configurable:!0,enumerable:!0,get:function(){return"PopulateTableFieldListContextMenu"}},
tB:{configurable:!0,enumerable:!0,get:function(){return Ab.a.mMf}},DK:{configurable:!0,enumerable:!0,get:function(){this.JEa||(this.JEa=this.$.da.za(261));return this.JEa}}});Object(ma.a)(D,"PulloutFieldListContextMenu",Db.a,[]);var ge=Ab.a.oMf,Nd=Db.a;$k(w,Nd);w.prototype.Ac=function(Ta,Cb,jc){return-1687037502===Cb.command&&!!jc&&this.grid.isEditing};w.prototype.executeCommand=function(Ta,Cb,jc){this.showRichTextFloatie(jc);return zb.Task.Ua(!0)};w.prototype.iKa=function(){return[md.a.dXg]};w.prototype.showRichTextFloatie=
function(Ta){var Cb=Object(Ob.a)(rd.a,Ta.eventArgs);Cb&&(Ta=this.iKa(Cb.nb),Cb=new Sys.UI.Point(Cb.Ca.clientX,Cb.Ca.clientY),this.showFloatie(Ta,new Sys.UI.Bounds(Cb.x,Cb.y,0,0),2))};of.Object.defineProperties(w.prototype,{xw:{configurable:!0,enumerable:!0,get:function(){return"PopulateRichTextContextMenu"}},tB:{configurable:!0,enumerable:!0,get:function(){return Ab.a.oMf}}});Object(ma.a)(w,"RichTextContextMenu",Db.a,[]);var Ld=b(101),De=b(647),ke=Ab.a.C3g,db=Db.a;$k(y,db);y.prototype.executeCommand=
function(Ta,Cb,jc){if(Cd.a(this.$))return zb.Task.Ua(!0);this.$.isEditMode&&(Ta=jc[Ab.a.S1f],Ta=Ta.x&&Ta.y?new Sys.UI.Point(Ta.x+(this.$.isChromeRtl?10:-10),Ta.y):de.DOMElementExtensions.getLocation(jc[Ab.a.T1f]),this.hp(Ta,!1));return zb.Task.Ua(!0)};y.prototype.Ac=function(Ta,Cb,jc){return-1075099431===Cb.command&&!!jc};y.prototype.UY=function(){var Ta=this.Va.kq(this.menuId),Cb=this.$.isEditMode;this.YUj();this.PGh(Ta,Cb);this.EGh(Ta);this.IHh(Ta);return Ta};y.prototype.uZb=function(Ta,Cb,jc,tc){Ta.push(this.Va.lb(Cb?
jc:tc))};y.prototype.PGh=function(Ta,Cb){var jc=this.Va,tc=jc.Bc();tc.buttons.push(jc.lb(54));this.uZb(tc.buttons,this.xic,127,56);tc.buttons.push(jc.lb(55));Cb&&this.uZb(tc.buttons,this.xic,126,125);tc.buttons.push(jc.lb(158));this.$.ea.NLb&&(Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:6540166_CheckIsSdxAllowedForProtectionPane")?Ra.AFrameworkApplication.uqd(De.a):this.$.ya.ExcelSheetProtectionSettingsEnabled)&&(Cb=Object(Ob.a)(Ld.a,this.$.pa))&&df.p(Cb)&&this.$.isEditMode&&(tc.buttons.push(jc.lb(277)),
Cb.isLockPausedInSession?tc.buttons.push(jc.lb(279)):Cb.fj&&tc.buttons.push(jc.lb(278)));Cb=jc.Tv("ContextMenu.TabColor",null,lb.a.instance.ga(521),1841703919);jc=jc.s3c(467002767,1549407384,544,-221093529,this.tB);Cb.menu.pc.push(jc);tc.buttons.push(Cb);Ta.pc.push(tc)};y.prototype.EGh=function(Ta){var Cb=this.Va.Bc();this.uZb(Cb.buttons,this.xic,114,112);this.uZb(Cb.buttons,!this.Vgc,115,113);Ta.pc.push(Cb)};y.prototype.IHh=function(Ta){if(Yb.EwaSettings.ma(482)&&!df.e(this.$.xa.pa)){var Cb=this.Va,
jc=Cb.Bc();jc.buttons.push(Cb.lb(263));Ta.pc.push(jc)}};y.prototype.YUj=function(){var Ta=this.$.d3c();var Cb=Ta.e3c;Ta=Ta.LCe;this.xic=1===Cb;this.Vgc=0<Ta};of.Object.defineProperties(y.prototype,{xw:{configurable:!0,enumerable:!0,get:function(){return"PopulateSheetOpsContextMenu"}},tB:{configurable:!0,enumerable:!0,get:function(){return Ab.a.pMf}}});Object(ma.a)(y,"SheetOpsContextMenu",Db.a,[]);var Qb=b(574),Fc=Db.a;$k(z,Fc);z.prototype.Nc=function(Ta,Cb){var jc=!0;switch(Cb){case -231711729:jc=
!1;break;case -1909381757:jc=this.wcc();jc=!!jc&&jc.Mii;break;case 1312363469:jc=!0}return!jc||Fc.prototype.Nc.call(this,Ta,Cb)};z.prototype.executeCommand=function(Ta,Cb,jc){if(!this.$.isEditMode)return ca.TaskExtensions.eba();Ta=Cb.command;Cb=this.wcc();var tc=null;switch(Ta){case 2108047455:Cb&&Cb.hze();break;case -231711729:V.ULS.shipAssertTag(537166990,0,!1,"Shouldn't be hitting Slicer Refresh - NYI");break;case -1909381757:Cb&&Cb.$2b();break;case 1312363469:this.showSlicerContextMenu(jc);break;
default:tc=Sb.a(Ta)}return tc||ca.TaskExtensions.eba()};z.prototype.Ac=function(Ta,Cb,jc){Ta=!1;switch(Cb.command){case -231711729:case 2108047455:case -1909381757:Ta=!0;break;case 1312363469:Ta=!!jc}return Ta};z.prototype.UY=function(){var Ta=this.Va.kq(this.menuId),Cb=this.Va.Bc();Cb.buttons.push(this.Va.lb(252));Cb.buttons.push(this.Va.lb(253));Cb.buttons.push(this.Va.lb(254));Ta.pc.push(Cb);Cb=this.Va.Bc();this.boi()?Cb.buttons.push(this.Va.lb(266)):Cb.buttons.push(this.Va.lb(267));Ta.pc.push(Cb);
return Ta};z.prototype.boi=function(){if(fc.a.rd(this.$)){var Ta=this.$.da.za(439);if(Ta)return Ta.Jr}else if(Ta=this.$.da.za(371))return Ta.Jr;return!1};z.prototype.showSlicerContextMenu=function(Ta){var Cb=Object(Ob.a)(rd.a,Ta.eventArgs);Ta=this.Xac(Object(Ob.a)(rd.a,Ta.eventArgs));Cb=Cb.nb;vb.a.Cb=Cb;this.hp(Ta,!1,Cb)};z.prototype.gWe=function(Ta){var Cb=this.Va.Bc(),jc=this.Va.Bc();jc.buttons.push(this.Va.lb(255));jc.buttons.push(this.Va.lb(256));var tc=this.Va.w3c("ContextMenu.SlicerSort",null,
lb.a.instance.ga(2161),-814639094,0,ic.a.bPe);tc.menu.pc.push(jc);Cb.buttons.push(tc);Ta.pc.push(Cb)};z.prototype.Bzj=function(Ta){return Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5103035_SlicerCornerResizePointContextMenuUseOnlyClientPoint")&&Ta.yb.className===ic.a.u9c||Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5185773_SlicerShortcutContextMenuSkipFramePoint")&&1===Ta.nb};z.prototype.Xac=function(Ta){var Cb=Oa.g(this.$).ha.Oa.Yb,jc=Ta&&1!==Ta.nb&&Ta.clientPoint?Ta.clientPoint:Sys.UI.DomElement.getLocation(Cb.domElement);
if(this.Bzj(Ta)){var tc=this.wcc();tc&&(Ta.yb.className===ic.a.u9c&&(jc=Cc.HelperMethods.nvb(Ta.Ca)),1===Ta.nb&&(jc=Fb.a(this.$).Ija(de.DOMElementExtensions.getLocation(tc.frame))))}else if(Ta=this.wcc())Ta=this.nQh(Ta.frame),(tc=Cc.HelperMethods.AC(this.$.uf,this.$.domElement,Oa.g(this.$).rtl,!1))?(Ta.x=Fb.a(this.$).hi(Ta.x-tc.x)+tc.x,Ta.y=Fb.a(this.$).hi(Ta.y-tc.y)+tc.y):V.ULS.sendTraceTag(537166989,0,15,"Cannot get constant pane size."),jc.y+=Ta.y,jc.x+=Ta.x;Ta=this.$.domElement;tc=Oa.g(this.$).rtl;
Cb=Cc.HelperMethods.AC(Cb.dg.domElement,Ta,tc);jc.y=Math.max(jc.y,Cb.y);jc.x=Math.max(jc.x,Cb.x);return jc};z.prototype.wcc=function(){var Ta=Oa.g(this.$).ha.Oa.Yb;V.ULS.shipAssertTag(537166988,0,!!Ta);return Qb.a(this.$).hH(Ta.floatingObject.id)};z.prototype.nQh=function(Ta){var Cb=new Sys.UI.Point(Ta.offsetParent.offsetLeft,Ta.offsetParent.offsetTop),jc=Oa.g(this.$);if(!jc)return Cb;var tc=Oa.g(this.$).rtl;Cb=Cc.HelperMethods.AC(Ta,this.$.Sq.ownerDocument.body,tc);jc.CCe(Cb);Cb.x=tc?this.$.Sq.clientWidth-
Cb.x-Ta.clientWidth:Cb.x;Ta=jc.view.rpb;jc=tc?-jc.WR.wca(Ta.x):Ta.x;Cb.x-=jc;Cb.y-=Ta.y;return Cb};of.Object.defineProperties(z.prototype,{xw:{configurable:!0,enumerable:!0,get:function(){return"PopulateSlicerContextMenu"}},tB:{configurable:!0,enumerable:!0,get:function(){return Ab.a.qMf}}});Object(ma.a)(z,"SlicerContextMenu",Db.a,[]);Object(ma.a)(A,"TimeSlicerRibbonButtonParameter",null,[]);var Tc=Db.a;$k(u,Tc);u.prototype.executeCommand=function(Ta,Cb,jc){Ta=Cb.command;switch(Ta){case 2000085697:Ta=
jc.DOMElement;this.Fsa=jc.ChangeLevelCallback;this.rKa=jc.GetLevelLabelCallback;this.b1a=jc.CurrentLevel;var tc=jc.DomEvent;Na.g(tc);var kd=jc.location;jc=jc.levelLabelText;this.lKe=de.DOMElementExtensions.lz(document.activeElement,"iframe")&&jc?jc.parentNode:null;jc=Sys.UI.DomElement.getBounds(jc);jc.x=kd.x;jc.y=kd.y;this.M0(tc,Ta,jc,Cb,!0);break;case -649826274:this.Fsa(0);break;case 149600865:this.Fsa(1);break;case -2012435159:this.Fsa(2);break;case -1979934975:this.Fsa(3);break;case 1634477200:de.DOMElementExtensions.setFocus(this.lKe);
break;default:return Sb.a(Ta)}return zb.Task.Ua(!0)};u.prototype.Ac=function(Ta,Cb,jc){Ta=!1;switch(Cb.command){case 2000085697:Ta=!!jc;break;case -649826274:case 149600865:case -2012435159:case -1979934975:case 1634477200:Ta=!0}return Ta};u.prototype.M0=function(Ta,Cb,jc){Ta=Sys.UI.DomElement.getBounds(Cb);jc.x=Fb.a(this.$).hi(jc.x);jc.y=Fb.a(this.$).hi(jc.y);Ta.x=Fb.a(this.$).hi(Ta.x);Ta.y=Fb.a(this.$).hi(Ta.y);Ta=new Sys.UI.Point(Ta.x+jc.x,Ta.y+jc.y);this.showContextMenu(new Sys.UI.Bounds(Ta.x,
Ta.y-jc.height,jc.width,jc.height))};u.prototype.UY=function(){for(var Ta=this.Va,Cb=Ta.kq(this.menuId),jc=Ta.Bc(),tc=0;3>=tc;tc++){var kd=this.rKa(tc),Rd=u.GKh(tc);Rd=Ta.D5g(Rd.A3g,Rd.mr,this.b1a===tc,u.lye);Rd.label=kd;Rd.$R(kd);this.b1a===tc?Rd.bS("Image16by16",8,u.lye):Rd.R2b();jc.buttons.push(Rd)}Cb.pc.push(jc);return Cb};u.GKh=function(Ta){var Cb=null;switch(Ta){case 0:Cb=new A(87,"ContextMenu.TimeSlicerLevelYear",-649826274);break;case 1:Cb=new A(88,"ContextMenu.TimeSlicerLevelQuater",149600865);
break;case 2:Cb=new A(89,"ContextMenu.TimeSlicerLevelMonth",-2012435159);break;case 3:Cb=new A(90,"ContextMenu.TimeSlicerLevelDay",-1979934975)}return Cb};of.Object.defineProperties(u.prototype,{xw:{configurable:!0,enumerable:!0,get:function(){return"PopulateTimeSlicerLevelMenu"}},tB:{configurable:!0,enumerable:!0,get:function(){return Ab.a.tMf}}});u.UKj=Ab.a.E3g;u.NJb="TimeSlicerLevelMenuRootName";u.lye=ic.a.sua;Object(ma.a)(u,"TimeSlicerLevelMenu",Db.a,[]);var zd=b(332),Wc=b(3),dd=Ea.a;$k(l,dd);
l.prototype.zd=function(){var Ta=this,Cb=this.$,jc=Yc.a.UHa(Nc.b(),this.la,"Task","IRootUser"),tc=Ha.a(Cb),kd=null;kd=function(le,Wd){tc.cRf(kd);jc.setResult(Wd.m4b)};tc.Yne(kd);tc.K0e();var Rd=Ba.GetServiceTaskFactory.create(Cb.da,102,Cb.la,this.hb),pe=Ba.GetServiceTaskFactory.Ra(Cb.da,342,338,this.hb);ca.TaskExtensions.Aa(ca.TaskExtensions.Vd([jc.task,Rd,pe],this.la),function(){var le=Rd.result,Wd=jc.task.result,ve=pe.result;Ta.jd([new ba(Cb,Wd,le,ve),new da(Cb,Wd,le,ve),new ia(Cb,Wd,le,ve),new U(Cb,
Wd,le,ve),new S(Cb,Wd,le,ve),new xa(Cb,Wd,le,ve),new Ja.GridContextMenu(Cb,Wd,le,ve),new J(Cb,Wd,le,ve),new y(Cb,Wd,le,ve),new u(Cb,Wd,le,ve),new D(Cb,Wd,le,ve),new Z(Cb,Wd,le,ve),new F(Cb,Wd,le,ve),new z(Cb,Wd,le,ve),new w(Cb,Wd,le,ve)])},Cb.la,3)};l.initData=function(){var Ta=zd.a.J9;Ta(2000085697,20479,0,0);Ta(-227942804,Wc.a.wc|24576,0,0);Ta(1634477200,Wc.a.wc|131072,0,0);Ta(-649826274,4095,0,0);Ta(149600865,4095,0,0);Ta(-2012435159,4095,0,0);Ta(-1979934975,4095,0,0);Ta(1247109494,Wc.a.wc|24576,
0,0);Ta(-2064931494,Wc.a.wc|131072,0,0);Ta(-1396319072,Wc.a.Ha,128,0);Ta(-425234874,Wc.a.Ha,128,0);Ta(-1253126584,Wc.a.Ha,0,0);Ta(274207288,Wc.a.wc|24576,0,0);Ta(-1497523576,Wc.a.wc|131072,0,0);Ta(-498523270,Wc.a.wc|24576,64,0);Ta(1640762262,Wc.a.wc|131072,64,0);Ta(-2017893763,Wc.a.wc|24576,0,0);Ta(1350204367,Wc.a.wc|131072,0,0);Ta(-889576107,Wc.a.Pv,128,0);Ta(-1170196828,Wc.a.Pv,128,0);Ta(389774337,Wc.a.Pv,128,0);Ta(1529312473,Wc.a.Pv,128,0);Ta(2033235475,Wc.a.Pv,128,0);Ta(-96230454,Wc.a.Pv,128,
0);Ta(74086617,Wc.a.Pv,128,0);Ta(563292088,Wc.a.Pv,128,0);Ta(-1092351914,Wc.a.Pv,128,0);Ta(-2141589616,Wc.a.Pv|16384,128,0);Ta(745182485,Wc.a.Pv,0,0);Ta(359279088,Wc.a.Pv,128,0);Ta(-67292059,Wc.a.Pv,128,0);Ta(926905850,Wc.a.Pv,128,0);Ta(547535945,Wc.a.Pv,128,0);Ta(1374696078,Wc.a.wc|24576,0,0);Ta(495005930,Wc.a.wc|212992,0,0);Ta(-1045020714,Wc.a.wc|24576,0,0);Ta(-170383950,Wc.a.wc|212992,0,0);Ta(324156914,Wc.a.Ha,0,0);Ta(-1085236154,Wc.a.Eu,0,0);Ta(-751848458,Wc.a.kl|16384,0,0);Ta(216058793,Wc.a.Eu,
0,0);Ta(474690375,Wc.a.kl|16384,0,0);Ta(-1920954846,Wc.a.wc|24576,0,0);Ta(723126814,Wc.a.wc|131072,0,0);Ta(2108047455,128,128,0);Ta(-231711729,128,128,0);Ta(-1909381757,128,128,0);Ta(-814639094,128,128,0);Ta(1701016594,Wc.a.wc|3072,128,0);Ta(-1475408662,Wc.a.wc|24576,0,0);Ta(1114549926,Wc.a.wc|131072,32,0)};l.ka=function(Ta){Ea.a.Pd(10,new l(Ta))};Object(ma.a)(l,"ContextMenuCommandHandlerFactory",Ea.a,[]);var oe=b(235),Fd=b(1610),We=b(92),zf=b(267);x.prototype.dispose=function(){};x.prototype.iaa=
function(){this.nrb.E3()};x.prototype.tC=function(){this.nrb.tC()};x.prototype.aSd=function(Ta,Cb,jc){ec.h(this.$,ec.b);this.nrb.showContextMenu(Object(Aa.a)(new Fd.a,{x:Cb.x,y:Cb.y}),jc,Ta);We.EventHandlerManager.instance.zbd()};x.prototype.Sxc=function(Ta,Cb,jc){ec.h(this.$,ec.b);this.nrb.showFloatie(Object(Aa.a)(new Fd.a,{x:Cb.x,y:Cb.y}),Ta,jc);zf.a(function(){We.EventHandlerManager.instance.zbd()},this.$.la)};x.prototype.$Rd=function(Ta,Cb,jc,tc){ec.h(this.$,ec.b);this.nrb.$Rd(Object(Aa.a)(new Fd.a,
{x:Cb.x,y:Cb.y}),Ta,jc,tc)};Object(ma.a)(x,"ReactContextMenuController",null,[510,6]);var Cf=oe.a;$k(m,Cf);m.prototype.dispose=function(){this.u$e&&this.$&&this.$.ea.pn(this.pld);Cf.prototype.dispose.call(this)};m.prototype.create=function(){this.$.ea.Lg?(V.ULS.sendTraceTag(537167065,0,50,"ContextMenuControllerFactory.InitReactUISurfacesAndRegisterControllerIfNeeded: GFI = "+this.$.ea.Lg),this.pld(null,null)):(this.u$e=!0,this.$.ea.jl(this.pld))};m.ka=function(Ta){Ta.da.Ga(338,new m(Ta))};Object(ma.a)(m,
"ContextMenuControllerFactory",oe.a,[]);var pf=b(161);Object(ma.a)(v,"RibbonCommandParams",null,[]);Object(ma.a)(f,"HeaderSnappedAutoFilterMenuCacheEntry",null,[]);n.prototype.SKh=function(Ta){return(Ta=this.Tdc[Ta.toString()])?Ta.menuModel:null};n.prototype.mUg=function(Ta,Cb){this.Tdc[Cb.toString()]=Object(Aa.a)(new f,{menuModel:Ta,uFe:Cc.HelperMethods.Qb()})};n.prototype.O7b=function(Ta){this.Tdc[Ta.toString()]=null};n.prototype.v_h=function(Ta){return(Ta=this.Tdc[Ta.toString()])?Ta.uFe:-1};Object(ma.a)(n,
"FilterMenuCache",null,[]);var Hf=b(13),Qa=b(199),Mb=b(236);Object(ma.a)(k,"AutoFilterEventRegistrationArgs",null,[]);h.prototype.dispose=function(){window.cancelAnimationFrame(this.YBb);this.gridView&&this.gridView.Vsc(this.ZEb);this.gridView=null};h.prototype.v$h=function(){if(this.rRd=Cc.HelperMethods.T6a)this.PZa=[];this.wDg();this.gridView.QZb(this.ZEb)};h.prototype.wDg=function(){for(var Ta=ik(this.gridView.hn),Cb=Ta.next();!Cb.done;Cb=Ta.next()){Cb=Cb.value.cCa;for(var jc in Cb){var tc=Cb[jc];
this.NKf(tc.domElement,tc.hashCode)}}};h.prototype.NKf=function(Ta,Cb){if(Oa.g(this.$).Ea.hm.L1a(Cb))if(Ta){Ta=Ta.querySelectorAll('[id^="'+Ab.a.kad+'"]');for(var jc=0;jc<Ta.length;jc++){var tc=Ta[jc],kd=tc.getAttribute(Ab.a.eBh),Rd=tc.getAttribute(Ab.a.YAh);V.ULS.shipAssertTag(537167053,0,!!kd&&!!Rd,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Row and Column attributes should exist in AF input element. AutoFilterId: "+tc.id+", BlockHash: "+Cb);kd=sc.Range.Qc(parseInt(kd,10),
parseInt(Rd,10));tc=Object(Aa.a)(new k,{cell:kd,hte:tc,Ld:Cb});this.rRd?(this.PZa.push(tc),this.YBb||(this.EMe=window.performance.now(),this.YBb=window.requestAnimationFrame(this.EOf))):this.eme(tc)}}else V.ULS.sendTraceTag(537167054,0,50,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block DOM element is null. BlockHash: "+Cb);else V.ULS.sendTraceTag(537167055,0,50,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block model does not exist yet. Handlers will be added when block is rendered. BlockHash: "+
Cb)};h.prototype.eme=function(Ta){var Cb=this.gridView.Ea.tKa(Ta.cell,Ta.Ld);Cb?this.vDg(Ta.hte,Cb):V.ULS.sendTraceTag(537167050,1,10,"FilterMenuManager.AddPointerHandlersToAutoFilterInCell: GetModelCellFromRange returned null. BlockHash: "+Ta.Ld+", AutoFilter Cell: "+Ta.cell)};h.prototype.vDg=function(Ta,Cb){Cb.hasAutoFilter?this.tBg(Ta,Cb.cub):Cb.D4?this.tDg(Ta,Cb.cub,Cb.Epd):V.ULS.sendTraceTag(537167049,1,50,"FilterMenuManager.AddPointerEventHandlersToAutoFilter: Cell must have either AutoFilter or PivotFilter if reached here!");
pf.a.instance.ra(Hf.a.sf,Ta,this.onPointerDown);Qa.a.instance.ra(Hf.a.jya,Ta,this.onPointerDown)};h.prototype.tBg=function(Ta,Cb){Mb.a.instance.ra(Hf.a.click,Ta,function(jc){Cb&&Zb.a.hrc(jc.Ca.rawEvent,966232027,Cb,null);return!0})};h.prototype.tDg=function(Ta,Cb,jc){var tc=Ka.a.Wh(Cb);Mb.a.instance.ra(Hf.a.click,Ta,function(kd){jc?Zb.a.spf(document.getElementById(tc.EwaElementId),tc.Cell,tc.DataSourceIndex,tc.FieldId,tc.IsOlap,tc.RequiresConfirmation,kd.Ca.rawEvent,tc.OptionalPivotMenuAnchor):Zb.a.spfm(kd.Ca.rawEvent,
tc.RequiresConfirmation,tc.Cell,tc.DataSourceIndex,tc.PivotName,tc.OptionalPivotMenuAnchor);return!1})};Object(ma.a)(h,"FilterMenuPointerEventsManager",null,[6]);e.prototype.dispose=function(){Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||this.VSe.dispose();this.$=null};e.prototype.aRh=function(Ta){var Cb=Oa.g(this.$).Ea.o$(Ta,this.$.activeItemName);return Cb&&Cb.blockPresentInViewportTimeStamp>this.S8a.v_h(Ta.left)?
Cb.Mr(Ta).autoFilterMenu:this.S8a.SKh(Ta.left)};e.prototype.XNi=function(Ta,Cb,jc){this.S8a&&this.S8a.mUg(Ta.menuModel[Cb],jc)};e.prototype.YNi=function(Ta){this.S8a&&this.S8a.O7b(Ta)};Object(ma.a)(e,"FilterMenuManager",null,[509,6]);var kc=b(215),zc=b(174);d.prototype.vdd=function(Ta){return sa.a.yc(this.qyc,Ta)};d.prototype.dispose=function(){this.Ad?V.ULS.sendTraceTag(537167062,1,50,"ContextMenuManager.Dispose: Dispose has been called more than once"):(this.Ad=!0,this.$&&(this.$.sl(d.Yc),this.$.da.BU(8),
this.ha&&this.ha.Nsc(this.Il),this.$.Ka.QIb(this.dwf),Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ka&&this.$.Ka.Sza(this.lR),Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.q0(this.m6)),this.$=this.ha=null,this.V9b.dispose(),this.qyc=this.y6d=null)};d.prototype.showContextMenu=function(Ta,Cb,jc){Cb=void 0===Cb?null:Cb;jc=void 0===jc?null:jc;this.hzj(Ta)&&(ec.h(this.$,ec.i),Ta=this.P6g(Ta,
Cb,jc),this.$.Ka.Kb(Ta.Ed,Ta.dictionary))};d.prototype.E3=function(){this.contextMenuController?this.contextMenuController.iaa():V.ULS.sendTraceTag(537167061,1,10,"ContextMenuManager.DismissContextualUI: Context menu controller is null.")};d.prototype.hzj=function(Ta){return lc.a(this.$).Lp()?(V.ULS.sendTraceTag(537167060,1,50,"ContextMenuManager.OnContextMenu: Ignoring ContextMenu event because it is not allowed in partial interactivity mode"),lc.a(this.$).qW(zc.a.grid,kc.a.showContextMenu),!1):
!this.$.Ka.Byh&&(!Ta||Ta.yb!==Oa.g(this.$).domElement&&!Pd.a.equals(Ta.yb.tagName,"INPUT",!0))};d.prototype.P6g=function(Ta,Cb,jc){Cb=void 0===Cb?null:Cb;var tc={};jc=(tc.eventArgs=Ta,tc.creationParams=void 0===jc?null:jc,tc);Ta=Ta?Ta.nb:-1;tc=this.ha.Oa.Yb;var kd=1441131127;tc?(Cb=tc.floatingObject,V.ULS.shipAssertTag(537167059,0,!!Cb,"floatingObj shouldn't be null."),d.Qqd(Cb)?kd=1312363469:d.isPivotChart(Cb)?(jc[da.T_c]=Cb?Cb.Pc:null,kd=-149612405):kd=-1372040782):d.Sff(Cb)?(jc[da.T_c]=Cb,kd=-149612405):
!ec.g(this.$)&&ec.f(Oa.g(this.$))&&(kd=671488277);Cb=new nb.a(kd,Ta,this.$.Jc,30,null);return Object(Aa.a)(new v,{Ed:Cb,dictionary:jc})};d.ka=function(Ta){Ta.Uk(d.Yc)};d.isPivotChart=function(Ta){return!!Ta&&0===Ta.type&&d.Sff(Ta.Pc)};d.Qqd=function(Ta){return!!Ta&&2===Ta.type};d.Sff=function(Ta){return!!Ta&&!!(Ta.Attributes&4)};of.Object.defineProperties(d.prototype,{V9b:{configurable:!0,enumerable:!0,get:function(){return this.y6d}}});d.F3g="autoFilter chart fieldList fieldListPivotFilter fieldWell floatingObject grid pivotFilter sheetOps timeSlicerLevel tableFieldList autoFilterRichFieldList slicer richText".split(" ");
d.k2h="GridContextMenu";d.Yc=function(Ta){(Ta=Object(Ob.a)(2,Ta))&&Ba.GetServiceTaskFactory.create(Ta.da,9,Ta.la,0)};Object(ma.a)(d,"ContextMenuManager",null,[488,6]);var Ib=oe.a;$k(c,Ib);c.prototype.create=function(){var Ta=this,Cb=this.$,jc=Cb.ic;if(jc.allowSelection||jc.allowEdits||jc.allowFiltering||jc.allowSorting||jc.allowPivotSpecificOperations){var tc=Ba.GetServiceTaskFactory.create(Cb.da,10,Cb.la,this.hb),kd=Ba.GetServiceTaskFactory.Ra(Cb.da,342,338,this.hb);ca.TaskExtensions.Aa(ca.TaskExtensions.Vd([tc,
kd],this.la),function(){Ta.pb(Wb.a(Cb)||new d(Cb,tc.result,kd.result))},this.$.la,3)}else V.ULS.sendTraceTag(537167058,0,15,"ContextMenuManagerFactory.Create: no client permissions to allow creating ConetxtMenuManager. Returning null."),Cb.da.BU(8),this.pb(null)};c.ka=function(Ta){Ta.da.Ga(9,new c(Ta))};Object(ma.a)(c,"ContextMenuManagerFactory",oe.a,[]);var rc=b(10);b.d(E,"a",function(){return a})},1348:function(t,E,b){function a(){V.a.Fa(function(Qa){Ua.ka(Qa);pa.ka(Qa);c.ka(Qa)})}function c(Qa){var Mb=
Hf.call(this)||this;Mb.$=Qa;Mb.Eb();return Mb}function d(Qa,Mb,kc,zc,Ib,rc,Ta){var Cb=this;this.$=Qa;this.functionInfoManager=Mb;this.calcManager=kc;this.pluginScheduler=zc;this.formulaAssistanceUIControl=Ib;this.formulaAssistanceTelemetryManager=rc;this.Kg=Ta;this.aSa=!0;this.ZLa=this.isCellContentOnlyEqualDuringEdit=!1;this.cla=null;this.nNa=-1;this.gW=0;this.Eba=Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");this.cAb=Ia.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NotifyActiveCellOnEditStarted",
!1);this.vh=function(jc,tc){Cb.gridView.isEditing||Cb.gridView.vi||Cb.oOa(null===tc||void 0===tc?void 0:tc.cell)};this.Fh=function(jc,tc){Cb.oOa(null===tc||void 0===tc?void 0:tc.fja)};this.onFunctionInfoLoaded=function(){Cb.functionInfoManager.vbb(Cb.onFunctionInfoLoaded);Cb.NUj();Cb.zda()};this.quf=function(){Cb.aSa=!1};this.yuf=function(jc,tc){var kd=Cb.Ya;jc=kd.text;kd=kd.textBox.caretPosition;0<Cb.gW&&Cb.formulaAssistanceTelemetryManager.xY.commitWhileRequestPending++;Cb.formulaAssistanceTelemetryManager.oO(["argumentAssistanceComputation",
"argumentAssistanceOverall"]);tc.shouldRequestAutocompleteOnCommit?Cb.QXf(jc,kd):Cb.NKd(jc,kd)};this.Ef=function(){Cb.x2&&(Cb.isCellContentOnlyEqualDuringEdit&&(Cb.formulaAssistanceTelemetryManager.CM.isCellContentOnlyEqualDuringEditCounter++,Cb.isCellContentOnlyEqualDuringEdit=!1),Cb.ZLa&&(Cb.formulaAssistanceTelemetryManager.CM.isCellContentFormulaCounter++,Cb.ZLa=!1));Cb.aSa=!0;Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:6103891_dismissControlOnEditEnded")&&Cb.a7b()};this.n6=function(jc,tc){Cb.tMd(tc.newValue)};
this.yi=function(){Cb.ndg()};this.ndg=function(){Cb.pluginScheduler.notifier().setDefinedNamesInfo(Cb.x6b.$Ge)};this.wed=function(jc,tc){jc=Cb.pluginScheduler.syncRequester().formulaHighlighting({content:jc,caretPosition:null===tc||void 0===tc?void 0:tc.index,selectionLength:null===tc||void 0===tc?void 0:tc.length});if(isNullOrUndefined(jc)||isNullOrUndefined(jc.formulaHighlights))Sa.ULS.sendTraceTag(521211933,0,10,"FormulaAssistanceManager.getFormulaHighlights: formulaHighlightingResult is null or undefined, formulaHighlights array is null:"+
!isNullOrUndefined(jc));else return jc};this.functionInfoManager=Mb;this.formulaAssistanceUIControl=Ib;this.pluginScheduler=zc;this.gridView=Jb.g(this.$);this.pff=Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest");this.U4=Ia.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);this.pyd=Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");this.x2=Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:6352308_addTelemetryAtFormulaAssistance");
this.nYc=Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:6488306_BlockFormulasuggestionInPivotTable");this.Qii=Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:6646054_FixNoPreviewBugEnabled");this.pff&&(this.x6b=new da(Qa),this.gridView.Ea.lx(this.yi),this.ndg());this.fqa=new n(this.$,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);this.T8=new k(this.$,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);this.lji=la.a.c5(Qa);this.kxa=la.a.kxa(Qa);this.g_=la.a.g_(Qa);
this.lji&&(this.MEh=new e(this.$));Qa.da.Ga(464,this);this.calcManager=kc;la.a.vV()&&this.Kld();this.x2&&this.gridView.$b.um(this.Ef);this.U4&&(this.x2||this.gridView.$b.um(this.Ef),this.fqa.OFg(this.quf));this.lnd=Ia.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertToSheetGridCell",!1)}function e(Qa){this.$=Qa}function h(Qa,Mb){var kc=this,zc,Ib;this.Kg=Qa;this.$=Mb;this.Bya=function(){kc.M9b.resolve(kc.Kg.Hk);kc.Ibg()};this.Vxf=function(){kc.M9b.reject(null);kc.Ibg()};this.Ef=function(){kc.Kg.Ubb();
kc.vsd=null};null===(Ib=null===(zc=Jb.g(this.$))||void 0===zc?void 0:zc.$b)||void 0===Ib?void 0:Ib.um(this.Ef);this.FDj=Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:6476169_skipGetFieldInfoListContextIfContextLoaded")}function k(Qa,Mb,kc){var zc=zf.call(this,k.SJa())||this;zc.$=Qa;zc.formulaAssistanceUIControl=Mb;zc.formulaAssistanceTelemetryManager=kc;zc.Ya=null;zc.ar=null;zc.zIa=!1;zc.AIa=!1;zc.yIa=!1;zc.wIa=!1;zc.xIa=!1;zc.Ht=null;zc.XW=0;zc.Hq=null;zc.Iv=!1;zc.Ifa=!1;zc.WAa=!1;zc.xSa=!1;zc.wSa=
!1;zc.uOb=We.Dismissed;zc.onRestoreFocus=function(){};zc.dismiss=function(){zc.Iv=!1;zc.Std();zc.wH&&zc.Ya.isEditing&&zc.Rma();zc.Hq=null;zc.formulaAssistanceUIControl&&(zc.formulaAssistanceUIControl.dismiss(zc.domElement),zc.ar.canReceiveFocus=!1,zc.uOb=We.Dismissed)};zc.Rhd=function(){zc.raiseEvent("FAFocusOnSmartSuggestionsCard",null)};zc.Gca=function(Ib,rc){0==rc.Dq&&(170==rc.If.operation.operationName&&zc.formulaAssistanceTelemetryManager.Ojc++,zc.$.userOperationManager.to(zc.Gca))};zc.LOa=function(Ib,
rc){0==rc.Dq&&(12==rc.If.operation.operationName&&zc.$.userOperationManager.Br(zc.Gca),zc.$.userOperationManager.to(zc.LOa))};zc.tKi=function(){zc.dismiss();Jb.g(zc.$).Gi.textBox.focus()};zc.qRa=function(){var Ib={};zc.$Ef?Ib[eb.a.WU]="SmartSuggestionsCard":Ib[eb.a.WU]="FunctionAndSmartSuggestionsCard";zc.$.Cd(802602464,0,8,Ib)};zc.Ef=function(){zc.Gzb&&zc.RJg()};zc.Ozd=function(Ib,rc){zc.Bfb(rc);zc.AIa=!0};zc.Rc=function(){zc.visible=!1};zc.Nzd=function(Ib){zc.xIa=!0;zc.Uqb(Ib)};zc.wh=function(){zc.dismiss()};
zc.$s=function(){void 0!==zc.Hq&&null!==zc.Hq&&zc.Hq()};zc.ar=new X(zc.$,zc.formulaAssistanceUIControl,1,Jd.a.Jbd,zc.Rhd);Jb.g(zc.$).view.Is(zc.$s);Jb.g(zc.$).ha.wG(zc.Rc);zc.$.xa.Mf(zc.wh);zc.Gzb=Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:5523443_FormulaSuggestionsCardUserInteractionTelemetry");zc.N9=Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:6378161_addKeptSmartSuggestionsMetric");zc.Gzb&&Jb.g(zc.$).$b.um(zc.Ef);Ia.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",
!1)&&zc.$.domElement.appendChild(zc.domElement);zc.Bki=Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:6312266_RedesignListBoxEvents");return zc}function n(Qa,Mb,kc){var zc=Fd.call(this,n.SJa())||this;zc.$=Qa;zc.formulaAssistanceUIControl=Mb;zc.formulaAssistanceTelemetryManager=kc;zc.O2=0;zc.ar=null;zc.Hq=null;zc.bla=null;zc.Iv=!1;zc.OQ=!1;zc.Rc=function(){zc.visible=!1};zc.onCardModeChange=function(Ib){zc.GOb(Ib);1===Ib?zc.formulaAssistanceTelemetryManager.h$.argumentAssistanceCollapseCounter++:zc.formulaAssistanceTelemetryManager.h$.argumentAssistanceExpandCounter++};
zc.qRa=function(Ib){var rc={};rc[eb.a.WU]="ArgumentAssistanceCard";var Ta={};Ta.FunctionName=Ib.functionName;rc[eb.a.P$c]=Ta;zc.$.Cd(802602464,0,8,rc)};zc.$s=function(){void 0!==zc.Hq&&null!==zc.Hq&&zc.Hq()};zc.onDismissClick=function(){zc.formulaAssistanceTelemetryManager.h$.argumentAssistanceDismissCounter++;zc.dismiss();zc.raiseEvent("DC");zc.OQ&&zc.OG.clear();0===zc.O2&&zc.GOb(1)};zc.Ef=function(){zc.OQ&&zc.OG.clear()};zc.U4=Ia.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",
!1);zc.WOd();zc.ar=new X(zc.$,zc.formulaAssistanceUIControl,0,Jd.a.Gbd);Jb.g(zc.$).view.Is(zc.$s);Jb.g(zc.$).ha.wG(zc.Rc);zc.OQ=Ia.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",!1)&&Ia.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",!1);zc.OQ&&(zc.OG=new G(zc.formulaAssistanceUIControl,zc.formulaAssistanceTelemetryManager),Jb.g(zc.$).$b.um(zc.Ef));Ia.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",
!1)&&zc.$.domElement.appendChild(zc.domElement);return zc}function f(Qa,Mb,kc,zc,Ib,rc,Ta,Cb,jc){var tc=oe.call(this,Qa)||this;tc.functionInfoManager=Mb;tc.calcManager=zc;tc.instantaneousSupportInformationManager=Ib;tc.formulaAssistanceUIControl=Ta;tc.formulaAssistanceTelemetryManager=Cb;tc.pluginScheduler=jc;tc.Ydc=!1;tc.ar=null;tc.BGa=null;tc.Fg=null;tc.IV=null;tc.Ord=null;tc.C5=null;tc.t3a=0;tc.Z$b=0;tc.K3=0;tc.nJe=0;tc.Tsb=0;tc.reb=0;tc.J5b=0;tc.wxc=!1;tc.Sia=null;tc.Jpc=null;tc.columnName="";
tc.Z5c=!1;tc.Kwe=!1;tc.IJa=[];tc.XP=null;tc.vSa=[];tc.Hq=null;tc.gcd=null;tc.u8=null;tc.Ifa=!1;tc.WAa=!1;tc.xSa=!1;tc.wSa=!1;tc.isCellContentOnlyEqualDuringEdit=!1;tc.ZLa=!1;tc.cla=null;tc.nNa=0;tc.d2d=null;tc.pDb=0;tc.Emd=!1;tc.onRestoreFocus=function(){};tc.Vfb=void 0;tc.Eba=Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");tc.Wef=Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:6592409_startArgumentAssistanceTimerBeforeAutocompleteCalculation");tc.cAb=Ia.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NotifyActiveCellOnEditStarted",
!1);tc.Rhd=function(){tc.Ck&&tc.raiseEvent(f.lbd,null)};tc.QSe=function(){tc.Sia=!1;tc.IV=tc.Ya.text;tc.eh.tJa(tc.Ht,tc.IV,!0,tc.columnName,void 0,!1);1===tc.eh.nq.length&&1===tc.eh.lW.length?(tc.set_visible(!1),tc.Kwe||tc.Qkd()):tc.show()};tc.DNi=function(kd){if(Xc.a(kd))-315732528!==kd.Errors[0].MessageId&&Sa.ULS.sendTraceTag(537162013,0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call failed with Unexpected error : "+Qb.a.Cc(kd.Errors));else if((kd=kd.Result)&&kd.length){tc.Fg.sO||
(tc.Fg.sO={},tc.Fg.sO.HeadersList=[]);tc.Fg.sO.IsFullTableHeaders=!0;for(var Rd=0;Rd<kd.length;++Rd)tc.Fg.sO.HeadersList[Rd]={},tc.Fg.sO.HeadersList[Rd].Index=Rd,tc.Fg.sO.HeadersList[Rd].Name=kd[Rd];tc.KHf(!0);tc.IV=tc.e3e();tc.eh.tJa(tc.Ht,tc.IV,!0,void 0,void 0,!0);tc.show()}else Sa.ULS.sendTraceTag(537162012,0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call returned no results")};tc.CNi=function(kd){kd=rd.a.xf(kd.data);Sa.ULS.sendTraceTag(537162011,0,10,"FormulaAssistanceControl.OnGetTableColHeadersFailure - Webservice call failed with Errors: "+
Qb.a.Cc(kd))};tc.Ttf=function(kd,Rd){tc.gridView.isEditing||tc.gridView.vi||tc.oOa(null===Rd||void 0===Rd?void 0:Rd.cell)};tc.Fh=function(kd,Rd){tc.oOa(null===Rd||void 0===Rd?void 0:Rd.fja)};tc.n6=function(kd,Rd){tc.tMd(Rd.newValue)};tc.Rc=function(){(Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")||tc.Ck)&&tc.set_visible(!1)};tc.Nxf=function(){tc.BGa=null;tc.u8=null};tc.wh=function(){tc.Ck&&tc.H1a()};tc.onFunctionInfoLoaded=function(){tc.Hob()};
tc.Bya=function(){tc.hka?(tc.u8=null,tc.BGa=null,tc.Hob()):tc.Kg.Hk&&tc.tse()};tc.Dca=function(){tc.XP&&Ha(tc.$,tc.XP.HelpId,tc.XP.IsDynamicUdf);return!0};tc.Gca=function(kd,Rd){0==Rd.Dq&&(170==Rd.If.operation.operationName&&tc.formulaAssistanceTelemetryManager.Ojc++,tc.$.userOperationManager.to(tc.Gca))};tc.LOa=function(kd,Rd){0==Rd.Dq&&(12==Rd.If.operation.operationName&&tc.$.userOperationManager.Br(tc.Gca),tc.$.userOperationManager.to(tc.LOa))};tc.H1a=function(){tc.Ck&&tc.Std();tc.wH&&tc.Ya.isEditing&&
tc.Rma();tc.Hq=null;tc.formulaAssistanceUIControl&&(tc.formulaAssistanceUIControl.dismiss(tc.L0b),tc.ar.canReceiveFocus=!1);tc.Emd=!1};tc.JCf=function(){tc.wH&&tc.Rma();tc.A4f();1===tc.AXf.type&&Ia.EwaSettings.tb()&&!tc.Ya.text.includes("\n")&&tc.IEd(tc.AXf)};tc.onDismiss=function(){tc.isListVisible=!1;tc.gridView.Gi.textBox.focus()};tc.qRa=function(){var kd={};tc.eh.vic?kd[eb.a.WU]="SmartSuggestionsCard":kd[eb.a.WU]="FunctionAndSmartSuggestionsCard";tc.$.Cd(802602464,0,8,kd)};tc.Ozd=function(kd,
Rd){tc.eh.teg(Rd);tc.Ck&&(tc.AIa=!0)};tc.Nzd=function(kd){tc.Ck&&(tc.xIa=!0);tc.wH?(tc.MAe(),tc.N9&&tc.YVf(),tc.gridView.Gi.endEdit(!0,"FormulaAssistanceControl.OnCompletionItemClicked",0)):kd.textEdit?tc.Uqb(kd.textEdit):tc.Ly(!0)};tc.qp=Jb.g(Qa);tc.domElement.className=df.a.LMe;tc.Kg=rc.A3c(Qa,kc);tc.x6b=new da(Qa);tc.qyg=kc;f.mkd||(f.mkd=f.SJa());tc.domElement.innerHTML=f.mkd;tc.Oyd=RegExp("\\d+");zd.d(tc.style,tc.$.isChromeRtl);tc.gja=new T(tc.$,tc.domElement,tc.functionInfoManager,tc.formulaAssistanceUIControl,
tc.formulaAssistanceTelemetryManager,tc.pluginScheduler);Mb=$get(Aa.dcd,tc.domElement);kc=$get(Aa.$bd,tc.domElement);zc=$get(Aa.fcd,tc.domElement);tc.Opg=new y(tc.$,Mb,zc,kc,tc);tc.Kg.NZb(tc.Bya);tc.functionInfoManager.JYa(tc.onFunctionInfoLoaded);tc.functionInfoManager.jGg(tc.Nxf);tc.L0b=tc.domElement;tc.Ck&&(tc.$.xa.Mf(tc.wh),tc.eh.yVc(tc.JCf),Ia.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&(tc.L0b=document.createElement("div")));tc.OSa(!0);tc.S7f(!0);
tc.$.domElement.appendChild(tc.L0b);tc.FQc=0;(kc=ke.a(Qa))&&tc.IJa.push(new S(Qa,kc,tc,tc.formulaAssistanceTelemetryManager));tc.IJa.push(new S(Qa,tc.qp.Wb,tc,tc.formulaAssistanceTelemetryManager));tc.Hub=tc.IJa[0];tc.eqb=tc.IJa[tc.IJa.length-1];Qa.da.Ga(221,tc);tc.instantaneousSupportInformationManager||tc.$.da.Za(268,function(kd){tc.instantaneousSupportInformationManager=kd});tc.gSe=Ia.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1);Ia.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",
0)&&(void 0===tc.formulaAssistanceTelemetryManager.Rda.anyPluginInitialized?Sa.ULS.sendTraceTag(523511372,0,15,"FormulaAssistanceControl - tried to initiailize mockSetActiveCellExperimentStage before pluginInitialized data is set."):tc.formulaAssistanceTelemetryManager.Rda.anyPluginInitialized||(tc.pDb=Ia.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)));tc.VAa=la.a.g_(tc.$);tc.xyc=la.a.kxa(tc.$);tc.pyd=Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");
tc.x2=Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:6352308_addTelemetryAtFormulaAssistance");tc.nYc=Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:6488306_BlockFormulasuggestionInPivotTable");la.a.vV()&&tc.Kld();la.a.YM(tc.$)&&Mb.classList.add("ewa-fb-refactor");tc.Ck?tc.gridView.ha.wG(tc.Rc):tc.gridView.ha.qP(tc.Rc);tc.ar=new X(tc.$,tc.formulaAssistanceUIControl,1,Jd.a.Jbd,tc.Rhd);tc.lnd=Ia.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertToSheetGridCell",!1);tc.N9=Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:6378161_addKeptSmartSuggestionsMetric");
tc.mdf=Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:6279033_logAutocompletionStatistics");tc.zji=Ia.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceGridView",!1);tc.Edf=Ia.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixKeydownLayoutTrashingBottleneck",!1)&&Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:6347847_FormulaAssistanceLayoutFix");return tc}function v(){}function m(){this.callbacks=this.completionItems=null;this.activeItemIndex=0}function x(){this.onRestoreFocus=
this.onDismiss=this.onFeedback=this.onCompletionItemCommitted=this.onCompletionItemSelected=null}function l(){this.B9=this._name=null}function u(){this._name=null}function A(){this._name=null}function z(){this.B9=this._name=null}function y(Qa,Mb,kc,zc,Ib){Qa=De.call(this,Qa,Mb)||this;Qa.nra=null;Qa.qvc=0;Qa.MMb=0;Qa.L3b=null;Qa.AVe=kc;Qa.Oub=zc;Qa.formulaAssistanceControl=Ib;Qa.nq=[];Qa.lW=[];Qa.Ck=la.a.V4();Qa.rff=Qa.Ck&&Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:5931218_FaAvoidDomOperations");
return Qa}function w(){this.textEdit=this.label=null;this.kind=0;this.shouldRequestAutocompleteOnCommit=this.isPrefixed=this.detail=this.type=null}function D(Qa,Mb){this.$=Qa;this.items=Mb;this.g_=la.a.g_(this.$)}function H(Qa,Mb){this.w1i=Qa;this.Zrf=Mb}function F(){}function J(Qa){this.index=Qa}function S(Qa,Mb,kc,zc){Qa=he.call(this,Qa,Mb)||this;Qa.formulaAssistanceControl=kc;Qa.formulaAssistanceTelemetryManager=zc;Qa.ZEf=!1;Qa.eSa=null;Qa.Wkd=0;Qa.cGc=null;Qa.gIa=null;Qa.YP=0;Qa.Tob=Mb.textBox;
Qa.Ck=la.a.V4();Qa.Uaj=Ia.EwaSettings.tb();Qa.x2=Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:6352308_addTelemetryAtFormulaAssistance");return Qa}function N(){this.Sha=this.Osa=this.Psa=!1;this.mFf=40;this.Ize=41;this.d0a=this.ACd=this.BCd=this.mGb=0;this.hwf=!0;this.hBd=!1;this.PTe=this.hNd=-1}function T(Qa,Mb,kc,zc,Ib,rc){var Ta=Ec.call(this,T.SJa(la.a.V4()))||this;Ta.$=Qa;Ta.Aj=Mb;Ta.functionInfoManager=kc;Ta.formulaAssistanceUIControl=zc;Ta.formulaAssistanceTelemetryManager=Ib;Ta.pluginScheduler=
rc;Ta.T1a=null;Ta.O2=0;Ta.ar=null;Ta.WWc=!1;Ta.Hq=null;Ta.bla=null;Ta.aSa=!0;Ta.OQ=!1;Ta.Eba=Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");Ta.Wef=Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:6592409_startArgumentAssistanceTimerBeforeAutocompleteCalculation");Ta.onCardModeChange=function(Cb){Ta.GOb(Cb);1===Cb?Ta.formulaAssistanceTelemetryManager.h$.argumentAssistanceCollapseCounter++:Ta.formulaAssistanceTelemetryManager.h$.argumentAssistanceExpandCounter++};
Ta.qRa=function(Cb){var jc={};jc[eb.a.WU]="ArgumentAssistanceCard";var tc={};tc.FunctionName=Cb.functionName;jc[eb.a.P$c]=tc;Ta.$.Cd(802602464,0,8,jc)};Ta.onDismissClick=function(){Ta.formulaAssistanceTelemetryManager.h$.argumentAssistanceDismissCounter++;Ta.aSa=!1;Ta.Isb();Ta.OQ&&Ta.OG.clear();0===Ta.O2&&Ta.GOb(1)};Ta.Ef=function(){Ta.aSa=!0;Ta.OQ&&Ta.OG.clear()};Ta.RLi=function(Cb){Cb.button===Sys.UI.MouseButton.leftButton&&Cb.target&&(Ub.g(Cb),Ta.T1a&&Ta.T1a.DSa(Cb))};Ta.$s=function(){void 0!==
Ta.Hq&&null!==Ta.Hq&&Ta.Hq()};Ta.Ck=la.a.V4();Ta.U4=Ta.Ck&&Ia.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);Ta.Ck?(Ta.WOd(),Ta.ar=new X(Ta.$,Ta.formulaAssistanceUIControl,0,Jd.a.Gbd),Ta.U4&&Jb.g(Ta.$).$b.um(Ta.Ef),Ta.OQ=Ia.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",!1)&&Ia.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",!1)&&!!Ta.formulaAssistanceUIControl,Ta.OQ&&(Ta.OG=new G(Ta.formulaAssistanceUIControl,
Ta.formulaAssistanceTelemetryManager)),Ia.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&Ta.$.domElement.appendChild(Ta.domElement)):(Ta.T1a=new B(Ta.domElement,Ta.$.jE,void 0,la.a.YM(Ta.$)),Ta.zc.ka("mousedown",Ta.RLi),Qa=$get(Aa.dcd,Ta.Aj),Ta.Aj.insertBefore(Ta.domElement,Qa));Jb.g(Ta.$).view.Is(Ta.$s);return Ta}function G(Qa,Mb){this.HJa=Qa;this.formulaAssistanceTelemetryManager=Mb;this.Zm=!1;Qa={};this.Fea=(Qa[ee.Drag]=0,Qa[ee.Move]=0,Qa);this.uDc=this.HJa.getWindowEdgeBuffer()+
1;this.Wqf=new K(this);this.BJe=new I(this)}function I(Qa){this.OG=Qa;this.Zm=!1}function K(Qa){var Mb=this;this.OG=Qa;this.QZ=this.fRd=this.Zm=!1;this.onKeyDown=function(kc){return!Mb.QZ&&kc.keyCode===Oc.a.Soa&&kc.altKey&&kc.ctrlKey?(Mb.v8b(),kc.stopPropagation(),kc.preventDefault(),!0):!1};this.bNa=function(kc){if(!Mb.QZ)return!1;if(kc.eventName===de.a.Lb){var zc=kc.Ca.ctrlKey?1:kc.Ca.shiftKey?50:10;switch(kc.Ca.keyCode){case Oc.a.$Ta:Mb.a6(0,-zc);break;case Oc.a.Qoa:Mb.a6(0,zc);break;case Oc.a.Roa:Mb.a6(-zc,
0);break;case Oc.a.Lfb:Mb.a6(zc,0);break;case Oc.a.pL:case Oc.a.Qh:Mb.fRd=!0;break;default:return!1}}kc.eventName===de.a.Fd&&Mb.fRd&&Mb.b4(!0);kc.Ca.preventDefault();return!0};this.LGb=function(kc){if(!Mb.QZ)return!1;kc.Ca.preventDefault();Mb.b4();return!0};this.onBlur=function(){if(!Mb.QZ)return!1;Mb.b4();return!0};this.hr=td.KeyInputManager.instance;this.pointerInputManager=Nb.a.instance}function L(){this.callbacks=this.functionRenderingInfo=null;this.cardMode=0}function O(){this.onDismissClick=
this.onFeedback=this.onHelpLink=this.onCardModeChange=null}function B(Qa,Mb,kc,zc){zc=void 0===zc?!1:zc;Mb=Q.call(this,Qa,Mb,!1,void 0===kc?null:kc)||this;Mb.MRa(zc);Mb.Vi=Ob.a.equals("rtl",Qa.dir,!0);return Mb}function Q(Qa,Mb,kc,zc){var Ib=Zb.call(this,Qa,void 0===zc?null:zc)||this;Ib.O3=null;Ib.BUd=!1;Ib.hNb=!1;Ib.R1a=null;Ib.N7=null;Ib.offsetParent=null;Ib.LGi=null;Ib.EJc=!1;Ib.Tsg=null;Ib.$zd=function(rc){return Ib.q6(rc)};Ib.Zzd=function(rc){return Ib.sN(rc)};Ib.Iwf=function(rc){var Ta=oc.HelperMethods.Fn(rc);
Ta.button===Sys.UI.MouseButton.leftButton&&2===rc.nb&&(Ib.Ynd(Ta.target)||Ib.DSa(Ta));return!1};Ib.z5d=Mb;kc&&(Ib.BUd=!0,Nb.a.instance.ra(de.a.pointerDown,Ib.FJe,Ib.Iwf));Ib.rfa=!1;return Ib}function U(Qa,Mb){var kc=sd.call(this)||this;kc.Tpg=[];kc.hcd={};kc.icd={};kc.ZS=null;kc.U8=[];kc.PJa={};kc.byf=function(zc,Ib){Sa.ULS.sendTraceTag(537161987,0,50,"FunctionInfoManager.OnGetFunctionListPartialSucceeded");kc.Oxf(zc,!!Ib&&1!==Ib.FilterType,!0)};kc.ayf=function(){Sa.ULS.sendTraceTag(537161986,0,50,
"FunctionInfoManager.OnGetFunctionListPartialFailed -  reset varaible to ensure we will re-issue the webservice call");kc.ZS=null};kc.Lxf=function(zc){Sa.ULS.sendTraceTag(537161985,0,50,"FunctionInfoManager.OnFullFunctionListLoaded - full list was loaded");kc.EHd(zc.oja,!0,!1)};kc.$xf=function(zc){Sa.ULS.sendTraceTag(537161984,0,50,"FunctionInfoManager.OnGetFunctionListFullSucceeded");kc.Oxf(zc,!0,!1)};kc.gLc=!1;kc.eLc=!1;kc.ib=Qa;kc.pluginScheduler=Mb;kc.$.da.Ga(19,kc);return kc}function X(Qa,Mb,
kc,zc,Ib){this.vka=this.OZc=!1;this.$=Qa;this.formulaAssistanceUIControl=Mb;this.aVe=kc;this.$mj=zc;this.A5e=void 0===Ib?null:Ib;this.vka=Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:6592066_FixAutoCompleteCardFocusBug")}function P(Qa,Mb,kc){var zc=lc.call(this)||this;zc.ecd=Qa;zc.vNd=Mb;zc.AXi=kc;return zc}function ea(Qa){var Mb=Oe.call(this)||this;Mb.vNd=Qa;return Mb}function ia(Qa,Mb){var kc=bf.call(this)||this;kc.functionName=Qa;kc.ecd=Mb;return kc}function da(Qa){this.aHe={};this.$=Qa}function xa(){this.sheetName=
this.namedRange=this.tooltip=this.name=null;this.type=0}function Z(Qa){this.cT=0;this.Y8d=!1;this.WVa=this.t$d=null;this.xsg=void 0===Qa?!1:Qa;this.textEdit=null}function ha(Qa){var Mb=this;this.Xrb=this.Dha=this.calcManager=this.Ya=null;this.N9a=function(){Mb.p5a(!1,!1)};this.$=Qa;this.Gub=new va(Qa);this.N$b=new ba(Qa);this.O$b=new ya(this);Jb.g(Qa).Wb.um(this.N9a);this.$.da.Ga(317,this)}function ya(Qa){this.V7=0;this.Hbd=Qa}function va(Qa){this.Aqa=this.QSa=this.r2a=this.OP=this.S$=this.Ya=null;
this.Yid=!1;this.Ec=Qa}function bb(){}function ba(Qa){var Mb=this;this.wAi=30;this.calcManager=null;this.Ad=!1;this.ZOa=this.BGb=this.T$a=null;this.fy=function(){Mb.Fha.WZ()};this.$=Qa;this.Fha=new ra;this.hTf=-1;this.$.ea.VD(this.fy)}function fa(Qa,Mb,kc,zc,Ib,rc,Ta){Ta=Qa.Na(1,void 0===Ta?null:Ta);Ta.getPartialCalcResultsParameters=Mb;return md.g(Qa,"GetPartialCalcResults",Ta,kc,zc,Ib,rc,4)}function ra(){this.IQa={}}function pa(Qa){var Mb=nc.call(this)||this;Mb.$=Qa;Mb.Eb();return Mb}function Za(Qa,
Mb){var kc=this;this.OJa=this.Mua=this.hja=null;this.vBf=function(zc,Ib){kc.S6i(Ib.functionName,Ib.ecd)};this.xBf=function(zc,Ib){kc.R6i(Ib.ecd,Ib.vNd,Ib.AXi)};this.wBf=function(zc,Ib){zc=[];Ib=ik(Ib.vNd);for(var rc=Ib.next();!rc.done;rc=Ib.next())rc=rc.value,(!kc.wwa||void 0!==rc&&null!==rc)&&(rc=rc.trim())&&zc.push(rc);if(!kc.wwa||zc.length){Ib="";for(rc=0;rc<zc.length;rc++){var Ta=kc.XYc(zc[rc]),Cb=Za.$Dd(rc,zc.length);Ib+=Ta+Cb;Cb&&(Ib+=kc.ariaLiveNotifier.Mxa)}kc.ariaLiveNotifier.readText(Ib)}};
this.yBf=function(zc,Ib){kc.ariaLiveNotifier.U6i(Ib.JF,Ib.description,Ib.selectedIndex.toString(),Ib.length.toString())};this.rBf=function(zc,Ib){kc.ariaLiveNotifier.yMf(Ib.description,Ib.length)};this.Gxf=function(){kc.ariaLiveNotifier.Sab(ub.a.instance.ga(881),eb.a.AZa)};this.zxf=function(){kc.ariaLiveNotifier.readText(ub.a.instance.ga(882))};this.Cxf=function(){kc.ariaLiveNotifier.readText(ub.a.instance.ga(883))};this.$=Mb;this.ariaLiveNotifier=Qa;this.$.da.Ga(219,this);this.wwa=la.a.V4()}function Ua(Qa){return xb.call(this,
Qa)||this}function Ma(Qa,Mb,kc){var zc=this;this.$=Qa;this.Va=Mb;this.functionInfoManager=kc;this.BFh="FinancialFns LogicalFns TextFns DateTimeFns LookupReferenceFns MathTrigFns StatisticalFns EngineeringFns CubeFns InformationFns".split(" ");this.menuId=null;this.onFunctionInfoLoaded=function(){zc.menuId&&zc.BFh.includes(zc.menuId)&&zc.frame.Pw(zc.menuId)};this.f_=la.a.f_(this.$);this.Nwa=la.a.Nwa(this.$);this.ymi=la.a.ipd();this.f_&&(this.formulaAssistanceManager=this.$.da.za(464));this.BY={};this.frame=
this.$.frame;this.functionInfoManager.JYa(this.onFunctionInfoLoaded);this.formulaAssistanceTelemetryManager=Qa.da.za(491)}function oa(Qa){return Qa.Params.split("!")[0].split(",").map(function(Mb){return{name:Mb,description:"Mock description for param "+Mb+". How Mmuch wood would a wood chuck chuck if a wood chuck would chuck wood",type:"text"}})}function ja(Qa,Mb){var kc=Mc.call(this,Qa)||this;kc.X$b=Mb;kc.vFh=function(zc,Ib){var rc;1===zc&&(kc.hide(),zc={},Ib=(zc[Wb.a.Mc]=kc.X$b.NameUI,zc.functionArgs=
null!==(rc=Ib.functionArgs)&&void 0!==rc?rc:[],zc.ibdk=!0,zc),rc=new yb.a(-433697611,0,kc.$.Jc,8,null),kc.$.Ka.Kb(rc,Ib))};kc.wJh=function(zc){return{name:"argument_"+zc,description:"mock argument description. she sells sea shells at the sea shore shop",type:"number"}};kc.zl=ub.a.instance.ga(1027);kc.qg();return kc}function ta(Qa,Mb){var kc=Ic.call(this,Qa,ub.a.instance.ga(1026),void 0,void 0,void 0,Ia.EwaSettings.ma(397))||this;kc.NJa=null;kc.nja=null;kc.MJa=null;kc.Qub=null;kc.xVe=null;kc.mja=null;
kc.yVe=null;kc.BVe=null;kc.Elf=null;kc.Pub=null;kc.njd=!1;kc.j2b=null;kc.c6=null;kc.Exb=null;kc.onFunctionInfoLoaded=function(){if(!kc.MJa.count){for(var zc=kc.functionInfoManager.Zbd,Ib=0,rc=zc.length;Ib<rc;++Ib)kc.MJa.WL(zc[Ib],zc[Ib],!1).className=Yb.a.qph;kc.MJa.selectedIndex=0;sa.a.oc([kc.j2b,kc.c6,kc.Exb]);kc.j2b=kc.je.Td(kc.NJa);kc.c6=kc.je.Td(kc.nja);kc.Exb=kc.je.Td(kc.Pub);kc.j2b.ka("change",kc.Mxf);kc.c6.ka("change",kc.SLi);kc.c6.ka("dblclick",kc.TLi);kc.Exb.ka("click",kc.Dca);kc.Exb.ka("keyup",
kc.ZNi);Oa.DOMElementExtensions.setVisible(kc.nja,!0);Oa.DOMElementExtensions.setVisible(kc.xVe,!1);kc.$.m5c&&Oa.DOMElementExtensions.setVisible(kc.Elf,!0)}kc.Mxf(null);kc.getButton(0).get_element().disabled=!1;kc.NJa.disabled=!1;kc.ERa();kc.njd=!0};kc.Dca=function(){kc.baa&&Ha(kc.$,kc.baa.HelpId,kc.baa.IsDynamicUdf)};kc.ZNi=function(zc){13!==zc.keyCode&&32!==zc.keyCode||kc.Dca(zc)};kc.Mxf=function(){var zc=kc.functionInfoManager.xbc(kc.MJa.fe.value);kc.Qua(zc);kc.nja.scrollTop=0;kc.uZf()};kc.SLi=
function(){kc.uZf()};kc.TLi=function(zc){kc.baa&&(Ub.g(zc),kc.close(0))};kc.Uc=function(zc,Ib){lb.b(Ib)&&kc.Lt()};kc.functionInfoManager=Qa.da.za(19);kc.formulaAssistanceControl=Qa.da.za(221);kc.Ibd=la.a.f_(kc.$);kc.Ibd&&(kc.formulaAssistanceManager=Qa.da.za(464));kc.QA=Mb;kc.t_c=Mb.textBox.caretPosition;return kc}function aa(Qa){var Mb=ca.call(this,Qa)||this;Mb.uVe=function(kc,zc){1===kc&&(Mb.hide(),kc={},zc=(kc[Wb.a.Mc]=zc.functionName,kc.ibdk=!0,kc),kc=la.a.Nwa(Mb.$)?1117706454:-433697611,kc=new yb.a(kc,
0,Mb.$.Jc,8,null),Mb.$.Ka.Kb(kc,zc))};Mb.onFunctionInfoLoaded=function(){Mb.functionInfoManager.vbb(Mb.onFunctionInfoLoaded);Mb.v$e()};Mb.d7h=function(kc){Ea(Mb.$,kc,!1)};Mb.vff=function(kc){return!Mb.functionInfoManager.Pgc(kc)};Mb.zl=ub.a.instance.ga(1026);Mb.functionInfoManager=Qa.da.za(19);Mb.qg();return Mb}function ma(Qa){var Mb=Ka.a.Q_,kc=Qa.da.za(368);kc&&!Jb.g(Qa).pj&&(Mb=kc.zoom);return Mb}function Ea(Qa,Mb,kc){if(kc){if(Mb&&(!Mb||Mb.startsWith("http://")||Mb.startsWith("https://"))){if(Qa.ma(157)&&
(Qa=Object($a.a)({qEb:269,new:Ba.a,registry:Qa.da}))&&Qa.HBa(Mb))return;oc.HelperMethods.Te(Mb,"_blank",dc.a)}}else oc.HelperMethods.$V(Qa.$F,"XLWAEndUser_"+Mb,Qa.tS)}function Ha(Qa,Mb,kc){if(Qa){var zc=Qa.da.za(491);zc?zc.h$.argumentAssistanceLearnMoreCounter++:Sa.ULS.sendTraceTag(523551513,0,50,"FormulaAssistanceExtensions: logHelpLinkClick getService returned a null formulaAssistanceManager");kc?Ea(Qa,Mb,kc):(kc=new yb.a(-859308420,Wb.a.Cb,Qa.Jc,0,null),zc={},Mb=(zc[Wb.a.Mc]=eb.a.GQ,zc[Wb.a.Wf]=
"HelpID="+Mb,zc),Qa.Ka.Kb(kc,Mb))}}function Aa(){}var V=b(10),La=b(0),Ra=b(915),pb=b(50),cb=b(37),Sa=b(15),Db=b(19),Ab=b(412),Wb=b(76);Aa.i$c="!";Aa.wFf="[";Aa.vFf="]";Aa.openParen="(";Aa.closeParen=")";Aa.thg=" /.(*\\".split("");Aa.Z7b="...";Aa.lGb="param_help_link";Aa.VCd="param_help_udf";Aa.dcd="function_list_box";Aa.GFh="function_param_box";Aa.fcd="function_reader_description";Aa.$bd="function_description_box";Aa.zVe="function_param_table";Aa.zXi="param_row_";Aa.WCd="param_set";Aa.dGf="param_row_0";
Aa.eGf="param_row_1";Aa.HFh="<div id='{0}' class='{1}'></div>";Aa.FFh="<div id='{0}' class='{1} {2} {3}'>\r\n\t<table id='{4}'>\r\n\t\t{5}\r\n\t\t{6}\r\n\t</table>\r\n</div> ";Aa.fGf="<tr>\r\n\t<td id='{0}'>\r\n\t\t<span id='{0}_{1}' class='{2}'></span>\r\n\t\t<a href = '#' id='{0}_{3}' class='{4}'></a>\r\n\t\t<span id ='{0}_{5}'></span>\r\n\t</td>\r\n</tr>";Aa.CFh="<div id='{0}' class='{1} {2} {3}'></div>";Aa.zFh="<div id='{0}' class='{1} {2} {3} {4}'></div>";Aa.Akf="[@";Aa.e5g=1;Aa.d5g=3;Aa.meh=
500;Aa.Xpf=50;Object(La.a)(Aa,"FormulaAssistanceConstants",null,[]);var ub=b(14),vb=b(300),Ka=b(9),eb=b(5),yb=b(91),oc=b(11),Jb=b(21),dc=b(376),$a=b(477),Ba=b(374),la=b(36),ka;(function(Qa){Qa.CategoryList="categoryList";Qa.FunctionsMap="functionsMap";Qa.FunctionIdsToDisplay="functionIdsToDisplay";Qa.RefreshListCallback="refreshListCallback";Qa.HelpCallback="helpCallback";Qa.InitialCategory="initialCategory";Qa.AllCategoryName="allFunctionsCategoryName"})(ka||(ka={}));Object(La.b)("PropsKeys",ka);
var ca=vb.a;$k(aa,ca);aa.prototype.qg=function(){this.functionInfoManager.i2a({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0);this.Rb=1;this.functionInfoManager.h_?this.v$e():this.functionInfoManager.JYa(this.onFunctionInfoLoaded)};aa.prototype.v$e=function(){var Qa;this.J_b=this.functionInfoManager.Y$b.filter(this.vff);var Mb=null!==(Qa=aa.ujf)&&void 0!==Qa?Qa:aa.s1g;Qa=this.functionInfoManager.Zbd;var kc=this.functionInfoManager.xbc(Mb).map(function(Ib){return Ib.FunctionIndex}),zc={};
this.Ax=(zc[aa.Hu]=this.mc,zc[ka.CategoryList]=Qa,zc[ka.FunctionsMap]=this.X7g(),zc[ka.FunctionIdsToDisplay]=kc,zc[ka.RefreshListCallback]=this.tOi.bind(this),zc[ka.HelpCallback]=this.d7h,zc[ka.InitialCategory]=Mb,zc[ka.AllCategoryName]=aa.AllCategoryName,zc);this.initializeAndShow(this.zl,this.uVe,this.Ax)};aa.prototype.X7g=function(){var Qa={};this.J_b.forEach(function(Mb){Qa[Mb.FunctionIndex]=Mb});return Qa};aa.prototype.KSj=function(Qa){Qa=Qa.map(function(Mb){return Mb.FunctionIndex});this.Ax[ka.FunctionIdsToDisplay]=
Qa;this.ITa(this.zl,this.B4a(this.uVe),this.Ax)};aa.prototype.tOi=function(Qa,Mb){Mb?Mb=this.cBh(Mb):(Mb=this.functionInfoManager.xbc(Qa).filter(this.vff),aa.ujf=Qa);this.KSj(Mb)};aa.prototype.cBh=function(Qa){Qa=void 0===Qa?"":Qa;Qa=Qa.toLocaleLowerCase();var Mb=this.J_b.filter(function(kc){return kc.NameUI.toLocaleLowerCase().startsWith(Qa)});3<=Qa.length&&(Mb.push.apply(Mb,kk(this.J_b.filter(function(kc){return kc.NameUI.toLocaleLowerCase().includes(Qa)&&!Mb.includes(kc)}))),Mb.push.apply(Mb,kk(this.J_b.filter(function(kc){return kc.Help.toLocaleLowerCase().includes(Qa)&&
!Mb.includes(kc)}))));return Mb};of.Object.defineProperties(aa.prototype,{mc:{configurable:!0,enumerable:!0,get:function(){return"FunctionDialog"}}});aa.AllCategoryName=ub.a.instance.ga(1025);aa.s1g=ub.a.instance.ga(1024);aa.ujf=void 0;Object(La.a)(aa,"FunctionDialog",vb.a,[]);var Ia=b(1),jb=b(95),nb=b(58),Na=b(63),sa=b(87),Wa=b(27),Hb=b(221),Yb=b(71),Sb=b(118),lb=b(238),wb=b(53),wa=b(948),Oa=b(12),Ub=b(69),hb=Yb.a.pph,Xb=Yb.a.lNe,Gc=Yb.a.mNe,uc=Yb.a.f9c,Nc=Yb.a.rph,Fb=Yb.a.vph,ob=Yb.a.hNe,zb=Yb.a.pNe,
ib=Yb.a.tph,fc=Yb.a.iNe,Ic=Hb.a;$k(ta,Ic);ta.prototype.initialize=function(){this.Hb.classList.add(Yb.a.nph);this.Hb.innerHTML=ta.JG();this.Ae||(this.Dl(),this.A2());Ic.prototype.initialize.call(this);var Qa=Oa.DOMElementExtensions.Bj(this.Hb,fc);this.rtl&&(Qa.align="right",this.Pub.style.marginLeft="5px");this.Ae&&(Qa.style.padding="1px");this.functionInfoManager.i2a({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0)};ta.prototype.dispose=function(){this.functionInfoManager&&(this.functionInfoManager.vbb(this.onFunctionInfoLoaded),
this.functionInfoManager.$.ea.wk(this.Uc));sa.a.oc([this.j2b,this.c6,this.Exb,this.MJa,this.Qub]);Ic.prototype.dispose.call(this)};ta.prototype.Dl=function(){this.NJa=Oa.DOMElementExtensions.Bj(this.Hb,hb);this.nja=Oa.DOMElementExtensions.Bj(this.Hb,Xb);this.NJa.setAttribute(eb.a.Gd,eb.a.l0b);this.MJa=new wa.a(this.NJa,!0);this.Qub=new wa.a(this.nja,!0);this.xVe=Oa.DOMElementExtensions.Bj(this.Hb,Fb);this.Pub=Oa.DOMElementExtensions.Bj(this.Hb,Nc);this.BVe=Oa.DOMElementExtensions.Bj(this.Hb,zb);this.Elf=
Oa.DOMElementExtensions.Bj(this.Hb,ib);this.yVe=$get(ta.acd,this.Hb);this.mja=Oa.DOMElementExtensions.Bj(this.Hb,ob);this.Ae&&(this.mja.style.paddingLeft="1px");this.functionInfoManager.JYa(this.onFunctionInfoLoaded);this.functionInfoManager.$.ea.Vj(this.Uc)};ta.prototype.HQ=function(Qa){var Mb=this;this.$.da.Za(40,function(){Mb.MJa.HQ(Qa)})};ta.prototype.rn=function(){this.Ibd?this.formulaAssistanceManager.a7b():this.formulaAssistanceControl.set_visible(!1);Ic.prototype.rn.call(this);this.njd||(this.getButton(0).get_element().disabled=
!0)};ta.prototype.setFocus=function(){!this.NJa.disabled&&this.njd&&Oa.DOMElementExtensions.setFocus(this.NJa)};ta.prototype.commit=function(){return!0};ta.prototype.Tqb=function(){var Qa=this,Mb=this.baa.NameDataStrings;if(Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements")){var kc=new yb.a(-433697611,0,this.$.Jc,8,null),zc={};zc=(zc[Wb.a.Mc]=Mb,zc);this.$.Ka.Kb(kc,zc)}else{Mb+=Aa.openParen;kc=Jb.g(this.$);kc.view.visibleArea.contains(kc.gg(null))||kc.er(kc.ha.sa.activeCell,
3,jb.a.AFh);var Ib=this.QA.textBox;if(this.QA.isEditing&&this.QA.text){zc=this.QA.text;var rc=this.t_c?zc.substring(0,this.t_c):"=";this.QA.text=rc+Mb+zc.substring(this.t_c+(Ib.kv?Ib.kv.length:0),zc.length);Ib.caretPosition=rc.length+Mb.length}else cb.TaskExtensions.Aa(kc.startEdit(!0,1),function(){Qa.QA.text="="+Mb;var Ta=Mb.length+1;Ib.xRa(Ta);Ib.caretPosition=Ta},this.la,11,Na.a.current);kc.pj&&(kc=kc.Wb,kc.text=Ib.text,kc.setCaretPosition(Ib.caretPosition));(kc=this.QA.vY.get(Ab.a.s3a))&&kc.hU(!1)}};
ta.prototype.Asa=function(){this.Ibd?this.formulaAssistanceManager.zda():this.formulaAssistanceControl.Hob()};ta.prototype.Qua=function(Qa){this.Qub.clear();for(var Mb=ta.acd+" "+ta.sVe,kc=0,zc=Qa.length;kc<zc;++kc){var Ib=this.Qub.WL(Qa[kc].NameUI,Qa[kc].FunctionIndex.toString(),!1);Wa.a.Xu&&Ib.classList.add(uc);Ib.setAttribute(eb.a.ZD,ta.tVe);Ib.setAttribute(eb.a.yG,Mb)}this.Qub.selectedIndex=0};ta.prototype.uZf=function(){if(this.baa){this.Pub.parentNode.className=Yb.a.iNe+(this.functionInfoManager.Pgc(this.baa)?
"-udf":"");var Qa=this.baa.NameDataStrings;this.BVe.innerText=Qa;this.Pub.innerText=Qa;this.mja.innerText=this.baa.Help;Qa=this.baa.Params.split(Aa.i$c);this.yVe.innerText=Aa.openParen+(1<Qa.length?Aa.Z7b:Qa[0])+Aa.closeParen}};ta.JG=function(){return String.format("<div class='"+Yb.a.oph+"'>\r\n\t<label for='{6}'>{0}</label>\r\n\t<select id='{6}' class='{9}' disabled='true'></select>\r\n</div>\r\n<div class='"+Sb.a.Dn+"'>{1}</div>\r\n<div class='"+Yb.a.gNe+"'>\r\n\t<select id='{16}' class='{17} "+
Db.a.Hp+" "+Db.a.Mo+"' size='{8}'></select>\r\n\t<div class='{11}' >{2}</div>\r\n</div>\r\n<div class='"+Yb.a.sph+"'>\r\n\t<div style='direction:ltr' class='{15}'>\r\n\t\t<span class='{14} "+Db.a.Hp+"'>\r\n\t\t\t<span class='"+Db.a.HA+" "+Yb.a.uph+"'>\r\n\t\t\t\t<img title='{3}' class='"+Db.a.Ruh+"' src='{4}'/>\r\n\t\t\t</span>\r\n\t\t</span>\r\n\t\t<span id='{19}' class='{13}'></span>\r\n\t\t<a tabindex='0' title='{5}' class='{10}'></a>\r\n\t\t<span id='{7}'></span>\r\n\t</div>\r\n\t<div id='{18}' class='{12}'></div>\r\n</div>",
ub.a.instance.ga(1029),ub.a.instance.ga(1030),ub.a.instance.ga(739),ub.a.instance.mb(3),wb.a.df(13),ub.a.instance.ga(1031),ta.yFh,ta.acd,7,hb,Nc,Fb,ob,zb,ib,fc,ta.DFh,Xb+(Wa.a.Xu?" "+Gc:""),ta.sVe,ta.tVe)};of.Object.defineProperties(ta.prototype,{mc:{configurable:!0,enumerable:!0,get:function(){return"FunctionDeprecatedDialog"}},baa:{configurable:!0,enumerable:!0,get:function(){if(!this.nja||!this.nja.firstChild)return null;var Qa=Number.parseInvariant(this.nja.children[this.nja.selectedIndex].value);
return this.functionInfoManager.uQh(Qa)}}});ta.acd="function_dialog_param_string";ta.sVe="function_dialog_function_description";ta.tVe="function_dialog_function_name";ta.DFh="function_list";ta.yFh="function_category";Object(La.a)(ta,"FunctionDeprecatedDialog",Hb.a,[]);var Yc=b(276),Mc=vb.a;$k(ja,Mc);ja.prototype.qg=function(){this.Rb=1;var Qa={};this.Ax=(Qa[Yc.a.Hu]=this.mc,Qa.functionInfo=this.X$b,Qa.initialArgs=this.xJh(this.X$b),Qa.evaluateCallback=this.BUg,Qa.generateArgByIndex=this.wJh,Qa.helpCallback=
this.$V,Qa.isModal=!1,Qa);this.initializeAndShow(this.zl,this.vFh,this.Ax)};ja.prototype.$V=function(){Ea(this.$,this.X$b.HelpId,!1)};ja.prototype.BUg=function(){return"42"};ja.prototype.xJh=function(Qa){return oa(Qa)};of.Object.defineProperties(ja.prototype,{mc:{configurable:!0,enumerable:!0,get:function(){return"FunctionArgumentsDialog"}}});Object(La.a)(ja,"FunctionArgumentsDialog",vb.a,[]);Ma.prototype.Nc=function(Qa,Mb){if(!Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements"))return!1;
switch(Mb){case 753860909:case -2060563418:case 1117706454:case 917756490:case -1756230110:case -1702465186:case -977299160:case 2135922458:case -1960662393:case -1999560076:case 493672674:case -1031255406:case 548833656:case 641360851:case -433697611:return Qa=Jb.g(this.$).Gi,Qa.H5a||!Qa.isEditing||0>=Qa.text.length?!1:!0;default:return!1}};Ma.prototype.executeCommand=function(Qa,Mb,kc){var zc=this,Ib,rc;Qa=Mb.command;var Ta=Jb.g(this.$),Cb=Ta.Gi;switch(Qa){case 753860909:case -2060563418:null===
(Ib=this.formulaAssistanceManager)||void 0===Ib?void 0:Ib.a7b();Ta.inRangePicker&&Cb.dE(!1);this.ymi?new aa(this.$):(new ta(this.$,Cb)).qf();this.formulaAssistanceTelemetryManager.r3a.dialogShownCounter++;break;case 1117706454:null===(rc=this.formulaAssistanceManager)||void 0===rc?void 0:rc.a7b();Ta.inRangePicker&&Cb.dE(!1);Ib=this.functionInfoManager.vQh(kc[Wb.a.Mc]);new ja(this.$,Ib);kc.ibdk?this.formulaAssistanceTelemetryManager.r3a.argsDialogOpenedByDialogCounter++:this.formulaAssistanceTelemetryManager.r3a.argsDialogOpenedByRibbonCounter++;
break;case -433697611:kc.ibdk&&(this.Nwa?this.formulaAssistanceTelemetryManager.r3a.argsDialogCommitedCounter++:this.formulaAssistanceTelemetryManager.r3a.dialogCommitedCounter++);var jc=kc[Wb.a.Mc]+Aa.openParen;this.Nwa&&(jc+=kc.functionArgs.join(this.$.listSeparator)+Aa.closeParen);kc.UILocation&&this.$.Cd(-1075437823,-1,0,null);Ta.view.visibleArea.contains(Ta.gg(null))||Ta.er(Ta.ha.sa.activeCell,3,jb.a.AEh);var tc=Cb.textBox;kc=Cb.textBox.caretPosition;Cb.isEditing&&Cb.text?(Ib=Cb.text,rc=kc?Ib.substring(0,
kc):"=",Cb.text=rc+jc+Ib.substring(kc+(tc.kv?tc.kv.length:0),Ib.length),tc.caretPosition=rc.length+jc.length):cb.TaskExtensions.Aa(Ta.startEdit(!0,1),function(){Cb.text="="+jc;if(zc.Nwa)Ta.endEdit(!0,"FormulaAssistanceCommandHandler.ExecuteCommand");else{var kd=jc.length+1;tc.xRa(kd);tc.caretPosition=kd}},this.$.la,11,Na.a.current);Ta.pj&&(kc=Ta.Wb,kc.text=tc.text,kc.setCaretPosition(tc.caretPosition));this.f_?this.formulaAssistanceManager.zda():(kc=Cb.vY.get(Ab.a.s3a),null===kc||void 0===kc?void 0:
kc.hU(!1))}return nb.Task.Ua(!0)};Ma.prototype.Ac=function(Qa,Mb){switch(Mb.command){case 753860909:case -2060563418:case -433697611:return!0;case 1117706454:return this.Nwa;default:return!1}};Ma.prototype.yGh=function(Qa,Mb){Mb=this.Va.kq(Mb);var kc=this.Va.Bc(),zc=this.functionInfoManager.xbc(Qa);if(!zc)return Sa.ULS.sendTraceTag(537162067,0,15,"FormulaAssistanceCommandHandler.GenerateFunctionMenu: functionList is null"),Mb.bE();for(var Ib=this.Nwa?1117706454:-433697611,rc=0;rc<zc.length;++rc){var Ta=
zc[rc].NameUI,Cb=this.Va.PP(280,"Formulas."+Qa+"MenuItem_"+zc[rc].FunctionIndex.toString(),Ib,null,1,"None",0,0,Ta,!1,0);Cb.label=Ta;var jc=zc[rc].Params.split(Aa.i$c);Cb.$R(Ta+" "+(Aa.openParen+(1<jc.length?Aa.Z7b:jc[0])+Aa.closeParen)+"\n"+zc[rc].Help);kc.buttons.push(Cb)}Qa=this.Va.Bc();zc=this.Va.PP(280,"Formulas.MoreFunctionsMenuItem",-2060563418,Db.a.uQe,3,"Image16by16",1028,0,"Formulas.MoreFunctionsMenuItem",!1,0);Qa.buttons.push(zc);Mb.pc.push(kc);Mb.pc.push(Qa);return Mb.bE()};Ma.prototype.Tc=
function(Qa,Mb,kc){Qa=this.tQh(Mb);if(-1===Qa)return!1;this.menuId=kc.MenuId;if(!this.functionInfoManager.h_)return this.functionInfoManager.i2a({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0),!1;Qa=this.functionInfoManager.Zbd[Qa];this.BY[Qa]=this.BY[Qa]||this.yGh(Qa,kc.MenuId);kc.MenuItems=this.BY[Qa];return!0};Ma.prototype.tQh=function(Qa){switch(Qa){case "PopulateFinancialFnsMenu":return 2;case "PopulateLogicalFnsMenu":return 9;case "PopulateTextFnsMenu":return 8;case "PopulateDateTimeFnsMenu":return 3;
case "PopulateLookupReferenceFnsMenu":return 6;case "PopulateMathTrigFnsMenu":return 4;case "PopulateStatisticalFnsMenu":return 5;case "PopulateEngineeringFnsMenu":return 11;case "PopulateCubeFnsMenu":return 12;case "PopulateInformationFnsMenu":return 10;default:return-1}};Object(La.a)(Ma,"FormulaAssistanceCommandHandler",null,[401]);var xb=Ra.a;$k(Ua,xb);Ua.prototype.zd=function(){var Qa=this,Mb=pb.GetServiceTaskFactory.create(this.$.da,102,this.la,this.hb),kc=pb.GetServiceTaskFactory.create(this.$.da,
153,this.la,this.hb);cb.TaskExtensions.Aa(cb.TaskExtensions.Vd([Mb,kc],this.la),function(){Qa.jd([new Ma(Qa.$,Mb.result,kc.result)])},this.la,3)};Ua.ka=function(Qa){Ra.a.Pd(92,new Ua(Qa))};Object(La.a)(Ua,"FormulaAssistanceCommandHandlerFactory",Ra.a,[]);var wc=b(235),Ob=b(22);Za.prototype.dispose=function(){this.ZXd();this.OJa=this.Mua=this.hja=null};Za.prototype.uXc=function(Qa){Qa&&(this.hja=Qa,this.hja.Ane(this.vBf),this.hja.roe(this.xBf),this.wwa&&this.hja.qoe(this.wBf))};Za.prototype.vXc=function(Qa){Qa&&
(this.Mua=Qa,this.wwa&&(this.Mua.yne(this.Gxf),this.Mua.wne(this.zxf)),this.Mua.xne(this.Cxf))};Za.prototype.wXc=function(Qa){Qa&&(this.OJa=Qa,this.OJa.yVc(this.yBf),this.OJa.VZb(this.rBf))};Za.prototype.ZXd=function(){var Qa,Mb,kc;this.hja&&(this.hja.JQf(this.vBf),this.hja.iRf(this.xBf),this.wwa&&this.hja.hRf(this.wBf));this.OJa&&(this.OJa.IJd(this.yBf),this.OJa.Zsc(this.rBf));this.wwa&&(null===(Qa=this.Mua)||void 0===Qa?void 0:Qa.IQf(this.Gxf),null===(Mb=this.Mua)||void 0===Mb?void 0:Mb.GQf(this.zxf));
null===(kc=this.Mua)||void 0===kc?void 0:kc.HQf(this.Cxf)};Za.prototype.S6i=function(Qa,Mb){if(Mb){var kc="";this.wwa||(kc+=ub.a.instance.mb(57)+this.ariaLiveNotifier.Mxa);for(var zc=0;zc<Mb.length;zc++)kc+=Qa+this.ariaLiveNotifier.Mxa+this.XYc(Mb[zc])+Za.$Dd(zc,Mb.length);this.wwa&&(kc+=ub.a.instance.ga(880)+this.ariaLiveNotifier.Mxa);this.ariaLiveNotifier.readText(kc)}};Za.prototype.R6i=function(Qa,Mb,kc){if(Qa){var zc="",Ib=0;if(Mb){for(var rc=0;rc<Mb.length;rc++)if(kc>=Qa[rc].split(this.$.listSeparator).length)Ib++;
else{var Ta=Mb[rc].trim();if(!Ta)return;Ta=this.XYc(Ta);var Cb=Za.$Dd(rc-Ib,Mb.length-Ib);zc+=Ta+Cb;Cb&&(zc+=this.ariaLiveNotifier.Mxa)}this.ariaLiveNotifier.readText(zc)}}};Za.prototype.XYc=function(Qa){if(!Qa)return"";var Mb=Qa.split(this.$.listSeparator);Qa="";Mb=ik(Mb);for(var kc=Mb.next();!kc.done;kc=Mb.next()){var zc=kc.value;Za.Pnd(zc)?Qa+=zc:(zc=(kc=Za.yli(zc))?zc.replace("[","").replace("]",""):zc,Qa+=String.format(kc?ub.a.instance.mb(59):ub.a.instance.mb(58),zc));Qa+=this.ariaLiveNotifier.Mxa}return Qa};
Za.$Dd=function(Qa,Mb){return Qa>=Mb||1===Mb?(Sa.ULS.shipAssertTag(537161997,0,Qa<Mb,"FormulaAssistanceControl.PositionInList: requested item index >= list length."),""):String.format(ub.a.instance.mb(55),Qa+1,Mb)+"\r\n"};Za.Pnd=function(Qa){return Ob.a.contains(Qa,Aa.Z7b,!0)};Za.yli=function(Qa){return Qa.trimStart().startsWith(Aa.wFf)||Qa.trimEnd().endsWith(Aa.vFf)};Object(La.a)(Za,"FormulaAssistanceReadoutHandler",null,[623,6]);var nc=wc.a;$k(pa,nc);pa.prototype.create=function(){var Qa=this,Mb=
this.$.da;cb.TaskExtensions.Aa(pb.GetServiceTaskFactory.Ra(Mb,211,212,this.hb),function(kc){kc=Mb.za(219)||new Za(kc.result,Qa.$);Qa.pb(kc)},this.la,3)};pa.ka=function(Qa){Qa.da.Ga(220,new pa(Qa))};Object(La.a)(pa,"FormulaAssistanceReadoutHandlerFactory",wc.a,[]);var mb=b(747),ic=b(113),qc=b(1196),hc=b(54),Jc=b(41),rd=b(121);ra.prototype.Kgd=function(Qa){return this.IQa&&Qa in this.IQa?this.IQa[Qa]:null};ra.prototype.o7f=function(Qa,Mb){this.IQa||(this.IQa={});this.IQa[Qa]=Mb};ra.prototype.WZ=function(){this.IQa=
null};Object(La.a)(ra,"FormulaAssistanceContextualPreviewCache",null,[]);var md=b(62);ba.prototype.dispose=function(){this.Ad||(this.$&&(this.$.ea.jD(this.fy),this.$=null),this.Fha=this.BGb=null,this.Ad=!0)};ba.prototype.xdd=function(Qa,Mb,kc,zc){var Ib=this;if(Mb&&0>=Mb.length)throw Error.argumentNull("GetContextualFormulaPreviewResults - currentFormula is null or empty");if(!Qa)throw Error.argumentNull("GetContextualFormulaPreviewResults - formulaSubExpressionObject is null");this.calcManager=this.$.da.za(266);
if(!this.calcManager)throw Error.invalidOperation("GetContextualFormulaPreviewResults failed - No CalcManager");var rc="="+Mb.substring(kc.start,kc.end);Ia.EwaSettings.ma(594)&&(rc=this.calcManager.AZh(Jb.g(this.$).ha.sa.activeCell,Qa,kc));var Ta=this.AMh(rc,kc);if(Ia.EwaSettings.ma(594)){if(Ta&&!this.calcManager.isFormulaSubExpressionVolatile(Qa))return Promise.resolve(Ta)}else if(Ta)return Promise.resolve(Ta);return this.CMh(rc,kc).then(function(Cb){if(Ib.e0c(zc))throw Error.create("OperationCanceledException");
if(!Cb||Cb.Pij||Cb.dna.startsWith("##UNSUPPORTED:"))return Ib.bYe(Mb,rc,kc,zc);Ib.Fha.o7f(rc,Cb.dna);return Promise.resolve(Cb)})};ba.prototype.AMh=function(Qa,Mb){return(Qa=this.Fha.Kgd(Qa))?new qc.a(Qa,Mb.start,Mb.end,0):null};ba.prototype.CMh=function(Qa,Mb){if(!Qa||0>=Qa.length||!Mb)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");return this.calcManager.zUg(Jb.g(this.$).ha.sa.activeCell,Qa,this.wAi,Mb)};ba.prototype.bYe=
function(Qa,Mb,kc,zc){var Ib=this;if(!Qa||0>=Qa.length||!Mb||0>=Mb.length||!kc)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");if(this.ZOa)return this.BMh(Qa,Mb,kc,zc);var rc={};rc.PartialFormula=Mb;rc.Formula=Qa;rc.SourceRange=Jc.v(Jb.g(this.$).ha.sa.activeCell,this.$);return this.ZOa=new Promise(function(Ta,Cb){Ib.BGb=new mb.a;Ib.hTf=Ib.$.ea.Ke;Ib.T$a=fa(Ib.$.oa.va,rc,function(jc){Ib.sVi(Mb,kc,zc,jc,Ta,Cb)},function(jc){Ib.ZOa=
null;Ib.T$a=null;Cb(jc)},null,null,null);Ib.BGb.token.register(function(){Ib.eWg(Cb)})})};ba.prototype.sVi=function(Qa,Mb,kc,zc,Ib,rc){this.T$a=this.ZOa=null;if(this.hTf!==this.$.ea.Ke)rc(Error.create("OperationCanceledException"));else if(zc.Result)if(zc=hc.a.Wh(zc.Result),!zc||ic.a.isEmpty(zc))Ib(null);else{for(var Ta in zc)this.Fha.o7f(Ta,zc[Ta]);this.e0c(kc)?rc(Error.create("OperationCanceledException")):(Qa=this.Fha.Kgd(Qa))?(""===Qa&&(Qa=" "),Ib(new qc.a(Qa,Mb.start,Mb.end,0))):rc(Error.create("SubexpressionNotFoundException"))}else Ib(null)};
ba.prototype.BMh=function(Qa,Mb,kc,zc){var Ib=this;return new Promise(function(rc,Ta){Ib.ZOa.then(function(){Ib.TTf(Qa,Mb,kc,zc,rc,Ta)}).catch(function(){Ib.TTf(Qa,Mb,kc,zc,rc,Ta)})})};ba.prototype.TTf=function(Qa,Mb,kc,zc,Ib,rc){if(this.e0c(zc))rc(Error.create("OperationCanceledException"));else{var Ta=this.Fha.Kgd(Mb);Ta?Ib(new qc.a(Ta,kc.start,kc.end,0)):this.bYe(Qa,Mb,kc,zc).then(function(Cb){Ib(Cb)}).catch(function(Cb){rc(Cb)})}};ba.prototype.eWg=function(Qa){this.T$a&&(rd.a.mu(this.T$a.Gt)?
(this.ZOa=this.T$a=null,Qa(Error.create("PendingWebReqeuestCancelled"))):Sa.ULS.sendTraceTag(537162063,0,10,"Failed to cancel the pending web request!"))};ba.prototype.WZ=function(){this.fWg();this.Fha&&this.Fha.WZ()};ba.prototype.fWg=function(){this.BGb&&this.BGb.cancel()};ba.prototype.e0c=function(Qa){return this.Ad||Qa.aK};Object(La.a)(ba,"FormulaAssistanceContextualPreviewCalculator",null,[6]);var Cc=b(162),fd=b(227);bb.cqh="ewa-facp-text-box";Object(La.a)(bb,"CssClassNames",null,[]);va.prototype.dispose=
function(){(this.S$||this.OP)&&this.$7e();this.Ya=this.Aqa=null};va.prototype.wSj=function(Qa,Mb,kc,zc){Qa&&Mb&&zc&&Mb.dna&&!(1>Mb.dna.length)&&(this.Ya=Qa,this.JPf(),this.r2a=Mb,this.QSa=zc,this.NAj(Mb,kc,zc))};va.prototype.$7e=function(){this.r7h();this.JPf();this.QSa=this.r2a=null};va.prototype.NAj=function(Qa,Mb,kc){var zc=this;if(Qa.dna&&!(1>Qa.dna.length)){var Ib=this.Ec.da.za(266);if(Ib){var rc=Ib.ESh();rc&&cb.TaskExtensions.Aa(this.pCb,function(){if(Mb)if(Ia.EwaSettings.ma(594)&&zc.Ya.isEditing&&
0<kc.length){zc.Qxb(Qa.KJa,kc[0].start,null);var Ta=zc.Y2e(kc[0],rc),Cb=zc.Ya.text.substring(kc[0].start,kc[0].end).trim();Cb=zc.Ya.text.indexOf(Cb);Cb=zc.Ya.text.substring(0,Cb).lastIndexOf("\n");zc.Qxb(0>Cb||1>=kc.length?kc[0].start:Cb+1,kc[0].end,Ta?String.format(Ta,.3):null);for(var jc=1;jc<kc.length;jc++)Ta=zc.Y2e(kc[jc],rc),Cb=zc.Ya.text.substring(kc[jc].start,kc[jc].end).trim(),Cb=zc.Ya.text.indexOf(Cb),Cb=zc.Ya.text.substring(kc[jc-1].end,Cb).lastIndexOf("\n"),zc.Qxb(0>Cb?kc[jc-1].end:Cb+
1+kc[jc-1].end,kc[jc].end,Ta?String.format(Ta,.3):null);Cb=zc.Ya.text.substring(kc[kc.length-1].end,Qa.Oua).indexOf("\n");zc.Qxb(0>Cb?kc[kc.length-1].end:Cb+1+kc[kc.length-1].end,Qa.Oua,null);Sa.ULS.sendTraceTag(537162061,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Colored highlighting and partial evaluation completed")}else zc.Qxb(Qa.KJa,Qa.Oua,null),Sa.ULS.sendTraceTag(537162060,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Default highlighting and partial evaluation completed");
zc.S$||(zc.S$=document.createElement(fd.a.div),zc.Ya.textBox.domElement.appendChild(zc.S$));zc.OP||(zc.OP=document.createElement(fd.a.div),zc.OP.className=bb.cqh,zc.Ec.domElement.appendChild(zc.OP));Ta=Qa.Oua;Ia.EwaSettings.ma(594)&&zc.Ya.isEditing&&kc&&0<kc.length&&kc[0].start<Ta&&kc[0].start!==Qa.KJa&&!zc.Ya.textBox.kv.length&&(Ta=kc[0].start);jc=Ob.a.contains(zc.Ya.textBox.Oe.id,"FormulaBar",!0)&&Ob.a.contains(zc.Ya.text.substring(Qa.KJa,Qa.Oua),"\n",!0);Cb=zc.Ya.isEditing?zc.Ya.textBox.caretPosition:
0;Ta=excelOnline.utils.getBoundingRectForText(zc.Ya.textBox.Oe,jc?Cb:Qa.KJa,jc?Cb:Ta,Ia.EwaSettings.ma(594));zc.OP.style.left=oc.HelperMethods.nc(Ta.left);zc.OP.style.top=oc.HelperMethods.nc(Ta.top);zc.OP.style.width=oc.HelperMethods.nc(Ta.width);zc.OP.style.height=oc.HelperMethods.nc(Ta.height);dialogControls.renderToolTip(zc.S$,"FormulaAssistancePreviewToolTip_"+Qa.Oua+"_"+Qa.Oua,Qa.dna,zc.OP,0,!1,!1,1)},this.Ec.la,3)}}};va.prototype.Y2e=function(Qa,Mb){var kc=this.Ya.text,zc=kc.substring(Qa.start,
Qa.end);zc=zc.trim();Qa=kc.indexOf(zc,Qa.start);Mb=kc.indexOf(Mb,Qa);zc=kc.substring(Qa,Mb);zc=zc.trim();return this.Ya.colors.getItem(Qa+"-"+(Qa+zc.length))};va.prototype.r7h=function(){var Qa=this;this.Ya&&this.S$&&this.OP&&cb.TaskExtensions.Aa(this.pCb,function(){Qa.Ya.textBox.domElement.contains(Qa.S$)&&(dialogControls.clearToolTip(Qa.S$),Qa.Ya.textBox.domElement.removeChild(Qa.S$),Qa.S$=null);Qa.Ec.domElement.contains(Qa.OP)&&(Qa.Ec.domElement.removeChild(Qa.OP),Qa.OP=null)},this.Ec.la,3)};va.prototype.Qxb=
function(Qa,Mb,kc){if(this.Ya&&!(Qa>=Mb)){var zc={};this.Ya.textBox.formatText(Qa,Mb-Qa,(zc.background=kc||"#E3DDCC",zc));this.Yid=!0}};va.prototype.JPf=function(){if(this.Ya&&this.r2a&&this.Yid){var Qa=this.r2a.Oua;Ia.EwaSettings.ma(594)&&0<this.QSa.length&&this.QSa[this.QSa.length-1].end>Qa&&(Qa=this.QSa[this.QSa.length-1].end);var Mb={};this.Ya.textBox.formatText(this.r2a.KJa,Qa-this.r2a.KJa,(Mb.background=!1,Mb));this.Yid=!1}};of.Object.defineProperties(va.prototype,{pCb:{configurable:!0,enumerable:!0,
get:function(){var Qa=this;if(this.Aqa)return this.Aqa;var Mb=new Cc.a;this.Ec.bB(function(kc){cb.TaskExtensions.Aa(kc.Atd(),function(){Mb.setResult(!0)},Qa.Ec.la,3)});return this.Aqa=Mb.task}}});Object(La.a)(va,"FormulaAssistanceContextualPreviewControl",null,[6]);var Cd=b(85),Sc=b(47),Md=b(45);ya.prototype.F3f=function(Qa,Mb,kc){kc?this.d7g(Qa,Mb,kc):this.j5e(Qa,Mb,kc,!0)};ya.prototype.shj=function(){this.V7=0};ya.prototype.d7g=function(Qa,Mb,kc){var zc=this;this.V7++;var Ib=this.V7;Sc.a.instance.create(function(){zc.j5e(Qa,
Mb,kc,Ib===zc.V7)},500,Md.a.BEh,!0,!0)};ya.prototype.j5e=function(Qa,Mb,kc,zc){var Ib=this,rc=this.Hbd.xdd(Qa,Mb);rc&&rc.then(function(Ta){zc&&Ib.Hbd.Dod(Mb)&&Ib.Hbd.vSj(Qa,Ta,kc)}).catch(function(Ta){Ta=Object(Cd.a)(Error,Ta);"OperationCanceledException"===Ta.message?Sa.ULS.sendTraceTag(537162059,0,50,"GetContextualFormulaPreviewResults - caught exception: "+Ta):Sa.ULS.sendTraceTag(537162058,0,10,"GetContextualFormulaPreviewResults - caught exception: "+Ta)})};Object(La.a)(ya,"FormulaAssistanceContextualPreviewHoverManager",
null,[]);var bc=b(211);ha.prototype.dispose=function(){this.a_c();sa.a.oc([this.Gub,this.N$b]);this.O$b=this.N$b=this.Gub=null;this.$&&Jb.g(this.$).Wb.Nl(this.N9a);this.Dha=this.Ya=this.$=null};ha.prototype.OAj=function(Qa,Mb){Mb&&bc.f(Mb.text)&&!(Mb.Hwa||Mb.textBox.kv||this.Ya&&this.Ya.textBox.kv)&&(this.Ya=Mb,this.calcManager=this.$.da.za(266))&&(Sa.ULS.sendTraceTag(537162056,0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnHover: Highlighting and partial evaluation initiated"),
Qa=oc.HelperMethods.nvb(Qa),Qa=this.calcManager.xZh(Jb.g(this.$).ha.sa.activeCell,this.Ya.text,Qa.x,Qa.y),Mb=this.calcManager.getSubExpressionSpan(Qa),!Mb||Mb.end<=Mb.start||this.Dod(Mb)||(this.Dha=Mb,this.O$b.F3f(Qa,Mb,!0)))};ha.prototype.cSd=function(Qa){if(Qa&&bc.f(Qa.text))if(Qa.textBox.kv&&Qa.textBox.kv.trim()){if(this.Ya=Qa,this.calcManager=this.$.da.za(266)){Sa.ULS.sendTraceTag(537162054,0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnSelection: Highlighting and partial evaluation initiated");
Qa={};var Mb=this.Ya.textBox.kv.trim();Qa.start=this.Ya.text.indexOf(Mb,this.Ya.textBox.caretPosition);Qa.end=Qa.start+Mb.length;(Mb=this.calcManager.getFormulaSubExpressionObject(Jb.g(this.$).ha.sa.activeCell,this.Ya.text,this.Ya.textBox.kv))&&!this.Dod(Qa)&&(this.Dha=Qa,this.O$b.F3f(Mb,Qa,!1))}}else this.p5a(!1,!0)};ha.prototype.p5a=function(Qa,Mb){!this.Ya||Mb&&this.Ya.textBox.kv||(this.Dha=null,Qa&&(this.a_c(),this.N$b.WZ(),this.O$b.shj()),this.Gub&&this.Gub.$7e(),this.Ya.Hwa||(this.Ya.Hwa=!1,
this.Ya=null))};ha.prototype.xdd=function(Qa,Mb){if(!this.Ya||this.Ya.Hwa)return null;this.a_c();this.Xrb=new mb.a;return this.N$b.xdd(Qa,this.Ya.text,Mb,this.Xrb.token)};ha.prototype.vSj=function(Qa,Mb,kc){this.Xrb=null;!Qa||!Mb||!Mb.dna||0>=Mb.dna.length?this.p5a(!1,!1):(Qa=this.calcManager.yZh(Jb.g(this.$).ha.sa.activeCell,Qa,this.Ya.text),this.Gub.wSj(this.Ya,Mb,kc,Qa))};ha.prototype.Dod=function(Qa){return this.Dha?Qa.start===this.Dha.start&&Qa.end===this.Dha.end&&Qa.pre===this.Dha.pre&&Qa.post===
this.Dha.post:!1};ha.prototype.a_c=function(){this.Xrb&&this.Xrb.cancel()};Object(La.a)(ha,"FormulaAssistanceContextualPreviewManager",null,[668,6,669]);var xe=b(7),Je=b(4),we=b(236),de=b(13),Le=b(192),Ie=b(1304),jf=b(67),df=b(996),Be=b(30),Sd=b(24),vc=b(64),qd=b(259),Jd=b(257),ld=b(169);Z.prototype.f_f=function(Qa){this.cT=0;this.Y8d=Qa.IsCompatibility;this.set_name(Qa.NameDataStrings);this.WVa=Qa.Help};Z.prototype.vrj=function(Qa){this.cT=1;this.set_name(Qa.Name)};Z.prototype.Wqj=function(Qa){this.cT=
2;this.set_name(Qa.name);this.WVa=Qa.tooltip};Z.prototype.xsj=function(Qa){this.cT=3;this.set_name(Qa.name);this.WVa=Qa.toolTip};Z.prototype.C0f=function(Qa){this.cT=4;this.set_name(Qa.name)};Z.prototype.Puj=function(Qa){this.cT=5;this.set_name(Qa.name);this.WVa=Qa.toolTip};Z.prototype.Ouj=function(Qa){this.cT=7;this.set_name(Qa.name)};Z.prototype.ltj=function(){this.cT=6;this.set_name(ub.a.instance.mb(187));this.WVa=ub.a.instance.mb(188)};Z.prototype.set_name=function(Qa){return this.t$d=Qa};Z.yah=
function(){return Object(xe.a)(new Z(!0),{})};of.Object.defineProperties(Z.prototype,{itemType:{configurable:!0,enumerable:!0,get:function(){return this.cT}},khi:{configurable:!0,enumerable:!0,get:function(){return this.Y8d}},name:{configurable:!0,enumerable:!0,get:function(){return this.label}},label:{configurable:!0,enumerable:!0,get:function(){return this.t$d}},mja:{configurable:!0,enumerable:!0,get:function(){return this.WVa}},JAb:{configurable:!0,enumerable:!0,get:function(){return this.xsg}}});
Object(La.a)(Z,"AutoCompleteItem",null,[680]);Object(La.a)(xa,"DefinedNameInfo",null,[]);var Kd=b(191);da.prototype.TOj=function(Qa){var Mb=this.aHe[Qa.toUpperCase()];if(!Mb)return{returnValue:!1,sheetName:"",range:null};Qa=Mb.sheetName;Mb=this.Y3g(Mb.namedRange);return{returnValue:!0,sheetName:Qa,range:Mb}};da.prototype.m4g=function(Qa){if(null!=Qa&&void 0!=Qa)return{top:Qa.top,left:Qa.left,bottom:Qa.bottom,right:Qa.right,maxRows:Qa.maxRows,maxColumns:Qa.maxColumns,sheetName:void 0}};da.prototype.Y3g=
function(Qa){if(null!=Qa&&void 0!=Qa)return new Kd.a(Qa.top,Qa.left,Qa.bottom,Qa.right,Qa.maxRows,Qa.maxColumns)};da.prototype.f4g=function(Qa){switch(Qa){case 2:return 0;case 3:return 1;default:return-1}};of.Object.defineProperties(da.prototype,{$Ge:{configurable:!0,enumerable:!0,get:function(){var Qa=[];if(!this.$.vb||!this.$.vb.items)return Qa;for(var Mb=0,kc=Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest")&&la.a.f_(this.$),zc=ik(this.$.vb.items),Ib=
zc.next();!Ib.done;Ib=zc.next())if((Ib=Ib.value)&&(3===Ib.type&&Ib.usedRange||kc&&2===Ib.type)){var rc=new xa;rc.tooltip=Ib.sheetName+jf.a.exclamation+Ib.usedRange.toString();rc.name=Ib.name;rc.namedRange=this.m4g(Ib.usedRange);rc.sheetName=Ib.sheetName;rc.type=this.f4g(Ib.type);Qa.push(rc);this.aHe[Ib.name.toUpperCase()]=rc;++Mb;if(Mb===Aa.Xpf){Sa.ULS.sendTraceTag(537162076,0,15,"Maximum number of defined names reached for formula assistance: "+Aa.Xpf);break}}return Qa}}});Object(La.a)(da,"DefinedNameInfoManager",
null,[]);var re=b(130),ie=b(278),ef=b(275),Fe=b(248),bf=Sys.EventArgs;$k(ia,bf);Object(La.a)(ia,"FormulaAssistanceFunctionChangedEventArgs",Sys.EventArgs,[]);var Oe=Sys.EventArgs;$k(ea,Oe);Object(La.a)(ea,"FormulaAssistanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var lc=Sys.EventArgs;$k(P,lc);Object(La.a)(P,"FormulaAssitanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var Fa=b(274);X.prototype.Uf=function(Qa,Mb){Qa=!1;Mb||(Jb.g(this.$).Gi.textBox.XJ=!0,Qa=this.formulaAssistanceUIControl.focus(this.aVe));
return Qa};X.prototype.ah=function(Qa){var Mb=this.hc;return!(void 0===Mb||null===Mb)&&Oa.DOMElementExtensions.nf(Mb,Qa)};X.prototype.ej=function(){this.A5e&&this.A5e();if(this.vka){var Qa=Jb.g(this.$).Gi.textBox;this.selection=Qa.selection;Qa.removeSelection()}};X.prototype.Dj=function(){this.vka&&(Jb.g(this.$).Gi.textBox.selection=this.selection)};X.prototype.dispose=function(){Fa.a(this.$).Dz(this)};of.Object.defineProperties(X.prototype,{canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.OZc},
set:function(Qa){this.OZc!==Qa&&(Qa?Fa.a(this.$).Nh(this):Fa.a(this.$).Dz(this),this.OZc=Qa)}},Yd:{configurable:!0,enumerable:!0,get:function(){return this.$mj}},hc:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceUIControl.getRootElement(this.aVe)}}});Object(La.a)(X,"FormulaAssistanceFocusManager",null,[429,6]);var Kb=b(38),gb=b(394),Tb=b(177),pc=b(34),Xc=b(299),pd=b(298),Uc=b(1130),sd=Kb.a;$k(U,sd);U.prototype.JYa=function(Qa){this.addHandler("FunctionInfoLoaded",Qa)};
U.prototype.vbb=function(Qa){this.removeHandler("FunctionInfoLoaded",Qa)};U.prototype.jGg=function(Qa){this.addHandler("FunctionInfoReset",Qa)};U.prototype.Icj=function(Qa){this.removeHandler("FunctionInfoReset",Qa)};U.prototype.dispose=function(){var Qa=this.$.da.za(268);Qa&&Qa.oJd(this.Lxf);this.ib=null;sd.prototype.dispose.call(this)};U.prototype.zTf=function(){this.raiseEvent("FunctionInfoReset")};U.prototype.ZKd=function(){this.zTf();this.gLc=!1;this.ZS=null;this.eLc=!0};U.prototype.i2a=function(Qa,
Mb){var kc=this;Mb=void 0===Mb?!1:Mb;if(this.h_)this.eLf();else{Sa.ULS.sendTraceTag(537161991,0,50,"Retrieving the list of function names for culture '"+this.$.ya.UICultureTag+"' from the server.");var zc=null;(zc=this.$.da.za(268))||Sa.ULS.sendTraceTag(537161990,0,50,"instantaneousSupportInformationManager == null");if((null===zc||void 0===zc?0:zc.oja)&&0<zc.oja.length)Ia.EwaSettings.ma(122)?zc.cEh(this.$xf):this.EHd(zc.oja,!0,!1);else{var Ib=this.$.oa.va.Pb();Qa&&(this.$.ea.dc||Mb)&&!this.eji&&
(Mb?gb.a(this.$.userOperationManager,function(rc,Ta,Cb){return md.p(kc.$.oa.va,Qa,pd.b(rc,kc.byf),pd.a(Ta,kc.ayf),Cb,Qa,Ib)},function(rc){return new Tb.a(130,0,rc,16)},null):md.p(this.$.oa.va,Qa,this.byf,this.ayf,null,Qa,Ib));!this.h_&&this.$.ea.dc&&(zc?(Sa.ULS.sendTraceTag(537161989,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - Functions not loaded yet, wait for them. IsFullyLoaded="+this.h_+", IsSessionActive="+this.$.ea.dc),zc.zne(this.Lxf)):(Sa.ULS.sendTraceTag(537161988,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - instantaneousSupportInformationManager is null"),
md.p(this.$.oa.va,{FilterType:0},this.$xf,null,null,null,Ib),this.eLc=!1))}}};U.prototype.uQh=function(Qa){return 0>Qa||Qa>=this.ZS.length?null:this.ZS[Qa]};U.prototype.zed=function(Qa){return pc.a.yc(this.hcd,Qa.toUpperCase())};U.prototype.vQh=function(Qa){return pc.a.yc(this.icd,Qa.toUpperCase())};U.prototype.xbc=function(Qa){return pc.a.yc(this.PJa,Qa)};U.prototype.Pgc=function(Qa){return!Qa.GroupUI};U.prototype.Oxf=function(Qa,Mb,kc){var zc=Xc.a(Qa);Sa.ULS.sendTraceTag(537161955,0,50,"FunctionInfoManager.OnFunctionListSuceeded: areNonStatusMessagesPresentInResult="+
zc);zc?(Jb.g(this.$).endEdit(!1,"FunctionInfoManager.OnFunctionListSuceeded"),this.$.ea.fp(Qa.Errors)):(this.EHd(Qa.Result,Mb,kc),la.a.vV()&&!la.a.f_(this.$)&&this.MUj())};U.prototype.EHd=function(Qa,Mb,kc){Sa.ULS.sendTraceTag(537161954,0,50,"FunctionInfoManager.RefreshFunctionList: functionsInfo count = "+Qa.length+", isCategorized = "+Mb+", partialResult = "+kc+" IsFullyLoaded = "+this.h_);this.h_||(this.ZS=Qa,this.mRg(Mb),this.gLc=!kc,this.eLf())};U.prototype.eLf=function(){this.raiseEvent("FunctionInfoLoaded")};
U.prototype.MUj=function(){this.pluginScheduler.notifier().setFunctionsInfo(this.Y$b)};U.prototype.mRg=function(Qa){function Mb(Rd,pe){return Rd.NameUI.localeCompare(pe.NameUI)}var kc=ub.a.instance.ga(1024),zc=[];this.PJa={};this.U8=[];this.PJa[kc]=zc;var Ib=ub.a.instance.ga(1025),rc=[];this.U8.push(kc);this.U8.push(Ib);kc=0;for(var Ta=this.ZS.length;kc<Ta;kc++){var Cb=this.ZS[kc];Cb.IsCompatibility||rc.push(Cb);var jc=Cb.NameUI,tc=Cb.NameDataStrings;this.hcd[tc.toUpperCase()]||(this.hcd[tc.toUpperCase()]=
Cb);this.icd[jc.toUpperCase()]||(this.icd[jc.toUpperCase()]=Cb);if(!this.Pgc(Cb)){if(Qa){jc=Cb.GroupUI;var kd=pc.a.yc(this.PJa,jc);kd||(kd=[],this.PJa[jc]=kd,this.U8.push(jc));kd.push(Cb)}Cb.IsCommonlyUsed&&zc.push(Cb);Cb.IsCompatibility||this.Tpg.push(tc)}}this.PJa[Ib]=rc;Qa&&(U.YOf(zc,[2,3,0,5,4,9,1,7,8,6]),zc=Array(14),zc[0]=0,zc[1]=1,zc[2]=7,zc[3]=11,zc[4]=5,zc[5]=2,zc[6]=6,zc[7]=10,zc[8]=9,zc[9]=3,zc[10]=4,zc[11]=13,zc[12]=12,zc[13]=8,U.YOf(this.U8,zc),zc=[],zc.push.apply(zc,kk(this.U8)),zc.splice(13,
1),this.U8=zc);this.ZS=[].concat(kk(this.ZS));this.ZS.sort(function(Rd,pe){return Rd.NameDataStrings.localeCompare(pe.NameDataStrings)});zc=1;for(Ib=this.U8.length;zc<Ib&&Qa;zc++)this.PJa[this.U8[zc]].sort(Mb);Qa=0;for(zc=this.ZS.length;Qa<zc;Qa++)this.ZS[Qa].FunctionIndex=Qa};U.YOf=function(Qa,Mb){for(var kc=[].concat(kk(Qa)),zc=0;zc<kc.length&&zc<Mb.length;zc++)Qa[zc]=kc[Mb[zc]]};of.Object.defineProperties(U.prototype,{h_:{configurable:!0,enumerable:!0,get:function(){return this.gLc}},eji:{configurable:!0,
enumerable:!0,get:function(){return this.eLc}},Y$b:{configurable:!0,enumerable:!0,get:function(){var Qa=this.ZS,Mb=Uc.a(this.$);if(!Mb)return Qa;Mb=Mb.JPh();var kc=Mb.length;if(0>=kc)return Qa;var zc=[];zc.push.apply(zc,kk(Qa));for(Qa=0;Qa<kc;Qa++){var Ib=Mb[Qa],rc={};rc.FunctionIndex=zc.length;rc.HelpId=rc.GroupUI=null;rc.Help=Ib.description;rc.IsCommonlyUsed=rc.IsCompatibility=!1;rc.NameDataStrings=Ib.name;rc.NameUI=Ib.name;rc.Params=null;rc.ParamsHelp=null;zc.push(rc)}return zc}},Zbd:{configurable:!0,
enumerable:!0,get:function(){return this.U8}},$:{configurable:!0,enumerable:!0,get:function(){return this.ib}}});Object(La.a)(U,"FunctionInfoManager",Kb.a,[611,612,6]);var Nb=b(249),Ja=b(94),Lb=b(48),ec=b(928),Zb=Ja.a;$k(Q,Zb);Q.prototype.dispose=function(){this.BUd&&(Nb.a.instance.Ba(de.a.sj,this.FJe,this.Iwf),this.BUd=!1);this.hNb&&(this.hNb=!1,Nb.a.instance.Ba(de.a.Hf,this.domElement.ownerDocument.body,this.$zd),Nb.a.instance.Ba(de.a.sj,this.domElement.ownerDocument.body,this.Zzd));this.O3=this.z5d=
null;Zb.prototype.dispose.call(this)};Q.prototype.xle=function(Qa){this.O3?this.O3.push(Qa):this.O3=[Qa]};Q.prototype.Ynd=function(Qa){if(this.O3)for(var Mb=0,kc=this.O3.length;Mb<kc;++Mb)if(Oa.DOMElementExtensions.nf(this.O3[Mb],Qa))return!0;return!1};Q.prototype.DSa=function(Qa){this.L7b||(this.rfa=!0,Ob.a.equals(this.domElement.currentStyle.position,"absolute",!0)||(this.domElement.style.position="absolute"),this.Kmh(),Nb.a.instance.ra(de.a.Hf,this.domElement.ownerDocument.body,this.$zd),Nb.a.instance.ra(de.a.sj,
this.domElement.ownerDocument.body,this.Zzd),this.hNb=!0,this.drag(!0,Qa))};Q.prototype.drag=function(Qa,Mb){Ub.g(Mb);var kc=new Lb.a(0,0);Mb=new Sys.UI.Point(Mb.clientX,Mb.clientY);var zc=this.domElement.parentNode,Ib=ec.a.ns(kc,zc,Mb,this.isRtl());Qa?(kc=ec.a.ME(kc,zc,this.domElement,this.isRtl()),this.R1a=ec.a.rD(Ib,kc),this.N7=Ib,this.EJc=!1):!this.m6h&&this.j6h(Ib,this.N7)&&(this.EJc=!0);kc=ec.a.rD(Ib,this.R1a);ec.a.Qcb(zc,this.domElement,kc,this.isRtl(),Qa);this.Tsg=Mb};Q.prototype.cz=function(Qa){this.hNb&&
(this.hNb=!1,Nb.a.instance.Ba(de.a.Hf,this.domElement.ownerDocument.body,this.$zd),Nb.a.instance.Ba(de.a.sj,this.domElement.ownerDocument.body,this.Zzd));Ub.g(Qa);this.rfa=!1;this.N7=this.R1a=null};Q.prototype.q6=function(Qa){var Mb=oc.HelperMethods.Fn(Qa);Mb.button===Sys.UI.MouseButton.leftButton&&2===Qa.nb&&this.cz(Mb);return!1};Q.prototype.sN=function(Qa){2===Qa.nb&&this.drag(!1,oc.HelperMethods.Fn(Qa));return!1};Q.prototype.j6h=function(Qa,Mb){return Mb.x<Qa.x-2||Mb.x>Qa.x+2||Mb.y<Qa.y-2||Mb.y>
Qa.y+2};Q.prototype.Kmh=function(){this.offsetParent=this.domElement.offsetParent||this.domElement.ownerDocument.body;this.LGi=Oa.DOMElementExtensions.getLocation(this.offsetParent)};of.Object.defineProperties(Q.prototype,{L7b:{configurable:!0,enumerable:!0,get:function(){return this.rfa}},FJe:{configurable:!0,enumerable:!0,get:function(){return this.z5d}},m6h:{configurable:!0,enumerable:!0,get:function(){return this.EJc}}});Object(La.a)(Q,"BaseDraggableBehavior",Ja.a,[]);$k(B,Q);B.prototype.setVisible=
function(Qa){Oa.DOMElementExtensions.setVisible(this.domElement,Qa);Qa||(this.domElement.style.top="auto",this.domElement.style.left="auto")};B.prototype.isRtl=function(){return this.Vi};B.prototype.MRa=function(Qa){var Mb=this.domElement.style;Mb.cursor="move";Mb.position=Qa?"relative":"absolute"};Object(La.a)(B,"FunctionParamBoxDraggableItem",Q,[]);Object(La.a)(O,"FormulaArgumentAssistanceCallbacks",null,[]);Object(La.a)(L,"FormulaArgumentAssistanceRenderingInfo",null,[]);var Oc=b(86),td=b(109),
Gd=b(158);K.prototype.ka=function(Qa){(this.root=Qa)&&!this.Zm&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.Zm=!0)};K.prototype.detach=function(){this.root&&this.Zm&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.Zm=!1)};K.prototype.v8b=function(){this.root&&(this.target=this.OG.GDf("move",!0),this.bUd=this.target.getBoundingClientRect(),this.QZ=!0,this.fRd=!1,this.fv(),this.Nlc||this.$3c(),this.target.appendChild(this.Nlc))};K.prototype.b4=function(Qa){this.OG.$wf(void 0===
Qa?!1:Qa);this.QZ=!1;this.PId();this.rId();this.bUd=this.target=void 0};K.prototype.fv=function(){this.hr.capture(this.bNa,null);this.pointerInputManager.it(de.a.pointerDown,this.target,this.LGb,!0);this.target.addEventListener("blur",this.onBlur)};K.prototype.rId=function(){this.hr.releaseCapture();this.pointerInputManager.rt(de.a.pointerDown,this.target,this.LGb,!0);this.target.removeEventListener("blur",this.onBlur)};K.prototype.PId=function(){var Qa;this.target&&(null===(Qa=this.Nlc)||void 0===
Qa?void 0:Qa.parentNode)===this.target&&this.target.removeChild(this.Nlc)};K.prototype.a6=function(Qa,Mb){var kc=this.target.getBoundingClientRect();Qa+=kc.left-this.bUd.left;Mb+=kc.top-this.bUd.top;this.OG.onMove(Qa,Mb)};K.prototype.$3c=function(){this.Nlc=Gd.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")};Object(La.a)(K,"FormulaAssistanceMoveAdapter",null,[]);var Pd=b(293);I.prototype.Bba=function(){return this.Zm&&!!this.Vja};I.prototype.COa=function(Qa){this.Vja.style.cursor=
"grabbing";this.zGj=Qa.clientPoint.x;this.AGj=Qa.clientPoint.y;this.OG.GDf("drag");return!0};I.prototype.Xla=function(Qa){this.OG.onMove(Qa.clientPoint.x-this.zGj,Qa.clientPoint.y-this.AGj);return!0};I.prototype.Wla=function(){this.cz()};I.prototype.Vla=function(){this.cz()};I.prototype.ka=function(Qa){if(this.Vja=Qa)this.Vja.style.cursor="grab",Pd.a.instance.o0(this.Vja,this),this.Zm=!0};I.prototype.detach=function(){this.Zm&&this.Vja&&(this.Vja.style.cursor="",Pd.a.instance.c8(this.Vja,this),this.Zm=
!1)};I.prototype.cz=function(){this.Vja.style.cursor="grab";this.OG.$wf()};Object(La.a)(I,"FormulaAssistanceDragAdapter",null,[699]);G.prototype.ka=function(Qa,Mb,kc,zc){this.root=Qa;this.render=kc;this.dismiss=zc;this.detach();Mb&&(this.BJe.ka(Mb),this.Wqf.ka(Qa.firstChild),this.Zm=!0)};G.prototype.detach=function(){this.Zm&&(this.BJe.detach(),this.Wqf.detach(),this.Zm=!1);Oa.DOMElementExtensions.gf(this.placeholder)};G.prototype.clear=function(){this.HJa.setOverrideTarget(void 0);this.detach();
this.JKd()};G.prototype.GDf=function(Qa,Mb){Mb=void 0===Mb?!1:Mb;this.Fea[Qa]+=1;this.Qyc=this.root.firstChild.getBoundingClientRect();this.placeholder=this.root.cloneNode(!0);Qa=this.placeholder.firstChild;Qa.style.animationDuration="0ms";this.root.parentElement.appendChild(this.placeholder);Mb&&(this.VEd=document.activeElement,Qa.tabIndex=0,Qa.focus());this.dismiss();return Qa};G.prototype.onMove=function(Qa,Mb){Qa=Math.min(Math.max(Qa,this.uDc-this.Qyc.left),window.innerWidth-this.Qyc.right-this.uDc);
Mb=Math.min(Math.max(Mb,this.uDc-this.Qyc.top),window.innerHeight-this.Qyc.bottom-this.uDc);this.placeholder.firstChild.style.transform="translate("+Qa+"px, "+Mb+"px)"};G.prototype.$wf=function(Qa){var Mb=this;Qa=void 0===Qa?!0:Qa;var kc=this.placeholder.firstChild.getBoundingClientRect(),zc=this.HJa.getDirectionalHint({top:kc.top,left:kc.left});this.HJa.setOverrideTarget({top:1===zc?kc.bottom:kc.top,left:kc.left});this.render();window.requestAnimationFrame(function(){Oa.DOMElementExtensions.gf(Mb.placeholder);
Mb.VEd&&(Qa&&Mb.VEd.focus(),Mb.VEd=void 0)})};G.prototype.JKd=function(){var Qa=this.formulaAssistanceTelemetryManager.h$,Mb=this.Fea[ee.Drag],kc=this.Fea[ee.Move];0<Mb&&(Qa.argumentAssistanceDragCounter+=1,Qa.argumentAssistanceDragTotalCounter+=Mb,this.Fea[ee.Drag]=0);0<kc&&(Qa.argumentAssistanceMoveCounter+=1,Qa.argumentAssistanceMoveTotalCounter+=kc,this.Fea[ee.Move]=0)};Object(La.a)(G,"FormulaAssistanceDragControl",null,[]);var ee;(function(Qa){Qa.Drag="drag";Qa.Move="move"})(ee||(ee={}));Object(La.b)("FormulaAssistanceDragMode",
ee);var Ec=Fe.a;$k(T,Ec);T.prototype.Ane=function(Qa){this.addHandler("FAFunctionNameUpdated",Qa)};T.prototype.JQf=function(Qa){this.removeHandler("FAFunctionNameUpdated",Qa)};T.prototype.roe=function(Qa){this.addHandler("FAParameterSelectionChangedOld",Qa)};T.prototype.iRf=function(Qa){this.removeHandler("FAParameterSelectionChangedOld",Qa)};T.prototype.qoe=function(Qa){this.addHandler("FAParameterSelectionChanged",Qa)};T.prototype.hRf=function(Qa){this.removeHandler("FAParameterSelectionChanged",
Qa)};T.prototype.set_visible=function(Qa){this.Ck?Qa||this.Isb():Sys.UI.Control.prototype.set_visible.call(this,Qa);return Qa};T.prototype.Isb=function(){this.formulaAssistanceUIControl&&(this.Hq=null,this.OQ&&this.OG.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.bla=null,this.ar.canReceiveFocus=!1)};T.prototype.show=function(Qa){this.Ck||(this.formulaAssistanceTelemetryManager.oO(["argumentAssistanceRender"]),this.T1a.setVisible(!!Qa),this.formulaAssistanceTelemetryManager.gQ(["argumentAssistanceRender"]),
this.WWc&&(this.WWc=!1,this.formulaAssistanceTelemetryManager.i8b("argumentAssistanceOverall")))};T.prototype.NKd=function(){var Qa=this;if(!this.U4||this.aSa){this.U4||this.formulaAssistanceTelemetryManager.oO(["argumentAssistanceOverall"]);this.formulaAssistanceTelemetryManager.oO(["argumentAssistanceComputation"]);var Mb=Jb.g(this.$).Gi,kc={content:Mb.text,caretPosition:Mb.textBox.caretPosition};(this.Eba?this.pluginScheduler.getRequester().argumentAssistance(kc,0):this.pluginScheduler.requester().argumentAssistance(kc)).then(function(zc){0===
zc.kind?zc.payload?(Qa.formulaAssistanceTelemetryManager.gQ(["argumentAssistanceComputation"]),Qa.rAj(Qa.rEd(zc.payload),Mb.textBox.domElement)):Qa.Isb():Qa.formulaAssistanceTelemetryManager.gQ(["argumentAssistanceComputation"],!1);return null})}};T.prototype.update=function(Qa,Mb,kc,zc){if(!this.Ck&&Qa){this.formulaAssistanceTelemetryManager.oO(["argumentAssistanceComputation","argumentAssistanceOverall"]);this.WWc=!0;var Ib=this.$.listSeparator;try{var rc=$get(Aa.fcd,this.Aj),Ta=$get(Aa.$bd,this.Aj);
rc.innerText="";Ta.innerText="";var Cb=$get(Aa.zVe,this.Aj),jc=Qa.Params.split(Aa.i$c);rc=[];Ta=0;for(var tc=Cb.rows.length;Ta<tc;Ta++){var kd=Cb.rows[Ta];Oa.DOMElementExtensions.setVisible(kd,Ta<jc.length);var Rd=jc[Ta],pe=Aa.zXi+Ta+"_",le=Qa.NameDataStrings;$get(pe+Aa.lGb,kd).innerText=le;$get(pe+Aa.VCd,kd).innerText=le;if(Rd){var Wd=jc[Ta].split(Ib),ve=T.Pnd(Wd[Wd.length-1]),Se=T.Dli(Qa);ve&&(Se&&(2<Wd.length?(Wd[Wd.length-2]+="1",Wd[Wd.length-3]+="1"):Sa.ULS.sendTraceTag(537162073,0,50,"pair params formula should have at least 2 params. at UpdateParameterAssistance. formula '{0}', {1} params, currentParameterIndex = {3}.",
le,Wd.length.toString(),Mb)),T.sLg(Wd,Se,Mb,Qa));Rd=Wd.join(Ib.toString()+" ");jc[Ta]=Rd;kc<Wd.length?(rc[Ta]=Wd[kc],Sa.ULS.shipAssertTag(537162072,0,!!Wd[kc]&&1<=Wd[kc].length,"Emphasized parameter is too short or empty selectedParameterIndex = {0}, currRowParamsArray.Length = {1}, formula name = {3}, current row = {4}",kc,Wd.length,le,Ta),Wd[kc]="<b>"+Wd[kc]+"</b>",Rd=Wd.join(Ib.toString()+" ")):Sa.ULS.shipAssertTag(537162071,0,!1,"the current param index is larger than the param list count. selectedParameterIndex = "+
kc+"currRowParamsArray.Length = "+Wd.length+", current row = "+Ta);zc&&Sa.ULS.sendTraceTag(558474578,0,50,"formula '"+le+"', "+Wd.length+" params, isElipsis = "+ve+", isPairsParamsFormula = "+Se+", currentParameterIndex = "+Mb)}$get(pe+Aa.WCd,kd).innerHTML="("+(Rd||"")+")"}zc?this.raiseEvent("FAFunctionNameUpdated",new ia(Qa.NameDataStrings,jc)):this.raiseEvent("FAParameterSelectionChangedOld",new P(jc,rc,kc));Cb.className=df.a.Kqh+(this.functionInfoManager.Pgc(Qa)?"-udf":"")}catch(Ve){throw Sa.ULS.shipAssertTag(558474577,
0,!1,"UpdateParameterAssistance Exception. formula '{0}', {1} params. \nException: {4}",Qa.NameDataStrings,Mb,Ve),Ve;}this.formulaAssistanceTelemetryManager.gQ(["argumentAssistanceComputation"])}};T.prototype.dispose=function(){this.Ck||(this.zc.qC(),sa.a.Ia(this.zc),Jb.g(this.$).view.Gq(this.$s),sa.a.Ia(this.T1a),this.T1a=null);this.Ck&&sa.a.Ia(this.ar);this.U4&&Jb.g(this.$).$b.Nl(this.Ef);this.functionInfoManager=this.$=null;Ec.prototype.dispose.call(this)};T.prototype.rEd=function(Qa){var Mb=new L;
Mb.functionRenderingInfo=Qa;Mb.cardMode=this.O2;this.gId(Mb);return Mb};T.prototype.gId=function(Qa){Qa.callbacks=new O;Qa.callbacks.onHelpLink=this.Jed(Qa.functionRenderingInfo);Qa.callbacks.onCardModeChange=this.onCardModeChange;Qa.callbacks.onFeedback=this.qRa;this.U4&&(Qa.callbacks.onDismissClick=this.onDismissClick)};T.prototype.rAj=function(Qa,Mb){var kc=this;if(this.formulaAssistanceUIControl){this.formulaAssistanceTelemetryManager.oO(["argumentAssistanceRender"]);var zc={};zc.zoomLevel=ma(this.$);
this.formulaAssistanceUIControl.updateContext(zc);this.Hq=function(){kc.formulaAssistanceUIControl.renderArgumentAssistanceCard(kc.domElement,Mb,Qa)};this.Hq();this.wDd(Qa);this.OQ&&this.OG.ka(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.Hq,function(){return kc.formulaAssistanceUIControl.dismiss(kc.domElement)});this.ar.canReceiveFocus=!0;this.formulaAssistanceTelemetryManager.gQ(["argumentAssistanceRender"]);this.formulaAssistanceTelemetryManager.i8b("argumentAssistanceOverall")}};
T.prototype.Jed=function(Qa){var Mb=this;return function(){Ha(Mb.$,Qa.helpID,Qa.isUDF)}};T.prototype.WOd=function(){var Qa=re.a.get(eb.a.j0b);this.O2=Qa?parseInt(Qa,10):T.O5c;this.formulaAssistanceTelemetryManager.MYf(this.O2)};T.prototype.wDd=function(Qa){var Mb=Qa.functionRenderingInfo.functionName;this.bla&&Ob.a.equals(this.bla,Mb,!0)?(Mb=ie.a.map(Qa.functionRenderingInfo.signatures,function(kc){var zc="";0<=kc.signatureParams.activeParam&&kc.signatureParams.activeParam<kc.signatureParams.params.length&&
(zc=kc.signatureParams.params[kc.signatureParams.activeParam]);return zc}),this.raiseEvent("FAParameterSelectionChanged",new ea(Mb))):(this.bla=Mb,Qa=ie.a.map(Qa.functionRenderingInfo.signatures,function(kc){return kc.signatureParams.params.join(", ")}),this.raiseEvent("FAFunctionNameUpdated",new ia(Mb,Qa)))};T.prototype.GOb=function(Qa){this.O2=Qa;try{re.a.Kw(eb.a.j0b,Qa.toString(),ef.AFrame.wea)}catch(Mb){Sa.ULS.sendTraceTag(537162070,0,15,"Failed setting ArgumentAssistanceCardCollapseState cookie with error message: "+
Mb.message)}};T.Pnd=function(Qa){return Ob.a.contains(Qa,Aa.Z7b,!0)};T.Dli=function(Qa){return!!Qa&&Ob.a.e2a(Qa.NameDataStrings,"IFS")};T.sLg=function(Qa,Mb,kc,zc){try{if(!Qa||2>Qa.length)Sa.ULS.shipAssertTag(537162069,0,!1,"Requested not on elipsis function, formula '"+zc.NameDataStrings+"', "+(Qa?Qa.length.toString():"currRowParamsArray == null")+" params, isPairsParamsFormula = "+Mb+", currentParameterIndex = "+kc+".");else{for(var Ib=Qa.pop().toString(),rc=Qa.length-1;rc<kc;rc++){var Ta=Qa[rc].trim();
if(Mb){var Cb=Qa[rc-1].trim();Qa.push(T.pHh(Cb,Ta))}else{var jc=T.Y9e(Ta);Qa.push(T.$Ve(jc))}}Qa.push(Ib)}}catch(tc){throw Sa.ULS.shipAssertTag(537162068,0,!1,"AppendNewOptionalParameters Exception. formula '"+zc.NameDataStrings+"', "+(Qa?Qa.length.toString():"currRowParamsArray == null")+" params, isPairsParamsFormula = "+Mb+", currentParameterIndex = "+kc+". \nException: "+tc),tc;}};T.pHh=function(Qa,Mb){Qa=T.Y9e(Qa);var kc=T.V0e(Qa);Mb=T.V0e(Mb);return T.$Ve(Qa,!0,!!kc&&!!Mb&&kc!==Mb)};T.Y9e=function(Qa){var Mb=
Qa.match(T.Oyd);Qa=Ob.a.trimEnd(Ob.a.trimStart(Qa,Aa.wFf),Aa.vFf);if(Mb&&Mb.length){Mb=Mb[Mb.length-1];var kc=Number.parseLocale(Mb)+1;Qa=Qa.replace(Mb,kc.toString())}else Qa=""+Qa+1;return Qa};T.$Ve=function(Qa,Mb,kc){var zc="[{0}]";(void 0===Mb?0:Mb)&&(zc=(void 0===kc?0:kc)?"[{0}":"{0}]");return String.format(zc,Qa)};T.V0e=function(Qa){return(Qa=Qa.match(T.Oyd))&&Qa.length?Qa[0]:null};T.SJa=function(Qa){if(Qa)return document.createElement("div");Qa=String.format(Aa.fGf,Aa.dGf,Aa.VCd,df.a.FNe,Aa.lGb,
df.a.ENe,Aa.WCd);var Mb=String.format(Aa.fGf,Aa.eGf,Aa.VCd,df.a.FNe,Aa.lGb,df.a.ENe,Aa.WCd);Qa=String.format(Aa.FFh,Aa.GFh,df.a.zOe,df.a.Inh,Db.a.Hp,Aa.zVe,Qa,Mb);Mb=document.createElement("div");Mb.innerHTML=Qa;return Mb.firstChild};T.Oyd=RegExp("\\d+");T.O5c=0;Object(La.a)(T,"FormulaArgumentAssistanceControlDeprecated",Fe.a,[679]);Object(La.a)(N,"ParseContext",null,[]);var $c=b(445),id=b(1129),vd=b(339),he=id.a;$k(S,he);S.prototype.Jh=function(Qa,Mb){this.formulaAssistanceControl.Ya=this.Ya;-1470715894!==
Mb&&-1231471547!==Mb||!this.VHe()||(this.yV=!1);return he.prototype.Jh.call(this,Qa,Mb)};S.prototype.nzd=function(){var Qa=this.H5a;if(Qa||this.CRd)if(this.formulaAssistanceControl.Ya=this.Ya,this.formulaAssistanceTelemetryManager.Zob.formulaAssistanceRequestAttemptedCounter++,this.VHe())if(!Qa&&this.CRd)this.formulaAssistanceControl.tse();else if(Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")&&this.H9h){if(Qa=this.$.Fb.sc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),
this.formulaAssistanceControl.wse(),Qa.stop(),this.Tob.text.endsWith("[")&&"["!==this.Tob.text.charAt(this.Tob.text.length-2)){var Mb=""===this.gIa?this.formulaAssistanceControl.tableManager.Fg:Object(Cd.a)(vd.a,this.$.vb.getItemByName(this.gIa));Sa.ULS.sendTraceTag(575776010,0,50,"FormulaAutoCompleteListAutoCompleteBehavior.OnAutoCompleteTimerTick: AutoComplete List Box for Table Column Headers is shown after user types =[ inside a table with id "+Mb.ij+" in "+Qa.qc+" ms with cell edit regression time of "+
this.Wkd+" ms and popup visibility - "+this.yV)}}else this.formulaAssistanceControl.Hob(),this.ZEf&&(this.ZEf=this.yV=!1);else this.formulaAssistanceTelemetryManager.Zob.formulaAssistanceRequestOptimizedCounter++;else this.yV=!1};S.prototype.Fh=function(){this.Uaj||(this.eSa=null,this.CRd&&this.formulaAssistanceControl.xZ())};S.prototype.Ef=function(){this.yV=!1;this.formulaAssistanceControl.set_visible(!1);this.formulaAssistanceControl.Stc();this.Ck&&this.bwi()};S.prototype.PFd=function(Qa,Mb){return this.formulaAssistanceControl.Jh(Qa,
Mb)};S.prototype.bwi=function(){this.formulaAssistanceControl.WAa&&(this.formulaAssistanceTelemetryManager.CM.smartSuggestionShownCounter++,this.formulaAssistanceControl.WAa=!1);this.formulaAssistanceControl.xSa&&(this.formulaAssistanceTelemetryManager.CM.smartSuggestionSelectedCounter++,this.formulaAssistanceControl.xSa=!1);this.formulaAssistanceControl.wSa&&(this.formulaAssistanceTelemetryManager.CM.smartSuggestionCommittedCounter++,this.formulaAssistanceControl.wSa=!1);this.x2&&(this.formulaAssistanceControl.isCellContentOnlyEqualDuringEdit&&
(this.formulaAssistanceTelemetryManager.CM.isCellContentOnlyEqualDuringEditCounter++,this.formulaAssistanceControl.isCellContentOnlyEqualDuringEdit=!1),this.formulaAssistanceControl.ZLa&&(this.formulaAssistanceTelemetryManager.CM.isCellContentFormulaCounter++,this.formulaAssistanceControl.ZLa=!1))};S.prototype.yWg=function(Qa,Mb){for(var kc=0,zc;-1!==kc;)if(kc=Qa.indexOf("[",kc+1),-1!==kc&&kc<Mb&&(zc=Qa.indexOf("]",kc+1),-1===zc||zc>=Mb))return kc;return-1};S.prototype.VHe=function(){var Qa=this.Ya.text,
Mb=this.Ya.textBox.caretPosition,kc=this.formulaAssistanceControl.cla,zc=this.formulaAssistanceControl.nNa;if(this.yV&&Ob.a.equals(Qa,kc,!0)&&Mb===zc)return!1;this.formulaAssistanceControl.cla=Qa;this.formulaAssistanceControl.nNa=Mb;return!0};of.Object.defineProperties(S.prototype,{kzb:{configurable:!0,enumerable:!0,get:function(){return Object($c.a)(ta,this.$.ob.Yg)}},yV:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceControl.isListVisible},set:function(Qa){this.formulaAssistanceControl.isListVisible=
Qa}},H5a:{configurable:!0,enumerable:!0,get:function(){return this.Ya.H5a}},H9h:{configurable:!0,enumerable:!0,get:function(){var Qa=this.Tob.text,Mb=!1;if(0>=Qa.length)return Mb;var kc=this.$.Fb.sc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),zc=Jb.g(this.$).ha.sa.activeCell.clone(),Ib=Qa.charCodeAt(0);this.gIa="";this.YP=this.yWg(Qa,this.Tob.caretPosition);Ib=61===Ib&&-1!==this.YP;if(!Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing"))Ib&&(Mb=!0);
else if(Ib){if(Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){Ib=0;for(var rc=this.YP-1;1<=rc&&!(this.YP-rc>S.Tpf);rc--)if(S.que.includes(Qa.charAt(rc))){Ib=rc;break}Ib=Qa.substring(Ib+1,this.YP);Qa=""!==Ib?this.$.vb.getItemByName(Ib):null;rc=this.YP;for(var Ta=this.YP+1;Ta<=this.Ya.textBox.caretPosition;Ta++)if("["===this.Ya.text.charAt(Ta))rc=Ta;else break;this.YP=rc}else{Ib=Qa.lastIndexOf("[");rc=0;for(Ta=Ib-1;1<=Ta&&!(Ib-Ta>S.Tpf);Ta--)if(S.que.includes(Qa.charAt(Ta))){rc=
Ta;break}Ib=Qa.substring(rc+1,Ib);Qa=""!==Ib?this.$.vb.getItemByName(Ib):null}Qa&&2===Qa.type?(Mb=!0,this.gIa=Ib):Jb.g(this.$).Ab.dk(zc)&&(Mb=!0,this.gIa="")}kc.stop();this.Wkd=kc.qc;Sa.ULS.sendTraceTag(575776011,0,50,"FormulaAutoCompleteListAutoCompleteBehavior.InTableHeaderMode: Regression time in cell edit due to column header mode parsing is "+this.Wkd+" milliseconds");return Mb}},key:{configurable:!0,enumerable:!0,get:function(){return Ab.a.s3a}},calcManager:{configurable:!0,enumerable:!0,get:function(){this.cGc||
(this.cGc=this.$.da.za(266,!1));return this.cGc}},CRd:{configurable:!0,enumerable:!0,get:function(){if(null!=this.eSa)return this.eSa;if(!Ia.EwaSettings.ma(136))return this.eSa=!1;var Qa=Jb.g(this.$).ha.sa.activeCell.clone();if(1!==Qa.zpf||!Qa.left||Jb.g(this.$).ha.sa.mhc())return!1;var Mb=this.formulaAssistanceControl.tableManager.Wm(Qa);if(Mb)return this.eSa=!1;--Qa.left;--Qa.right;if(!Qa.isValidRange)return!1;Mb=this.formulaAssistanceControl.tableManager.Wm(Qa);return this.eSa=!!Mb&&Qa.top===Mb.top&&
this.formulaAssistanceControl.tableManager.b5g(Mb,Jb.g(this.$))}}});S.que=" !%&'()*+,-/:;<=>@[]^{|}~".split("");S.Tpf=255;Object(La.a)(S,"FormulaAutoCompleteListAutoCompleteBehavior",id.a,[]);var Ge=b(29),Ze;(function(Qa){Qa[Qa.function=0]="function";Qa[Qa.field=1]="field";Qa[Qa.definedName=2]="definedName";Qa[Qa.letVariable=3]="letVariable";Qa[Qa.tableColHeaderName=4]="tableColHeaderName";Qa[Qa.tableSpecialStructRef=5]="tableSpecialStructRef";Qa[Qa.pendingData=6]="pendingData";Qa[Qa.tableNamedObject=
7]="tableNamedObject"})(Ze||(Ze={}));Object(La.b)("ItemType",Ze);var gf=b(1306),Df=b(1305);J.prototype.execute=function(Qa){Qa.push(this.index)};Object(La.a)(J,"AppendIndexOperation",null,[698]);F.prototype.execute=function(){};Object(La.a)(F,"NopIndexOperation",null,[698]);H.prototype.execute=function(Qa){for(var Mb=0;Mb<Qa.length;Mb++)Qa[Mb]===this.w1i&&(Qa[Mb]=this.Zrf)};Object(La.a)(H,"ReplaceIndexOperation",null,[698]);var mc=b(77);D.prototype.rEe=function(Qa,Mb){var kc=new J(Mb);if(!this.g_)return kc;
Qa=this.tqi(Qa,Mb);return null!=Qa?this.items[Qa].JAb?new H(Qa,Mb):new F:kc};D.prototype.tqi=function(Qa,Mb){var kc=this,zc=this.items[Mb];Sa.ULS.shipAssertTag(537162075,0,!!zc,"Internal error: invalid item index");Qa=mc.where(mc.asEnumerable(Qa),function(Ib){return kc.items[Ib].name===zc.name});return mc.Ct(Qa)?mc.first(Qa):null};Object(La.a)(D,"FilterItemOperationFactory",null,[]);var sc=b(117),hd=b(1060);Object(La.a)(w,"CompletionItem",null,[]);var cd=b(70),Ed="<tr>\r\n\t{0}\r\n\t<td id='name_cell{4}' class='{1}'>{2}</td>\r\n\t<td id='description_cell{4}' class='"+
Db.a.Hp+"'>{3}</td>\r\n\t<td id='item_type_cell' class='"+Db.a.Hp+"'>{5}</td>\r\n</tr>",ge="<tr>\r\n\t{0}\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='description_cell{1}' class='"+Db.a.Hp+"'></td>\r\n\t<td id='item_type_cell' class='"+Db.a.Hp+"'>{2}</td>\r\n</tr>",Nd="<td>\r\n\t<div class='"+Db.a.HA+"'>\r\n\t\t<img class='{0}' src='{1}' alt='{2}'/>\r\n\t</div>\r\n</td>",Ld="<tr>\r\n\t<td><b>{0}</b></td>\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='description_cell{1}' class='"+
Db.a.Hp+"'>{5}</td>\r\n\t<td id='item_type_cell' class='"+Db.a.Hp+"'>{2}</td>\r\n</tr>",De=gf.a;$k(y,De);y.prototype.yVc=function(Qa){this.addHandler("FLBSelectedRowChanged",Qa)};y.prototype.IJd=function(Qa){this.removeHandler("FLBSelectedRowChanged",Qa)};y.prototype.VZb=function(Qa){this.addHandler("ACLBUpdated",Qa)};y.prototype.Zsc=function(Qa){this.removeHandler("ACLBUpdated",Qa)};y.prototype.dispose=function(){De.prototype.dispose.call(this);this.nra=this.AVe=this.Oub=null};y.prototype.zzc=function(Qa,
Mb,kc,zc){zc=void 0===zc?0:zc;this.rff||this.R7(!1);var Ib="";kc&&(Ib+="<table aria-live='off' id='list_column_header'><tr><td class='"+df.a.n0g+"'>"+kc+"</td></tr></table>");Ib+="<table class='"+this.ica+"' aria-live='off'><tbody>";for(var rc=new Le.a,Ta=0,Cb=this.lW.length;Ta<Cb;Ta++)Ib+=this.f3e(Qa[this.lW[Ta]],Ta+1,Mb,zc),this.Ck&&rc.add(this.WXe(Qa[this.lW[Ta]]));Ta=this.lW.length;Cb=0;for(var jc=this.nq.length;Cb<jc;Cb++)this.lW.includes(this.nq[Cb])||(Ta++,Ib+=this.f3e(Qa[this.nq[Cb]],Ta,Mb,
zc),this.Ck&&rc.add(this.WXe(Qa[this.nq[Cb]])));this.Rf.innerHTML=Ib+"</tbody></table>";this.Hn=Oa.DOMElementExtensions.Bj(this.domElement,this.ica);this.Ck&&(this.L3b=rc.toArray());this.rff?(this.isListVisible=!0,this.AGa.set_visible(!0)):(this.R7(!0),this.pJg(!!kc))};y.prototype.tJa=function(Qa,Mb,kc,zc,Ib,rc){zc=void 0===zc?"":zc;Ib=void 0===Ib?0:Ib;rc=void 0===rc?!1:rc;if(Qa){var Ta=[],Cb=[];this.MMb=0;var jc=new D(this.$,Qa);if(Mb){var tc=!!Mb&&0<Ib,kd=tc&&91===Mb.charCodeAt(Ib+1)?Ib+2:Ib+1;
rc=tc?Mb.length===kd:!1;tc&&Mb.length===Ib&&Ia.EwaSettings.ma(136)&&(rc=!0);var Rd=null;!rc&&tc&&Mb.length>Ib+1&&(Rd=Mb.substring(kd,Mb.length));if(Mb)for(tc=0,kd=Qa.length;tc<kd;tc++){var pe=Qa[tc].name;if(!Qa[tc].khi){var le=jc.rEe(Ta,tc);Qa[tc].JAb&&this.MMb++;if(!Rd&&!rc||0===Qa[tc].itemType)Cb=this.USe(Mb,pe,kc,le,Ta,Cb),Ta=Cb.d$e,Cb=Cb.mIf;Rd&&1===Qa[tc].itemType&&(Cb=this.USe(Rd,pe,!0,le,Ta,Cb),Ta=Cb.d$e,Cb=Cb.mIf);rc&&1===Qa[tc].itemType&&le.execute(Ta)}}}else for(kc=0;kc<Qa.length;++kc)if(Qa[kc].JAb||
rc)Rd=jc.rEe(Ta,kc),Rd.execute(Ta),Rd.execute(Cb),Qa[kc].JAb&&this.MMb++;this.lW=Cb;this.nq=Ta;this.zzc(Qa,Mb,zc,Ib)}};y.prototype.MTj=function(Qa){if(Qa&&!(1<Qa.length)){var Mb=[],kc=[];Mb.push(0);kc.push(0);this.lW=Mb;this.nq=kc;this.zzc(Qa,"","",0)}};y.prototype.gya=function(){this.Pk&&De.prototype.gya.call(this)};y.prototype.W4i=function(Qa,Mb){this.raiseEvent("ACLBUpdated",new Df.a(Qa,void 0,void 0,Mb))};y.prototype.teg=function(Qa){var Mb=this.Hn.rows[Qa];return(!this.Pk||this.Pk!==Mb)&&Qa<
this.Hn.rows.length?(this.Pk=Mb,!0):!1};y.XXe=function(Qa){switch(Qa){case 0:return 3;case 2:return 100;case 1:case 6:return 103;case 3:return 102;case 4:return 101;case 5:return 107;case 7:return 106;default:return 3}};y.prototype.onItemClick=function(Qa){Ub.g(Qa.Ca);0===this.B0||2===this.B0||3===this.B0||4===this.B0||5===this.B0||7===this.B0?(this.raiseEvent(hd.a.M4a),this.gya()):1===this.B0?this.AGa.Ly(!1):(this.AGa.Ly(!1),Qa=Jb.g(this.$),Qa.xo(!1),Qa.focus());return!0};y.prototype.pJg=function(Qa){this.Tra();
if(Qa){var Mb=this.Hn.offsetWidth+(this.nq.length>this.JH?sc.a.hv:0);Qa=$get("list_column_header");Qa.offsetWidth>Mb&&Oa.DOMElementExtensions.uv(this.Rf,Qa.offsetWidth);Mb=this.Rf.getElementsByClassName(this.x_);for(var kc=0;kc<Mb.length;kc++)Mb[kc].style.width=oc.HelperMethods.nc(Qa.offsetWidth)}};y.prototype.f3e=function(Qa,Mb,kc,zc){if(1===Qa.itemType){var Ib=Ge.a.yg(Qa.name),rc=Ge.a.yg(zc?kc.substring(zc+1,kc.length):kc),Ta=0;Ib.substring(0,rc.length).toLowerCase()!==rc.toLowerCase()&&(Ta=y.hGj(Ib,
Aa.thg,rc));kc="";kc=0<=Ta?kc+(Ib.substring(0,Ta)+"<b>"+Ib.substring(Ta,Ta+rc.length)+"</b>"+Ib.substring(Ta+rc.length,Ib.length)):kc+Ib;zc=zc?String.format(Nd,Db.a.$Oe,Ge.a.LZ(wb.a.df(0)),ub.a.instance.ga(715)):"";return String.format(ge,zc,Mb,Ze[Qa.itemType],this.x_,kc)}if(5===Qa.itemType)return String.format(Ld,"",Mb,Ze[Qa.itemType],this.x_,Ge.a.yg(Qa.name),Ge.a.yg(Qa.mja));if(4===Qa.itemType)return String.format(Ld,"(...)",Mb,Ze[Qa.itemType],this.x_,Ge.a.yg(Qa.name));if(6===Qa.itemType)return zc=
zc?String.format(Nd,Db.a.$Oe,Ge.a.LZ(wb.a.df(0)),ub.a.instance.ga(715)):"",String.format(Ed,zc,this.x_,Ge.a.yg(Qa.name),Ge.a.yg(Qa.mja),Mb,Ze[Qa.itemType]);zc=String.format(Nd,2===Qa.itemType||3===Qa.itemType?Db.a.$th:Db.a.Yth,Ge.a.LZ(wb.a.df(0)),ub.a.instance.ga(712));return String.format(Ed,zc,this.x_,Ge.a.yg(Qa.name),Ge.a.yg(Qa.mja),Mb,Ze[Qa.itemType])};y.prototype.WXe=function(Qa){var Mb=new w;Mb.label=Qa.label;Mb.textEdit=Qa.textEdit;Mb.kind=y.XXe(Qa.itemType);Mb.type=Qa.JAb?1:0;if(Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:5607789_FunctionShortDescriptions")&&
3===Mb.kind){var kc=this.formulaAssistanceControl.wQh(Qa.label);Mb.detail=kc?kc:Qa.mja}else Mb.detail=Qa.mja;return Mb};y.prototype.USe=function(Qa,Mb,kc,zc,Ib,rc){Ob.a.equals(Mb,"Pretend this is the line.",!1)&&0<Ib.length||Ob.a.gL(Mb,Qa)?(zc.execute(Ib),zc.execute(rc)):kc&&Qa.length>=Aa.e5g&&y.Qeh(Mb,Aa.thg,Qa)?zc.execute(Ib):!kc&&Qa.length>=Aa.d5g&&Ob.a.contains(Mb,Qa,!0)&&zc.execute(Ib);return{d$e:Ib,mIf:rc}};y.Qeh=function(Qa,Mb,kc){Mb=ik(Mb);for(var zc=Mb.next();!zc.done;zc=Mb.next())if(zc=
Qa.split(zc.value),!(2>zc.length)){zc=ik(zc);for(var Ib=zc.next();!Ib.done;Ib=zc.next())if(Ob.a.gL(Ib.value,kc))return!0}return!1};y.hGj=function(Qa,Mb,kc){Mb=ik(Mb);for(var zc=Mb.next();!zc.done;zc=Mb.next())if(zc=Qa.toLowerCase().indexOf((zc.value+kc).toLowerCase()),0<zc)return zc+1;return-1};of.Object.defineProperties(y.prototype,{vic:{configurable:!0,enumerable:!0,get:function(){return 0<this.MMb&&this.MMb===this.nq.length}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return Object(cd.a)(y.prototype,
this,"isListVisible")},set:function(Qa){Object(cd.b)(y.prototype,this,"isListVisible",Qa);Qa||(this.qvc=0,this.fe=null);0===this.qvc?Oa.DOMElementExtensions.setVisible(this.Oub,Qa&&!this.Ck):Oa.DOMElementExtensions.setVisible(this.Oub,!1)}},Pk:{configurable:!0,enumerable:!0,get:function(){return this.nra},set:function(Qa){this.wBa(this.Pk);if(Qa){this.AVe.innerText="";this.nra=Qa;var Mb=this.wBa(this.Pk),kc=Qa.rowIndex+1,zc=$get("description_cell"+kc,Qa);this.Oub.innerText=zc.innerText;var Ib=$get("item_type_cell",
Qa);this.fe=Mb=Mb.innerText;this.qvc="field"===Ib.innerText?1:"definedName"===Ib.innerText?2:"letVariable"===Ib.innerText?3:"tableColHeaderName"===Ib.innerText?4:"tableSpecialStructRef"===Ib.innerText?5:"pendingData"===Ib.innerText?6:"tableNamedObject"===Ib.innerText?7:0;this.raiseEvent("FLBSelectedRowChanged",new Df.a(this.nq.length,kc,Mb,zc.innerText));this.cvc(Qa)}}},mTa:{configurable:!0,enumerable:!0,get:function(){return this.Oub}},AGa:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceControl}},
B0:{configurable:!0,enumerable:!0,get:function(){return this.qvc}}});Object(La.a)(y,"FormulaAutoCompleteListBox",gf.a,[678]);of.Object.defineProperties(z.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},toolTip:{configurable:!0,enumerable:!0,get:function(){return this.B9}}});Object(La.a)(z,"LETVariableInfo",null,[]);of.Object.defineProperties(A.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}}});Object(La.a)(A,"TableColHeaderNameInfo",
null,[]);of.Object.defineProperties(u.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}}});Object(La.a)(u,"TableNamedObjectInfo",null,[]);of.Object.defineProperties(l.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},toolTip:{configurable:!0,enumerable:!0,get:function(){return this.B9}}});Object(La.a)(l,"TableSpecialStructRefInfo",null,[]);var ke=b(114),db=b(179),Qb=b(31),Fc=b(101),Tc=b(1126),zd=b(262),Wc=b(51),dd=b(188);Object(La.a)(x,
"FormulaAutoCompleteCallbacks",null,[]);Object(La.a)(m,"FormulaAutoCompleteRenderingInfo",null,[]);Object(La.a)(v,"RunExperimentRequest",null,[]);var oe=Ie.a;$k(f,oe);f.prototype.yne=function(Qa){this.addHandler(f.Pbd,Qa)};f.prototype.IQf=function(Qa){this.removeHandler(f.Pbd,Qa)};f.prototype.wne=function(Qa){this.addHandler(f.lbd,Qa)};f.prototype.GQf=function(Qa){this.removeHandler(f.lbd,Qa)};f.prototype.xne=function(Qa){this.addHandler("FormulaAutoCompleteShown",Qa)};f.prototype.HQf=function(Qa){this.removeHandler("FormulaAutoCompleteShown",
Qa)};f.prototype.get_visible=function(){return this.Edf?void 0!==this.Vfb?this.Vfb:this.Vfb=oe.prototype.get_visible.call(this):oe.prototype.get_visible.call(this)};f.prototype.set_visible=function(Qa){if(this.Edf&&this.Vfb===Qa)return this.Ck&&!Qa&&this.H1a(),Qa;this.gja.set_visible(Qa);this.Ck&&!Qa&&this.H1a();Sys.UI.Control.prototype.set_visible.call(this,Qa);return this.Vfb=Qa};f.prototype.GVg=function(Qa,Mb){this.isListVisible&&(Qa+=Aa.openParen,Mb++,this.$Cd(Qa,Mb));var kc=0<Mb&&Qa.charAt(Mb-
1)===Aa.openParen,zc=Mb===Qa.length||Qa.charAt(Mb)===Aa.closeParen;if(!kc||!zc)return Sa.ULS.sendTraceTag(537162053,0,50,"FormulaAssistanceControl.CanInsertFormulaArguments Caret position: "+Mb+" is invalid. Is cell empty: "+!Qa.length+". Function exists in cell: "+!!this.XP),!1;kc=Qa.substring(0,Mb).lastIndexOf(this.$.listSeparator);zc=Qa.substring(0,Mb-1).lastIndexOf(Aa.openParen);Qa=Qa.substring(-1===kc&&-1===zc?1:Math.max(kc,zc)+1,Mb-1).trim();return this.functionInfoManager.zed(Qa)?!0:(Sa.ULS.sendTraceTag(537162052,
0,50,"FormulaAssistanceControl.CanInsertFormulaArguments No valid function name before caret. Function exists in cell: "+!!this.XP),!1)};f.prototype.cdi=function(Qa,Mb){var kc=this.GVg(Qa,Mb);if(!kc||!this.XP)return Sa.ULS.shipAssertTag(537162051,0,!kc||kc&&!!this.XP,"FormulaAssistanceControl.InsertFormulaArgumentsFromCaretPosition currentFunctionInfo is null"),{returnValue:null,Vrf:0,QTe:0};kc=this.XP.Params;kc=kc.replace(RegExp("[\\[\\]]","g"),"");var zc=Qa.charAt(Mb-1)===Aa.openParen,Ib=zc?"":
"(",rc=Mb===Qa.length?")":"";var Ta=this.$.listSeparator;Ta=kc.includes(Ta)?kc.indexOf(Ta):kc.length;return{returnValue:Qa.substring(0,Mb)+Ib+kc+rc+Qa.substring(Mb,Qa.length),Vrf:zc?Mb:Mb+1,QTe:Ta}};f.prototype.$s=function(Qa,Mb){this.Ck&&void 0!==this.Hq&&null!==this.Hq&&this.Hq();this.Ck||oe.prototype.$s.call(this,Qa,Mb)};f.prototype.dispose=function(){if(this.$){this.OSa(!1);var Qa=this.gridView;this.N9&&(this.$.userOperationManager.to(this.Gca),this.$.userOperationManager.to(this.LOa));Qa&&(Qa.ha&&
(this.Ck?Qa.ha.zF(this.Rc):Qa.ha.AW(this.Rc),la.a.vV()&&4!==this.pDb&&(this.cAb?Qa.$b.vk(this.Fh):Qa.ha.Sma(this.Ttf))),Qa.view.Gq(this.Bnc));this.Ck&&this.$.xa&&this.$.xa.ug(this.wh)}this.functionInfoManager&&(this.functionInfoManager.vbb(this.onFunctionInfoLoaded),this.functionInfoManager.Icj(this.Nxf));this.Kg&&this.Kg.Rsc(this.Bya);this.Ck&&this.eh&&this.eh.IJd(this.JCf);la.a.Pfc&&this.Ya&&this.Ya.HIb(this.n6);this.S7f(!1);sa.a.Ia(this.eh);sa.a.Ia(this.v0b);sa.a.Ia(this.gja);sa.a.Ia(this.ar);
this.Ya=this.functionInfoManager=this.Kg=null;sa.a.oc(this.IJa);this.Fg=this.u8=this.gja=this.IJa=null;oe.prototype.dispose.call(this)};f.prototype.Rwa=function(){return!this.Ht};f.prototype.kki=function(){return!this.BGa};f.prototype.Jh=function(Qa,Mb){if(!this.Rwa()){if(this.Ck&&this.wH){if(125627505===Mb||267796030===Mb)return this.Ck&&this.DBc(Mb),this.MAe(),this.N9&&this.YVf(),!1;if(1872288872===Mb)return this.Rma(),this.isListVisible=!1,!0;if(this.eh.vic&&(-798660877===Mb||137938150===Mb))return!1}if(1!==
this.eh.B0||125627505!==Mb&&267796030!==Mb)if(6===this.eh.B0){var kc=Qa.keyCode;13!==kc&&9!==kc||this.Ly(!1)}else{if(4===this.eh.B0||5===this.eh.B0)return oe.prototype.Jh.call(this,Qa,Mb,!0);1===this.eh.lW.length&&(kc=Qa.keyCode,this.Kwe=8===kc||127===kc||46===kc?!0:!1)}else{if(this.Ly(!1)&&!this.hka)return this.gridView.ha.Jh(Qa,Mb);if(125627505===Mb&&this.hka)return!0}}return oe.prototype.Jh.call(this,Qa,Mb)};f.prototype.Stc=function(){this.Kg.Ubb();this.u8=null;null==this.Sia||this.Sia||this.pkc("NoFieldChosen",
1,2,1);this.Sia=null;this.J3=0;this.C5=this.Ord=this.Jpc=null};f.prototype.Hob=function(){var Qa=this;this.Wef&&this.formulaAssistanceTelemetryManager.oO(["argumentAssistanceOverall"]);var Mb=!!this.Ya&&!vc.f(this.$.pa),kc=null;this.x2&&Mb&&(kc=this.Ya.text,kc.startsWith("=")&&(this.ZLa=!0,1===kc.length&&(this.isCellContentOnlyEqualDuringEdit=!0)));if((this.VAa||this.xyc)&&Mb){this.x2||(kc=this.Ya.text);var zc={content:kc,caretPosition:null};(this.Eba?this.pluginScheduler.getRequester().functionSuggestion(zc,
0):this.pluginScheduler.requester().functionSuggestion(zc)).then(function(Ib){if(0===Ib.kind){Sa.ULS.shipAssertTag(537162050,0,!!Ib&&!!Ib.payload.items,"FormulaAssistanceControl.AssistFormula - x10Scheduler returned `null` suggestion");var rc=mc.toArray(mc.select(mc.asEnumerable(Ib.payload.items),function(Ta){return f.V3g(Ta)}));Qa.xyc&&"="===kc&&0<rc.length&&Qa.qp.cua.bPd("="+rc[0].textEdit.newText,Ib.payload.data.value);Qa.VAa&&(Qa.vSa=rc,Je.AFrameworkApplication.zg||(Qa.nYc&&Qa.Ab.n5(Qa.gridView.ha.sa.activeCell)?
Qa.formulaAssistanceTelemetryManager.CM.smartSuggestionWouldSuggestInsidePivotCounter++:Qa.vse(Mb,!0)))}return null})}this.VAa&&Mb||this.vse(Mb,!1)};f.prototype.e3e=function(){if(Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){var Qa=this.gridView.pj?this.Hub.YP:this.eqb.YP;"@"===this.Ya.text.charAt(Qa+1)&&this.Ya.textBox.caretPosition>Qa+1?this.reb=Qa+2:this.reb=Qa+1}else{Qa=this.Ya.text.lastIndexOf(Aa.Akf);var Mb=this.Ya.text.lastIndexOf("[");this.reb=
Qa+1>=Mb?Qa+2:Mb+1}return this.Ya.text.substring(this.reb,this.Ya.textBox.caretPosition)};f.prototype.wse=function(){this.L4f()&&(this.Pah(),this.Ht&&(this.Sia=!1,this.IV=this.e3e(),this.eh.tJa(this.Ht,this.IV,!0,void 0,void 0,!0),this.show(),Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:5516893_fixInTableHeaderModeAccordingToCaretPoisiton")&&this.gja.Isb()))};f.prototype.tse=function(){this.L4f()&&(this.v0b&&this.v0b.cancel(),this.Kg.r6a?(this.Rwa()&&this.eDe(!0),this.get_visible()?this.QSe():this.d2d=
db.AsyncMethodContext.Zq(this.QSe,Aa.meh,Md.a.CEh,this.v0b)):this.xZ())};f.prototype.L4f=function(){return this.Ya?0<this.$.ob.rR||!this.Ya.text||!this.Ya.isEditing?(this.set_visible(!1),!1):vc.f(this.$.pa)?!1:!0:!1};f.prototype.Uqb=function(Qa){this.Ya&&this.isListVisible&&(this.Xld(this.Ya.text,Qa),this.Ya.textBox.caretPosition=Qa.range.start.character+Qa.newText.length,this.set_visible(!1))};f.prototype.Ly=function(){var Qa;if(!this.Ya||!this.isListVisible)return!1;var Mb=this.eh.B0;this.mdf&&
this.formulaAssistanceTelemetryManager.V9e(y.XXe(Mb));var kc="",zc=0,Ib=this.gridView,rc=this.Ya.text,Ta=0,Cb=this.eh.fe,jc=!1;if(0===Mb||2===Mb||3===Mb||7===Mb)kc+=rc.substr(0,this.t3a)+this.eh.fe,0!==Mb||this.eh.fe.endsWith(")")||(kc+="("),zc=kc.toString().length,kc+=rc.substr(this.Z$b),2===Mb&&(Ta=4,Cb="DefinedName",jc=!0,this.set_visible(!1));else if(1===Mb)if(this.Sia=!0,this.hka){kc+=rc.substr(0,this.J3+2);!kc.toString().endsWith(jf.a.IU)&&Ia.EwaSettings.ma(136)&&(kc+=jf.a.IU);Ta=this.eh.fe;
Ta=Ta.replace("'","''");Ta=Ta.replace("[","'[");Ta=Ta.replace("]","']");if(this.Z5c||this.fAh(Ta))Ta=jf.a.$si+Ta+jf.a.Ljj,jc=!0;kc+=Ta;zc=kc.length;Ta=3;dd.a("PulloutFieldAccepted")}else return this.Ya.text=this.eh.fe,this.set_visible(!1),Ib.xo(!1),Ib.focus(),this.pkc("FieldName",1,1,1),dd.a("TableHeaderAutoCompleteSuggestionAccepted"),!0;else if(5===Mb)Sa.ULS.sendTraceTag(537162048,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableSpecialStructRef listbox item"),kc+=rc.substr(0,this.reb),
Ob.a.equals(this.eh.fe,"@ - "+this.instantaneousSupportInformationManager.we.ThisRowStructRefString,!1)?kc+="@":(kc+=this.eh.fe,jc=!0,this.set_visible(!1)),zc=kc.length;else if(4===Mb){Sa.ULS.sendTraceTag(575776009,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableColHeaderName listbox item}");kc+=rc.substr(0,this.reb);jc="";zc=!1;for(var tc=[39,91,93,64,35],kd=0;kd<this.eh.fe.length;kd++){var Rd=this.eh.fe.charCodeAt(kd);tc.includes(Rd)&&(jc+="'");jc+=this.eh.fe.charAt(kd).toString();
zc||Ob.a.isNumeral(Rd)||Ob.a.Jef(Rd)||(zc=!0)}tc=this.gridView.pj?this.Hub.YP:this.eqb.YP;rc=Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?"@"===rc.charAt(tc+1)&&zc:rc.lastIndexOf(Aa.Akf)+1>=rc.lastIndexOf("[")&&zc;kc+=rc?"["+jc+"]":jc;jc=!0;this.set_visible(!1);zc=kc.toString().length}else if(6===Mb)kc+=rc.substr(0,this.Tsb);else return Sa.ULS.sendTraceTag(537162019,0,10,"Autocomplete item type was not set on AutoComplete ListBox"),!1;this.Ya.text=
kc;this.Ya.textBox.caretPosition=zc;this.Ya.lxa()&&(null===(Qa=Ib.Fr)||void 0===Qa?0:Qa.Nua)&&Ib.Fr.IKb(this.Ya.text,this.Ya.textBox.caretPosition,this.Ya.textBox.caretPosition,this.Ya.textBox.kv.length);Ib.pj&&(Qa=Ib.Wb,Qa.text=this.Ya.text,Qa.setCaretPosition(this.Ya.textBox.caretPosition));Cb=(null==this.Sia?0:this.Sia)?"FieldName":Cb;this.eh.Pk.sectionRowIndex>=this.eh.lW.length?this.pkc(Cb,4,Ta,0):this.pkc(Cb,1,Ta,0);jc||(5===Mb||4===Mb?this.wse():this.Hob());return!0};f.prototype.xZ=function(Qa,
Mb){Qa=void 0===Qa?null:Qa;Mb=void 0===Mb?null:Mb;Qa?(this.Kg.Ubb(),this.Kg.xZ(Qa,!1,!1,Mb)):(Qa=this.gridView,Qa.ha.sa.rg&&(Qa=Jc.v(Qa.ha.sa.Vc,this.$),this.Kg.xZ(Qa,!0,!0,Mb)))};f.prototype.Rma=function(){this.Ifa=!1;this.Ya.wIe()};f.prototype.wQh=function(Qa){Qa=this.calcManager.getWorksheetFuncId(Qa);return this.DVe?this.DVe.descriptionsMap.get(Qa):null};f.prototype.eDe=function(Qa){if(this.kki()){if(this.Kg.r6a&&this.Kg.Hk&&(!this.Kg.Hk.length||!this.Kg.Hk[0].FieldInfoDataList))return;this.MRj(Qa)}Qa=
mc.asEnumerable(this.BGa);Qa=mc.concat(Qa,this.wSh(this.Ya.text));Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:5501880_NamedObjectAutoCompleteDropdown")&&this.Ck&&(Qa=mc.concat(Qa,this.DTh()));mc.OBc(Qa,function(Mb){return Mb.name},new Tc.a);this.VAa&&(Qa=mc.concat(mc.asEnumerable(this.vSa),Qa),Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&(0<this.vSa.length&&(this.WAa=!0),this.vSa=[]));this.u8=mc.toArray(Qa)};f.prototype.Pah=function(){var Qa=this.Ya.text;
if(Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing")){var Mb=this.gridView.pj?this.Hub.gIa:this.eqb.gIa,kc=!0;if(Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:5962126_tableColHeadersListJSCrashFix")){if(""!==Mb&&(this.Fg=Object(Cd.a)(vd.a,this.$.vb.getItemByName(Mb))),this.Fg||(this.Fg=this.tableManager.Fg,kc=!1),!this.Fg){Sa.ULS.sendTraceTag(527234895,0,50,"FormulaAssistanceControl.createTableColHeaderAutoCompleteList - current table object is null. Total number of named objects in workbook: %d. Is target table name empty? %d");
return}}else this.Fg=Object(Cd.a)(vd.a,this.$.vb.getItemByName(Mb)),this.Fg||(this.Fg=this.tableManager.Fg,kc=!1);this.Fg.sO&&this.Fg.sO.IsFullTableHeaders?this.KHf(kc):ld.d(this.Fg)?(Sa.ULS.sendTraceTag(537162017,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Getting column headers for table with xluid - %s"),qd.p(this.$.oa.va,this.Fg.ij,this.DNi,this.CNi,null,null)):Sa.ULS.sendTraceTag(537162018,0,15,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Table with xluid %s has header rows turned off.")}else if(this.calcManager&&
this.tableManager.Fg)if(Mb=this.calcManager.G4a(this.tableManager.Fg))if(this.calcManager.eKg(this.tableManager.Fg,Mb)){Qa=mc.empty();if(91===this.Ya.text.charCodeAt(this.Ya.text.length-1)){var zc=this.U0a("@ - "+this.instantaneousSupportInformationManager.we.ThisRowStructRefString);Qa=mc.concat(Qa,(kc=new Le.a,kc.add(zc),kc))}Qa=mc.concat(Qa,mc.select(mc.asEnumerable(Mb.toArray()),function(Ib){var rc=new Z,Ta=new A;Ta._name=Ib.toString();rc.C0f(Ta);return rc}));this.u8=mc.toArray(Qa)}else Qa.endsWith("[")&&
"["!==Qa.charAt(Qa.length-2)&&Sa.ULS.sendTraceTag(572381130,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns partial table header data with "+Mb.count+" columns for a table with id "+this.tableManager.Fg.ij+" of size "+(this.tableManager.Fg.usedRange.right-this.tableManager.Fg.usedRange.left+1));else Qa.endsWith("[")&&"["!==Qa.charAt(Qa.length-2)&&Sa.ULS.sendTraceTag(573149408,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns null inside a table during table column header autocomplete list creation")};
f.prototype.fAh=function(Qa){if(!Qa)return!1;var Mb=Qa.charCodeAt(0);if(46===Mb||48<=Mb&&57>=Mb||63===Mb)return!0;for(var kc=0;kc<Qa.length;kc++,Mb=Qa.charCodeAt(kc))if(!((Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?Ob.a.isLetter(Mb):Ob.a.Sod(Mb))||92===Mb||95===Mb||63===Mb||48<=Mb&&57>=Mb))return!0;return!1};f.prototype.$Cd=function(Qa,Mb){var kc=!1,zc=!1,Ib=!1,rc=0,Ta=0;this.t3a=0;this.Z$b=Mb;this.J5b=1;for(var Cb=Mb-1;0<=Cb;--Cb)switch(Qa.charCodeAt(Cb)){case 39:zc=
!zc;break;case 34:kc=!kc;break;case 91:++rc;Ib=rc>Ta;break;case 93:++Ta}Ib=Object(xe.a)(new N,{Osa:!kc,Psa:!zc,Sha:!Ib,mGb:1});rc=this.VXi(Qa,Mb,Ib);Mb=this.WXi(Qa,Mb,Ib.Osa,Ib.Psa,Ib.Sha);this.J5b=rc+Mb;if(this.FQc=rc-1)this.wxc=!1;this.VAh(Qa,kc,zc,Ib.ACd,Ib.BCd)};f.prototype.Kld=function(){4!==this.pDb&&(this.cAb?this.gridView.$b.Ak(this.Fh):this.gridView.ha.Rga(this.Ttf));var Qa=la.a.Pyb()?this.qp.Ub(null):void 0;this.oOa(Qa);la.a.Pfc&&this.gridView.Gi.GYa(this.n6);f.vMd(this.pluginScheduler);
this.VAa&&this.dYg()};f.prototype.szh=function(){return this.VAa||this.gSe};f.prototype.XXi=function(){var Qa=this.C5;if(!this.Eyj||!Qa)return this.J3=0,this.BGa=this.u8=null,!1;Qa=Qa.endsWith(jf.a.IU);var Mb;if(Mb=Ia.EwaSettings.ma(136)){Mb=this.jPj(this.C5.substring(0,this.K3));var kc=Mb.sheetRange;Mb=Mb.returnValue}return Mb&&(Mb=this.C5.substring(0,this.J3),Qa&&Mb!==this.Ord)?(this.Ord=Mb,this.J3=this.C5.length-(Qa?1:0),this.xZ(kc,this.C5),this.Sia=!1,Sa.ULS.sendTraceTag(537162015,0,50,"Begin dot notation autocomplete"),
!0):!1};f.prototype.wSh=function(Qa){var Mb=new Le.a;this.calcManager&&Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")&&Sa.ULS.shipAssertTag(537162014,0,!!this.calcManager.cta(Sd.Range.Qc(1,1)),"FormulaAssistanceControl.GetLetVariables() - ConvertToSheetGridCell() is null");if(this.calcManager&&this.gSe&&(Qa=this.calcManager.extractLetVariables(Qa,this.Ya.textBox.caretPosition))){Qa=ik(Qa);for(var kc=Qa.next();!kc.done;kc=Qa.next()){var zc=kc.value;kc=new z;kc._name=
zc;kc.B9=ub.a.instance.ga(2199);zc=new Z;zc.xsj(kc);Mb.add(zc)}}return Mb};f.prototype.DTh=function(){for(var Qa=new Le.a,Mb=this.$.vb.items,kc=0,zc=Mb.length;kc<zc;kc++){var Ib=Mb[kc];if(vc.n(Ib)){var rc=new u;rc._name=Ib.name;Ib=new Z;Ib.Ouj(rc);Qa.add(Ib)}}return Qa};f.prototype.U0a=function(Qa){var Mb=new Z,kc=new l;kc._name=Qa;Mb.Puj(kc);return Mb};f.prototype.KHf=function(Qa){var Mb=new Le.a,kc=this.Ya.text.charCodeAt(this.Ya.text.length-1),zc=this.Ya.textBox.caretPosition-1;if(Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?
91===this.Ya.text.charCodeAt(zc):91===kc){var Ib=this.U0a("@ - "+this.instantaneousSupportInformationManager.we.ThisRowStructRefString);Mb.add(Ib)}Ib=ik(this.Fg.sO.HeadersList);for(var rc=Ib.next();!rc.done;rc=Ib.next()){rc=rc.value;var Ta=new Z,Cb=new A;Cb._name=rc.Name;Ta.C0f(Cb);Mb.add(Ta)}Ib=this.gridView.pj?this.Hub.YP:this.eqb.YP;rc=this.Ya.text.charCodeAt(Ib+1);(Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?!Qa||zc!==Ib&&35!==rc:!Qa||91!==
kc&&35!==kc)||(Qa=this.U0a("#"+this.instantaneousSupportInformationManager.we.AllStructRefString),Mb.add(Qa),Qa=this.U0a("#"+this.instantaneousSupportInformationManager.we.DataStructRefString),Mb.add(Qa),Qa=this.U0a("#"+this.instantaneousSupportInformationManager.we.HeadersStructRefString),Mb.add(Qa),Qa=this.U0a("#"+this.instantaneousSupportInformationManager.we.TotalsStructRefString),Mb.add(Qa));Mb&&(this.u8=Mb.toArray())};f.prototype.MRj=function(Qa){var Mb=mc.empty();!Qa&&this.functionInfoManager.h_&&
(Mb=mc.concat(Mb,mc.select(mc.asEnumerable(this.functionInfoManager.Y$b),function(kc){var zc=new Z;zc.f_f(kc);return zc})),Qa=this.x6b.$Ge,0<Qa.length&&(Mb=mc.OBc(mc.concat(Mb,mc.select(mc.asEnumerable(Qa),function(kc){var zc=new Z;zc.Wqj(kc);return zc})),function(kc){return kc.name},new Tc.a)));if(this.Kg.r6a&&this.Kg.Hk){if(!this.Kg.Hk.length||!this.Kg.Hk[0].FieldInfoDataList)return;Mb=mc.OBc(mc.concat(Mb,mc.select(mc.asEnumerable(this.Kg.Hk[0].FieldInfoDataList),function(kc){var zc=new Z;zc.vrj(kc);
return zc})),function(kc){return kc.name},new Tc.a);this.columnName=this.Kg.Hk[0].ColumnName}this.BGa=mc.toArray(Mb)};f.prototype.oOa=function(Qa){var Mb;if(1!==this.pDb){var kc=this.gridView.ha.sa.activeCell;if(kc){var zc=this.calcManager.cta(kc,!this.lnd);if(zc){var Ib=this.$.xa,rc=zc.sheet.index;0>=Ib.count||0>rc||rc>=Ib.count||(rc=Ib=null,this.pyd&&void 0!==this.calcManager&&null!==this.calcManager&&(Qa=null!==(Mb=null===Qa||void 0===Qa?void 0:Qa.cell)&&void 0!==Mb?Mb:this.gridView.Ea.Lr(kc))&&
(Mb=this.calcManager.$bc(Qa.Zk),void 0!==Mb&&null!==Mb&&(Ib=Mb.FormatString,rc=Mb.Builtin)),2!==this.pDb&&this.pluginScheduler.notifier().setActiveCell({colIndex:zc.range.col,rowIndex:zc.range.row,sheetIndex:this.$.xa.getItem(zc.sheet.index).sheetId,docName:zc.sheet.document.name,docPath:zc.sheet.document.path,formatString:Ib,builtIn:rc}))}}}};f.prototype.YVf=function(){this.formulaAssistanceTelemetryManager.v_={sk:this.gridView.ha.sa.activeCell,fqb:this.gridView.Wb.text,Wqb:!0};this.formulaAssistanceTelemetryManager.UBb=
this.$.ea.Ke;this.formulaAssistanceTelemetryManager.Mjc=this.$.xa.pa.sheetId;this.$.userOperationManager.Br(this.LOa)};f.prototype.dYg=function(){this.gridView.pj?this.Hub.hU(!1):this.eqb.hU(!1)};f.prototype.qif=function(Qa){var Mb=Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?Ob.a.isLetter(Qa):Ob.a.Sod(Qa);return 48<=Qa&&57>=Qa||46===Qa||95===Qa||Mb};f.prototype.show=function(){if(this.Ht){var Qa=this.eh.teg(0);this.Ck?0<this.eh.nq.length?
Qa||this.A4f():this.H1a():((Qa=0<this.eh.nq.length)&&this.formulaAssistanceTelemetryManager.oO(["autoCompleteRender"]),!this.isListVisible&&this.columnName&&Qa&&this.eh.W4i(this.eh.nq.length,this.columnName),this.isListVisible=Qa,this.gja.show(this.XP),this.NBa(!0),this.eh.gya(),Qa&&this.formulaAssistanceTelemetryManager.gQ(["autoCompleteRender"]))}};f.prototype.WXi=function(Qa,Mb,kc,zc,Ib){for(kc=Object(xe.a)(new N,{mFf:41,Ize:40,Osa:kc,Psa:zc,Sha:Ib});Mb<Qa.length&&!this.jGf(Qa,Mb,kc);++Mb);return kc.mGb};
f.prototype.VXi=function(Qa,Mb,kc){for(--Mb;0<=Mb&&!this.jGf(Qa,Mb,kc);--Mb);return kc.mGb};f.prototype.jGf=function(Qa,Mb,kc){var zc=Qa.charCodeAt(Mb);0>=this.K3&&(this.K3=Qa.substring(0,Mb).lastIndexOf(jf.a.IU));46===zc&&(Mb<this.K3?this.K3=Mb:Mb>this.Tsb&&(this.J3=this.Tsb=Mb));if(!this.qif(zc)&&!f.Opi(zc)&&(!this.hka||Mb<=this.K3||!f.g9h(zc,kc))){kc.hwf&&(kc.hwf=!1,this.t3a=Mb+1);if(kc.hBd){kc.BCd=Mb+1;if(this.functionInfoManager.zed(Qa.substring(kc.BCd,kc.ACd)))return!0;kc.hBd=!1}switch(zc){case 39:kc.Psa=
!kc.Psa;break;case 34:kc.Osa=!kc.Osa;break;case 91:kc.Sha=!1;break;case 93:kc.Sha=!0}zc===this.$.listSeparator.toString().charCodeAt(0)&&kc.Psa&&kc.Osa&&!kc.d0a&&(!this.hka||kc.Sha)&&(Mb<kc.hNd||-1===kc.hNd)&&(kc.mGb+=1,this.J5b++);zc===kc.Ize&&kc.Osa&&kc.Psa&&(!this.hka||kc.Sha)?kc.d0a+=1:zc===kc.mFf&&kc.Osa&&kc.Psa&&(!this.hka||kc.Sha)?0<kc.d0a?--kc.d0a:(kc.hNd=kc.PTe,kc.PTe=Mb,0<Mb&&this.qif(Qa.charCodeAt(Mb-1))&&(kc.hBd=!0,kc.ACd=Mb)):this.hka&&46===zc&&Mb>this.K3&&(Mb<this.K3?this.K3=Mb:Mb>this.Tsb&&
(this.J3=this.Tsb=Mb))}return!1};f.prototype.VAh=function(Qa,Mb,kc,zc,Ib){this.Z$b>this.t3a&&0<=this.t3a?Mb||kc||(this.IV=Qa.substring(this.t3a,this.Z$b)):this.IV=null;zc!==Ib?(Qa=Qa.substring(Ib,zc),this.XP&&Ob.a.equals(this.XP.NameDataStrings,Qa,!0)||(this.wxc=!0),this.XP=this.functionInfoManager.zed(Qa)):(this.wxc=!1,this.XP=null)};f.prototype.S7f=function(Qa){var Mb=$get(Aa.dGf+"_"+Aa.lGb,this.domElement),kc=$get(Aa.eGf+"_"+Aa.lGb,this.domElement);Qa&&!this.Ydc?(Mb&&we.a.instance.ra(de.a.click,
Mb,this.Dca),kc&&we.a.instance.ra(de.a.click,kc,this.Dca),this.Ydc=!0):this.Ydc&&(Mb&&we.a.instance.Ba(de.a.click,Mb,this.Dca),kc&&we.a.instance.Ba(de.a.click,kc,this.Dca),this.Ydc=!1)};f.prototype.jPj=function(Qa){var Mb=this;var kc=null;var zc;if(function(){var Cb=Jc.Z(Qa,Mb.$.ea.xa);rc=Cb.sheetName;zc=Cb.range;return Cb}().returnValue&&zc){if(!rc){var Ib=Object(Cd.a)(Fc.a,this.$.pa);if(!Ib)return{returnValue:!1,sheetRange:kc};var rc=Ib.name}kc=Jc.v(zc,this.$);kc.SheetName=rc;this.Z5c=!1;return{returnValue:!0,
sheetRange:kc}}var Ta=null;return function(){var Cb=Mb.x6b.TOj(Qa);rc=Cb.sheetName;Ta=Cb.range;return Cb}().returnValue?(kc=Jc.v(Ta,this.$),kc.SheetName=rc,this.Z5c=!0,{returnValue:!0,sheetRange:kc}):{returnValue:!1,sheetRange:kc}};f.prototype.tMd=function(Qa){Qa={content:Qa,isCellContentOnlyEqualDuringEdit:this.isCellContentOnlyEqualDuringEdit};this.Eba?this.pluginScheduler.getRequester().runAuthoringExperiment(Qa,0):this.pluginScheduler.requester().runAuthoringExperiment(Qa)};f.prototype.Qkd=function(){if(1===
this.eh.lW.length&&this.Ht.length){var Qa=this.Ht[this.eh.lW[0]];if(1===Qa.itemType){var Mb=Qa.name;Qa=this.Ya.text;Mb=Mb.substring(Qa.length,Mb.length);Mb.length&&(this.Ya.text=Qa+Mb,this.Ya.textBox.selectRange(Qa.length,this.Ya.text.length))}}else Sa.ULS.shipAssertTag(537162007,0,!1,"InCellAutoComplete should only be called when there is 1 item (number of items: "+this.eh.lW.length+")")};f.prototype.pkc=function(Qa,Mb,kc,zc){var Ib={};Ib.a=Qa;Ib.b=Mb;Ib.c=kc;Ib.d=zc;Wc.b().Ce(38,Ib,!0)};f.prototype.vse=
function(Qa,Mb){if(!this.functionInfoManager.h_){if(Qa)if(this.$Cd(this.Ya.text,this.Ya.textBox.caretPosition),this.VAa||this.IV){var kc={};kc.Filter=this.IV?this.IV.charAt(0).toString():"";kc.FilterType=1;kc.IncludeOneOfEachGroupUI=!1;this.functionInfoManager.i2a(kc)}else Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")&&this.get_visible()&&this.set_visible(!1);if(!Mb)return}0<this.$.ob.rR||this.Ya&&!this.Ya.isEditing?this.set_visible(!1):Qa&&(this.$Cd(this.Ya.text,
this.Ya.textBox.caretPosition),this.gja.update(this.XP,this.J5b,this.FQc,this.wxc),this.C5=this.Ya.text.substring(1,this.Ya.textBox.caretPosition),this.K3=this.C5.indexOf(jf.a.IU),this.J3=this.C5.lastIndexOf(jf.a.IU),this.XXi()?(Qa=new Z,Qa.ltj(),this.BGa=this.u8=Qa=[Qa],this.eh.MTj(Qa),this.show()):((this.szh()||this.Rwa())&&this.eDe(!1),0<this.J3?this.eh.tJa(this.Ht,this.C5,!1,void 0,this.C5.lastIndexOf(jf.a.IU),!1):this.eh.tJa(this.Ht,this.IV,!1,void 0,this.J3,!1),this.show(),this.Ck&&(this.eh.nq.length||
this.gridView.Gi.FK?this.gja.Isb():(this.gja.NKd(),this.Ck&&this.H1a()))))};f.prototype.A4f=function(){var Qa=this;if(0<this.eh.nq.length){this.formulaAssistanceTelemetryManager.oO(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){var Mb={};Mb.zoomLevel=ma(this.$);this.formulaAssistanceUIControl.updateContext(Mb);this.Hq=function(){Qa.formulaAssistanceUIControl.renderAutoCompleteMenu(Qa.L0b,Qa.gridView.Gi.textBox.domElement,Qa.ved())};this.Hq();this.Ck&&this.eh.vic&&this.raiseEvent(f.Pbd,
null);this.Emd||this.eh.vic||this.raiseEvent("FormulaAutoCompleteShown");this.Emd=this.ar.canReceiveFocus=!0;this.mdf&&this.formulaAssistanceTelemetryManager.W9e(this.eh.L3b)}this.formulaAssistanceTelemetryManager.gQ(["autoCompleteRender"]);!Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&void 0!==this.vSa&&null!==this.vSa&&0<this.vSa.length&&(this.WAa=!0)}};f.prototype.Std=function(){this.zIa&&(this.formulaAssistanceTelemetryManager.xY.selectByArrowKeyCounter++,
this.zIa=!1);this.AIa&&(this.formulaAssistanceTelemetryManager.xY.selectByMouseHoverCounter++,this.AIa=!1);this.yIa&&(this.formulaAssistanceTelemetryManager.xY.commitByTabKeyCounter++,this.yIa=!1);this.wIa&&(this.formulaAssistanceTelemetryManager.xY.commitByEnterKeyCounter++,this.wIa=!1);this.xIa&&(this.formulaAssistanceTelemetryManager.xY.commitByMouseClickCounter++,this.xIa=!1)};f.prototype.ved=function(){var Qa=new m;Qa.completionItems=this.eh.L3b;Qa.activeItemIndex=this.eh.Pk?this.eh.Pk.rowIndex:
-1;this.cId(Qa);return Qa};f.prototype.cId=function(Qa){Qa.callbacks=new x;Qa.callbacks.onCompletionItemSelected=this.Ozd;Qa.callbacks.onCompletionItemCommitted=this.Nzd;Qa.callbacks.onFeedback=this.qRa;Qa.callbacks.onDismiss=this.onDismiss;Qa.callbacks.onRestoreFocus=Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:6178649_FixFormulaBarFocusBug")?this.onRestoreFocus:void 0};f.prototype.IEd=function(Qa){this.Ifa=!0;var Mb=Qa.textEdit.newText;this.Ya.Kdb(Mb.substring(this.Ya.text.length-Qa.textEdit.range.start.character,
Mb.length))};f.prototype.MAe=function(){this.Ly(!0);this.Ifa=this.isListVisible=!1;this.wSa=this.xSa=!0};f.prototype.Xld=function(Qa,Mb){this.Ya.text=Qa.substring(0,Mb.range.start.character)+Mb.newText+Qa.substring(Mb.range.end.character,Qa.length);this.gridView.pj&&(this.gridView.Wb.text=this.Ya.text)};f.vMd=function(Qa){Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUse")?Qa.getRequester().runExperiment(new v,0):Qa.requester().runExperiment(new v)};f.V3g=function(Qa){var Mb=
Z.yah(),kc={IsCompatibility:!1};kc.NameDataStrings=Qa.label;kc.Help=Qa.detail;Mb.f_f(kc);Mb.textEdit=Qa.textEdit;return Mb};f.SJa=function(){var Qa=String.format(Aa.HFh,Aa.fcd,Be.a.INe),Mb=String.format(Aa.CFh,Aa.dcd,df.a.m9c,Db.a.Mo,Db.a.Hp),kc=String.format(Aa.zFh,Aa.$bd,df.a.m9c,Db.a.Mo,df.a.zOe,Db.a.Hp);return Qa+"\n"+Mb+"\n"+kc};f.Opi=function(Qa){return 36===Qa||58===Qa||33===Qa||39===Qa||32===Qa};f.g9h=function(Qa,Mb){return 32===Qa||91===Qa||!Mb.Sha};of.Object.defineProperties(f.prototype,
{It:{configurable:!0,enumerable:!0,get:function(){return this.eh}},Ht:{configurable:!0,enumerable:!0,get:function(){return this.u8}},AKb:{configurable:!0,enumerable:!0,get:function(){return this.eh.fe}},wVe:{configurable:!0,enumerable:!0,get:function(){return this.eh}},$Ue:{configurable:!0,enumerable:!0,get:function(){return this.gja}},eh:{configurable:!0,enumerable:!0,get:function(){return this.Opg}},Y0a:{configurable:!0,enumerable:!0,get:function(){return this.VAa?this.Ya?this.Ya.text:null:this.IV}},
isListVisible:{configurable:!0,enumerable:!0,get:function(){return this.It.isListVisible},set:function(Qa){this.Ck&&!Qa&&this.H1a();this.It.isListVisible=Qa}},tableManager:{configurable:!0,enumerable:!0,get:function(){return this.qyg}},hka:{configurable:!0,enumerable:!0,get:function(){return 0<this.J3}},wH:{configurable:!0,enumerable:!0,get:function(){return this.Ifa}},gridView:{configurable:!0,enumerable:!0,get:function(){return this.zji?this.qp:Jb.g(this.$)}},Ab:{configurable:!0,enumerable:!0,get:function(){return this.gridView.Ab}},
v0b:{configurable:!0,enumerable:!0,get:function(){return this.d2d}},J3:{configurable:!0,enumerable:!0,get:function(){return this.nJe},set:function(Qa){this.nJe=Qa;Qa||(this.K3=0)}},Eyj:{configurable:!0,enumerable:!0,get:function(){if(null==this.Jpc){var Qa=this.$.ic;this.Jpc=!!Qa&&!Qa.inEmbedView}return this.Jpc}},AXf:{configurable:!0,enumerable:!0,get:function(){return this.eh.L3b[this.eh.Pk.rowIndex]}},DVe:{configurable:!0,enumerable:!0,get:function(){!this.gcd&&this.pluginScheduler&&(this.gcd=
this.pluginScheduler.getFunctionsShortDescriptions());return this.gcd}}});f.Pbd="FACardOpened";f.lbd="FAFocusOnSmartSuggestionsCard";f.mkd=null;Object(La.a)(f,"FormulaAssistanceControl",Ie.a,[670,614,6,671,672]);var Fd=Fe.a;$k(n,Fd);n.prototype.Ane=function(Qa){this.addHandler("FAFunctionNameUpdated",Qa)};n.prototype.JQf=function(Qa){this.removeHandler("FAFunctionNameUpdated",Qa)};n.prototype.roe=function(Qa){this.addHandler("FAParameterSelectionChangedOld",Qa)};n.prototype.iRf=function(Qa){this.removeHandler("FAParameterSelectionChangedOld",
Qa)};n.prototype.qoe=function(Qa){this.addHandler("FAParameterSelectionChanged",Qa)};n.prototype.hRf=function(Qa){this.removeHandler("FAParameterSelectionChanged",Qa)};n.prototype.OFg=function(Qa){this.addHandler("DC",Qa)};n.prototype.rcj=function(Qa){this.removeHandler("DC",Qa)};n.prototype.dismiss=function(){this.Iv=!1;this.formulaAssistanceUIControl&&(this.Hq=null,this.OQ&&this.OG.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.bla=null,this.ar.canReceiveFocus=!1)};n.prototype.show=
function(Qa,Mb){var kc=this;this.Iv=!0;var zc=this.rEd(Qa);this.formulaAssistanceUIControl&&(this.formulaAssistanceTelemetryManager.oO(["argumentAssistanceRender"]),Qa={},Qa.zoomLevel=ma(this.$),this.formulaAssistanceUIControl.updateContext(Qa),Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:5470368_FormulaAssistanceScroll")?(this.Hq=function(){kc.formulaAssistanceUIControl.renderArgumentAssistanceCard(kc.domElement,Mb,zc)},this.Hq()):this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,
Mb,zc),this.wDd(zc),this.OQ&&this.OG.ka(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.Hq,function(){return kc.formulaAssistanceUIControl.dismiss(kc.domElement)}),this.ar.canReceiveFocus=!0,this.formulaAssistanceTelemetryManager.gQ(["argumentAssistanceRender"]),this.formulaAssistanceTelemetryManager.i8b("argumentAssistanceOverall"))};n.prototype.dispose=function(){if(this.$){var Qa=Jb.g(this.$);Qa&&(Qa.ha&&Qa.ha.zF(this.Rc),Qa.view.Gq(this.$s),
this.OQ&&Qa.$b.Nl(this.Ef))}sa.a.Ia(this.ar);this.$=null};n.prototype.rEd=function(Qa){var Mb=new L;Mb.functionRenderingInfo=Qa;Mb.cardMode=this.O2;this.gId(Mb);return Mb};n.prototype.gId=function(Qa){Qa.callbacks=new O;Qa.callbacks.onHelpLink=this.Jed(Qa.functionRenderingInfo);Qa.callbacks.onCardModeChange=this.onCardModeChange;Qa.callbacks.onFeedback=this.qRa;this.U4&&(Qa.callbacks.onDismissClick=this.onDismissClick)};n.prototype.Jed=function(Qa){var Mb=this;return function(){Ha(Mb.$,Qa.helpID,
Qa.isUDF)}};n.prototype.WOd=function(){var Qa=re.a.get(eb.a.j0b);this.O2=Qa?parseInt(Qa,10):n.O5c;this.formulaAssistanceTelemetryManager.MYf(this.O2)};n.prototype.wDd=function(Qa){var Mb=Qa.functionRenderingInfo.functionName;this.bla&&Ob.a.equals(this.bla,Mb,!0)?(Mb=ie.a.map(Qa.functionRenderingInfo.signatures,function(kc){var zc="";0<=kc.signatureParams.activeParam&&kc.signatureParams.activeParam<kc.signatureParams.params.length&&(zc=kc.signatureParams.params[kc.signatureParams.activeParam]);return zc}),
this.raiseEvent("FAParameterSelectionChanged",new ea(Mb))):(this.bla=Mb,Qa=ie.a.map(Qa.functionRenderingInfo.signatures,function(kc){return kc.signatureParams.params.join(", ")}),this.raiseEvent("FAFunctionNameUpdated",new ia(Mb,Qa)))};n.prototype.GOb=function(Qa){this.O2=Qa;try{re.a.Kw(eb.a.j0b,Qa.toString(),ef.AFrame.wea)}catch(Mb){Sa.ULS.sendTraceTag(537162074,0,15,"Failed setting ArgumentAssistanceCardCollapseState cookie with error message: "+Mb.message)}};n.SJa=function(){return document.createElement("div")};
of.Object.defineProperties(n.prototype,{visible:{configurable:!0,enumerable:!0,get:function(){return this.Iv},set:function(Qa){Qa||this.dismiss();this.Iv=Qa}}});n.O5c=0;Object(La.a)(n,"FormulaArgumentAssistanceControl",Fe.a,[682]);var We;(function(Qa){Qa[Qa.Dismissed=0]="Dismissed";Qa[Qa.Smart=1]="Smart";Qa[Qa.Simple=2]="Simple";Qa[Qa.Mixed=3]="Mixed"})(We||(We={}));Object(La.b)("UIState",We);var zf=Fe.a;$k(k,zf);k.prototype.yne=function(Qa){this.addHandler("FACardOpened",Qa)};k.prototype.IQf=function(Qa){this.removeHandler("FACardOpened",
Qa)};k.prototype.wne=function(Qa){this.addHandler("FAFocusOnSmartSuggestionsCard",Qa)};k.prototype.GQf=function(Qa){this.removeHandler("FAFocusOnSmartSuggestionsCard",Qa)};k.prototype.xne=function(Qa){this.addHandler("FormulaAutoCompleteShown",Qa)};k.prototype.HQf=function(Qa){this.removeHandler("FormulaAutoCompleteShown",Qa)};k.prototype.yVc=function(Qa){this.addHandler("SelectedRowChanged",Qa)};k.prototype.IJd=function(Qa){this.removeHandler("SelectedRowChanged",Qa)};k.prototype.VZb=function(Qa){this.addHandler("ListBoxUpdated",
Qa)};k.prototype.Zsc=function(Qa){this.removeHandler("ListBoxUpdated",Qa)};k.prototype.dispose=function(){if(this.$){var Qa=Jb.g(this.$);this.N9&&(this.$.userOperationManager.to(this.Gca),this.$.userOperationManager.to(this.LOa));Qa&&(Qa.ha&&Qa.ha.zF(this.Rc),Qa.$b&&this.Gzb&&Qa.$b.Nl(this.Ef),Qa.view.Gq(this.$s));this.$.xa&&this.$.xa.ug(this.wh)}sa.a.Ia(this.ar);this.$=null};k.prototype.BFg=function(Qa){this.addHandler("CVIC",Qa)};k.prototype.dcj=function(Qa){this.removeHandler("CVIC",Qa)};k.prototype.Jh=
function(Qa,Mb){if(!this.visible)return!1;this.DBc(Mb);var kc;return(kc=this.E4h(Mb)).Ddc?kc.result:this.jyj(Mb)};k.prototype.Vwb=function(Qa){if(!this.visible)return!1;var Mb=!1;switch(Qa){case 1872288872:this.wH&&this.Rma();this.visible=!1;Mb=!0;break;case -798660877:this.Bfb(this.zwb(this.XW+1));Mb=!0;break;case 137938150:this.Bfb(this.zwb(this.XW-1));Mb=!0;break;case 2091832999:this.Bfb(this.zwb(this.XW+8));Mb=!0;break;case 742457698:this.Bfb(this.zwb(this.XW-8));Mb=!0;break;case 125627505:case 267796030:this.Uqb(this.Ht.items[this.XW]),
Mb=!0}return Mb};k.prototype.show=function(Qa){this.Ya=Jb.g(this.$).Gi;this.Iv=!0;this.XW=0;this.Ht=Qa;0<this.Ht.items.length&&(this.render(),this.Bfb(this.zwb(this.XW)),1===this.Ht.items[0].type&&this.Gzb&&(this.WAa=!0));this.formulaAssistanceTelemetryManager.W9e(Qa.items)};k.prototype.Rma=function(){this.Ifa=!1;this.Ya.wIe()};k.prototype.jyj=function(Qa){return[1872288872,-798660877,137938150,2091832999,742457698,125627505,267796030].includes(Qa)};k.prototype.E4h=function(Qa){return this.wH?125627505===
Qa||267796030===Qa?(this.Uqb(this.Ht.items[this.XW]),{Ddc:!0,result:!1}):!this.$Ef||-798660877!==Qa&&137938150!==Qa?{Ddc:!1}:{Ddc:!0,result:!1}:{Ddc:!1}};k.prototype.render=function(){var Qa=this;this.formulaAssistanceTelemetryManager.oO(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){var Mb={};Mb.zoomLevel=ma(this.$);this.formulaAssistanceUIControl.updateContext(Mb);this.Hq=function(){Qa.formulaAssistanceUIControl.renderAutoCompleteMenu(Qa.domElement,Qa.Ya.textBox.domElement,Qa.ved())};
this.Hq();this.L4i();this.ar.canReceiveFocus=!0;this.formulaAssistanceTelemetryManager.gQ(["autoCompleteRender"]);this.formulaAssistanceTelemetryManager.i8b("autoCompleteOverall")}};k.prototype.L4i=function(){var Qa=this.uOb;this.uOb=this.b0h(this.Ht.items);Qa!==We.Dismissed&&Qa!==We.Smart||this.uOb!==We.Simple&&this.uOb!==We.Mixed||this.raiseEvent("FormulaAutoCompleteShown")};k.prototype.o5i=function(){var Qa;if(this.Bki&&0!==this.Ht.items.length){var Mb=0<=this.XW?this.XW:0,kc=this.Ht.items[Mb];
kc={JF:kc.label,description:null!==(Qa=kc.detail)&&void 0!==Qa?Qa:"",selectedIndex:Mb+1,length:this.Ht.items.length};this.raiseEvent("SelectedRowChanged",kc)}};k.prototype.Uqb=function(Qa){if(this.Ya&&this.visible){var Mb=Qa.textEdit;this.Xld(this.Ya.text,Mb);this.Ya.textBox.caretPosition=Mb.range.start.character+Mb.newText.length;this.wH&&(this.Ifa=!1,this.Gzb&&(this.wSa=this.xSa=!0),this.N9&&this.Csj(),this.Ya.endEdit(!0,"FormulaAutoCompleteControl.CommitAutoCompletion",0));this.visible=!1;this.raiseEvent("CVIC",
{shouldRequestAutocompleteOnCommit:Qa.shouldRequestAutocompleteOnCommit});this.formulaAssistanceTelemetryManager.V9e(Qa.kind)}};k.prototype.Csj=function(){var Qa=Jb.g(this.$);this.formulaAssistanceTelemetryManager.v_={sk:Qa.ha.sa.activeCell,fqb:Qa.Wb.text,Wqb:!0};this.formulaAssistanceTelemetryManager.Mjc=this.$.xa.pa.sheetId;this.formulaAssistanceTelemetryManager.UBb=this.$.ea.Ke;this.$.userOperationManager.Br(this.LOa)};k.prototype.RJg=function(){this.WAa&&(this.formulaAssistanceTelemetryManager.CM.smartSuggestionShownCounter++,
this.WAa=!1);this.xSa&&(this.formulaAssistanceTelemetryManager.CM.smartSuggestionSelectedCounter++,this.xSa=!1);this.wSa&&(this.formulaAssistanceTelemetryManager.CM.smartSuggestionCommittedCounter++,this.wSa=!1)};k.prototype.ved=function(){var Qa=new m;Qa.completionItems=this.Ht.items;Qa.activeItemIndex=this.XW;this.cId(Qa);return Qa};k.prototype.cId=function(Qa){Qa.callbacks=new x;Qa.callbacks.onCompletionItemSelected=this.Ozd;Qa.callbacks.onCompletionItemCommitted=this.Nzd;Qa.callbacks.onFeedback=
this.qRa;Qa.callbacks.onDismiss=this.tKi;Qa.callbacks.onRestoreFocus=Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:6178649_FixFormulaBarFocusBug")?this.onRestoreFocus:void 0};k.prototype.IEd=function(Qa){this.Ifa=!0;var Mb=Qa.textEdit.newText;this.Ya.Kdb(Mb.substring(this.Ya.text.length-Qa.textEdit.range.start.character,Mb.length))};k.prototype.Bfb=function(Qa){var Mb=this.XW;this.XW=Qa;var kc=this.Ht.items[Qa];this.wH&&this.Rma();Mb!==Qa&&this.render();1===kc.type&&Ia.EwaSettings.tb()&&!Jb.g(this.$).Gi.text.includes("\n")&&
this.IEd(kc);this.o5i()};k.prototype.zwb=function(Qa){return 0>Qa?0:Math.min(Qa,this.Ht.items.length-1)};k.prototype.Xld=function(Qa,Mb){this.Ya.text=Qa.substring(0,Mb.range.start.character)+Mb.newText+Qa.substring(Mb.range.end.character,Qa.length);Jb.g(this.$).pj&&(Jb.g(this.$).Wb.text=this.Ya.text)};k.prototype.Std=function(){this.zIa&&(this.formulaAssistanceTelemetryManager.xY.selectByArrowKeyCounter++,this.zIa=!1);this.AIa&&(this.formulaAssistanceTelemetryManager.xY.selectByMouseHoverCounter++,
this.AIa=!1);this.yIa&&(this.formulaAssistanceTelemetryManager.xY.commitByTabKeyCounter++,this.yIa=!1);this.wIa&&(this.formulaAssistanceTelemetryManager.xY.commitByEnterKeyCounter++,this.wIa=!1);this.xIa&&(this.formulaAssistanceTelemetryManager.xY.commitByMouseClickCounter++,this.xIa=!1)};k.prototype.DBc=function(Qa){switch(Qa){case -798660877:case 137938150:case 2091832999:case 742457698:this.zIa=!0;break;case 125627505:this.yIa=!0;break;case 267796030:this.wIa=!0}};k.SJa=function(){return document.createElement("div")};
k.prototype.b0h=function(Qa){return Qa.reduce(function(Mb,kc){return Mb|=0===kc.type?We.Simple:We.Smart},We.Dismissed)};of.Object.defineProperties(k.prototype,{visible:{configurable:!0,enumerable:!0,get:function(){return this.Iv},set:function(Qa){Qa||this.dismiss();this.Iv=Qa}},wH:{configurable:!0,enumerable:!0,get:function(){return this.Ifa}},$Ef:{configurable:!0,enumerable:!0,get:function(){return 1===this.Ht.items.length&&1===this.Ht.items[0].type}}});Object(La.a)(k,"FormulaAutoCompleteControl",
Fe.a,[681,6,671]);var Cf=b(988);h.prototype.getRichValueFieldListContext=function(Qa,Mb,kc,zc){var Ib={x$:Qa,oJe:Mb},rc;if(rc=Object(Cf.b)(this.vsd))rc=this.vsd,rc=!(Ib.x$.FirstRow===rc.x$.FirstRow&&Ib.x$.FirstColumn===rc.x$.FirstColumn&&Ib.x$.LastRow===rc.x$.LastRow&&Ib.x$.LastColumn===rc.x$.LastColumn&&Ib.x$.SheetName===rc.x$.SheetName&&Ib.oJe===rc.oJe);rc&&this.Kg.Ubb();this.vsd=Ib;this.FDj&&this.Kg.r6a||this.Kg.xZ(Qa,kc,zc,Mb);this.M9b=new Cf.a;this.Kg.r6a?this.M9b.resolve(this.Kg.Hk):this.w9i();
return this.M9b.promise};h.prototype.dispose=function(){var Qa,Mb;null===(Mb=null===(Qa=Jb.g(this.$))||void 0===Qa?void 0:Qa.$b)||void 0===Mb?void 0:Mb.Nl(this.Ef)};h.prototype.w9i=function(){this.Kg.NZb(this.Bya);this.Kg.lGg(this.Vxf)};h.prototype.Ibg=function(){this.Kg.Rsc(this.Bya);this.Kg.Kcj(this.Vxf)};Object(La.a)(h,"ServerDataProvider",null,[677]);e.prototype.K3h=function(Qa,Mb,kc){return isNullOrUndefined(this.coloredReferencesManager)?!1:this.coloredReferencesManager.aBc(Qa,Mb,kc)};of.Object.defineProperties(e.prototype,
{coloredReferencesManager:{configurable:!0,enumerable:!0,get:function(){this.eVa||(this.eVa=this.$.da.za(281));return this.eVa}}});Object(La.a)(e,"FormulaHighlightsControl",null,[]);var pf=b(1199);d.prototype.dispose=function(){if(this.$){var Qa=this.gridView;Qa&&(Qa.ha&&la.a.vV()&&(this.cAb?Qa.$b.vk(this.Fh):Qa.ha.Sma(this.vh)),this.pff&&Qa.Ea&&Qa.Ea.gv(this.yi))}this.x2&&this.gridView.$b.Nl(this.Ef);this.U4&&(this.x2||this.gridView.$b.Nl(this.Ef),this.fqa.rcj(this.quf));this.T8.dcj(this.yuf);this.functionInfoManager&&
this.functionInfoManager.vbb(this.onFunctionInfoLoaded);la.a.Pfc&&this.Ya&&this.Ya.HIb(this.n6);sa.a.Ia(this.fqa);sa.a.Ia(this.T8);this.T8=this.fqa=this.functionInfoManager=this.$=null};d.prototype.dhj=function(){this.nNa=-1;this.cla=null};d.prototype.a7b=function(){this.T8.visible=!1;this.fqa.visible=!1};d.prototype.Jh=function(){this.zda();return!1};d.prototype.zda=function(){if(!this.Ya.FK)if(this.formulaAssistanceTelemetryManager.Zob.formulaAssistanceRequestAttemptedCounter++,this.Uyj()){this.functionInfoManager.h_||
(this.functionInfoManager.JYa(this.onFunctionInfoLoaded),this.functionInfoManager.i2a({}));var Qa=this.Ya,Mb=Qa.text;Qa=Qa.textBox.caretPosition;this.x2&&Mb.startsWith("=")&&(this.ZLa=!0,1===Mb.length&&(this.isCellContentOnlyEqualDuringEdit=!0));!this.U4||this.aSa?(this.formulaAssistanceTelemetryManager.oO(["argumentAssistanceComputation","autoCompleteComputation","argumentAssistanceOverall","autoCompleteOverall"]),this.QXf(Mb,Qa)):(this.formulaAssistanceTelemetryManager.oO(["autoCompleteComputation",
"autoCompleteOverall"]),this.Ngj(Mb,Qa));Ia.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutoCompleteWrapperPluginRequest",!1)&&this.Mgj(Mb,Qa)}else this.formulaAssistanceTelemetryManager.Zob.formulaAssistanceRequestOptimizedCounter++};d.prototype.QXf=function(Qa,Mb){var kc=this;Qa=this.pluginScheduler.batchRequester().functionSuggestionAndArgumentAssistance({functionSuggestion:{content:Qa,caretPosition:Mb},argumentAssistance:{content:Qa,caretPosition:Mb}});this.gW+=1;Qa.then(function(zc){--kc.gW;
0===zc.kind&&(kc.a5e(zc.payload.argumentAssistance),kc.F5e(zc.payload.functionSuggestion));return null})};d.prototype.Ngj=function(Qa,Mb){var kc=this;Qa={content:Qa,caretPosition:Mb};Qa=this.Eba?this.pluginScheduler.getRequester().functionSuggestion(Qa,0):this.pluginScheduler.requester().functionSuggestion(Qa);this.gW+=1;Qa.then(function(zc){--kc.gW;0===zc.kind&&kc.F5e(zc.payload);return null})};d.prototype.Mgj=function(Qa,Mb){var kc=this;Qa={content:Qa,caretPosition:Mb,enableAutocompleteWrapperPlugin:this.kxa&&
!this.g_&&"="===Qa};this.Eba&&(Qa=this.pluginScheduler.getRequester().runPerCharacterExperiment(Qa,0),this.gW+=1,Qa.then(function(zc){--kc.gW;if(0===zc.kind){zc=ik(zc.payload.results);for(var Ib=zc.next();!Ib.done;Ib=zc.next())if(Ib=Ib.value,0===Ib.kind){Ib=Ib.value;var rc=Ib.items;0<rc.length&&kc.gridView.cua.bPd("="+rc[0].textEdit.newText,Ib.data.value)}}return null}))};d.prototype.NKd=function(Qa,Mb){var kc=this;Qa={content:Qa,caretPosition:Mb};Qa=this.Eba?this.pluginScheduler.getRequester().argumentAssistance(Qa,
0):this.pluginScheduler.requester().argumentAssistance(Qa);this.gW+=1;Qa.then(function(zc){--kc.gW;0===zc.kind&&kc.a5e(zc.payload)})};d.prototype.Uyj=function(){var Qa=this.Ya,Mb=Qa.text;Qa=Qa.textBox.caretPosition;if(this.T8.visible&&Ob.a.equals(Mb,this.cla,!0)&&(!this.Qii||!bc.e(Mb))&&Qa===this.nNa)return!1;this.cla=Mb;this.nNa=Qa;return!0};d.prototype.vMd=function(){this.Eba?this.pluginScheduler.getRequester().runExperiment(new v,0):this.pluginScheduler.requester().runExperiment(new v)};d.prototype.a5e=
function(Qa){Qa&&this.Ya.isEditing?(this.formulaAssistanceTelemetryManager.gQ(["argumentAssistanceComputation"]),this.fqa.show(Qa,this.Ya.textBox.domElement)):this.fqa.dismiss()};d.prototype.F5e=function(Qa){var Mb;Qa&&0<Qa.items.length&&this.Ya.isEditing&&(!Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:6487912_SmartSuggestionFix")||this.Ya.text===this.cla)?this.nYc&&this.Ab.n5(this.gridView.ha.sa.activeCell)?(this.formulaAssistanceTelemetryManager.CM.smartSuggestionWouldSuggestInsidePivotCounter++,
this.T8.dismiss()):(this.formulaAssistanceTelemetryManager.gQ(["autoCompleteComputation"]),this.T8.show(Qa)):this.T8.dismiss();this.kxa&&"="===this.cla&&0<(null===(Mb=null===Qa||void 0===Qa?void 0:Qa.items)||void 0===Mb?void 0:Mb.length)&&1===Qa.items[0].type&&this.gridView.cua.bPd("="+Qa.items[0].textEdit.newText,Qa.data.value)};d.prototype.tMd=function(Qa){Qa={content:Qa,isCellContentOnlyEqualDuringEdit:this.isCellContentOnlyEqualDuringEdit};this.Eba?this.pluginScheduler.getRequester().runAuthoringExperiment(Qa,
0):this.pluginScheduler.requester().runAuthoringExperiment(Qa)};d.prototype.oOa=function(Qa){var Mb,kc=this.gridView.ha.sa.activeCell;if(kc){var zc=this.calcManager.cta(kc,!this.lnd);if(zc){var Ib=this.$.xa,rc=zc.sheet.index;0>=Ib.count||0>rc||rc>=Ib.count||(rc=Ib=null,this.pyd&&void 0!==this.calcManager&&null!==this.calcManager&&(Qa=null!==(Mb=null===Qa||void 0===Qa?void 0:Qa.cell)&&void 0!==Mb?Mb:this.gridView.Ea.Lr(kc))&&(Mb=this.calcManager.$bc(Qa.Zk),void 0!==Mb&&null!==Mb&&(Ib=Mb.FormatString,
rc=Mb.Builtin)),this.pluginScheduler.notifier().setActiveCell({colIndex:zc.range.col,rowIndex:zc.range.row,sheetIndex:this.$.xa.getItem(zc.sheet.index).sheetId,docName:zc.sheet.document.name,docPath:zc.sheet.document.path,formatString:Ib,builtIn:rc}))}else Sa.ULS.sendTraceTag(537162002,0,50,"FormulaAssistanceManager.NotifyActiveCellChanged ISheetGridCell location is null")}};d.prototype.NUj=function(){this.pluginScheduler.notifier().setFunctionsInfo(this.functionInfoManager.Y$b)};d.prototype.Kld=
function(){this.cAb?this.gridView.$b.Ak(this.Fh):this.gridView.ha.Rga(this.vh);var Qa=la.a.Pyb()?this.gridView.Ub(null):void 0;this.oOa(Qa);la.a.Pfc&&this.Ya.GYa(this.n6);this.vMd();this.T8.BFg(this.yuf);this.pluginScheduler.setServerDataProvider(new h(this.Kg,this.$));this.zda()};d.prototype.aBc=function(Qa,Mb,kc){kc=Object(Cf.b)(Mb)?this.wed(Mb,Object(Cf.b)(kc)?kc:pf.a):this.wed(Qa.text,Qa.textBox.selection);return this.MEh.K3h(Qa,Mb,kc)};of.Object.defineProperties(d.prototype,{ija:{configurable:!0,
enumerable:!0,get:function(){return this.T8}},ZUe:{configurable:!0,enumerable:!0,get:function(){return this.fqa}},Ya:{configurable:!0,enumerable:!0,get:function(){return this.gridView.Gi}},Ab:{configurable:!0,enumerable:!0,get:function(){return this.gridView.Ab}}});Object(La.a)(d,"FormulaAssistanceManager",null,[667,6]);b(207);var Hf=wc.a;$k(c,Hf);c.prototype.create=function(){var Qa=this,Mb=la.a.vV(),kc=Ia.EwaSettings.ma(374),zc=Ia.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",
!1),Ib=la.a.f_(this.$),rc=this.$.da,Ta=pb.GetServiceTaskFactory.create(rc,134,this.la,this.hb),Cb=pb.GetServiceTaskFactory.Ra(this.$.da,12,477,this.hb);var jc=la.a.V4()?pb.GetServiceTaskFactory.create(this.$.da,449,this.$.la,1):nb.Task.Ua(null);var tc=la.a.vV()?pb.GetServiceTaskFactory.create(this.$.da,414,this.$.la,1):nb.Task.Ua(null);if(zc||Mb){var kd=pb.GetServiceTaskFactory.Ra(rc,266,265,this.hb),Rd=pb.GetServiceTaskFactory.Ra(rc,219,220,this.hb),pe=pb.GetServiceTaskFactory.Ra(rc,491,492,this.hb);
cb.TaskExtensions.Aa(cb.TaskExtensions.Vd([kd,tc,jc,Rd,pe],this.la),function(){var ve=rc.za(19)||new U(Qa.$,tc.result),Se=Rd.result;if(Ib){var Ve=rc.za(464);Ve||(Ve=new d(Qa.$,ve,kd.result,tc.result,jc.result,pe.result,Cb.result.A3c(Qa.$,Ta.result)),Se.uXc(Ve.ZUe),Se.vXc(Ve.ija),Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:6312266_RedesignListBoxEvents")&&Se.wXc(Ve.ija))}else Ve=rc.za(221),Ve||(Ve=new f(Qa.$,ve,Ta.result,kd.result,null,Cb.result,jc.result,pe.result,tc.result),Se.uXc(Ve.$Ue),Se.wXc(Ve.wVe),
Se.vXc(Ve)),kc&&(rc.za(317)||new ha(Qa.$));Qa.pb(ve)},this.la,3)}else{var le=pb.GetServiceTaskFactory.Ra(rc,219,220,this.hb),Wd=pb.GetServiceTaskFactory.Ra(rc,491,492,this.hb);cb.TaskExtensions.Aa(cb.TaskExtensions.Vd([le,jc,tc],this.la),function(){var ve=rc.za(19)||new U(Qa.$,tc.result),Se=le.result,Ve=rc.za(221);Ve||(Ve=new f(Qa.$,ve,Ta.result,null,null,Cb.result,jc.result,Wd.result,tc.result),Se.uXc(Ve.$Ue),Se.wXc(Ve.wVe),Se.vXc(Ve));kc&&(rc.za(317)||new ha(Qa.$));Qa.pb(ve)},this.la,3)}};c.ka=
function(Qa){Qa.da.Ga(153,new c(Qa))};Object(La.a)(c,"FunctionInfoManagerFactory",wc.a,[]);b.d(E,"a",function(){return a})},1359:function(t,E,b){function a(){w.a.Fa(c.ka)}function c(V){return Aa.call(this,V)||this}function d(){}function e(V,La,Ra,pb){var cb=Ea.call(this,V)||this;cb.EDb=null;cb.ylc=null;cb.mfc=null;cb.m3=null;cb.xka=!1;cb.disposed=!1;cb.$Ma=!1;cb.Oh=null;cb.Szd=function(Sa){H.ULS.sendTraceTag(537163269,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback");
if(cb.disposed)H.ULS.sendTraceTag(537163268,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback: Callback not handled since dialog was already disposed");else{if(G.a(Sa)){H.ULS.sendTraceTag(537163267,0,15,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - request has expected errors: "+(Sa?pa.a.Cc(Sa.Errors):null)+".");if(Sa.Errors&&1===Sa.Errors.length){var Db=Sa.Errors[0].MessageId,Ab=cb.Gdd(Db);if(Ab){cb.Qzj(Db)?cb.gvj(Ab):cb.pr(Ab);cb.ila("OkInvalidByServer",
Sa.Errors[0].MessageIdName);return}}H.ULS.sendTraceTag(537163266,0,15,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: "+pa.a.Cc(Sa.Errors))}cb.ila("OkValid","None");cb.hide()}};cb.n5c=function(Sa){cb.DW(Sa);2!==Sa&&(cb.Oh=cb.$.Fb.sc("UserAction","DataValidationEditTimeToDialogTryClose"));1===Sa?cb.f$a():2===Sa?cb.zya():cb.Tla()};cb.Eca=function(){cb.kSj();cb.$Ma?cb.bze():cb.s0c();return cb.xka=!1};cb.selectedRanges=La;cb.ASb=Ra;cb.command=
pb;3===pb&&(cb.xka=!0);cb.Rb=2;cb.Bv=!1;cb.Xf=l.Xf;return cb}function h(V,La){this.options=this.cellRange=null;this.cellRange=V;this.options=La}function k(V,La){var Ra=ta.call(this,V)||this;Ra.W9=null;Ra.rha=null;Ra.jUa=null;Ra.Y9=null;Ra.X9=null;Ra.Hnc=function(){Ra.W9.checked?(Ra.rha.disabled=!1,Ra.jUa.disabled=!1,Ra.Y9.disabled=!1,Ra.X9.disabled=!1):(Ra.rha.disabled=!0,Ra.jUa.disabled=!0,Ra.Y9.disabled=!0,Ra.X9.disabled=!0);return!1};Ra.get_visible=Ra.Rja;Ra.set_visible=Ra.Hna;Ra.uk=La;Ra.kka();
return Ra}function n(V,La){var Ra=ja.call(this,V)||this;Ra.sba=null;Ra.gaf=null;Ra.uba=null;Ra.tba=null;Ra.Inc=function(){Ra.sba.checked?(Ra.uba.disabled=!1,Ra.tba.disabled=!1):(Ra.uba.disabled=!0,Ra.tba.disabled=!0);return!1};Ra.get_visible=Ra.Rja;Ra.set_visible=Ra.Hna;Ra.uk=La;Ra.kka();return Ra}function f(){}function v(V,La,Ra,pb){var cb=Ma.call(this,V)||this;cb.lub=null;cb.jNd=null;cb.xka=!1;cb.disposed=!1;cb.$Ma=!1;cb.Oh=null;cb.bXj=function(Sa,Db){cb.fbc(Sa);var Ab=cb.SZd();Sa=Ab.errorString;
var Wb=Ab.mq;if(Ab.returnValue)return cb.LLa(121,cb.uNh(cb.$,Db),0,cb.i5,!1),"";cb.ila("OkInvalidByClient",Wb);return Sa};cb.n5c=function(Sa){cb.DW(Sa);cb.Oh=cb.$.Fb.sc("UserAction","DataValidationEditTimeToDialogTryClose");0===Sa&&cb.Tla()};cb.selectedRanges=La;cb.ASb=Ra;cb.command=pb;3===pb&&(cb.xka=!0);cb.Rb=2;cb.Bv=!1;return cb}function m(V,La,Ra,pb,cb,Sa,Db,Ab){Ab=V.Na(9,void 0===Ab?null:Ab);Ab.selectedRanges=La;Ab.ruleOptions=Ra;return ra.g(V,"CreateOrEditDataValidation",Ab,pb,cb,Sa,Db,0)}function x(V,
La,Ra){var pb=fa.call(this,La)||this;pb.hwa=null;pb.Nec=null;pb.NT=null;pb.xK=null;pb.Vya=null;pb.Wya=null;pb.G5a=null;pb.CNa=null;pb.y$a=null;pb.ePa=null;pb.gpc=null;pb.vCd=null;pb.ECh=[[12,12,12,12,12,12,12,12],[0,0,2,2,0,1,0,1],[0,0,2,2,0,1,0,1],[3,3,3,3,3,3,3,3],[5,5,7,7,5,6,5,6],[8,8,10,10,8,9,8,9],[0,0,11,11,0,1,0,1],[4,4,4,4,4,4,4,4]];pb.Qmj=[[12,12],[1,1],[1,1],[12,12],[6,6],[9,9],[1,1],[12,12]];pb.Gnc=function(cb){var Sa=!1;(null===cb||void 0===cb?0:cb.Ca)&&(cb.Ca.keyCode===xa.a.Soa||cb.Ca.keyCode===
xa.a.Qh)&&(Sa=pb.Eca(cb),pb.NT.blur(),pb.xK.blur());return Sa};pb.Eca=function(){var cb=pb.NT.selectedIndex,Sa=pb.xK.selectedIndex;pb.gpc.innerText=pb.Evb(cb,Sa);pb.vCd.innerText=pb.rgd(cb,Sa);switch(cb){case 0:return pb.xK.disabled=!0,bb.DOMElementExtensions.setVisible(pb.y$a,!1),bb.DOMElementExtensions.setVisible(pb.ePa,!1),bb.DOMElementExtensions.setVisible(pb.G5a,!1),bb.DOMElementExtensions.setVisible(pb.CNa,!1),pb.hwa.disabled=!0,!1;case 3:return pb.xK.disabled=!0,bb.DOMElementExtensions.setVisible(pb.y$a,
!0),bb.DOMElementExtensions.setVisible(pb.ePa,!1),bb.DOMElementExtensions.setVisible(pb.G5a,!0),bb.DOMElementExtensions.setVisible(pb.CNa,!0),pb.hwa.disabled=!1;case 7:return pb.xK.disabled=!0,bb.DOMElementExtensions.setVisible(pb.y$a,!0),bb.DOMElementExtensions.setVisible(pb.ePa,!1),bb.DOMElementExtensions.setVisible(pb.G5a,!1),bb.DOMElementExtensions.setVisible(pb.CNa,!1),pb.hwa.disabled=!1;default:pb.hwa.disabled=!1,bb.DOMElementExtensions.setVisible(pb.y$a,!0),bb.DOMElementExtensions.setVisible(pb.CNa,
!1)}switch(Sa){case 0:case 1:bb.DOMElementExtensions.setVisible(pb.ePa,!0);break;default:bb.DOMElementExtensions.setVisible(pb.ePa,!1)}pb.xK.disabled=!1;pb.gpc.disabled=!1;bb.DOMElementExtensions.setVisible(pb.G5a,!1);bb.DOMElementExtensions.setVisible(pb.CNa,!1);return!1};pb.get_visible=pb.Rja;pb.set_visible=pb.Hna;pb.YQ=new ya.a;pb.YQ.add(ba.a.instance.ga(1664));pb.YQ.add(ba.a.instance.ga(1665));pb.YQ.add(ba.a.instance.ga(1668));pb.YQ.add(ba.a.instance.ga(1666));pb.YQ.add(ba.a.instance.ga(1667));
pb.YQ.add(ba.a.instance.ga(1669));pb.YQ.add(ba.a.instance.ga(1670));pb.YQ.add(ba.a.instance.ga(1671));pb.YQ.add(ba.a.instance.ga(1672));pb.YQ.add(ba.a.instance.ga(1673));pb.YQ.add(ba.a.instance.ga(1674));pb.YQ.add(ba.a.instance.ga(1675));pb.YQ.add("");pb.$=V;pb.uk=Ra;pb.kka();return pb}function l(){}function u(V,La){var Ra=this;this.EB=this.m1a=this.selectedRanges=null;this.TJe=!1;this.Oh=null;this.iMi=function(pb){H.ULS.sendTraceTag(537163284,0,50,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback");
!pb||G.a(pb)?H.ULS.sendTraceTag(537163283,0,10,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback, failed to get expected results."):(Ra.m1a=pb.Result,Ra.i1i())};this.Iyh=function(pb){Ra.DW("DataValidationEdit.ExpandExisitngDialog",pb);Ra.EB.c=u.pia(pb);1===pb?Ra.MHa(new A(Ra.m1a)):2===pb?Ra.MHa(new A):Ra.dnf()};this.gXi=function(pb){Ra.DW("DataValidationEdit.OverrideExisitngDialog",pb);Ra.EB.c=u.pia(pb);1===pb?Ra.MHa(new A):Ra.dnf()};this.$=V;this.o5c=La}function A(V){this.d5=
(V=void 0===V?null:V)?V.IsIgnoreBlank:!0;this.e5=V?V.IsInCellDropDown:!0;this.HN=V?V.LowerBoundary:"";this.IN=V?V.UpperBoundary:"";this.uB=V?V.ConditionType:0;this.ruleType=V?V.RuleType:0;this.$Z=V?V.IsAlertBlocking:!0;this.MT=V?V.AlertTitle:"";this.KT=V?V.AlertMessage:"";this.rV=V?V.InputMessage:"";this.XE=V?V.InputTitle:"";this.t5=V?V.IsShowErrorAlert:!0;this.u5=V?V.IsShowInputMessage:!0}function z(V){switch(V){case 0:V="AnyValue";break;case 1:V="WholeNumber";break;case 2:V="Decimal";break;case 3:V=
"List";break;case 4:V="Date";break;case 5:V="Time";break;case 6:V="TextLength";break;case 7:V="Custom";break;default:V="Unknown"}return V}function y(V){switch(V){case 0:V="Between";break;case 1:V="NotBetween";break;case 2:V="Equal";break;case 3:V="NotEqual";break;case 4:V="GreaterThan";break;case 5:V="LessThan";break;case 6:V="GreaterThanOrEqual";break;case 7:V="LessThanOrEqual";break;default:V="Unknown"}return V}var w=b(10);t=b(0);var D=b(915),H=b(15),F=b(133),J=b(41),S=b(394),N=b(177),T=b(259);
A.prototype.isEqual=function(V){return V?this.d5===V.d5&&this.e5===V.e5&&this.HN===V.HN&&this.IN===V.IN&&this.uB===V.uB&&this.ruleType===V.ruleType&&this.$Z===V.$Z&&this.MT===V.MT&&this.KT===V.KT&&this.rV===V.rV&&this.XE===V.XE&&this.t5===V.t5&&this.u5===V.u5:(H.ULS.shipAssertTag(537163233,0,!1,"DataValidationEditDialogState.IsEqual: State should not be Null"),!1)};Object(t.a)(A,"DataValidationEditDialogState",null,[]);var G=b(299),I=b(187),K=b(298),L=b(21),O=b(134),B=b(51),Q=b(58);u.prototype.Nc=
function(){return!1};u.prototype.executeCommand=function(V,La){-1728432249!==La.command&&I.a(La.command);this.selectedRanges=J.r(L.g(this.$).ha.sa.selectedRanges,this.$);L.g(this.$).lSa(!0);this.getDataValidationInitialState();this.Oh=this.$.Fb.sc("UserAction","DataValidationEditTimeToDialogOpen");this.TJe?H.ULS.sendTraceTag(537163285,0,50,"Open data validation edit dialog - NOT first time in session"):(H.ULS.sendTraceTag(23667778,0,50,"Open data validation edit dialog - FIRST time in session"),this.TJe=
!0);return Q.Task.Ua(!0)};u.prototype.Ac=function(V,La){return-1728432249===La.command};u.prototype.Tc=function(){return!1};u.prototype.getDataValidationInitialState=function(){var V=this,La=this.$.oa.va.Pb();S.a(this.$.userOperationManager,function(Ra,pb,cb){return T.f(V.$.oa.va,V.selectedRanges,K.b(Ra,V.iMi),K.a(pb),cb,La)},function(Ra){return new N.a(120,0,Ra,16)},null)};u.prototype.i1i=function(){var V=this.EB={};switch(this.m1a.Command){case 0:var La="CreateNew";break;case 1:La="CreateNewFromRule";
break;case 2:La="ExpandExisitng";break;case 3:La="OverrideExisitng";break;default:La="Unknown"}V.a=La;this.Oh&&(this.Oh.stop(),this.EB.r=this.Oh.id);switch(this.m1a.Command){case 0:this.EB.b=!1;this.EB.c="None";this.MHa(new A);break;case 1:this.EB.b=!1;this.EB.c="None";this.MHa(new A(this.m1a));break;case 2:this.EB.b=!0;this.o5c.M5g(this.$,this.Iyh);break;case 3:this.EB.b=!0;this.o5c.O5g(this.$,this.gXi);break;default:H.ULS.sendTraceTag(537163282,0,10,"DataValidationEditCommandHandler.PrepareUserDialog, unexpected command type.")}};
u.prototype.MHa=function(V){this.o5c.MHa(this.$,this.selectedRanges,V,this.m1a.Command);this.Uxi(V)};u.prototype.Uxi=function(V){u.Fsb(V,this.EB);this.EB.d=!0;B.b().Ce(48,this.EB,!0)};u.prototype.dnf=function(){this.EB.d=!1;B.b().Ce(48,this.EB,!0)};u.prototype.DW=function(V,La){var Ra={};V=(Ra.ButtonType=u.pia(La),Ra.DialogName=V,Ra.Location="dialog",Ra.NumberOfSelectedRanges=L.g(this.$).ha.sa.uK,Ra);O.b(this.$).yd(F.a.M6b,V)};u.Fsb=function(V,La){La.e=z(V.ruleType);La.f=y(V.uB);La.g=!!V.HN;La.h=
!!V.IN;La.i=V.d5;La.j=V.e5;La.k=V.u5;La.l=!!V.XE;La.m=!!V.rV;La.n=V.t5;La.o=V.$Z;La.p=!!V.MT;La.q=!!V.KT};u.pia=function(V){switch(V){case 1:return"Yes";case 2:return"No";case 0:return"Cancel";default:return H.ULS.shipAssertTag(537163281,0,!1,"DataValidationEditCommandHandler.DialogButtonToString: Unknown DialogButton"),"Unknown"}};Object(t.a)(u,"DataValidationEditCommandHandler",null,[401]);var U=b(135),X=b(1021),P;(function(V){V[V.between=0]="between";V[V.notBetween=1]="notBetween";V[V.equal=2]=
"equal";V[V.notEqual=3]="notEqual";V[V.greaterThan=4]="greaterThan";V[V.lessThan=5]="lessThan";V[V.greaterThanOrEqual=6]="greaterThanOrEqual";V[V.lessThanOrEqual=7]="lessThanOrEqual"})(P||(P={}));Object(t.b)("DataValidationRuleConditionType",P);var ea;(function(V){V[V.anyValue=0]="anyValue";V[V.wholeNumber=1]="wholeNumber";V[V.decimal=2]="decimal";V[V.list=3]="list";V[V.date=4]="date";V[V.time=5]="time";V[V.textLength=6]="textLength";V[V.custom=7]="custom"})(ea||(ea={}));Object(t.b)("DataValidationRuleType",
ea);var ia=b(150),da=b(180);of.Object.defineProperties(l,{Xf:{configurable:!0,enumerable:!0,get:function(){return ia.a.Oo(l.rk,"")}},agh:{configurable:!0,enumerable:!0,get:function(){return ia.a.Oo(l.egh,da.a.ga(1662),da.a.ga(1677),da.a.ga(1678),da.a.ga(1679),da.a.ga(1680),da.a.ga(1681),da.a.ga(1682),da.a.ga(1683),da.a.ga(1684),da.a.ga(1663),da.a.ga(1687),da.a.ga(1688),da.a.ga(1689),da.a.ga(1690),da.a.ga(1691),da.a.ga(1692),da.a.ga(1693),da.a.ga(1694),da.a.ga(1664),da.a.ga(1665),da.a.ga(1685),da.a.ga(1686),
da.a.ga(1676),"255")}},hgh:{configurable:!0,enumerable:!0,get:function(){return ia.a.Oo(l.fgh,da.a.ga(1699),da.a.ga(1703),da.a.ga(1704),"255","32")}},lgh:{configurable:!0,enumerable:!0,get:function(){return ia.a.Oo(l.ggh,da.a.ga(1698),da.a.ga(1701),da.a.ga(1700),da.a.ga(1702),da.a.ga(1703),da.a.ga(1704),"255","32")}}});l.y9f=255;l.rk="<div class='WACDialogRow' id='dataValidationTabsId'> </div> <div class='DataValidationEditErrorMessage WACDialogRowNoBreak' id='ErrorContainer'> <label id='validationErrorMessageId' class='WACDialogLabel' role='alert' >{0}</label> </div>";
l.egh="<div class='DataValidationEditTabContent' id='ConditionDivID'> <div class='DataValidationRow' id='allowConditionRow'> <label id='allowConditionSelectionLabelId' class='DataValidationEditElementLabel' for='allowConditionSelectionId'>{0}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='allowConditionSelectionId'> <option value='0'>{1}</option> <option value='1'>{2}</option> <option value='2'>{3}</option> <option value='3'>{4}</option> <option value='4'>{5}</option> <option value='5'>{6}</option> <option value='6'>{7}</option> <option value='7'>{8}</option> </select> </div> <div class='DataValidationRow' id='operatorSelectionDivId'> <label id='operatorSelectionLabelId' class='DataValidationEditElementLabel' for='operatorSelectionId'>{9}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='operatorSelectionId'> <option value='0'>{10}</option> <option value='1'>{11}</option> <option value='2'>{12}</option> <option value='3'>{13}</option> <option value='4'>{14}</option> <option value='5'>{15}</option> <option value='6'>{16}</option> <option value='7'>{17}</option> </select> </div> <div class='DataValidationRow' id='operatorInputDivId1'> <label id='operatorInputLableId1' class='DataValidationEditElementLabel' for='operatorInputId1'>{18}</label> <input type='text' id='operatorInputId1' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='operatorInputDivId2'> <label id='operatorInputLableId2' class='DataValidationEditElementLabel' for='operatorInputId2'>{19}</label> <input type='text' id='operatorInputId2' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationNonBorderRow' id='listDescriptionDivId'> <div id='listDescriptionDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='listDescriptionSubDivID'> <label id='listDescriptionLabelId' class='DataValidationEditLabel' for='listDescriptionSubDivID'>{20}</label> </div> </div> <div class='DataValidationNonBorderRow' id='ignoreBlankCheckboxDivID'> <div id='ignoreBlankCheckboxDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='ignoreBlankCheckboxSubDivID'> <input type='checkbox' id='ignoreBlankCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{21}'></input> <label id='\"\"' class='WACDialogLabel' for='ignoreBlankCheckBoxId' >{21}</label> </div> </div> <div class='DataValidationNonBorderRow' id='inCellDropdownDivId'> <div id='inCellDropdownDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='inCellDropdownSubDivId'> <input type='checkbox' id='inCellDropdownCheckboxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{22}'></input> <label id='\"\"' class='WACDialogLabel' for='inCellDropdownCheckboxId' >{22}</label> </div> </div> </div>";
l.fgh="<div class='DataValidationEditTabContent' id='inputDivID'> <div class='DataValidationNonBorderRow' id='inputMessageCheckBoxDivID'> <label id='showInputCheckBoxLabelId' class='DataValidationEditElementLabel' for='showInputCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='inputMessageCheckBoxSubDivID'> <input type='checkbox' id='showInputCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='inputTitleDivID'> <label id='inputTitleLabelId' class='DataValidationEditElementLabel' for='textForInputTitleId'>{1}</label> <input type='text' id='textForInputTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={4} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='inputMessageDivID'> <label id='inputMessageLabelId' class='DataValidationEditElementLabel' for='textForInputMessageId'>{2}</label> <textarea id='textForInputMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={3} autocomplete=\"off\"></textarea> </div> </div>";
l.ggh="<div class='DataValidationEditTabContent' id='alertDivID'> <div class='DataValidationNonBorderRow' id='showAlertCheckBoxDivID'> <label id='showAlertCheckBoxLabelId' class='DataValidationEditElementLabel' for='showAlertCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='showAlertCheckBoxSubDivID'> <input type='checkbox' id='showAlertCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='blockWarnRadioDivID'> <label id='blockWarnRadioLabelId' class='DataValidationEditElementLabel' for='blockWarnRadioSubDivID'>{1}</label> <div class='DataValidationEditRadio DataValidationEditNoBorderElement' id='blockWarnRadioSubDivID'> <input type='radio' id='blockingId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{2}' title='{2}'></input> <label id='blockingId' class='WACDialogLabel' for='blockingId' >{2}</label> <input type='radio' id='warningId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{3}' title='{3}'></input> <label id='blockingId' class='WACDialogLabel' for='warningId' >{3}</label> </div> </div> <div class='DataValidationRow' id='alertTitleDivID'> <label id='alertTitleLabelId' class='DataValidationEditElementLabel' for='textForAlertTitleId'>{4}</label> <input type='text' id='textForAlertTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={7} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='alertMessageDivID'> <label id='alertMessageLabelId' class='DataValidationEditElementLabel' for='textForAlertMessageId'>{5}</label> <textarea id='textForAlertMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={6} autocomplete=\"off\"></textarea> </div> </div>";
Object(t.a)(l,"DataValidationEditDialogHtml",null,[]);var xa=b(86),Z=b(626),ha=b(13),ya=b(192),va=b(248),bb=b(12),ba=b(14),fa=va.a;$k(x,fa);x.prototype.yAa=function(V){this.NT.selectedIndex=V.ruleType;this.xK.selectedIndex=V.uB;this.Nec.checked=V.e5;this.hwa.checked=V.d5;this.Vya.value=V.HN;this.Wya.value=V.IN;this.Eca(null)};x.prototype.Kpb=function(V){V.d5=this.hwa.checked;V.e5=this.Nec.checked;V.uB=this.xK.selectedIndex;V.ruleType=this.NT.selectedIndex;V.HN=this.Vya.value;V.IN=this.Wya.value};
x.prototype.dispose=function(){this.Tj();this.uk=this.vCd=this.gpc=this.ePa=this.y$a=this.CNa=this.G5a=this.Nec=this.Wya=this.Vya=this.xK=this.NT=this.hwa=null;fa.prototype.dispose.call(this)};x.prototype.render=function(V){V.appendChild(this.domElement)};x.prototype.Rja=function(){return this.isVisible};x.prototype.Hna=function(V){return this.isVisible=V};x.prototype.setFocus=function(){};x.prototype.Evb=function(V,La){return this.G0e(V,La,this.ECh)};x.prototype.rgd=function(V,La){return 0!==La&&
1!==La?"":this.G0e(V,La,this.Qmj)};x.prototype.kka=function(){this.domElement.innerHTML=l.agh;this.hwa=bb.DOMElementExtensions.getElementById(this.domElement,"ignoreBlankCheckBoxId");this.NT=bb.DOMElementExtensions.getElementById(this.domElement,"allowConditionSelectionId");this.xK=bb.DOMElementExtensions.getElementById(this.domElement,"operatorSelectionId");this.Vya=bb.DOMElementExtensions.getElementById(this.domElement,"operatorInputId1");this.Wya=bb.DOMElementExtensions.getElementById(this.domElement,
"operatorInputId2");this.gpc=bb.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId1");this.vCd=bb.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId2");this.G5a=bb.DOMElementExtensions.getElementById(this.domElement,"inCellDropdownDivId");this.CNa=bb.DOMElementExtensions.getElementById(this.domElement,"listDescriptionDivId");this.y$a=bb.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId1");this.ePa=bb.DOMElementExtensions.getElementById(this.domElement,
"operatorInputDivId2");this.Nec=bb.DOMElementExtensions.getElementById(this.domElement,"inCellDropdownCheckboxId");this.Pi()};x.prototype.G0e=function(V,La,Ra){return Ra.length<V||Ra[V].length<La?(H.ULS.sendTraceTag(537163280,0,10,"DataValidationEditDialog.GetOperatorLabel: wrong parameters conditionOption="+V+" operatorOption="+La+", cannot get label."),""):this.YQ.na(Ra[V][La])};x.prototype.Pi=function(){Z.a.instance.ra(ha.a.Lb,this.NT,this.Gnc);Z.a.instance.ra(ha.a.Lb,this.xK,this.Gnc);Z.a.instance.ra(ha.a.change,
this.NT,this.Eca);Z.a.instance.ra(ha.a.change,this.xK,this.Eca);Z.a.instance.ra(ha.a.change,this.xK,this.uk);Z.a.instance.ra(ha.a.change,this.NT,this.uk);Z.a.instance.ra(ha.a.change,this.Vya,this.uk);Z.a.instance.ra(ha.a.Lb,this.Vya,this.uk);Z.a.instance.ra(ha.a.change,this.Wya,this.uk);Z.a.instance.ra(ha.a.Lb,this.Wya,this.uk)};x.prototype.Tj=function(){Z.a.instance.Ba(ha.a.Lb,this.NT,this.Gnc);Z.a.instance.Ba(ha.a.Lb,this.xK,this.Gnc);Z.a.instance.Ba(ha.a.change,this.NT,this.Eca);Z.a.instance.Ba(ha.a.change,
this.xK,this.Eca);Z.a.instance.Ba(ha.a.change,this.xK,this.uk);Z.a.instance.Ba(ha.a.change,this.NT,this.uk);Z.a.instance.Ba(ha.a.change,this.Vya,this.uk);Z.a.instance.Ba(ha.a.Lb,this.Vya,this.uk);Z.a.instance.Ba(ha.a.change,this.Wya,this.uk);Z.a.instance.Ba(ha.a.Lb,this.Wya,this.uk)};x.sja=function(){var V;return V=new ya.a,V.add("operatorInputId1"),V.add("operatorInputId2"),V};of.Object.defineProperties(x.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return ba.a.instance.ga(1695)}},
a2g:{configurable:!0,enumerable:!0,get:function(){return this.NT.selectedIndex}}});Object(t.a)(x,"DataValidationEditConditionsControl",va.a,[545,6,546]);var ra=b(62),pa=b(31),Za=b(22),Ua=b(211),Ma=X.a;$k(v,Ma);v.prototype.MSd=function(){var V={};V=(V.RuleType=this.qd.ruleType,V.RuleOperatorType=this.qd.uB,V.OperatorInput1=this.qd.HN,V.OperatorInput2=this.qd.IN,V.IsIgnoreBlank=this.qd.d5,V.IsInCellDropDown=this.qd.e5,V.IsAlertBlocking=this.qd.$Z,V.AlertTitle=this.qd.MT,V.AlertMessage=this.qd.KT,V.InputTitle=
this.qd.XE,V.InputMessage=this.qd.rV,V.IsShowErrorAlert=this.qd.t5,V.IsShowInputMessage=this.qd.u5,V);this.kc(2,ba.a.instance.ga(1661));var La={};V=(La[v.Hu]=this.mc,La.validateDialogValues=this.bXj,La.RangePickerController=L.g(this.$).ig.mcc(),La.isModal=!1,La.bodyProps=V,La);this.initializeAndShow(ba.a.instance.ga(1660),this.n5c,V);H.ULS.sendTraceTag(537163278,0,50,"DataValidationEditDialog dialog opened.")};v.prototype.dispose=function(){this.disposed||(Ma.prototype.dispose.call(this),this.disposed=
!0)};v.prototype.sja=function(){return x.sja()};v.prototype.uNh=function(V,La){var Ra=this;return function(pb,cb,Sa){var Db=V.oa.va.Pb();return m(Ra.$.oa.va,Ra.selectedRanges,Ra.qSg(),Ra.N_a(pb,Ra.Szd(La)),K.a(cb),Sa,Db)}};v.prototype.Szd=function(V){var La=this;return function(Ra){H.ULS.sendTraceTag(537163277,0,50,"DataValidationEditDialog.OnDataValidationEditSuccessCallback");var pb;G.a(Ra)?(H.ULS.sendTraceTag(537163276,0,15,"DataValidationEditDialog.OnDataValidationEditSuccessCallback - request has expected errors: "+
(Ra?pa.a.Cc(Ra.Errors):null)+"."),Ra.Errors&&1===Ra.Errors.length&&((pb=La.Gdd(Ra.Errors[0].MessageId))?La.ila("OkInvalidByServer",Ra.Errors[0].MessageIdName):(La.ila("OkValid","None"),La.hide()),V(pb)),H.ULS.sendTraceTag(537163275,0,15,"DataValidationEditDialog.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: "+pa.a.Cc(Ra.Errors))):La.hide()}};v.prototype.qSg=function(){var V={};V.Command=this.command;V.RuleType=this.qd.ruleType;V.ConditionType=this.qd.uB;V.IsIgnoreBlank=this.qd.d5;
V.IsInCellDropDown=this.qd.e5;V.LowerBoundary=this.qd.HN;V.UpperBoundary=this.qd.IN;V.IsAlertBlocking=this.qd.$Z;V.IsShowErrorAlert=this.qd.t5;V.IsShowInputMessage=this.qd.u5;V.AlertTitle=this.qd.MT;V.AlertMessage=this.qd.KT;V.InputTitle=this.qd.XE;V.InputMessage=this.qd.rV;V.ShouldIgnoreFormulaError=this.$Ma;return V};v.prototype.Gdd=function(V){switch(V){case 1173235830:return ba.a.instance.ga(1710);case 43935303:return ba.a.instance.ga(1711);case -1323438439:return ba.a.instance.ga(1713);case 2112020473:return ba.a.instance.ga(1707);
case -219503282:return ba.a.instance.ga(1708);case 1689335445:return ba.a.instance.ga(1709);case 2146493810:return ba.a.instance.ga(1712);case -2104909922:return String.format(ba.a.instance.mb(105),this.lub,this.jNd);case -869372599:return String.format(ba.a.instance.mb(104),this.lub);case -1181828368:return ba.a.instance.ga(1715);case -758480861:return ba.a.instance.ga(1716);case -13729088:return ba.a.instance.ga(1717);case -846654055:return ba.a.instance.ga(1718);case 751854001:return ba.a.instance.ga(1719);
case -453846397:return ba.a.instance.ga(1720);case 1102013489:return ba.a.instance.ga(1721);case 835813260:return ba.a.instance.ga(1722);case 1577787509:return ba.a.instance.ga(1723);case 2083564019:return ba.a.instance.ga(1714);default:H.ULS.sendTraceTag(537163274,0,15,"DataValidationEditDialog.GetDataValidationServerErrorString - unexpected error: "+V.toString()+".")}return null};v.prototype.Tla=function(){this.ila("Cancel","None")};v.prototype.DW=function(V){H.ULS.sendTraceTag(537163273,0,50,"DataValidationEditDialog "+
(1===V?"Ok":"Cancel")+" was clicked.");var La={};V=(La.ButtonType=v.pia(V),La.DialogName=this.mc,La.Location="dialog",La.NumberOfSelectedRanges=L.g(this.$).ha.sa.uK,La);O.b(this.$).yd(F.a.M6b,V)};v.prototype.ila=function(V,La){var Ra={};v.Fsb(this.qd,Ra);Ra.o=V;Ra.p=La;Ra.n=this.xka;this.Oh&&(this.Oh.stop(),Ra.q=this.Oh.id);B.b().Ce(49,Ra,!0)};v.prototype.fbc=function(V){this.qd.ruleType=V.RuleType;this.qd.uB=V.RuleOperatorType;this.qd.HN=V.OperatorInput1;this.qd.IN=V.OperatorInput2;this.qd.$Z=V.IsAlertBlocking;
this.qd.t5=V.IsShowErrorAlert;this.qd.MT=V.AlertTitle;this.qd.KT=V.AlertMessage;this.qd.u5=V.IsShowInputMessage;this.qd.XE=V.InputTitle;this.qd.rV=V.InputMessage;this.qd.d5=V.IsIgnoreBlank;this.qd.e5=V.IsInCellDropDown;this.lub=V.firstOperatorLabel;this.jNd=V.secondOperatorLabel};v.prototype.sPb=function(V,La,Ra){var pb;var cb=pb=null;if(!V)return Ra?(pb=String.format(ba.a.instance.mb(105),this.lub,this.jNd),cb="DataValidationEditNoMinMaxError"):(pb=String.format(ba.a.instance.mb(104),this.lub),cb=
"DataValidationEditNoValueError"),{returnValue:!1,errorString:pb,mq:cb};if(V.length>l.y9f)return pb=ba.a.instance.ga(1714),{returnValue:!1,errorString:pb,mq:cb};if(Ua.d(V))return{returnValue:!0,errorString:pb,mq:cb};if(1===La||2===La||6===La){if(!Za.a.l5(V))return pb=ba.a.instance.ga(1707),{returnValue:!1,errorString:pb,mq:cb};if(1===La&&!Za.a.isInteger(V))return pb=ba.a.instance.ga(1708),{returnValue:!1,errorString:pb,mq:cb};if(6===La){if(!Za.a.isInteger(V))return pb=ba.a.instance.ga(1708),{returnValue:!1,
errorString:pb,mq:cb};if(0>parseInt(V,10))return pb=ba.a.instance.ga(1709),{returnValue:!1,errorString:pb,mq:cb}}}return{returnValue:!0,errorString:pb,mq:cb}};v.prototype.SZd=function(){var V=this,La;var Ra=La=null;var pb=this.qd.HN,cb=this.qd.IN,Sa=ea[this.qd.ruleType],Db=P[this.qd.uB];if(0===Sa)return{returnValue:!0,errorString:La,mq:Ra};var Ab=(0===Db||1===Db)&&3!==Sa&&7!==Sa;return!function(){var Wb=V.sPb(pb,Sa,Ab);La=Wb.errorString;Ra=Wb.mq;return Wb}().returnValue||Ab&&!function(){var Wb=V.sPb(cb,
Sa,Ab);La=Wb.errorString;Ra=Wb.mq;return Wb}().returnValue?{returnValue:!1,errorString:La,mq:Ra}:Ab&&(1===Sa||2===Sa||6===Sa)&&!Ua.d(pb)&&!Ua.d(cb)&&parseFloat(pb)>parseFloat(cb)?(La=ba.a.instance.ga(1712),Ra="DataValidationEditMaximumLessMinimumError",{returnValue:!1,errorString:La,mq:Ra}):{returnValue:!0,errorString:La,mq:Ra}};v.pia=function(V){switch(V){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return H.ULS.shipAssertTag(537163272,0,!1,"DataValidationEditDialog.DialogButtonToString: Unknown DialogButton"),
"Unknown"}};v.Fsb=function(V,La){La.a=z(V.ruleType);La.b=y(V.uB);La.c=!!V.HN;La.d=!!V.IN;La.e=V.d5;La.f=V.e5;La.g=V.u5;La.h=!!V.XE;La.i=!!V.rV;La.j=V.t5;La.k=V.$Z;La.l=!!V.MT;La.m=!!V.KT};of.Object.defineProperties(v.prototype,{qd:{configurable:!0,enumerable:!0,get:function(){return this.ASb}},mc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationEditDialog"}},o2b:{configurable:!0,enumerable:!0,get:function(){return 3===this.qd.ruleType}}});Object(t.a)(v,"DataValidationEditDialog",
X.a,[]);var oa=b(87);X=b(276);f.Pch="DataValidationDialogPanel";f.Och="DataValidationButtonPanel";f.Nch="DataValidationButtonClearAll";Object(t.a)(f,"CssClassNames",null,[]);var ja=va.a;$k(n,ja);n.prototype.render=function(V){V.appendChild(this.domElement)};n.prototype.Rja=function(){return this.isVisible};n.prototype.Hna=function(V){return this.isVisible=V};n.prototype.setFocus=function(){};n.prototype.dispose=function(){this.Tj();this.uk=this.uba=this.tba=this.gaf=this.sba=null;ja.prototype.dispose.call(this)};
n.prototype.kka=function(){this.domElement.innerHTML=l.hgh;this.sba=bb.DOMElementExtensions.getElementById(this.domElement,"showInputCheckBoxId");this.gaf=bb.DOMElementExtensions.getElementById(this.domElement,"inputMessageDivID");this.uba=bb.DOMElementExtensions.getElementById(this.domElement,"textForInputTitleId");this.tba=bb.DOMElementExtensions.getElementById(this.domElement,"textForInputMessageId");this.sba.checked=!0;this.Pi();this.Inc(null)};n.prototype.yAa=function(V){this.uba.value=void 0===
V.XE||null===V.XE?"":V.XE;this.tba.value=void 0===V.rV||null===V.rV?"":V.rV;this.sba.checked=V.u5;this.Inc(null)};n.prototype.Kpb=function(V){V.XE=this.uba.value;V.rV=this.tba.value;V.u5=this.sba.checked};n.prototype.Pi=function(){Z.a.instance.ra(ha.a.change,this.sba,this.Inc);Z.a.instance.ra(ha.a.change,this.sba,this.uk);Z.a.instance.ra(ha.a.change,this.uba,this.uk);Z.a.instance.ra(ha.a.Lb,this.uba,this.uk);Z.a.instance.ra(ha.a.change,this.tba,this.uk);Z.a.instance.ra(ha.a.Lb,this.tba,this.uk)};
n.prototype.Tj=function(){Z.a.instance.Ba(ha.a.change,this.sba,this.Inc);Z.a.instance.Ba(ha.a.change,this.sba,this.uk);Z.a.instance.Ba(ha.a.change,this.uba,this.uk);Z.a.instance.Ba(ha.a.Lb,this.uba,this.uk);Z.a.instance.Ba(ha.a.change,this.tba,this.uk);Z.a.instance.Ba(ha.a.Lb,this.tba,this.uk)};of.Object.defineProperties(n.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return ba.a.instance.ga(1697)}}});Object(t.a)(n,"DataValidationEditInputControl",va.a,[545,6,551]);var ta=va.a;$k(k,
ta);k.prototype.render=function(V){V.appendChild(this.domElement)};k.prototype.Rja=function(){return this.isVisible};k.prototype.Hna=function(V){return this.isVisible=V};k.prototype.setFocus=function(){};k.prototype.dispose=function(){this.Tj();this.uk=this.Y9=this.X9=this.jUa=this.rha=this.W9=null;ta.prototype.dispose.call(this)};k.prototype.kka=function(){this.domElement.innerHTML=l.lgh;this.W9=bb.DOMElementExtensions.getElementById(this.domElement,"showAlertCheckBoxId");this.rha=bb.DOMElementExtensions.getElementById(this.domElement,
"blockingId");this.jUa=bb.DOMElementExtensions.getElementById(this.domElement,"warningId");this.Y9=bb.DOMElementExtensions.getElementById(this.domElement,"textForAlertTitleId");this.X9=bb.DOMElementExtensions.getElementById(this.domElement,"textForAlertMessageId");this.W9.checked=!0;this.rha.checked=!0;this.Pi();this.Hnc(null)};k.prototype.yAa=function(V){this.rha.checked=V.$Z;this.jUa.checked=!V.$Z;this.Y9.value=void 0===V.MT||null===V.MT?"":V.MT;this.X9.value=void 0===V.KT||null===V.KT?"":V.KT;
this.W9.checked=V.t5;this.Hnc(null)};k.prototype.Kpb=function(V){V.MT=this.Y9.value;V.KT=this.X9.value;V.$Z=this.rha.checked;V.t5=this.W9.checked};k.prototype.Pi=function(){Z.a.instance.ra(ha.a.change,this.W9,this.Hnc);Z.a.instance.ra(ha.a.change,this.W9,this.uk);Z.a.instance.ra(ha.a.change,this.rha,this.uk);Z.a.instance.ra(ha.a.change,this.jUa,this.uk);Z.a.instance.ra(ha.a.change,this.Y9,this.uk);Z.a.instance.ra(ha.a.Lb,this.Y9,this.uk);Z.a.instance.ra(ha.a.change,this.X9,this.uk);Z.a.instance.ra(ha.a.Lb,
this.X9,this.uk)};k.prototype.Tj=function(){Z.a.instance.Ba(ha.a.change,this.W9,this.Hnc);Z.a.instance.Ba(ha.a.change,this.W9,this.uk);Z.a.instance.ra(ha.a.change,this.rha,this.uk);Z.a.instance.ra(ha.a.change,this.jUa,this.uk);Z.a.instance.Ba(ha.a.change,this.Y9,this.uk);Z.a.instance.Ba(ha.a.Lb,this.Y9,this.uk);Z.a.instance.Ba(ha.a.change,this.X9,this.uk);Z.a.instance.Ba(ha.a.Lb,this.X9,this.uk)};of.Object.defineProperties(k.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return ba.a.instance.ga(1696)}}});
Object(t.a)(k,"DataValidationEditMessagesControl",va.a,[545,6,547]);Object(t.a)(h,"MacroRecorderRangeDataValidationChangedPayload",null,[430]);var aa=b(1450),ma=b(70),Ea=X.a;$k(e,Ea);e.prototype.MSd=function(){var V={};V=(V.key=this.qd,V);this.initializeAndShow(ba.a.instance.ga(1660),this.n5c,V);H.ULS.sendTraceTag(537163271,0,50,"DataValidationEditDialogDeprecated dialog opened.")};e.prototype.dispose=function(){this.disposed||(this.mfc=this.ylc=this.m3=null,oa.a.Ia(this.EDb),this.EDb=null,O.b(this.$)&&
O.b(this.$).jUd("DataValidationDialogCorellation"),Ea.prototype.dispose.call(this),this.disposed=!0)};e.prototype.lv=function(V){Ea.prototype.lv.call(this,V);this.kc(2,ba.a.instance.ga(1661));V=this.bV(2);var La=this.bV(1),Ra=this.bV(0),pb=La.parentNode;pb.appendChild(V);pb.appendChild(La);pb.appendChild(Ra);V.parentNode.classList.add(f.Och);V.classList.add(f.Nch);V=document.getElementById("dataValidationTabsId");La=new x(this.$,document.createElement("div"),this.Eca);Ra=new n(document.createElement("div"),
this.Eca);pb=new k(document.createElement("div"),this.Eca);this.sci(La,Ra,pb);var cb;this.EDb=new aa.a(V,(cb=new ya.a,cb.add(La),cb.add(Ra),cb.add(pb),cb));this.EDb.zRf();this.SU=document.getElementById("validationErrorMessageId");this.yAa();O.b(this.$)&&O.b(this.$).TTd("DataValidationDialogCorellation")};e.prototype.lO=function(){Ea.prototype.lO.call(this);document.getElementById(this.di("WACDialogPanel")).classList.add(f.Pch)};e.prototype.sja=function(){return x.sja()};e.prototype.Udd=function(){return"validationErrorMessageId"};
e.prototype.sci=function(V,La,Ra){this.m3=V;this.mfc=La;this.ylc=Ra};e.prototype.Vnj=function(){function V(){return new h(La.selectedRanges,Ra)}var La=this,Ra={};Ra.IsClearAll=this.xka;Ra.Command=this.command;Ra.RuleType=this.qd.ruleType;Ra.ConditionType=this.qd.uB;Ra.IsIgnoreBlank=this.qd.d5;Ra.IsInCellDropDown=this.qd.e5;Ra.LowerBoundary=this.qd.HN;Ra.UpperBoundary=this.qd.IN;Ra.IsAlertBlocking=this.qd.$Z;Ra.IsShowErrorAlert=this.qd.t5;Ra.IsShowInputMessage=this.qd.u5;Ra.AlertTitle=this.qd.MT;Ra.AlertMessage=
this.qd.KT;Ra.InputTitle=this.qd.XE;Ra.InputMessage=this.qd.rV;Ra.ShouldIgnoreFormulaError=this.$Ma;var pb=this.$.oa.va.Pb();S.a(this.$.userOperationManager,function(cb,Sa,Db){return m(La.$.oa.va,La.selectedRanges,Ra,K.b(cb,La.Szd),K.a(Sa),Db,pb)},function(cb){return new N.a(121,0,cb,void 0,V)},null)};e.prototype.Qzj=function(V){return 1577787509===V};e.prototype.gvj=function(V){this.SU.innerText=V;this.kI(this.bV(0));this.$Ma=!0};e.prototype.bze=function(){this.$Ma=!1;this.SU.innerText=""};e.prototype.Gdd=
function(V){switch(V){case 1173235830:return ba.a.instance.ga(1710);case 43935303:return ba.a.instance.ga(1711);case -1323438439:return ba.a.instance.ga(1713);case 2112020473:return ba.a.instance.ga(1707);case -219503282:return ba.a.instance.ga(1708);case 1689335445:return ba.a.instance.ga(1709);case 2146493810:return ba.a.instance.ga(1712);case -2104909922:return String.format(ba.a.instance.mb(105),this.m3.Evb(this.qd.ruleType,this.qd.uB),this.m3.rgd(this.qd.ruleType,this.qd.uB));case -869372599:return String.format(ba.a.instance.mb(104),
this.m3.Evb(this.qd.ruleType,this.qd.uB));case -1181828368:return ba.a.instance.ga(1715);case -758480861:return ba.a.instance.ga(1716);case -13729088:return ba.a.instance.ga(1717);case -846654055:return ba.a.instance.ga(1718);case 751854001:return ba.a.instance.ga(1719);case -453846397:return ba.a.instance.ga(1720);case 1102013489:return ba.a.instance.ga(1721);case 835813260:return ba.a.instance.ga(1722);case 1577787509:return ba.a.instance.ga(1723);case 2083564019:return ba.a.instance.ga(1714);default:H.ULS.sendTraceTag(537163265,
0,15,"DataValidationEditDialogDeprecated.GetDataValidationServerErrorString - unexpected error: "+V.toString()+".")}return null};e.prototype.f$a=function(){H.ULS.sendTraceTag(537163264,0,50,"DataValidationEditDialogDeprecated 'Ok' was clicked.");this.fbc();var V=this.SZd();var La=V.errorString;var Ra=V.mq;if(!V.returnValue)return this.pr(La),this.ila("OkInvalidByClient",Ra),!1;this.Vnj();return!0};e.prototype.Tla=function(){this.fbc();this.ila("Cancel","None");this.hide()};e.prototype.zya=function(){H.ULS.sendTraceTag(537163235,
0,50,"DataValidationEditDialogDeprecated 'ClearAll' was clicked.");this.$Ma?this.bze():this.s0c();this.lhj();this.xka=!0};e.prototype.DW=function(V){var La={};V=(La.ButtonType=e.pia(V),La.DialogName=this.mc,La.Location="dialog",La.NumberOfSelectedRanges=L.g(this.$).ha.sa.uK,La);O.b(this.$).yd(F.a.M6b,V)};e.prototype.lhj=function(){this.ASb=new A;this.yAa()};e.prototype.yAa=function(){this.ylc.yAa(this.qd);this.mfc.yAa(this.qd);this.m3.yAa(this.qd)};e.prototype.fbc=function(){this.m3.Kpb(this.qd);
this.ylc.Kpb(this.qd);this.mfc.Kpb(this.qd)};e.prototype.ila=function(V,La){var Ra={};e.Fsb(this.qd,Ra);Ra.o=V;Ra.p=La;Ra.n=this.xka;this.Oh&&(this.Oh.stop(),Ra.q=this.Oh.id);B.b().Ce(49,Ra,!0)};e.prototype.sPb=function(V,La){var Ra;var pb=Ra=null;if(!V)return La?(Ra=String.format(ba.a.instance.mb(105),this.m3.Evb(this.qd.ruleType,this.qd.uB),this.m3.rgd(this.qd.ruleType,this.qd.uB)),pb="DataValidationEditNoMinMaxError"):(Ra=String.format(ba.a.instance.mb(104),this.m3.Evb(this.qd.ruleType,this.qd.uB)),
pb="DataValidationEditNoValueError"),{returnValue:!1,errorString:Ra,mq:pb};if(V.length>l.y9f)return Ra=ba.a.instance.ga(1714),{returnValue:!1,errorString:Ra,mq:pb};if(Ua.d(V))return{returnValue:!0,errorString:Ra,mq:pb};if(1===this.qd.ruleType||2===this.qd.ruleType||6===this.qd.ruleType){if(!Za.a.l5(V))return Ra=ba.a.instance.ga(1707),{returnValue:!1,errorString:Ra,mq:pb};if(1===this.qd.ruleType&&!Za.a.isInteger(V))return Ra=ba.a.instance.ga(1708),{returnValue:!1,errorString:Ra,mq:pb};if(6===this.qd.ruleType){if(!Za.a.isInteger(V))return Ra=
ba.a.instance.ga(1708),{returnValue:!1,errorString:Ra,mq:pb};if(0>parseInt(V,10))return Ra=ba.a.instance.ga(1709),{returnValue:!1,errorString:Ra,mq:pb}}}return{returnValue:!0,errorString:Ra,mq:pb}};e.prototype.SZd=function(){var V=this,La;var Ra=La=null;if(this.xka||0===this.qd.ruleType)return{returnValue:!0,errorString:La,mq:Ra};var pb=(0===this.qd.uB||1===this.qd.uB)&&3!==this.qd.ruleType&&7!==this.qd.ruleType;return!function(){var cb=V.sPb(V.qd.HN,pb);La=cb.errorString;Ra=cb.mq;return cb}().returnValue||
pb&&!function(){var cb=V.sPb(V.qd.IN,pb);La=cb.errorString;Ra=cb.mq;return cb}().returnValue?{returnValue:!1,errorString:La,mq:Ra}:pb&&(1===this.qd.ruleType||2===this.qd.ruleType||6===this.qd.ruleType)&&!Ua.d(this.qd.HN)&&!Ua.d(this.qd.IN)&&parseFloat(this.qd.HN)>parseFloat(this.qd.IN)?(La=ba.a.instance.ga(1712),Ra="DataValidationEditMaximumLessMinimumError",{returnValue:!1,errorString:La,mq:Ra}):{returnValue:!0,errorString:La,mq:Ra}};e.pia=function(V){switch(V){case 0:return"Cancel";case 1:return"Ok";
case 2:return"ClearAll";default:return H.ULS.shipAssertTag(537163234,0,!1,"DataValidationEditDialogDeprecated.DialogButtonToString: Unknown DialogButton"),"Unknown"}};e.Fsb=function(V,La){La.a=z(V.ruleType);La.b=y(V.uB);La.c=!!V.HN;La.d=!!V.IN;La.e=V.d5;La.f=V.e5;La.g=V.u5;La.h=!!V.XE;La.i=!!V.rV;La.j=V.t5;La.k=V.$Z;La.l=!!V.MT;La.m=!!V.KT};of.Object.defineProperties(e.prototype,{qd:{configurable:!0,enumerable:!0,get:function(){return this.ASb}},mc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationEditDialog"}},
onCommitDialogHandler:{configurable:!0,enumerable:!0,get:function(){var V=this;return function(){V.DW(1);V.f$a()}},set:function(V){Object(ma.b)(e.prototype,this,"onCommitDialogHandler",V)}},canBePreempted:{configurable:!0,enumerable:!0,get:function(){return!1}},o2b:{configurable:!0,enumerable:!0,get:function(){return 3===this.m3.a2g}}});Object(t.a)(e,"DataValidationEditDialogDeprecated",X.a,[]);var Ha=b(1);d.prototype.MHa=function(V,La,Ra,pb){Ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationReactDialog",
!1)?(new v(V,La,Ra,pb)).MSd():(new e(V,La,Ra,pb)).MSd()};d.prototype.M5g=function(V,La){var Ra=new U.StandardDialog;Ra.Rb=3;Ra.PAa(V.ob.qja,ba.a.instance.ga(1705),La)};d.prototype.O5g=function(V,La){var Ra=new U.StandardDialog;Ra.Rb=1;Ra.fX(V.ob.qja,ba.a.instance.ga(1706),La)};Object(t.a)(d,"DataValidationEditDialogFactory",null,[521]);var Aa=D.a;$k(c,Aa);c.prototype.zd=function(){this.jd([new u(this.$,new d)])};c.ka=function(V){D.a.Pd(245,new c(V))};Object(t.a)(c,"DataValidationEditCommandHandlerFactory",
D.a,[]);b.d(E,"a",function(){return a})},1366:function(t,E,b){function a(){G.a.Fa(c.ka)}function c(ka){var ca=la.call(this)||this;ca.$=ka;ca.Eb();return ca}function d(ka){var ca=this;this.ox=this.calcManager=this.jz=this.sSa=null;this.LLi=function(Ia,jb){if(Ia&&!pb.a(Ia)&&jb){var nb=!!Ia&&!!Ia.RequestTelemetryData;Ab.g(ca.$).si.tla(jb.toString(),Ia.StateId,nb?Ia.RequestTelemetryData.EcsOperationDuration:0,nb?Ia.RequestTelemetryData.EcsRequestDuration:0,nb?Ia.RequestTelemetryData.WfeRequestDuration:
0)}};this.$=ka;this.$.da.Za(268,function(Ia){ca.jz=Ia});this.kEh=new k(Ab.g(this.$).Ea,this.$);this.Gha=new f(this.$,Ab.g(this.$),this);this.$.da.Za(266,function(Ia){ca.calcManager=Ia});this.tb=fa.EwaSettings.tb();this.Am=fa.EwaSettings.Am();this.TAb=fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNumberFormatterInWebWorker",!1);this.Krd=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:6169583_checkTextAlignmentColorAndApplyNumberFormat2");this.SMa=fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",
!1);this.oqi=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:6280164_fixRTEregressionInMovingNFToWebWorker")}function e(ka,ca){this.success=ka;this.ez=ca}function h(){this.agg=this.DYj=!1;this.source=0;this.pwa=this.Vhc=!1}function k(ka,ca){this.ox=null;this.Ea=ka;this.M2a=ca}function n(ka,ca,Ia){this.success=ka;this.wmc=void 0===ca?null:ca;this.reason=void 0===Ia?"":Ia}function f(ka,ca,Ia){var jb=this;this.eda=[];this.calcManager=this.rzc=this.lastSetCellInstantaneousOperation=null;this.UJf=function(nb){var Na;
if(nb&&nb.rangeDeltas){for(var sa=jb.eda.length,Wa=0;Wa<nb.rangeDeltas.length;Wa++)(null===(Na=nb.rangeDeltas[Wa])||void 0===Na?0:Na.data)&&void 0!==nb.rangeDeltas[Wa].data.value&&null!==nb.rangeDeltas[Wa].data.value&&void 0!==nb.rangeDeltas[Wa].range&&null!==nb.rangeDeltas[Wa].range&&jb.eda.push(new v(nb.rangeDeltas[Wa],nb.stateId,nb.isFinished,nb.priorityGroup));L.ULS.sendTraceTag(574993422,0,50,"CalcResultProcessor.ProcessResults stateId="+nb.stateId+", priorityGroup="+nb.priorityGroup+", recalcFinished="+
nb.isFinished+", cellsFromCalc="+nb.rangeDeltas.length+", initialCellsToRender="+sa+", recalcedCells="+jb.eda.length+", lastSetCellInstantaneousOperation="+jb.lastSetCellInstantaneousOperation);!sa&&jb.eda.length&&jb.BBf(!1,0)}};this.$=ka;this.grid=ca;this.Hg=Ia;this.ada=f.PGe;this.$.da.Za(268,function(nb){jb.rzc=nb});this.$.da.Za(266,function(nb){jb.calcManager=nb});this.TAb=fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNumberFormatterInWebWorker",!1);this.Krd=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:6169583_checkTextAlignmentColorAndApplyNumberFormat2");
this.nqi=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:6280164_fixRTEregressionInMovingNFToWebWorker")}function v(ka,ca,Ia,jb){this.rangeDelta=ka;this.stateId=ca;this.isFinished=Ia;this.priorityGroup=jb}function m(ka,ca,Ia,jb,nb,Na,sa,Wa,Hb,Yb,Sb,lb,wb,wa,Oa,Ub,hb,Xb,Gc,uc,Nc,Fb,ob,zb,ib){this.numberOfDependentRecalcedCellsInBatch=this.numberOfEditedRecalcedCellsInBatch=this.newProcessingTimeLimit=this.originalProcessingTimeLimit=this.totalExecutionTime=this.numberOfSkippedCellsDueToMissingLocaleInfo=
this.numberOfUnsupportedRichCellTypes=this.numberOfUnsupportedBlankCellTypes=this.numberOfUnsupportedErrorCellTypes=this.numberOfCellsWithNoFormattedCell=this.numberOfCellsSkippedDueToTimeout=this.numberOfCellsUpdatedAlreadyByServer=this.numberOfUpdatedCells=this.numberOfNonUpdatedCells=this.totalNumberOfCellsInBatch=0;this.isNewTask=!1;this.lastSetCellInstantaneousOperation=null;this.taskId=0;this.numberOfHashFormattedValues=this.numberOfMeasureTextWidthCalls=this.newNumberFormatterFinalizeFailures=
this.totalNumberFormatterTime=this.numberOfRecalcedCellsWithoutFormattedValue=this.numberOfRecalcedCellsWithFormattedValue=this.isNewNumberFormatter=null;this.totalNumberOfCellsInBatch=void 0===ka?0:ka;this.numberOfNonUpdatedCells=void 0===ca?0:ca;this.numberOfUpdatedCells=void 0===Ia?0:Ia;this.numberOfCellsUpdatedAlreadyByServer=void 0===jb?0:jb;this.numberOfCellsSkippedDueToTimeout=void 0===nb?0:nb;this.numberOfCellsWithNoFormattedCell=void 0===Na?0:Na;this.numberOfUnsupportedErrorCellTypes=void 0===
sa?0:sa;this.numberOfUnsupportedBlankCellTypes=void 0===Wa?0:Wa;this.numberOfUnsupportedRichCellTypes=void 0===Hb?0:Hb;this.numberOfSkippedCellsDueToMissingLocaleInfo=void 0===Yb?0:Yb;this.totalExecutionTime=void 0===Sb?0:Sb;this.originalProcessingTimeLimit=void 0===lb?0:lb;this.newProcessingTimeLimit=void 0===wb?0:wb;this.numberOfEditedRecalcedCellsInBatch=void 0===wa?0:wa;this.numberOfDependentRecalcedCellsInBatch=void 0===Oa?0:Oa;this.isNewTask=void 0===Ub?!1:Ub;this.lastSetCellInstantaneousOperation=
void 0===hb?"":hb;this.taskId=void 0===Xb?0:Xb;this.isNewNumberFormatter=void 0===Gc?null:Gc;this.numberOfRecalcedCellsWithFormattedValue=void 0===uc?null:uc;this.numberOfRecalcedCellsWithoutFormattedValue=void 0===Nc?null:Nc;this.totalNumberFormatterTime=void 0===Fb?null:Fb;this.newNumberFormatterFinalizeFailures=void 0===ob?null:ob;this.numberOfMeasureTextWidthCalls=void 0===zb?null:zb;this.numberOfHashFormattedValues=void 0===ib?null:ib}function x(){}function l(ka,ca,Ia,jb,nb){this.iM=void 0===
ka?0:ka;this.cellValue=void 0===ca?"":ca;this.ifmt=void 0===Ia?0:Ia;this.priorityGroup=void 0===jb?"":jb;this.ez=void 0===nb?"":nb}function u(ka){ka=A(ka);if(0===ka)return 1;if(1===ka)return 2;L.ULS.sendTraceTag(537162182,0,10,"CalcInterfaceAdapter.GetInstantaneousUpdatedCellType: unknown updated cell type!");return 0}function A(ka){if(ka.priorityGroup===J.editCell)return 0;if(ka.priorityGroup===J.dependentCell)return 1;L.ULS.sendTraceTag(537162183,0,10,"CalcInterfaceAdapter.GetRecalcPriorityGroup: unknown priority group!");
return 2}function z(ka,ca){var Ia=A(ca),jb=!(void 0===ca.rangeDelta.data.format||null===ca.rangeDelta.data.format);L.ULS.shipAssertTag(537162187,0,0===Ia||!jb,"CalcInterfaceAdapter.GetRecalcInferredFormat: Format inference expected for Edited cell only "+ca.priorityGroup);ka=Math.max(ka.cell.Zk,0);jb&&(jb=excelOnlineCalc.calc.getCellFormatKind(ca.rangeDelta.data.format.format),"number"===jb?ka=ca.rangeDelta.data.format.format:"string"===jb?L.ULS.sendTraceTag(537162186,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind string"):
"Unavailable"===jb?L.ULS.sendTraceTag(537162185,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind unavailable"):L.ULS.shipAssertTag(537162184,0,!1,"CalcInterfaceAdapter.GetRecalcInferredFormat: unknown format kind!"));return ka}function y(ka){var ca=ka.value;switch(ka.type){case 2:return void 0===ca||null===ca?"":ca;case 1:return ka=parseFloat(ca),isNaN(ka)?null:ka;case 3:return ka=parseFloat(ca),isNaN(ka)?null:1===ka;case 4:return ka=parseFloat(ca),isNaN(ka)?null:excelOnlineCalc.calc.errorValue(ka);
default:return excelOnlineCalc.calc.blankValue}}function w(ka){ka=excelOnlineCalc.calc.getCellValueKind(ka.rangeDelta.data.value);var ca=0;switch(ka){case "number":ca=1;break;case "string":ca=2;break;case "boolean":ca=3;break;case "Error":ca=4;break;case "Blank":ca=0;break;default:L.ULS.shipAssertTag(537162191,0,!1,"CalcInterfaceAdapter.GetCellValueType: Unexpected unsupported type "+ka)}return ca}function D(ka,ca){ka=excelOnlineCalc.calc.getCellValueKind(ka.rangeDelta.data.value);switch(ka){case "number":case "string":case "boolean":return!0;
case "Blank":if(fa.EwaSettings.isChangeGateEnabled("OfficeVSO:5477761_Calc_BlankCellValueTypeSupported"))return!0;ca.numberOfUnsupportedBlankCellTypes++;return!1;case "Error":if(fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcErrorValueTypeSupported",!1))return!0;ca.numberOfUnsupportedErrorCellTypes++;return!1;case "Rich":return ca.numberOfUnsupportedRichCellTypes++,!1;default:return L.ULS.shipAssertTag(537162192,0,!1,"CalcInterfaceAdapter.IsCellValueTypeSupported: Unexpected unsupported type "+
ka),!1}}function H(ka){if(ka=ka.color){if("String"===Object.getType(ka).getName())return Ma.a.Po(ka);if("Number"===Object.getType(ka).getName())return null}else return null;L.ULS.sendTraceTag(537162193,0,10,"CalcInterfaceAdapter.GetFontColorFromFormattedValue: unknown color type!");return null}function F(ka){switch(ka.alignment){case "Center":return 2;case "Left":return 1;case "Right":return 3;default:return L.ULS.sendTraceTag(537162194,0,10,"CalcInterfaceAdapter.GetHorizontalAlignmentFromFormattedValue: unknown horizontal alignment!"),
0}}function J(){}function S(ka,ca,Ia,jb,nb,Na,sa,Wa,Hb,Yb,Sb,lb,wb){lb=void 0===lb?null:lb;wb=void 0===wb?null:wb;Wa=pa.call(this,11,0,Wa,Sb)||this;Wa.jEh=ka;Wa.Ebd=ca;Wa.format=jb;Wa.activeCell=Ia;Wa.Bre=nb;Wa.jHf=Na;Wa.eHf=sa;Wa.sFa=Hb;Wa.clientCorrelationId=Yb;Wa.fmb=lb;Wa.Bib=wb;return Wa}function N(){}function T(ka,ca,Ia,jb,nb,Na){if(0===jb)return Object(Ha.a)($a.UnsupportedZeroResize);if(0>jb||0===Ia.length)return Object(Ha.a)($a.InvalidInput);if(ka.z6h())return Object(Ha.a)($a.UnsupportedSkeletonInView);
var sa=ka.Qe;if(!sa)return Object(Ha.a)($a.NullSPD);var Wa=sa.UZe(Ia);if(Wa&&0<Wa.length)return Object(Ha.a)(Wa.length.toString()+" "+$a.UnsupportedHiddenInRange);a:{Wa=ik(Ia);for(var Hb=Wa.next();!Hb.done;Hb=Wa.next())Hb=Hb.value,nb?Hb.right=oa.a.Eh:Hb.bottom=oa.a.uh;Wa=ka.Y$("EditGridAction.IsMergeCellAcrossBlocksExistInRanges",Ia);try{for(Wa.$$rst();Wa.$$mn();)if(Wa.zn.ZEj){var Yb=!0;break a}}finally{Wa&&Wa.dispose()}Yb=!1}if(Yb)return Object(Ha.a)($a.UnsupportedMergeCell);if(fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase2",
!1)&&!nb&&"undefined"!==typeof gridRenderer)for(Yb=ik(Ia),Wa=Yb.next();!Wa.done;Wa=Yb.next())gridRenderer.CanvasRendererGlobals.resetColWidthCacheByCol(Wa.value.left);ka=ka.Ea;Yb=dc.a.create().toString();sa.qeg(Ia,jb,nb);Na=ka.URj(nb,Na);ca.q8i(Ia,nb);ka.r4i(Na,Yb,nb?"row":"column");return Object(Ha.d)(jb)}var G=b(10);t=b(0);var I=b(235),K=b(7),L=b(15),O=b(87),B=b(278),Q=b(192),U=b(445),X=b(85),P=b(995),ea=b(191),ia=b(283),da=b(24),xa=b(1093),Z=b(41);N.PFh="GalleryGeneral";N.RFh="GalleryNumber";N.NFh=
"GalleryCurrency";N.LFh="GalleryAccounting";N.UFh="GalleryShortDate";N.QFh="GalleryLongDate";N.WFh="GalleryTime";N.SFh="GalleryPercentage";N.OFh="GalleryFraction";N.TFh="GalleryScientific";N.VFh="GalleryText";N.DTg="ButtonComma";N.buttonPercentage="ButtonPercentage";N.keyboardNumber="KeyboardNumber";N.keyboardCurrency="KeyboardCurrency";N.keyboardDate="KeyboardDate";N.keyboardTime="KeyboardTime";N.keyboardPercentage="KeyboardPercentage";Object(t.a)(N,"RibbonFormatKind",null,[]);var ha=b(62),ya=b(313),
va=b(725),bb=b(724),ba=b(723),fa=b(1),ra=b(70),pa=ya.a;$k(S,pa);S.prototype.T2=function(ka){return pa.prototype.T2.call(this,ka)||this.jEh.T2(this.Ebd,this.activeCell,this.format,this.Bre,this.jHf,this.eHf,this.G_b,this.sFa,this.clientCorrelationId,this.fmb,this.Bib)};S.prototype.Zi=function(){var ka=[];if(this.idc)for(var ca=ik(this.idc),Ia=ca.next();!Ia.done;Ia=ca.next())ka.push(ba.a(Ia.value));else ka.push(new bb.a(this.format,this.Ebd,this.activeCell));return function(){return new va.a(ka)}};
S.prototype.Jeb=function(){var ka={OperationType:0};ka.FormatCellsMultiRange=this.Ebd;ka.ActiveCell=this.activeCell;ka.Format=this.format;ka.ApplyFormatOnPivotTableValueField=this.Bre;ka.PivotTableXluid=this.jHf;ka.PivotTableFieldCaption=this.eHf;return ka};of.Object.defineProperties(S.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return fa.EwaSettings.Zb()?Object(ra.a)(S.prototype,this,"operationWorkingState"):0}},nt:{configurable:!0,enumerable:!0,get:function(){return this.fmb}},
Baa:{configurable:!0,enumerable:!0,get:function(){return this.Bib}},HCc:{configurable:!0,enumerable:!0,get:function(){return this.sFa}}});Object(t.a)(S,"FormatCellsBatchOperation",ya.a,[]);var Za=b(36),Ua=b(219);J.editCell="Edited";J.dependentCell="Dependents";Object(t.a)(J,"RecalcPriorityGroupType",null,[]);var Ma=b(208),oa=b(9);Object(t.a)(l,"RecalcAccuracyObject",null,[]);x.string="String";x.blank="Blank";x.general="General";x.TCh="Flexible";Object(t.a)(x,"FormattedUnitKind",null,[]);Object(t.a)(m,
"RecalcResultProcessingStatistics",null,[]);Object(t.a)(v,"RecalcedCellInfo",null,[]);var ja=b(110),ta=b(11),aa=b(22),ma=b(58),Ea=b(63),Ha=b(450);f.prototype.dispose=function(){this.calcManager=this.rzc=this.Hg=this.grid=this.$=null};f.prototype.nad=function(ka,ca,Ia,jb,nb,Na,sa){if(!ca)return Object(Ha.a)("Null");var Wa=excelOnlineCalc.numfmt.renderCallback(jb,function(Yb){return gridRenderer.CanvasRendererGlobals.measureTextWidth(Yb,nb,!0,fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",
!1))},sa),Hb=ka.renderValue(ca,Wa);if(!excelOnlineCalc.util.isSuccess(Hb))return Object(Ha.a)("Finalize");jb=null;if(sa=excelOnlineCalc.numfmt.isHashesValue(Hb.value)){if(Hb=ka.renderHashesValue(Hb.value,Wa),!excelOnlineCalc.util.isSuccess(Hb))return Object(Ha.a)("Hashes")}else jb=f.vEh(ca,Hb.value);Wa=Hb.value;ka=excelOnlineCalc.numfmt.renderedValueToString(Wa);ca=F(Wa);Wa=H(Wa);return Object(Ha.d)({text:ka,valueType:Ia,fontColor:Wa,Zk:Na,s9a:jb,horizontalAlignment:ca,isHashesValue:sa})};f.prototype.BBf=
function(ka,ca){var Ia=this;this.$&&this.grid&&this.calcManager&&this.rzc&&this.calcManager.QC?(ka&&(this.ada=this.rzc.zaf),this.I2i(this.grid,this.calcManager.QC,ka,ca),!this.ada&&this.eda.length?ma.Task.delay(0).Jo(function(jb){Ia.BBf(!0,jb.id);return!0},0,null,Ea.a.current):ma.Task.Ua(!0)):(L.ULS.sendTraceTag(537162181,0,50,"CalcResultProcessor.OnRecalcResultsTask: one of the objects required for processing is null. Aborting..."),ma.Task.Ua(!1))};f.prototype.I2i=function(ka,ca,Ia,jb){var nb=ta.HelperMethods.Qb();
for(Ia=new m(this.eda.length,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,this.ada,void 0,void 0,void 0,Ia,void 0,jb,!0,0,0,0,0,0,0);0<this.eda.length;){jb=ta.HelperMethods.Qb()-nb;if(!this.ada||jb>this.ada){Ia.numberOfCellsSkippedDueToTimeout=this.eda.length;break}jb=Array.dequeue(this.eda);if(D(jb,Ia)){var Na=da.Range.Qc(jb.rangeDelta.range.row+1,jb.rangeDelta.range.column+1);(Na=ka.Ub(Na))?f.xVg(jb.stateId,Na.cell)?(f.rmc(ka,Na,jb,Ia),this.VLg(ca,Na,jb,Ia)):Ia.numberOfCellsUpdatedAlreadyByServer++:
Ia.numberOfCellsWithNoFormattedCell++}}jb=Math.round(ta.HelperMethods.Qb()-nb);this.wVj(jb);this.aIj(Ia,jb);this.tgj(Ia)};f.prototype.VLg=function(ka,ca,Ia,jb){var nb,Na,sa,Wa,Hb=z(ca,Ia),Yb=Ia.rangeDelta.data.formatted,Sb=w(Ia),lb=A(Ia);ka=this.nad(ka,Yb,Sb,ca.cell.lBa,ca.cell.Z$,Hb,!1);Hb=ca.cell.N0d;if(Object(Ha.c)(ka))if(this.TAb&&this.Krd){if(0===lb||ca.text!==ka.value.text)this.nqi&&0===lb&&this.pRd(Hb,ka.value)&&(ca.cell.formattedText=Hb),this.Hg.tZa(ca,ka.value),Ia=u(Ia),this.Hg.a8c(ca,this.lastSetCellInstantaneousOperation,
2,Ia,!0,!0),0===lb&&fa.EwaSettings.isChangeGateEnabled("OfficeVSO:6487996_CalcNotifiesRecalcComplete")&&(this.calcManager?this.calcManager.Esf(ca.range):L.ULS.sendTraceTag(521171802,0,15,"CalcResultsProcessor.applyRecalcResultOnCell: Unable to call notifyEditedCellRecalcComplete as calcManager member is null.")),jb.numberOfUpdatedCells++}else ca.text!==ka.value.text&&(this.Hg.tZa(ca,ka.value),Ia=u(Ia),this.Hg.a8c(ca,this.lastSetCellInstantaneousOperation,2,Ia,!0,!0),jb.numberOfUpdatedCells++);else switch(ka.reason){case "Null":jb.numberOfRecalcedCellsWithoutFormattedValue=
(null!==(nb=jb.numberOfRecalcedCellsWithoutFormattedValue)&&void 0!==nb?nb:0)+1;break;case "Hashes":jb.numberOfHashFormattedValues=(null!==(Na=jb.numberOfHashFormattedValues)&&void 0!==Na?Na:0)+1;break;case "Finalize":jb.newNumberFormatterFinalizeFailures=(null!==(sa=jb.newNumberFormatterFinalizeFailures)&&void 0!==sa?sa:0)+1}Object(Ha.b)(ka)&&"Null"!==ka.reason&&(jb.numberOfRecalcedCellsWithFormattedValue=(null!==(Wa=jb.numberOfRecalcedCellsWithFormattedValue)&&void 0!==Wa?Wa:0)+1);jb=0===lb?ca.cell.userInput:
ca.formulaBarText;Wa=Object(Ha.c)(ka)?ka.value.text:"";Ia=Object(Ha.b)(ka)?ka.reason:"";L.ULS.sendTraceTag(537162180,0,50,"CalcResultProcessor.ApplyRecalcResultOnCell: ("+ca.range.top+", "+ca.range.left+") 2nd pass formatting, success: "+ka.success+", reason: "+Ia+", priority: "+lb+", ifmt: "+ca.cell.Zk+", input: '"+(jb?aa.a.bM(jb):"null")+"', prediction: '"+(Wa?aa.a.bM(Wa):"null")+"',")};f.prototype.wVj=function(ka){this.ada=Math.max(this.ada-Math.max(ka,1),0)};f.prototype.aIj=function(ka,ca){ka.numberOfNonUpdatedCells=
this.eda.length;ka.totalExecutionTime=ca;ka.newProcessingTimeLimit=this.ada;ka.lastSetCellInstantaneousOperation=this.lastSetCellInstantaneousOperation};f.prototype.tgj=function(ka){ka=Sys.Serialization.JavaScriptSerializer.serialize(ka);L.ULS.sendTraceTag(574993417,0,50,"CalcResultProcessor.ReportRecalcProcessingStatistics:"+ka)};f.vEh=function(ka,ca){ka=ka.units;var Ia=ca.units;if(ka.length!==Ia.length)return L.ULS.sendTraceTag(537162179,0,15,"CalcResultProcessor.FormattedValueToNumberFormatInformation: can't convert to NumberFormatInformation: units and finalized units don't have the same length!"),
null;ca=[];for(var jb=-1,nb=0;nb<ka.length;nb++)switch(ka[nb].kind){case x.blank:ca.push.apply(ca,kk(ja.h(" ",Ia[nb].str.length)));break;case x.string:ca.push(ka[nb].str);break;case x.TCh:ca.push("");jb=nb;break;case x.general:ca.push(Ia[nb].str);break;default:L.ULS.sendTraceTag(537162178,0,15,"CalcResultProcessor.ProcessFormattedValue: unknown FormattedUnitKind!")}if(0>=jb||""===Ia[jb].str)return null;Ia={};Ia.Start=ca.slice(0,jb).join("");Ia.Separator=ka[jb].str;Ia.End=ca.slice(jb+1,ca.length).join("");
return Ia};f.iLh=function(ka){return ka&&ka&&ka.Tt?ka.Tt.lJ:oa.a.Ee};f.xVg=function(ka,ca){if(!ca)return!1;ca=f.iLh(ca);return ca===oa.a.Ee||ca===ka};f.rmc=function(ka,ca,Ia,jb){var nb=Ia.rangeDelta.data.value.toString(),Na=w(Ia),sa=z(ca,Ia);nb=new l(Na,nb,sa,Ia.priorityGroup);ca.cell.rmc(nb,ka.Ea.L5);1===A(Ia)?jb.numberOfDependentRecalcedCellsInBatch++:jb.numberOfEditedRecalcedCellsInBatch++};f.prototype.pRd=function(ka,ca){return null==ka?!1:!!ka.TextRuns&&!!ka.Fonts&&ka.Text===ca.text&&2===ca.valueType};
f.PGe=20;Object(t.a)(f,"CalcResultProcessor",null,[805,6]);Object(t.a)(n,"GetRibbonNumberFormatResult",null,[]);var Aa=b(1127);k.prototype.Ocb=function(ka,ca,Ia,jb,nb,Na){ka&&(ka.I0(ca,Ia,void 0===nb?!1:nb,void 0===Na?!1:Na),ka.verticalAlignment=jb)};k.prototype.ZKb=function(ka,ca,Ia){this.ox||(this.ox=new Aa.a(this.Ea,this.M2a));this.ox.ZKb(ka,ca,Ia)};Object(t.a)(k,"FormatCellsActionModelAccessor",null,[804]);var V=b(220),La=b(28),Ra=b(31),pb=b(299),cb=b(262),Sa=b(298),Db=b(74);Object(t.a)(h,"FormatCellInstantaneousResult",
null,[]);Object(t.a)(e,"FormatStringResult",null,[]);var Ab=b(21),Wb=b(211),ub=b(1299),vb=b(43),Ka=b(576),eb=b(51),yb=b(210),oc=b(277),Jb=b(77),dc=b(178),$a;(function(ka){ka.InvalidInput="invalid input";ka.UnsupportedZeroResize="resizing to 0 - ignore";ka.UnsupportedSkeletonInView="skeleton in view - ignore";ka.NullSPD="ActiveSheetProcessedData is null";ka.UnsupportedHiddenInRange="hiddens in resizeRanges";ka.UnsupportedMergeCell="There's a merge cell across blocks in resizeRanges"})($a||($a={}));
Object(t.b)("InstantaneousRowColumnResizeFailureReason",$a);var Ba=b(189);d.prototype.dispose=function(){O.a.oc([this.sSa,this.Gha]);this.$=this.Gha=this.sSa=null};d.prototype.QAa=function(ka,ca,Ia,jb,nb,Na,sa,Wa,Hb){return this.JBj(ka,ca,Ia,void 0===nb?!1:nb,void 0===Wa?0:Wa,void 0===Na?"":Na,void 0===Hb?null:Hb)};d.prototype.a8c=function(ka,ca,Ia,jb,nb,Na){ka.cell.Tt.rM|=jb;d.N1g(Ab.g(this.$),ka,Ia,nb);this.Gha.lastSetCellInstantaneousOperation=ca;Na&&Ab.g(this.$).si.P0(ca,Db.BasicTelemetryCalculator.KQ)};
d.prototype.Zda=function(ka,ca,Ia,jb,nb,Na){jb=void 0===jb?!1:jb;nb=void 0===nb?null:nb;var sa=void 0===sa?null:sa;Na=(void 0===Na?null:Na)||ka.ha.sa.selectedRanges;if(!(-1690267012===ca&&1<Na.length)){-1690267012===ca&&L.ULS.shipAssertTag(537162176,0,1===Na.length,"FormatCellsAction.ShowInstantaneousFormatting: targetRanges.Length = "+Na.length);var Wa=ka.Y$("FormatCellsAction.ShowInstantaneousFormatting",Na);try{Wa.$$rst();for(var Hb=!1;Wa.$$mn();){var Yb=void 0,Sb=Wa.$$cu().aF?ka.wKb(Wa.$$cu().range):
(Yb=new Q.a,Yb.add(Wa.$$cu()),Yb);Yb={};for(var lb=ik(Sb),wb=lb.next();!wb.done;Yb={fgb:Yb.fgb},wb=lb.next()){var wa=wb.value;if(Ab.g(this.$).kz&&wa&&sa&&-1690267012===ca&&(Yb.fgb=wa.range,Yb.fgb&&sa.contains(Yb.fgb)&&B.a.all(Na,function(Oa){return function(Ub){return!Z.c(Ub,Oa.fgb)}}(Yb))))continue;if(!wa||Wa.gb.contains(wa.range))if(this.b4f(ca,wa,Ia,jb,nb,Wa.$$cu().aF),Hb||(ka.Ea.uV(),Hb=!0),nb)break}}}finally{Wa&&Wa.dispose()}}};d.prototype.tZa=function(ka,ca,Ia){if(Ia=void 0===Ia?null:Ia)Ia.pwa=
!0;Ia=!ca.text;var jb=aa.a.Bff(ca.text),nb,Na=ka.aF?Ab.g(this.$).wKb(ka.range):(nb=new Q.a,nb.add(ka),nb);nb=ik(Na);for(Na=nb.next();!Na.done;Na=nb.next())this.TLg(this.$,Na.value,ca.text,ca.horizontalAlignment,ca.fontColor,ca.Zk,ka.cell.Zk,Ia,jb,ca.valueType,ca.s9a);ka.cell.vCc()};d.prototype.EYi=function(ka,ca,Ia,jb,nb){nb=void 0===nb?null:nb;try{var Na=Z.D(ca),sa=Z.D(Ia);if(ka.Ab.H6a(Na)||ka.Ab.H6a(sa))return 8;if(-185374993!==jb&&this.foi(ka,Na,sa))return 9;if(-185374993!==jb&&(ka.Ab.p5(sa)||
ka.Ab.oAb(Na)))return 10;if(1804571062!==jb&&ka.Ab.n5(sa))return 11;if(this.Pih(sa))return 12;if(this.Yoi(Na,sa))return 13;var Wa=this.$.Fb.sc("UserAction","PasteInstantaneous");Wa.start();Ka.a(Wa);nb&&eb.b().qA(Wa.id,nb.id,"actions","actions");!Na.isSingle&&sa.isSingle&&(sa=d.expandRange(Na,sa),ka.ha.updateSelection(sa,sa,0));switch(jb){case 237279923:case 808159687:if(!this.WYi(Na,sa))return 14;this.U2c(ka,Na,sa,!0,!1);break;case 1804571062:this.U2c(ka,Na,sa,!0,!1);break;case -185374993:this.U2c(ka,
Na,sa,!1,!0);break;default:return 2}L.ULS.sendTraceTag(537162146,0,50,"FormatCellsAction.PasteInstantaneous: Complete processing.");return 1}catch(Hb){return L.ULS.sendTraceTag(537162145,0,10,"FormatCellsAction.PasteInstantaneous: failed with the following error: "+JSON.stringify(Hb)),15}};d.prototype.IZg=function(ka,ca){ka=ik(ka);for(var Ia=ka.next();!Ia.done;Ia=ka.next())this.C0c(Ia.value,!0,ca)};d.prototype.C0c=function(ka,ca,Ia){Ia=void 0===Ia?"":Ia;if(ka){var jb=Ab.g(this.$);if(ca){if(ca=jb.Xj("FormatCellsAction.ClearRangeInstantaneous",
ka),ka=ka.isSingle?null:ka,ca.$$mn()&&void 0!==ca.$$cu()&&null!==ca.$$cu())for(jb=Object(K.a)(new oc.a,{Text:""}),this.QAa(ca.$$cu(),jb,!1,void 0,Za.a.$gc(this.$),Ia,void 0,void 0,ka);ca.$$mn();)void 0!==ca.$$cu()&&null!==ca.$$cu()&&this.QAa(ca.$$cu(),jb,!1,void 0,!1,Ia)}else this.Zda(jb,-1228228458,{},void 0,void 0,[ka])}else L.ULS.shipAssertTag(537162144,0,!1,"FormatCellsAction.ClearRangeInstantaneous: targetRange shouldn't be null")};d.prototype.q8i=function(ka,ca){if(!ca){ca=ta.HelperMethods.Qb();
var Ia=Ab.g(this.$),jb=Ia.Y$("FormatCellsAction.ReformatCells",ka);try{jb.$$rst();for(var nb=!1;jb.$$mn();){var Na=jb.$$cu().cell;if(0===Na.iM||2===Na.iM)this.updateSpillInformation(Na,ka),nb||(Ia.Ea.uV(),nb=!0)}}finally{jb&&jb.dispose()}L.ULS.sendTraceTag(537162143,0,50,"FormatCellsAction.ReformatCellsAfterGeometryChange: reformatting cells total time: "+(ta.HelperMethods.Qb()-ca)+".")}};d.prototype.Hdc=function(ka,ca){if(this.tb){if(ka.formulaBarText)return!aa.a.equals(ca.Text,ka.formulaBarText,
!1);var Ia=ka.cell.formattedText;Ia=cb.a(Ia,ka.cell.getCellFont());return!gridRenderer.CanvasRendererGlobals.compareFormattedTexts(Ia,ca).isEqual}return!aa.a.equals(ca.Text,ka.text,!1)};d.prototype.qEh=function(ka){if(void 0===ka||null===ka)return new e(!1,"1234.56");ka=this.f3a({value:"1234.56",type:1},ka,244,"12px sans-serif");return Object(Ha.b)(ka)?new e(!1,"1234.56"):new e(!0,ka.value.text)};d.prototype.KBj=function(ka,ca,Ia,jb){return T(ka,this,ca,Ia,jb,!0)};d.prototype.a4f=function(ka,ca,Ia){if(!this.Hdc(ca,
Ia))return Object(Ha.d)("Skip unchanged cell content");ca=ca.cell;Ia=this.XUe(Ia.Text,ca.Zk,ca.lBa,ca.Z$,!0);if(Object(Ha.b)(Ia))ka=Ia;else{Ia=Ia.value;var jb=Ia.text;var nb=Ia.valueType;jb=ca.hasRichValueIcon?"Unsupported rich value icon":ca.Nea?fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EstimateWrapTextEditResize",!1)&&2==nb&&'normal 11pt "calibri"'===ca.Z$&&ca.JBe(jb)>=ca.offsetWidth*Math.floor(ca.offsetHeight/oa.a.r1a)?"Unsupported wrapped text with long input":"Unsupported wrapped text":
ca.uif||null!=ca.mS&&0!==ca.mS?"Unsupported rotated text":!0;!0!==jb?ka=Object(Ha.a)(jb):(ca.isCellWidthFixed?jb="Skip fixed width cell":(jb=Ia.valueType,jb=0===jb?"Skip empty cell value":2===jb?"Skip string cell value":ca.XM&&!ca.$ni?"Skip merged cell":ca.jyc?"Skip shrunk to fit":Ia.isHashesValue?"Skip hashes cell value":!0),!0!==jb?ka=Object(Ha.d)(jb):(Ia=ca.JBe(Ia.text),Ia>ca.offsetWidth?(ca=[ca.getRange().clone()],ka=T(ka,this,ca,Ia,!1,!1),ka=Object(Ha.b)(ka)?ka:Object(Ha.d)(Ia)):ka=Object(Ha.d)("Column is wide enough")))}return ka};
d.prototype.VUe=function(ka,ca,Ia,jb,nb){var Na={};Na.value=ka;Na.type=Ia;ca=this.f3a(Na,ca,jb,nb);return Object(Ha.b)(ca)?new e(!1,ka):new e(!0,ca.value.text)};d.prototype.updateSpillInformation=function(ka,ca){var Ia=ka.getRange(),jb=!1;ca=ik(ca);for(var nb=ca.next();!nb.done;nb=ca.next())if(Ia.left===nb.value.left){jb=!0;break}ka.jSj(jb)};d.prototype.JBj=function(ka,ca,Ia,jb,nb,Na,sa){var Wa=void 0;Na=void 0===Na?"":Na;Wa=void 0===Wa?1:Wa;sa=void 0===sa?null:sa;this.TAb&&this.oqi&&(ka.cell.N0d=
ca);var Hb=new h;Hb.source=0;Hb.pwa=!1;ka.cell.lpc=ka.cell.Zk;var Yb=ca.Text,Sb=!Yb,lb=aa.a.Bff(Yb);aa.a.uq(Yb)&&(L.ULS.shipAssertTag(537162142,0,!((void 0===Yb||null===Yb)&&void 0!==ca.TextRuns&&null!==ca.TextRuns),"FormatCellsAction.ShowInstantaneousDataEntryOnCellInternal: Text is null but TextRuns isn't"),ca=Object(K.a)(new oc.a,{Text:""}),Yb="");ka.cell.userInput=Yb;if(!this.Hdc(ka,ca))return this.eXg(ka,nb,Sb,lb,Hb);Ia?this.YWg(ka,Yb,this.$.workbookContext.DefaultHyperlinkStyle,Hb):this.SWg(ka,
ca,Yb,Sb,lb,jb,Hb,sa);this.a8c(ka,Na,nb,Wa,Hb.Vhc,Hb.pwa);return Hb};d.prototype.eXg=function(ka,ca,Ia,jb,nb){nb.agg=!0;nb.Vhc=!0;nb.pwa=!1;0===ca&&Ab.g(this.$).Ea.uV();0===ka.cell.Yya&&(Ia?ka.cell.I0(0,!1):jb&&ka.cell.I0(1,!1));this.EXd(ka.range,"FormatCellsAction.cellUnchangedDataEntryCSE");return nb};d.prototype.YWg=function(ka,ca,Ia,jb){jb.pwa=!0;ka.insertHyperlink(ca,Ua.a.Vad(ca),Ia);this.EXd(ka.range,"FormatCellsAction.cellDataEntryCSE")};d.prototype.SWg=function(ka,ca,Ia,jb,nb,Na,sa,Wa){Wa=
void 0===Wa?null:Wa;sa.pwa=!1;var Hb=ka.cell;this.jz||(this.jz=this.$.da.za(268));this.ZNj(this.jz,Hb.Zk);jb||nb?this.UWg(ka,jb,nb,sa):(jb=this.XUe(Ia,Hb.Zk,Hb.lBa,Hb.Z$,!1),Object(Ha.c)(jb)?(this.pRd(ca.TextRuns,ca.Fonts)&&this.WWg(ka,ca,jb.value),this.tZa(ka,jb.value,sa),this.EXd(ka.range,"FormatCellsAction.cellDataEntryCSE")):this.TAb&&this.Krd?this.bXg(ka,ca.Text,sa):this.cXg(ka,ca.Text),ca=Object(Ha.c)(jb)?jb.value.text:"",nb=Object(Ha.b)(jb)?jb.reason:"",L.ULS.sendTraceTag(559724065,0,50,"FormatCellsAction.CellDataEntryCSE: ("+
ka.range.top+", "+ka.range.left+") 1st pass formatting, success: "+jb.success+", reason: "+nb+", ifmt: "+Hb.Zk+", input: '"+aa.a.nZa(Hb.userInput)+"', prediction: '"+aa.a.nZa(ca)+"',"));Hb.formulaBarText=Ia;Na&&this.yNj(this.jz,ka,Ia,Wa);sa.Vhc=!0};d.prototype.UWg=function(ka,ca,Ia,jb){jb.pwa=!0;ka.text="";ka.formulaBarText="";ka.cell.userInput="";this.k2b(ka,null,null,ca,Ia)};d.prototype.WWg=function(ka,ca,Ia){ca.Text===Ia.text&&2===Ia.valueType&&(ka.cell.formattedText=ca)};d.prototype.bXg=function(ka,
ca,Ia){Ia&&(Ia.pwa=!0);ka.text=ca;ka.formulaBarText=ca;this.k2b(ka,1)};d.prototype.cXg=function(ka,ca){ka.text=ca;ka.formulaBarText=ca;this.k2b(ka,1)};d.prototype.k2b=function(ka,ca,Ia,jb,nb,Na){Ia=void 0===Ia?null:Ia;jb=void 0===jb?!1:jb;nb=void 0===nb?!1:nb;Na=void 0===Na?!1:Na;var sa=ka.horizontalAlignment;Ia=null!=Ia?Ia:ka.verticalAlignment;0===ka.cell.Yya&&(null!=ca||jb||nb||Na)&&(jb?sa=0:nb||Na?sa=1:null!=ca&&(sa=ca),this.Lua.Ocb(ka,sa,!1,Ia,!0))};d.prototype.EXd=function(ka,ca){var Ia=this;
if(fa.EwaSettings.isChangeGateEnabled("OfficeVSO:6487996_CalcNotifiesRecalcComplete")){var jb=Ab.g(this.$),nb=function(){Ia.calcManager?Ia.calcManager.Esf(ka):L.ULS.sendTraceTag(521172961,0,50,"FormatCellsAction.cellUnchangedDataEntryCSE: Unable to call notifyEditedCellRecalcComplete as calcManager member is null. caller: "+ca+", cell "+ka);jb.Wb.Nl(nb)};jb.Wb.um(nb)}};d.prototype.ZNj=function(ka,ca){(null===ka||void 0===ka?0:ka.qya)&&ca>=d.BCh&&ca>ka.qya.length-1&&(L.ULS.sendTraceTag(537162141,0,
50,"FormatCellsAction.TriggerSupportInformationRefresh: The cell has a missing format, ifmt:"+ca+". Triggering refresh..."),ka.NUe())};d.prototype.yNj=function(ka,ca,Ia,jb){jb=void 0===jb?null:jb;if(void 0!==ka&&null!==ka)if(this.jz.amd)L.ULS.sendTraceTag(537162140,0,50,"FormatCellsAction.TriggerCalc: in manual mode - not recalcing");else{var nb=this.$.da.za(266);nb&&(this.Gha.ada=f.PGe,ka&&(this.Gha.ada=ka.zaf),nb.MUg(ca,Ia,this.Gha.UJf,jb))}};d.prototype.f3a=function(ka,ca,Ia,jb){var nb=this.$.da.za(266);
if(!nb)return Object(Ha.a)("calcManager is null");if(!nb.QC)return Object(Ha.a)("calcManager.NumberFormatter is null");if(!this.jz)return Object(Ha.a)("instantaneousManager is null");if("number"===typeof ca||"string"===typeof ca){var Na=nb.Ybc(ca);if(!Object(Ha.c)(Na))return Na;var sa=Na.value}else sa=ca;Na=nb.QC;var Wa=y(ka);if(void 0===Wa||null===Wa)return Object(Ha.a)("cellValue is null");nb=excelOnlineCalc.calc.cellValueToReadOper(nb.config.mathpack,Wa);if(void 0===nb||null===nb)return Object(Ha.a)("readOper is null");
nb=Na.applyFormat(sa,nb,fa.EwaSettings.isChangeGateEnabled("OfficeVSO:6328006_applyFormatDisplaysZeroes"));return excelOnlineCalc.util.isSuccess(nb)?this.Gha.nad(Na,nb.value,ka.type,Ia,jb,"number"===typeof ca?ca:-1,!1):Object(Ha.a)("NumberFormatter.ApplyFormat: "+JSON.stringify(nb.reason.kind))};d.prototype.XUe=function(ka,ca,Ia,jb,nb){var Na=this.$.da.za(266);if(void 0===Na||null===Na)return Object(Ha.a)("calcManager is null");if(void 0===Na.QC||null===Na.QC)return Object(Ha.a)("calcManager.NumberFormatter is null");
if(void 0===this.jz||null===this.jz)return Object(Ha.a)("instantaneousManager is null");if(this.TAb&&!nb)return Object(Ha.a)("No main thread number formatter");var sa=Na.Ybc(ca);if(!Object(Ha.c)(sa))return sa;var Wa=sa.value;sa=Na.QC;ka=sa.parseEdit(ka,Wa);if(!excelOnlineCalc.util.isSuccess(ka))return Object(Ha.a)("ParseEdit failure: reason="+ka.reason.kind+", features="+ka.reason.features);if(ka.value.kind===xa.a.formula)return Object(Ha.a)("Main thread - skipping formula edit");Na=excelOnlineCalc.numfmt.applyValueEdit(sa,
Na.localeInfo,Wa,ka.value);if(!excelOnlineCalc.util.isSuccess(Na))return Object(Ha.a)("NumberFormatter.FormatValueEdit: "+JSON.stringify(Na.reason.kind));ka=ka.value;L.ULS.shipAssertTag(537162190,0,ka.kind!==xa.a.formula,"CalcInterfaceAdapter.GetCellValueTypeFromParsedEdit: given parsed edit must be a value edit!");ka=excelOnlineCalc.numfmt.getValueEditOperKind(ka);Wa=0;switch(ka){case 0:case 128:Wa=0;break;case 1:Wa=1;break;case 2:Wa=2;break;case 4:Wa=3;break;case 8:Wa=4;break;case 16:case 32:case 64:case 256:L.ULS.sendTraceTag(537162189,
0,15,"CalcInterfaceAdapter.OperKindToCellValueType: can't convert given OperKind "+ka+" to a CellValueType");break;default:L.ULS.shipAssertTag(537162188,0,!1,"CalcInterfaceAdapter.OperKindToCellValueType: Unexpected oper kind "+ka)}return this.Gha.nad(sa,Na.value,Wa,Ia,jb,"number"===typeof ca?ca:-1,nb)};d.prototype.foi=function(ka,ca,Ia){if(ca.width<Ia.width)for(var jb=ka.Xj("FormatCellsAction.IsSourceRangeLargerAndWithBorders",new da.Range(ca.top,ca.left,ca.bottom,ca.left,!0,!0));jb.$$mn();){var nb=
jb.$$cu();if(nb&&nb.ZKa())return L.ULS.sendTraceTag(537162139,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0}if(ca.height<Ia.height)for(ka=ka.Xj("FormatCellsAction.IsSourceRangeLargerAndWithBorders2",new da.Range(ca.top,ca.left,ca.top,ca.right,!0,!0));ka.$$mn();)if((ca=ka.$$cu())&&ca.bLa())return L.ULS.sendTraceTag(537162138,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0;return!1};d.prototype.U2c=function(ka,ca,Ia,jb,nb){for(var Na=
ca.pS().FirstRow,sa=ca.pS().LastRow,Wa=Ia.pS().LastRow,Hb=Na,Yb=Ia.pS().FirstRow;Yb<=Wa;Yb++,Hb++){Hb>sa&&(Hb=Na);var Sb=ca.pS();Sb.FirstRow=Sb.LastRow=Hb;var lb=Ia.pS();lb.FirstRow=lb.LastRow=Yb;this.M4g(ka,ea.a.sQ(Sb),ea.a.sQ(lb),jb,nb)}};d.prototype.WYi=function(ka,ca){var Ia=this.$.da.za(266);return void 0!==Ia&&null!==Ia?(Ia.GUg(ka,ca.topLeft,this.Gha.UJf),!0):!1};d.prototype.Yoi=function(ka,ca){var Ia=ka.right-ka.left+1;ka=ka.bottom-ka.top+1;var jb=ca.right-ca.left+1;ca=ca.bottom-ca.top+1;if(jb>
Ia&&ca>ka){if(!(jb%Ia&&ca%ka))return!0}else if(jb===Ia&&ca>ka){if(!(ca%ka))return!0}else if(jb>Ia&&ca===ka&&!(jb%Ia))return!0;return!1};d.prototype.Pih=function(ka){if(fa.EwaSettings.ma(103)){ka=Ab.g(this.$).m1(ka).gridView.getRangeInformation(ka);ka=ik(ka);for(var ca=ka.next();!ca.done;ca=ka.next())if(ca=ca.value,Object(U.a)(ia.DynamicArrayRange,ca)&&!Object(X.a)(ia.DynamicArrayRange,ca).jmc)return!0}return!1};d.prototype.ACe=function(ka,ca,Ia,jb,nb,Na){ca=ik(ca);for(var sa=ca.next();!sa.done;sa=
ca.next())sa=sa.value,Ia&&(this.Q4g(sa,nb),sa.setCell(!0)),jb&&(Na=this.y4h(nb,sa)),Na||(ka.Ea.uV(),Na=!0);return Na};d.prototype.iQh=function(ka,ca,Ia){ca=new da.Range(ca,Ia,ca,Ia,!0,!0);return ka.Ub(ca)};d.prototype.M4g=function(ka,ca,Ia,jb,nb){if(Ia){this.sSa&&Ia.equals(this.sSa.range)||(O.a.Ia(this.sSa),this.sSa=ka.Xj("FormatCellsAction.CopyBetweenRows",Ia));Ia=this.sSa;Ia.$$rst();var Na=!1;if(fa.EwaSettings.getBooleanFeatureGate(Ba.a.xFe,!1)){var sa=ca.pS().FirstColumn+1,Wa=ca.pS().LastColumn+
1;ca=ca.pS().FirstRow+1;for(var Hb=sa;Ia.$$mn();){Hb>Wa&&(Hb=sa);var Yb=this.iQh(ka,ca,Hb);Hb+=1;var Sb=void 0,lb=Ia.$$cu().aF?ka.wKb(Ia.$$cu().range):(Sb=new Q.a,Sb.add(Ia.$$cu()),Sb);Yb&&(Na=this.ACe(ka,lb,jb,nb,Yb,Na));Jb.lastOrDefault(lb)}}else for(sa=ka.Xj("FormatCellsAction.CopyBetweenRows2",ca);Ia.$$mn();)sa.$$mn()||(sa.$$rst(),sa.$$mn()),Wa=sa.$$cu(),ca=void 0,Hb=Ia.$$cu().aF?ka.wKb(Ia.$$cu().range):(ca=new Q.a,ca.add(Ia.$$cu()),ca),Wa&&(Na=this.ACe(ka,Hb,jb,nb,Wa,Na)),Jb.lastOrDefault(Hb)}else L.ULS.sendTraceTag(537162137,
0,50,"FormatCellsAction.CopyBetweenRows: targetRange is null")};d.prototype.u4f=function(){var ka=Ra.a.Xc(1,0,0,651,0,104573951,"PivotTableContextMenuOperationFailure");vb.a(this.$).gj(ka)};d.prototype.Kzi=function(ka,ca){var Ia={ValidMembers:32},jb=ca.NumberFormat;switch(ka){case 1890566896:if(1001===jb||1002===jb||1003===jb){Ia.NumberFormat=14;Ia.NumberFormatOptions={};switch(jb){case 1001:Ia.NumberFormatOptions.TimeType=2;break;case 1002:Ia.NumberFormatOptions.DateType=7;break;case 1003:Ia.NumberFormatOptions.DecimalPlaces=
0}Ia.NumberFormatOptions.NumberFormatCategory=this.HLg(jb)}else Ia.NumberFormat=jb;break;case 1886928607:Ia.NumberFormat=13;break;case -992833457:Ia.NumberFormat=11;break;case 218524921:Ia.NumberFormat=12;break;case 996232352:Ia.NumberFormat=14;Ia.NumberFormatOptions=Object(K.a)(new P.a,{DecimalPlaces:0});Ia.NumberFormatOptions.NumberFormatCategory=6;break;default:return ca}return Ia};d.prototype.formatCells=function(ka,ca,Ia,jb,nb,Na,sa){jb=void 0===jb?null:jb;nb=void 0===nb?null:nb;Na=void 0===
Na?null:Na;sa=void 0===sa?null:sa;var Wa=this.$.Fb.sc("UserAction","FormatCellsInstantaneous, command = "+eb.b().Xh(ka)),Hb=this.$.Fb.Mg("UserAction","FormatCellsInstantaneousFrame");Hb.start();Ka.a(Hb);var Yb=eb.b().Xh(ka),Sb=this.$,lb=Ab.g(Sb),wb=lb.ha.sa,wa=nb||wb.selectedRanges,Oa=ja.g(wa,function(uc){return uc.FG});Yb=Yb+", cellCount="+Oa;Ab.g(this.$).si.L7(1,Wa.id,Yb);wa=Z.r(wa,this.$);wb=wb.activeCell;Yb=-168056295===Ia.command;var Ub=Oa=null;if(Yb){Ub=lb.Ab.Ro(wb);if(!Ub){this.u4f();return}Oa=
Ub.Rca.substring(1,Ub.Rca.length-1);Ub=Ub.abc();if(!Ub){this.u4f();return}Ub=Ub.Caption}lb.ig.HG(!1,!0);var hb=Z.o(wb,Sb),Xb=Sb.oa.va.Pb({D_:!0,SZ:1}),Gc=this.Kzi(Ia.command,ca);Yb||this.Zda(lb,ka,ca,!1,jb,nb);Wa.stop();Ab.g(this.$).si.P0(Wa.id,Db.BasicTelemetryCalculator.KQ);Ia.wdi=La.a.Ta.Jb;jb=this.$.Fb.sc("UserAction","FormatCellsUserAction");this.awi(ka,Ia.taskId,ca,wa,wb,jb.id);eb.b().qA(Wa.id,jb.id,"actions","actions");eb.b().qA(Hb.id,jb.id,"actions","actions");fa.EwaSettings.Zb()?Sb.userOperationManager.Sb(new S(this,
wa,hb,Gc,Yb,Oa,Ub,Xb,jb,Wa.id,64,Na,sa),Ia):Sb.userOperationManager.Sb(new S(this,wa,hb,Gc,Yb,Oa,Ub,Xb,jb,Wa.id,0,Na,sa),Ia)};d.prototype.T2=function(ka,ca,Ia,jb,nb,Na,sa,Wa,Hb,Yb,Sb){var lb=this,wb=this.$;return function(wa,Oa,Ub){wb.py();wa=[wa,lb.LLi];Oa=[Oa];Yb&&wa.push(Yb);Sb&&Oa.push(Sb);return ha.l(wb.oa.va,ka,ca,Ia,jb,nb,Na,!1,Sa.b.apply(Sa,kk(wa)),Sa.a.apply(Sa,kk(Oa)),Ub,Hb,sa,Wa)}};d.prototype.b4f=function(ka,ca,Ia,jb,nb,Na,sa){sa=void 0===sa?null:sa;if(ca&&Ia){var Wa=Ia.Font,Hb=Ia.HorizontalAlignment,
Yb=Ia.VerticalAlignment;Ia.ValidMembers&2||(Hb=ca.horizontalAlignment);Ia.ValidMembers&1||(Yb=ca.verticalAlignment);var Sb=0!==Hb;d.Ifi(ka)&&0===Hb&&(Hb=this.XZe(ca));var lb=!1;switch(ka){case -394785302:this.Lua.Ocb(ca,Hb,Sb,0);break;case 1041132226:this.Lua.Ocb(ca,Hb,Sb,1);break;case -571165336:this.Lua.Ocb(ca,Hb,Sb,2);break;case -1150205178:case -1142465846:case -286432209:this.Lua.Ocb(ca,Hb,Sb,Yb,!1,!1);break;case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:this.SMa&&
this.pqj(ca,Ia,Sb);break;case 1650812936:this.setFillColor(ca,Ia,Na);break;case -287251124:ca.bold=Wa.Bold;break;case -1690267012:Ab.g(this.$).ha.sa.rg&&(Wa=fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1)?sa?sa:Ab.g(this.$).ha.sa.Vc:Ab.g(this.$).ha.sa.Vc,this.Lua.ZKb(ca,Ia,Wa));break;case 1970784898:Ia=Ma.a.Po(ca.color,ca.backgroundColor);if(V.a.compare(Ia,V.a.red)&&(aa.a.l5(ca.text)||aa.a.P6e(ca.text)))break;Wa=V.a.WG(Wa.FontColor);ca.color=
yb.e(Ma.a.UF(Wa));break;case -1925065947:ca.italic=Wa.Italic;break;case -1293291468:Ia=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");this.Am?(ca.rLb(Wa.FontName,Ia,"ShowInstantaneousFormattingOnCell"),ca.d_f(Wa.FontScheme)):ca.rLb(Wa.FontName,Ia,"ShowInstantaneousFormattingOnCell");break;case 862890474:case 963349338:ca.fontSize=Wa.FontSize;this.$.hf();break;case -1077965542:ca.fontSize=Wa.FontSize;break;case 1764140053:ca.underline=Wa.Underline;break;case -1685033574:ca.doubleUnderline=
Wa.DoubleUnderline;break;case -1590502662:ca.fontStrikethrough=Wa.Strikethrough;break;case -848953656:case 2045211913:lb=ca.uqb();break;case 2105621672:Wa=Object(X.a)(ub.a,nb);if(!Wa)break;Ia=V.a.qFh(Wa.color);ca.color=yb.e(Ma.a.UF(Ia));this.Hre(ca,Wa.Amc);break;case -1409276245:this.Hre(ca,Ia.NumberFormatOptions.CustomFormatString);break;case 1890566896:this.SLg(ca,Ia);break;case -1228228458:ca.uqb();ca.clearFormat();this.KWc(ca,0);lb=!0;break;case -730106152:ca.clearFormat();this.KWc(ca,0);break;
case 932244020:this.oqj(ca,Ia,Na);break;case -1942512156:case -1920201820:this.msj(ca,Ia)}jb||(lb?ca.qIb(!0):ca.setCell(!0))}else L.ULS.shipAssertTag(537162135,0,!ca,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellToFormat"),L.ULS.shipAssertTag(537162134,0,!Ia,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellFormat")};d.prototype.Q4g=function(ka,ca){ka&&ca?(ka.Dqb(ca),ka.T0c(ca),this.KWc(ka,ca.cell.Zk)):L.ULS.sendTraceTag(537162133,0,10,"FormatCellsAction.CopyFormattingBetweenCells:cellToFormat & sourceCell should not be null")};
d.prototype.KWc=function(ka,ca){if(0>ca)this.kca({caller:"ApplyNumberFormatIndexOnCell",cell:ka,kind:"failure",reason:"ApplyNumberFormatIndexOnCell: negative format index was supplied"});else{var Ia=this.f3a(ka.Rw,ca,ka.cell.lBa,ka.cell.Z$);Object(Ha.b)(Ia)?this.kca({caller:"ApplyNumberFormatIndexOnCell",cell:ka,kind:"failure",reason:Ia.reason}):(this.tZa(ka,Ia.value),this.kca({caller:"ApplyNumberFormatIndexOnCell",cell:ka,kind:"success",ez:Ia.value,format:ca}))}};d.prototype.Hre=function(ka,ca){if(void 0===
ca||null===ca)this.kca({caller:"ApplyNumberFormatStringOnCell",cell:ka,kind:"failure",reason:"ApplyNumberFormatStringOnCell: no format string was supplied"});else{var Ia=this.f3a(ka.Rw,ca,ka.cell.lBa,ka.cell.Z$);Object(Ha.b)(Ia)?this.kca({caller:"ApplyNumberFormatStringOnCell",cell:ka,kind:"failure",reason:Ia.reason}):(this.tZa(ka,Ia.value),this.kca({caller:"ApplyNumberFormatStringOnCell",cell:ka,kind:"success",ez:Ia.value,format:ca}))}};d.prototype.SLg=function(ka,ca){if(ca=void 0===ca?null:ca)if(ca=
this.tXh(ka,ca),ca.success){var Ia=this.f3a(ka.Rw,ca.wmc,ka.cell.lBa,ka.cell.Z$);Object(Ha.b)(Ia)?this.kca({caller:"ApplyNumberFormatCategoryOnCell",cell:ka,kind:"failure",reason:Ia.reason,format:ca.wmc}):(this.tZa(ka,Ia.value),this.kca({caller:"ApplyNumberFormatCategoryOnCell",cell:ka,kind:"success",ez:Ia.value,format:ca.wmc}))}else this.kca({caller:"ApplyNumberFormatCategoryOnCell",cell:ka,kind:"failure",reason:ca.reason,format:ca.wmc});else this.kca({caller:"ApplyNumberFormatCategoryOnCell",cell:ka,
kind:"failure",reason:"ApplyNumberFormatCategoryOnCell: no format was supplied"})};d.prototype.HLg=function(ka){switch(ka){case 1004:return 1;case 5:return-1;case 1002:return 4;case 6:case 1001:return 5;case 7:case 1003:return 6;case 8:return 7;case 9:return 8;case 10:return 9}return 10<ka?-1:ka};d.prototype.tXh=function(ka,ca){if(!this.jz||!this.localeInfo||!ca)return ka=this.jz?this.localeInfo?"cellFormat is null":"localeInfo is null":"instantaneousManager is null",new n(!1,void 0,"GetRibbonNumberFormat: "+
ka);ca=ca.NumberFormat;switch(ca){case 0:ka=N.PFh;break;case 1:ka=N.RFh;break;case 2:ka=N.NFh;break;case 3:ka=N.LFh;break;case 4:ka=N.UFh;break;case 5:ka=N.QFh;break;case 6:ka=N.WFh;break;case 7:ka=N.SFh;break;case 8:ka=N.OFh;break;case 9:ka=N.TFh;break;case 10:ka=N.VFh;break;case 11:case 12:return this.jz.NUe(),this.ANh(ka,ca);case 13:ka=N.DTg;break;case 1006:ka=N.buttonPercentage;break;case 1004:ka=N.keyboardNumber;break;case 1005:ka=N.keyboardCurrency;break;case 1002:ka=N.keyboardDate;break;case 1001:ka=
N.keyboardTime;break;case 1003:ka=N.keyboardPercentage;break;case 14:return ka="GetRibbonNumberFormat: should not be called with NumberFormatDialog!",L.ULS.shipAssertTag(537162132,0,!1,ka),new n(!1,void 0,ka);default:return ka="GetRibbonNumberFormat: unknown NumberFormatType!",L.ULS.shipAssertTag(537162131,0,!1,ka),new n(!1,void 0,ka)}return ka?(ka=excelOnlineCalc.numfmt.getRibbonFormat(this.localeInfo,ka))?new n(!0,ka):new n(!1,void 0,"GetRibbonNumberFormat: ExcelOnlineCalcService.NumberFormatter.GetRibbonNumberFormat unable to get ribbon format..."):
new n(!1,void 0,"GetRibbonNumberFormat: unsupported ribbonFormatKind...")};d.prototype.ANh=function(ka,ca){if(!this.calcManager||!this.QC)return ca=this.calcManager?"numberFormatter is null":"calcManager is null",new n(!1,void 0,"GetDecimalChangeNumberFormat: "+ca);ka=this.calcManager.Ybc(ka.cell.Zk);if(!Object(Ha.c)(ka))return new n(!1,void 0,"getDecimalChangeNumberFormat: "+ka.reason);ca=this.QC.changeFormatDecimals(ka.value,11===ca?1:-1);return excelOnlineCalc.util.isSuccess(ca)?void 0===ca.value||
null===ca.value?new n(!1,void 0,"GetDecimalChangeNumberFormat: successUndefined result"):new n(!0,ca.value):new n(!1,void 0,"GetDecimalChangeNumberFormat: NumberFormatter.ChangeFormatDecimals failure")};d.prototype.kca=function(ka){var ca=ka.caller,Ia=ka.cell,jb=ka.format;jb=null==jb?"null":"number"===typeof jb?jb:"string"===typeof jb?aa.a.nZa(jb):aa.a.nZa(jb.formatString);var nb=aa.a.nZa(Ia.Rw.value)||"null",Na="success"===ka.kind?aa.a.nZa(ka.ez.text):"null";L.ULS.sendTraceTag(537162130,0,50,"FormatCellsAction.LogNumberFormatEdit: "+
{caller:ca,"range.top":Ia.range.top,"range.left":Ia.range.left,result:ka.kind,reason:"success"===ka.kind?"":ka.reason,value:nb,valueType:Ia.Rw.type,ifmt:jb,prediction:Na})};d.prototype.TLg=function(ka,ca,Ia,jb,nb,Na,sa,Wa,Hb,Yb,Sb){Wa=void 0===Wa?!1:Wa;Hb=void 0===Hb?!1:Hb;var lb=ca.cell;lb.iM=void 0===Yb?0:Yb;Yb=ca.text;Yb!==Ia&&(lb.text=Ia);lb.s9a=void 0===Sb?null:Sb;Wb.f(Yb)?ca.formulaBarText=Yb:ca.formulaBarText="";ka=Ab.g(ka).Ab.kgf(ca.range);this.k2b(ca,jb,null,Wa,Hb,ka);nb&&(ca.color=yb.e(Ma.a.UF(nb)));
ca.cell.Zk=Na;ca.cell.lpc=sa;ca.cell.ITd=Na};d.prototype.awi=function(ka,ca,Ia,jb,nb,Na){var sa={};sa.a=this.$.ya.UserSessionId;sa.b=ca;sa.c=jb.Ranges.length;sa.d=this.S8g(jb.Ranges);sa.e=nb.toString();sa.f=ka;sa.h=Na;1890566896===ka?sa.g=Ia.NumberFormat.toString():2105621672===ka&&(sa.g=Ia.NumberFormatOptions.NumberFormatCategory.toString());eb.b().Ce(3,sa,!0)};d.prototype.S8g=function(ka){for(var ca=0,Ia=0,jb=0,nb=0;nb<ka.length;nb++){var Na=Z.B(ka[nb]).FG;ca+=Na;Na>jb&&(jb=Na,Ia=nb)}ka=Z.B(ka[Ia]).toString();
return"TotalCellCount:"+ca+"; Max range:"+ka+"; MaxRangeSize:"+jb+";"};d.prototype.oqj=function(ka,ca,Ia){64===(ca.ValidMembers&64)&&this.setFillColor(ka,ca,Ia);16===(ca.ValidMembers&16)&&d.Rrj(ka,ca);128===(ca.ValidMembers&128)&&this.Lua.ZKb(ka,ca,ka.range);if(2===(ca.ValidMembers&2)||1===(ca.ValidMembers&1)){Ia=ca.VerticalAlignment;ca=ca.HorizontalAlignment;var jb=0!==ca;fa.EwaSettings.isChangeGateEnabled("OfficeVSO:3603507_calculateHorizontalAlignmentOnToggle")&&!jb&&this.XZe(ka);this.Lua.Ocb(ka,
ca,jb,Ia)}};d.prototype.setFillColor=function(ka,ca,Ia){(fa.EwaSettings.isChangeGateEnabled("OfficeVSO:3634588_NoFillColorOnConditionalFormattingCell")?ka.jba:ka.jba&&ka.exb&&!ka.hxb&&!ka.mxb)||(ca=-1===ca.FillColor?Ia?Ma.a.UF(V.a.white):null:Ma.a.UF(V.a.WG(ca.FillColor)),ka.backgroundColor=ca?yb.e(ca):null)};d.prototype.msj=function(ka,ca){0!==ka.horizontalAlignment&&2!==ka.horizontalAlignment||ka.I0(1,!1);0<=ka.indentation+ca.IndentationIncrease&&(ka.indentation+=ca.IndentationIncrease)};d.prototype.pqj=
function(ka,ca,Ia){var jb=ka.mS,nb=ca.TextOrientation;nb!==oa.a.verticalText&&(0>nb||180<nb)&&L.ULS.shipAssertTag(523090050,0,!1,"FormatCellsAction.setCellTextOrientation: invalid value for text orientation in server "+nb);jb===nb||jb===oa.a.vuc&&nb===oa.a.wuc||jb===oa.a.xuc&&nb===oa.a.yuc?ca.TextOrientation=0:(ka.mS=ca.TextOrientation,Ia||ka.I0(0<=ka.mS?1:3,!1))};d.prototype.XZe=function(ka){ka=this.f3a(ka.Rw,ka.cell.Zk,ka.cell.lBa,ka.cell.Z$);return Object(Ha.b)(ka)?0:null!=ka.value.horizontalAlignment?
ka.value.horizontalAlignment:0};d.prototype.xtj=function(ka,ca,Ia){this.ox||(this.ox=new Aa.a(Ab.g(this.$).Ea,this.$));this.ox.ZKb(ka,ca,Ia)};d.prototype.y4h=function(ka,ca){var Ia=new oc.a;if(ka.cell.formulaBarText&&ka.cell.formulaBarText.startsWith("'"))Ia.Text=ka.cell.formulaBarText;else{var jb=ka.cellValue;jb&&4!==ka.cell.iM||(jb=ka.text);Ia.Text=jb}this.QAa(ca,Ia,!1,void 0,Za.a.$gc(this.$));return!0};d.prototype.pRd=function(ka,ca){return this.tb&&!!ka&&!!ca};d.N1g=function(ka,ca,Ia,jb){jb&&
ca.setCell(!0);0===Ia&&ka.Ea.uV()};d.expandRange=function(ka,ca){ca=ca.clone();ca.height<ka.height&&(ca.bottom=ca.top+ka.height-1);ca.width<ka.width&&(ca.right=ca.left+ka.width-1);return ca};d.Ifi=function(ka){switch(ka){case -1142465846:case -1150205178:case -286432209:case -571165336:case 1041132226:case -394785302:return!0;default:return!1}};d.Rrj=function(ka,ca){ca=ca.Font;var Ia=0!==(ca.ValidMembers&16),jb=0!==(ca.ValidMembers&16),nb=0!==(ca.ValidMembers&16);ka.bold=0!==(ca.ValidMembers&4);ka.italic=
0!==(ca.ValidMembers&8);Ia&&(ka.underline=Ia);jb&&(ka.doubleUnderline=jb);nb&&(ka.fontStrikethrough=nb);Ia=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");ka.rLb(ca.FontName,Ia,"SetFont");ka.fontSize=ca.FontSize;Ia=Ma.a.Po(ka.color,ka.backgroundColor);V.a.compare(Ia,V.a.red)&&(aa.a.l5(ka.text)||aa.a.P6e(ka.text))||(ca=V.a.WG(ca.FontColor),ka.color=yb.e(Ma.a.UF(ca)))};of.Object.defineProperties(d.prototype,{Lua:{configurable:!0,enumerable:!0,get:function(){return this.kEh}},
QC:{configurable:!0,enumerable:!0,get:function(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.QC}},localeInfo:{configurable:!0,enumerable:!0,get:function(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.localeInfo}}});d.BCh=36;Object(t.a)(d,"FormatCellsAction",null,[685,6]);var la=I.a;$k(c,la);c.prototype.create=function(){this.pb(new d(this.$))};c.ka=function(ka){ka.da.Ga(18,new c(ka))};Object(t.a)(c,"FormatCellsActionFactory",I.a,
[]);b.d(E,"a",function(){return a})},1373:function(t,E,b){function a(){z.a.Fa(c.ka)}function c(ka){var ca=la.call(this)||this;ca.$=ka;ca.Eb();return ca}function d(){}function e(ka,ca,Ia,jb,nb){Ia=void 0===Ia?null:Ia;jb=void 0===jb?null:jb;nb=void 0===nb?0:nb;ka=k.call(this,ka,ca)||this;ka.HNa=null;ka.Mec=Ia||$a.a.current.So(103);ka.Clf=nb;ka.W4c=jb;ka.OCg();return ka}function h(ka,ca,Ia,jb){ka=k.call(this,ka,ca)||this;ka.qCb=null;ka.Aog=Ia;ka.l7h=jb;ka.PCg();return ka}function k(ka,ca){var Ia=Jb.call(this,
ka)||this;Ia.rCb=null;Ia.thh=function(){Ia.display()};Ia.c$h=Math.max(1,ca);return Ia}function n(ka,ca,Ia,jb,nb,Na,sa,Wa){Wa=void 0===Wa?"":Wa;var Hb=oc.call(this)||this;Hb.lwa=null;Hb.X8e=!1;Hb.Klc=null;Hb.Jlc=null;Hb.buttons={};Hb.AMe={};Hb.$=ka;Hb.svgIconProvider=ca;Hb.UIi=Ia;Hb.Lkd=jb;Hb.Kkd=nb;Hb.altText=Na;Hb.MGb=sa;Hb.buttonText=Wa;return Hb}function f(ka,ca,Ia,jb,nb,Na,sa,Wa){function Hb(Sb){Ab.g(Sb)}var Yb=Ka.call(this,document.createElement("div"))||this;Yb.Qjf=null;Yb.QSd=!1;Yb.pSa=null;
Yb.DNb=null;Yb.yN=function(){Yb.raiseEvent("OnObjectButtonMouseOver")};Yb.xN=function(){Yb.raiseEvent("OnObjectButtonMouseOut")};Yb.oDj=function(){Yb.kke()};Yb.Zc=function(Sb){Yb.raiseEvent(Yb.MGb,Sb);Yb.KGb();return!0};Yb.AKi=function(Sb){100<I.a(G.a.Ta,Yb.Qjf)&&Yb.jid(new Sys.UI.Point(Math.round(Sb.clientX),Math.round(Sb.clientY)))};Yb.tN=function(Sb){Ab.g(Sb.Ca,!1);return!1};Yb.dZ=Yb.je.OHa();Yb.set_visible(!1);Yb.wic=nb;Yb.MGb=Na;Yb.lmc=ka;Yb.Z2b=ca;Yb.wic&&(Yb.pSa=S.a.instance.create(Yb.oDj,
3E4,"OnObjectButton.ShyTimerFired",!1,!1));ka&&Yb.domElement.classList.add(ka);Yb.o_a=document.createElement("div");Yb.domElement.appendChild(Yb.o_a);Ia&&Yb.o_a.classList.add(Ia);jb&&(Yb.o_a.innerHTML=jb);sa&&(Yb.DNb=document.createElement("div"),Yb.domElement.appendChild(Yb.DNb),Yb.DNb.classList.add(Wa),Yb.DNb.innerText=sa,Yb.domElement.style.padding="3px",cb.a.instance.ra(Q.a.pointerDown,Yb.domElement,Yb.tN));Yb.f_a=new Db.a(Yb.domElement,7);Sa.a.instance.ra(Q.a.click,Yb.domElement,Yb.Zc);w.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&
cb.a.instance.ra(Q.a.pointerDown,Yb.domElement,Yb.tN);Yb.zc.ka("mouseup",Hb);Yb.zc.ka("click",Hb);Yb.zc.ka("dblclick",Hb);return Yb}function v(){}function m(ka,ca,Ia,jb){var nb=x.call(this,ka,ca)||this;nb.Y1a=null;nb.lxf=function(){nb.Rsc(nb.lxf);if(nb.Hk&&nb.Hk.length&&nb.contextMenuManager){var Na=nb.contextMenuManager.vdd("autoFilterRichFieldList"),sa=window.document.getElementById(nb.Y1a);Na.M0(null,sa,nb,null,!0)}};nb.cmg=Ia;nb.contextMenuManager=jb;return nb}function x(ka,ca){var Ia=Ea.call(this)||
this;Ia.bP=null;Ia.Dvb=null;Ia.bed=null;Ia.CJb=null;Ia.DUb=!1;Ia.w4d=null;Ia.iGd=!1;Ia.qMi=function(jb,nb,Na){D.ULS.sendTraceTag(25264350,0,10,"Call to GetRichValueFieldListContextList failed in: "+Na);Ia.CJb&&Ia.CJb.stop();Ia.bP=null;Ia.raiseEvent(va.k)};Ia.rMi=function(jb){ja.a(jb)||(Ia.CJb&&Ia.CJb.stop(),Ia.DUb=!1,Ia.bP=jb.Result,Ia.bP&&0<Ia.bP.length&&D.ULS.sendTraceTag(25264351,0,50,"Retrieved "+Ia.bP.length+" rich value field list context for autocomplete"),Ia.lWa=!0,Ia.lrc())};Ia.lWa=!1;Ia.ib=
ka;Ia.oTb=-1;Ia.tableManager=ca;Ia.iGd=w.EwaSettings.isChangeGateEnabled("OfficeVSO:6395797_raiseFieldInfoLoadedEventOnEmptyResults")&&ma.a.f_(ka);return Ia}function l(ka){var ca=ha.call(this)||this;ca.firstElement=null;ca.mw=null;ca.nMa=!1;ca.us=null;ca.lxj=L.a.Pf;ca.ozf=function(Ia){var jb=Ia.Ca.keyCode;return jb===O.a.Qh?ca.UKi():jb===O.a.Sz&&Ia.Ca.shiftKey?ca.Eyh(ca.firstElement):!1};ca.OEf=function(Ia){if(!ca.nMa||Ia.Ca.keyCode!==O.a.pL)return!1;l.q8e();Z.Task.delay(1).Jo(function(){ca.mw.focus();
return!0},0,ca.la);return!0};ca.zVi=function(){document.activeElement&&document.activeElement.id===ca.mw.id||(l.q8e(),Z.Task.delay(1).Jo(function(){ca.mw.focus();return!0},0,ca.la))};ca.rxf=function(){ca.cag(ca.mw)};ca.nzf=function(Ia){Ia.stopPropagation();Ia.preventDefault();ca.nMa&&(ca.nMa=!1)};ca.$=ka;(ka=ca.$.ea.ic)&&D.ULS.sendTraceTag(39350791,0,50,"EmbedViewFocusControl: PermissionSet = "+ka.Vsa+"; InWebPart = '"+(ka.inWebPart?"Classic":"Non Classic")+"', InEmbedView = '"+(ka.inEmbedView?"True (+Modern)":
"False (not Modern)")+"'");ka&&(ka.inWebPart||ka.inEmbedView)?D.ULS.sendTraceTag(537153856,0,15,"EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '"+(ka.inWebPart?"Classic":"Non Classic")+"', InEmbedView = '"+(ka.inEmbedView?"True (+Modern)":"False (not Modern)")+"'"):(ca.J7g(),ca.I8g(),B.KeyInputManager.instance.ra(Q.a.Lb,ca.$.domElement,ca.OEf));ca.$.da.Ga(238,ca);return ca}function u(ka,ca,Ia,jb,nb){nb=void 0===
nb?null:nb;var Na=K.call(this)||this;Na.$nb=null;Na.YOa=null;Na.gZc=0;Na.dpc=null;Na.eSi=function(){var sa=Na.YOa.QYe();D.ULS.sendTraceTag(537153861,0,50,"ActionAggregator<"+Na.ola+">.OnRunningLong: Operation running for more than "+sa+"ms");Na.dpc=S.a.instance.create(Na.D6,Math.max(Na.rve-sa,0),N.a.Zje)};Na.D6=function(){D.ULS.sendTraceTag(537153860,0,50,"ActionAggregator<"+Na.ola+">.OnTimeout: Operation running for more than "+Na.YOa.QYe()+"ms, timing out. Has pending actions: "+Na.V5a);Na.gZc++;
Na.gZc>Na.qve&&D.ULS.sendTraceTag(537153859,0,50,"ActionAggregator<"+Na.ola+">.OnTimeout: passed the allowed bypassed count");Na.YOa.qx.cancel();Na.FTe()};Na.K9a=function(){Na.V5a&&D.ULS.sendTraceTag(537153858,0,50,"ActionAggregator<"+Na.ola+">.OnDocumentUnhidden: Start. IsActionOngoing: "+Na.OLa+", AggregatedActionParams not null: "+Na.V5a);Na.gmd()};Na.AAg=ka;Na.BAg=ca;Na.documentVisibilityObserver=Ia;Na.ola=jb;Na.vO=nb;Ia&&Na.documentVisibilityObserver.LZb(Na.K9a);Na.fZc=!!Ia&&w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperation",
!1);Na.qve=w.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLimit",3);ca=w.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationThresholdInMs",5E3);Na.rve=ka.Dcd(ca);ka=w.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLogThresholdInMs",1E3);Na.PTg=Math.max(Na.rve-ca,0)+ka;return Na}function A(){this.startTime=G.a.Ta.Jb;this.qx=new T.a}var z=b(10);t=b(0);var y=b(235),w=b(1),D=b(15),
H=b(205),F=b(79),J=b(37),S=b(47),N=b(45),T=b(747),G=b(28),I=b(119);A.prototype.QYe=function(){return I.a(G.a.Ta,this.startTime)};Object(t.a)(A,"OngoingAction",null,[]);var K=F.a;$k(u,K);u.prototype.PGf=function(ka){D.ULS.sendTraceTag(537153864,0,50,"ActionAggregator<"+this.ola+">.PerformThrottledAction: Start. IsActionOngoing: "+this.OLa+", AggregatedActionParams not null: "+this.V5a);this.$nb=this.BAg.eWc(ka,this.$nb);this.gmd()};u.prototype.dispose=function(){this.documentVisibilityObserver&&this.documentVisibilityObserver.KIb(this.K9a);
this.Wwe();K.prototype.dispose.call(this)};u.prototype.R_f=function(ka){this.fZc?(this.YOa=ka?new A:null,ka?this.startTimer():this.Wwe()):this.YOa=ka?{}:null};u.prototype.FTe=function(ka){ka=void 0===ka?null:ka;this.fZc&&ka&&ka.aK?D.ULS.sendTraceTag(537153863,0,50,"ActionAggregator<"+this.ola+">.FinishedCallback: timedout, skipping"):(D.ULS.sendTraceTag(537153862,0,50,"ActionAggregator<"+this.ola+">.FinishedCallback: Start. IsActionOngoing: "+this.OLa+", AggregatedActionParams not null: "+this.V5a),
this.R_f(!1),this.gmd())};u.prototype.gmd=function(){var ka=this;if(!this.iMb()){var ca=this.$nb;this.$nb=null;this.R_f(!0);D.ULS.sendTraceTag(537153857,0,50,"ActionAggregator<"+this.ola+">.InternalPerformAction: Calling PerformAction.");var Ia=this.fZc?this.YOa.qx.token:H.a.none;J.TaskExtensions.Aa(this.AAg.uDd(ca),function(){ka.FTe(Ia)},Ia,0,this.vO)}};u.prototype.iMb=function(){return!this.V5a||this.OLa?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.Mi?(D.ULS.sendTraceTag(593376846,
0,50,"ActionAggregator<"+this.ola+">.ShouldThrottle: Not Calling PerformAction as document is hidden."),!0):!1};u.prototype.Wwe=function(){this.dpc&&this.dpc.cancel()};u.prototype.startTimer=function(){this.gZc<=this.qve&&(this.dpc=S.a.instance.create(this.eSi,this.PTg,N.a.Zje))};of.Object.defineProperties(u.prototype,{OLa:{configurable:!0,enumerable:!0,get:function(){return!!this.YOa}},V5a:{configurable:!0,enumerable:!0,get:function(){return!!this.$nb}}});Object(t.a)(u,"ActionAggregator",F.a,[995,
6]);var L=b(27),O=b(86),B=b(109),Q=b(13),U=b(44),X=b(38),P=b(19),ea=b(5),ia=b(129),da=b(14),xa=b(21),Z=b(58),ha=X.a;$k(l,ha);l.prototype.LGg=function(ka){this.addHandler("KBIS",ka)};l.prototype.bdj=function(ka){this.removeHandler("KBIS",ka)};l.prototype.dispose=function(){this.firstElement&&U.a.removeHandler(this.firstElement,Q.a.focus,this.rxf);this.us&&this.us.detach("focus");this.mw&&(U.a.removeHandler(this.mw,Q.a.focus,this.nzf),U.a.removeHandler(this.mw,Q.a.blur,l.onBlur),B.KeyInputManager.instance.Ba(Q.a.Lb,
this.mw,this.ozf));B.KeyInputManager.instance.Ba(Q.a.Lb,this.$.domElement,this.OEf);this.us=this.mw=this.firstElement=this.$=null;ha.prototype.dispose.call(this)};l.prototype.J7g=function(){this.lxj?(this.firstElement=document.documentElement,this.us=ia.a.instance.KG(document.parentWindow),this.us.ka("focus",this.zVi)):(this.firstElement=l.JDe(),document.body.insertBefore(this.firstElement,document.body.childNodes[0]),U.a.addHandler(this.firstElement,Q.a.focus,this.rxf))};l.prototype.I8g=function(){this.mw=
l.JDe();this.mw.id=ea.a.PKe;this.mw.setAttribute(ea.a.Ft,da.a.instance.ga(861));document.body.appendChild(this.mw);U.a.addHandler(this.mw,Q.a.focus,this.nzf);U.a.addHandler(this.mw,Q.a.blur,l.onBlur);B.KeyInputManager.instance.ra(Q.a.Lb,this.mw,this.ozf)};l.prototype.Eyh=function(ka){this.cag(ka);return!1};l.prototype.UKi=function(){this.nMa=!0;xa.g(this.$).focus();xa.g(this.$).ha.z5e();this.raiseEvent("KBIS");return!0};l.prototype.cag=function(ka){this.nMa?this.nMa=!1:(this.nMa=!0,ka&&ka.focus())};
l.JDe=function(){var ka=document.createElement("div");ka.tabIndex=0;return ka};l.q8e=function(){document.body.classList.add(P.a.rNe)};l.onBlur=function(){document.body.classList.remove(P.a.rNe)};Object(t.a)(l,"EmbedViewFocusControl",X.a,[994,6]);var ya=b(4),va=b(1296),bb=b(60),ba=b(578),fa=b(24),ra=b(41),pa=b(394),Za=b(177),Ua=b(259),Ma=b(121),oa=b(31),ja=b(299),ta=b(298),aa=b(62),ma=b(36),Ea=X.a;$k(x,Ea);x.prototype.NZb=function(ka){this.addHandler(va.a,ka)};x.prototype.Rsc=function(ka){this.removeHandler(va.a,
ka)};x.prototype.lGg=function(ka){this.addHandler(va.k,ka)};x.prototype.Kcj=function(ka){this.removeHandler(va.k,ka)};x.prototype.dispose=function(){this.ib=null;this.Ubb();Ea.prototype.dispose.call(this)};x.prototype.l_i=function(){var ka=Array(9);var ca={};ca.Name=va.e;ka[0]=ca;ca={};ca.Name=va.h;ka[1]=ca;ca={};ca.Name=va.f;ka[2]=ca;ca={};ca.Name=va.i;ka[3]=ca;ca={};ca.Name=va.j;ka[4]=ca;ca={};ca.Name=va.g;ka[5]=ca;ca={};ca.Name=va.c;ka[6]=ca;ca={};ca.Name=va.d;ka[7]=ca;ca={};ca.Name=va.b;ka[8]=
ca;ca={ColumnName:"",ColumnIndex:-1};ca.FieldInfoDataList=ka;ka=[];ka[0]=ca;this.HOd(ka)};x.prototype.xZ=function(ka,ca,Ia,jb){jb=void 0===jb?null:jb;if(ka){this.YZc();this.$1b();var nb=null,Na=!1,sa;if(sa=!jb)sa=this.LOj(ka,ca,Ia),Na=sa.M$a,nb=sa.Hk,sa=sa.returnValue;if(sa)if(this.iGd||this.HOd(nb),this.DUb=!0,this.bP=nb,this.iGd){if(!Na){this.lWa=!0;this.lrc();return}}else if(this.bP&&0<this.bP.length&&(this.lWa=!0,this.lrc()),!Na)return;this.Ndg(ka,jb,ca,Ia,!1)}};x.prototype.Ndg=function(ka,ca,
Ia,jb,nb){if(this.$.ea.dc){this.$.Fb&&(this.CJb=this.$.Fb.sc("WebServiceCall","GetRichValueFieldInfoListContext"));this.Dvb=null;var Na=this.$.oa.va.Pb(),sa=this.$.oa.va,Wa=this.rMi,Hb=this.qMi,Yb=sa.Na(1,null);Yb.selectedRange=ka;Yb.richValueKeyPath=ca;Yb.singleColumn=Ia;Yb.searchForRange=jb;Yb.calculateMajorityDataType=nb;this.Dvb=aa.g(sa,"GetRichValueFieldListContextList",Yb,Wa,Hb,null,Na,4)}else this.bP=null};x.prototype.Ubb=function(){this.bP=null;this.lWa=!1;this.YZc();this.$1b();this.Dvb=null;
this.oTb=-1};x.prototype.YZc=function(){x.bqb(this.Dvb)};x.prototype.$1b=function(){x.bqb(this.bed)};x.prototype.lrc=function(){this.raiseEvent(va.a)};x.prototype.Wm=function(ka){ka=ra.D(ka);--ka.left;--ka.right;return this.tableManager.Wm(ka)};x.prototype.fKa=function(ka){var ca=this;ka.FirstColumn=ka.FirstColumn;ka.LastColumn=ka.LastColumn;ka.FirstRow=ka.FirstRow;ka.LastRow=ka.LastRow;this.$1b();this.bed=null;return pa.a(this.$.userOperationManager,function(Ia,jb,nb){return Ua.h(ca.$.oa.va,ka,ta.b(Ia,
function(Na){ca.BMi(Na)}),ta.a(jb,jb,function(Na){ca.AMi(Na)}),nb,null)},function(Ia){return new Za.a(264,0,Ia,80)},null)};x.prototype.AMi=function(ka){ka=Ma.a.xf(ka.data);D.ULS.sendTraceTag(525336847,0,10,"FieldInfoManager.OnGetFullTableRangeFailure - Webservice call failed with Errors: "+oa.a.Cc(ka))};x.prototype.BMi=function(ka){if(ja.a(ka))-315732528!==ka.Errors[0].MessageId&&D.ULS.sendTraceTag(525336846,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call failed with Unexpected error : "+
oa.a.Cc(ka.Errors));else if(ka&&ka.Result){ka=ka.Result;var ca=ka.HasHeaderRow;ca=new ba.AutofilterRange(ka.TableRange.FirstRow+(ca?1:0)+1,ka.TableRange.FirstColumn+1,ka.TableRange.LastRow+1,ka.TableRange.LastColumn+1,null,null,null,0,ca);this.oTb=ka.TableRange.FirstColumn;(ka=this.WJf(!1,!0,ca))||D.ULS.sendTraceTag(525336844,0,50,"FieldInfoManager.OnGetFullTableRangeSuccess - fieldInfoListContextList is null");this.HOd(ka)}else D.ULS.sendTraceTag(525336845,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call returned no result")};
x.prototype.LOj=function(ka,ca,Ia){var jb=null;var nb=!1;if(ka.SheetName!==this.$.ea.pa.sheetName)return{returnValue:!1,M$a:nb,fKa:!1,Hk:jb};this.oTb=-1;if(Ia){var Na=this.Wm(ka);if(!Na||!Na.lba)return{returnValue:!1,M$a:nb,fKa:!1,Hk:jb};var sa=xa.g(this.$).Ab.S1e(Na);this.w4d=Na;if(w.EwaSettings.isChangeGateEnabled("OfficeVSO:5167298_ObtainFullRangeOfTableForPopulatingInsertDataDropdownCorrectly")&&sa&&0<sa.count)return--ka.FirstColumn,--ka.LastColumn,this.bed=this.fKa(ka),{returnValue:!0,M$a:nb,
fKa:!0,Hk:jb};Na.top+=1;Na.right=ra.D(ka).right-1}else Na=new ba.AutofilterRange(ka.FirstRow+1,ka.FirstColumn+1,ka.LastRow+1,ka.LastColumn+1,null,null,null,0,!1);if(Na.top>Na.bottom||Na.left>Na.right)return{returnValue:!0,M$a:nb,fKa:!1,Hk:jb};ka=xa.g(this.$);var Wa=ka.eb.width,Hb=ka.eb.height;sa=ka.view.visibleArea;Wa=new bb.a(sa.x-Wa,sa.y-Hb,sa.width+Wa,sa.height+Hb);Hb=ka.gg(Na);if(!sa||!Hb||!ka.Zhc(Na))return{returnValue:!1,M$a:nb,fKa:!1,Hk:jb};Wa.contains(Hb)||(nb=!0);jb=this.WJf(ca,Ia,Na);return{returnValue:!0,
M$a:nb,fKa:!1,Hk:jb}};x.prototype.HOd=function(ka){ka&&D.ULS.sendTraceTag(25264348,0,50,"Retrieved "+ka.length+" rich value field contexts from block cache");this.DUb=!0;(this.bP=ka)&&0<this.bP.length&&(this.lWa=!0,this.lrc())};x.prototype.WJf=function(ka,ca,Ia){var jb=null;var nb=Ia.clone();if(ca){ca=Ia.right;for(var Na=0;ca>=Ia.left;--ca){nb.left=ca;nb.right=ca;var sa=this.dZe(nb,!0,Ia.left);if(sa){jb||(jb=[]);jb[Na]=sa;if(ka)break;++Na}}}else if(ka=this.dZe(nb,!1))jb=[],jb[0]=ka;return jb};x.prototype.dZe=
function(ka,ca,Ia){Ia=void 0===Ia?0:Ia;var jb=null;if(w.EwaSettings.isChangeGateEnabled("OfficeVSO:5723259_StoreRichValueFieldsInDictionary")){var nb=xa.g(this.$).Ab.wXh(ka);if(nb&&0<nb.count){var Na=Array(nb.count),sa=0;nb=ik(nb.values);for(jb=nb.next();!jb.done;jb=nb.next()){var Wa={};Wa.Name=jb.value;Na[sa]=Wa;++sa}sa="";nb=-1;0<ka.top&&ca&&(ka=new fa.Range(ka.top-1,ka.left,ka.top-1,ka.left,!1,!1),null!=xa.g(this.$).Ub(ka)&&null!=xa.g(this.$).Ub(ka).originalText&&(sa=xa.g(this.$).Ub(ka).originalText),
nb=ka.left-Ia);jb={};jb.ColumnName=sa;jb.ColumnIndex=nb;jb.FieldInfoDataList=Na}}else if((nb=xa.g(this.$).Ab.S1e(ka))&&0<nb.count){Na=Array(nb.count);sa=0;nb=ik(nb);for(jb=nb.next();!jb.done;jb=nb.next())Wa={},Wa.Name=jb.value,Na[sa]=Wa,++sa;sa="";nb=-1;0<ka.top&&ca&&(ka=new fa.Range(ka.top-1,ka.left,ka.top-1,ka.left,!1,!1),sa=xa.g(this.$).Ub(ka).originalText,nb=ka.left-Ia);jb={};jb.ColumnName=sa;jb.ColumnIndex=nb;jb.FieldInfoDataList=Na}return jb};x.bqb=function(ka){ka&&ya.AFrameworkApplication.nd.mu(ka.Gt)};
of.Object.defineProperties(x.prototype,{r6a:{configurable:!0,enumerable:!0,get:function(){return this.lWa}},Bui:{configurable:!0,enumerable:!0,get:function(){return this.DUb}},rVe:{configurable:!0,enumerable:!0,get:function(){return this.oTb}},T4c:{configurable:!0,enumerable:!0,get:function(){return this.w4d}},$:{configurable:!0,enumerable:!0,get:function(){return this.ib}},Hk:{configurable:!0,enumerable:!0,get:function(){return this.bP}},kPh:{configurable:!0,enumerable:!0,get:function(){return!!this.Dvb}}});
Object(t.a)(x,"FieldInfoManager",X.a,[564,6]);$k(m,x);m.prototype.uPh=function(ka,ca){this.Y1a=ca;D.ULS.sendTraceTag(537153825,0,100,"FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col ("+ka.FirstRow+", "+ka.FirstColumn+", "+ka.LastRow+", "+ka.LastColumn+")");this.Ndg(ka,null,!0,!1,!0)};of.Object.defineProperties(m.prototype,{AG:{configurable:!0,enumerable:!0,get:function(){return this.cmg}}});Object(t.a)(m,"FilterInfoManager",x,
[567,564,6]);var Ha=b(1060),Aa=b(1307),V=b(29),La=b(87),Ra=b(9);v.Csh="ewa-sharedUi-launchButton";v.Fsh="ewa-sharedUi-launchButtonWithText";v.Dsh="ewa-sharedUi-launchButtonClick";v.Gsh="ewa-sharedUi-launchButtonWithTextClick";v.Esh="ewa-sharedUi-launchButtonText";Object(t.a)(v,"CssClassNames",null,[]);var pb=b(64);b(573);var cb=b(249),Sa=b(236);X=b(248);var Db=b(302),Ab=b(69),Wb=b(11),ub=b(262),vb=b(33),Ka=X.a;$k(f,Ka);f.prototype.C2=function(ka){this.addHandler(this.MGb,ka)};f.prototype.rda=function(ka){this.get_events().removeHandler(this.MGb,
ka)};f.prototype.bHg=function(ka){this.addHandler("OnObjectButtonMouseOver",ka)};f.prototype.qdj=function(ka){this.get_events().removeHandler("OnObjectButtonMouseOver",ka)};f.prototype.aHg=function(ka){this.addHandler("OnObjectButtonMouseOut",ka)};f.prototype.pdj=function(ka){this.get_events().removeHandler("OnObjectButtonMouseOut",ka)};f.prototype.Ucg=function(ka){ka&&(this.o_a.innerHTML=ka)};f.prototype.ZRj=function(ka,ca,Ia){this.o_a.innerHTML="";ka?ka.vba(ca,16,16,this.o_a,16,16,void 0,Ia):D.ULS.sendTraceTag(537153824,
0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")};f.prototype.$Rj=function(ka,ca){ka&&(this.DNb.innerText=ka);this.domElement.title=ca};f.prototype.dispose=function(){this.get_isInitialized()&&(this.hide(),this.zc.qC(),La.a.oc([this.dZ,this.f_a]),Sa.a.instance.Ba(Q.a.click,this.domElement,this.Zc),cb.a.instance.Ba(Q.a.pointerDown,this.domElement,this.tN),this.pSa&&this.pSa.dispose(),Ka.prototype.dispose.call(this))};f.prototype.Sbb=function(){this.Z2b&&this.domElement.classList.remove(this.Z2b);
this.lmc&&this.domElement.classList.add(this.lmc)};f.prototype.KGb=function(){this.lmc&&this.domElement.classList.remove(this.lmc);this.Z2b&&this.domElement.classList.add(this.Z2b);this.l2a()};f.prototype.l2a=function(){this.wic&&(this.pSa.cancel(),this.a7f(),this.setOpacity(1));this.set_visible(!0)};f.prototype.hp=function(ka,ca,Ia,jb,nb){nb=void 0===nb?!1:nb;ka=vb.a(jb).hi(ka);ca=vb.a(jb).hi(ca);vb.a(jb).ywc(this.domElement);this.domElement.style.top=Wb.HelperMethods.nc(ca);this.domElement.style.left=
this.domElement.style.right="";ca=ka;nb&&(ca=ka-this.domElement.offsetWidth);ub.c(this.domElement.style,Ia,Wb.HelperMethods.nc(ca));this.set_visible(!0);this.setOpacity(1);this.wic&&(this.QSd=!1,this.fGj(),this.pSa.Iq())};f.prototype.hide=function(){this.Sbb();this.set_visible(!1);this.wic&&(this.a7f(),this.pSa.cancel())};f.prototype.d8b=function(){this.zc.ka("mouseover",this.yN,!0);this.zc.ka("mouseout",this.xN,!0)};f.prototype.fGj=function(){this.dZ.Zm("mousemove")||this.dZ.ka("mousemove",this.AKi)};
f.prototype.a7f=function(){this.dZ.Zm("mousemove")&&this.dZ.detach("mousemove")};f.prototype.jid=function(ka){if(this.domElement.parentNode){var ca=Sys.UI.DomElement.getBounds(this.domElement),Ia=new Sys.UI.Point(Math.round(ca.x+ca.width),Math.round(ca.y+ca.height));ca=Math.abs(Ia.x-ka.x);ka=Math.abs(Ia.y-ka.y);ka=ca>ka?ca:ka;this.QSd?this.setOpacity(f.TUg(ka)):100>=ka&&this.kke()}};f.prototype.kke=function(){this.QSd=!0;this.pSa.cancel()};f.prototype.setOpacity=function(ka){L.a.setOpacity(this.domElement,
ka);this.Qjf=G.a.Ta.Jb};f.TUg=function(ka){return 100>=ka?1:250<=ka?0:.01*(100-(ka-100)/150*100)};Object(t.a)(f,"OnObjectButton",X.a,[1E3,177,6]);var eb=b(1013),yb=v.Esh,oc=F.a;$k(n,oc);n.prototype.dispose=function(){this.Jhh();this.$=null;oc.prototype.dispose.call(this)};n.prototype.getButton=function(ka,ca){return this.Yua(ka,void 0===ca?!0:ca)};n.prototype.Yua=function(ka,ca){var Ia=ka.toString();Ia in this.buttons||this.K8g(ka,void 0===ca?!0:ca);return this.buttons[Ia]};n.prototype.hp=function(ka,
ca,Ia,jb,nb,Na){nb=void 0===nb?!0:nb;Na=void 0===Na?!1:Na;this.hide();if(this.$.ea.isNamedObjectViewMode&&pb.i(this.$.pa)){var sa=xa.g(this.$).WR.domElement,Wa=ka+this.buttonWidth-sa.scrollWidth;sa=ca+this.buttonWidth-sa.scrollHeight;ka=0<Wa?ka-Wa:ka;ca=0<sa?ca-sa:ca}this.Yua(jb,nb).hp(ka,ca,Ia,this.$,Na)};n.prototype.hide=function(){var ka=this.buttons,ca;for(ca in ka)ka[ca].hide()};n.prototype.d8b=function(ka,ca){!this.X8e&&(ca=this.buttons[ca.toString()])&&(this.Klc=function(Ia,jb){ka(jb,!0)},
ca.bHg(this.Klc),this.Jlc=function(Ia,jb){ka(jb,!1)},ca.aHg(this.Jlc),this.X8e=!0,ca.d8b())};n.prototype.K8g=function(ka,ca){function Ia(Na,sa){jb.UIi(sa,ka)}var jb=this;this.lwa=String.format(this.Lkd===P.a.S8b?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',V.a.yg(this.Lkd),V.a.yg(this.Kkd),"{0}");var nb=String.format(this.lwa,V.a.yg(this.altText));ca=new f(""===this.buttonText?v.Csh:
v.Fsh,""===this.buttonText?v.Dsh:v.Gsh,P.a.HA,nb,ca,this.MGb,this.buttonText,yb);ca.C2(Ia);this.buttons[ka.toString()]=ca;this.AMe[ka.toString()]=Ia;nb=xa.g(this.$).Gf(ka);nb.domElement.insertBefore(ca.domElement,nb.domElement.firstChild)};n.prototype.Jhh=function(){for(var ka=ik(eb.a(this.buttons)),ca=ka.next();!ca.done;ca=ka.next()){ca=ca.value;var Ia=this.buttons[ca];Ia.rda(this.AMe[ca]);La.a.Ia(Ia);delete this.buttons[ca];this.Klc&&Ia.qdj(this.Klc);this.Jlc&&Ia.pdj(this.Jlc)}};n.prototype.domElement=
function(ka){return this.Yua(ka).domElement};n.prototype.l2a=function(ka){this.Yua(ka).l2a()};n.prototype.bPb=function(ka,ca,Ia){Ia=void 0===Ia?!0:Ia;this.lwa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',V.a.yg(this.Lkd),V.a.yg(this.Kkd),"{0}");ka=String.format(this.lwa,V.a.yg(ka));this.Yua(ca,Ia).Ucg(ka)};n.prototype.OTa=function(ka,ca,Ia){this.Yua(Ia,!1).$Rj(ka,ca)};n.prototype.Kdg=function(){var ka=void 0===ka?!1:ka;this.lwa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',
"{0}",V.a.yg(this.Kkd),"{1}");var ca=String.format(this.lwa,void 0,V.a.yg(void 0));this.Yua(void 0,ka).Ucg(ca)};n.prototype.Ldg=function(ka,ca,Ia){this.Yua(Ia,!1).ZRj(this.svgIconProvider,ka,ca)};of.Object.defineProperties(n.prototype,{hz:{configurable:!0,enumerable:!0,get:function(){return vb.a(this.$).iGa(Ra.a.uQi)}},z2b:{configurable:!0,enumerable:!0,get:function(){return Ra.a.tQi}},buttonWidth:{configurable:!0,enumerable:!0,get:function(){return vb.a(this.$).iGa(Ra.a.vQi)}}});Object(t.a)(n,"OnObjectLaunchButton",
F.a,[993,6]);F=b(94);var Jb=F.a;$k(k,Jb);k.prototype.dispose=function(){La.a.Ia(this.rCb);this.rCb=null;Jb.prototype.dispose.call(this)};k.prototype.ESa=function(){La.a.Ia(this.rCb);this.rCb=S.a.instance.create(this.thh,this.c$h,N.a.Fui)};k.prototype.eeb=function(){La.a.Ia(this.rCb);this.hide()};Object(t.a)(k,"LoadingIndicatorBehavior",F.a,[973,6]);$k(h,k);h.prototype.dispose=function(){this.qCb=null;k.prototype.dispose.call(this)};h.prototype.display=function(){this.Aog(this.qCb)};h.prototype.hide=
function(){this.l7h(this.qCb)};h.prototype.PCg=function(){this.qCb=document.createElement("div");this.domElement.appendChild(this.qCb)};Object(t.a)(h,"ShimmerLoadingIndicatorBehavior",k,[]);var dc=b(71),$a=b(53),Ba=b(12);$k(e,k);e.prototype.dispose=function(){this.HNa=null;k.prototype.dispose.call(this)};e.prototype.display=function(){Ba.DOMElementExtensions.setVisible(this.HNa,!0)};e.prototype.hide=function(){Ba.DOMElementExtensions.setVisible(this.HNa,!1)};e.prototype.OCg=function(){this.HNa=document.createElement("div");
this.HNa.classList.add(dc.a.drh);var ka=document.createElement("div");ka.classList.add(dc.a.erh);this.W4c&&""!=this.W4c&&ka.classList.add(this.W4c);var ca=0===this.Clf?"":da.a.instance.ga(this.Clf),Ia=String.format('<div class="'+dc.a.frh+'">{0}</div>',ca);ka.innerHTML=this.Mec?'<img src="'+this.Mec+'" alt="'+ca+'" title="'+ca+'"/>'+Ia:Ia;this.HNa.appendChild(ka);this.domElement.appendChild(this.HNa)};Object(t.a)(e,"SpinnerLoadingIndicatorBehavior",k,[]);d.prototype.Y3c=function(ka,ca,Ia){return new Ha.a(ka,
ca,Ia)};d.prototype.a5b=function(ka,ca,Ia,jb,nb,Na,sa,Wa,Hb,Yb){return new Aa.a(ka,ca,Ia,jb,nb,Na,sa,Wa,Hb,Yb)};d.prototype.Vrb=function(ka,ca,Ia,jb,nb){return new e(ka,ca,Ia,jb,void 0===nb?0:nb)};d.prototype.Gfd=function(ka){return ka.da.za(238)||new l(ka)};d.prototype.e5b=function(ka,ca,Ia,jb,nb,Na,sa,Wa){return new n(ka,ca,Ia,jb,nb,Na,sa,void 0===Wa?"":Wa)};d.prototype.A3c=function(ka,ca){return new x(ka,ca)};d.prototype.E7g=function(ka,ca,Ia,jb){return new m(ka,ca,Ia,jb)};d.prototype.g3c=function(ka,
ca,Ia,jb){return new u(ka,ca,Ia,jb)};Object(t.a)(d,"SharedUIControlsFactory",null,[918]);var la=y.a;$k(c,la);c.prototype.create=function(){w.EwaSettings.xl()?this.pb(this.$.da.za(12)||new d):this.pb(new d)};c.ka=function(ka){ka.da.Ga(477,new c(ka))};Object(t.a)(c,"SharedUIControlsFactoryServiceFactory",y.a,[]);b.d(E,"a",function(){return a})},1376:function(t,E,b){function a(){l.a.Fa(c.ka);l.a.Fa(x.ka)}function c(sa){return Na.call(this,sa)||this}function d(sa,Wa,Hb,Yb,Sb,lb,wb){var wa=this;this.$=
sa;this.gridView=Wa;this.Hg=Hb;this.sB=Yb;this.borderFormatManager=Sb;this.moreColorsHelper=lb;this.fontDropdownHelper=wb;this.wA=null;this.v_a=1461300262;this.ex=this.s_a=this.V8a=this.M$b=null;this.zOi=function(Oa,Ub){if(!aa.a(Oa)&&Ub){var hb=!!Oa&&!!Oa.RequestTelemetryData;Wb.g(wa.$).si.tla(Ub,Oa.StateId,hb?Oa.RequestTelemetryData.EcsOperationDuration:0,hb?Oa.RequestTelemetryData.EcsRequestDuration:0,hb?Oa.RequestTelemetryData.WfeRequestDuration:0)}};this.yqb=function(){if(wa.gridView.v6a){var Oa=
wa.$.da.za(254,!0);Oa&&Oa.Edj(wa.yqb);wa.gridView.v6a=!1;wa.gridView.ig.wo(ea.a.x4);wa.gridView.ha.zW(wa.Fbd);Wb.g(wa.$).$.hf()}};this.Fbd=function(){var Oa=wa.M$b;wa.M$b=da.d(wa.$.xa.pa);if(Oa===wa.M$b)if(wa.gridView.ha.zW(wa.Fbd),(Oa=wa.$.da.za(254,!0))&&Oa.NZc(36,Wb.g(wa.$).ha.sa.selectedRanges)){Oa=new oa.a(1804571062,2,2,0,null);var Ub={};wa.$.Ka.Kb(Oa,(Ub[ea.a.skipClipboardAccess]=!0,Ub[ea.a.r0c]=!0,Ub[ea.a.isFormatPainter]=!0,Ub)).continueWith(function(){wa.yqb()})}else wa.gridView.ig.HG(!1)};
this.tb=y.EwaSettings.tb();this.vlc=new e(this.$,Hb);this.KC=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);this.Am=y.EwaSettings.Am();this.an=jb.a.an()}function e(sa,Wa){this.$=sa;this.Hg=Wa;this.ox=new Ab.a(Wb.g(this.$).Ea,this.$);this.ggf=y.EwaSettings.isChangeGateEnabled("OfficeVSO:5412627_MergeCellRangeBorderScenariosTelemetry");this.ezb=y.EwaSettings.isChangeGateEnabled("OfficeVSO:5607672_MergeCellCseForOutOfViewPortCells");this.Zod=y.EwaSettings.isChangeGateEnabled("OfficeVSO:5658006_MergeCellCSEBugFixesforCellStylesAndRTL");
this.khc=y.EwaSettings.isChangeGateEnabled("OfficeVSO:5954689_MergeCellCSEUnmergewithMergeCommand");this.cef=y.EwaSettings.isChangeGateEnabled("OfficeVSO:6013788_MergeCellHighGetRangeNumbersTelemetry");this.Ahi=y.EwaSettings.isChangeGateEnabled("OfficeVSO:6100978_MergeCellCSEIsCsePossibleForWrapTextWrongValueForUnmergeCommandFix");this.hif=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1);this.Yhc=y.EwaSettings.isChangeGateEnabled("OfficeVSO:6147046_MergeCellCSERangeBorderScenarioFix");
this.Wzb=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellMultipleBlocksScenarioCse",!1);this.lhc=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellBorderScenarioCse",!1);this.Nki=y.EwaSettings.isChangeGateEnabled("OfficeVSO:6327711_MergeCellMultiBlockUnmergeBitFix");this.Hhi=y.EwaSettings.isChangeGateEnabled("OfficeVSO:6350260_MergeCellCSEDataLossScenarioUnmergeConditionFix");this.Xbf=y.EwaSettings.isChangeGateEnabled("OfficeVSO:6209366_MergeCellCSECellFormatAssertFix");
this.$df=y.EwaSettings.isChangeGateEnabled("OfficeVSO:6402649_HiddenCellsAvoidCseFixEnabled");this.cli=y.EwaSettings.isChangeGateEnabled("OfficeVSO:6476102_MergeCellCSEMultiBlockMergeFlagsFix")}function h(){this.scenario=0;this.qQ=null}function k(){this.OQa=this.GGa=this.vNa=this.oTa=0}function n(sa,Wa,Hb,Yb){this.targetSheetRange=this.sourceSheetRange=null;this.fillRangeDirection=this.fillRangeType=0;this.sourceSheetRange=sa;this.targetSheetRange=Wa;this.fillRangeType=Hb;this.fillRangeDirection=
Yb}function f(sa,Wa,Hb){var Yb=cb.call(this,sa)||this;Yb.zl=null;Yb.t6c=0;Yb.adi=function(Sb,lb){if(0===Sb)F.ULS.sendTraceTag(574993491,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: User pressed Cancel");else{Sb={};var wb="",wa=1035996630;switch(lb.selectedKey){case 0:wb=1896159024===Yb.mr?"InsertCellsShiftRight":"DeleteCellsShiftLeft";break;case 1:wb=1896159024===Yb.mr?"InsertCellsShiftDown":"DeleteCellsShiftUp";break;case 2:1896159024===Yb.mr?(wb="InsertRows",wa=-1113896058):(wb=
"DeleteRows",wa=1554436520);break;case 3:1896159024===Yb.mr?(wb="InsertColumns",wa=1415868706):(wb="DeleteColumns",wa=674605324)}F.ULS.sendTraceTag(574993490,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: Handle RibbonCommand.InsertOrDeleteCells, MenuItemId:"+wb);lb=new oa.a(wa,1,2,8,null);Sb[xa.a.Mc]=wb;Yb.$.Ka.Kb(lb,Sb)}};Yb.mr=Wa;Yb.selectedRanges=Hb;sa=Object(La.a)(Ra.a,Yb.$.xa.pa);Yb.isRtl=sa.displayRtl;return Yb}function v(sa,Wa,Hb,Yb,Sb){this.IUe=0;this.Mpg=sa;this.Npg=Wa;this.byg=
Hb;this.pXb=Yb;this.IUe=void 0===Sb?0:Sb}function m(sa){this.insertDeleteMultiRangeParameters=null;this.insertDeleteMultiRangeParameters=sa}function x(sa){var Wa=D.call(this)||this;Wa.$=sa;Wa.Eb();return Wa}var l=b(10);t=b(0);var u=b(235),A=b(50),z=b(37),y=b(1),w=b(1028),D=u.a;$k(x,D);x.prototype.create=function(){var sa=this,Wa=A.GetServiceTaskFactory.create(this.$.da,18,this.la,this.hb),Hb=A.GetServiceTaskFactory.create(this.$.da,102,this.la,this.hb);z.TaskExtensions.Aa(z.TaskExtensions.Vd([Wa,
Hb],this.la),function(){sa.pb(sa.$.da.za(296)||sa.$.da.Ga(296,new w.BorderFormatManager(sa.$,Wa.result,Hb.result)))},this.la,3)};x.ka=function(sa){y.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")&&sa.da.Ga(468,new x(sa))};Object(t.a)(x,"BorderFormatManagerFactory",u.a,[]);var H=b(915),F=b(15),J=b(278),S=b(178),N=b(1043),T=b(27),G=b(39),I=b(29),K=b(96),L=b(275),O=b(375),B=b(371),Q=b(99),U=b(192),X=b(9),P;(function(sa){sa[sa.insert=1]="insert";sa[sa.delete=2]="delete";
sa[sa.rows=4]="rows";sa[sa.columns=8]="columns";sa[sa.cellsShiftHorizontal=16]="cellsShiftHorizontal";sa[sa.cellsShiftVertical=32]="cellsShiftVertical";sa[sa.insertRows=5]="insertRows";sa[sa.insertColumns=9]="insertColumns";sa[sa.insertCellsShiftRight=17]="insertCellsShiftRight";sa[sa.insertCellsShiftDown=33]="insertCellsShiftDown";sa[sa.deleteRows=6]="deleteRows";sa[sa.deleteColumns=10]="deleteColumns";sa[sa.deleteCellsShiftLeft=18]="deleteCellsShiftLeft";sa[sa.deleteCellsShiftUp=34]="deleteCellsShiftUp"})(P||
(P={}));Object(t.b)("InsertDeleteCellFlags",P);var ea=b(5),ia=b(452),da=b(64),xa=b(76);Object(t.a)(m,"MacroRecorderRangeInsertedOrDeletedPayload",null,[430]);var Z=b(1294),ha=b(41),ya=b(572),va=b(394),bb=b(177),ba=b(62),fa=b(259),ra=b(151),pa=b(499),Za=b(114),Ua=b(53),Ma=b(208),oa=b(91),ja=b(34),ta=b(31),aa=b(299),ma=b(271),Ea=b(11),Ha=b(187),Aa=b(22),V=b(298);v.wSg=function(sa,Wa){return new v(sa,Wa,null,null,null)};v.YYc=function(sa,Wa){return new v(sa,null,Wa,null,null)};v.xSg=function(sa,Wa){return new v(sa,
null,null,Wa,null)};v.vSg=function(sa,Wa,Hb){return new v(sa,null,Wa,null,Hb)};of.Object.defineProperties(v.prototype,{fja:{configurable:!0,enumerable:!0,get:function(){return this.Mpg}},formattedText:{configurable:!0,enumerable:!0,get:function(){return this.Npg}},style:{configurable:!0,enumerable:!0,get:function(){return this.byg}},size:{configurable:!0,enumerable:!0,get:function(){return this.pXb}},Maa:{configurable:!0,enumerable:!0,get:function(){return this.IUe}}});Object(t.a)(v,"CachedPreviewCellGroup",
null,[]);var La=b(85);u=b(300);var Ra=b(101),pb=b(14),cb=u.a;$k(f,cb);f.prototype.qg=function(){1896159024===this.mr?(this.zl=pb.a.instance.ga(23),this.t6c=0):(this.zl=pb.a.instance.ga(22),this.t6c=1);var sa=this.selectedRanges[0].l_&&!this.selectedRanges[0].x5?0:1;this.Rb=1;var Wa={};sa=(Wa[f.Hu]=this.mc,Wa.dialogToDisplay=this.t6c,Wa.defaultSelectedKey=sa,Wa.isRtl=this.isRtl,Wa);this.initializeAndShow(this.zl,this.adi,sa)};of.Object.defineProperties(f.prototype,{mc:{configurable:!0,enumerable:!0,
get:function(){return"InsertDeleteCellsDialog"}}});Object(t.a)(f,"InsertDeleteCellsDialog",u.a,[]);Object(t.a)(n,"MacroRecorderRangeFilledPayload",null,[430]);var Sa=b(7),Db=b(24);Object(t.a)(k,"RangeBorders",null,[]);Object(t.a)(h,"ScenarioInfo",null,[]);var Ab=b(1127),Wb=b(21),ub=b(277),vb=b(220),Ka=b(77);e.prototype.dispose=function(){this.$=null};e.prototype.Ghi=function(sa,Wa){return!(void 0===Wa||null===Wa)&&!!(Wa.scenario&16384)&&!this.Ihi(sa,Wa)&&this.Qbf(Wa,sa)};e.prototype.R_e=function(){var sa=
G.a.Qd(),Wa=Wb.g(this.$),Hb=Wa.ha.sa.selectedRanges,Yb=0,Sb=0,lb=Hb.length,wb=new h;if(1<lb)return wb.scenario=4,wb;if(this.$df&&Wa.Qe.Nff(Hb[0]))return wb.scenario=262144,wb;this.Zod&&Wb.g(this.$).rtl&&(Yb|=65536);if(!Wa.UQ(Hb[0]))if(this.ezb)Yb|=32;else return wb.scenario=32,wb;if(Wa=Wa.Ea.mKa(Hb[0],this.$.activeItemName))for(wb.rYc=Wa,Wa=ik(Wa),lb=Wa.next();!lb.done;lb=Wa.next())if(Sb+=1,1<Sb){this.ezb?(Yb|=256,wb.scenario=Yb):wb.scenario=256;if(!this.Wzb)return wb;break}Sb=Wb.g(this.$).Ea.Tua(Hb[0]);
if(!Sb)return wb.scenario=32768,wb;Wa=Sb.length;Hb=Hb[0];lb=Hb.bottom-Hb.top+1;for(var wa=Hb.right-Hb.left+1,Oa=new k,Ub=0;Ub<Wa;Ub++)if(this.ggf&&this.kWh(Sb[Ub],Hb,Oa),Yb=Yb|(void 0!==Sb[Ub].text&&null!==Sb[Ub].text&&""!==Sb[Ub].text?1:0)|(Sb[Ub].XM?2:0)|(Sb[Ub].Qva?8:0)|(Sb[Ub].fxb?16:0)|(Sb[Ub].PE?64:0)|(Sb[Ub].jba?128:0),void 0!==Sb[Ub].text&&null!==Sb[Ub].text&&""!==Sb[Ub].text||Sb[Ub].Qva)if(void 0===wb.qQ||null===wb.qQ)wb.qQ=Wb.g(this.$).Ub(Sb[Ub].getRange());else{if(Sb[Ub].getRange().top<
wb.qQ.range.top||Sb[Ub].getRange().top==wb.qQ.range.top&&Sb[Ub].getRange().left<wb.qQ.range.left)wb.qQ=Wb.g(this.$).Ub(Sb[Ub].getRange());Yb|=16384}this.ggf&&(Oa.oTa===wa&&(Yb|=512),Oa.GGa===wa&&(Yb|=2048),Oa.vNa===lb&&(Yb|=4096),Oa.OQa===lb&&(Yb|=1024),0<Oa.oTa&&Oa.oTa<wa||0<Oa.GGa&&Oa.GGa<wa||0<Oa.vNa&&Oa.vNa<lb||0<Oa.OQa&&Oa.OQa<lb)&&(Yb|=8192);!y.EwaSettings.isChangeGateEnabled("OfficeVSO:6217608_Add_Entire_Row_Column_Selection_flag")||Hb.right!==Hb.maxColumns&&Hb.bottom!==Hb.maxRows||(Yb|=131072);
sa=G.a.Qd()-sa;F.ULS.sendTraceTag(537159424,0,50,"Execution time of GetMergeCellScenario is : "+sa);wb.scenario=Yb;return wb};e.prototype.nqf=function(sa,Wa){var Hb=sa.command;if(void 0===Wa||null===Wa)Wa=this.R_e();if(!this.Qbf(Wa,Hb))return!1;sa=Wb.g(this.$).ha.sa.selectedRanges;var Yb=Wb.g(this.$).Ea.Tua(sa[0]);if(!Yb)return!1;if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:5993850_HandleSingleCellMergeScenario")&&1===Yb.length&&!Yb[0].XM)return-167499203===Hb?(Yb[0].I0(2,!0),!0):!1;Yb=Wb.g(this.$).ha.sa.Qr;
var Sb=this.$.pa.sheetName,lb=!0;switch(Hb){case -167499203:2===(Wa.scenario&2)&&this.khc?this.Xbg(Wa.scenario,sa,Hb):lb=this.nBi(Wa,sa);break;case 1097660126:(Wa=this.oqf(Wa,sa))&&0!=Wa.length||(lb=!1);break;case 155820588:this.Xbg(Wa.scenario,sa,Hb);break;default:return!1}Wb.g(this.$).jV(sa,Yb,Sb,null,sa[0],null,null,0,"MergeCellCommandAction");return this.Wzb?lb:!0};e.prototype.Qbf=function(sa,Wa){var Hb=this.tgi(sa,Wa);if(!this.cef)return Hb;var Yb=Wb.g(this.$).ha.sa.selectedRanges[0].aB(!1);
F.ULS.sendTraceTag(526149324,0,50,"Merge Cell Command: "+Wa.toString()+"; Scenario Number: "+sa.scenario+"; IsCSEPossible result: "+Hb+"; Range: "+Yb);return Hb};e.prototype.tgi=function(sa,Wa){if(-255094134===Wa)return!1;var Hb=sa.scenario;if(this.$df&&262144===Hb||this.Zod&&65536===(Hb&65536))return!1;if(this.gif(Wa,sa))return this.npi(Wa,sa);this.ezb&&32===(Hb&32)&&(Hb&=-33);if(256==(Hb&256))if(this.bli(sa))Hb&=-257;else return!1;return 32768===Hb||4===Hb||128===(Hb&128)||!this.ezb&&32===Hb?!1:
-167499203!=Wa&&1097660126!==Wa||!this.Mmd(sa)?void 0!==sa.qQ&&null!==sa.qQ&&sa.qQ.Nea?!1:0===Hb?!0:16384===(Hb&16384)?y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1):1!==(Hb&1)&&8!==(Hb&8)||!y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellContentScenarioCse",!1)?!1:!0:this.lhc};e.prototype.uii=function(sa){return 131072===(sa.scenario&131072)?!0:!1};e.prototype.bli=function(sa){if(!this.Wzb)return!1;var Wa="Multi block",Hb=!0;this.Mmd(sa)&&
(Wa+=" with border",Hb=!1);this.uii(sa)&&(Hb=!1,Wa+=" with entire row or column selected",16384===(sa.scenario&16384)&&(Wa+=" and a data loss scenario"));Hb||F.ULS.sendTraceTag(523511383,0,50,"CSE for "+Wa+", is not enabled");return Hb};e.prototype.Mmd=function(sa){return 16===(sa.scenario&16)||this.Pid(sa.scenario)||this.ijd(sa.scenario)||this.$id(sa.scenario)||this.ljd(sa.scenario)||8192===(sa.scenario&8192)?!0:!1};e.prototype.Ihi=function(sa,Wa){return this.Hhi?this.gif(sa,Wa):155820588===sa};
e.prototype.gif=function(sa,Wa){return 155820588===sa||(-167499203===sa||1097660126===sa)&&2===(Wa.scenario&2)&&this.khc?!0:!1};e.prototype.mpi=function(sa){return this.ljd(sa.scenario)||this.$id(sa.scenario)||this.Pid(sa.scenario)||this.ijd(sa.scenario)?!0:!1};e.prototype.npi=function(sa,Wa){if(1097660126===sa&&2===(Wa.scenario&2)||this.Ahi&&void 0!==Wa.qQ&&null!==Wa.qQ&&Wa.qQ.Nea)return!1;this.ezb&&32===(Wa.scenario&32)&&(Wa.scenario&=-33);return 32768===Wa.scenario||4===Wa.scenario||256===(Wa.scenario&
256)&&this.Nki||128===(Wa.scenario&128)?!1:2===(Wa.scenario&2)?this.mpi(Wa)?y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1):y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithoutBorderScenariosCse",!1):!1};e.prototype.kWh=function(sa,Wa,Hb){var Yb=sa.getRange();if(Yb.top===Wa.top)if(sa.bLa)Hb.oTa+=Yb.right-Yb.left+1;else{var Sb=this.ox.uQ(Yb,0);if(Sb){var lb=ik(Sb);for(Sb=lb.next();!Sb.done;Sb=lb.next())Sb=Sb.value,
Sb.XKa&&(Hb.oTa+=Sb.getRange().right-Sb.getRange().left+1)}}if(Yb.left===Wa.left)if(sa.ZKa)Hb.vNa+=Yb.bottom-Yb.top+1;else if(Sb=this.ox.uQ(Yb,2))for(lb=ik(Sb),Sb=lb.next();!Sb.done;Sb=lb.next())Sb=Sb.value,Sb.$Ka&&(Hb.vNa+=Sb.getRange().bottom-Sb.getRange().top+1);if(Yb.bottom===Wa.bottom)if(sa.XKa)Hb.GGa+=Yb.right-Yb.left+1;else if(Sb=this.ox.uQ(Yb,1))for(lb=ik(Sb),Sb=lb.next();!Sb.done;Sb=lb.next())Sb=Sb.value,Sb.bLa&&(Hb.GGa+=Sb.getRange().right-Sb.getRange().left+1);if(Yb.right===Wa.right)if(sa.$Ka)Hb.OQa+=
Yb.bottom-Yb.top+1;else if(sa=this.ox.uQ(Yb,3))for(sa=ik(sa),Sb=sa.next();!Sb.done;Sb=sa.next())Wa=Sb.value,Wa.ZKa&&(Hb.OQa+=Wa.getRange().bottom-Wa.getRange().top+1)};e.prototype.xaj=function(sa,Wa){Wa=ik(Wa.rYc);for(var Hb=Wa.next();!Hb.done;Hb=Wa.next()){Hb=sa.ze(Hb.value.jf);Hb=Wb.g(this.$).Ea.Tua(Hb);for(var Yb=Hb.length,Sb=1;Sb<Yb;Sb++){var lb=Wb.g(this.$).Ub(Hb[Sb].getRange());this.lhc?lb.cell.deleteCellFromModel():(lb.uqb(),lb.clearFormat(),lb.cell.yaj());lb.qIb(!0)}}};e.prototype.uVj=function(sa,
Wa){sa.backgroundColor=Wa.backgroundColor;sa.color=Wa.color};e.prototype.Wig=function(sa,Wa){return{SpansBlocks:!0,OriginRow:sa,OriginColumn:Wa,IsOrigin:!1,Columns:0,Rows:0,Width:0,Height:0,OriginDeltaX:0,OriginDeltaY:0}};e.prototype.yBg=function(sa,Wa,Hb,Yb,Sb){Hb=sa.ze(Hb.jf);if(!Hb)return F.ULS.sendTraceTag(523547158,0,15,"blockRange(intersection of block's range and the selected range) can't be null as the blocks we are checking are returned as the intersecting blocks"),null;var lb=new Db.Range(sa.top,
sa.left,Hb.top,Hb.left,!1,!1);if(Hb.top==sa.top)var wb=0;else lb.bottom=Hb.top-1,wb=Wa.$fd(lb);Hb.left==sa.left?lb=0:(lb.right=Hb.left-1,lb=Wa.agd(lb));Wa=this.Wig(sa.top-1,sa.left-1);Wa.OriginDeltaY=wb;Wa.OriginDeltaX=lb;Wa.Rows=Hb.bottom-Hb.top;Wa.Columns=Hb.right-Hb.left;Wa.Height=Sb;Wa.Width=Yb;Hb.top==sa.top&&Hb.left==sa.left&&(Wa.IsOrigin=!0);sa=Wb.g(this.$).Ub(Hb.topLeft);sa.cell.F_f(Wa);return sa};e.prototype.iPd=function(sa,Wa){var Hb=[],Yb=Wb.g(this.$).Qe;if(!Yb)return Hb;var Sb=Yb.$fd(sa),
lb=Yb.agd(sa);if(Wa.rYc){Wa=ik(Wa.rYc);for(var wb=Wa.next();!wb.done;wb=Wa.next())if(wb=this.yBg(sa,Yb,wb.value,lb,Sb))Hb.push(wb);else{Hb=[];break}}return Hb};e.prototype.mXh=function(sa,Wa,Hb,Yb){var Sb=Hb.bottom-Hb.top,lb=Hb.right-Hb.left,wb=[],wa=Yb.scenario;if(256===(wa&256)){if(wb=this.iPd(Hb,Yb),!wb||0==wb.length)return wb}else Wa.cell.iPd(Sb,lb),wb.push(Wa);Sb=this.b3(this.X4(Wa),!0,0,wa,"merge");if(void 0!==sa&&null!==sa){lb=ik(wb);for(var Oa=lb.next();!Oa.done;Oa=lb.next()){Oa=Oa.value;
var Ub=sa.cell.formattedText,hb=Object(Sa.a)(new ub.a,{TextRuns:Ub.TextRuns,Fonts:Ub.Fonts});hb.Text=void 0!==sa.cell.originalText&&null!==sa.cell.originalText?sa.cell.originalText:void 0!==sa.cell.userInput&&null!==sa.cell.userInput?sa.cell.userInput:Ub.Text;Sb=this.b3(this.X4(Oa),Sb,1,wa,"merge");this.Hg.QAa(Oa,hb,!1,null,!0,"MergeCells",void 0,2);Sb=this.b3(this.X4(Oa),Sb,2,wa,"merge");this.Zod?Oa.Dqb(sa):this.uVj(Oa,sa);Sb=this.b3(this.X4(Oa),Sb,3,wa,"merge");Oa.cell.O4g(sa.cell);Sb=this.b3(this.X4(Oa),
Sb,4,wa,"merge");Oa.cell.vCc(!1);Sb=this.b3(this.X4(Oa),Sb,6,wa,"merge")}}this.xaj(Hb,Yb);this.b3(this.X4(Wa),Sb,5,wa,"merge");return wb};e.prototype.$id=function(sa){return 4096===(sa&4096)};e.prototype.ljd=function(sa){return 512===(sa&512)};e.prototype.Pid=function(sa){return 2048===(sa&2048)};e.prototype.ijd=function(sa){return 1024===(sa&1024)};e.prototype.Dac=function(sa,Wa){for(var Hb=null,Yb=0;Yb<sa.length;Yb++)if(sa[Yb].BorderPosition===Wa){Hb=sa[Yb];break}return Hb};e.prototype.rSh=function(sa,
Wa){this.Yhc?(Wa=this.Dac(Wa.cell.EM().Borders,2))&&sa.push(Wa):(Wa=Wa.cell.EM().Borders,1<Wa.length&&(Wa=[Wa[1]]),sa=[].concat(kk(Wa),kk(sa)));return sa};e.prototype.F_h=function(sa,Wa){this.Yhc?(Wa=this.Dac(Wa.cell.EM().Borders,0))&&sa.push(Wa):(Wa=Wa.cell.EM().Borders,1<Wa.length&&(Wa=[Wa[0]]),sa=[].concat(kk(Wa),kk(sa)));return sa};e.prototype.qKh=function(sa,Wa){Wa=this.ox.uQ(Wa.cell.getRange(),1);if(!Wa||0===Wa.length)return sa;if(this.Yhc){if(Wa=Wa[0].EM().Borders,Wa=this.Dac(Wa,0))Wa.BorderPosition=
1,sa.push(Wa)}else{var Hb=[];0<Wa.length&&(Hb=Wa[0].EM().Borders);Hb[0].BorderPosition=1;sa=[].concat(kk(Hb),kk(sa))}return sa};e.prototype.xXh=function(sa,Wa){Wa=this.ox.uQ(Wa.cell.getRange(),3);if(!Wa||0===Wa.length)return sa;if(this.Yhc){if(Wa=Wa[0].EM().Borders,Wa=this.Dac(Wa,2))Wa.BorderPosition=3,sa.push(Wa)}else{var Hb=[];0<Wa.length&&(Hb=Wa[0].EM().Borders);Hb[0].BorderPosition=3;sa=[].concat(kk(Hb),kk(sa))}return sa};e.prototype.lWh=function(sa,Wa,Hb){this.$id(sa.scenario)&&(Wa=this.rSh(Wa,
Hb));this.ljd(sa.scenario)&&(Wa=this.F_h(Wa,Hb));this.Pid(sa.scenario)&&(Wa=this.qKh(Wa,Hb));this.ijd(sa.scenario)&&(Wa=this.xXh(Wa,Hb));return Wa};e.prototype.wZ=function(sa){if(0===sa.length)return null;var Wa=[0,0,0,0],Hb=[1,1,1,1],Yb=0;sa.forEach(function(lb){var wb=lb.BorderPosition;Hb[wb]=lb.BorderLineStyle;var wa=new vb.a(lb.Color.Red,lb.Color.Green,lb.Color.Blue);Wa[wb]=wa.oS();Yb|=Ea.HelperMethods.K3a(lb.BorderPosition)});sa={};sa.LineStyle=Hb;sa.Color=Wa;var Sb={};Sb.BorderFormat=sa;Sb.Border=
Yb;return Sb};e.prototype.a1d=function(sa,Wa,Hb){Hb=void 0===Hb?null:Hb;var Yb=[];Yb=null!==Hb?[].concat(kk(Hb)):this.lWh(Wa,Yb,sa);if(Wa=this.wZ(Yb))sa.cell.mbb(sa.cell.getRange()),this.ox.pIb(sa.cell.getRange()),this.Hg.Zda(Wb.g(this.$),-1690267012,Wa,!1,null,[sa.cell.getRange()])};e.prototype.jmi=function(sa){return 512===(sa.scenario&512)||4096===(sa.scenario&4096)||1024===(sa.scenario&1024)||2048===(sa.scenario&2048)?!0:!1};e.prototype.G_h=function(sa){sa=this.ox.uQ(sa.cell.getRange(),1);return sa&&
0!==sa.length?sa[0].bLa?(sa=sa[0].EM().Borders[0],sa.BorderPosition=1,sa):null:null};e.prototype.H_h=function(sa){sa=this.ox.uQ(sa.cell.getRange(),3);return sa&&0!==sa.length?sa[0].ZKa?(sa=sa[0].EM().Borders[0],sa.BorderPosition=3,sa):null:null};e.prototype.i4h=function(sa,Wa,Hb,Yb,Sb){Wa.cell.Vdg();if(this.jmi(sa))this.a1d(Wa,sa);else{var lb=8192===(sa.scenario&8192),wb=Wa.cell.getRange();lb&&this.Xbf?(Wa.cell.mbb(),this.ox.pIb(wb)):Sb?(Sb=[],null!==Hb&&Sb.push(Hb),null!==Yb&&Sb.push(Yb),0<Sb.length?
this.a1d(Wa,sa,Sb):(Wa.cell.mbb(),this.ox.pIb(wb))):lb&&!this.Xbf&&(Wa.cell.mbb(),this.ox.pIb(wb))}};e.prototype.MRh=function(sa,Wa){return null===sa||void 0===sa?!0:sa.cell.getRange().top===Wa.topLeft.top&&sa.cell.getRange().left===Wa.topLeft.left&&sa.cell.getRange().bottom===Wa.topLeft.bottom&&sa.cell.getRange().right===Wa.topLeft.right?!0:!1};e.prototype.nBi=function(sa,Wa){Wa=this.oqf(sa,Wa);if(this.Wzb&&(!Wa||0==Wa.length))return!1;for(var Hb=0;Hb<Wa.length;Hb++)Wa[Hb].I0(2,!0),this.b3(this.X4(Wa[Hb]),
!0,8,sa.scenario,"merge");return!0};e.prototype.QTj=function(sa){var Wa=Wb.g(this.$).Ea.mKa(sa,this.$.activeItemName);if(Wa&&Ka.Ct(Wa)){Wa=ik(Wa);for(var Hb=Wa.next();!Hb.done;Hb=Wa.next())Hb.value.OYd(sa,!0)}};e.prototype.oqf=function(sa,Wa){var Hb=sa.qQ,Yb=Wb.g(this.$).Ub(Wa[0]),Sb=null,lb=null;this.lhc&&(Sb=this.G_h(Yb),lb=this.H_h(Yb));var wb=this.mXh(Hb,Yb,Wa[0],sa);if(this.Wzb&&(!wb||0==wb.length))return wb;this.cli?this.QTj(Wa[0]):Wb.g(this.$).Ea.o$(Wa[0],this.$.activeItemName).OYd(Wa[0],!0);
this.b3(this.X4(Yb),!0,9,sa.scenario,"merge");if(this.lhc&&this.Mmd(sa))for(Wa=this.MRh(Hb,Wa[0]),Hb=ik(wb),Yb=Hb.next();!Yb.done;Yb=Hb.next())this.i4h(sa,Yb.value,Sb,lb,Wa);return wb};e.prototype.FLg=function(sa,Wa,Hb){var Yb=this;if(!(1>sa.Borders.length)){var Sb=this.wZ(sa.Borders);Hb.forEach(function(lb){lb=Wb.g(Yb.$).Ub(lb.getRange());Yb.Hg.b4f(-1690267012,lb,Sb,!1,null,!1,Wa)})}};e.prototype.xQj=function(sa,Wa,Hb){for(var Yb=sa.length,Sb=0;Sb<Yb;Sb++){sa[Sb].cell.vCc();var lb=sa[Sb].cell.getRange(),
wb=Wb.g(this.$).Ea.Tua(lb),wa=wb.length;if(-167499203===Wa&&this.khc){var Oa=0;2===sa[Sb].cell.ZGd||1===sa[Sb].cell.iM?Oa=3:2===sa[Sb].cell.iM&&(Oa=1);sa[Sb].I0(Oa,!1)}for(Oa=1;Oa<wa;Oa++)wb[Oa].attachCellToModel(),wb[Oa].Dqb(sa[Sb]),-167499203===Wa&&this.khc&&wb[Oa].I0(null,!1);this.hif&&Hb&&this.FLg(Hb[Sb],lb,wb)}};e.prototype.zWe=function(sa,Wa){for(var Hb=null,Yb=0;Yb<sa.length;Yb++)if(sa[Yb].BorderPosition===Wa){Hb=sa[Yb];break}return Hb};e.prototype.pKh=function(sa,Wa){var Hb=sa.cell.EM();sa.XKa()&&
sa.cell.kQa(1);sa.$Ka()&&sa.cell.kQa(3);if((sa=this.ox.uQ(Wa,0))&&sa[0].XKa){var Yb=sa[0].EM().Borders;Yb=this.zWe(Yb,1);Yb.BorderPosition=0;Hb.Borders.push(Yb);sa.forEach(function(Sb){Sb.kQa(1)})}(Wa=this.ox.uQ(Wa,2))&&Wa[0].$Ka&&(sa=Wa[0].EM().Borders,sa=this.zWe(sa,3),sa.BorderPosition=2,Hb.Borders.push(sa),Wa.forEach(function(Sb){Sb.kQa(3)}));return Hb};e.prototype.Xbg=function(sa,Wa,Hb){var Yb=Wb.g(this.$).Ea.nva(Wa[0],this.$.activeItemName),Sb=Wb.g(this.$).Ea.o$(Wa[0],this.$.activeItemName),
lb=[];if(void 0!==Yb&&null!==Yb&&(Wa=Wb.g(this.$).mva(Wa[0],Yb),void 0!==Wa&&null!==Wa)){Wa=Wa.$$ge();for(Yb=[];Wa.$$mn();){var wb=Wa.$$cu();if(wb.aF){lb.push(wb);this.b3(this.X4(wb),!0,10,sa,"unmerge");wb.cell.xZg();var wa=wb.cell.getRange();this.b3(this.X4(wb),!1,11,sa,"unmerge");Sb.OYd(wa,!1);this.hif&&(wb=this.pKh(wb,wa),Yb.push(wb))}}0<lb.length&&(Sb.lf.resetCellLookup(),this.xQj(lb,Hb,Yb))}};e.prototype.b3=function(sa,Wa,Hb,Yb,Sb){if(!this.cef)return!1;sa!==Wa&&F.ULS.sendTraceTag(526149323,
0,50,"Merge Information for resultant cell is unexpectedly changed at step: "+Hb+"; Scenario: "+Yb+"; Command: "+Sb+"; Expected: "+(Wa?"populated":"empty")+"; Actual: "+(sa?"populated":"empty"));return sa};e.prototype.X4=function(sa){return!!sa.cell.cell.Merge};Object(t.a)(e,"MergeCellCommandAction",null,[]);var eb=b(74),yb=b(95),oc=b(211),Jb=b(43),dc=b(501),$a=b(401),Ba=b(51),la=b(68),ka=b(916),ca=b(58),Ia=b(1301),jb=b(36),nb=b(359);d.prototype.aki=function(sa){return 1896159024===sa||-1554384558===
sa||-1113896058===sa||1554436520===sa||1415868706===sa||674605324===sa||1035996630===sa};d.prototype.Nc=function(sa,Wa){return 2054778433===Wa&&sa&1?!pa.a(this.$).aic:600686207===Wa?!1:this.aki(Wa)&&J.a.any(this.gridView.ha.sa.selectedRanges,function(Hb){return Hb.We||Hb.isRow})&&!this.Zgf&&!this.Ugf?!0:this.uic(sa,Wa)};d.prototype.executeCommand=function(sa,Wa,Hb){return this.Kb(Wa,Hb)};d.prototype.Ac=function(sa,Wa,Hb){if(sa=1===sa)switch(Wa.command){case 1457172838:case 2036397036:case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:case 1886928607:case -992833457:case 218524921:case 996232352:case -167499203:case -255094134:case -693675336:case 322710748:case 1097660126:case 155820588:case 1896159024:case -1554384558:case 504848446:case 1504715724:case 1872288872:case 41465729:case -1451655532:case 1972143101:case -475861485:case -978843926:case 2098035706:case -2142700828:case 1405660955:case 1983983164:case 478842689:case -798660877:case -653661711:case 862890474:case 963349338:case 1012765228:case 1597684571:case -1832800737:case -1920201820:case -1942512156:case -600086683:case -208772570:case -987339782:case 748067091:case -381232414:case 1696566924:case 894341014:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:case -1770246794:break;
case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:sa=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",!1);break;case -1077965542:case 909774670:case -1904244080:case -1293291468:case 324978188:case -1428968098:case 1970784898:case -803000997:case -128950598:case 1688184685:case 87208751:case -446735083:case 1650812936:case 673562736:case -1690267012:case -236759591:case -1803452024:case -2118943501:case 1890566896:case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:case 886009118:case 165054436:case 1981714220:case -556441918:case 942362098:case 622604322:case 1405456548:case 284490184:case 1256700402:case -1756763834:case -1418159950:sa=
!!Hb;break;case 862825906:case 1532790410:case 46555851:case -1522760979:sa=!0;break;default:sa=!1}return sa};d.prototype.Tc=function(sa,Wa,Hb){switch(Wa){case "PopulateFontColor":Hb.MenuItems=this.sB.Pac(1970784898,-803000997,null,null,-128950598,2036397036,1688184685,862825906,Hb.MenuId);break;case "PopulateFillColor":Hb.MenuItems=this.sB.Pac(1650812936,null,87208751,2063445891,673562736,1457172838,-446735083,1532790410,Hb.MenuId);break;case "PopulateBorderColor":Hb.MenuItems=this.sB.Pac(-236759591,
-1803452024,void 0,void 0,void 0,void 0,void 0,46555851,Hb.MenuId);break;case "PopulateBorderStyle":this.borderFormatManager.C4h(Hb);break;case "PopulateFontDropdown":case "PopulateFontRTFDropdown":if(this.an&&(this.fontDropdownHelper.Msj(Hb.MenuId),!this.fontDropdownHelper.Zii()))return!1;Hb.MenuItems=this.fontDropdownHelper.UVe(-1293291468,324978188,-1428968098,Hb.MenuId);break;default:return!1}return!0};d.prototype.uic=function(sa,Wa){var Hb=Wb.g(this.$).ha.sa.selectedRanges;return!(new ra.a(this.$.xa)).zm(sa,
Wa,Hb,this.gridView)};d.prototype.Kb=function(sa,Wa){var Hb=this,Yb=this.gridView,Sb=sa.command,lb=z.TaskExtensions.kk(),wb=!0;switch(Sb){case -1077965542:wb=this.D5e(Wa,sa,!1);break;case 909774670:this.Lpb(Sb);wb=this.D5e(Wa,sa,!0);break;case -1293291468:wb=this.B5e(Wa,sa,!1);break;case 324978188:y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&F.ULS.sendTraceTag(574650248,0,50,"GridCommandHandler.HandleRibbonCommand: Handle font name preview");this.Lpb(Sb);wb=
this.B5e(Wa,sa,!0);break;case 862890474:case 963349338:wb=this.X3h(sa);break;case -1832800737:wb=this.rdc(Sb,Wa,!1,sa);break;case 1970784898:wb=this.rdc(Sb,Wa,!1,sa);break;case -803000997:wb=this.rdc(Sb,Wa,!1,sa);break;case -128950598:case 1688184685:this.Lpb(Sb);wb=this.rdc(Sb,Wa,!0,sa);break;case 1597684571:wb=this.Uwb(Sb,Wa,!1,sa);break;case 87208751:Wa.Color="-1";Wa.IntColor=!0;wb=this.Uwb(Sb,Wa,!1,sa);break;case -446735083:this.Lpb(Sb);Wa.Color="-1";Wa.IntColor=!0;wb=this.Uwb(Sb,Wa,!0,sa);break;
case 1650812936:wb=this.Uwb(Sb,Wa,!1,sa);break;case 673562736:this.Lpb(Sb);wb=this.Uwb(Sb,Wa,!0,sa);break;case -1904244080:case -1428968098:case 1457172838:case 2036397036:y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(sa=Ba.b().Xh(Sb),F.ULS.sendTraceTag(537159510,0,50,"GridCommandHandler.HandleRibbonCommand: Handle "+sa));this.fUf(Sb);break;case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:wb=this.H3h(Sb,sa);break;case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:wb=
this.P2h(Sb,sa);break;case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:wb=this.x4h(Sb,sa);break;case -1803452024:case -236759591:wb=this.Thd(Sb,Wa,sa);break;case -2118943501:wb=this.borderFormatManager.$2h(Wa,sa);break;case 1012765228:wb=this.borderFormatManager.R4h(Wa,sa);break;case 1256700402:wb=this.borderFormatManager.Xhd(sa);break;case -1756763834:wb=this.borderFormatManager.Yhd(sa);break;case -1418159950:wb=this.borderFormatManager.p5e(sa);break;
case -1920201820:case -1942512156:wb=this.Y3h(Sb,sa);break;case -1690267012:case -600086683:case 165054436:case 1981714220:case -556441918:wb=this.borderFormatManager.b5e(Wa,sa);this.WAh(Wa);break;case 1890566896:case 1886928607:case -992833457:case 218524921:case 996232352:wb=this.t4h(Sb,Wa,sa);break;case -693675336:case 322710748:break;case 1696566924:wb=this.I3h(sa);break;case -167499203:case -255094134:case 1097660126:case 155820588:lb=this.handleMergeCellsCommand(this.gridView,sa);break;case 1896159024:case -1554384558:Wa=
this.gridView.ha.sa.selectedRanges;if(this.ozj(sa,Wa))F.ULS.sendTraceTag(574993492,0,50,"GridCommandHandler.HandleRibbonCommand: showing InsertDeleteCellsDialog"),(new f(this.$,Sb,Wa)).qg(),wb=!0;else if(J.a.any(Wa,function(Oa){return Hb.gridView.Ab.CMa(Oa)})){Yb="";lb=1461300262;var wa=-1554384558===Sb&&this.gridView.Ab.kmi(Wa[0]);Wa=Wa[0].height>Wa[0].width&&!wa;switch(Sb){case 1896159024:Yb=Wa?"InsertColumnsTable":"InsertRowsTable";lb=Wa?622604322:942362098;break;case -1554384558:Yb=Wa?"DeleteColumnsTable":
"DeleteRowsTable",lb=Wa?284490184:1405456548}Wa=ja.a.Tp(d.Uld,Yb,1);new oa.a(lb,1,2,6,null);lb=this.insertOrDeleteCells(Wa,sa,!0)}else lb=this.insertOrDeleteCells(1896159024===Sb?1:2,sa,!1);break;case 942362098:case 622604322:case 1405456548:case 284490184:lb=this.insertOrDeleteCells(ja.a.Tp(d.Uld,Wa[xa.a.Mc],1),sa,!0);break;case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:lb=this.insertOrDeleteCells(ja.a.Tp(d.Uld,Wa[xa.a.Mc],1),sa,!1);break;case 504848446:lb=Yb.startEdit(!1,
1,Wa[ea.a.event],void 0,void 0,!0);break;case 1504715724:if(Wb.g(this.$).kz&&this.borderFormatManager.JU.gB)break;lb=Yb.startEdit(!0,0,Wa[ea.a.event],void 0,void 0,!0);break;case 1872288872:this.yqb();break;case 41465729:lb=this.fill(Yb.ha.sa.Vc,null,0,1,sa);break;case -1451655532:case 1972143101:lb=this.fillDownAbsoluteValueAndStartEdit(Yb,Wa[ea.a.event],-1451655532===Sb);break;case -475861485:lb=this.fill(Yb.ha.sa.Vc,null,Yb.rtl?1:2,1,sa);break;case -978843926:lb=this.fill(Yb.ha.sa.Vc,null,3,1,
sa);break;case 2098035706:lb=this.fill(Yb.ha.sa.Vc,null,Yb.rtl?2:1,1,sa);break;case -2142700828:lb=this.fill(Yb.ha.sourceRange,Yb.ha.sa.Vc,d.gZe(Yb.ha.sa.Vc,Yb.ha.sourceRange),2,sa);break;case 1405660955:lb=this.fill(Yb.ha.sourceRange,Yb.ha.sa.Vc,d.gZe(Yb.ha.sa.Vc,Yb.ha.sourceRange),4,sa);break;case 1983983164:lb=this.fill(Yb.ha.sa.Vc,null,0,0,sa);break;case 478842689:(sa=this.$.da.za(376))?(sa.H4i(),wb=!0):F.ULS.sendTraceTag(537159509,0,15,"gridHighlightBehaviorEventManager is null for TouchAutoFill");
break;case -798660877:case -653661711:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:wb=Yb.ha.Kb(null,Sb);break;case -208772570:this.o4h();wb=!0;break;case -987339782:this.h3h();wb=!0;break;case -1770246794:Yb.ha.i3h();wb=!0;break;case 748067091:case -381232414:this.l3h(Sb);wb=!0;break;case -1522760979:this.gridView.toggleFormulaView();wb=!0;break;case 886009118:lb=this.V3h();break;case 894341014:this.$3h();wb=!0;break;case 862825906:lb=this.T5e(1970784898,sa);break;
case 1532790410:lb=this.T5e(1650812936,sa);break;case 46555851:lb=this.k4h(sa);break;default:wb=!1}wb||(lb=Ha.a(Sb));return lb};d.prototype.WAh=function(sa){sa&&sa.MenuItemId&&["OutsideBorders","AllBorders","ThickOutsideBorders"].includes(sa.MenuItemId)&&y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&this.dQg(new nb.a(this.gridView.ha.sa.activeRange,da.d(this.$.xa.pa)))};d.prototype.dQg=function(sa){z.TaskExtensions.Aa(A.GetServiceTaskFactory.Ra(this.$.da,
426,427,1),function(Wa){Wa.result.dXd(sa,"BorderActions")},this.$.la,3)};d.prototype.ozj=function(sa,Wa){var Hb=this,Yb=J.a.all(Wa,function(wb){return!Hb.gridView.Ab.CMa(wb)}),Sb=1<Wa.length&&!!this.gridView.Ab.Pgd(Wa),lb=J.a.all(Wa,function(wb){return!Hb.gridView.Ab.n5(wb)});Wa=!J.a.any(Wa,function(wb){return wb.isRow||wb.We});return 1===sa.method&&6===sa.Ne&&(Yb||Sb)&&lb&&Wa};d.prototype.fillDownAbsoluteValueAndStartEdit=function(sa,Wa,Hb){var Yb=this,Sb=sa.ha.sa.activeCell,lb=ha.E(Sb,this.gridView.Cs);
return sa.startEdit(!0,0,Wa).Jo(function(){var wb=sa.Ub(lb),wa=sa.Ub(Sb);if(!wb||!wa)return F.ULS.shipAssertTag(537159507,0,!1,"GridCommandHandler.FillDownAbsoluteValueAndStartEdit Cannot get cells for active cell: "+Sb.toString()+" and above cell: "+lb.toString()),ca.Task.Ua(!1);Yb.gridView.Wb.text=Hb?wb.e1:wb.text;Yb.gridView.Wb.textBox.setCaretPositionToEnd();return ca.Task.Ua(!0)})};d.prototype.insertOrDeleteCells=function(sa,Wa,Hb){function Yb(){return new m(Ub)}var Sb=this,lb=S.a.create().toString(),
wb=Enum.toString(P,sa);this.gridView.si.L7(17,lb,wb);wb=this.gridView.ha.sa.selectedRanges;var wa=this.Zgf,Oa=this.Ugf;if(!this.$.iq(null,!1,void 0,Wa.Ne)&&!Oa&&!wa&&5!==sa&&9!==sa)return ca.Task.Ua(!0);2===sa?sa=Oa?10:wa?6:wb[0].height>wb[0].width?18:34:1===sa?sa=Oa?9:wa?5:wb[0].height>wb[0].width?17:33:18===sa&&wa?sa=34:34===sa&&Oa&&(sa=18);wb=this.yJg(wb,sa);if((10===sa||6===sa)&&!this.$.iq(wb,!0,1,Wa.Ne))return ca.Task.Ua(!0);var Ub={};Ub.InsertDeleteRangeItems=Array(wb.length);Ub.SheetName=this.$.pa.sheetName;
Ub.IsTableCommand=Hb;for(Hb=0;Hb<wb.length;Hb++){wa=wb[Hb];var hb={},Xb=Oa=void 0;sa&4?(hb.FirstRow=wa.top-1,hb.LastRow=X.a.Xx,hb.FirstColumn=0,hb.LastColumn=X.a.Zu,Oa=wa.bottom-wa.top+1,Xb=0,6===sa&&(wa.We||(hb.FirstRow=wa.bottom),Oa=-Oa)):sa&8?(hb.FirstRow=0,hb.LastRow=X.a.Xx,hb.FirstColumn=wa.left-1,hb.LastColumn=X.a.Zu,Oa=0,Xb=wa.right-wa.left+1,10===sa&&(wa.isRow||(hb.FirstColumn=wa.right),Xb=-Xb)):sa&16?(hb.FirstRow=wa.top-1,hb.LastRow=wa.bottom-1,hb.FirstColumn=wa.left-1,hb.LastColumn=X.a.Zu,
Oa=0,Xb=wa.right-wa.left+1,18===sa&&(hb.FirstColumn=wa.right,Xb=-Xb)):(hb.FirstRow=wa.top-1,hb.LastRow=X.a.Xx,hb.FirstColumn=wa.left-1,hb.LastColumn=wa.right-1,Oa=wa.bottom-wa.top+1,Xb=0,34===sa&&(hb.FirstRow=wa.bottom,Oa=-Oa));hb={InsertDeleteRange:hb};hb.DeltaRow=Oa;hb.DeltaColumn=Xb;hb.AdjustedSelectedRange=ha.j(wa);Ub.InsertDeleteRangeItems[Hb]=hb}this.gridView.ig.HG(!1);var Gc=y.EwaSettings.isChangeGateEnabled("OfficeVSO:4932761_InsertDeleteCellsDecoupled");Ub.IsDecoupleRecalc=Gc;var uc=this.$.oa.va.Pb();
return va.a(this.$.userOperationManager,function(Nc,Fb,ob){Gc&&!y.EwaSettings.isChangeGateEnabled("OfficeVSO:5316173_RecoverableFromOOM")||Sb.$.py();var zb=Sb.$.oa.va;Nc=V.b(Nc,Sb.zOi);var ib=zb.Na(41,void 0===uc?null:uc);ib.insertDeleteMultiRangeParameters=Ub;return ba.g(zb,"InsertDeleteCells",ib,Nc,Fb,ob,lb,0)},function(Nc){return new bb.a(237,0,Nc,void 0,Yb)},Wa)};d.prototype.yJg=function(sa,Wa){return Wa&32?this.aZa(sa,function(Hb){return Hb.bottom},function(Hb){return Hb.top},function(Hb,Yb){Hb.bottom=
Yb},!1,!0):Wa&16?this.gridView.rtl?this.aZa(sa,function(Hb){return Hb.left},function(Hb){return Hb.right},function(Hb,Yb){Hb.left=Yb},!1,!1):this.aZa(sa,function(Hb){return Hb.right},function(Hb){return Hb.left},function(Hb,Yb){Hb.right=Yb},!1,!1):Wa&4?this.aZa(sa,function(Hb){return Hb.bottom},function(Hb){return Hb.top},function(Hb,Yb){Hb.bottom=Yb},!0,!0):Wa&8?this.gridView.rtl?this.aZa(sa,function(Hb){return Hb.left},function(Hb){return Hb.right},function(Hb,Yb){Hb.left=Yb},!0,!1):this.aZa(sa,
function(Hb){return Hb.right},function(Hb){return Hb.left},function(Hb,Yb){Hb.right=Yb},!0,!1):sa};d.prototype.aZa=function(sa,Wa,Hb,Yb,Sb,lb){sa=ha.d(sa);sa.sort(function(Oa,Ub){return Wa(Ub)-Wa(Oa)});if(Sb){Sb=[];lb=y.EwaSettings.isChangeGateEnabled("OfficeVSO:5181014_DeletingLastTwoRowsColsFix")?lb?X.a.uh+1:X.a.Eh+1:lb?X.a.Xx:X.a.Zu;for(var wb=0;wb<sa.length;wb++){var wa=sa[wb];Hb(wa)<lb&&(Yb(wa,Math.min(Wa(wa),lb-1)),Sb.push(wa),lb=Hb(wa))}sa=Sb}return sa};d.prototype.fill=function(sa,Wa,Hb,Yb,
Sb){function lb(){return new n(Oa,Ub,Yb,Hb)}var wb=this,wa=this.$;if(!wa.iq([Wa],!0))return ca.Task.Ua(!0);var Oa=ha.v(sa,wa),Ub=Wa?ha.v(Wa,wa):Oa,hb=this.$.oa.va.Pb();return va.a(this.$.userOperationManager,function(Xb,Gc,uc){wb.$.py();var Nc=wb.$.oa.va,Fb=Nc.Na(9,hb);Fb.sourceRange=Oa;Fb.targetRange=Ub;Fb.fillDirection=Hb;Fb.fillType=Yb;return ba.g(Nc,"FillRange",Fb,Xb,Gc,uc,null,0)},function(Xb){return new bb.a(155,0,Xb,void 0,lb)},Sb)};d.prototype.t4h=function(sa,Wa,Hb){var Yb={ValidMembers:32};
switch(sa){case 1890566896:sa=parseInt(Wa[xa.a.Mc].toString(),10);if(14===sa)return Hb=new oa.a(2105621672,Hb.method,Hb.mode,Hb.Ne,Hb.tabName),Wa[xa.a.Mc]=null,this.$.Ka.Kb(Hb,Wa),F.ULS.sendTraceTag(537159506,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered NumberFormatDialog command, with menu item 14."),!0;Yb.NumberFormat=sa;break;case 1886928607:Yb.NumberFormat=13;break;case -992833457:Yb.NumberFormat=11;break;case 218524921:Yb.NumberFormat=12;break;case 996232352:Yb.NumberFormat=
1006;break;default:return F.ULS.shipAssertTag(537159505,0,!1,"Unexpected number formatting command "+Ba.b().Xh(Hb.command)),!1}F.ULS.sendTraceTag(537159504,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered "+Ba.b().Xh(Hb.command)+" command, with menu item "+Wa[xa.a.Mc]+".");this.Hg.formatCells(1890566896,Yb,Hb);this.$.hf();return!0};d.prototype.X3h=function(sa){var Wa=this.gridView.Ub(this.gridView.ha.sa.activeCell);if(this.tb&&this.gridView.isEditing){Wa=this.gridView.Gi.e4a(Wa?oc.a(Wa).Font:
null);if(!Wa)return F.ULS.shipAssertTag(537159503,0,!1,"GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: fontType for range "+this.gridView.ha.sa.activeCell.toString()+" is null while editing"),!1;var Hb=Wa.FontSize}else if(Wa)Hb=Wa.fontSize;else return!1;Wa=sa.command;var Yb=0;if(862890474===Wa)for(;Yb<d.FJa.length-1&&d.FJa[Yb]<=Hb;)Yb++;else if(963349338===Wa)for(Yb=d.FJa.length-1;0<Yb&&d.FJa[Yb]>=Hb;)Yb--;F.ULS.sendTraceTag(537159501,0,50,"GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: change font from size "+
Hb+" to size "+d.FJa[Yb]);if(Hb===d.FJa[Yb])return!0;Hb=d.Zvc(2);Hb.Font.FontSize=d.FJa[Yb];this.tb&&this.gridView.isEditing?(this.oob(sa,!1,Hb),this.$.hf()):this.Hg.formatCells(Wa,Hb,sa);return!0};d.prototype.D5e=function(sa,Wa,Hb){sa=sa[sa[N.a.IsFreeForm]?N.a.Value:xa.a.Wf].toString();if(!d.b0i.test(sa))return F.ULS.sendTraceTag(537159499,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command is not a number."),y.EwaSettings.isChangeGateEnabled("OfficeVSO:5115068_FontSizeCommandHandledForInvalidParameter")?
!0:!1;sa=parseFloat(sa);if(8>sa||72<sa)return F.ULS.sendTraceTag(537159497,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command is not within expected limits (8 - 72)."),y.EwaSettings.isChangeGateEnabled("OfficeVSO:5115068_FontSizeCommandHandledForInvalidParameter")?!0:!1;var Yb=Math.round(2*sa)/2,Sb=d.Zvc(2);Sb.Font.FontSize=Yb;this.tb&&this.gridView.isEditing?(this.oob(Wa,Hb,Sb,!0),Yb===sa||Hb||this.$.hf()):Hb?this.Hg.Zda(this.gridView,-1077965542,Sb,Hb):(this.Hg.formatCells(-1077965542,
Sb,Wa),this.X_a());return!0};d.prototype.B5e=function(sa,Wa,Hb){var Yb=sa[xa.a.Wf];if(this.an){var Sb=this.fontDropdownHelper.szc?this.fontDropdownHelper.szc[Yb]:null;Sb||(F.ULS.sendTraceTag(523903201,1,15,"GridCommandHandler.HandleFontFamilyCommand: font in supportedFontFamiliesNew is not found for "+Yb),Sb=Ea.HelperMethods.jS[Yb])}else Sb=Ea.HelperMethods.jS[Yb];var lb=0;this.Am&&(sa=sa.MenuItemId,sa===Ia.b?(Yb==this.themesManager.lL.Kqf&&(Sb=Yb),lb=2):sa===Ia.a&&(Yb==this.themesManager.lL.$of&&
(Sb=Yb),lb=1));if(!Sb)return!0;Yb=d.Zvc(1);Yb.Font.FontName=Sb;this.Am&&(Yb.Font.FontScheme=lb);this.tb&&this.gridView.isEditing?(this.oob(Wa,Hb,Yb),this.$.hf()):Hb?this.Hg.Zda(this.gridView,-1293291468,Yb,Hb):(this.Hg.formatCells(-1293291468,Yb,Wa),this.X_a());return!0};d.prototype.rdc=function(sa,Wa,Hb,Yb){var Sb=-803000997===sa||1688184685===sa?"black":Wa.Color;this.moreColorsHelper&&(-1832800737===sa?Sb=Aa.a.compare(Sb,"WindowText",!0)?this.moreColorsHelper.QHb:"black":Hb||(this.moreColorsHelper.QHb=
Sb,this.moreColorsHelper.fda(Wa,Sb,Yb)));sa=d.Zvc(32);sa.Font.FontColor=Ma.a.XG(Sb,ja.a.vg(Wa,"IntColor"));this.tb&&this.gridView.isEditing?this.oob(Yb,Hb,sa,17===Yb.Ne):Hb?this.Hg.Zda(this.gridView,1970784898,sa,Hb):(this.KC&&(Hb=this.getThemeColor(Wa),Wa=Hb.themeColor,Hb.returnValue&&(sa.Font.ThemeFontColor=Wa,sa.Font.ColorTypeOption=1)),this.Hg.formatCells(1970784898,sa,Yb),this.X_a());return!0};d.prototype.l3h=function(sa){var Wa=(new Date).format(748067091===sa?this.$.ya.ShortDateFormat:this.$.ya.ShortTimeFormat),
Hb=this.gridView.pj?Za.a(this.gridView.$):this.gridView.Wb;sa=Hb.textBox;if(this.gridView.isEditing)Hb.insertText(Wa);else{var Yb=y.EwaSettings.isChangeGateEnabled("OfficeVSO:6336696_ChangeEditingModeAfterInsertDateOrTime")?0:1;this.gridView.startEdit(!0,Yb);Hb.text=Wa;Wa=Wa.length;sa.xRa(Wa);sa.caretPosition=Wa}};d.prototype.o4h=function(){this.gridView.UQ(this.gridView.ha.sa.activeCell)||this.gridView.uvc||this.gridView.yMa()||this.gridView.er(this.gridView.ha.sa.activeCell,3,yb.a.M4e)};d.prototype.h3h=
function(){if(!(this.gridView.uvc||this.gridView.yMa()||this.gridView.isEditing&&T.a.isMac)){var sa=this.gridView.ha.sa.i4;this.gridView.hg(ha.v(sa,this.$),sa,null,null,60,yb.a.M4e)}};d.prototype.I3h=function(sa){var Wa=this;this.M$b=da.d(this.$.xa.pa);var Hb=this.$.da.za(254,!0);if(this.gridView.v6a)return this.gridView.ig.HG(!1),!!Hb;if(!Hb)return F.ULS.sendTraceTag(537159494,0,50,"GridCommandHandler.HandleFormatPainter : copyPasteInfrastructure is null"),!1;this.gridView.ha.qY(this.Fbd);var Yb=
String.format(ea.a.vta,Ua.a.current.So(105));this.gridView.ig.wo(Yb);sa=new oa.a(-911352779,sa.method,sa.mode,sa.Ne,sa.tabName);Yb={};this.$.Ka.Kb(sa,(Yb[ea.a.silentClipboardAccessFailures]=!0,Yb[ea.a.isFormatPainter]=!0,Yb)).continueWith(function(Sb){(6>Sb.status||6===Sb.status&&!Sb.result)&&Wa.yqb()});this.gridView.v6a=!0;Hb.xHg(this.yqb);return!0};d.prototype.Uwb=function(sa,Wa,Hb,Yb){var Sb=87208751===sa?"-1":Wa.Color;this.moreColorsHelper&&(1597684571===sa?Sb=this.moreColorsHelper.Yab:Hb||(this.moreColorsHelper.Yab=
Sb===d.notSet?d.YWd:Sb,this.moreColorsHelper.fda(Wa,Sb,Yb)));sa={ValidMembers:64};sa.FillColor=Ma.a.XG(Sb,ja.a.vg(Wa,"IntColor"));Hb?this.Hg.Zda(this.gridView,1650812936,sa,!0):(this.KC&&(Hb=this.getThemeColor(Wa),Wa=Hb.themeColor,Hb.returnValue&&(sa.ThemeFillColor=Wa,sa.ColorTypeOption=1)),this.Hg.formatCells(1650812936,sa,Yb),this.X_a());return!0};d.prototype.$3h=function(){F.ULS.sendTraceTag(537159493,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Started handling the command");var sa=
this.$.da.za(221);if(sa){var Wa=this.gridView.Gi;if(Wa){var Hb=sa.cdi(Wa.text,Wa.textBox.caretPosition);var Yb=Hb.Vrf;var Sb=Hb.QTe;(Hb=Hb.returnValue)?(sa.isListVisible=!1,Wa.text=Hb,Wa.textBox.selectRange(Yb,Yb+Sb),F.ULS.sendTraceTag(587534607,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell InsertFormulaArguments executed successfully")):F.ULS.sendTraceTag(537159490,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Can't insert formula arguments with current text and caret position.")}else F.ULS.shipAssertTag(537159491,
0,!1,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No editor object")}else F.ULS.sendTraceTag(537159492,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No formulaAssistanceControl object")};d.prototype.H3h=function(sa,Wa){var Hb=0,Yb=this.gridView,Sb=oc.a(Yb.Ub(null));this.tb&&Yb.isEditing&&(Sb.Font=Yb.Gi.e4a(Sb.Font));var lb=Sb.Font;lb||(lb={ValidMembers:0});switch(sa){case -287251124:Hb|=4;ma.e(lb,4)?lb.Bold=!lb.Bold:lb.Bold=!0;break;case -1925065947:Hb|=8;ma.e(lb,8)?lb.Italic=
!lb.Italic:lb.Italic=!0;break;case 1764140053:Hb|=16;ma.e(lb,16)?lb.Underline=!lb.Underline:lb.Underline=!0;break;case -1685033574:Hb|=64;ma.e(lb,64)?lb.DoubleUnderline=!lb.DoubleUnderline:lb.DoubleUnderline=!0;break;case -1590502662:Hb|=128,ma.e(lb,128)?lb.Strikethrough=!lb.Strikethrough:lb.Strikethrough=!0}if(!Hb)return!1;lb.ValidMembers=Hb;Sb.Font=lb;Sb.ValidMembers=16;this.tb&&this.gridView.isEditing?this.oob(Wa,!1,Sb):(y.EwaSettings.ma(658)||Yb.ig.HG(!1),this.Hg.formatCells(sa,Sb,Wa));this.$.hf();
return!0};d.prototype.P2h=function(sa,Wa){var Hb=0,Yb=this.gridView,Sb=oc.a(Yb.Ub(null));-571165336===sa||1041132226===sa||-394785302===sa?(Hb|=1,Sb.VerticalAlignment=ja.a.Tp(d.iZa,sa.toString(),2)):d.Lji(sa)?(Hb|=2,this.S3h(Sb,sa)):-1116189897===sa&&(Hb|=8,Sb.Wrap=Sb.ValidMembers&8?!Sb.Wrap:!0);if(!Hb)return!1;Sb.ValidMembers=Hb;y.EwaSettings.ma(658)||Yb.ig.HG(!1);this.Hg.formatCells(sa,Sb,Wa);this.$.hf();return!0};d.prototype.S3h=function(sa,Wa){!y.EwaSettings.isChangeGateEnabled("OfficeVSO:5049785_DisableTextAlignmentCommandFlipInRTL")&&
this.$.isChromeRtl&&-1142465846!==Wa&&(Wa=-1150205178===Wa?-286432209:-1150205178);Wa=ja.a.Tp(d.iZa,Wa.toString(),0);sa.HorizontalAlignment=Wa===sa.HorizontalAlignment?0:Wa};d.prototype.QJf=function(sa,Wa,Hb,Yb){var Sb=this,lb=!1;y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1)&&(lb=this.vlc.nqf(Wa,Hb))&&Wb.g(this.$).si.P0(this.V8a,eb.BasicTelemetryCalculator.KQ);return this.rtb(sa,Wa,!1,lb,function(wb){Sb.HPi(wb,Hb,Wa,lb,Yb)})};d.prototype.handleMergeCellsCommand=
function(sa,Wa){var Hb=this;this.V8a=S.a.create().toString();var Yb=null;Yb=this.vlc.R_e();var Sb=ia.a(Wa.command),lb=this.vlc.Ghi(Wa.command,Yb),wb=y.EwaSettings.isChangeGateEnabled("OfficeVSO:5855030_MergeCellLogTelemetryForDataLossScenario"),wa=0;wb&&lb?wa=G.a.Qd():Wb.g(this.$).si.L7(4,this.V8a,Sb+", Scenario = "+Yb.scenario.toString());Sb=sa.ha.sa.selectedRanges;F.ULS.sendTraceTag(537159459,0,50,"GridCommandHandler.HandleMergeCellsCommand: Merge Command: "+Ba.b().Xh(Wa.command)+", Number of ranges: "+
Sb.length+", Ranges: "+ha.i(Sb,",",this.$,!1));Sb=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1);sa.ig.HG(!1,Sb);if(10===ja.a.Tp(d.pqf,Wa.command.toString(),10))return ca.Task.Ua(!1);var Oa=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1);if(Sb&&Oa)return lb?(wb?this.eSd(Yb,Wa,!0,!0,wa):this.eSd(Yb,Wa,!0),ca.Task.Ua(!0)):this.QJf(sa,Wa,Yb,!1);var Ub=!1;Sb&&(Ub=this.vlc.nqf(Wa,Yb))&&Wb.g(this.$).si.P0(this.V8a,
eb.BasicTelemetryCalculator.KQ);return this.rtb(sa,Wa,!1,Ub,function(hb){Hb.IPi(hb,Wa,Ub)})};d.prototype.rtb=function(sa,Wa,Hb,Yb,Sb){function lb(Gc,uc,Nc){Oa.$.py();Gc=Sb?V.b(Gc,Sb):Gc;Gc=V.b(Gc,wb);return ba.d(Oa.$.oa.va,hb,Xb,Hb,Gc,uc,Nc,null,Ub)}function wb(Gc){var uc=!!Gc&&!!Gc.RequestTelemetryData;Wb.g(Oa.$).si.tla(Oa.V8a,Gc.StateId,uc?Gc.RequestTelemetryData.EcsOperationDuration:0,uc?Gc.RequestTelemetryData.EcsRequestDuration:0,uc?Gc.RequestTelemetryData.WfeRequestDuration:0)}function wa(){return new Z.a(hb,
Xb)}var Oa=this;Sb=void 0===Sb?null:Sb;var Ub=this.$.oa.va.Pb(),hb=ja.a.Tp(d.pqf,Wa.command.toString(),10),Xb=ha.r(sa.ha.sa.selectedRanges,sa.$);return Yb?y.EwaSettings.Zb()?va.a(this.$.userOperationManager,lb,function(Gc){return new bb.a(156,0,Gc,64,wa)},Wa):va.a(this.$.userOperationManager,lb,function(Gc){return new ya.a(156,0,Gc,void 0,wa)},Wa):va.a(this.$.userOperationManager,lb,function(Gc){return new bb.a(156,0,Gc,void 0,wa)},Wa)};d.prototype.eSd=function(sa,Wa,Hb,Yb,Sb){var lb=this;Yb=void 0===
Yb?!1:Yb;Sb=void 0===Sb?0:Sb;F.ULS.sendTraceTag(537159457,0,50,"Merge cells with multiple values. isCalledBeforeCSE :- "+Hb);var wb=Wb.g(this.$).rtl,wa=y.EwaSettings.isChangeGateEnabled("OfficeVSO:5855030_MergeCellLogTelemetryForDataLossScenario");wb=ta.a.Xc(3,2,0,wb?638:637,0,514846606,"MergeCellsLoseData");z.TaskExtensions.Aa(Jb.a(this.$).gj(wb),function(Oa){Oa=Oa.result;if(Yb){var Ub=G.a.Qd()-Sb;F.ULS.sendTraceTag(528779355,0,50,"Time taken to show Dialog in Data Loss Scenario is : "+Ub+", and the user action is : "+
Oa)}0===Oa?(F.ULS.sendTraceTag(537159456,0,50,"MergeCellsLoseData Dialog: Ok pressed"),Hb?(Yb&&wa&&(Oa=ia.a(Wa.command),Wb.g(lb.$).si.L7(4,lb.V8a,Oa+", Scenario = "+sa.scenario.toString())),lb.QJf(Wb.g(lb.$),Wa,sa,!0)):lb.rtb(lb.gridView,Wa,!0,!1)):1===Oa&&F.ULS.sendTraceTag(537159455,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},this.$.la,11)};d.prototype.Cvi=function(sa,Wa,Hb,Yb){Wa!==sa&&F.ULS.sendTraceTag(537159454,0,15,"MergeCellsLoseData flag as per client and server does not match. MergeCellsLoseData flag as per client is :- "+
Wa+" and as per server is "+sa+". The scenario is:- "+Hb+", The CSE is done:- "+Yb)};d.prototype.IPi=function(sa,Wa,Hb){var Yb=this;aa.b(sa,514846606)&&(F.ULS.sendTraceTag(537159453,0,50,"Merge cells with multiple values"),la.a(this.$).dd.eJ(514846606),sa=Wb.g(this.$).rtl,sa=ta.a.Xc(3,2,0,sa?638:637,0,514846606,"MergeCellsLoseData"),z.TaskExtensions.Aa(Jb.a(this.$).gj(sa),function(Sb){Sb=Sb.result;0===Sb?(F.ULS.sendTraceTag(537159452,0,50,"MergeCellsLoseData Dialog: Ok pressed"),Yb.rtb(Yb.gridView,
Wa,!0,Hb)):1===Sb&&F.ULS.sendTraceTag(537159451,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},this.$.la,11))};d.prototype.HPi=function(sa,Wa,Hb,Yb,Sb){var lb=this,wb=!1;aa.b(sa,514846606)&&(wb=!0,la.a(this.$).dd.eJ(514846606),Yb&&Sb?window.setTimeout(function(){lb.rtb(lb.gridView,Hb,!0,!0)},0):this.eSd(Wa,Hb,!1));this.Cvi(wb,Sb,Wa.scenario,Yb)};d.prototype.Lpb=function(sa){var Wa=y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");if(Wa&&this.v_a!==sa&&1461300262!==
this.v_a){this.fUf(this.v_a);var Hb=Ba.b().Xh(sa),Yb=Ba.b().Xh(this.v_a);F.ULS.sendTraceTag(537159450,0,50,"GridCommandHandler.CacheFontStyles: Style cached during "+Yb+" was restored before caching the style for "+Hb+" command.")}Wa&&(this.v_a=sa);if(this.tb&&this.gridView.isEditing)this.s_a||(this.s_a=this.gridView.Gi.formattedText);else if(!this.wA){this.wA=[];Wa=this.gridView.Y$("GridCommandHandler.CacheFontStyles",this.gridView.ha.sa.selectedRanges);try{for(Wa.$$rst();Wa.$$mn();){var Sb=Wa.$$cu(),
lb=Sb.cell.hasRichText;if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var wb=Ba.b().Xh(sa);F.ULS.sendTraceTag(537159449,0,100,"GridCommandHandler.CacheFontStyles: Add CachedPreviewCellGroup following "+wb+" command. isRichText("+lb+"). Cache size is "+this.wA.length)}if(lb)this.wA.push(v.wSg(Sb,Sb.cell.formattedText));else switch(sa){case 673562736:case -446735083:this.wA.push(v.YYc(Sb,Sb.backgroundColor));y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
!Sb.backgroundColor&&F.ULS.sendTraceTag(537159448,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null BackgroundColor. isNull("+!Sb.backgroundColor+")");break;case -128950598:case 1688184685:this.wA.push(v.YYc(Sb,Sb.color));y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!Sb.color&&F.ULS.sendTraceTag(537159447,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null Color. isNull("+!Sb.color+")");break;case 909774670:this.wA.push(v.xSg(Sb,Sb.fontSize));
if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var wa=ka.c(Sb.fontSize)?"null or undefined":Sb.fontSize.toString();F.ULS.sendTraceTag(537159446,0,100,"GridCommandHandler.CacheFontStyles: cached font size is "+wa)}break;case 324978188:this.Am?this.wA.push(v.vSg(Sb,Sb.fontName,Sb.Maa)):this.wA.push(v.YYc(Sb,Sb.fontName)),y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(Sb.fontName?F.ULS.sendTraceTag(537159444,0,50,"GridCommandHandler.CacheFontStyles: cached FontName is ("+
gridRenderer.CanvasRendererGlobals.getFontNameForLogging(Sb.fontName)+") of length("+Sb.fontName.length+")."):F.ULS.sendTraceTag(537159445,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null FontName. isNull("+!Sb.fontName+")"))}}}finally{Wa&&Wa.dispose()}}};d.prototype.IDj=function(){return this.tb&&this.gridView.isEditing?!this.s_a:!this.wA};d.prototype.ygi=function(sa){return!!this.wA&&this.wA.length>sa&&!!this.wA[sa].formattedText};d.prototype.Aac=function(sa){return this.wA[sa].style};
d.prototype.VKh=function(sa){return this.wA[sa].size};d.prototype.UKh=function(sa){return this.wA[sa].Maa};d.prototype.fUf=function(sa){if(this.IDj())y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&F.ULS.sendTraceTag(537159443,0,100,"GridCommandHandler.RestoreCachedStyles: Nothing to restore following "+sa+" command.");else{if(this.tb&&this.gridView.isEditing)y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(sa=Ba.b().Xh(sa),
F.ULS.sendTraceTag(537159442,0,50,"GridCommandHandler.RestoreCachedStyles: Restore style following "+sa+" command. Formatted text is enabledand IsEditing is true.")),this.s_a&&(this.gridView.Wb.formattedText=this.s_a);else for(var Wa=this.wA.length,Hb=0;Hb<Wa;Hb++){var Yb,Sb=this.wA[Hb].fja.cell.getRange();if(Yb=this.gridView.Ub(Sb)){Sb=void 0;var lb=Yb.aF?this.gridView.wKb(Yb.range):(Sb=new U.a,Sb.add(Yb),Sb);Sb=ik(lb);for(lb=Sb.next();!lb.done;lb=Sb.next()){lb=lb.value;if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var wb=
Ba.b().Xh(sa);F.ULS.sendTraceTag(537159440,0,100,"GridCommandHandler.RestoreCachedStyles: Restore style following "+wb+" command. formattedCell.Cell.HasRichText("+lb.cell.hasRichText+"). Cached item "+Hb+". isMerge("+Yb.aF+"). Cache size is "+Wa)}if(lb.cell.hasRichText&&1457172838!==sa)this.ygi(Hb)&&(lb.cell.formattedText=this.wA[Hb].formattedText,y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!lb.cell.formattedText&&F.ULS.sendTraceTag(537159439,0,100,"GridCommandHandler.RestoreCachedStyles: Setting FormattedText to null."));
else switch(sa){case 1457172838:lb.backgroundColor=this.Aac(Hb);y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!lb.backgroundColor&&F.ULS.sendTraceTag(537159438,0,100,"GridCommandHandler.RestoreCachedStyles: Setting BackgroundColor to be empty or null. isNull("+!lb.backgroundColor+").");break;case 2036397036:lb.color=this.Aac(Hb);y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!lb.color&&F.ULS.sendTraceTag(537159437,0,100,
"GridCommandHandler.RestoreCachedStyles: Setting Color to be empty or null. isNull("+!lb.color+").");break;case -1904244080:lb.fontSize=this.VKh(Hb);y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(lb=ka.c(lb.fontSize)?"null or undefined":lb.fontSize.toString(),F.ULS.sendTraceTag(537159436,0,100,"GridCommandHandler.RestoreCachedStyles: Setting font size to "+lb));break;case -1428968098:wb=y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation"),
this.Am?(lb.rLb(this.Aac(Hb),wb,"RestoreCachedStyles"),lb.d_f(this.UKh(Hb))):lb.rLb(this.Aac(Hb),wb,"RestoreCachedStyles")}}}else F.ULS.sendTraceTag(537159441,0,50,"GridCommandHandler.RestoreCachedStyles: Cell is not supposed to be null. Cell range: "+Sb.aB(!1))}y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(this.v_a=1461300262);this.X_a()}};d.prototype.X_a=function(){this.tb&&this.gridView.isEditing?this.s_a=null:this.wA=null;y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
F.ULS.sendTraceTag(537159435,0,50,"GridCommandHandler.ClearCachedStyles: Cache cleared.")};d.prototype.Y3h=function(sa,Wa){var Hb={IndentationIncrease:0};if(-1942512156===sa)Hb.IndentationIncrease=1;else if(-1920201820===sa)Hb.IndentationIncrease=-1;else return!0;Hb.ValidMembers=256;this.Hg.formatCells(sa,Hb,Wa);return!0};d.prototype.x4h=function(sa,Wa){var Hb=sa;!Wb.g(this.$).rtl||-1649235364!==sa&&524773427!==sa||(Hb=-1649235364===sa?524773427:-1649235364);switch(Hb){case -1649235364:Hb=X.a.rotateTextUp45;
break;case 524773427:Hb=X.a.wuc;break;case 1886217042:Hb=X.a.rotateTextUp90;break;case 928057943:Hb=X.a.yuc;break;case -1526602249:Hb=X.a.verticalText;break;default:return!1}var Yb={ValidMembers:512};Yb.TextOrientation=Hb;this.Hg.formatCells(sa,Yb,Wa);return!0};d.prototype.V3h=function(){var sa=this,Wa=Wb.g(this.$),Hb=ha.r(Wa.ha.sa.selectedRanges,this.$),Yb=ha.o(Wa.ha.sa.activeCell,this.$);F.ULS.sendTraceTag(42566215,0,50,"GridCommandHandler: HandleIgnoreErrorCommand Invoked.");return va.a(this.$.userOperationManager,
function(Sb,lb,wb){return fa.q(sa.$.oa.va,Yb,Hb,Sb,lb,wb,null)},function(Sb){return new bb.a(201,0,Sb)},null)};d.prototype.T5e=function(sa,Wa){var Hb=null,Yb=Wb.g(this.$).ha.sa.selectedRanges;Yb=this.gridView.Y$("MoreColors",Yb,1,!0);try{for(Yb.$$rst();Yb.$$mn();){var Sb=Yb.$$cu().cell;if(Sb){var lb=d.black;if(1970784898===sa)lb=Sb.color;else if(1650812936===sa){var wb=Sb.backgroundColor;lb=Aa.a.compare(wb,d.YWd,!0)&&Aa.a.compare(wb,d.empty,!0)?Sb.backgroundColor:d.white}if(!Hb)Hb=lb;else if(Hb!==
lb){Hb=d.black;break}}}}finally{Yb&&Yb.dispose()}this.tb&&this.gridView.isEditing&&1970784898===sa&&this.gridView.Gi.textBox.aue();return this.moreColorsHelper.Exa(sa,Wa,Hb)};d.prototype.k4h=function(sa){var Wa=I.a.w4a(this.borderFormatManager.s3);return this.moreColorsHelper.Exa(-236759591,sa,Wa)};d.prototype.oob=function(sa,Wa,Hb,Yb){var Sb=this;Yb=void 0===Yb?!1:Yb;Wa?this.gridView.Gi.SIf(Hb.Font):(this.Jxi(sa),Yb?window.requestAnimationFrame(function(){K.FocusManager.instance().Ij(L.AFrame.jaa);
Sb.gridView.Gi.WUe(Hb.Font)}):(K.FocusManager.instance().Ij(L.AFrame.jaa),this.gridView.Gi.WUe(Hb.Font)),this.X_a())};d.prototype.Jxi=function(sa){var Wa=ia.a(sa.command);sa=O.a[sa.Ne]+"_"+B.a[sa.method];var Hb=this.gridView.$b.wxe.toString(),Yb=new Map;Yb.set("Command",Wa);Yb.set("Source",sa);Yb.set("Ribbon","React");Yb.set("CellTextRuns",Hb);Q.Health.instance.recordKpiUsage($a.a.mEh,0,dc.a.HUf,Yb)};d.prototype.Thd=function(sa,Wa,Hb){sa=this.borderFormatManager.Thd(sa,Wa,Hb);this.moreColorsHelper&&
this.moreColorsHelper.fda(Wa,this.borderFormatManager.s3,Hb);return sa};d.prototype.getThemeColor=function(sa){var Wa={};var Hb=!1;if((sa.SqmControlId||"").includes("ThemeColorPicker")){if(!this.themesManager)return F.ULS.sendTraceTag(537159433,0,10,"GridCommandHandler.GetThemeColor: Themes Manager is null"),{returnValue:!1,themeColor:Wa};Hb=this.themesManager.getThemeColor(sa.Color);sa=Hb.themeIndex;var Yb=Hb.qBa;if(Hb=Hb.returnValue)Wa.ThemeColorIndex=sa,Wa.ThemeColorRow=Yb}return{returnValue:Hb,
themeColor:Wa}};d.Lji=function(sa){return-1150205178===sa||-1142465846===sa||-286432209===sa};d.Zvc=function(sa){var Wa={},Hb={};Wa.ValidMembers=16;Wa.Font=Hb;Hb.ValidMembers=sa;return Wa};d.gZe=function(sa,Wa){var Hb=sa.top<Wa.top?3:sa.bottom>Wa.bottom?0:-1;return Hb=sa.left<Wa.left?1:sa.right>Wa.right?2:Hb};of.Object.defineProperties(d.prototype,{Zgf:{configurable:!0,enumerable:!0,get:function(){return J.a.all(this.gridView.ha.sa.selectedRanges,function(sa){return sa.isRow})}},Ugf:{configurable:!0,
enumerable:!0,get:function(){return J.a.all(this.gridView.ha.sa.selectedRanges,function(sa){return sa.We})}},themesManager:{configurable:!0,enumerable:!0,get:function(){this.ex||(this.ex=this.$.da.za(422));return this.ex}}});of.Object.defineProperties(d,{b0i:{configurable:!0,enumerable:!0,get:function(){return d.Pde||(d.Pde=RegExp("^[0-9]+[.]?[0-9]*$"))}},Uld:{configurable:!0,enumerable:!0,get:function(){var sa={};return d.x8d||(d.x8d=(sa.InsertRows=5,sa.InsertColumns=9,sa.InsertCellsShiftRight=17,
sa.InsertCellsShiftDown=33,sa.DeleteRows=6,sa.DeleteColumns=10,sa.DeleteCellsShiftLeft=18,sa.DeleteCellsShiftUp=34,sa.DeleteRowsTable=6,sa.DeleteColumnsTable=10,sa.InsertRowsTable=5,sa.InsertColumnsTable=9,sa))}},iZa:{configurable:!0,enumerable:!0,get:function(){var sa={};return d.Pgb||(d.Pgb=(sa["-394785302"]=0,sa["-571165336"]=2,sa["1041132226"]=1,sa["-1150205178"]=1,sa["-1142465846"]=2,sa["-286432209"]=3,sa))}},pqf:{configurable:!0,enumerable:!0,get:function(){var sa={};return d.gbe||(d.gbe=(sa["-167499203"]=
2,sa["-255094134"]=5,sa["1097660126"]=6,sa["155820588"]=7,sa))}}});d.YWd="transparent";d.notSet="-1";d.black="#000000";d.empty="";d.white="#FFFFFF";d.x8d=null;d.Pgb=null;d.gbe=null;d.Pde=null;d.FJa=[8,9,10,11,12,14,16,18,20,24,26,28,36,48,72];Object(t.a)(d,"GridCommandHandler",null,[401]);var Na=H.a;$k(c,Na);c.prototype.zd=function(){var sa=this,Wa=A.GetServiceTaskFactory.create(this.$.da,111,this.la,this.hb),Hb=A.GetServiceTaskFactory.create(this.$.da,18,this.la,this.hb),Yb=A.GetServiceTaskFactory.create(this.$.da,
397,this.la,this.hb),Sb=A.GetServiceTaskFactory.Ra(this.$.da,502,503,this.hb);if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")){var lb=A.GetServiceTaskFactory.Ra(this.$.da,296,468,this.hb);z.TaskExtensions.Aa(z.TaskExtensions.Vd([Wa,Hb,Yb,lb,Sb],this.la),function(){sa.jd([new d(sa.$,Wb.g(sa.$),Hb.result,Wa.result,lb.result,Yb.result,Sb.result)])},this.la,3)}else{var wb=A.GetServiceTaskFactory.create(this.$.da,102,this.la,this.hb);z.TaskExtensions.Aa(z.TaskExtensions.Vd([Wa,
Hb,wb,Yb,Sb],this.la),function(){sa.jd([new d(sa.$,Wb.g(sa.$),Hb.result,Wa.result,new w.BorderFormatManager(sa.$,Hb.result,wb.result),Yb.result,Sb.result)])},this.la,3)}};c.ka=function(sa){H.a.Pd(80,new c(sa))};Object(t.a)(c,"GridCommandHandlerFactory",H.a,[]);b.d(E,"a",function(){return a})},1386:function(t,E,b){function a(){Type.registerNamespace("Common.App.GestureManager");c.main()}function c(){this.fb=null;this.Ww=!1}function d(B,Q){var U=K.call(this)||this;U.lqa=u.a.eIh;U.ZOc=!!window.PointerEvent;
U.xie=window.hasOwnProperty("ontouchstart");U.Hkb=null;U.XVa=null;U.W8=!1;U.fT=new A.a;U.$kb=new A.a;U.Zpg=new m.a;U.Ipa=null;U.xmb=!1;U.u3d=!1;U.Xee=!1;U.UMc=!1;U.nGc=!1;U.o3d=!1;U.rJc=!1;U.$Ua=!1;U.jkb=-1;U.HRc=null;U.session=null;U.handlers=null;U.element=null;U.curRecognizer=null;U.Jd=N.EventHandlerManager.instance;U.ZOc?(v.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),U.Hkb=Object(x.a)(U,U.poc,"onPointerEvent"),U.XVa=H.a.gIh):U.xie?(v.ULS.sendTraceTag(593893140,310,50,"Using touch events"),
U.Hkb=Object(x.a)(U,U.Rya,"onTouchEvent"),U.XVa=H.a.touchEvents):(v.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),U.Hkb=Object(x.a)(U,U.$nc,"onMouseEvent"),U.XVa=H.a.fIh);U.qh=Q;U.qfa=B;y.AFrameworkApplication.fa&&(U.xmb=y.AFrameworkApplication.fa.qa("UsePointerCaptureIsEnabled"),U.u3d=y.AFrameworkApplication.fa.qa("ClearCacheOnPrimaryPointerIsEnabled"),U.Xee=y.AFrameworkApplication.fa.qa("ResetHandledBeforeInputHandlerIsEnabled"),U.UMc=y.AFrameworkApplication.fa.qa("LogCoalescedEventsIsEnabled"),
U.nGc=y.AFrameworkApplication.fa.qa("CheckExistenceOfGetCoalescedEventsIsEnabled"),U.o3d=y.AFrameworkApplication.fa.qa("CheckIfHammerExistsAfterDownloadIsEnabled"),U.rJc=y.AFrameworkApplication.fa.qa("HammerJsPerformanceTimersIsEnabled"),U.$Ua=U.xmb&&y.AFrameworkApplication.fa.qa("CancelDragFromGestureInputManagerIsEnabled")&&y.AFrameworkApplication.fa.qa("UseGestureInputManagerPointerCacheIsEnabled"));return U}function e(){}function h(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=
null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}function k(B,Q,U,X,P,ea,ia,da,xa){B=S.call(this,B,U,X,ea)||this;B.thb=Q;B.oga=ia;B.FX=da;B.n0j=xa;B.Ypg=P;return B}function n(){this.EHc=null}function f(){this.hda=this.nWe=null}t=b(0);var v=
b(15),m=b(192),x=b(84),l=b(85),u=b(414),A=b(100),z=b(44);Object(t.a)(f,"GestureAdapterInfo",null,[]);var y=b(4),w=b(397),D=b(239);n.prototype.Xti=function(){if(!this.EHc){var B="hammer.min.js";y.AFrameworkApplication.fa.Zn("IsServerFlavorDebug")&&(B=y.AFrameworkApplication.fa.qa("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");B=y.AFrameworkApplication.WK(String.format("{0}",B),5);B=D.a.create(B,null,null);w.a.Bia(B);this.EHc=B.o8a}return this.EHc};of.Object.defineProperties(n,{instance:{configurable:!0,
enumerable:!0,get:function(){n.Ma||(n.Ma=new n);return n.Ma}}});n.Ma=null;Object(t.a)(n,"HammerJsDependencyLoader",null,[799]);var H=b(13),F;(function(B){B[B.none=-1]="none";B[B.pinch=0]="pinch";B[B.pan=1]="pan";B[B.swipe=2]="swipe"})(F||(F={}));Object(t.b)("GestureEvent",F);var J=b(75),S=J.a;$k(k,S);k.create=function(B,Q,U,X,P,ea){if(U.rawEvent)if(ea){var ia=U.rawEvent;ia=new Sys.UI.Point(ia.clientX,ia.clientY)}else ia=J.a.ovb(U);else ia=new Sys.UI.Point(U.clientX,U.clientY);return new k(B,ia,Q,
U,X,P,U.shiftKey,U.ctrlKey,ea)};of.Object.defineProperties(k.prototype,{shiftKey:{configurable:!0,enumerable:!0,get:function(){return this.oga}},ctrlKey:{configurable:!0,enumerable:!0,get:function(){return this.FX}},clientPoint:{configurable:!0,enumerable:!0,get:function(){return this.thb}},Sua:{configurable:!0,enumerable:!0,get:function(){return this.Ypg}}});Object(t.a)(k,"GestureEventArgs",J.a,[]);Object(t.a)(h,"GestureManagerData",null,[]);e.jkg=2;e.kkg=4;e.lkg=8;e.mkg=8;Object(t.a)(e,"HammerConstants",
null,[]);var N=b(92),T=b(216),G=b(29),I=b(77),K=z.a;$k(d,K);d.prototype.CQh=function(){return this.ZOc?0:this.xie?1:2};d.prototype.Xm=function(B){K.prototype.Xm.call(this,B);this.Jd.lka(this.XVa,B,0,this.Hkb)};d.prototype.am=function(B){K.prototype.am.call(this,B);this.Jd.qIa(B,this.XVa)};d.prototype.D9i=function(B,Q,U){var X=this;U=void 0===U?null:U;var P=void 0===P?null:P;y.AFrameworkApplication.qhc()?n.instance.Xti().continueWith(function(ea){X.pGj();if(ea.Of||ea.sh)v.ULS.sendTraceTag(591192778,
310,10,"Hammer did not download correctly: {0}",ea.status);else{v.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",ea.status);if(X.o3d){ea=window.Hammer;if("undefined"===typeof ea){v.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");X.azc();return}if("undefined"===typeof ea.inputHandler){v.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");X.azc();return}}if(!B)throw X.azc(),Error.argumentNull("source element can not be null");ea=T.a.rva(B,X.lqa);if(void 0===
ea||null===ea)ea=new A.a,T.a.Xcb(B,X.lqa,ea),X.E9i(B);var ia=null;if(!ea.kb(F[0])){ia=Object;var da=ia.assign,xa=new f,Z=F[0],ha=P;ha=void 0===ha?null:ha;if(void 0===X||null===X)throw v.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");var ya=null;switch(Z){case H.a.pinch:ya=new Hammer.Pinch(ha);break;case H.a.pan:ya=new Hammer.Pan(ha)}ya&&(ya.manager=X);ia=da.call(ia,xa,{hda:ya,nWe:Q});ea.add(F[0],ia)}if(void 0!==U&&null!==U)for(da=0;da<U.length;da++)ea.kb(F[U[da]])&&
(xa=ea.na(F[U[da]]),ia.hda.recognizeWith(xa.hda))}X.azc()}):v.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")};d.prototype.pGj=function(){this.rJc&&(this.qh?this.HRc=this.qh.sc("Task","RegisterGestureAdapterAfterLoad"):v.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))};d.prototype.azc=function(){this.rJc&&(this.HRc?this.HRc.stop():v.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))};
d.prototype.E9i=function(B){this.Zpg.add(B);this.Jd.lka(this.XVa,B,0,this.Hkb)};d.prototype.recognize=function(B){for(var Q=Array(B.pointers.length),U=0;U<B.pointers.length;U++)Q[U]=B.pointers[U].target;U=null;for(this.Ipa=this.SSh(Q);void 0!==this.Ipa&&null!==this.Ipa&&(U=T.a.rva(this.Ipa,this.lqa),void 0===U||null===U);this.Ipa=this.Ipa.parentNode);if(void 0!==U&&null!==U){this.curRecognizer&&this.curRecognizer.state===e.mkg&&(this.curRecognizer=null);Q=ik(U.keys);for(var X=Q.next();!X.done;X=Q.next()){X=
U.na(X.value);void 0!==X&&null!==X&&void 0!==X.hda&&null!==X.hda&&(void 0===this.curRecognizer||null===this.curRecognizer||X.hda===this.curRecognizer||X.hda.canRecognizeWith(this.curRecognizer))&&X.hda.recognize(B);var P=X.hda.state;this.curRecognizer||e.jkg!==P&&e.kkg!==P&&e.lkg!==P||(this.curRecognizer=X.hda)}}};d.prototype.emit=function(B,Q){if("hammer.input"!==B){this.W8=!1;Q=k.create(B,this.Ipa,Q.srcEvent,Q,3,this.ZOc);var U=T.a.rva(this.Ipa,this.lqa);if(this.Oli(B))var X=0;else if(this.Fli(B))X=
1;else if(this.Boi(B))X=2;else{v.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}U=U.yc(F[X]).value;void 0!==U&&null!==U&&((U=U.nWe,U.uji())?B.endsWith("start")?this.W8=U.YLi(Q):B.endsWith("end")?(U.WLi(Q),this.W8=!0):B.endsWith("cancel")?(U.VLi(Q),this.W8=!0):B.endsWith("move")&&(this.W8=U.XLi(Q)):v.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",B))}};d.prototype.get=function(B){return Object(l.a)(Hammer.Recognizer,B)};d.prototype.SSh=
function(B){if(1>B.length)return null;if(1===B.length)return B[0];for(var Q=B[0],U=!0,X=1;X<B.length;X++){if(!B[X])return null;if(Q!==B[X]){U=!1;break}}if(U)return Q;Q=this.GWe(B[0]);U=0;B=ik(B);for(X=B.next();!X.done;X=B.next()){X=this.GWe(X.value);if(Q.na(Q.count-1)!==X.na(X.count-1))return null;for(var P=Q.count-2,ea=X.count-2;P>=U&&0<=ea;P--,ea--)if(Q.na(P)!==X.na(ea)){U=P+1;break}}return Q.na(U)};d.prototype.GWe=function(B){for(var Q=new m.a;void 0!==B&&null!==B;B=B.parentNode)Q.add(B);return Q};
d.prototype.j_e=function(B){switch(B){case H.a.sf:case H.a.vha:return 1;case H.a.Vf:case H.a.wha:return 2;case H.a.oe:case H.a.JGa:return 4;case H.a.HAc:case H.a.GYc:return 8}return 0};d.prototype.Rya=function(B,Q,U){B=this.j_e(B);Q=this.BRh(U);Hammer.inputHandler(this,B,Q);this.W8&&U.preventDefault();return this.W8};d.prototype.A6e=function(){return 1<this.fT.count};d.prototype.b2b=function(){v.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.xmb)for(var B=ik(this.fT),Q=B.next();!Q.done;Q=
B.next())this.MPf(Q.value.key);else this.fT=new A.a;this.session=null};d.prototype.fDg=function(B,Q,U){v.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",B);if(!this.$kb.kb(B)){try{Q.setPointerCapture(B)}catch(X){v.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",X)}this.$kb.add(B,Q)}this.fT.ia(B,U);this.$Ua&&1<this.fT.count&&this.qfa&&!this.qfa.Zpb&&(this.qfa.Zpb=!0)};d.prototype.MPf=function(B){v.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",
B);if(this.$kb.kb(B)){try{this.$kb.na(B).releasePointerCapture(B)}catch(Q){v.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",Q)}this.$kb.remove(B)}else v.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",B);this.fT.remove(B);this.$Ua&&1>=this.fT.count&&this.qfa&&this.qfa.Zpb&&(this.qfa.Zpb=!1)};d.prototype.poc=function(B,Q,U){var X=U.rawEvent.pointerType.toString(),P=U.rawEvent.pointerId.toString();if("touch"!==X)return!1;B=this.j_e(B);if(1!==B&&!this.fT.kb(P))return!1;
this.u3d&&1===B&&U.rawEvent.isPrimary&&this.fT.count&&(v.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.b2b());this.xmb?this.fDg(P,Q,U):this.fT.ia(P,U);this.UMc&&2===B&&(!this.nGc||this.nGc&&"function"===typeof U.rawEvent.getCoalescedEvents)&&(Q=U.rawEvent.getCoalescedEvents())&&this.A6e()&&(this.jkb=Math.max(this.jkb,Q.length));this.Xee&&(this.W8=!1);X=this.ARh(this.fT,U,X);Hammer.inputHandler(this,B,X);if(4===B||8===B)this.xmb?this.MPf(P):this.fT.remove(P),this.fT.count||
(this.session=null,this.UMc&&-1!==this.jkb&&(v.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.jkb),this.jkb=-1));this.W8&&U.preventDefault();return this.W8};d.prototype.$nc=function(){return!1};d.prototype.BRh=function(B){var Q=new h,U=B.rawEvent,X=U.touches;U=U.changedTouches;Q.pointers=Array.clone(X);Q.pointers=Array.clone(0<X.length?X:U);Q.changedPointers=Array.clone(U);Q.srcEvent=B;Q.pointerType="touch";return Q};d.prototype.ARh=function(B,Q,U){var X=new h;X.pointers=
I.toArray(B.values);X.changedPointers=[Q];X.pointerType=U;X.srcEvent=Q;return X};d.prototype.Oli=function(B){return G.a.startsWith(B,H.a.pinch)};d.prototype.Fli=function(B){return G.a.startsWith(B,H.a.pan)};d.prototype.Boi=function(B){return G.a.startsWith(B,H.a.swipe)};Object(t.a)(d,"GestureInputManager",z.a,[708,709]);var L=b(293),O=b(258);c.prototype.Sh=function(B){B.register(d,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").tc().Dc(function(){return new d(L.a.instance,
y.AFrameworkApplication.ta.sD)});this.fb=B};c.prototype.init=function(){this.Ww||(this.fb.resolve("Common.App.GestureManager.GestureInputManager"),this.Ww=!0)};c.prototype.dispose=function(){};c.main=function(){O.a.instance.Qi(new c)};of.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.GestureInputManager"}}});Object(t.a)(c,"GestureInputManagerPackage",null,[10,11]);b.d(E,"a",function(){return a})},1399:function(t,E,b){function a(){v.a.Fa(function(cb){cb.da.Ga(150,
new c(cb))})}function c(cb){var Sa=pb.call(this)||this;Sa.$=cb;Sa.Eb();return Sa}function d(cb){var Sa=Ra.call(this,document.createElement("div"))||this;Sa.$Q=!1;Sa.CQ=!1;Sa.A1b=!1;Sa.Dh=null;Sa.Mh=null;Sa.Lhi=Ma.EwaSettings.isChangeGateEnabled("OfficeVSO:6172290_DataValidationConditionalHideAll");Sa.Mhi=Ma.EwaSettings.isChangeGateEnabled("OfficeVSO:6172279_DataValidationConstButtonWidth");Sa.Uod=!1;Sa.Ppd=!1;Sa.Pmd=!1;Sa.h6b=[];Sa.vh=function(){Sa.I3f(!1)};Sa.KOa=function(Ab,Wb){Sa.show(Sa.TQ,!Sa.isListVisible,
!0,x.a.Wo||3===Wb.nb||3===J.a.Cb);Sa.Tzd(null,null)};Sa.Tzd=function(){Sa.gridView.setFocus()};Sa.zLa=function(){Sa.Ya.textBox.XJ=!0};Sa.$s=function(){Sa.$dg()};Sa.onContentReady=function(){Sa.I3f(Sa.isListVisible)};Sa.Fc=function(){Sa.Nx()};Sa.Nya=function(){Sa.yRa()};Sa.Qwf=function(){Sa.$dg()};Sa.$=cb;Sa.gridView=L.g(Sa.$);Sa.DI=Sa.gridView.Wb;var Db="<div id='dv_reader_description' class='"+y.a.INe+"' role='alert' aria-live='polite'></div>\r\n<div id='dv_list_button' class='"+f.Eph+" "+D.a.Hp+
"'></div>\r\n<div id='dv_list_box' class='"+f.Loh+" "+D.a.Mo+" "+D.a.Hp+"'></div>\r\n<div id='dv_prompt_box' class='"+f.Cph+" "+D.a.Hp+"'></div>";Sa.domElement.className=f.Dph;Sa.domElement.innerHTML=Db;ta.d(Sa.style,Sa.isGridRtl);Sa.Rf=$get("dv_list_box",Sa.domElement);Sa.f0=$get("dv_prompt_box",Sa.domElement);Sa.vsa=$get("dv_list_button",Sa.domElement);Sa.jCb=$get("dv_reader_description",Sa.domElement);(Db=ja.a(cb))&&Sa.h6b.push(new h(cb,Db,Sa));Sa.h6b.push(new h(cb,Sa.gridView.Wb,Sa));Sa.gridView.ha.hJ(Sa.vh);
Sa.gridView.Au(Sa.onContentReady);Sa.gridView.$b.SFg(Sa.Qwf);Sa.$.Bk(Sa.Fc);Db=Sa.gridView.Aj;Db.insertBefore(Sa.domElement,Db.firstChild);Sa.onContentReady(null,null);cb.da.Ga(14,Sa);return Sa}function e(cb,Sa,Db){cb=oa.call(this,cb,Sa,new Ua.a(f.listItem,f.hCb,f.kCb,f.lCb))||this;cb.Mlb=null;cb.fe=null;cb.Kda=null;cb.NV=null;cb.kIa=null;cb.DNa=0;cb.gPa=[];cb.OSj=Ma.EwaSettings.isChangeGateEnabled("OfficeVSO:6172276_UpdateDvListHeightUsingItemHeight");cb.jCb=Db;return cb}function h(cb,Sa,Db){cb=
ba.call(this,cb,Sa)||this;cb.dataValidationControl=Db;return cb}function k(cb,Sa,Db){var Ab=va.call(this,cb)||this;Ab.Ax=null;Ab.QU=null;Ab.Cgf=!1;Ab.errorMessage=null;Ab.P7e=null;Ab.vm=null;Ab.eea=null;Ab.jGe=function(Wb){var ub=Ab.$,vb=Ab.Cgf;Ab.hide();var Ka=L.g(ub);Ka.isEditing&&Ka.Wb.endEdit(!1,"DataValidationErrorDialog.DataValidationErrorDialogHandler",0);1===Wb&&vb&&I.TaskExtensions.Aa(Ka.startEdit(!1,1),function(){var yb=Ka.Wb.textBox;yb.text&&yb.selectRange(0,yb.text.length)},Ab.la,11,B.a.current);
if(1===Wb&&!vb){if(vb=Ka.Ub(null)){Ka.Ea.uV();var eb=Object(S.a)(new O.a,{Text:vb.cell.userInput});Ka.setCell(eb,vb.range,0,63,null)}ub.Cd(-798660877,J.a.Cb,8,null)}2===Wb&&I.TaskExtensions.Aa(Ka.startEdit(!1,0),function(){var yb=Ka.Wb.textBox;yb.text&&yb.selectRange(0,yb.text.length)},Ab.la,11,B.a.current)};Ab.CAd=function(){Z.HelperMethods.$V(Ab.$.$F,Ab.error.HelpTopicId,Ab.$.tS)};Ab.PNi=function(){Ab.Oxb();Ab.$.Cd(802602464,2,8,Ab.QU)};Ab.jMi=function(){N.ULS.sendTraceTag(537163288,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationFailureCallback, failed to get expected results.")};
Ab.kMi=function(Wb){!Wb||xa.a(Wb)?N.ULS.sendTraceTag(537163287,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationSuccessCallback, failed to get expected results."):(Wb=Ab.FXh(Wb.Result),Ab.Ax.errorInformation=Wb,Ab.ITa(Ab.XIa,Ab.B4a(Ab.jGe),Ab.Ax))};Ab.iAd=function(){Ab.show(Ab.BSb)};Ab.pMe=Db;Ab.sqmManager=ya.a(Ab.$);Ab.error=k.wQ(Sa,cb,Db);Ab.ob.Dp=Ab;cb=cb.da.za(14);Ab.Gu=cb.S3a(Ab.pMe);Ab.XIa=Ab.Gu&&Ab.Gu.XIa?Ab.Gu.XIa:K.a.instance.ga(1724);Ab.Zqj();Ab.initializeAndShow(Ab.XIa,
Ab.jGe,Ab.Ax);return Ab}function n(cb,Sa,Db){var Ab=Q.call(this,cb,n.wQ(Sa,cb,Db))||this;Ab.Rc=function(){Ab.setFocus()};L.g(Ab.$).ha.wG(Ab.Rc);(cb=cb.da.za(14).S3a(Db))&&cb.options&1&&N.ULS.sendTraceTag(537163291,0,50,"DataValidationErrorDeprecatedDialog.DataValidationErrorDeprecatedDialogs, Data validation Error opened on a list rule.");return Ab}function f(){}var v=b(10);t=b(0);var m=b(235),x=b(27),l=b(87),u=b(29),A=b(445),z=b(248);f.Dph="ewa-dv";f.Eph="ewa-dv-buttonarea";f.Loh="ewa-dlb";f.kCb=
"list-table";f.listItem="list-item";f.hCb="list-item-selected";f.lCb="list-table-touch";f.Cph="ewa-dpb";f.Njh="dv-prompt-title";f.Mjh="dv-prompt-message";Object(t.a)(f,"CssClassNames",null,[]);var y=b(30),w=b(627),D=b(19),H=b(48),F=b(466),J=b(76),S=b(7),N=b(15),T=b(160),G=b(1039),I=b(37),K=b(14),L=b(21),O=b(277),B=b(63),Q=T.ErrorDialog;$k(n,Q);n.prototype.dispose=function(){L.g(this.$).ha.zF(this.Rc);Q.prototype.dispose.call(this)};n.prototype.setFocus=function(){switch(this.error.Severity){case 0:var cb=
4;break;case 1:cb=3;break;case 2:cb=0;break;default:cb=this.closeAction}(cb=this.getButton(cb))?cb.get_element().focus():Q.prototype.setFocus.call(this)};n.prototype.Tqb=function(){var cb=L.g(this.$);cb.isEditing&&cb.Wb.endEdit(!1,"DataValidationErrorDeprecatedDialog.CommitAfterClosing",0);4===this.returnValue&&this.PTd(1);if(2===this.returnValue||0===this.returnValue){var Sa=cb.Ub(null);if(Sa){cb.Ea.uV();var Db=Object(S.a)(new O.a,{Text:Sa.originalText});cb.setCell(Db,Sa.range,0,63,null)}this.$.Cd(-798660877,
J.a.Cb,8,null)}Q.prototype.Tqb.call(this)};n.prototype.Asa=function(){var cb=L.g(this.$);cb.isEditing&&cb.Wb.endEdit(!1,"DataValidationErrorDeprecatedDialog.CancelAfterClosing",0);3===this.returnValue&&this.PTd(0);Q.prototype.Asa.call(this)};n.prototype.PTd=function(cb){var Sa=L.g(this.$);I.TaskExtensions.Aa(Sa.startEdit(!1,cb),function(){var Db=Sa.Wb.textBox;Db.text&&Db.selectRange(0,Db.text.length)},this.la,11,B.a.current)};n.wQ=function(cb,Sa,Db){Db=Sa.da.za(14).S3a(Db);cb.MessageId=-1083021405;
cb.MessageIdName="DataValidationError";cb.MessageIdHash=u.a.Nv(cb.MessageIdName);cb.Severity=Db?Db.N8c:1;Sa=(null===Db||void 0===Db?0:Db.XIa)?u.a.yg(Db.XIa):null;Db=(null===Db||void 0===Db?0:Db.error)?u.a.yg(Db.error):String.format("<p>{0}</p><p>{1}</p>",K.a.instance.ga(893),K.a.instance.ga(894));switch(cb.Severity){case 0:cb.Appearance=18;break;case 1:cb.Appearance=12;Db+=String.format("<p>{0}</p>",K.a.instance.ga(895));break;default:cb.Appearance=3}cb.Caption=Sa;cb.Description=Db;cb.HelpDescription=
K.a.instance.ga(1312);cb.HelpTopicId=G.a.iGe;return cb};Object(t.a)(n,"DataValidationErrorDeprecatedDialog",T.ErrorDialog,[]);T=b(300);var U=b(5),X=b(41),P=b(259),ea=b(201),ia=b(53),da=b(31),xa=b(299),Z=b(11),ha=b(298),ya=b(165),va=T.a;$k(k,va);k.prototype.dispose=function(){this===this.ob.Dp&&(this.ob.Dp=null);l.a.Ia(this.vm);this.vm=null;va.prototype.dispose.call(this)};k.prototype.Zqj=function(){this.Gu&&this.Gu.error?this.errorMessage=this.Gu.error:this.Gu&&this.Gu.options&1?(N.ULS.sendTraceTag(537163289,
0,50,"DataValidationErrorDialog.SetDialogProps, Data validation Error opened on a list rule."),this.errorMessage=K.a.instance.ga(1726),this.P7e=ia.a.current.So(117)):(this.errorMessage=K.a.instance.ga(1725),this.vNh(this.pMe));var cb=this.Gu?this.Gu.N8c:1,Sa={};this.Ax=(Sa[k.Hu]=this.mc,Sa.errorDescription=this.errorMessage,Sa.helpImageUri=this.P7e,Sa);switch(cb){case 0:this.Rb=1;this.kc(1,"Retry");this.Ax.dialogIcon=2;this.Cgf=!0;break;case 1:this.Rb=4;this.Ax.dialogIcon=1;this.Ax.additionalInformation=
K.a.instance.ga(895);break;default:this.Rb=1,this.Ax.dialogIcon=3}cb={};this.Ax.helpLink=(cb.type="AppLinkProps",cb[k.Hu]=this.error.HelpTopicId,cb.text=K.a.instance.ga(1312),cb.handler=this.CAd,cb);cb=da.a.QWc([this.error]);Sa={};this.QU=(Sa[U.a.K9b]=!0,Sa[U.a.T$c]=cb,Sa[U.a.U$c]=ya.a(this.$).ytb(this.error.MessageIdHash),Sa[U.a.WU]=this.mc,Sa.DismissHandler=this.iAd,Sa);cb={};this.Ax.giveFeedbackLink=(cb.type="AppLinkProps",cb[k.Hu]=U.a.Bhd,cb.text=K.a.instance.ga(1762),cb.handler=this.PNi,cb)};
k.prototype.vNh=function(cb){var Sa=this.$.oa.va.Pb();P.f(this.$.oa.va,X.q(cb,this.$),ha.b(this.kMi),ha.a(this.jMi),null,Sa)};k.prototype.FXh=function(cb){switch(cb.RuleType){case 1:switch(cb.ConditionType){case 0:var Sa=K.a.instance.mb(108);return String.format(Sa,cb.LowerBoundary,cb.UpperBoundary);case 1:return Sa=K.a.instance.mb(109),String.format(Sa,cb.LowerBoundary,cb.UpperBoundary);case 2:return Sa=K.a.instance.mb(110),String.format(Sa,cb.LowerBoundary);case 3:return Sa=K.a.instance.mb(111),
String.format(Sa,cb.LowerBoundary);case 4:return Sa=K.a.instance.mb(112),String.format(Sa,cb.LowerBoundary);case 5:return Sa=K.a.instance.mb(113),String.format(Sa,cb.UpperBoundary);case 6:return Sa=K.a.instance.mb(114),String.format(Sa,cb.LowerBoundary);case 7:return Sa=K.a.instance.mb(115),String.format(Sa,cb.UpperBoundary);default:return"we couldn't get the details"}case 2:switch(cb.ConditionType){case 0:return Sa=K.a.instance.mb(116),String.format(Sa,cb.LowerBoundary,cb.UpperBoundary);case 1:return Sa=
K.a.instance.mb(117),String.format(Sa,cb.LowerBoundary,cb.UpperBoundary);case 2:return Sa=K.a.instance.mb(118),String.format(Sa,cb.LowerBoundary);case 3:return Sa=K.a.instance.mb(119),String.format(Sa,cb.LowerBoundary);case 4:return Sa=K.a.instance.mb(120),String.format(Sa,cb.LowerBoundary);case 5:return Sa=K.a.instance.mb(121),String.format(Sa,cb.UpperBoundary);case 6:return Sa=K.a.instance.mb(122),String.format(Sa,cb.LowerBoundary);case 7:return Sa=K.a.instance.mb(123),String.format(Sa,cb.UpperBoundary);
default:return"we couldn't get the details"}case 4:switch(cb.ConditionType){case 0:return Sa=K.a.instance.mb(124),String.format(Sa,cb.LowerBoundary,cb.UpperBoundary);case 1:return Sa=K.a.instance.mb(125),String.format(Sa,cb.LowerBoundary,cb.UpperBoundary);case 2:return Sa=K.a.instance.mb(126),String.format(Sa,cb.LowerBoundary);case 3:return Sa=K.a.instance.mb(127),String.format(Sa,cb.LowerBoundary);case 4:return Sa=K.a.instance.mb(128),String.format(Sa,cb.LowerBoundary);case 5:return Sa=K.a.instance.mb(129),
String.format(Sa,cb.UpperBoundary);case 6:return Sa=K.a.instance.mb(130),String.format(Sa,cb.LowerBoundary);case 7:return Sa=K.a.instance.mb(131),String.format(Sa,cb.UpperBoundary);default:return"we couldn't get the details"}case 5:switch(cb.ConditionType){case 0:return Sa=K.a.instance.mb(132),String.format(Sa,cb.LowerBoundary,cb.UpperBoundary);case 1:return Sa=K.a.instance.mb(133),String.format(Sa,cb.LowerBoundary,cb.UpperBoundary);case 2:return Sa=K.a.instance.mb(134),String.format(Sa,cb.LowerBoundary);
case 3:return Sa=K.a.instance.mb(135),String.format(Sa,cb.LowerBoundary);case 4:return Sa=K.a.instance.mb(136),String.format(Sa,cb.LowerBoundary);case 5:return Sa=K.a.instance.mb(137),String.format(Sa,cb.UpperBoundary);case 6:return Sa=K.a.instance.mb(138),String.format(Sa,cb.LowerBoundary);case 7:return Sa=K.a.instance.mb(139),String.format(Sa,cb.UpperBoundary);default:return"we couldn't get the details"}case 6:switch(cb.ConditionType){case 0:return Sa=K.a.instance.mb(140),String.format(Sa,cb.LowerBoundary,
cb.UpperBoundary);case 1:return Sa=K.a.instance.mb(141),String.format(Sa,cb.LowerBoundary,cb.UpperBoundary);case 2:return Sa=K.a.instance.mb(142),String.format(Sa,cb.LowerBoundary);case 3:return Sa=K.a.instance.mb(143),String.format(Sa,cb.LowerBoundary);case 4:return Sa=K.a.instance.mb(144),String.format(Sa,cb.LowerBoundary);case 5:return Sa=K.a.instance.mb(145),String.format(Sa,cb.UpperBoundary);case 6:return Sa=K.a.instance.mb(146),String.format(Sa,cb.LowerBoundary);case 7:return Sa=K.a.instance.mb(147),
String.format(Sa,cb.UpperBoundary);default:return"we couldn't get the details"}case 3:return Sa=K.a.instance.mb(106),String.format(Sa,cb.LowerBoundary);case 7:return Sa=K.a.instance.mb(107),String.format(Sa,cb.LowerBoundary);default:return"we couldn't get the details"}};k.prototype.PTd=function(cb){var Sa=L.g(this.$);I.TaskExtensions.Aa(Sa.startEdit(!1,cb),function(){var Db=Sa.Wb.textBox;Db.text&&Db.selectRange(0,Db.text.length)},this.la,11,B.a.current)};k.wQ=function(cb,Sa,Db){Sa=Sa.da.za(14).S3a(Db);
cb.MessageId=-1083021405;cb.MessageIdName="DataValidationError";cb.MessageIdHash=u.a.Nv(cb.MessageIdName);cb.Severity=Sa?Sa.N8c:1;cb.HelpDescription=K.a.instance.ga(1312);cb.HelpTopicId=G.a.iGe;return cb};of.Object.defineProperties(k.prototype,{mc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationErrorDialog"}},la:{configurable:!0,enumerable:!0,get:function(){this.vm=this.vm||new ea.a;return this.vm.token}}});Object(t.a)(k,"DataValidationErrorDialog",T.a,[451,452,6,397]);T=b(1129);
var bb=b(412),ba=T.a;$k(h,ba);h.prototype.dispose=function(){this.dataValidationControl=null;ba.prototype.dispose.call(this)};h.prototype.Jh=function(cb,Sa){this.dataValidationControl.Ya=this.Ya;var Db=cb.keyCode;return 1461300262!==Sa||16!==Db&&17!==Db&&18!==Db?ba.prototype.Jh.call(this,cb,Sa):!1};h.prototype.nzd=function(){this.yV&&(this.dataValidationControl.Ya=this.Ya,this.dataValidationControl.show(this.dataValidationControl.TQ,!0,!0,x.a.Wo||3===J.a.Cb))};h.prototype.Ef=function(){};h.prototype.Fh=
function(){this.dataValidationControl.show(this.dataValidationControl.TQ,!0,!0,x.a.Wo||3===J.a.Cb)};h.prototype.PFd=function(cb,Sa){return this.dataValidationControl.Jh(Sa)};of.Object.defineProperties(h.prototype,{kzb:{configurable:!0,enumerable:!0,get:function(){return Object(A.a)(k,this.$.ob.Yg)}},yV:{configurable:!0,enumerable:!0,get:function(){return this.dataValidationControl.isListVisible},set:function(cb){this.dataValidationControl.isListVisible=cb}},H5a:{configurable:!0,enumerable:!0,get:function(){return!1}},
key:{configurable:!0,enumerable:!0,get:function(){return bb.a.p5c}}});Object(t.a)(h,"DataValidationListAutoCompleteBehavior",T.a,[]);var fa=b(278);T=b(1060);var ra=b(12),pa=b(117),Za=b(22),Ua=b(1128),Ma=b(1),oa=T.a;$k(e,oa);e.prototype.dispose=function(){oa.prototype.dispose.call(this);this.jCb=this.Mlb=null};e.prototype.yea=function(cb,Sa,Db,Ab){if(cb&&(!cb||cb.length)){this.R7(!1);this.kIa=cb;this.NV=[];for(var Wb=0;Wb<cb.length;Wb++)this.NV[Wb]=cb[Wb]?cb[Wb].Name:null;Wb="<table class='"+this.ica+
"' aria-live='polite'><tbody>";var ub="",vb="";cb=0;var Ka=L.g(this.$).Ub(null);Ab=this.isEditing?Ab?Ab.text:this.editText:Ka?Ka.originalText:null;Ka=!Ab;var eb=0;this.gPa.length=0;var yb=[],oc=[],Jb=[],dc=Ab?Ab.split(" "):[""];Ab=Ab.trim();for(var $a={},Ba=0;Ba<this.NV.length;$a={VDc:$a.VDc},Ba++){var la=this.NV[Ba],ka=void 0;$a.VDc=la.split(" ");ka=fa.a.all(dc,function(jb){return function(nb){return fa.a.any(jb.VDc,function(Na){return Za.a.gL(Na,nb)})}}($a));var ca=!la,Ia=Jb.includes(la);ca||Ia||
this.isEditing&&!ka||(ka=la?u.a.yg(u.a.X7c(la)):"",ka=String.format("<tr>\r\n\t<td class='{0}'>{1}</td>\r\n</tr>",this.x_,ka),Jb.push(la),this.isEditing&&Za.a.gL(la,Ab)?(ub+=ka,yb.push(Ba)):(vb+=ka,oc.push(Ba)),!Ka&&Za.a.equals(Ab,la,!0)&&(cb=this.isEditing?yb.length-1:eb,Ka=!0),eb++)}this.DNa=eb;this.gPa.push.apply(this.gPa,kk(yb));this.gPa.push.apply(this.gPa,kk(oc));this.Rf.innerHTML=Wb+(ub+vb+"</tbody></table>");Wb=this.Hn=ra.DOMElementExtensions.Bj(this.domElement,this.ica);this.rnb(Wb,Sa);this.R7(!0);
this.Tra(Sa,Db);this.Pk=0<this.DNa?Wb.rows[cb]:null}};e.prototype.yRa=function(cb){var Sa=!1;this.isEditing&&cb&&(Sa=!this.DNa,cb.endEdit(Sa,"DataValidationListBox.SetCellContent",0));if(!Sa&&(cb=L.g(this.$),Sa=cb.Ub(null))){var Db=null;this.Kda&&-1!==this.Kda.SheetId&&-1!==this.Kda.Row&&-1!==this.Kda.Column&&(Db={},Db.SheetName=this.Kda.SheetId.toString(),Db.FirstRow=this.Kda.Row,Db.FirstColumn=this.Kda.Column,Db={ParameterType:6,SourceRange:Db});var Ab=Object(S.a)(new O.a,{Text:this.fe});cb.setCell(Ab,
Sa.range,0,63,Db)}return!0};e.prototype.Tra=function(cb,Sa){var Db=cb?this.$Cb:this.JH;cb=cb?this.ckc:this.dkc;0>=this.DNa?this.Rf.style.height=Z.HelperMethods.nc(cb):(this.Rf.style.height="auto",this.DNa>Db?(ra.DOMElementExtensions.vI(this.Rf,this.OSj?Math.floor(cb*Db):Math.floor(this.Rf.offsetHeight*Db/this.DNa)),this.Rf.style.overflowY="auto"):(this.Rf.style.height="auto",this.Rf.style.overflowY="hidden"));ra.DOMElementExtensions.uv(this.Rf,Sa);ra.DOMElementExtensions.uv(this.Hn,Sa-(this.DNa>Db?
pa.a.hv:0))};of.Object.defineProperties(e.prototype,{Pk:{configurable:!0,enumerable:!0,get:function(){return this.Mlb},set:function(cb){this.wBa(this.Mlb);if(cb){this.Mlb=cb;this.jCb.innerText="";this.wBa(this.Mlb);var Sa=this.gPa[cb.rowIndex];this.fe=this.NV[Sa];this.kIa&&(this.Kda=this.kIa[Sa],N.ULS.shipAssertTag(537163286,0,!this.gPa.length||!!this.Kda,"DataValidationListBox.SelectedRow: Did not find corresponding DataValidationListItem"));this.jCb.innerText=this.fe;this.cvc(cb)}else this.Kda=
this.fe=null}},isEditing:{configurable:!0,enumerable:!0,get:function(){return L.g(this.$).isEditing}},editText:{configurable:!0,enumerable:!0,get:function(){return L.g(this.$).Wb.text}}});Object(t.a)(e,"DataValidationListBox",T.a,[]);var ja=b(114),ta=b(262),aa=b(268),ma=b(1307),Ea="<p class='"+f.Njh+"'>\r\n\t<span class='dv-prompt-titletext'>{0}</span>\r\n</p>",Ha="<p class='"+f.Mjh+"'>\r\n\t<span class='dv-prompt-messagetext'>{0}</span>\r\n</p>",Aa=D.a.qNe,V=D.a.qNe,La=D.a.i_g,Ra=z.a;$k(d,Ra);d.prototype.dispose=
function(){this.$&&(this.eNb(!1),this.gridView.ha.IK(this.vh),this.gridView.ny(this.onContentReady),this.gridView.$b.ucj(this.Qwf),this.$.Ol(this.Fc));this.tEe(!1);this.uEe(!1);l.a.oc(this.h6b);this.h6b=this.vsa=this.Rf=this.f0=this.DI=this.gridView=this.$=null;Ra.prototype.dispose.call(this)};d.prototype.Y6c=function(cb){return!!this.S3a(cb)};d.prototype.Drb=function(cb,Sa){return Ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5879568_ReactDataValidationErrorDialog")?new k(this.$,cb,Sa):new n(this.$,
cb,Sa)};d.prototype.S3a=function(cb){cb=this.gridView.getRangeInformation(cb);for(var Sa=0;Sa<cb.length;Sa++){var Db=cb[Sa];if(Object(A.a)(F.DataValidationRange,Db))return Db}return null};d.prototype.yJh=function(){if(!this.b5a)return"";var cb=this.i7e?this.Gu.gKf+" "+this.Gu.prompt:"",Sa=this.nxb?K.a.instance.ga(841):"";return String.format(K.a.instance.mb(17),cb,Sa)};d.prototype.Jh=function(cb){var Sa=!1;if(this.isListVisible||(-569786022===cb||541421805===cb)&&this.nxb||1872288872===cb&&this.TQ)switch(cb){case -569786022:case 541421805:this.show(this.TQ,
!this.isListVisible,!0,x.a.Wo||3===J.a.Cb);Sa=!0;break;case 1872288872:this.isListVisible?(this.show(this.TQ,!1,!0,!1),Sa=!0):this.TQ?(this.show(!1,!1,!0,!1),Sa=!0):this.Ya&&(this.Ya.endEdit(!1,"DataValidationControl.HandleKeyDown",0),Sa=!0);break;case -798660877:this.Mh.mB(1);Sa=!0;break;case 137938150:this.Mh.mB(-1);Sa=!0;break;case 2091832999:this.Mh.mB(this.Mh.JH-1);Sa=!0;break;case 742457698:this.Mh.mB(-(this.Mh.JH-1));Sa=!0;break;case 125627505:case 267796030:Sa=this.yRa()}return Sa};d.prototype.show=
function(cb,Sa,Db,Ab){this.Nx();if(this.RAb&&this.b5a){var Wb=this.tOa;if(Wb){if(cb||Sa||Db)this.isVisible=!0;ta.d(this.style,this.isGridRtl);Db&&this.nxb&&(this.uEe(!0),this.Rdg(Wb,!1));Sa&&this.nxb&&this.jSa(Ab,Wb);cb&&this.i7e&&this.ACj(Wb);this.ipi||(this.isVisible=!1)}}};d.prototype.sva=function(cb,Sa){if(!Sa||!Sa.cell.tk)return null;var Db=this.gridView.$b.textBox.domElement;var Ab=0<ra.DOMElementExtensions.getHeight(Db)&&0<ra.DOMElementExtensions.getWidth(Db)&&0<=Db.offsetTop&&0<=Db.offsetLeft;
if(Ab)Db=ra.DOMElementExtensions.sva(Db,cb.Aj);else{Db=cb.getCellBounds(Sa.cell);var Wb=ra.DOMElementExtensions.getBoundingClientRect(cb.Aj);Db=new Sys.UI.Bounds(Db.x-Wb.x,Db.y-Wb.y,Db.width,Db.height)}if(Db)if(Ab)2<Db.height&&2<Db.height&&(Db.x+=1,Db.y+=1,Db.height-=2,Db.width-=2);else if(Ab=L.g(this.$).OJ(Sa.cell))Ab=Ab.width+1,Wb=Za.a.equals(aa.a.uvb(Sa.cell,cb.rtl),"right",!0),cb.rtl&&Wb&&(Db.x=Db.x+Db.width-Ab),Sa.Ska&&cb.rtl===Wb&&(Db.width=Ab);else return null;return Db};d.prototype.I3f=function(cb){var Sa=
this.b5a;this.eNb(Sa);Sa?this.show(!0,cb,!0,!1):this.Nx()};d.prototype.yRa=function(){var cb=!1;this.isListVisible&&(cb=this.Mh.yRa(this.Ya),this.show(this.TQ,!1,!0,!1));return cb};d.prototype.Nx=function(){this.Lhi?(this.isListVisible&&(this.isListVisible=!1),this.YLa&&(this.YLa=!1),this.TQ&&(this.TQ=!1),this.isVisible&&(this.isVisible=!1)):this.isListVisible=this.YLa=this.TQ=this.isVisible=!1;this.Uod=this.Pmd=this.Ppd=!1};d.prototype.jSa=function(cb,Sa){this.nxb&&!this.Gu.kIa?this.YLa&&this.Dh.disable():
(this.tEe(!0),this.Mh.yea(this.Gu.kIa,cb,this.DSh(Sa),this.Ya),this.NBa(Sa,!1))};d.prototype.ACj=function(cb){this.Gu.prompt&&(this.TQ=!0,this.DUj(this.Gu.gKf,this.Gu.prompt),this.jeg(cb,!1))};d.prototype.Rdg=function(cb,Sa){var Db=cb.y;this.vsa.style.top=Z.HelperMethods.nc(Db);cb=this.isGridRtl?cb.x-this.vsa.offsetWidth+1:cb.x+cb.width+1;this.vsa.style.left=Z.HelperMethods.nc(cb);Sa?this.YLa=this.gridView.Sic(new H.a(cb,Db))&&this.Pmd:this.Pmd=!0};d.prototype.NBa=function(cb,Sa){var Db=cb.y+cb.height;
cb=this.isGridRtl?cb.x+cb.width-this.Rf.offsetWidth:cb.x;this.Rf.style.top=Z.HelperMethods.nc(Db);this.Rf.style.left=Z.HelperMethods.nc(cb);Sa?this.isListVisible=this.gridView.Sic(new H.a(cb,Db))&&this.Uod:this.Uod=!0};d.prototype.jeg=function(cb,Sa){var Db=cb.y+cb.height+5,Ab=this.activeCell;Ab=Ab?Ab.width/2:32;cb=this.isGridRtl?cb.x-this.f0.offsetWidth+Ab:cb.x+cb.width-Ab;this.f0.style.top=Z.HelperMethods.nc(Db);this.f0.style.left=Z.HelperMethods.nc(cb);Sa?this.TQ=this.gridView.Sic(new H.a(cb,Db))&&
this.Ppd:this.Ppd=!0};d.prototype.DUj=function(cb,Sa){if(Sa){var Db="";cb&&(Db+=String.format(Ea,u.a.yg(cb)));Db+=String.format(Ha,u.a.yg(Sa));this.f0.innerHTML=Db;cb=ra.DOMElementExtensions.Bj(this.f0,"dv-prompt-titletext");if(Sa=ra.DOMElementExtensions.Bj(this.f0,"dv-prompt-messagetext"))for(cb=cb?parseInt(String(Math.max(cb.offsetWidth,Sa.offsetWidth)),10):Sa.offsetWidth,cb+=6,ra.DOMElementExtensions.uv(this.f0,cb),Sa=0,Db=this.f0.children.length;Sa<Db;Sa++)ra.DOMElementExtensions.uv(this.f0.children[Sa],
cb)}};d.prototype.DSh=function(cb){return this.Mhi?cb.width+17-2+1:cb.width+this.vsa.clientWidth-2+1};d.prototype.uEe=function(cb){this.$&&!this.RAb||!cb?(this.R7f(!1),l.a.Ia(this.Dh),this.Dh=null):(this.Dh||(this.Dh=new ma.a(this.vsa,Aa,w.a.iia,1,V,K.a.instance.ga(892),La,K.a.instance.ga(891),"",-1),this.R7f(!0)),this.YLa=!0,this.Gu.kIa?this.Dh.isEnabled||this.Dh.enable():this.Dh.disable())};d.prototype.tEe=function(cb){this.$&&!this.RAb||!cb?(this.OSa(!1),l.a.Ia(this.Mh),this.Mh=null):(this.Mh||
(this.Mh=new e(this.$,this.Rf,this.jCb),this.OSa(!0)),this.isListVisible=!0)};d.prototype.OSa=function(cb){this.Mh&&(cb&&!this.$Q?(this.Mh.S9(this.Tzd),this.Mh.RZb(this.zLa),this.Mh.Nnb(this.Nya),this.$Q=!0):!cb&&this.$Q&&(this.Mh.sda(this.Tzd),this.Mh.Wsc(this.zLa),this.Mh.XIb(this.Nya),this.$Q=!1))};d.prototype.eNb=function(cb){cb&&!this.CQ?(this.gridView.view.Is(this.$s),this.CQ=!0):!cb&&this.CQ&&(this.gridView.view.Gq(this.$s),this.CQ=!1)};d.prototype.R7f=function(cb){this.Dh&&(cb&&!this.A1b?
(this.Dh.$Uc(this.KOa),this.Dh.lVc(this.KOa),this.Dh.ynb(this.zLa),this.A1b=!0):!cb&&this.A1b&&(this.Dh.gJd(this.KOa),this.Dh.uJd(this.KOa),this.Dh.GIb(this.zLa),this.A1b=!1))};d.prototype.$dg=function(){if(this.b5a){var cb=this.tOa;cb&&(this.Rdg(cb,!0),this.NBa(cb,!0),this.jeg(cb,!0))}};of.Object.defineProperties(d.prototype,{RAb:{configurable:!0,enumerable:!0,get:function(){return!!(this.$.Bd&16)}},ipi:{configurable:!0,enumerable:!0,get:function(){return this.isListVisible||this.TQ||this.YLa}},
isListVisible:{configurable:!0,enumerable:!0,get:function(){return ra.DOMElementExtensions.isVisible(this.Rf)},set:function(cb){ra.DOMElementExtensions.setVisible(this.Rf,cb)}},TQ:{configurable:!0,enumerable:!0,get:function(){return ra.DOMElementExtensions.isVisible(this.f0)},set:function(cb){ra.DOMElementExtensions.setVisible(this.f0,cb)}},YLa:{configurable:!0,enumerable:!0,get:function(){return ra.DOMElementExtensions.isVisible(this.vsa)&&!!this.Dh&&ra.DOMElementExtensions.isVisible(this.Dh.domElement)},
set:function(cb){ra.DOMElementExtensions.setVisible(this.vsa,cb);this.Dh&&ra.DOMElementExtensions.setVisible(this.Dh.domElement,cb)}},Ya:{configurable:!0,enumerable:!0,get:function(){return this.DI},set:function(cb){this.DI=cb}},b5a:{configurable:!0,enumerable:!0,get:function(){return!!this.activeCell&&this.Y6c(this.activeCell.range)}},activeCell:{configurable:!0,enumerable:!0,get:function(){return this.gridView.Ub(null)}},i7e:{configurable:!0,enumerable:!0,get:function(){return this.b5a&&!!this.Gu&&
!!(this.Gu.options&2)&&!!this.Gu.prompt}},nxb:{configurable:!0,enumerable:!0,get:function(){return this.b5a&&!!this.Gu&&!!(this.Gu.options&1)}},isGridRtl:{configurable:!0,enumerable:!0,get:function(){return this.gridView.rtl}},Gu:{configurable:!0,enumerable:!0,get:function(){return this.S3a(this.activeCell.range)}},tOa:{configurable:!0,enumerable:!0,get:function(){var cb=this.activeCell;return cb?this.sva(this.gridView,cb):null}}});Object(t.a)(d,"DataValidationControl",z.a,[604,6]);var pb=m.a;$k(c,
pb);c.prototype.create=function(){this.pb(this.$.da.za(14)||new d(this.$))};Object(t.a)(c,"DataValidationControlFactory",m.a,[]);b.d(E,"a",function(){return a})},1400:function(t,E,b){function a(){l.a.Fa(function(L){c.ka(L)})}function c(L){var O=K.call(this)||this;O.$=L;O.Eb();return O}function d(L,O,B){var Q=this;this.$=L;this.HBd=function(U,X){return Object(A.a)(Q,void 0,void 0,function ea(){var ia,da=this;return Nm(ea,function(xa){ia={text:U.text,start:X.index,length:X.length};void da.TJf(ia,da.requester.request.bind(da.requester),
U,0===ia.length);xa.Le=0})})};this.yOa=function(){Q.hide()};this.reset=function(){Q.handler.clearCache();Q.requester.clearCache();Q.hide()};this.fy=function(){Q.handler.clearCache();Q.requester.clearCache()};this.gridView=Object(y.g)(this.$);this.control=new f(this.$,B);this.requester=new h(this.$,O);this.handler=new k(this.$,{HBd:this.HBd,yOa:this.yOa});this.Pi()}function e(L){this.cWd=L;this.map=new Map}function h(L,O){this.$=L;this.pluginScheduler=O;this.Nbb=new e(x);this.uYf=new e(x);this.OSi=
function(B,Q){return function(U){if(Object(z.c)(U.Result))Q("No result");else if(U=JSON.parse(U.Result),Object(z.c)(U))Q("Failed to deserialize");else if(1!==Object.keys(U).length)Q("Invalid response");else{var X;for(X in U)var P=U[X];B(P)}}};this.NSi=function(B){return function(){B("Request failed")}};this.gridView=Object(y.g)(this.$)}function k(L,O){this.cache=void 0;var B=this;B.$=L;B.callbacks=O;B.qnc=function(Q,U){var X=B.gridView.Gi;if(!(0<(X.isEditing?X.textBox.selection:{index:0,length:0}).length))switch(U.state){case 0:B.EAd(Q,
U.event);break;case 1:B.eOi(Q);break;default:return w.ULS.shipAssertTag(521446489,0,!1,"FormulaAssistanceValuePreviewHandler.onHoverChange unxpected HoverState"),U}};B.pnc=function(Q,U){var X;B.clearCache();U=null!==(X=U.selection)&&void 0!==X?X:Q.textBox.selection;if(0<U.length)B.onSelectionChange(Q,U);else B.KCf(Q)};B.gridView=Object(y.g)(B.$);B.editBox=B.gridView.$b;B.formulaBar=Object(S.a)(B.$);B.Pi();return B}function n(L){this.cache=L}function f(L,O){this.$=L;this.HJa=O;this.jai();this.editBox=
Object(y.g)(this.$).Wb}function v(L,O,B){if(L===O)return B;if(O.textContent!==O.parentElement.textContent)for(;null!==O.previousSibling;)O=O.previousSibling,B+=O.textContent.length,"div"===O.nodeName.toLowerCase()&&(B+=1);return v(L,O.parentElement,B)}function m(L,O,B){if(L.has(O))return L.get(O);B=B();L.set(O,B);return B}function x(L){return JSON.stringify({text:L.text,start:L.start,length:L.length})}var l=b(10);t=b(0);var u=b(235),A=b(198),z=b(988),y=b(21),w=b(15),D=b(11),H=b(22),F=b(231),J=b(33);
f.prototype.dispose=function(){this.hide()};f.prototype.show=function(L,O,B){L=Object.assign(Object.assign({},O),{QA:L,Q_d:B});this.wdb(L)&&(this.Qna(L)&&this.hide(),this.XY=L,this.vy(),B&&this.c8h())};f.prototype.hide=function(){if(this.XY){var L=this.XY.Q_d;this.hhh();L&&this.Waj();this.XY=void 0}};f.prototype.wdb=function(L){var O;(O=!this.XY)||(O=this.XY,O=!(O.QA===L.QA&&O.kind===L.kind&&O.text===L.text&&O.start===L.start&&O.length===L.length&&O.Q_d===L.Q_d));return O};f.prototype.Qna=function(L){var O;
if(O=this.XY)O=this.XY,O=!(O.QA===L.QA&&O.start===L.start&&O.length===L.length);return O};f.prototype.c8h=function(){var L=this.XY;L.QA.textBox.formatText(L.start,L.length,{background:"rgba(202,234,216,0.6)"})};f.prototype.Waj=function(){var L=this.XY,O=L.QA,B=L.start;L=L.length;var Q=O.text;Q.length<B+L?w.ULS.shipAssertTag(521019917,0,!1,"FormulaAssistanceValuePreviewControl.removeHighlight - unexpected editor state, "+Q.length+":"+B+":"+L):O.textBox.formatText(B,L,{background:!1})};f.prototype.vy=
function(){var L=this.XY,O=L.text;switch(L.kind){case 1:case 2:L={isLoaded:!0,value:O};break;case 3:L={isLoaded:!1,value:null};break;default:return}this.AVj();this.HJa.renderValuePreview(this.ms,this.cOb,L)};f.prototype.hhh=function(){this.HJa.dismiss(this.ms)};f.prototype.jai=function(){this.ms=document.createElement("div");this.cOb=document.createElement("div");this.cOb.style.position="absolute";this.cOb.style.visibility="hidden";this.$.domElement.appendChild(this.cOb)};f.prototype.AVj=function(){var L=
this.XY,O=L.QA,B=L.start;L=L.length;var Q=H.a.contains(O.text.substring(B,B+L),"\n",!0);O=excelOnline.utils.getBoundingRectForText(O.textBox.Oe,B,Q?B:B+L,!1);B=new F.a(this.cOb.style);B.AB.left=this.nyc(O.left);B.AB.top=this.nyc(O.top);B.AB.width=this.nyc(O.width);B.AB.height=this.nyc(O.height);B.L2()};f.prototype.nyc=function(L){var O=this.XY.QA;O=Object(z.b)(this.zoomManager)&&O===this.editBox;return D.HelperMethods.nc(O?this.zoomManager.hi(L):L)};of.Object.defineProperties(f.prototype,{zoomManager:{configurable:!0,
enumerable:!0,get:function(){this.Mje||(this.Mje=Object(J.a)(this.$));return this.Mje}}});Object(t.a)(f,"FormulaAssistanceValuePreviewControl",null,[6]);var S=b(114);n.prototype.clearCache=function(){this.cache=void 0};Object(t.a)(n,"Cacheable",null,[]);$k(k,n);k.prototype.dispose=function(){this.Tj()};k.prototype.Pi=function(){this.editBox.gVc(this.qnc);this.formulaBar.gVc(this.qnc);this.editBox.ine(this.pnc);this.formulaBar.ine(this.pnc)};k.prototype.Tj=function(){this.editBox.qJd(this.qnc);this.formulaBar.qJd(this.qnc);
this.editBox.xQf(this.pnc);this.formulaBar.xQf(this.pnc)};k.prototype.EAd=function(L,O){var B=new Sys.UI.Point(O.clientX,O.clientY);O=L.textBox.Oe;var Q=void 0,U=B.x,X=B.y;Q=void 0===Q?document:Q;B=-1;var P=null;void 0!==Q.caretPositionFromPoint?(Q=Q.caretPositionFromPoint(U,X),null!==Q&&(B=Q.offset,P=Q.offsetNode)):void 0!==Q.caretRangeFromPoint&&(Q=Q.caretRangeFromPoint(U,X),null!==Q&&(B=Q.startOffset,P=Q.startContainer));null===P||-1===B?(w.ULS.sendTraceTag(521446491,0,15,"getEditorCaretPositionFromPoint - failed to get relevant range"),
O=-1):O.contains(P)?O=v(O,P,B):(w.ULS.sendTraceTag(521446490,0,15,"getEditorCaretPositionFromPoint - relavant node not inside root"),O=-1);if(-1!==O)this.onSelectionChange(L,{index:O,length:0})};k.prototype.eOi=function(L){this.KCf(L)};k.prototype.onSelectionChange=function(L,O){this.lyj(O)&&(this.cache=O,this.callbacks.HBd(L,O))};k.prototype.KCf=function(L){this.clearCache();this.callbacks.yOa(L)};k.prototype.lyj=function(L){var O;(O=!this.cache)||(O=this.cache,O=!(O.index===L.index&&O.length===
L.length));return O};Object(t.a)(k,"FormulaAssistanceValuePreviewHandler",n,[6]);var N=b(41),T=b(62);h.prototype.clearCache=function(){this.Nbb.clear();this.uYf.clear()};h.prototype.request=function(L){return Object(A.a)(this,void 0,void 0,function B(){var Q=this,U;return Nm(B,function(X){U=Q;return X.return(m(Q.Nbb,L,function(){return Object(A.a)(U,void 0,void 0,function ea(){var ia=this,da,xa,Z,ha,ya;return Nm(ea,function(va){switch(va.Le){case 1:return da=ia,va.Kj(ia.pluginScheduler.getRequester().valuePreview(L,
0),2);case 2:xa=va.vr;Z=xa.kind;ha=xa.payload;if(0!==Z)return va.return(null);if(Object(z.c)(ha))return va.return({kind:0});switch(ha.kind){case 0:return va.return({kind:0});case 1:case 2:return va.return(Object.assign({},ha));case 3:return va.gK(3)}va.gK(0);break;case 3:ya={text:L.text,start:ha.start,length:ha.length};if(!ia.Nbb.has(ya)){va.gK(5);break}return va.Kj(ia.Nbb.get(ya),6);case 6:return va.return(va.vr);case 5:return va.return(Object.assign(Object.assign({},ha),{kind:3,next:function(){return da.Lgj(ya,
L,ha.text)}}))}})})}))})})};h.prototype.Lgj=function(L,O,B){return Object(A.a)(this,void 0,void 0,function U(){var X=this,P;return Nm(U,function(ea){P=X;return ea.return(m(X.uYf,L,function(){var ia=new Promise(function(da){return Object(A.a)(P,void 0,void 0,function Z(){var ha=this,ya,va;return Nm(Z,function(bb){if(1==bb.Le)return bb.fM=2,bb.Kj(ha.UUh(B),4);2!=bb.Le?(ya=bb.vr,da({kind:1,text:ya,start:L.start,length:L.length}),bb.Le=0,bb.fM=0):(va=Dm(bb),w.ULS.sendTraceTag(520495426,1,50,"FormulaAssistanceValuePreviewRequester.requestFromServer: getPartialCalcResults failed, "+
va),da({kind:0}),bb.Le=0)})})});ia.then(function(){P.Nbb.set(L,ia);P.Nbb.set(O,ia)}).catch(function(da){w.ULS.sendTraceTag(520495425,1,15,"FormulaAssistanceValuePreviewRequester.requestFromServer: serverPromise failed, "+da)});return ia}))})})};h.prototype.UUh=function(L){return Object(A.a)(this,void 0,void 0,function B(){var Q=this,U;return Nm(B,function(X){U=Q;return X.return(new Promise(function(P,ea){var ia={Formula:L,PartialFormula:L,SourceRange:Object(N.v)(U.gridView.ha.sa.activeCell,U.$)},
da=U.$.oa.va;P=U.OSi(P,ea);ea=U.NSi(ea);var xa=da.Na(1,null);xa.getPartialCalcResultsParameters=ia;Object(T.g)(da,"GetPartialCalcResults",xa,P,ea,null,null,4)}))})})};Object(t.a)(h,"FormulaAssistanceValuePreviewRequester",null,[]);e.prototype.has=function(L){L=this.cWd(L);return this.map.has(L)};e.prototype.get=function(L){L=this.cWd(L);return this.map.get(L)};e.prototype.set=function(L,O){L=this.cWd(L);this.map.set(L,O);return this};e.prototype.clear=function(){this.map.clear()};Object(t.a)(e,"RequestMap",
null,[]);d.prototype.dispose=function(){this.Tj();this.handler.dispose();this.control.dispose()};d.prototype.Pi=function(){this.gridView.Wb.um(this.reset);this.gridView.ha.Rga(this.reset);this.$.ea.VD(this.fy)};d.prototype.Tj=function(){this.gridView.Wb.Nl(this.reset);this.gridView.ha.Sma(this.reset);this.$.ea.jD(this.fy)};d.prototype.TJf=function(L,O,B,Q){return Object(A.a)(this,void 0,void 0,function X(){var P,ea=this,ia;return Nm(X,function(da){if(1==da.Le)return P=Object.assign(Object.assign({},
L),{QA:B,kRd:Q}),ea.csb=P,da.Kj(O(L),2);ia=da.vr;if(Object(z.c)(ia)||!ea.Pmi(P))return da.return();void ea.b5h(ia);da.Le=0})})};d.prototype.b5h=function(L){return Object(A.a)(this,void 0,void 0,function B(){var Q=this,U,X,P,ea,ia,da;return Nm(B,function(xa){U=Q.csb;X=U.text;P=U.QA;ea=U.kRd;switch(L.kind){case 0:Q.hide();break;case 1:case 2:Q.show(P,L,ea);break;case 3:if(!Q.jpi(L))break;Q.show(P,L,ea);ia={text:X,start:L.start,length:L.length};void Q.TJf(ia,L.next,P,ea);break;default:return da=L,xa.return(da)}xa.Le=
0})})};d.prototype.show=function(L,O,B){this.control.show(L,O,B);this.csb=void 0;this.dsb=O};d.prototype.hide=function(){this.control.hide();this.dsb=this.csb=void 0};d.prototype.Pmi=function(L){var O;if(O=this.csb)O=this.csb,O=O.text===L.text&&O.start===L.start&&O.length===L.length&&O.QA===L.QA&&O.kRd===L.kRd;return O};d.prototype.jpi=function(L){return!this.dsb||this.dsb.start!==L.start||this.dsb.length!==L.length||3===this.dsb.kind};Object(t.a)(d,"FormulaAssistanceValuePreview",null,[606,6]);var G=
b(50),I=b(37),K=u.a;$k(c,K);c.ka=function(L){L.da.Ga(497,new c(L))};c.prototype.create=function(){var L=this,O=this.$.da.za(496);O&&this.pb(O);var B=G.GetServiceTaskFactory.Ra(this.$.da,413,414,this.hb),Q=G.GetServiceTaskFactory.Ra(this.$.da,448,449,this.hb),U=G.GetServiceTaskFactory.Ra(this.$.da,19,153,this.hb);I.TaskExtensions.Aa(I.TaskExtensions.Vd([B,Q,U],this.la),function(){O=L.$.da.za(496);O||(O=new d(L.$,B.result,Q.result),L.$.da.Ga(496,O));L.pb(O)},this.la,3)};Object(t.a)(c,"FormulaAssistanceValuePreviewFactory",
u.a,[]);b.d(E,"a",function(){return a})},1410:function(t,E,b){function a(){h.a.Fa(function(O){c.ka(O)})}function c(O){var B=L.call(this)||this;B.$=O;B.Eb();return B}function d(O){var B=this;this.$=O;this.v_=null;this.UBb=-1;this.Mjc=null;this.Ojc=0;this.h$=Object.assign({},x);this.CM=Object.assign({},l);this.xY=Object.assign({},v);this.Zob=Object.assign({},m);this.Rda=Object.assign({},z);this.$ob={};this.r3a=Object.assign(Object.assign({},u),{isReactDialog:G.a.ipd()});this.Ef=function(Q,U){null!=
B.v_&&(1==Math.abs(B.UBb-B.$.ea.Ke)&&(Q=B.$.xa.pa.sheetId,U.Wqb&&U.sk.equals(B.v_.sk)&&B.Mjc===Q&&B.v_.fqb!==U.fqb&&B.Ojc++),1<=Math.abs(B.UBb-B.$.ea.Ke)&&(B.v_=null,B.UBb=-1,B.Mjc=null))};this.Fc=function(){B.suj();B.N9&&B.Cuj();B.$.sendBeaconTraceTag(88392384,50,!1,"{0}",B.getJsonForLogging())};this.N9=H.EwaSettings.isChangeGateEnabled("OfficeVSO:6378161_addKeptSmartSuggestionsMetric");this.U$a=new N.a;O.Bk(this.Fc);this.N9&&S.g(this.$).Gi.um(this.Ef)}function e(O){var B=this;this.Cqf=O;this.a0=
Object.assign({},A);this.P7b=[];this.nlc=-1;(this.Bqf=H.EwaSettings.isChangeGateEnabled("OfficeVSO:5999949_formulaTelemetryMetriThresholds"))&&O&&(this.a0.countAboveThresholds={},O.forEach(function(Q){return B.a0.countAboveThresholds[Q]=0}))}var h=b(10);t=b(0);var k=b(235),n=b(192),f={average:0,max:0,median:0,P75:0,P95:0},v={selectByArrowKeyCounter:0,selectByMouseHoverCounter:0,commitByTabKeyCounter:0,commitByEnterKeyCounter:0,commitByMouseClickCounter:0,commitWhileRequestPending:0},m={formulaAssistanceRequestAttemptedCounter:0,
formulaAssistanceRequestOptimizedCounter:0},x={argumentAssistanceCardInitialMode:void 0,argumentAssistanceCollapseCounter:0,argumentAssistanceExpandCounter:0,argumentAssistanceLearnMoreCounter:0,argumentAssistanceDismissCounter:0,argumentAssistanceDragCounter:0,argumentAssistanceDragTotalCounter:0,argumentAssistanceMoveCounter:0,argumentAssistanceMoveTotalCounter:0},l={smartSuggestionShownCounter:0,smartSuggestionSelectedCounter:0,smartSuggestionCommittedCounter:0,smartSuggestionKeptCounter:0,isCellContentOnlyEqualDuringEditCounter:0,
isCellContentFormulaCounter:0,smartSuggestionWouldSuggestInsidePivotCounter:0},u={dialogCommitedCounter:0,dialogShownCounter:0,argsDialogOpenedByRibbonCounter:0,argsDialogOpenedByDialogCounter:0,argsDialogCommitedCounter:0},A={count:0,countAboveThresholds:void 0,failedCount:0,firstAction:0,includingFirstAction:Object.assign({},f),excludingFirstAction:Object.assign({},f)},z={argumentAssistanceFlight:void 0,autoCompleteUIFlight:void 0,smartFormulaBarAutoCompleteFlight:void 0,smartFormulaBarAutoCompletePluginFlight:void 0,
anyPluginInitialized:void 0,formulaAssistanceRedesignFlight:void 0,NewInsertFunctionDialogFlight:void 0},y=b(54),w=b(110),D=b(28),H=b(1);e.prototype.FSa=function(){this.nlc=D.a.Ta.Wd.m};e.prototype.Aia=function(O){-1!==this.nlc&&(O?(this.onb(D.a.Ta.Wd.m-this.nlc),this.nlc=-1):this.a0.failedCount++)};e.prototype.kBh=function(){this.a0.excludingFirstAction=e.aTe(this.P7b);this.P7b.push(this.a0.firstAction);this.a0.includingFirstAction=e.aTe(this.P7b)};e.prototype.onb=function(O){var B=this;this.a0.count?
1E3>this.a0.count&&this.P7b.push(O):this.a0.firstAction=O;this.Bqf&&this.Cqf&&this.Cqf.forEach(function(Q){O>Q&&B.a0.countAboveThresholds[Q]++});this.a0.count++};e.aTe=function(O){var B=Object.assign({},f);0<O.length&&(w.i(O),B.median=O[Math.floor(.5*O.length)],B.P75=O[Math.floor(.75*O.length)],B.P95=O[Math.floor(.95*O.length)],B.max=O[O.length-1],B.average=w.g(O,function(Q){return Q})/O.length);return B};Object(t.a)(e,"PerformanceMeasurement",null,[]);var F=b(22),J=b(42),S=b(21),N=b(100),T;(function(O){O[O.function=
3]="function";O[O.namedRange=100]="namedRange";O[O.tableHeader=101]="tableHeader";O[O.letVariable=102]="letVariable";O[O.richEntity=103]="richEntity";O[O.lambda=104]="lambda";O[O.customFunction=105]="customFunction";O[O.table=106]="table";O[O.tableSpecialStructRef=107]="tableSpecialStructRef";O[O.richEntityEmptyCellRef=108]="richEntityEmptyCellRef"})(T||(T={}));Object(t.b)("CompletionItemKind",T);var G=b(36),I={},K=(I.argumentAssistanceOverall=[50,80,100,130,150,170,200],I.autoCompleteOverall=[50,
80,100,130,150,170,200],I);d.prototype.dispose=function(){this.$&&this.N9&&S.g(this.$).Gi.Nl(this.Ef)};d.prototype.oO=function(O){var B=this;O.forEach(function(Q){B.U$a.kb(Q)||B.U$a.ia(Q,new e(K[Q]));B.U$a.na(Q).FSa()})};d.prototype.gQ=function(O,B){var Q=this;B=void 0===B?!0:B;O.forEach(function(U){Q.U$a.kb(U)&&Q.U$a.na(U).Aia(B)})};d.prototype.MYf=function(O){var B="Undefined";switch(O){case 1:B="Collapsed";break;case 0:B="Expanded";break;case 2:B="Hidden"}this.h$.argumentAssistanceCardInitialMode=
B};d.prototype.i8b=function(O){var B=this;window.requestAnimationFrame(function(){B.gQ([O])})};d.prototype.W9e=function(O){var B=this;O.forEach(function(Q){Q=T[Q.kind];B.fgg(Q);B.$ob[Q].shownCounter++})};d.prototype.V9e=function(O){O=T[O];this.fgg(O);this.$ob[O].committedCounter++};d.prototype.getJsonForLogging=function(){return"{"+this.kU("SessionDetails",this.Rda)+","+this.kU("ArgumentAssistanceUsage",this.h$)+","+this.kU("FormulaSuggestionsUsage",this.CM)+","+this.kU("FunctionDialogUsage",this.r3a)+
","+this.kU("AutocompleteCardInteraction",this.xY)+","+this.kU("AutocompleteRenderOptimization",this.Zob)+","+this.kU("AutocompleteUsageByKind",this.$ob)+","+this.jYh()+"}"};d.prototype.Cuj=function(){this.CM.smartSuggestionKeptCounter=this.CM.smartSuggestionCommittedCounter-this.Ojc};d.prototype.suj=function(){this.Rda.argumentAssistanceFlight=this.b4a("Microsoft.Office.ExcelOnline.","ArgumentAssistancePlugin");this.Rda.autoCompleteUIFlight=this.b4a("Microsoft.Office.Excel.","AutoCompleteNewUI");
this.Rda.smartFormulaBarAutoCompleteFlight=this.b4a("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteFeatureIsEnabled");this.Rda.smartFormulaBarAutoCompletePluginFlight=this.b4a("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteIsEnabled");this.Rda.formulaAssistanceRedesignFlight=this.b4a("Microsoft.Office.Excel.","FormulaAssistanceRedesign");this.Rda.NewInsertFunctionDialogFlight=this.b4a("Microsoft.Office.Excel.","NewInsertFunctionDialog")};d.prototype.jYh=function(){for(var O=new n.a,
B=ik(this.U$a),Q=B.next();!Q.done;Q=B.next())Q=Q.value,Q.value.kBh(),O.add('"'+Q.key+'":'+y.a.xc(Q.value.a0));return'"PerfMeasurements": {'+O.toArray().join(",")+"}"};d.prototype.b4a=function(O,B){return F.a.contains(this.$.ya.FlightHolder.FlightId,B,!0)?H.EwaSettings.getBooleanFeatureGate(O+B,!1)?"T":"C":"None"};d.prototype.kU=function(O,B){return'"'+O.toString()+'":'+J.c(B)};d.prototype.fgg=function(O){this.$ob[O]||(this.$ob[O]={shownCounter:0,committedCounter:0})};Object(t.a)(d,"FormulaAssistanceTelemetryManager",
null,[608]);var L=k.a;$k(c,L);c.ka=function(O){O.da.Ga(492,new c(O))};c.prototype.create=function(){var O;this.pb(null!==(O=this.$.da.za(491))&&void 0!==O?O:this.$.da.Ga(491,new d(this.$)))};Object(t.a)(c,"FormulaAssistanceTelemetryManagerFactory",k.a,[]);b.d(E,"a",function(){return a})},1424:function(t,E,b){function a(){Type.registerNamespace("CAUI");c.main()}function c(){}function d(F,J,S,N){var T=this;this.K2d=this.u1=this.Di=this.BD=this.x8=null;this.nXb=F;this.mxg=N;this.nXb.WLa&&(this.Di=new u.a(3,
2,5E3,Object(v.a)(this,this.aOg,"authenticationCheckTask"),2),m.AFrameworkApplication.zi.Cg(this.Di),this.Ag(J,S));this.nXb.xnb(function(){T.wuf()});this.nXb.EYa(function(){T.xuf()})}function e(){}t=b(0);var h=b(640),k=b(634),n=b(631),f=b(1218);e.prototype.p$g=function(F,J){if(F&&!(1>F.length)&&J){var S=Object.assign(new n.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.N7g(F,S.ControlList);J.push(S)}};e.prototype.N7g=function(F,J){var S=Object.assign(new h.a,{ExternalId:"ContextCoauthors",
LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new k.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(J,S);J=Object.assign(new n.a,{Title:"",ControlList:[]});Array.add(S.Menu.MenuSectionList,J);this.W9g(F,J.ControlList)};e.prototype.W9g=function(F,J){for(var S=0;S<F.length;S++){var N=Object.assign(new f.a,{ExternalId:String.format("CoauthorPersona_{0}",S),Command:"336231556",DisplayName:F[S].userName,LabelText:F[S].userName,
ImageBackColor:F[S].color,PersonaId:F[S].email,IsAnonymous:F[S].isAnonymous});Array.add(J,N)}};Object(t.a)(e,"PresenceContextMenuSectionBuilder",null,[213]);var v=b(84),m=b(4),x=b(181),l=b(632),u=b(108),A=b(135),z=b(87),y=b(83),w=b(107),D=b(25);d.prototype.Ag=function(F,J){var S=m.AFrameworkApplication.ub;S.He(D.a.authenticationLost,w.a.frame,F,96);S.He(D.a.$se,w.a.frame,J,96);S.Mb(D.a.Uwe,w.a.frame,x.ActionManager.S6c);S.Mb(D.a.Vwe,w.a.frame,x.ActionManager.S6c);S.Mb(D.a.Ysd,w.a.frame,x.ActionManager.S6c)};
d.prototype.wuf=function(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);m.AFrameworkApplication.ub.processAction(D.a.authenticationLost,2)};d.prototype.xuf=function(){this.CJj();m.AFrameworkApplication.ub.processAction(D.a.$se,2)};d.prototype.aOg=function(){this.nXb.authenticationCheck()};d.prototype.CJj=function(){this.BD&&(this.BD.hide(),this.BD.dispose(),this.BD=null);this.x8&&this.businessBar&&(m.AFrameworkApplication.zg||this.businessBar.removeEntry(this.x8),this.x8.dispose(),
this.x8=null)};d.prototype.showDialog=function(F){z.a.Ia(this.BD);this.BD=new A.StandardDialog;this.mxg||(this.BD.Su=!1,this.BD.Rb=0);this.BD.kc(1,CommonUIStrings.l_SignIn);this.BD.fX(CommonUIStrings.l_DefaultDialogTitle,F,Object(v.a)(this,this.Xv,"dialogHandler"))};d.prototype.Xv=function(F){1===F?(l.a.N6(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),m.AFrameworkApplication.ub.processAction(D.a.Ysd,2)):(this.SRd(),m.AFrameworkApplication.ub.processAction(D.a.Vwe,
2))};d.prototype.SRd=function(){this.businessBar&&this.eve&&(this.x8=this.eve.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.x8.closeable=!0,this.x8.addButton(CommonUIStrings.l_SignIn,d.wTg,""),this.x8.I$=Object(v.a)(this,this.zTg,"businessBarEntryCloseHandler"),this.businessBar.QD(this.x8,!1))};d.prototype.zTg=function(){this.Tgh();m.AFrameworkApplication.ub.processAction(D.a.Uwe,2)};d.prototype.Tgh=function(){this.Di&&(m.AFrameworkApplication.zi.Ep(this.Di),
this.Di=null)};d.prototype.dispose=function(){this.Di=this.BD=this.x8=null};d.wTg=function(){l.a.N6();m.AFrameworkApplication.ub.processAction(D.a.Ysd,2)};of.Object.defineProperties(d.prototype,{businessBar:{configurable:!0,enumerable:!0,get:function(){return this.u1||(this.u1=y.a.instance.nh("CommonUI.IBusinessBar"))}},eve:{configurable:!0,enumerable:!0,get:function(){return this.K2d||(this.K2d=y.a.instance.nh("CommonUI.IBusinessBarEntryFactory"))}}});Object(t.a)(d,"SignOutResponseUI",null,[6]);
var H=b(258);c.prototype.Sh=function(F){F.register(e,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").tc()};c.prototype.init=function(){};c.prototype.dispose=function(){z.a.Ia(c.g2);c.g2=null};c.main=function(){H.a.instance.Qi(new c)};of.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.UI"}}});c.g2=null;Object(t.a)(c,"CommonAppUIPackage",null,[10,11]);b.d(E,"a",function(){return a})},
1428:function(t,E,b){function a(vb,Ka,eb,yb){var oc=ub.call(this,vb,"PopulateGridContextMenu",1247109494,-2064931494,a.s2h,!0,!1,a.NJb,Ka,eb,!0,yb)||this;oc.OAa=!1;oc.Zva=!1;oc.lZ=!1;oc.refresh=!1;oc.expandCollapse=!1;oc.Hic=!1;oc.hEe=!0;oc.grid=ha.g(vb);oc.plc=!0;oc.jgc=xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GridContextMenuFilterByValue",!1);if(oc.jgc){var Jb=bb.GetServiceTaskFactory.Ra(oc.$.da,309,310,3),dc=bb.GetServiceTaskFactory.create(oc.$.da,18,oc.la,3);ea.TaskExtensions.Aa(ea.TaskExtensions.Vd([Jb,
dc],oc.la),function(){oc.$.da.Za(268,function($a){oc.P4a=new c(vb,Jb.result,dc.result,$a)})},oc.la,3)}return oc}function c(vb,Ka,eb,yb){this.IWc=this.Keb=this.Meb=0;this.$=vb;this.gridView=ha.g(this.$);this.namedSheetViewPublic=Ka;this.Hg=eb;this.instantaneousSupportInformationManager=yb;this.BMa=Ra.a.Fmd()}function d(vb){this.ranges=null;this.ranges=vb}function e(vb,Ka,eb,yb,oc,Jb,dc,$a){this.$=Ka;this.Va=eb;this.tl=yb;this.selectedRanges=oc;this.grid=Jb;this.ty=$a;this.wba=dc;this.Xra=v.a.all(oc,
function(Ba){return Ba.isRow});this.aha=v.a.all(oc,function(Ba){return Ba.We});this.WDb=v.a.all(oc,function(Ba){return!Ba.isRow&&!Ba.We});Ka=Jb.Ab.Pgd(oc);this.b5b=!!Ka;this.cSf=!!Ka&&Ka.hasActiveFilter;this.menuSection=eb.Bc();vb.pc.push(this.menuSection);this.pka=this.Xra||this.aha?this.menuSection:eb.Bc();this.Gta=this.Xra||this.aha?this.menuSection:eb.Bc()}b.r(E);t=b(0);var h=b(15),k=b(293),n=b(92),f=b(39),v=b(278),m=b(620),x=b(4),l=b(85),u=b(445),A=b(938),z=b(9),y=b(30),w=b(19),D=b(60),H=b(5),
F=b(1010),J=b(1262),S=b(1059),N=b(14),T=b(36);e.prototype.lcd=function(){this.LGh();this.oGh();var vb=this.ty.h7a(this.selectedRanges,this.grid);this.menuSection.buttons.push(this.Va.lb(vb?149:148))};e.prototype.QGh=function(){var vb=0;this.b5b?this.wba.zm(942362098)?vb=this.ty.zm(this.tl,942362098,this.selectedRanges,this.grid)?161:169:this.cSf&&(vb=this.ty.zm(this.tl,-1113896058,this.selectedRanges,this.grid)?177:181):this.wba.zm(-1113896058)&&(vb=this.Xra?this.ty.zm(this.tl,-1113896058,this.selectedRanges,
this.grid)?49:116:this.ty.zm(this.tl,-1113896058,this.selectedRanges,this.grid)?177:181);0!==vb&&this.pka.buttons.push(this.Va.lb(vb))};e.prototype.MGh=function(){var vb=0;this.b5b?this.wba.zm(622604322)&&(vb=this.grid.rtl?this.ty.zm(this.tl,622604322,this.selectedRanges,this.grid)?191:192:this.ty.zm(this.tl,622604322,this.selectedRanges,this.grid)?162:170):this.wba.zm(1415868706)&&(vb=T.a.$zb()&&this.grid.rtl?this.aha?this.ty.zm(this.tl,1415868706,this.selectedRanges,this.grid)?288:289:this.ty.zm(this.tl,
1415868706,this.selectedRanges,this.grid)?290:291:this.aha?this.ty.zm(this.tl,1415868706,this.selectedRanges,this.grid)?50:117:this.ty.zm(this.tl,1415868706,this.selectedRanges,this.grid)?178:182);0!==vb&&this.pka.buttons.push(this.Va.lb(vb))};e.prototype.KGh=function(){this.wba.zm(1035996630)&&(this.ty.zm(this.tl,1035996630,this.selectedRanges,this.grid)?(this.pka.buttons.push(this.Va.lb(this.grid.rtl?187:165)),this.pka.buttons.push(this.Va.lb(166))):(this.pka.buttons.push(this.Va.lb(this.grid.rtl?
188:173)),this.pka.buttons.push(this.Va.lb(174))))};e.prototype.LGh=function(){var vb=b(1428).GridContextMenu,Ka=null;this.WDb&&(Ka=this.Va.Tv("ContextMenu.InsertCells",null,N.a.instance.ga(350),1896159024),Ka.menu.pc.push(this.pka));vb.NGh(this.pka,this.Va,this.$);this.QGh();this.MGh();this.KGh();Ka&&0<this.pka.buttons.length&&this.menuSection.buttons.push(Ka)};e.prototype.qGh=function(){var vb=0;this.b5b?this.wba.zm(1405456548)?vb=this.ty.zm(this.tl,1405456548,this.selectedRanges,this.grid)?163:
171:this.cSf&&(vb=this.ty.zm(this.tl,1554436520,this.selectedRanges,this.grid)?179:183):this.wba.zm(1554436520)&&(vb=this.Xra?this.ty.zm(this.tl,1554436520,this.selectedRanges,this.grid)?51:118:this.ty.zm(this.tl,1554436520,this.selectedRanges,this.grid)?179:183);0!==vb&&this.Gta.buttons.push(this.Va.lb(vb))};e.prototype.pGh=function(){var vb=0;this.b5b?this.wba.zm(284490184)&&(vb=this.ty.zm(this.tl,284490184,this.selectedRanges,this.grid)?164:172):this.wba.zm(674605324)&&(vb=this.aha?this.ty.zm(this.tl,
674605324,this.selectedRanges,this.grid)?52:119:this.ty.zm(this.tl,674605324,this.selectedRanges,this.grid)?180:184);0!==vb&&this.Gta.buttons.push(this.Va.lb(vb))};e.prototype.nGh=function(){this.wba.zm(1035996630)&&(this.ty.zm(this.tl,1035996630,this.selectedRanges,this.grid)?(this.Gta.buttons.push(this.Va.lb(this.grid.rtl?189:167)),this.Gta.buttons.push(this.Va.lb(168))):(this.Gta.buttons.push(this.Va.lb(this.grid.rtl?190:175)),this.Gta.buttons.push(this.Va.lb(176))))};e.prototype.oGh=function(){var vb=
null;this.WDb&&(vb=this.Va.Tv("ContextMenu.DeleteCells",null,N.a.instance.ga(413),-1554384558),vb.menu.pc.push(this.Gta));this.qGh();this.pGh();this.nGh();vb&&0<this.Gta.buttons.length&&this.menuSection.buttons.push(vb)};Object(t.a)(e,"CellsContextMenuGenerator",null,[]);Object(t.a)(d,"MacroRecorderRangeHyperlinkRemovedPayload",null,[430]);var G=b(597),I=b(24),K=b(103),L=b(76),O=b(78),B=b(41),Q=b(177),U=b(62),X=b(710),P=b(151),ea=b(37),ia=b(499),da=b(629),xa=b(1),Z=b(187),ha=b(21),ya=b(395),va=b(33),
bb=b(50),ba=b(252),fa=b(22),ra=b(29),pa=b(1286),Za=b(1125),Ua=b(133),Ma=b(572),oa=b(394),ja=b(259),ta=b(169),aa=b(160),ma=b(361),Ea=b(91),Ha=b(31),Aa=b(299),V=b(298),La=b(134),Ra=b(993),pb=b(994),cb=b(112),Sa=b(42),Db=b(58),Ab;(function(vb){vb[vb.none=0]="none";vb[vb.once=1]="once";vb[vb.twice=2]="twice"})(Ab||(Ab={}));Object(t.b)("ToggleState",Ab);c.prototype.hih=function(){var vb=this.aV(),Ka={};vb=(Ka.CommandValueId=Sa.c(vb),Ka);Ka=new Ea.a(-2058042992,2,this.$.Jc,19,null);h.ULS.sendTraceTag(527500302,
0,50,"GridContextMenuFilter::DoClearFilter GridContextMenu ClearFilter command executed");return this.$.Ka.Kb(Ka,vb)};c.prototype.xih=function(){var vb=new Ea.a(644342024,2,this.$.Jc,19,null);h.ULS.sendTraceTag(527500301,0,50,"GridContextMenuFilter::DoReapplyFilter GridContextMenu ReapplyFilter command executed");return this.$.Ka.Kb(vb)};c.prototype.mih=function(){var vb=this.gridView.ha.sa.activeCell,Ka=this.$.da.za(66).Fg,eb=this.$.da.za(66).cvb(vb);return Ka||eb?this.oih(Ka,eb,vb):this.nih(vb)};
c.prototype.oih=function(vb,Ka,eb){if(this.PXg(vb,Ka,eb))return h.ULS.sendTraceTag(527500300,0,50,"GridContextMenuFilter::DoFilterByValue Header/Total error dialog raised for FilterByValue in Table"),Db.Task.Ua(!1);if(null!=vb&&vb.hasAutoFilter||null!=Ka&&Ka.q_a.every(function(yb){return 0!=yb.length}))return this.Meb=Ab.none,this.GWc();this.Meb=Ab.once;return this.x7b(Ab.once)};c.prototype.nih=function(vb){var Ka=B.v(this.gridView.ha.sa.Vc,this.$);Ka=this.gridView.$.xa.getItemByName(Ka.SheetName);
var eb=B.D(Ka.L0);if(this.OXg(eb,vb))return h.ULS.sendTraceTag(527500299,0,50,"GridContextMenuFilter::DoFilterByValue Header/EmptyRange error dialog raised for FilterByValue in Sheet"),Db.Task.Ua(!1);if(Ka.hasAutoFilter){if(eb&&eb.contains(this.gridView.ha.sa.activeCell))return this.Meb=Ab.none,this.GWc();this.Meb=Ab.twice;return this.x7b(Ab.twice)}this.Meb=Ab.once;return this.x7b(Ab.once)};c.prototype.x7b=function(vb){function Ka($a){Aa.a($a)?h.ULS.sendTraceTag(527500297,0,50,"GridContextMenuFilter::ToggleFilter service call failed with errors : {}"):
(h.ULS.sendTraceTag(527500298,0,50,"GridContextMenuFilter::ToggleFilter service call succeeded"),vb===Ab.twice?yb.x7b(Ab.once):yb.GWc())}function eb(){return new pa.a(oc)}var yb=this,oc=B.v(this.gridView.ha.sa.Vc,this.$);if(!oc)return Db.Task.Ua(!1);this.Keb||(this.Keb=Date.now());var Jb=new Ea.a(368460465,2,this.$.Jc,19,null),dc=this.$.oa.va.Pb();return xa.EwaSettings.Zb()?oa.a(this.$.userOperationManager,function($a,Ba,la){return ja.A(yb.$.oa.va,oc,V.b($a,Ka),Ba,la,null,dc)},function($a){return new Q.a(516,
0,$a,64,eb)},Jb):oa.a(this.$.userOperationManager,function($a,Ba,la){return ja.A(yb.$.oa.va,oc,V.b($a,Ka),Ba,la,null,dc)},function($a){return new Ma.a(516,0,$a,void 0,eb)},Jb)};c.prototype.PXg=function(vb,Ka,eb){return null!=vb&&ta.d(vb)&&eb.top===vb.usedRange.top||null!=Ka&&Ka.lba&&eb.top===Ka.top?(this.mrc(this.$,225),!0):null!=vb&&ta.g(vb)&&eb.top===vb.usedRange.bottom?(this.mrc(this.$,226),!0):!1};c.prototype.OXg=function(vb,Ka){if(vb&&vb.contains(Ka)&&Ka.top===vb.top||!vb&&this.PWg(Ka.top,Ka.left))return this.mrc(this.$,
227),!0;vb=new I.Range(Ka.top,Ka.left,Ka.top+1,Ka.left+1,!1,!1);return this.gridView.Ab.bxa(vb)?(this.mrc(this.$,228),!0):!1};c.prototype.mrc=function(vb,Ka){Ka=Ha.a.Xc(1,1,754,Ka,0,147079615,"ContextMenuFilterByCellValueError");xa.EwaSettings.oz()?new ma.a(vb,Ka):(vb=new aa.ErrorDialog(vb,Ka),vb.initialize(),vb.qf())};c.prototype.GWc=function(){function vb($a){var Ba={};Ba=(Ba.ToggleFilterOperationCount=Ka.Meb,Ba.ApplyFilterTime=Ka.IWc?Date.now()-Ka.IWc:-1,Ba.ToggleAndApplyFilterTime=Ka.Keb?Date.now()-
Ka.Keb:-1,Ba.FilterByValueType=yb.AutoFilterType,Ba);h.ULS.sendTraceTag(527500295,0,50,"GridContextMenuFilter::ApplyFilterByValue Perf Telemetry : "+JSON.stringify(Ba));Ka.Keb&&(Ka.Keb=0);Ra.a.yxc($a)&&(Ba=Ra.a.wac($a),Ka.BMa?Ra.a.wQa(pb.a.filterByCellValue,Ba.MessageIdName,cb.a.ksa,!0,Ra.a.isSessionEndingError(Ba.MessageId)):h.ULS.sendTraceTag(527500294,0,10,"GridContextMenuFilter::ApplyFilterByValue failed with FilterException -"+Ba.MessageIdName));Aa.a($a)?h.ULS.sendTraceTag(527500292,0,50,"GridContextMenuFilter::ApplyFilterByValue service call failed with errors : {}"):
(h.ULS.sendTraceTag(527500293,0,50,"GridContextMenuFilter::ApplyFilterByValue service call succeeded"),La.b(Ka.$).yd(Ua.a.Qxf,Ka.em(),void 0,!0),$a={},$a.FirstRow=Ka.vPh(),$a.FirstColumn=yb.Column,-1!==$a.FirstRow&&($a=B.C($a),Ka.nL($a)))}var Ka=this;this.IWc=Date.now();var eb=this.K0h();if(!eb)return h.ULS.sendTraceTag(527500296,0,50,"GridContextMenuFilter::ApplyFilterByValue . CellValue returned is null"),Db.Task.Ua(!1);var yb=this.aV(),oc={FirstRow:0};oc.FirstColumn=yb.Column;oc.SheetName=yb.SheetName;
La.b(this.$).yd(Ua.a.ouf,this.em(),void 0,!0);var Jb=this.n3c(yb,oc),dc=new Q.a(208,0,function($a,Ba,la){return U.a(Ka.$.oa.va,Jb,eb,V.b($a,vb),Ba,la,null,null)},6,function(){return new Za.a(eb,Jb)});this.namedSheetViewPublic?this.namedSheetViewPublic.RAa().continueWith(function($a){$a.result&&Ka.$.userOperationManager.Sb(dc,null)}):this.$.userOperationManager.Sb(dc,null);return Db.Task.Ua(!0)};c.prototype.nL=function(vb){T.a.Oba(this.$)&&ea.TaskExtensions.Aa(bb.GetServiceTaskFactory.Ra(this.$.da,
430,431,1),function(Ka){Ka.result.vea(vb);h.ULS.sendTraceTag(527500291,306,50,"GridContextMenuFilter:TriggerPivotTableHandRaise Trigger hand raise from context menu filterByValue.")},this.$.la,3)};c.prototype.em=function(){var vb={};return vb.Location="contextMenu",vb};c.prototype.aV=function(){var vb=0,Ka=this.gridView.ha.sa.activeCell;var eb=this.$.da.za(66).Fg;var yb=this.$.da.za(66).cvb(Ka);if(eb){var oc="Table";vb=eb.objectId}else yb?(oc="Table",vb=yb.id):oc="Sheet";eb=Ka.left;Ka={};Ka.AutoFilterType=
oc;Ka.Column=eb;Ka.Id=vb;oc={};this.$.Oj(oc);oc.FirstRow=0;oc.FirstColumn=Ka.Column;vb=this.$.ea.isNamedObjectViewMode;Ka.NamedObjectView=vb;Ka.SheetName=vb?oc.NamedObjectName:oc.SheetName;Ka.ItemListOptions=null;return Ka};c.prototype.PWg=function(vb,Ka){vb=I.Range.Qc(vb,Ka);return this.gridView.Ea.o$(vb,this.$.pa.name)&&(vb=this.gridView.Ea.tKa(vb))&&vb.autoFilterMenu?!0:!1};c.prototype.K0h=function(){var vb=null,Ka=this.gridView.Ub(this.gridView.ha.sa.activeCell);if(!Ka)return null;var eb=Ka.cell.ITd;
var yb=this.instantaneousSupportInformationManager.ATa(eb,!1).category;if(1===Ka.Rw.type)if(3===yb){if(!Ka.cell.s9a)return h.ULS.sendTraceTag(527500290,0,15,"GridContextMenuFilter::GetValueForFilter() for category : "+yb+". NumFmt is null. "),null;vb=(Ka.cell.s9a.Start+Ka.cell.s9a.End).trim()}else if(!yb&&(fa.a.C0a(Ka.Rw.value,"E")||fa.a.C0a(Ka.originalText,"E"))){vb=this.Hg.VUe(Ka.Rw.value,eb,1,Number.POSITIVE_INFINITY,Ka.cell.Z$);if(!vb.success)return h.ULS.sendTraceTag(527500289,0,50,"GridContextMenuFilter::GetValueForFilter() for category : "+
yb+". Failed to acquire formatted value"),null;vb=vb.ez}vb||(vb=Ka.originalText);return ra.a.i0c(vb)?["[Blanks]"]:["i"+vb.trim()]};c.prototype.vPh=function(){var vb=this.gridView.ha.sa.activeCell,Ka=this.$.da.za(66).Fg,eb=this.$.da.za(66).cvb(vb);if(Ka)return Ka.usedRange.top;if(null!=eb)return eb.top;Ka=this.$.xa.getItemByName(this.$.pa.sheetName);return(Ka=B.D(Ka.L0))&&Ka.contains(vb)?Ka.top:-1};c.prototype.n3c=function(vb,Ka){var eb={};eb.Location=Ka;eb.FieldId=vb.Id.toString();eb.DataSourceIndex=
-1;eb.FilterType=vb.AutoFilterType;eb.AnchorType=0;eb.ChartId=null;eb.AnchorValue1=-1;eb.AnchorValue2=-1;eb.Property=vb.RichProperty;return eb};Object(t.a)(c,"GridContextMenuFilter",null,[]);var Wb=b(189);b.d(E,"GridContextMenu",function(){return a});var ub=A.a;$k(a,ub);a.prototype.dispose=function(){ub.prototype.dispose.call(this);this.grid=null};a.prototype.Nc=function(vb,Ka){vb=!this.kqd(vb,Ka);if(!vb)switch(Ka){case -1977666927:vb=null==this.P4a||this.Lxj();break;case 1549396389:vb=null==this.P4a||
!this.Dgi();break;case 2045563128:case 1803952894:vb=null==this.P4a||!this.$.isEditMode&&!this.Egi()}return vb};a.prototype.kqd=function(vb,Ka){var eb=this.grid.ha.sa.selectedRanges;return(new P.a(this.$.xa)).zm(vb,Ka,eb,this.grid)};a.prototype.executeCommand=function(vb,Ka,eb){var yb=Ka.command;vb=null;switch(yb){case -1396319072:if(Ka=this.grid.Ub(null))k.a.instance.WZc(!0),n.EventHandlerManager.instance.zbd(),a.UVi(Ka);break;case -1253126584:this.removeHyperlinksFromRange(this.grid.ha.sa.selectedRanges,
Ka);break;case 324156914:vb=this.grid.startEdit(!1,1);break;case 1441131127:this.showGridContextMenu(eb);break;case -1977666927:vb=this.P4a.hih();break;case 1549396389:vb=this.P4a.xih();break;case 1803952894:vb=this.P4a.mih();break;default:vb=Z.a(yb)}return vb||ea.TaskExtensions.eba()};a.prototype.Ac=function(vb,Ka,eb){vb=!1;switch(Ka.command){case -1396319072:case -1253126584:case 324156914:case -1977666927:case 1549396389:case 1803952894:vb=!0;break;case 1441131127:vb=!!eb}return vb};a.prototype.UY=
function(vb){vb=void 0===vb?!1:vb;var Ka=!1,eb=!1,yb=0;xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(yb=f.a.Qd());var oc=this.Va.kq(this.menuId),Jb=this.grid.ha.sa,dc=Jb.rg,$a=dc&&Jb.Vc.We,Ba=dc&&Jb.Vc.isRow;Jb=Jb.selectedRanges;var la=v.a.all(Jb,function(jb){return jb.We}),ka=v.a.all(Jb,function(jb){return jb.isRow}),ca=B.O(Jb),Ia=B.P(Jb);this.Tff($a,Ba)?(Ka=!0,this.tHh(oc)):this.$.isEditMode?ya.a(this.$)?this.uHh(oc,$a,Ba):(this.rGh(oc,!(Ba||$a||
!this.Hic)),this.OGh(oc,Jb,vb),this.DGh(oc,la,ka,ca,Ia),this.gWe(oc,dc,$a,Ba),this.MHh(oc),this.MVe(oc,$a,Ba),this.jHh(oc,dc,$a,Ba,Jb),this.uGh(oc),this.sGh(oc,Jb),this.VGh(oc),this.HHh(oc,dc),xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImmersiveReader",!1)&&this.IGh(oc)):(eb=!0,ya.a(this.$)?this.bWe(oc):this.bIh(oc,dc,$a,Ba,Jb));xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(vb=f.a.Qd()-yb,h.ULS.sendTraceTag(537167046,0,50,"GridContextMenu::CreateMenuModel, ExecutionTimeTotal: "+
vb+", isPivotMenu: "+Ka+", isViewMenu: "+eb+", firstTimeEntry: "+this.hEe));this.hEe=!1;return oc};a.prototype.iKa=function(vb){var Ka=[];if(ya.a(this.$))return Ka;if(3===vb){vb=this.grid.ha.sa;var eb=vb.rg,yb=eb&&vb.Vc.We,oc=eb&&vb.Vc.isRow,Jb=!1,dc=!1,$a=!1;this.$.isMobileMode&&(dc=vb.selectedRanges,Jb=B.O(dc),dc=B.P(dc));if(eb){var Ba=ha.e(this.grid);Ba&&Ba.range.contains(vb.Vc)&&this.wV(Ba)&&($a=!0)}this.$.isEditMode?this.Tff(yb,oc)?Ka.push.apply(Ka,[S.a.dHf,S.a.fHf]):yb||oc?(Ka.push(S.a.clipboard),
oc?Ka.push(S.a.Zjj):yb&&Ka.push(S.a.o0g)):(Ka.push.apply(Ka,[S.a.edit,S.a.clipboard]),$a?Ka.push(S.a.hyperlink):Ka.push(S.a.color),eb&&Ka.push(S.a.iOg)):(Ka.push(S.a.copy),$a&&Ka.push(S.a.openHyperlink),!oc||this.$.isMobileMode&&dc?!yb||this.$.isMobileMode&&Jb||Ka.push(S.a.TXj):Ka.push(S.a.UXj));Ka.push(S.a.j2h)}else 2===vb&&Ka.push(S.a.rxe);return Ka};a.prototype.Tff=function(vb,Ka){return(this.OAa||this.Zva||this.lZ||this.refresh||this.expandCollapse)&&!(vb||Ka)};a.prototype.showGridContextMenu=
function(vb){this.expandCollapse=this.refresh=this.lZ=this.Zva=this.OAa=!1;var Ka=this.$,eb=ia.a(Ka).wKa(),yb=this.grid.ha.sa,oc=yb.rg,Jb=oc&&yb.Vc.We;yb=oc&&yb.Vc.isRow;if(eb&&!Jb&&!yb){Jb=da.a(Ka);if(null===Jb||void 0===Jb?0:Jb.bRd)this.OAa=Jb=K.f(Ka.mg),this.Zva=!Jb;Jb=Ka.ic;this.lZ=eb.supportsBIExplore&&!!F.a(Ka)&&Jb.N2(32768);Jb.allowInteractivity&&(Ka=this.grid.Ub(null),(null===Ka||void 0===Ka?0:Ka.cell)&&(Ka.cell.LZc||Ka.cell.Y2f)&&(this.expandCollapse=!0),Jb.allowManualDataRefresh&&(this.refresh=
!0))}Ka=null;eb=1;Jb=Object(l.a)(m.a,vb.eventArgs);vb=Object(l.a)(J.a,vb.creationParams);yb=this.yMh();vb?(Ka=vb.clientPoint,eb=vb.inputMethod):Jb&&1!==Jb.nb?(Ka=new Sys.UI.Point(Jb.clientPoint.x,Jb.clientPoint.y),eb=Jb.nb):yb&&(Ka=new Sys.UI.Point(yb.x+(this.$.isChromeRtl?0:yb.width),yb.y+yb.height));L.a.Cb=eb;this.Hic=3===eb;vb=y.a.Ptb;this.hp(Ka,!Jb||Jb.Ca.target.className!==vb,eb)};a.prototype.removeHyperlinksFromRange=function(vb,Ka){var eb=this;if(!xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||
this.$.iq(vb,!0)){var yb=B.r(vb,this.$),oc=this.$.oa.va.Pb();this.$.userOperationManager.Sb(new Q.a(125,0,function(Jb,dc,$a){eb.$.py();return U.b(eb.$.oa.va,yb,"","",!0,!1,127,Jb,dc,$a,null,oc)},void 0,function(){return new d(yb)}),Ka);this.grid.ig.HG(!1)}};a.prototype.yMh=function(){var vb=this.grid.Ub(null);if((null===vb||void 0===vb?0:vb.cell.tk)&&this.Yef(vb))return this.grid.getCellBounds(vb.cell);vb=this.grid.ha.sa.activeCell;return(vb=this.f$b(new I.Range(vb.top,vb.left,z.a.uh,vb.left,!1,!1),
2,!0)||this.f$b(new I.Range(1,vb.left,vb.top,vb.left,!1,!1),2,!1)||this.f$b(new I.Range(vb.top,vb.right,vb.top,z.a.Eh,!1,!1),1,!0)||this.f$b(new I.Range(vb.top,1,vb.top,vb.right,!1,!1),1,!1)||null)&&vb.tk?this.grid.getCellBounds(vb):Sys.UI.DomElement.getBounds(this.grid.Tva.hc)};a.prototype.Yef=function(vb){var Ka=this.grid.rtl,eb=this.$.isChromeRtl;vb=vb.cell;var yb=ha.g(this.$).OJ(vb);return yb?(yb=yb.topLeft,Ka=yb.x+=Ka===eb?vb.offsetWidth:0,eb=yb.y+=vb.offsetHeight,this.grid.view.visibleArea.contains(new D.a(Ka,
eb,0,0))):!1};a.prototype.f$b=function(vb,Ka,eb){vb=this.grid.Xj("GridContextMenu.FindFirstCellInViewportArea",vb,Ka,eb);try{for(vb.$$rst();vb.$$mn();){var yb=vb.$$cu();if(yb&&this.Yef(yb))return yb.cell}}finally{vb&&vb.dispose()}return null};a.prototype.tHh=function(vb){var Ka=this.Va,eb=Ka.Bc();this.refresh&&eb.buttons.push(Ka.lb(100));this.lZ&&eb.buttons.push(Ka.lb(99));this.OAa?eb.buttons.push(Ka.lb(59)):this.Zva&&eb.buttons.push(Ka.lb(58));if(this.expandCollapse){var yb=Ka.Tv("ContextMenu.PivotExpandCollapse",
null,N.a.instance.ga(1156),589118293);var oc=Ka.Bc();oc.buttons.push(Ka.lb(243));oc.buttons.push(Ka.lb(244));oc.buttons.push(Ka.lb(245));oc.buttons.push(Ka.lb(246));yb.menu.pc.push(oc);yb&&0<oc.buttons.length&&eb.buttons.push(yb)}vb.pc.push(eb)};a.prototype.gWe=function(vb,Ka,eb,yb){if(Ka&&!eb&&!yb){Ka=this.Va.Bc();this.jgc&&!this.$.$M&&this.qcd(Ka);this.xcd(Ka);this.QHh(Ka);if(xa.EwaSettings.ma(481)&&ha.g(this.$).ha.sa.$J()&&ha.g(this.$).ha.sa.w5)switch(xa.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",
0)){case 1:Ka.buttons.push(this.Va.lb(237));break;case 2:Ka.buttons.push(this.Va.lb(238));break;default:Ka.buttons.push(this.Va.lb(236))}vb.pc.push(Ka)}};a.prototype.xcd=function(vb){if(!xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6172529_FixAllowSort")||this.$.ic.allowSorting)if(!this.$.isMobileMode||(new P.a(this.$.xa)).Ud(2048)){var Ka=this.Va.Bc();Ka.buttons.push(this.Va.lb(223));Ka.buttons.push(this.Va.lb(224));xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PutSelectedItemOnTop",
!1)&&(Ka.buttons.push(this.Va.lb(292)),Ka.buttons.push(this.Va.lb(293)),Ka.buttons.push(this.Va.lb(294)));this.$.isMobileMode||Ka.buttons.push(this.Va.lb(225));var eb=this.Va.Tv("ContextMenu.sort",null,N.a.instance.ga(229),-864298118);eb.menu.pc.push(Ka);vb.buttons.push(eb)}};a.prototype.qcd=function(vb){var Ka=this.Va.Tv("ContextMenu.filter",null,N.a.instance.ga(1952),2045563128),eb=this.Va.Bc(),yb=this.YQh(),oc=this.Va.lb(234);oc.label=yb;eb.buttons.push(oc);eb.buttons.push(this.Va.lb(235));yb=
this.Va.Bc();yb.buttons.push(this.Va.lb(233));Ka.menu.pc.push(eb);Ka.menu.pc.push(yb);vb.buttons.push(Ka)};a.prototype.QHh=function(vb){if(ha.g(this.$).ha.sa.$J()){var Ka=this.Va.Bc();Ka.buttons.push(this.Va.lb(232));xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6680193_FlighRemovalTableAltText")&&(Ka.buttons.push(this.Va.lb(285)),Ka.buttons.push(this.Va.lb(286)));var eb=this.Va.Tv("ContextMenu.table",null,N.a.instance.ga(1951),-697806646);eb.menu.pc.push(Ka);vb.buttons.push(eb)}};a.prototype.XVe=
function(vb,Ka,eb,yb,oc){if(Ka){var Jb=B.K(oc),dc=ha.e(this.grid);if(dc&&!eb&&!yb){eb=new P.a(this.$.xa);if(dc.range.contains(Jb)&&this.wV(dc)){(Ka=!dc.rMa&&!eb.fj)&&this.$.isEditMode&&vb.buttons.push(this.Va.lb(45));dc.kba&&vb.buttons.push(this.Va.lb(53));Ka&&this.$.isEditMode&&vb.buttons.push(this.Va.lb(47));return}!dc.rMa&&this.$.isEditMode&&(dc=eb.Ud(128),vb.buttons.push(this.Va.lb(dc?46:121)))}}this.P5i(oc)&&vb.buttons.push(this.Va.lb(48));(dc=this.$.xa.pa)&&dc.Kd&&(dc=dc.Kd.Ux||dc.Kd.eK,!Ka||
this.$.$M||!xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.ea.isNamedObjectViewMode||this.$.isMobileMode||dc||(Ka=B.K(oc),this.O5i(Ka)?vb.buttons.push(this.Va.lb(276)):Ka.We||Ka.isRow||vb.buttons.push(this.Va.lb(275))))};a.prototype.P5i=function(vb){vb=ik(vb);for(var Ka=vb.next();!Ka.done;Ka=vb.next()){Ka=this.grid.getRangeInformation(Ka.value);for(var eb=0;eb<Ka.length;eb++)if(Object(u.a)(G.HyperlinkRange,Ka[eb])){var yb=this.grid.Ub(Ka[eb]);if(yb&&this.wV(yb)&&
!yb.rMa)return!0}}return!1};a.prototype.O5i=function(vb){if(ha.g(this.$).ha.sa.$J()){var Ka=ha.g(this.$).Ab.dk(vb);if(Ka&&Ka.usedRange.equals(vb))return!0}return!1};a.prototype.MVe=function(vb,Ka,eb){var yb,oc;if(1===ha.g(this.$).ha.Re&&!Ka&&!eb){Ka=ya.a(this.$);eb=this.Va;var Jb=eb.Bc(),dc=this.$.da.za(65);(null===(yb=null===dc||void 0===dc?void 0:dc.Cm)||void 0===yb?0:yb.QE)&&!Ka&&Jb.buttons.push(eb.lb(227));dc&&dc.isCommentOperationEnabled(3)&&Jb.buttons.push(eb.lb(221));(null===(oc=null===dc||
void 0===dc?void 0:dc.Cm)||void 0===oc?0:oc.djd)&&!Ka&&Jb.buttons.push(eb.lb(228));(null===dc||void 0===dc?0:dc.hasCommentAtActiveCell)?dc.gC.isResolved||Jb.buttons.push(eb.lb(159)):dc&&dc.hasCommentAtActiveCell||(dc&&dc.Cm&&dc.Cm.QE?Ka||(Jb.buttons.push(eb.lb(229)),Jb.buttons.push(eb.lb(230))):(Jb.buttons.push(eb.lb(160)),Ka||Jb.buttons.push(eb.lb(226))));vb.pc.push(Jb)}};a.prototype.MHh=function(vb){if(xa.EwaSettings.ma(135)){var Ka=this.Va,eb=Ka.Bc();eb.buttons.push(Ka.lb(250));vb.pc.push(eb)}};
a.prototype.OGh=function(vb,Ka,eb){if(!eb){eb=this.$.Ka.bH();var yb=new P.a(this.$.xa),oc=new X.a(eb,Ka,this.grid);(new e(vb,this.$,this.Va,eb,Ka,this.grid,oc,yb)).lcd()}};a.prototype.DGh=function(vb,Ka,eb,yb,oc){var Jb=(new P.a(this.$.xa)).Ud(8),dc=this.Va,$a=dc.Bc();Ka&&$a.buttons.push(dc.lb(Jb?152:153));eb&&$a.buttons.push(dc.lb(Jb?150:151));Ka&&(yb||$a.buttons.push(dc.lb(Jb?109:155)),$a.buttons.push(dc.lb(Jb?111:157)));eb&&(oc||$a.buttons.push(dc.lb(Jb?108:154)),$a.buttons.push(dc.lb(Jb?110:156)));
vb.pc.push($a)};a.prototype.rGh=function(vb,Ka){var eb=this.Va,yb=this.$.pe.get(4),oc=this.$.pe.get(117),Jb=eb.Bc();vb.pc.push(Jb);Ka&&Jb.buttons.push(eb.lb(102));if(Wb.a.a7a){if(!yb||oc)Jb.buttons.push(eb.lb(42)),Jb.buttons.push(eb.lb(43))}else Jb.buttons.push(eb.lb(42)),Jb.buttons.push(eb.lb(43));Ka=this.qHh(eb);vb.pc.push(Ka)};a.prototype.qHh=function(vb){var Ka=vb.Bc();Ka.title=N.a.instance.ga(1136);Ka.R4f=!1;Ka.Q4f=!1;Ka.j$f=!1;var eb=5,yb=T.a.Frd(this.$);yb&&(eb=6);vb=vb.nC("PasteOptionsGallery",
eb,"Size24by24",Ka.title);Ka.buttons.push(vb);vb.Dt("ContextMenu.Paste",237279923,"QueryAdvancedPasteContextMenuGalleryIcon",1137,void 0,"Paste_24",1,w.a.auh);vb.Dt("ContextMenu.PasteValues",-185374993,"QueryAdvancedPasteContextMenuGalleryIcon",1138,void 0,"PasteValues_24",1,w.a.fuh);vb.Dt("ContextMenu.PasteFormulas",1766348718,"QueryAdvancedPasteContextMenuGalleryIcon",1139,void 0,"PasteFormulas_24",1,w.a.cuh);vb.Dt("ContextMenu.PasteTranspose",-958589048,"QueryAdvancedPasteContextMenuGalleryIcon",
1140,void 0,"PasteTranspose_24",1,w.a.euh);vb.Dt("ContextMenu.PasteFormatting",1804571062,"QueryAdvancedPasteContextMenuGalleryIcon",1141,void 0,"PasteFormatting_24",1,w.a.buh);yb&&vb.Dt("ContextMenu.PasteLink",42074747,"QueryAdvancedPasteContextMenuGalleryIcon",1142,void 0,"PasteLink_24",1,w.a.duh);return Ka};a.prototype.bIh=function(vb,Ka,eb,yb,oc){var Jb,dc=this.Va,$a=dc.Bc(),Ba=this.$.pe.get(4),la=this.$.pe.get(117);Wb.a.a7a?(!Ba||la)&&$a.buttons.push(dc.lb(43)):$a.buttons.push(dc.lb(43));vb.pc.push($a);
this.jgc&&!this.$.$M&&($a=this.Va.Bc(),this.qcd($a),vb.pc.push($a));xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInReadOnlyEditMode",!1)&&this.$.ea.ic.isMobileMode&&this.$.ea.ic.isReadOnlyEditMode&&!this.$.ya.IsMeetingLiveSession||($a=this.Va.Bc(),this.xcd($a),vb.pc.push($a),h.ULS.sendTraceTag(537167045,0,50,"GridContextMenu::GenerateViewMenuSection, Remove the sort options from right contextual menu in mobile, readonlyeditmode and non-meeting scenario"));$a=this.$.da.za(65);
if(null===(Jb=null===$a||void 0===$a?void 0:$a.Cm)||void 0===Jb?0:Jb.QE)Jb=this.Va.Bc(),Jb.buttons.push(dc.lb(229)),vb.pc.push(Jb);Jb=this.Va.Bc();this.XVe(Jb,Ka,eb,yb,oc);vb.pc.push(Jb);x.AFrameworkApplication.isMobileMode&&!O.a(this.$.ya,30)&&(Ka=dc.Bc(),Ka.buttons.push(dc.lb(272)),vb.pc.push(Ka))};a.prototype.jHh=function(vb,Ka,eb,yb,oc){var Jb=this.Va.Bc();this.kHh(Jb);this.XVe(Jb,Ka,eb,yb,oc);0<Jb.buttons.length&&vb.pc.push(Jb)};a.prototype.kHh=function(vb){vb.buttons.push(this.Va.lb(135))};
a.prototype.IGh=function(vb){var Ka=this.Va.Bc();Ka.buttons.push(this.Va.lb(185));vb.pc.push(Ka)};a.prototype.HHh=function(vb,Ka){xa.EwaSettings.ma(482)&&Ka&&(Ka=this.Va.Bc(),Ka.buttons.push(this.Va.lb(262)),vb.pc.push(Ka))};a.prototype.VGh=function(vb){var Ka=this.grid.ha.sa.selectedRanges;if(Ka&&Ka.length){for(var eb=!1,yb=0;yb<Ka.length;yb++)if(this.grid.Ab.ixa(Ka[yb])){eb=!0;break}if(eb){eb=!1;if(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6411410_RemoveConvertToTextForRichValueRange"))for(yb=
0;yb<Ka.length;yb++){var oc=this.grid.Ab.gVh(Ka[yb]);if(null!=oc&&null!=oc[0]){for(var Jb=0;Jb<oc.length;Jb++)if(this.grid.Ab.ixa(oc[Jb])){eb=!0;break}if(eb)break}}Jb=this.Va;yb=Jb.Bc();oc=Jb.Bc();for(var dc=1===Ka.length&&(Ka[0].isSingle||this.grid.Ab.p7a(Ka[0])),$a=!1,Ba=!1,la=!1,ka=!1,ca=0;ca<Ka.length&&!($a&&la&&Ba&&ka);ca++)!$a&&this.grid.Ab.mli(Ka[ca])&&($a=!0),!la&&this.grid.Ab.Pef(Ka[ca],!1)&&(la=!0),!Ba&&this.grid.Ab.Zpd(Ka[ca])&&(Ba=!0),!ka&&this.grid.Ab.Ggi(Ka[ca])&&(ka=!0);xa.EwaSettings.ma(105)&&
dc&&!this.grid.Ab.Jfc(Ka[0])&&(ka?yb.buttons.push(Jb.lb(217)):yb.buttons.push(Jb.lb(216)));ka=$a;ka=!(new P.a(this.$.xa)).fj&&ka;la&&!eb&&(xa.EwaSettings.ma(131)&&K.l(this.$.mg)&&(xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",!1)&&(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5695344_showRefreshSettingsOnProtectedSheet")?oc.buttons.push(Jb.lb(220)):oc.buttons.push(Jb.lb(ka?220:271))),Ba&&oc.buttons.push(Jb.lb(ka?218:269)),dc&&(this.grid.Ab.Zpd(Ka[0])||this.grid.Ab.Jfc(Ka[0]))&&
oc.buttons.push(Jb.lb(ka?219:270))),oc.buttons.push(Jb.lb(ka?215:268)));0<oc.buttons.length&&(Ka=Jb.Tv($a?"ContexMenu.LinkedEntitiesFlyOut_EnabledContents":"ContexMenu.LinkedEntitiesFlyOut_DisabledContents",null,N.a.instance.ga(1770),798637440),Ka.menu.pc.push(oc),yb.buttons.push(Ka));0<yb.buttons.length&&vb.pc.push(yb)}}};a.prototype.sGh=function(vb,Ka){this.grid.Ab.bdf(Ka)&&(Ka=this.Va.Bc(),this.grid.ha.sa.Rba()?(Ka.buttons.push(this.Va.lb(241)),Ka.buttons.push(this.Va.lb(239))):Ka.buttons.push(this.Va.lb(240)),
vb.pc.push(Ka))};a.prototype.wV=function(vb){return vb.cell.hasHyperlink};a.prototype.bWe=function(vb){this.vHh(vb);var Ka=this.Va.Bc();this.xcd(Ka);vb.pc.push(Ka);this.jgc&&(Ka=this.Va.Bc(),this.qcd(Ka),vb.pc.push(Ka))};a.prototype.uHh=function(vb,Ka,eb){this.bWe(vb);this.MVe(vb,Ka,eb)};a.prototype.vHh=function(vb){if(this.grid.ha.sa.rg&&!this.grid.eb.Ji){var Ka=this.Va,eb=Ka.Bc();va.a(this.$).FRd()?eb.buttons.push(Ka.lb(265)):eb.buttons.push(Ka.lb(264));vb.pc.push(eb)}};a.UVi=function(vb){var Ka=
vb.pKa(a.rkd);Ka&&Ka.emd&a.rkd&&vb.invoke(a.rkd,null)};a.NGh=function(vb,Ka,eb){if(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5552180_DontAssertIfCopyPasteInfraNotReadyOnContextMenuOpen")){if(eb=eb.da.za(254),!eb){h.ULS.sendTraceTag(537167044,0,50,"GridContextMenu::GenerateInsertCopiedCutCellsConextMenu, CopyPasteInfrastructure is not ready.");return}}else if(eb=eb.da.za(254,!0),!eb)return;eb.Lod()&&eb.Rjf()&&vb.buttons.push(Ka.lb(212));eb.Lod()&&eb.yjc()&&vb.buttons.push(Ka.lb(213))};a.prototype.Lxj=
function(){var vb=this.$.da.za(66).Fg,Ka=this.grid.ha.sa.activeCell;return null!=vb&&!vb.hasActiveFilter||ba.c(this.$,Ka)||!this.Fgi(Ka)};a.prototype.Fgi=function(vb){var Ka=vb.left,eb=this.Ecc();if(null!=eb&&null!=eb.W9b&&eb.W9b.includes(Ka-1))return!0;eb=this.vcc();return null!=eb&&B.D(eb).contains(vb)&&null!=eb.FilteredColumns&&eb.FilteredColumns.includes(Ka-1)?!0:!1};a.prototype.Dgi=function(){var vb=this.$.da.za(66).Fg,Ka=this.Ecc();if(null!=vb)return vb.hasAutoFilter&&vb.hasActiveFilter;if(null!=
Ka)return null!=Ka.W9b&&0<Ka.W9b.length;vb=this.vcc();return null!=vb&&null!=vb.FilteredColumns&&0<vb.FilteredColumns.length};a.prototype.Egi=function(){var vb=this.$.da.za(66).Fg,Ka=this.Ecc();if(null!=vb&&vb.hasAutoFilter||null!=Ka&&Ka.q_a.every(function(eb){return 0!=eb.length}))return!0;vb=B.D(this.vcc());return null!=vb&&vb.contains(this.grid.ha.sa.activeCell)?!0:!1};a.prototype.Ecc=function(){var vb=this.$.da.za(66);vb.Wm(this.grid.ha.sa.activeCell);return vb.cvb(this.grid.ha.sa.activeCell)};
a.prototype.vcc=function(){return this.$.xa.getItemByName(this.$.pa.sheetName).L0};a.prototype.YQh=function(){var vb=this.grid.ha.sa.activeCell,Ka=0,eb=!1,yb=this.$.da.za(66),oc=this.Ecc();yb=yb.Fg;null!=yb?(Ka=yb.usedRange.top,eb=!0):null!=oc?(Ka=oc.top,eb=!0):(oc=this.vcc(),null!=oc&&B.D(oc).contains(vb)&&(Ka=oc.FirstRow+1,eb=!0));return eb?(vb=vb.left,Ka=I.Range.Qc(Ka,vb),Ka=this.grid.Ub(Ka),eb="",null!=Ka&&(eb=Ka.text),this.sRg(eb,vb)):N.a.instance.ga(222)};a.prototype.sRg=function(vb,Ka){return null==
vb||fa.a.gh(vb.trim())?String.format(N.a.instance.mb(157),I.Range.KP(Ka)):vb.length>a.S0d?String.format(N.a.instance.mb(155),vb.substring(0,a.S0d)):String.format(N.a.instance.mb(156),vb)};of.Object.defineProperties(a.prototype,{xw:{configurable:!0,enumerable:!0,get:function(){return"PopulateGridContextMenu"}},tB:{configurable:!0,enumerable:!0,get:function(){return H.a.hMf}}});a.NJb="GridContextMenuRootName";a.s2h=H.a.RBe;a.rkd=192;a.S0d=26;Object(t.a)(a,"GridContextMenu",A.a,[])},1429:function(t,
E,b){function a(da,xa){var Z=ia.call(this,da)||this;Z.aDa=null;Z.A_c=[];Z.J4d=null;Z.cwa=!1;Z.pec=!1;Z.Xp=null;Z.qae=null;Z.LJe=function(){Z.FY.tJa(Z.items,Z.aDa);Z.raiseEvent("ACLBUpdated",new l.a(Z.items.length));Z.show()};Z.tableManager=xa;Z.domElement.className=m.a.LMe;Z.domElement.innerHTML=ea;N.DOMElementExtensions.setVisible(Z.domElement,!1);P.d(Z.style,Z.$.isChromeRtl);Z.Bdf=D.EwaSettings.xl();Z.mxe=$get(h.b8f,Z.domElement);Z.FY=new c(Z.$,Z.mxe,Z);Z.OSa(!0);Z.$.domElement.appendChild(Z.domElement);
Z.Pob(da,B.a(da));Z.Pob(da,F.g(da).Wb);Z.Bdf||Z.$.da.Ga(1,Z);Z.Kgi=D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeHandleKeyDownConditionOrder",!1);return Z}function c(da,xa,Z){da=K.call(this,da,xa)||this;da.cellAutoCompleteControl=null;da.nra=null;da.Wyb=D.EwaSettings.xl();da.Wyb&&(da.cellAutoCompleteControl=Z);da.nq=[];return da}function d(da,xa,Z){var ha=J.call(this,da,xa)||this;ha.CRb=null;ha.tjc=0;ha.d8a=null;ha.X0=null;ha.n6=function(ya,va){if(ya=ha.cellAutoCompleteControl.items)if(1===
ya.length&&ha.cellAutoCompleteControl.Y0a.length<ya[0].jsa.length&&ha.cellAutoCompleteControl.cwa&&H.a.gL(ya[0].jsa,ha.cellAutoCompleteControl.Y0a)&&(va.newValue=ya[0].jsa),ha.Ya&&D.EwaSettings.ma(136)){var bb=-1;1<ya.length?bb=ha.cellAutoCompleteControl.Acc(ha.Ya.text,!0):1===ya.length&&(ha.cellAutoCompleteControl.cwa||ha.cellAutoCompleteControl.pec)&&(bb=0);if(0<=bb&&ya.length>bb&&ya[bb].EXc){var ba=w.C(ya[bb].EXc);ba&&F.g(ha.$).Ab.ixa(ba)&&(va.Wbf=!0,va.nxe=ya[bb].EXc)}}};ha.KFb=function(){ha.cellAutoCompleteControl.cwa=
!1};ha.Ya.GYa(ha.n6);ha.Wyb=D.EwaSettings.xl();ha.Wyb&&(ha.CRb=Z);ha.X0=ha.je.Td(ha.Ya.textBox.domElement);ha.X0.ka("mousedown",ha.KFb);return ha}function e(da,xa){this.bmg=da;this.amg=xa}function h(){}b.r(E);t=b(0);var k=b(15),n=b(87),f=b(1304),v=b(9),m=b(996);h.b8f="suggested_cells_list_box";Object(t.a)(h,"CssElementIds",null,[]);var x=b(5),l=b(1305);of.Object.defineProperties(e.prototype,{jsa:{configurable:!0,enumerable:!0,get:function(){return this.bmg}},EXc:{configurable:!0,enumerable:!0,get:function(){return this.amg}}});
Object(t.a)(e,"CellAutoCompleteItem",null,[639]);var u=b(4),A=b(85),z=b(1129),y=b(412),w=b(41),D=b(1),H=b(22),F=b(21),J=z.a;$k(d,J);d.prototype.dispose=function(){this.Ya.HIb(this.n6);J.prototype.dispose.call(this)};d.prototype.hU=function(da){da&&!this.cellAutoCompleteControl.isListVisible||J.prototype.hU.call(this,da)};d.prototype.Jh=function(da,xa){this.cellAutoCompleteControl.Ya=this.Ya;this.tjc=da.keyCode;if(this.Ya.isEditing){var Z=this.Ya.text;H.a.equals(this.d8a,Z,!1)||(this.d8a=Z)}else this.d8a=
null;if(237279923===xa)return this.cellAutoCompleteControl.isListVisible=!1;D.EwaSettings.ma(136)&&17===this.tjc&&this.cellAutoCompleteControl.cwa&&(this.cellAutoCompleteControl.pec=!0);return J.prototype.Jh.call(this,da,xa)};d.prototype.nzd=function(){var da;if(!D.EwaSettings.isChangeGateEnabled("OfficeVSO:5172529_CheckForShuttingDownInAutocompletionTimedCallback")||!u.AFrameworkApplication.zg)if(this.cellAutoCompleteControl.Ya=this.Ya,this.cellAutoCompleteControl.cwa=!1,this.Ya.isEditing){var xa=
!H.a.equals(this.d8a,this.Ya.text,!0),Z=this.Ya.Jnd;Z||!xa&&229!==this.tjc?Z&&(this.cellAutoCompleteControl.isListVisible&&(this.cellAutoCompleteControl.isListVisible=!1),null===(da=this.cellAutoCompleteControl.BNa)||void 0===da?void 0:da.cancel()):this.cellAutoCompleteControl.XMg(this.tjc)}else this.d8a=null};d.prototype.Fh=function(){};d.prototype.Ef=function(){this.yV=!1;this.cellAutoCompleteControl.set_visible(!1);this.d8a=null;this.cellAutoCompleteControl.cwa=!1;this.cellAutoCompleteControl.pec=
!1;this.cellAutoCompleteControl.BNa&&this.cellAutoCompleteControl.BNa.cancel()};d.prototype.PFd=function(da,xa){return this.cellAutoCompleteControl.Jh(da,xa)};of.Object.defineProperties(d.prototype,{kzb:{configurable:!0,enumerable:!0,get:function(){return!1}},yV:{configurable:!0,enumerable:!0,get:function(){return this.cellAutoCompleteControl.isListVisible},set:function(da){this.cellAutoCompleteControl.isListVisible=da}},H5a:{configurable:!0,enumerable:!0,get:function(){return!1}},key:{configurable:!0,
enumerable:!0,get:function(){return y.a.B_c}},cellAutoCompleteControl:{configurable:!0,enumerable:!0,get:function(){if(this.Wyb)return this.CRb;var da=b(1429).CellAutoCompleteControl;return this.CRb||(this.CRb=Object(A.a)(da,this.$.da.za(1)))}}});Object(t.a)(d,"CellAutoCompleteListAutoCompleteBehavior",z.a,[]);var S=b(29);z=b(1306);var N=b(12),T=b(11),G=b(117),I=b(70),K=z.a;$k(c,K);c.prototype.dispose=function(){K.prototype.dispose.call(this);this.nra=null};c.prototype.zzc=function(da){this.R7(!1);
var xa="<table class='"+this.ica+"' aria-live='polite'><tbody>";for(var Z=0,ha=this.nq.length;Z<ha;Z++){var ya=S.a.yg(da[this.nq[Z]].jsa);ya=String.format("<tr><td class='{0}'><span class='{1}' {2}='{3}'>{4}</span></td></tr>",this.x_,c.C_c,x.a.Lpe,ya,S.a.X7c(ya));xa+=ya}this.Rf.innerHTML=xa+"</tbody></table>";this.Hn=N.DOMElementExtensions.Bj(this.domElement,this.ica);this.R7(!0);this.Tra()};c.prototype.tJa=function(da,xa){if(da&&da.length){var Z=[];if(xa)for(var ha=0,ya=da.length;ha<ya;ha++)H.a.gL(da[ha].jsa,
xa)&&Z.push(ha);this.nq=Z;this.zzc(da)}else this.isListVisible=!1,this.nra=null};c.prototype.gya=function(){};c.prototype.AUg=function(da,xa,Z){var ha=Math.min(da,Math.max(200,Z));xa&&da<Z&&(ha+=G.a.hv);N.DOMElementExtensions.uv(this.Rf,ha);xa&&(ha-=G.a.hv);return ha};c.prototype.Tra=function(){K.prototype.Tra.call(this);var da=N.DOMElementExtensions.Bj(this.get_element(),this.ica),xa=this.nq.length>this.JH,Z=F.g(this.$);if(Z=Z.Ub(Z.ha.sa.activeCell))for(da=this.AUg(da.offsetWidth,xa,Z.width),xa=
this.Rf.getElementsByClassName(c.C_c),Z=0;Z<xa.length;Z++)xa[Z].style.maxWidth=T.HelperMethods.nc(da);else k.ULS.sendTraceTag(537167964,0,15,"CellAutoCompleteListBox.AdjustHeightAndWidth: Can't retrive FormattedCell of the Current Active Cell.")};c.prototype.onItemClick=function(da){if(da=K.prototype.onItemClick.call(this,da)){var xa=F.g(this.$);xa.xo(!1);xa.focus()}return da};of.Object.defineProperties(c.prototype,{Pk:{configurable:!0,enumerable:!0,get:function(){return this.nra},set:function(da){this.wBa(this.Pk);
this.nra=da;var xa=this.wBa(this.Pk);this.fe=da?xa.innerText:null;this.cvc(da)}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return Object(I.a)(c.prototype,this,"isListVisible")},set:function(da){Object(I.b)(c.prototype,this,"isListVisible",da);da||(this.Pk=null)}},mTa:{configurable:!0,enumerable:!0,get:function(){return null}},AGa:{configurable:!0,enumerable:!0,get:function(){return this.Wyb?this.cellAutoCompleteControl:this.cellAutoCompleteControl||(this.cellAutoCompleteControl=
this.$.da.za(1))}}});c.C_c=m.a.uth;Object(t.a)(c,"CellAutoCompleteListBox",z.a,[]);var L=b(24),O=b(64),B=b(114),Q=b(179),U=b(45),X=b(34),P=b(262);z=b(19);b.d(E,"CellAutoCompleteControl",function(){return a});var ea="<div id='"+h.b8f+"' class='"+m.a.m9c+" "+z.a.Mo+"' ></div>",ia=f.a;$k(a,ia);a.prototype.VZb=function(da){this.addHandler("ACLBUpdated",da)};a.prototype.Zsc=function(da){this.removeHandler("ACLBUpdated",da)};a.prototype.E2=function(da){this.addHandler("ACLBSelectionChanged",da)};a.prototype.uda=
function(da){this.removeHandler("ACLBSelectionChanged",da)};a.prototype.GGg=function(da){this.addHandler("ACLBMatchedItem",da)};a.prototype.Xcj=function(da){this.removeHandler("ACLBMatchedItem",da)};a.prototype.q7f=function(da){for(var xa=0;xa<da.length;xa++){var Z=da.charCodeAt(xa);if(D.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?H.a.isLetter(Z):H.a.Sod(Z))return!0}return!1};a.prototype.Rwa=function(){return!this.items};a.prototype.dispose=
function(){if(this.$){this.OSa(!1);var da=F.g(this.$);da&&da.view.Gq(this.Bnc)}n.a.oc([this.FY,this.BNa]);n.a.oc(this.A_c);this.A_c=this.mxe=this.FY=this.Ya=null;ia.prototype.dispose.call(this)};a.prototype.Jh=function(da,xa){var Z=!1;if(this.iyj())switch(xa){case -798660877:if(1===this.items.length&&this.fe)break;this.It.mB(1);this.raiseEvent("ACLBSelectionChanged",new l.a(this.items.length,this.Acc(this.fe),this.fe));Z=this.Ly(!1);break;case 137938150:if(1===this.items.length&&this.fe)break;this.It.mB(-1);
this.raiseEvent("ACLBSelectionChanged",new l.a(this.items.length,this.Acc(this.fe),this.fe));Z=this.Ly(!1);break;case 2091832999:this.It.mB(this.JH-1);Z=this.Ly(!1);break;case 742457698:this.It.mB(-(this.JH-1));Z=this.Ly(!1);break;case 125627505:this.Ya.textBox.caretPosition=this.Ya.text.length;this.isListVisible=!1;Z=!0;break;case 267796030:this.Ly(!0);break;default:Z=ia.prototype.Jh.call(this,da,xa)}return Z};a.prototype.show=function(){this.items&&this.items.length&&(this.FY.Pk=this.fe?this.It.Hn.rows[this.Acc(this.fe)]:
null,this.isListVisible=0<this.FY.nq.length,this.NBa(!0),this.FY.gya())};a.prototype.XMg=function(da){var xa=!!this.Ya&&!O.f(this.$.pa);this.pec=this.cwa=!1;this.Ya&&!this.Ya.isEditing?this.set_visible(!1):xa&&!this.Qch(this.activeCell)&&this.NBj(da)};a.prototype.Qch=function(da){return!!this.dataValidationControl&&this.dataValidationControl.Y6c(da)};a.prototype.Ly=function(da){if(!this.Ya||!this.isListVisible)return!1;var xa=this.aDa;if(this.fe){var Z=N.DOMElementExtensions.vZ(N.DOMElementExtensions.Bj(this.FY.Pk,
c.C_c),x.a.Lpe,""),ha=Z.substring(xa.length,Z.length);da?this.Ya.text=Z:this.Ya.insertTextAt(ha,xa.length,this.Ya.text.length)}Z=F.g(this.$);Z.pj&&(Z=Z.Wb,Z.text=this.Ya.text,Z.setCaretPosition(this.Ya.textBox.caretPosition));da?this.isListVisible=!1:this.Ya.textBox.selectRange(xa.length,this.Ya.text.length);return!0};a.prototype.Acc=function(da,xa){xa=void 0===xa?!1:xa;if(!this.FY.Hn)return-1;for(var Z=this.FY.Hn.children[0],ha=Z.children.length,ya,va=0;va<ha;++va)if(ya=Z.children[va],H.a.equals(ya.innerText.trim(),
da,xa))return va;return-1};a.prototype.LBg=function(da,xa,Z,ha,ya,va,bb){var ba=Z.originalText.replace(a.qsf,String.fromCharCode(32)),fa=new L.Range(da.top-1,da.left,da.bottom-1,da.right,!1,!1),ra=bb?bb.Wm(Z.range):null;(!Z.aF||Z.range.left===da.left)&&1<ba.length&&!ha.kb(ba.toUpperCase())&&H.a.gL(ba,xa)&&!H.a.equals(ba,xa,!0)&&!a.OTe(xa)&&this.q7f(ba)&&(!ya&&!ra||!ya&&ra.equals(bb.Wm(fa))||ya&&Z.range.xd(va)&&Z.range.top!==va.top)&&(da=Z.formulaBarText,H.a.equals(da,Z.text,!1)||!da)&&(da={},da.FirstRow=
Z.range.top-1,da.FirstColumn=Z.range.left-1,Z=new e(ba,da),ha.add(ba.toUpperCase(),Z))};a.prototype.NBj=function(da){this.Xp=this.EZh();this.BNa&&this.BNa.cancel();0<this.Ya.text.length&&0!==da?this.items&&((1<this.items.length||this.isListVisible)&&this.xjh(),8!==da&&127!==da&&46!==da&&(1===this.items.length?this.Qkd(!1):this.FY.Pk&&this.Ly(!1))):this.isListVisible=!1};a.prototype.xjh=function(){this.isListVisible?this.LJe():this.qae=Q.AsyncMethodContext.Zq(this.LJe,500,U.a.NWg,this.BNa)};a.prototype.Qkd=
function(da){k.ULS.shipAssertTag(537167966,0,!this.Rwa()&&1===this.items.length,"Invalid Items");var xa=this.items[0].jsa,Z=this.Ya.text,ha=xa.substring(Z.length,xa.length);if(da&&!ha.length)this.Ya.text=xa;else if(!da&&0<ha.length)this.Ya.appendText(ha),this.Ya.textBox.selectRange(Z.length,this.Ya.text.length);else return;this.raiseEvent("ACLBMatchedItem",new l.a(this.items.length,0,xa));this.cwa=!0};a.prototype.EZh=function(){this.Xp=null;var da=new X.a(!1),xa=this.activeCell;this.aDa=this.Ya.text.replace(a.qsf,
String.fromCharCode(32));var Z=this.tableManager.Wm(xa),ha=xa.xd(Z);if(a.OTe(this.aDa)||!this.q7f(this.aDa))return this.items;var ya=new L.Range(1,xa.left,xa.top-1,xa.left,!1,!1),va=new L.Range(xa.top+1,xa.left,v.a.uh,xa.left,!1,!1),bb=F.g(this.$);va=bb.Xj("CellAutoCompleteControl.GetSuggestedCells",va);try{var ba=bb.Xj("CellAutoCompleteControl.GetSuggestedCells2",ya);try{for(var fa=ik([ba,va]),ra=fa.next();!ra.done;ra=fa.next())for(var pa=ra.value;pa.$$mn();){var Za=pa.$$cu();this.LBg(xa,this.aDa,
Za,da,ha,Z,this.tableManager)}}finally{ba&&ba.dispose()}}finally{va&&va.dispose()}this.Xp=Array(da.values.length);for(xa=0;xa<this.items.length;xa++)this.items[xa]=da.values[xa];this.items.sort(function(Ua,Ma){return Ua.jsa.localeCompare(Ma.jsa)});return this.items};a.prototype.Pob=function(da,xa){da&&xa&&this.A_c.push(new d(da,xa,this.Bdf?this:void 0))};a.prototype.iyj=function(){return this.Kgi?this.Y0a&&!this.Rwa()&&this.isListVisible?this.get_visible():!1:this.Y0a&&!this.Rwa()&&this.get_visible()&&
this.isListVisible};a.OTe=function(da){da=0<da.length?da.charCodeAt(0):-1;return 35===da||61===da||43===da||45===da||64===da};of.Object.defineProperties(a.prototype,{It:{configurable:!0,enumerable:!0,get:function(){return this.FY}},Y0a:{configurable:!0,enumerable:!0,get:function(){return this.aDa}},fe:{configurable:!0,enumerable:!0,get:function(){return this.FY.fe}},items:{configurable:!0,enumerable:!0,get:function(){return this.Xp}},BNa:{configurable:!0,enumerable:!0,get:function(){return this.qae}},
activeCell:{configurable:!0,enumerable:!0,get:function(){return F.g(this.$).ha.sa.activeCell}},dataValidationControl:{configurable:!0,enumerable:!0,get:function(){return this.J4d||(this.J4d=this.$.da.za(14))}}});of.Object.defineProperties(a,{qsf:{configurable:!0,enumerable:!0,get:function(){return a.Wbe||(a.Wbe=new RegExp(String.fromCharCode(160),"g"))}}});a.Wbe=null;Object(t.a)(a,"CellAutoCompleteControl",f.a,[613,614,615,6])},1439:function(t,E,b){function a(){z.a.Fa(e.ka);z.a.Fa(c.ka)}function c(y){var w=
A.call(this)||this;w.$=y;w.Eb();return w}function d(y,w){var D=this;this.OZa=null;this.sBf=function(H,F){1<F.length&&(H=u.a.instance.ga(856),D.ariaLiveNotifier.yMf(H,F.length))};this.tBf=function(H,F){l.ULS.shipAssertTag(537167961,0,0<=F.selectedIndex&&0<=F.length&&F.selectedIndex<F.length,"Invalid ListEventArgs: SelectedIndex/Length");l.ULS.shipAssertTag(537167960,0,!!F.JF,"ListEventArgs: SelectedValue should not be null");D.ariaLiveNotifier.T6i(F.JF,F.selectedIndex+1,F.length)};this.uBf=function(H,
F){D.ariaLiveNotifier.TPa(F.JF)};this.ariaLiveNotifier=y;v.EwaSettings.xl()||w.Ga(213,this)}function e(y){var w=x.call(this)||this;w.$=y;w.Eb();return w}t=b(0);var h=b(235),k=b(1429),n=b(50),f=b(37),v=b(1),m=b(921),x=h.a;$k(e,x);e.prototype.create=function(){var y=this,w=this.$.da,D=n.GetServiceTaskFactory.create(w,134,this.la,this.hb),H=n.GetServiceTaskFactory.Ra(w,213,214,this.hb);f.TaskExtensions.Aa(f.TaskExtensions.Vd([D,H],this.la),function(){if(v.EwaSettings.xl())y.pb(Object(m.c)(y.$.da,1,function(){var J=
new k.CellAutoCompleteControl(y.$,D.result);H.result.ka(J);return J}));else{var F=w.za(1);F||(F=new k.CellAutoCompleteControl(y.$,D.result),H.result.ka(F));y.pb(F)}},this.la,3)};e.ka=function(y){y.da.Ga(151,new e(y))};Object(t.a)(e,"CellAutoCompleteControlFactory",h.a,[]);var l=b(15),u=b(14);d.prototype.dispose=function(){this.ZXd();this.OZa=null};d.prototype.ka=function(y){y&&(this.OZa=y,y.VZb(this.sBf),y.E2(this.tBf),y.GGg(this.uBf))};d.prototype.ZXd=function(){this.OZa&&(this.OZa.Zsc(this.sBf),
this.OZa.uda(this.tBf),this.OZa.Xcj(this.uBf))};Object(t.a)(d,"CellAutoCompleteReadoutHandler",null,[622,6]);var A=h.a;$k(c,A);c.prototype.create=function(){var y=this,w=this.$.da;f.TaskExtensions.Aa(n.GetServiceTaskFactory.Ra(w,211,212,this.hb),function(D){if(v.EwaSettings.xl())y.pb(Object(m.c)(w,213,function(){return new d(D.result,w)}));else{var H=w.za(213)||new d(D.result,w);y.pb(H)}},this.la,3)};c.ka=function(y){y.da.Ga(214,new c(y))};Object(t.a)(c,"CellAutoCompleteReadoutHandlerFactory",h.a,
[]);var z=b(10);b.d(E,"a",function(){return a})},1440:function(t,E,b){function a(){h.a.Fa(function(X){X.ma(136)&&c.ka(X)})}function c(X){var P=U.call(this)||this;P.$=X;P.Eb();return P}function d(X,P,ea,ia,da){var xa=Q.call(this)||this;xa.HO=null;xa.u0=null;xa.FFa=null;xa.hvc=null;xa.WNc=null;xa.DXa=null;xa.lee=0;xa.OEc=!1;xa.qgc=!1;xa.BCb=!1;xa.tg=function(){xa.vwa&&(xa.gridView?1===xa.gridView.ha.Re?(xa.gridView.ha.sa.activeCell.equals(xa.FFa)||xa.cN||xa.Nx(),xa.Kob.Iq()):xa.Nx():x.ULS.shipAssertTag(537154141,
0,!1,"GridView is null during selection"))};xa.Fh=function(){xa.Nx()};xa.Yc=function(){xa.dX()};xa.Fc=function(){xa.Nx()};xa.Zc=function(){xa.showCallout()};xa.Bya=function(){if(xa.Kg.Hk&&xa.Kg.Hk.length)if(xa.cZc)xa.Kg.Bui||(xa.OEc=xa.Kg.Hk[0].BlockingDataForExpand),xa.Kg.kPh&&x.ULS.sendTraceTag(537154140,0,50,"User clicked pullout launch button before fieldInfo web service returned"),xa.lee=xa.Kg.T4c&&xa.Kg.rVe<xa.Kg.T4c.left-1?xa.Kg.T4c.left-1-xa.Kg.rVe:-1,xa.showCallout();else if(xa.gridView.ha.sa.rg){var Z=
xa.gridView.ha.sa.activeCell;if(Z&&xa.u0){var ha=xa.tableManager.Wm(Z);xa.JLc=!!ha;var ya=xa.gridView.ha.sa.Vc;ha=xa.cN&&xa.u0.xd(ha);var va=xa.Lhd&&!xa.cN&&ya.equals(xa.selectedRange);ha||va?(x.ULS.sendTraceTag(39662912,0,50,"Field TableWidget shown on grid"),xa.N9b=!0,m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&!xa.cN&&xa.tableManager.wva(Z)?x.ULS.shipAssertTag(537154139,0,!1,"PulloutManager:OnFieldInfoListContextLoaded fetch rich fields for a cell on PivotTable range"):
(m.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?xa.cN?xa.Lh.NAa(xa.u0,xa.cN):xa.Lh.NAa(ya,xa.cN):xa.Lh.NAa(xa.u0,xa.cN),xa.Stc())):x.ULS.shipAssertTag(537154138,0,!1,"PulloutManager:OnFieldInfoListContextLoaded FAILURE")}}};xa.Ni=function(){xa.L6a()&&xa.Lh.hide();1===xa.gridView.ha.Re&&xa.dX()};xa.mR=function(){var Z=xa.gridView.ha.Re;xa.gridView.ha.sa.activeCell&&1===Z&&xa.dX()};xa.$s=function(){if(m.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds"))if(xa.cN){if(xa.u0&&
xa.FFa){var Z=xa.tableManager.Wm(xa.FFa);Z&&1<Z.bottom-Z.top&&(--Z.bottom,xa.gridView.o5(Z)&&xa.Kob.Iq())}}else xa.gridView.ha.sa.rg&&xa.gridView.o5(xa.gridView.ha.sa.Vc)&&xa.Kob.Iq();else xa.u0&&xa.FFa&&xa.cN&&(Z=xa.tableManager.Wm(xa.FFa))&&1<Z.bottom-Z.top&&(--Z.bottom,xa.gridView.o5(Z)&&xa.Kob.Iq())};xa.dX=function(){if(xa.$&&xa.gridView){if(xa.N9b&&xa.cN){var Z=xa.gridView.ha.sa.activeCell;xa.u0=xa.wTe();var ha=!!xa.hvc&&xa.hvc.contains(Z);if(xa.u0&&(Z.equals(xa.FFa)||ha)){xa.Lh.NAa(xa.u0,xa.cN);
return}}xa.N9b=!1;xa.u0=xa.wTe();xa.u0&&xa.Hla&&xa.gridView&&xa.gridView.Ea.Lr(xa.Hla)?(xa.cZc=!1,xa.xZ()):(xa.Kg.YZc(),xa.Kg.$1b());xa.N9b||xa.Lh.hide()}};xa.$=X;xa.tableManager=ea;xa.contextMenuManager=ia;xa.Lh=new e(X,xa.Zc,P,da);xa.Kg=P.A3c(X,ea);xa.cZc=!1;xa.N9b=!1;xa.Lhd=m.EwaSettings.ma(136);xa.JLc=!0;xa.UKc=!1;xa.gridView=T.g(xa.$);xa.gridView.Wb.Ak(xa.Fh);xa.gridView.Au(xa.mR);xa.$.Uk(xa.Yc);xa.$.Bk(xa.Fc);xa.$.rA(xa.Ni);xa.gridView.view.Is(xa.$s);xa.gridView.ha.qP(xa.tg);xa.Kob=F.a.instance.create(xa.dX,
250,J.a.m3i);x.ULS.sendTraceTag(537154143,0,50,"Feature TableWidget enabled");xa.Kg.NZb(xa.Bya);O.a.izb()&&(xa.qgc=!0);xa.dX();X.da.Ga(261,xa);return xa}function e(X,P,ea,ia){var da=L.call(this)||this;da.isMac=G.a.isMac;da.$=X;da.ariaLiveNotifier=ia;da.Ap=ea.e5b(X,null,P,I.a.muh,K.a.df(9),N.a.instance.ga(1728),"PulloutPointerDown");return da}var h=b(10);t=b(0);var k=b(246),n=b(235),f=b(50),v=b(37),m=b(1),x=b(15),l=b(87),u=b(4),A=b(79),z=b(9),y=b(24),w=b(64),D=b(41),H=b(151),F=b(47),J=b(45),S=b(12),
N=b(14),T=b(21),G=b(27),I=b(19),K=b(53),L=A.a;$k(e,L);e.prototype.dispose=function(){this.Ap.dispose();this.$=null;L.prototype.dispose.call(this)};e.prototype.domElement=function(X){return this.Ap.domElement(X)};e.prototype.getButton=function(X){return this.Ap.getButton(X,!1)};e.prototype.bPb=function(X,P){this.Ap.bPb(X,P,!1)};e.prototype.NAa=function(X,P){var ea=T.g(this.$),ia=ea.eb.dj(X);this.Ap.bPb(P?N.a.instance.ga(1728):N.a.instance.ga(1729),ia);P=this.isMac?P?N.a.instance.ga(1732):N.a.instance.ga(1733):
P?N.a.instance.ga(1730):N.a.instance.ga(1731);var da=ea.gg(X,ia);X=ea.Gf(ia).jn;if(da&&0<=da.x&&0<=da.y){var xa=da.bottomRight.x+this.hz;da=da.topLeft.y-this.hz-this.buttonWidth;if(da<X.topLeft.y+this.hz){if(ea.eb.qTa){this.hide();return}da=X.topLeft.y+this.hz}this.hp(xa,da,ea.rtl,ia);this.ariaLiveNotifier.TPa(P)}else this.hide()};e.prototype.hp=function(X,P,ea,ia){this.Ap.hp(X,P,ea,ia,!1)};e.prototype.hide=function(){this.Ap.hide()};of.Object.defineProperties(e.prototype,{hz:{configurable:!0,enumerable:!0,
get:function(){return this.Ap.hz}},buttonWidth:{configurable:!0,enumerable:!0,get:function(){return this.Ap.buttonWidth}}});Object(t.a)(e,"PulloutLaunchButton",A.a,[]);var O=b(36),B=b(22),Q=A.a;$k(d,Q);d.prototype.dispose=function(){this.gridView&&(this.gridView.ha.AW(this.tg),this.gridView.view.Gq(this.$s),this.gridView.Wb&&this.gridView.Wb.vk(this.Fh));if(this.$){var X=this.$;X.sl(this.Yc);X.Ol(this.Fc);X.iD(this.Ni);T.g(X).ny(this.mR)}this.Kg&&this.Kg.Rsc(this.Bya);l.a.Ia(this.Lh);this.Kg=this.$=
this.gridView=this.Kob=this.Lh=null;Q.prototype.dispose.call(this)};d.prototype.Nx=function(){this.Lh.hide()};d.prototype.Bda=function(){this.Lh?this.Lh.getButton(this.Eea).Sbb():x.ULS.sendTraceTag(537154142,0,15,"PulloutManager.ResetButtonAppearance: launchButton is null.")};d.prototype.Ehj=function(){this.u0=null};d.prototype.IJf=function(){this.Lh&&this.Lh.hide()};d.prototype.H0h=function(){if(!this.Lhd||1!==this.selectedRange.width)return null;for(var X=this.selectedRange.clone();this.gridView.o5(X);){X.left+=
1;X.right+=1;if(!this.gridView.Gf(this.gridView.eb.dj(X)).Vg.ze(X))break;if(this.gridView.Ea.Lr(X)){var P=this.gridView.Xj("PulloutManager.GetValidatedRangeToFill",X,2);try{if(d.SWj(P))return X}finally{P&&P.dispose()}}}return null};d.prototype.Stc=function(){this.Kg.Ubb()};d.prototype.showCallout=function(){var X=this;this.vwa&&(this.Kg.r6a?(this.Lh.getButton(this.Eea).KGb(),m.EwaSettings.xl()?v.TaskExtensions.Aa(f.GetServiceTaskFactory.Ra(this.$.da,8,9,0),function(P){X.v3f(P.result)},this.$.la,3):
this.v3f(this.contextMenuManager)):(this.cZc=!0,this.xZ()))};d.prototype.v3f=function(X){X.vdd("tableFieldList").M0(null,this.Lh.domElement(this.Eea),this.Kg,null,!0);this.Stc()};d.prototype.wTe=function(){if(!this.vwa||!this.gridView||this.gridView.ha.Oa.Yb||!this.gridView.ha.sa.rg)return null;var X=this.gridView.ha.sa.activeCell,P=T.g(this.$).eb.dj(X);if(!X)return null;this.FFa=X.clone();var ea=this.tableManager.Wm(X);this.JLc=!!ea;if(this.cN){this.Lh.bPb(N.a.instance.ga(1728),P);this.HO=d.Ufg(ea);
if(!this.HO)return null;P=this.tableManager.HCe(ea,this.gridView);X=P.zY;P=P.returnValue||X;this.OEc=X;if(P)return this.hvc=new y.Range(ea.top,ea.left,ea.bottom,ea.right,!1,!1),this.WNc=new y.Range(this.HO.top,this.HO.right+1,this.HO.top,this.HO.right+1,!1,!1),this.HO}else if(this.Lhd){this.Lh.bPb(N.a.instance.ga(1729),P);this.DXa=this.gridView.ha.sa.Vc.clone();ea=T.g(this.$).Ab.ixa(this.selectedRange);(P=this.selectedRange.isSingle&&T.g(this.$).Ab.Ecf(this.selectedRange))&&!this.BCb&&m.EwaSettings.isChangeGateEnabled("OfficeVSO:6253558_DatePulloutExperimentTrigger")&&
B.a.equals(u.AFrameworkApplication.uiCulture,"en-us",!0)&&(u.AFrameworkApplication.A_("XLS-DateSuggestion-Treatment;XLS-DateSuggestion-Control"),this.BCb=!0);this.HO=d.Ufg(this.selectedRange);if(!(this.qgc&&P||ea)||!this.HO||!this.selectedRange)return null;this.qgc&&(this.UKc=P&&!ea);if(m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&this.tableManager.wva(this.selectedRange))return null;this.WNc=this.H0h();if((m.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?
this.gridView.o5(this.selectedRange):this.gridView.o5(this.HO))&&this.Hla)return this.hvc=this.HO,x.ULS.sendTraceTag(537154137,0,50,"PulloutManager:FindSelection, NextRange, "+(this.Hla?this.Hla.toString():"null")+", RightColumnHeader, "+(this.HO?this.HO.toString():"null")+", ActiveCell, "+(X?X.toString():"null")),this.HO}return null};d.prototype.xZ=function(){this.cN?this.Kg.xZ(D.v(this.Hla,this.$),!1,!0):this.qgc&&this.UKc?this.Kg.l_i():m.EwaSettings.ma(136)&&this.Kg.xZ(D.v(this.selectedRange,this.$),
!0,!1)};d.prototype.L6a=function(){return this.$.ea.isNamedObjectViewMode&&w.f(this.$.pa)};d.SWj=function(X){for(;X.$$mn();)if(X.$$cu().text||X.$$cu().aF||X.$$cu().Mi||X.zn.b7e)return!1;return!0};d.Ufg=function(X){return X.right===z.a.Eh?null:new y.Range(X.top,X.right,X.top,X.right,!1,!1)};of.Object.defineProperties(d.prototype,{hc:{configurable:!0,enumerable:!0,get:function(){return this.Lh.domElement(1)}},Hla:{configurable:!0,enumerable:!0,get:function(){return this.WNc}},selectedRange:{configurable:!0,
enumerable:!0,get:function(){return this.DXa}},cN:{configurable:!0,enumerable:!0,get:function(){return this.JLc}},snd:{configurable:!0,enumerable:!0,get:function(){return this.UKc}},mKf:{configurable:!0,enumerable:!0,get:function(){return this.lee}},XBb:{configurable:!0,enumerable:!0,get:function(){var X=this.Lh.domElement(this.Eea);return X?S.DOMElementExtensions.isVisible(X):!1}},vwa:{configurable:!0,enumerable:!0,get:function(){return this.$.isEditMode&&m.EwaSettings.ma(136)?!(new H.a(this.$.xa)).fj:
!1}},iJg:{configurable:!0,enumerable:!0,get:function(){return this.OEc}},Eea:{configurable:!0,enumerable:!0,get:function(){return this.Hla?this.gridView.eb.dj(this.HO):1}}});Object(t.a)(d,"PulloutManager",A.a,[603,6]);var U=n.a;$k(c,U);c.prototype.create=function(){var X=this;h.a.Fa(function(P){var ea=f.GetServiceTaskFactory.Ra(P.da,12,477,X.hb),ia=f.GetServiceTaskFactory.Ra(P.da,66,134,X.hb),da=f.GetServiceTaskFactory.Ra(P.da,211,212,X.hb),xa=k.a.Ua(null),Z=!m.EwaSettings.xl();Z&&(xa=f.GetServiceTaskFactory.Ra(P.da,
8,9,X.hb));v.TaskExtensions.Aa(v.TaskExtensions.Vd([ea,ia,xa,da],P.la),function(){Z?X.pb(X.$.da.za(261)||new d(X.$,ea.result,ia.result,xa.result,da.result)):X.pb(X.$.da.za(261)||new d(X.$,ea.result,ia.result,null,da.result))},P.la)})};c.ka=function(X){X.da.Ga(262,new c(X))};Object(t.a)(c,"PulloutManagerFactory",n.a,[]);b.d(E,"a",function(){return a})},1450:function(t,E,b){function a(l,u,A){A=void 0===A?null:A;this.imb=this.qmb=null;this.q1=-1;this.Uj=l;this.uga=(void 0===u?null:u)||new h.a;this.oyg=
A||new e;this.hFa=new h.a;l=0;u=ik(this.uga);for(A=u.next();!A.done;A=u.next()){A=A.value;this.xrd(this.q1)||(this.q1=l);var z=l++;this.hFa.add(new c(document.createElement("li"),A.title,this.z7g(z)))}}function c(l,u,A){this.Uj=l;this.xp=u;this.vGc=A;this.Gfa=document.createElement("a");m.a.kwc(this.Gfa,this.xp);Sys.UI.DomElement.addCssClass(this.Gfa,d.XIj);Sys.UI.DomElement.addCssClass(this.Uj,d.WIj);this.Uj.appendChild(this.Gfa);this.Gfa.tabIndex=0;this.CBc();n.a.addHandler(this.Uj,"click",this.vGc);
n.a.addHandler(this.Uj,"keyup",Object(k.a)(this,this.m$a,"onTitleKeyUp"))}function d(){}function e(){}t=b(0);var h=b(192);e.prototype.BIj=function(l,u){l.set_visible(!1);u.set_visible(!0)};Object(t.a)(e,"DefaultTabSwitchBehaviour",null,[566]);d.oJj="TabsContainer";d.YIj="TabTitlesContainer";d.WIj="TabTitle";d.XIj="TabTitleText";d.gVd="TabTitleActive";Object(t.a)(d,"MultitabControlStyles",null,[]);var k=b(84),n=b(44),f=b(86),v=b(89),m=b(56);c.prototype.dispose=function(){n.a.removeHandler(this.Uj,
"keyup",Object(k.a)(this,this.m$a,"onTitleKeyUp"));n.a.removeHandler(this.Uj,"click",this.vGc);this.Uj=this.Gfa=null};c.prototype.setActive=function(l){l?Sys.UI.DomElement.addCssClass(this.Uj,d.gVd):Sys.UI.DomElement.removeCssClass(this.Uj,d.gVd);this.Gfa&&this.Gfa.setAttribute(v.a.hha,l)};c.prototype.m$a=function(l){l.keyCode!==f.a.Qh&&l.keyCode!==f.a.Soa||this.vGc(l)};c.prototype.CBc=function(){this.Uj.setAttribute(v.a.Gd,v.a.Ks);this.Gfa.setAttribute(v.a.Ft,this.xp);this.Gfa.setAttribute(v.a.Gd,
v.a.Cob)};of.Object.defineProperties(c.prototype,{hc:{configurable:!0,enumerable:!0,get:function(){return this.Uj}},title:{configurable:!0,enumerable:!0,get:function(){return this.xp}},isActive:{configurable:!0,enumerable:!0,get:function(){return Sys.UI.DomElement.containsCssClass(this.Uj,d.gVd)},set:function(l){this.setActive(l)}}});Object(t.a)(c,"TabTitleControl",null,[6]);var x=b(39);b.d(E,"a",function(){return a});a.prototype.zRf=function(){this.qmb=document.createElement("ul");this.qmb.className=
d.YIj;this.imb=document.createElement("div");this.imb.className=d.oJj;for(var l=0;l<this.Bzc;++l){var u=this.uga.na(l),A=this.hFa.na(l);u.set_visible(!1);A.isActive=!1;var z=document.createElement("div");u.render(z);this.imb.appendChild(z);this.qmb.appendChild(A.hc)}this.hc.appendChild(this.qmb);this.hc.appendChild(this.imb);this.xrd(this.q1)&&(this.hFa.na(this.q1).isActive=!0,this.uga.na(this.q1).set_visible(!0))};a.prototype.dispose=function(){for(var l=0;l<this.Bzc;++l)this.uga.na(l).dispose(),
this.hFa.na(l).dispose();this.hFa=this.uga=this.Uj=this.imb=this.qmb=null};a.prototype.setFocus=function(){this.uga.na(this.q1).setFocus()};a.prototype.xrd=function(l){return 0<=l&&l<this.Bzc};a.prototype.w8f=function(l){this.q1!==l&&this.xrd(l)&&(this.oyg.BIj(this.uga.na(this.q1),this.uga.na(l)),this.hFa.na(this.q1).isActive=!1,this.hFa.na(l).isActive=!0,this.q1=l,this.setFocus())};a.prototype.z7g=function(l){var u=this;return function(){u.w8f(l)}};of.Object.defineProperties(a.prototype,{Bzc:{configurable:!0,
enumerable:!0,get:function(){return this.uga.count}},activeTab:{configurable:!0,enumerable:!0,get:function(){return this.q1},set:function(l){this.w8f(l)}},hc:{configurable:!0,enumerable:!0,get:function(){return this.Uj}},visible:{configurable:!0,enumerable:!0,get:function(){return x.a.isVisible(this.Uj)},set:function(l){this.Uj.style.visibility=l?"visible":"hidden"}}});Object(t.a)(a,"MultitabControl",null,[550,6])},1459:function(t,E,b){function a(){e.a.Fa(function(x){c.ka(x)})}function c(x){var l=
m.call(this)||this;l.jmj="formulaAssistance";l.$=x;l.Eb();return l}function d(){this.isFeedbackAllowed=!1;this.zoomLevel=0}var e=b(10);t=b(0);var h=b(7),k=b(235),n=b(50),f=b(37);Object(t.a)(d,"FormulaAssistanceUIContext",null,[]);var v=b(207),m=k.a;$k(c,m);c.prototype.create=function(){var x=this,l=this.$.da.za(448);if(l)this.pb(l);else{var u=n.GetServiceTaskFactory.Ra(this.$.da,283,284,this.hb);f.TaskExtensions.Aa(u,function(){f.TaskExtensions.Aa(v.c(u.result.vn.loadScript(x.jmj)),function(){l=x.$.da.za(448);
if(!l){var A=Object(h.a)(new d,{isFeedbackAllowed:x.$.isFeedbackEnabled});l=x.$.da.Ga(448,formulaAssistance.FormulaAssistanceUIFactoryGlobal.create(A));x.$.bye(function(){var z={};z.isFeedbackAllowed=x.$.isFeedbackEnabled;l.updateContext(z)})}x.pb(l)},x.$.la,3)},this.$.la,3)}};c.ka=function(x){x.da.Ga(449,new c(x))};Object(t.a)(c,"FormulaAssistanceUIControlFactory",k.a,[]);b.d(E,"a",function(){return a})},1460:function(t,E,b){function a(){e.a.Fa(c.ka)}function c(D){var H=w.call(this)||this;H.$=D;
H.Eb();return H}function d(D,H){var F=this;this.pNa=1;this.Hga=[];this.active=!1;this.tw=function(){var J=F.gridView.chd();if(!(0>=J||J===F.pNa||F.gridView.gp)){for(var S=!1,N=[],T=[],G=F.Hga.length-1;0<=G;G--){var I=F.Hga[G];if(F.bhd(I)>J||I.bottom<J)N.push(I),F.Hga.splice(G,1),S=!0}for(G=F.tableManager.rangeList.length-1;0<=G;G--){I=F.tableManager.rangeList[G];var K=F.bhd(I);K<=J&&I.bottom>=J&&!(K<=F.pNa&&I.bottom>=F.pNa)&&I.lba&&(T.push(I),S=!0)}if(S)for(I=A.EwaSettings.isChangeGateEnabled("OfficeVSO:6336710_ApplyHeaderSnappingOnVerticalFreezePane")?
F.gridView.zpc:[F.gridView.NY],G=ik(I),I=G.next();!I.done;I=G.next())for(K=ik(I.value),I=K.next();!I.done;I=K.next()){var L=ik(I.value);for(I=L.next();!I.done;I=L.next()){for(var O=I.value,B=O.Gn,Q=z.a(O.E4),U=N.length-1;0<=U;U--)I=N[U],F.tAc(I,!1,Q,B)&&N.splice(U,1);for(U=T.length-1;0<=U;U--)I=T[U],F.tAc(I,!0,Q,B)&&F.Hga.push(I);S&&O.UOd(Q)}}else v.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");F.pNa=J}};this.Ayf=function(J,
S){S.isRow||S.JVc(F.cLa)};this.Byf=function(J,S){S.isRow||(F.tableManager.rangeList.length||F.deactivate(),S.UJd(F.cLa))};this.cLa=function(J,S){if(F.Ud())F.activate();else if(J=F.active,F.deactivate(),!J){v.ULS.sendTraceTag(537157652,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlockHtml: detected an opportunity for bailing out");return}(S=S.Ut)&&F.J5f(S.Gn[0],S.Gn[S.Gn.length-1],S.E4,S.Gn)};this.mBf=function(J,S){!F.gridView.gp&&(F.Ud()?F.activate():(J=F.active,F.deactivate(),J||v.ULS.sendTraceTag(537157651,
0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),S=S.Ut)&&(J=z.a(S.E4),F.J5f(S.Gn[0],S.Gn[S.Gn.length-1],J,S.Gn)&&S.UOd(J))};this.me=function(){F.gridView.eb.C4?F.deactivate():F.activate()};this.tableManager=D;this.gridView=H;this.$=H.$;D.ioe(this.mBf);H.pGg(this.Ayf);H.qGg(this.Byf);this.$.xa.Mf(this.me);this.$.vb.Mf(this.me);this.Gre(function(J){J.JVc(F.cLa)});this.Ud()&&(this.activate(),this.tw(this,null));this.$.da.Ga(68,this)}var e=b(10);t=b(0);var h=
b(235),k=b(50),n=b(37),f=b(21),v=b(15),m=b(30),x=b(222),l=b(24),u=b(64),A=b(1),z=b(1302),y=b(11);d.prototype.dispose=function(){var D=this;this.deactivate();this.gridView&&(this.tableManager.eRf(this.mBf),this.gridView.Mcj(this.Ayf),this.gridView.Ncj(this.Byf),this.$.xa.ug(this.me),this.$.vb.ug(this.me),this.Gre(function(H){H.UJd(D.cLa)}));this.gridView=this.tableManager=this.Hga=null};d.prototype.tAc=function(D,H,F,J){if(!u.b(this.$.pa)||this.$.ea.isNamedObjectViewMode||this.gridView.eb.qTa)return!0;
if(!F.length)return!1;var S=J.length;if(J[S-1]<D.left)return!1;var N=y.HelperMethods.nx(new x.a(J),0,S,D.left,y.HelperMethods.PC);if(0>N)return!1;var T=D.m$f,G=!!D.q_a&&0<D.q_a.length,I=!!D.menuModel&&0<D.menuModel.length,K=N,L=0;for(S=Math.min(T.length+N,S);K<S;K++,L++)if(N=F[K],!A.EwaSettings.isChangeGateEnabled("OfficeVSO:5317457_ToggleHeaderSnapping_JSCrash_Fix")||N){var O=null,B=N.getElementsByClassName(m.a.Y9c);B&&(O=B[0]);if(O&&O.innerText){if(B=N.getElementsByClassName(m.a.mpe))for(var Q=
B.length-1;0<=Q;Q--)N.removeChild(B[Q]);B=J[K];H?(O.innerText=T[L],N.classList.add(m.a.BQe),G&&D.q_a[L]&&(O=document.createElement("div"),O.innerHTML=D.q_a[L],I&&D.menuModel[L]&&this.XCg(D,L,B),N.appendChild(O.firstChild))):(N.classList.remove(m.a.BQe),O.textContent=l.Range.KP(B),this.yjh(B))}}D.Zna=H;return!0};d.prototype.XCg=function(D,H,F){this.$.da.Za(8,function(J){J.V9b.XNi(D,H,F)})};d.prototype.yjh=function(D){this.$.da.Za(8,function(H){H.V9b.YNi(D)})};d.prototype.J5f=function(D,H,F,J){for(var S=
!1,N=this.h0h(D,H),T=this.Hga.length-1;0<=T;T--){var G=this.Hga[T];H>=G.left&&D<=G.right&&(this.tAc(G,!1,F,J),this.Hga.splice(T,1),S=!0)}D=0;for(H=N.length;D<H;D++)this.tAc(N[D],!0,F,J)&&(this.Hga.push(N[D]),S=!0);return S};d.prototype.activate=function(){this.Ud()&&!this.active&&(this.gridView.view.Is(this.tw),this.active=!0)};d.prototype.deactivate=function(){this.active&&(this.gridView.view.Gq(this.tw),this.active=!1)};d.prototype.Ud=function(){return u.b(this.$.pa)&&!this.$.ea.isNamedObjectViewMode&&
0>=this.gridView.eb.rL&&0<this.tableManager.rangeList.length};d.prototype.Gre=function(D){var H=A.EwaSettings.isChangeGateEnabled("OfficeVSO:6336710_ApplyHeaderSnappingOnVerticalFreezePane")?this.gridView.zpc:[this.gridView.NY];H=ik(H);for(var F=H.next();!F.done;F=H.next()){F=ik(F.value);for(var J=F.next();!J.done;J=F.next()){J=ik(J.value);for(var S=J.next();!S.done;S=J.next())D(S.value)}}};d.prototype.h0h=function(D,H){var F=[];if(!this.active)return F;this.pNa=this.gridView.chd();for(var J=this.tableManager.rangeList.length-
1;0<=J;J--){var S=this.tableManager.rangeList[J];S.bottom>=this.pNa&&this.bhd(S)<=this.pNa&&S.left>=D&&S.right<=H&&S.lba&&F.push(S)}return F};d.prototype.bhd=function(D){var H=this.gridView.Ab.dk(D);return H&&this.tableManager.Wdf(D,H.usedRange.topLeft)?D.top+1:D.top};Object(t.a)(d,"HeaderSnappingFeature",null,[6]);var w=h.a;$k(c,w);c.prototype.create=function(){var D=this,H=k.GetServiceTaskFactory.create(this.$.da,134,this.la,this.hb);n.TaskExtensions.Aa(n.TaskExtensions.Vd([H],this.la),function(){D.pb(D.$.da.za(68)||
new d(H.result,f.g(D.$)))},this.la,11)};c.ka=function(D){D.da.Ga(67,new c(D))};Object(t.a)(c,"HeaderSnappingFactory",h.a,[]);b.d(E,"a",function(){return a})},1489:function(t,E,b){function a(){k.a.Fa(function(H){c.ka(H)})}function c(H){var F=D.call(this)||this;F.g5b=null;F.$=H;F.Eb();return F}function d(H){this.a=H;this.preventDefault=d.zFf.preventDefault;this.stopPropagation=d.zFf.stopPropagation;var F=this.type=H.type.toLowerCase();this.rawEvent=H;this.altKey=H.altKey;"undefined"!==typeof H.button&&
(this.button="undefined"!==typeof H.which?H.button:4===H.button?Sys.UI.MouseButton.middleButton:2===H.button?Sys.UI.MouseButton.rightButton:Sys.UI.MouseButton.leftButton);"keypress"===F?this.charCode=H.charCode||H.keyCode:this.keyCode=H.keyCode&&46===H.keyCode?127:H.keyCode;this.clientX=H.clientX;this.clientY=H.clientY;this.ctrlKey=H.ctrlKey;this.target=H.target?H.target:H.srcElement;this.screenX=H.screenX;this.screenY=H.screenY;this.shiftKey=H.shiftKey}function e(){this._list={}}function h(){this._list=
{}}var k=b(10);t=b(0);var n=b(15),f=b(1094),v=b(27),m=b(205),x=b(235),l=b(226),u=b(1),A=b(51),z=b(58),y=b(207),w=b(36);h.prototype.addHandler=function(H,F){var J;this._list[H]=[].concat(kk(null!==(J=this._list[H])&&void 0!==J?J:[]),[F])};h.prototype.removeHandler=function(H,F){var J=this._list[H];void 0!==J&&(F=J.indexOf(F),0<=F&&(this._list[H]=[].concat(kk(J.slice(0,F)),kk(J.slice(F+1)))))};h.prototype.getHandler=function(H){var F=this._list[H];return F&&0!==F.length?function(J,S){for(var N=ik(F),
T=N.next();!T.done;T=N.next())T=T.value,T(J,S)}:null};h.hJb=function(){Sys.EventHandlerList.prototype.addHandler=h.prototype.addHandler;Sys.EventHandlerList.prototype.getHandler=h.prototype.getHandler;Sys.EventHandlerList.prototype.removeHandler=h.prototype.removeHandler};Object(t.a)(h,"EventHandlerListOptimized",null,[]);e.prototype.addHandler=function(H,F){this.invalidate(H);void 0===this._list[H]?this._list[H]=[F]:this._list[H].push(F)};e.prototype.invalidate=function(H){void 0!==this.bA&&this.bA.delete(H)};
e.prototype.removeHandler=function(H,F){var J=this._list[H];void 0!==J&&0!==J.length&&(F=J.indexOf(F),0<=F&&(this.invalidate(H),J.splice(F,1)))};e.prototype.getHandler=function(H){void 0===this.bA&&(this.bA=new Map);var F=this.bA.get(H);return void 0===F?(F=this.makeHandler(H),this.bA.set(H,F),F):F};e.prototype.makeHandler=function(H){H=this._list[H];if(!H||0===H.length)return null;var F=[].concat(kk(H));return function(J,S){for(var N=0;N<F.length;++N)F[N](J,S)}};e.hJb=function(){Sys.EventHandlerList.prototype.addHandler=
e.prototype.addHandler;Sys.EventHandlerList.prototype.getHandler=e.prototype.getHandler;Sys.EventHandlerList.prototype.removeHandler=e.prototype.removeHandler;Sys.EventHandlerList.prototype.makeHandler=e.prototype.makeHandler;Sys.EventHandlerList.prototype.invalidate=e.prototype.invalidate};Object(t.a)(e,"EventHandlerListMemoized",null,[]);d.hJb=function(){Sys.UI.DomEvent=d;d.registerClass("Sys.UI.DomEvent",void 0,void 0)};of.Object.defineProperties(d.prototype,{offsetX:{configurable:!0,enumerable:!0,
get:function(){if(!this.type.startsWith("key")){if(void 0!==this.rawEvent.offsetX)return this.rawEvent.offsetX;if(this.target&&3!==this.target.nodeType&&"number"===typeof this.clientX){var H=Sys.UI.DomElement.getLocation(this.target);return(Sys.UI.DomElement._getWindow(this.target).pageXOffset||0)+this.clientX-H.x}}}},offsetY:{configurable:!0,enumerable:!0,get:function(){if(!this.type.startsWith("key")){if(void 0!==this.rawEvent.offsetY)return this.rawEvent.offsetY;if(this.target&&3!==this.target.nodeType&&
"number"===typeof this.clientY){var H=Sys.UI.DomElement.getLocation(this.target);return(Sys.UI.DomElement._getWindow(this.target).pageYOffset||0)+this.clientY-H.y}}}}});d.addHandler=Sys.UI.DomEvent.addHandler;d.addHandlers=Sys.UI.DomEvent.addHandlers;d.removeHandler=Sys.UI.DomEvent.removeHandler;d.clearHandlers=Sys.UI.DomEvent.clearHandlers;d._removeHandler=Sys.UI.DomEvent._removeHandler;d._clearHandlers=Sys.UI.DomEvent._clearHandlers;d._disposeHandlers=Sys.UI.DomEvent._disposeHandlers;d.zFf=Sys.UI.DomEvent.prototype;
d.registerClass=function(H,F,J){this.prototype.constructor=this;this.__typeName=H;this.__class=!0;F&&(this.__baseType=F,this.__basePrototypePending=!0);Sys.__upperCaseTypes[H.toUpperCase()]=this;if(J){this.__interfaces=[];for(var S=2,N=arguments.length;S<N;S++)this.__interfaces.push(arguments[S])}return this};Object(t.a)(d,"DomEventLazy",null,[575]);var D=x.a;$k(c,D);c.prototype.create=function(){var H=this;n.ULS.sendTraceTag(537154643,0,50,"PluginSchedulerFactory.Create: Loading scheduler slice");
f.a.then(this.d$g(),function(F){H.pb(F)})};c.prototype.d$g=function(){var H=this;if(this.g5b)return this.g5b;var F=l.a.UHa(A.b(),m.a.none,"LoadResource","x10Scheduler loading");if(u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNativeStartsWithEndsWith",!1)){var J=String.prototype;if(void 0===J.startsWithOriginal||void 0===J.endsWithOriginal)if(u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RetrieveOriginalStringUsingIFrameHack",!1)){var S=document.createElement("frame");
document.body.appendChild(S);var N=S.contentWindow.String.prototype;document.body.removeChild(S);J.startsWithOriginal=N.startsWith;J.endsWithOriginal=N.endsWith}else J.startsWithOriginal=function(T,G){G=void 0===G?0:G;return this.lastIndexOf(T,G)===G},J.endsWithOriginal=function(T){return-1!==this.indexOf(T,this.length-T.length)};J.startsWith=J.startsWithOriginal;J.endsWith=J.endsWithOriginal}u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseImmutableHandlers",!1)&&h.hJb();u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseMemoizedHandlers",
!1)&&e.hJb();u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseLazyDomEvent",!1)&&d.hJb();if(u.EwaSettings.isChangeGateEnabled("OfficeVSO:5789323_disableSchedulerForIE")&&v.a.Xu)return J=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance(),this.$.da.Ga(413,J),F.setResult(J),this.g5b=F.task;this.$.da.Za(266,function(T){u.EwaSettings.isChangeGateEnabled("OfficeVSO:6600721_doGracefullyFallIfTryToLoadSchedulerWithoutCalc")&&!T.Xfc?(n.ULS.sendTraceTag(520901762,0,15,"PluginSchedulerFactory.createPluginSchedulerAsync: Calc is not initialized, pluginScheduler creation canceled"),
F.mt()):H.$.da.Za(283,function(G){var I=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();G=y.b(z.Task.Ua(G.vn));(u.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed")?Promise.all([excelOnlineCalc.x10.ensureGroupAttached(G,0),w.a.GNg(H.$)?excelOnlineCalc.x10.ensureGroupAttached(G,2):Promise.resolve(0)]).then(function(K){return K.some(function(L){return 0<L})}):excelOnlineCalc.x10.ensureAllPluginsAttached(G)).then(function(K){H.$.da.Ga(413,I);F.setResult(I);
u.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)&&H.$.da.Za(491,function(L){L.Rda.anyPluginInitialized=K})})})});return this.g5b=F.task};c.ka=function(H){H.da.Ga(414,new c(H))};Object(t.a)(c,"PluginSchedulerFactory",x.a,[]);b.d(E,"a",function(){return a})},1653:function(t,E,b){function a(mb){return wc.call(this,mb)||this}function c(mb){this.$=mb}function d(mb){var ic=Nc.call(this)||this;ic.$=mb;ic.Eb();return ic}function e(mb,ic){var qc=this;this.$=mb;this.fontServiceManager=
ic;this.menuId=this.eZc=this.jS=this.Kua=null;this.qbd=0;this.VBi="+mn-lt";this.bzi="+mj-lt";this.KLi=function(){qc.AZf()};this.aRi=function(hc){qc.Wff=!0;qc.wUg=null;qc.$.bB(function(Jc){Jc.APa("FontName_New")});N.ULS.sendTraceTag(520710160,1,15,"PreviewFont Status is "+hc)};this.pgi=!!String.fromCodePoint&&!lb.a.$t&&!!window.gridRenderer&&gridRenderer.CanvasRendererGlobals.isFontLoadApiSupported();this.Wff=!1;this.wUg=null;this.Am=ia.EwaSettings.Am();this.gridView=Z.g(this.$);(this.an=Gc.a.an())&&
this.fontServiceManager&&(this.fontServiceManager.kod?this.AZf():this.fontServiceManager.$ne(this.KLi))}function h(mb){return Yb.call(this,mb)||this}function k(mb,ic){var qc=this;this.T$b=this.LFd=null;this.Ixf=function(){ia.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnfreezeViewportAdjustLocation",!1)||qc.Utc();if(qc.T$b){var hc=Na.a(nb.a.Ta.Wd,qc.T$b);N.ULS.sendTraceTag(570949840,5,50,"FreezePanesCommandHandler.OnFreezePanesUpdateCompleted: duration of FreezePane from operation until allBlockUpdated: "+
hc);qc.T$b=null}qc.qFf()};this.$=mb;this.gridView=Z.g(mb);this.iF=ic.Vrb(this.$.domElement,500,null,null);this.RKa=this.QKa=-1}function n(mb){this.freezeOptions=null;this.freezeOptions=mb}function f(){}function v(mb){var ic=oc.call(this)||this;ic.aTb=null;ic.$=mb;ic.Eb();return ic}function m(mb){var ic=yb.call(this)||this;ic.ZIf=0;ic.QG=null;ic.Qaj=function(qc){ic.ecj(qc)};ic.b0g=function(qc,hc){if(1===qc&&ic.QG.FileCollectionErrorStateId){qc=ic.$.oa.va;var Jc=ic.QG.MessageId,rd=ic.QG.OriginalEcsServerId,
md=ic.QG.FileCollectionErrorStateId,Cc=qc.Na(0);Cc.errorMessageId=Jc;Cc.ecsServerId=rd;Cc.fileCollectionErrorStateId=md;Cc.userComment=hc;qc.HZc("CollectFile",Cc,null,null,null,null,0)}ic.raiseEvent("fileCollectionComplete",null,ic)};ic.$=mb;return ic}function x(mb){var ic=eb.call(this,!1,!1,x.ou)||this;ic.ovd=!1;ic.Nof=!0;ic.Xnf=0;ic.Rb=1;ic.kc(1,CommonUIStrings.l_Send);ic.kc(0,CommonUIStrings.l_NoThanks);ic.Xf=l.HTML;ic.Qnf=mb;ic.ye=x.ZTg;return ic}function l(){}function u(mb){return aa.call(this,
mb)||this}function A(mb,ic,qc){var hc=ta.call(this)||this;hc.OIi=function(Jc,rd){if(!oa.a(Jc)&&rd){var md=!!Jc&&!!Jc.RequestTelemetryData;Z.g(hc.$).si.tla(rd.toString(),Jc.StateId,md?Jc.RequestTelemetryData.EcsOperationDuration:0,md?Jc.RequestTelemetryData.EcsRequestDuration:0,md?Jc.RequestTelemetryData.WfeRequestDuration:0)}};hc.$=mb;hc.tableManager=ic;hc.Hg=qc;return hc}function z(mb){return ba.call(this,mb)||this}function y(mb){var ic=bb.call(this)||this;ic.Auf=function(qc){var hc=Z.g(ic.$);if(qc=
qc.Result){var Jc=K.D(qc.NewSelection),rd=K.D(qc.NewActiveCell);if(Jc&&rd)if(!qc.Committed&&qc.AutoSumFormula){var md=hc.Ub(rd);md&&(hc.ha.updateSelection(Jc,rd,60),Jc=rd=K.D(qc.MarkedArea),hc.EJ=2,D(hc.$b,md,qc.AutoSumFormula,!!Jc,qc.FormulaMarkStart,qc.FormulaMarkEnd),Jc&&rd&&hc.ha.updateSelection(Jc,rd,0),hc.$b.Opd=!1,U.TaskExtensions.Aa(Q.GetServiceTaskFactory.create(ic.$.da,153,ic.la,0),function(Cc){Cc.result.i2a(null)},ic.la,3))}else hc.ha.updateSelection(Jc,rd,60)}};ic.$=mb;return ic}function w(mb,
ic){this.sharedSheetRange=null;this.type=0;this.sharedSheetRange=mb;this.type=ic}function D(mb,ic,qc,hc,Jc,rd){if(ic){var md=mb.textBox;mb.isEditing||mb.startEdit(ic,!0);mb.Opd=!0;mb.text=qc;md.caretPosition=Jc;Jc<rd&&(hc&&mb.YAa(),md.selectRange(0,rd+1),md.selectRange(Jc,rd))}}function H(mb,ic,qc,hc,Jc,rd,md,Cc,fd,Cd){Cd=mb.Na(9,Cd);Cd.selectedRange=ic;Cd.activeCell=qc;Cd.autoSumType=hc;Cd.topLeftCell=Jc;return G.g(mb,"AutoSum",Cd,rd,md,Cc,fd,0)}b.r(E);var F=b(1293),J=b(0),S=b(915),N=b(15),T=b(182),
G=b(62),I=b(76);w.prototype.C4a=function(){return this.sharedSheetRange};Object(J.a)(w,"MacroRecorderAutoSumPayload",null,[430]);var K=b(41),L=b(572),O=b(394),B=b(177),Q=b(50),U=b(37),X=b(160),P=b(361),ea=b(31),ia=b(1),da=b(187),xa=b(298),Z=b(21),ha=b(126),ya=b(636),va=b(58),bb=T.a;$k(y,bb);y.prototype.Nc=function(){return!1};y.prototype.executeCommand=function(mb,ic,qc){mb=ic.command;switch(mb){case 1220954656:ic=this.UIe(0,ic);break;case -1537138325:ic=this.UIe(parseInt(qc[I.a.Mc].toString(),10),
ic);break;default:ic=da.a(mb)}return ic};y.prototype.Ac=function(mb,ic){if(mb=1===mb)switch(ic.command){case 1220954656:case -1537138325:break;default:mb=!1}return mb};y.prototype.Tc=function(){return!1};y.prototype.UIe=function(mb,ic){function qc(){return new w(md,mb)}var hc=this,Jc=Z.g(this.$);Jc.ig.HG(!1);if(!Z.g(this.$).ha.sa.rg)return N.ULS.sendTraceTag(537170308,0,50,"AutoSumCommandHandler.DoAutoSum: Unhandled AutoSum of type "+mb+" due to discontinuous selection. Number of selected ranges is "+
Z.g(this.$).ha.sa.uK),this.kza(),va.Task.Ua(!1);var rd=Jc.iH();if(!rd)return null;var md=K.v(Jc.ha.sa.Vc,this.$),Cc=K.o(Jc.ha.sa.activeCell,this.$),fd=K.o(rd,this.$),Cd=this.$.oa.va.Pb();return this.$.iq(Jc.ha.sa.selectedRanges,!0)?ia.EwaSettings.Zb()?O.a(this.$.userOperationManager,function(Sc,Md,bc){return H(hc.$.oa.va,md,Cc,mb,fd,xa.b(Sc,hc.Auf),Md,bc,mb,Cd)},function(Sc){return new B.a(502,0,Sc,64,qc)},ic):O.a(this.$.userOperationManager,function(Sc,Md,bc){return H(hc.$.oa.va,md,Cc,mb,fd,xa.b(Sc,
hc.Auf),Md,bc,mb,Cd)},function(Sc){return new L.a(502,0,Sc,void 0,qc)},ic):va.Task.Ua(!1)};y.prototype.kza=function(){ya.a(ha.a.discontinuousSelectionBlocking,["OtherICE"],!0,!0,!1,!1,null);var mb=ea.a.Xc(1,1,754,2174,0,371863010,"DiscontinuousSelectionBlocking");ia.EwaSettings.oz()?new P.a(this.$,mb):(mb=new X.ErrorDialog(this.$,mb),mb.initialize(),mb.qf())};Object(J.a)(y,"AutoSumCommandHandler",T.a,[401]);var ba=S.a;$k(z,ba);z.prototype.zd=function(){this.jd([new y(this.$)])};z.ka=function(mb){S.a.Pd(96,
new z(mb))};Object(J.a)(z,"AutoSumCommandHandlerFactory",S.a,[]);var fa=b(10),ra=b(178),pa=b(278),Za=b(38),Ua=b(341),Ma=b(1294),oa=b(299),ja=b(74),ta=Za.a;$k(A,ta);A.prototype.rFg=function(mb){this.addHandler("ekcvc",mb)};A.prototype.Wbj=function(mb){this.removeHandler("ekcvc",mb)};A.prototype.Nc=function(){return!1};A.prototype.executeCommand=function(mb,ic){mb=ic.command;switch(mb){case -730106152:ic=this.Uhd(ic,3);break;case -1228228458:ic=this.Uhd(ic,4);break;case -848953656:case 2045211913:if(this.Zli()){ic=
va.Task.Ua(!0);break}ic=this.Uhd(ic,1);break;default:ic=da.a(mb)}return ic};A.prototype.Ac=function(mb,ic){if(mb=1===mb)switch(ic.command){case -730106152:case -1228228458:case -848953656:case 2045211913:break;default:mb=!1}return mb};A.prototype.Tc=function(){return!1};A.prototype.Uhd=function(mb,ic){function qc(){return new Ma.a(ic,Cd)}function hc(Md,bc,xe){Jc.$.py();return G.d(Jc.$.oa.va,ic,Cd,!1,xa.b(Md,Jc.OIi),bc,xe,fd,Sc)}var Jc=this,rd=Z.g(this.$),md=rd.ha.sa.selectedRanges,Cc=mb.command,fd=
ra.a.create().toString();if(!this.$.iq(md,!0)&&-730106152!==Cc)return va.Task.Ua(!0);var Cd=K.r(md,this.$);this.IBj(Cc,rd,md,fd);ia.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&this.u4i();var Sc=this.$.oa.va.Pb({D_:!0,SZ:1});return ia.EwaSettings.Zb()?O.a(this.$.userOperationManager,hc,function(Md){return new B.a(508,0,Md,67,qc)},mb):O.a(this.$.userOperationManager,hc,function(Md){return new L.a(508,0,Md,3,qc)},mb)};A.prototype.IBj=function(mb,ic,qc,
hc){var Jc=this;if(-848953656!==mb&&2045211913!==mb&&-730106152!==mb&&-1228228458!==mb)N.ULS.sendTraceTag(537167938,0,10,"ClearCommandHandler.ShowInstantaneousClear: Unexpected command "+mb+".");else if(!pa.a.any(qc,function(md){return 0<ic.getRangeInformation(md).length})){var rd=pa.a.any(qc,function(md){return Jc.tableManager.brd(md)});if(-730106152!==mb&&-1228228458!==mb||!rd)this.GFj(ic,mb,hc,qc),-730106152!==mb&&-1228228458!==mb||this.Hg.Zda(ic,-730106152,{}),-1228228458!==mb&&2045211913!==mb&&
-848953656!==mb||this.Hg.IZg(qc,hc),ic.si.P0(hc,ja.BasicTelemetryCalculator.KQ)}};A.prototype.GFj=function(mb,ic,qc,hc){var Jc="";switch(ic){case -1228228458:Jc="ClearAll";break;case 2045211913:case -848953656:Jc="ClearContent";break;case -730106152:Jc="ClearFormat";break;default:N.ULS.sendTraceTag(537167937,0,15,"ClearCommandHandler.StampTimeWithCompatibleDescription: Unexpected command "+ic+".")}ic=hc.length;hc=K.b(hc);mb.si.L7(15,qc,Jc+(", ranges to clear: "+ic+", cells to clear: "+hc))};A.prototype.u4i=
function(){this.raiseEvent("ekcvc",new Ua.a)};A.prototype.Zli=function(){if(Z.g(this.$).kz){var mb=this.$.da.za(296);return!!mb&&mb.JU.gB}return!1};Object(J.a)(A,"ClearCommandHandler",Za.a,[401,919]);var aa=S.a;$k(u,aa);u.prototype.zd=function(){var mb=this,ic=Q.GetServiceTaskFactory.create(this.$.da,134,this.la,this.hb),qc=Q.GetServiceTaskFactory.create(this.$.da,18,this.la,this.hb);U.TaskExtensions.Aa(U.TaskExtensions.Vd([ic,qc],this.la),function(){var hc=new A(mb.$,ic.result,qc.result);mb.jd([hc]);
mb.$.da.Ga(313,hc)},this.la,3)};u.ka=function(mb){S.a.Pd(101,new u(mb))};Object(J.a)(u,"ClearCommandHandlerFactory",S.a,[]);var ma=b(1424),Ea=b(1295),Ha=b(1347),Aa=b(1297),V=b(1298),La=b(1359),Ra=b(87),pb=b(235),cb=b(4),Sa=b(107),Db=b(44),Ab=b(11),Wb=b(84),ub=b(150);l.HTML='<div id="WACDialogRow" class="WACDialogRow">\r\n\t\t\t\t\t<div id="WACDialogIconPanel" class="WACDialogIconPanel"></div>\r\n\t\t\t\t\t<div id="WACDialogTextPanel" class="WACDialogTextPanel" style="padding-right: 30px;">\r\n\t\t\t\t\t\t<div id="WACDialogErrorMessage"></div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorReportMessage"> </div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorTextPrompt" ></div> \r\n\t\t\t\t\t\t<textarea id="WACDialogInput" class="WACDialogInput" rows="5" style="margin-bottom: 10px; margin-top: 9px; overflow: auto;" maxlength="256"></textarea>\r\n\t\t\t\t\t\t<div id = "WACDialogSendFileCheckboxContainer" class="WACDialogRow" >\r\n\t\t\t\t\t\t<input type="checkbox" id="WACDialogSendFileCheckbox">\r\n\t\t\t\t\t\t<span id="WACDialogSendFileCheckboxText">text</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<a id="WACDialogPrivacyText"> </a> \r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>';
Object(J.a)(l,"FileUploadDialogHTML",null,[]);var vb=b(158),Ka=b(25),eb=ub.a;$k(x,eb);x.prototype.gj=function(mb,ic,qc,hc,Jc){Jc=void 0===Jc?!0:Jc;this.ovd=void 0===hc?!1:hc;this.UAj(ic);this.Xnf=mb;Jc&&cb.AFrameworkApplication.DF(mb)};x.prototype.UAj=function(mb){if(x.ou)this.CCj(mb);else{var ic={};ic[x.VTg]=mb;ic[x.aUg]=CommonUIStrings.l_SendFileErrorReportMessage;ic[x.bUg]=CommonUIStrings.l_SendFileErrorReportTextCaption;ic[x.pZc]="";ic[x.YTg]=CommonUIStrings.l_UserReportLinkText;ic[x.F1b]=!0;
this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(Wb.a)(this,this.dti,"legacyDialogHandler"),ic);this.$W(x.gUg)}};x.prototype.CCj=function(mb){var ic={},qc={},hc={},Jc={},rd={};mb=(rd.id=this.ye,rd.bodyControls=(Jc.reportErrorCheckboxProps=this.ovd?(ic.label=CommonUIStrings.l_UserReportLinkText,ic):null,Jc.textAreaProps=this.Nof?{}:null,Jc.privacyStatementLinkProps=(hc.text=CommonUIStrings.l_PrivacyStatement,hc.handler=(qc.href=cb.AFrameworkApplication.Ema,qc.target="_blank",qc),
hc),Jc),rd.errorMessage=mb,rd.errorReportMessage=CommonUIStrings.l_SendFileErrorReportMessage,rd.errorTextPrompt=CommonUIStrings.l_SendFileErrorReportTextCaption,rd);this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(Wb.a)(this,this.GGd,"reactDialogHandler"),mb)};x.prototype.R9a=function(){if(!x.ou){var mb=document.getElementById(x.dUg);mb&&(mb.className=x.cUg,mb.appendChild(vb.createClusteredImage(32,32,x.$Tg,null,!0,CommonUIStrings.l_DialogError)));if(mb=document.getElementById(x.eUg))mb.innerText=
CommonUIStrings.l_PrivacyStatement,mb.href=cb.AFrameworkApplication.Ema,Db.a.addHandler(mb,"click",Object(Wb.a)(this,this.dRi,"onPrivacyClickHandler"));this.Nof||(mb=document.getElementById(x.pZc))&&mb.parentNode&&mb.parentNode.removeChild(mb);this.ovd||(mb=document.getElementById(x.XTg))&&mb.parentNode&&mb.parentNode.removeChild(mb)}};x.prototype.lO=function(){x.ou||(eb.prototype.lO.call(this),document.getElementById(this.di("WACDialogPanel")).style.width=String.format("{0}px",400))};x.prototype.dti=
function(mb,ic){var qc=ic[x.pZc]||"",hc=!0;void 0!==ic[x.F1b]&&null!==ic[x.F1b]&&(hc=ic[x.F1b]);this.Xv(mb,qc,hc)};x.prototype.GGd=function(mb,ic){this.Xv(mb,ic.text||"",ic.reportErrorChecked)};x.prototype.Xv=function(mb,ic,qc){this.Qnf&&(qc&&N.ULS.sendTraceTag(5768786,306,50,"Error Report sent for errorCode:{0}",this.Xnf),this.Qnf(mb,ic,qc))};x.prototype.dRi=function(mb){cb.AFrameworkApplication.ub.$d(Ka.a.mHb,2,mb)};of.Object.defineProperties(x.prototype,{canBePreempted:{configurable:!0,enumerable:!0,
get:function(){return!1}}});of.Object.defineProperties(x,{ou:{configurable:!0,enumerable:!0,get:function(){return cb.AFrameworkApplication.ta.Qa.Yu&&cb.AFrameworkApplication.ta.Qa.xmi}}});x.VTg="WACDialogErrorMessage";x.aUg="WACDialogErrorReportMessage";x.bUg="WACDialogErrorTextPrompt";x.pZc="WACDialogInput";x.eUg="WACDialogPrivacyText";x.dUg="WACDialogIconPanel";x.$Tg="CancelRequest_32x32x32";x.cUg="WACDialogIcon";x.gUg="WACDialogTextPanel";x.F1b="WACDialogSendFileCheckbox";x.XTg="WACDialogSendFileCheckboxContainer";
x.YTg="WACDialogSendFileCheckboxText";x.ZTg="FileUploadErrorDialog";Object(J.a)(x,"FileUploadErrorDialog",ub.a,[]);var yb=Za.a;$k(m,yb);m.prototype.CFg=function(mb){this.addHandler("fileCollectionComplete",mb)};m.prototype.ecj=function(mb){this.removeHandler("fileCollectionComplete",mb)};m.prototype.a0g=function(mb,ic,qc){this.ZIf=ic;this.QG=mb;this.CFg(qc);cb.AFrameworkApplication.Ema=this.$.workbookContext.FullDocumentInfo.PrivacyUrl;mb=new x(this.b0g);cb.AFrameworkApplication.ub.Mb(Ka.a.mHb,Sa.a.frame,
m.f2i);mb.gj(0,"",null,!1,!1)};m.f2i=function(mb,ic,qc,hc,Jc){Db.a.Jt(Jc);cb.AFrameworkApplication.Ema&&Ab.HelperMethods.Te(cb.AFrameworkApplication.Ema,void 0,void 0,"FileCollectionOperation.PrivacyUrl");return 32};Object(J.a)(m,"FileCollectionOperation",Za.a,[920,6]);var oc=pb.a;$k(v,oc);v.prototype.create=function(){var mb=this;U.TaskExtensions.Aa(Q.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb),function(){mb.pb(mb.iAh)},this.la,3)};v.prototype.dispose=function(){Ra.a.Ia(this.aTb);
this.aTb=null;oc.prototype.dispose.call(this)};v.ka=function(mb){mb.da.Ga(125,new v(mb))};of.Object.defineProperties(v.prototype,{iAh:{configurable:!0,enumerable:!0,get:function(){return this.aTb||(this.aTb=new m(this.$))}}});Object(J.a)(v,"FileCollectionCommandHandlerFactory",pb.a,[]);var Jb=b(1366),dc=b(1300),$a=b(1459),Ba=b(7),la=b(750);Object(J.a)(f,"FreezePanesCommandParameters",null,[]);var ka=b(9),ca=b(186),Ia=b(24),jb=b(417),nb=b(28),Na=b(285),sa=b(287),Wa=b(117);n.prototype.getSheetName=
function(){return this.freezeOptions.SheetName};Object(J.a)(n,"MacroRecorderSheetPaneFrozenPayload",null,[430]);var Hb=b(43);k.prototype.Nc=function(mb,ic){var qc=!1;switch(ic){case 1844679312:qc=1!==mb&&!this.gridView.eb.C4}return qc};k.prototype.executeCommand=function(mb,ic){mb=this.gridView.eb;var qc=this.gridView.shd();cb.AFrameworkApplication.ta.Qa.jw&&this.$.v5&&(1844679312===ic.command||340334732===ic.command||-806625837===ic.command)&&la.ShyRibbon.nJ(1,2);switch(ic.command){case 1844679312:return this.setFreezePanes(ic,
qc,mb.Ji);case 340334732:return mb.o$b?va.Task.Ua(!1):this.Wrj(ic,qc);case -806625837:return mb.qTa?va.Task.Ua(!1):this.Xrj(ic,qc)}return va.Task.Ua(!1)};k.prototype.Ac=function(mb,ic){mb=!1;switch(ic.command){case 1844679312:case 340334732:case -806625837:case 1745254833:mb=!0}return mb};k.prototype.Tc=function(){return!1};k.prototype.setFreezePanes=function(mb,ic,qc){if(qc)return this.Avc(mb,!1,0,0,0,0,ic,null);var hc=this.gridView.ha.sa;qc=hc.activeCell.clone();hc=hc.activeRange;hc.We&&(N.ULS.sendTraceTag(537159585,
0,50,"FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top ("+qc.top+") and firstUnfreezeCell.Bottom ("+qc.bottom+") to equal topLeftRange.Top ("+ic.top+")"),qc.top=qc.bottom=ic.top);hc.isRow&&(N.ULS.sendTraceTag(537159584,0,50,"FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left ("+qc.left+") and firstUnfreezeCell.Right ("+qc.right+") to equal topLeftRange.Left ("+ic.left+")"),qc.left=qc.right=ic.left);qc.top===
ic.top&&qc.left===ic.left&&(qc=Ia.Range.Qc(qc.top+1,qc.left));hc=qc.top-1;var Jc=qc.left-1,rd=hc-(ic.top-1),md=Jc-(ic.left-1);return this.dXj(qc,rd,md)?this.Avc(mb,!0,hc,Jc,rd,md,ic,qc):(this.$.hf(),this.qFf(),va.Task.Ua(!0))};k.prototype.Wrj=function(mb,ic){return this.Avc(mb,!0,0,ic.left,0,1,ic,null)};k.prototype.Xrj=function(mb,ic){return this.Avc(mb,!0,ic.top,0,1,0,ic,null)};k.prototype.dXj=function(mb,ic,qc){var hc=this.gridView.gg(mb),Jc=this.gridView.view.visibleArea;return!hc||Jc.topLeft.y>
hc.bottomRight.y||Jc.topLeft.x>hc.bottomRight.x||Jc.bottomRight.y<hc.bottomRight.y||Jc.bottomRight.x<hc.bottomRight.x?(N.ULS.sendTraceTag(537159583,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create freeze pane when active cell not in view, range="+mb+", rangeViewportArea="+(hc?hc.toString():"null")+", visibleArea="+Jc.toString()),mb=ea.a.Xc(1,0,26,1483,0,2105967339,"FreezePaneSelectionNotInViewErr"),ia.EwaSettings.oz()?new P.a(this.$,mb):(mb=new X.ErrorDialog(this.$,mb),
mb.initialize(),mb.qf()),!1):0>=ic&&0>=qc?(N.ULS.sendTraceTag(537159582,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create empty freeze pane"),mb=Z.g(this.$).rtl?1485:1484,ic=Z.g(this.$).rtl?-2131054257:-1953454131,mb=ea.a.Xc(1,0,26,mb,0,ic,"FreezePaneA1SelectedErr"),ia.EwaSettings.oz()?new P.a(this.$,mb):(mb=new X.ErrorDialog(this.$,mb),mb.initialize(),mb.qf()),!1):!0};k.prototype.Avc=function(mb,ic,qc,hc,Jc,rd,md,Cc){function fd(){return new n(Sc)}var Cd=this;this.LFd=
Hb.a(this.$).R9(5,"SendFreezePanesRequest","SendFreezePanesRequest");this.gridView.nP(this.Ixf);this.iF.ESa();this.gridView.jGj(ic?"":"UnsetFreezePane");this.nuj(mb,ic,this.gridView.eb);var Sc=Object(Ba.a)(new f,{SheetName:this.$.pa.name,Freeze:ic,FrozenRows:Jc,FrozenColumns:rd,FirstRow:qc,FirstColumn:hc});N.ULS.sendTraceTag(573101852,0,50,"FreezePanesCommandHandler.SendFreezePanesRequest: Freeze="+ic+", FrozenRows="+Jc+", FrozenColumns="+rd+", FirstRow="+qc+", FirstColumn="+hc+" ");this.T$b=nb.a.Ta.Wd;
return O.a(this.$.userOperationManager,function(Md,bc,xe){if(ia.EwaSettings.ma(61)){var Je=window.performance;Je.clearMarks();Je.mark("FreezePanes request sent")}Je=Cd.gridView.Cs;ia.EwaSettings.isChangeGateEnabled("OfficeVSO:6661123_RequestContentOnFreezePaneOperation")&&Je?(Je=Cd.pnh(Sc,Je,md,Cc),Cd.ANj(Je)):Cd.$.py();Je=Cd.$.oa.va;var we=Je.Na(9,null);we.freezeSettings=Sc;return G.g(Je,"FreezeOrUnfreezePanes",we,Md,bc,xe,ic,0)},function(Md){return new B.a(151,0,Md,void 0,fd)},mb)};k.prototype.pnh=
function(mb,ic,qc,hc){N.ULS.shipAssertTag(537159580,1,!!ic,"FreezePaneCommandHandler.EstimatePaneViewDataOnPaneRequest: called with null Sheet Processed Data");if(!mb.Freeze)return null;var Jc=sa.a();Jc.State=1;Jc.IsEstimated=!0;var rd=!1,md=!1,Cc=ic.cV(Ia.Range.Qc(qc.top,qc.left)),fd=mb.FrozenRows,Cd=mb.FrozenColumns;1!==mb.FrozenRows||mb.FrozenColumns?mb.FrozenRows||1!==mb.FrozenColumns?(Cd=ic.cV(Ia.Range.Qc(mb.FirstRow+1,mb.FirstColumn+1)),ic=ic.cV(Ia.Range.Qc(qc.top,qc.left)),Jc.Width=Cd.nj-Cc.nj,
Jc.Height=Cd.vj-Cc.vj,0<mb.FrozenRows&&(Jc.AbsoluteTop=Cd.vj,md=!0),0<mb.FrozenColumns&&(Jc.AbsoluteLeft=Cd.nj,rd=!0),fd=Cd.VK-ic.VK,Cd=Cd.sJ-ic.sJ):(Jc.Width=ic.agd(ca.a.Qc(qc.top,qc.left)),hc=Ia.Range.Qc(qc.top,qc.left+1),Jc.AbsoluteLeft=Cc.nj+Jc.Width,rd=!0):(Jc.Height=ic.$fd(ca.a.Qc(qc.top,qc.left)),hc=Ia.Range.Qc(qc.top+1,qc.left),Jc.AbsoluteTop=Cc.vj+Jc.Height,md=!0);md&&(Jc.FirstFrozenRow=qc.top,Jc.FirstScrollableRow=hc.top);rd&&(Jc.FirstFrozenColumn=qc.left,Jc.FirstScrollableColumn=hc.left);
Jc.VisibleRows=fd;Jc.VisibleColumns=Cd;return Jc};k.prototype.ANj=function(mb){var ic=this;va.Task.delay(this.$.ya.GetRangeContentPrefetchDelayInMs).continueWith(function(){ic.$.pa&&ic.$.ea&&(ic.$.ea.pX(ka.a.Ee,"FreezePaneCommandHandler.TriggerDelayActiveItemPaneChange"),jb.b(ic.$.pa,mb,-1,void 0,!0))})};k.prototype.nuj=function(mb,ic,qc){if(!ia.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnfreezeViewportAdjustLocation",!1))switch(mb.command){case 1844679312:if(ic||-1===this.QKa&&-1===
this.RKa)this.QKa=qc.jx-qc.width+this.gridView.scrollLeft,this.RKa=qc.kx-qc.height+this.gridView.scrollTop;break;case 340334732:if(ic||-1===this.QKa)this.QKa=qc.jx-qc.width+this.gridView.scrollLeft;break;case -806625837:if(ic||-1===this.RKa)this.RKa=qc.kx-qc.height+this.gridView.scrollTop}};k.prototype.Utc=function(){var mb=this.gridView.eb;0<mb.width?this.gridView.scrollLeft=Wa.a.p1b(this.gridView.domElement,Z.g(this.$).rtl,0):-1!==this.QKa&&(this.gridView.scrollLeft=this.QKa,this.QKa=-1);0<mb.height?
this.gridView.scrollTop=0:-1!==this.RKa&&(this.gridView.scrollTop=this.RKa,this.RKa=-1)};k.prototype.qFf=function(){this.iF.eeb();Ra.a.Ia(this.LFd);this.LFd=null;this.gridView.LK(this.Ixf)};Object(J.a)(k,"FreezePanesCommandHandler",null,[401]);var Yb=S.a;$k(h,Yb);h.prototype.zd=function(){var mb=this;U.TaskExtensions.Aa(Q.GetServiceTaskFactory.Ra(this.$.da,12,477,this.hb),function(ic){mb.jd([new k(mb.$,ic.result)])},this.$.la)};h.ka=function(mb){mb.da.Ga(116,new h(mb))};Object(J.a)(h,"FreezePanesCommandHandlerFactory",
S.a,[]);var Sb=b(1376),lb=b(27),wb=b(634),wa=b(631),Oa=b(29),Ub=b(1212),hb=b(1301);b(328);var Xb=b(14),Gc=b(36);e.prototype.AZf=function(){this.jS=this.fontServiceManager.szc;this.Kua=this.fontServiceManager.ZDh;this.qbd=2};e.prototype.UVe=function(mb,ic,qc,hc){hc=void 0===hc?null:hc;var Jc=Object.assign(new wb.a,{Id:"FontDropdownMenu"});Jc.MenuSectionList=[];if(this.Am&&this.themesManager){this.themesManager.cad(hc);if(null==this.themesManager.lL||this.themesManager.grd)return Jc;hc=Object.assign(new wa.a,
{ControlsId:"ThemeFontsMenuSectionControl",Title:Xb.a.instance.ga(1329),ControlList:this.m_h(mb,ic,qc)});Jc.MenuSectionList.push(hc)}hc=Object.assign(new wa.a,{ControlsId:"FontsMenuSectionControl"});if(this.Am||this.an)hc.Title=Xb.a.instance.ga(1330);hc.ControlList=this.YPh(mb,ic,qc);Jc.MenuSectionList.push(hc);return Jc};e.prototype.m_h=function(mb,ic,qc){var hc,Jc=[],rd=this.gridView.ha.Oa.Yb;rd=5===(null===(hc=null===rd||void 0===rd?void 0:rd.floatingObject)||void 0===hc?void 0:hc.type);if(this.themesManager.lL){var md=
this.themesManager.lL.Kqf;var Cc=this.themesManager.lL.$of}else N.ULS.sendTraceTag(520710165,1,15,"ThemeFonts are Null");null!=Cc?(hc=this.iFe(Cc,1,rd,mb,ic,qc),Jc.push(hc)):N.ULS.sendTraceTag(520710164,1,15,"Major Theme Font is Null");null!=md?(mb=this.iFe(md,2,rd,mb,ic,qc),Jc.push(mb)):N.ULS.sendTraceTag(520710163,1,15,"Minor Theme Font is Null");return Jc};e.prototype.iFe=function(mb,ic,qc,hc,Jc,rd){var md=2===ic?this.VBi:this.bzi;qc=qc?md:Oa.a.af(mb);md=Oa.a.af(Ab.HelperMethods.Hcc(mb,ic));mb=
Oa.a.af(mb);return Object.assign(new Ub.a,{MenuItemId:2===ic?hb.b:hb.a,CommandValueId:qc,LabelText:md,LabelCss:String.format("font-size:12pt;font-family:{0};",mb),Styles:e.hwb(mb),AriaLabel:md,Alt:md,Command:hc.toString(),CommandPreviewId:Jc.toString(),CommandRevertId:rd.toString()})};e.prototype.YPh=function(mb,ic,qc){if(this.eZc)return this.eZc.A5c;var hc=this.pgi&&!this.Wff,Jc=!1;this.Kua||(this.O$e(),Jc=!0);var rd=this.KDe(mb,ic,qc,this.Kua,hc,Jc);rd.oxc&&!Jc&&(N.ULS.sendTraceTag(520710162,1,
15,"FontDropdownHelper.getFontButtonsForMenuSection: ddEntries is Null. Fallback to old Font Dictionary."),this.O$e(),rd=this.KDe(mb,ic,qc,this.Kua,hc,rd.oxc));this.an&&!rd.oxc&&(this.eZc=rd);hc&&gridRenderer.CanvasRendererGlobals.loadPreviewFont(this.aRi);return rd.A5c};e.prototype.KDe=function(mb,ic,qc,hc,Jc,rd){var md=[],Cc=this.an&&!rd;var fd=Cc?"msofpNew":"msofp";for(var Cd in hc){var Sc=Cd,Md=hc[Cd],bc=Oa.a.af(Sc),xe;if(Cc)if(xe=this.jS?this.jS[Sc]:null)xe=Oa.a.af(xe);else return N.ULS.sendTraceTag(520710161,
1,15,"FontDropdownHelper.getFontButtonsForMenuSection: localizedFontName in supportedFontFamiliesNew is not found for "+Sc),{oxc:!0,A5c:[]};else xe=Oa.a.af(Ab.HelperMethods.jS[Sc]);Sc=Oa.a.af(Sc);Jc||(Md=0);bc=Object.assign(new Ub.a,{MenuItemId:bc,CommandValueId:bc,LabelText:Jc&&0<Md?Oa.a.af(String.fromCodePoint(Md)):xe,LabelCss:String.format("font-size:12pt;font-family:{0};",Jc&&0<Md?fd:Sc),Styles:e.hwb(Jc&&0<Md?fd:Sc),AriaLabel:xe,Alt:xe,Command:mb.toString(),CommandPreviewId:ic.toString(),CommandRevertId:qc.toString()});
md.push(bc)}return{oxc:rd,A5c:md}};e.prototype.Msj=function(mb){this.menuId=mb};e.prototype.Zii=function(){return 2!==this.qbd&&3!==this.qbd?!1:!0};e.prototype.O$e=function(){var mb={};this.Kua=(mb["Angsana New"]=983046,mb["Arial Black"]=983051,mb.Arial=983050,mb.Batang=983061,mb["Book Antiqua"]=983077,mb["Browallia New"]=983082,mb.Calibri=983085,mb.Cambria=983089,mb.Candara=983091,mb.Century=983095,mb["Comic Sans MS"]=983100,mb.Consolas=983101,mb.Constantia=983102,mb.Corbel=983106,mb["Cordia New"]=
983107,mb["Courier New"]=983109,mb.DilleniaUPC=983121,mb.Dotum=983123,mb.FangSong=983138,mb.Garamond=983154,mb.Georgia=983156,mb.Gulim=983182,mb.GungSuh=983186,mb.KaiTi=983222,mb.JasmineUPC=983218,mb["Malgun Gothic"]=983258,mb.Mangal=983262,mb.Meiryo=983264,mb["Microsoft JhengHei"]=983272,mb["Microsoft YaHei"]=983284,mb.MingLiU=983292,mb.MingLiU_HKSCS=983296,mb["MS Gothic"]=983245,mb["MS Mincho"]=983247,mb["MS PGothic"]=983249,mb["MS PMincho"]=983251,mb.PMingliU=983322,mb["PMingLiU-ExtB"]=983324,
mb.SimHei=983382,mb.SimSun=983384,mb["SimSun-ExtB"]=983386,mb["Source Sans Pro"]=983396,mb.Tahoma=983405,mb.THSarabunPSK=983404,mb["Times New Roman"]=983415,mb["Trebuchet MS"]=983419,mb.Verdana=983443,mb["Yu Gothic"]=983464,mb["Yu Mincho"]=983474,mb)};e.hwb=function(mb){var ic={};ic["font-family"]=mb;ic["font-size"]="12pt";return{optionText:ic}};of.Object.defineProperties(e.prototype,{themesManager:{configurable:!0,enumerable:!0,get:function(){this.ex||(this.ex=this.$.da.za(422));return this.ex}},
szc:{configurable:!0,enumerable:!0,get:function(){return this.jS}}});Object(J.a)(e,"FontDropdownHelper",null,[932]);var uc=b(921),Nc=pb.a;$k(d,Nc);d.prototype.create=function(){var mb=this;ia.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FontServiceIntegration",!1)?this.$.da.Za(504,function(ic){mb.pb(Object(uc.c)(mb.$.da,502,function(){return new e(mb.$,ic)}))}):this.pb(Object(uc.c)(this.$.da,502,function(){return new e(mb.$,null)}))};d.ka=function(mb){mb.da.Ga(503,new d(mb))};Object(J.a)(d,
"FontDropdownHelperFactory",pb.a,[]);var Fb=b(1460),ob=b(1303),zb=b(1439),ib=b(1399),fc=b(1348),Ic=b(1373),Yc=b(1489),Mc=b(1440),xb=b(1410);c.prototype.Nc=function(){return!1};c.prototype.executeCommand=function(mb,ic){mb=!1;ic=ic.command;switch(ic){case 1910465940:mb=!0}return mb?va.Task.Ua(!0):da.a(ic)};c.prototype.Ac=function(mb,ic){switch(ic.command){case 1910465940:return!0;default:return!1}};c.prototype.Tc=function(){return!1};Object(J.a)(c,"NameManagerCommandHandler",null,[401]);var wc=S.a;
$k(a,wc);a.prototype.zd=function(){this.jd([new c(this.$)])};a.ka=function(mb){S.a.Pd(493,new a(mb))};Object(J.a)(a,"NameManagerCommandHandlerFactory",S.a,[]);var Ob=b(1400),nc=b(1386);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.AutoComplete");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ContextMenu");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidation");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidationEdit");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.FormulaAssistance");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory");Type.registerNamespace("_Ewa");Object(F.a)();fa.a.Fa(z.ka);fa.a.Fa(u.ka);Object(ma.a)();Object(Ea.a)();Object(Ha.a)();Object(Aa.a)();Object(V.a)();Object(La.a)();fa.a.Fa(v.ka);Object(Jb.a)();Object(dc.a)();Object($a.a)();(function(){fa.a.Fa(function(mb){h.ka(mb)})})();Object(Sb.a)();Object(Fb.a)();Object(ob.a)();Object(zb.a)();Object(ib.a)();Object(fc.a)();Object(Ic.a)();Object(Yc.a)();Object(Mc.a)();Object(nc.a)();
Object(xb.a)();Object(Ob.a)();(function(){fa.a.Fa(function(mb){a.ka(mb)})})();(function(){fa.a.Fa(function(mb){d.ka(mb)})})()},938:function(t,E,b){function a(B,Q,U,X,P,ea,ia,da,xa,Z,ha,ya){var va=O.call(this)||this;va.plc=!1;va.contextMenuController=null;va.XIc=null;va.iGc=null;va.hod=!1;va.I1j=0;va.H1j=0;va.Lsb=null;va.suc=null;va.tC=function(){va.contextMenuController?va.contextMenuController.tC():d.ULS.sendTraceTag(537167068,0,10,"ContextMenuBase.DismissFloatie: the context menu controller is null when attempintg to dismiss floatie on KeyDown.");
va.icg()};va.ib=B;va.kqf=P;va.$Pc=Z;va.R0j=U;va.Q0j=X;va.u0j=Q;va.AHf=ea;va.populateOnlyOnce=ia;va.f6h=ha;va.oOf(ya);return va}b.d(E,"a",function(){return a});t=b(0);var c=b(7),d=b(15),e=b(634),h=b(87),k=b(631),n=b(398),f=b(661),v=b(640),m=b(113),x=b(278),l=b(83),u=b(445),A=b(1609);E=b(79);var z=b(19),y=b(5),w=b(1058),D=b(76),H=b(41),F=b(59),J=b(151),S=b(114),N=b(1),T=b(11),G=b(22),I=b(14),K=b(21),L=b(33),O=E.a;$k(a,O);a.prototype.Nc=function(B,Q){B=!0;switch(Q){case 1651433993:case 1675506831:case 966232027:B=
this.Ud(4096)||this.Ud(2048);break;case 2045563128:B=this.Ud(4096);break;case 912277356:case 2123758504:case -1793121409:case 1378457149:B=this.Ud(8192)}return!B};a.prototype.Tc=function(B,Q,U){U.IsShadowMenuOpen||w.h(this.$,w.d);B=!1;Q===this.xw&&(U.IsShadowMenuOpen||w.h(this.$,w.a),Q=Object(c.a)(new e.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]}),this.RDd(Q,U.IsShadowMenuOpen),U.MenuItems=Q,U.IsShadowMenuOpen||w.h(this.$,w.c),B=!0);B&&this.plc&&T.HelperMethods.q1b&&!U.IsShadowMenuOpen&&
w.j(this.$);return B};a.prototype.RDd=function(B,Q){(Q=this.UY(Q))?(this.d9e(Q),B.MenuSectionList.push.apply(B.MenuSectionList,kk(Q.bE().MenuSectionList)),this.zDg(B)):d.ULS.sendTraceTag(537167105,0,10,"ContextMenuBase.PopulateContextMenuProps: CreateRibbonMenu() returned null instead of RibbonMenu instance")};a.prototype.UY=function(){d.ULS.sendTraceTag(537167104,0,10,"ContextMenuBase.CreateRibbonMenu: This method should not be called if the menu is not ready for React!");return null};a.prototype.M0=
function(B,Q,U,X,P){B=Sys.UI.DomElement.getBounds(Q);Q=new Sys.UI.Point(B.x,B.y+B.height);this.$.isChromeRtl&&(Q.x+=B.width);this.hp(Q,P)};a.prototype.hp=function(B,Q,U){U=void 0===U?0:U;Q&&(B=L.a(this.$).Ija(B));Q=!0;if(this.f6h){var X;3===U?(X=this.iKa(3))&&0<X.length?(Q=!1,this.showFloatie(X,new Sys.UI.Bounds(B.x,B.y,0,0),U)):d.ULS.sendTraceTag(537167075,0,10,"ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the touch floatie groups. Context menu ID: "+
this.menuId):2===U&&this.$.isEditMode&&((X=this.iKa(2))&&0<X.length?X[0]!==a.fUe?(Q=!1,this.bSd(X,new Sys.UI.Bounds(B.x,B.y,0,0),U)):d.ULS.sendTraceTag(537167074,0,50,"ContextMenuBase.ShowAt: The context menu does not support floatie. Context menu ID: "+this.menuId):d.ULS.sendTraceTag(537167073,0,10,"ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the mouse floatie groups. Context menu ID: "+this.menuId))}Q&&this.showContextMenu(new Sys.UI.Bounds(B.x,
B.y,0,0),U)};a.prototype.iKa=function(){return null};a.prototype.Wfd=function(B,Q){var U="";3===B?U="touch":2===B&&(U="mouse");B={};return B.ContextMenuId=this.menuId,B.IsEditMode=this.$.isEditMode,B.IsSLR=!!F.a.pg&&F.a.pg.dK,B.IsReactMLR=!!F.a.pg&&F.a.pg.AV,B.IsNov=this.$.ea.isNamedObjectViewMode,B.InputType=U,B.FloatieGroups=JSON.stringify(void 0===Q?null:Q),B};a.prototype.showContextMenu=function(B,Q){Q=void 0===Q?0:Q;var U=this.Wfd(Q);d.ULS.sendTraceTag(595359709,0,50,"ContextMenuBase.ShowContextMenu: rendering a context menu with given arguments: "+
JSON.stringify(U));this.contextMenuController?this.tB!==y.a.HGd&&this.tB!==y.a.IGd||0===Q?this.contextMenuController.aSd(this.tB,B,D.a.Cb):this.contextMenuController.aSd(this.tB,B,Q):d.ULS.sendTraceTag(537167072,0,10,"ContextMenuBase.ShowContextMenu: the context menu controller is null when attempintg to show context menu.")};a.prototype.showFloatie=function(B,Q,U){var X=this.Wfd(U,B);d.ULS.sendTraceTag(595359710,0,50,"ContextMenuBase.ShowFloatie: rendering a floatie with given arguments: "+JSON.stringify(X));
this.contextMenuController?(N.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.vOf(),this.contextMenuController.Sxc(B,Q,U)):d.ULS.sendTraceTag(537167071,0,10,"ContextMenuBase.ShowFloatie: the context menu controller is null when attempting to show the floatie with floatieGroups "+JSON.stringify(B)+".")};a.prototype.bSd=function(B,Q,U){var X=this.Wfd(U,B);d.ULS.sendTraceTag(537167070,0,50,"ContextMenuBase.ShowContextMenuWithFloatie: rendering a floatie with given arguments: "+
JSON.stringify(X));this.contextMenuController?(N.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.vOf(),this.contextMenuController.$Rd(B,Q,U,this.tB)):d.ULS.sendTraceTag(587335491,0,10,"ContextMenuBase.ShowContextMenuWithFloatie: the context menu controller is null when attempintg to show floatie with ContextMenu.")};a.prototype.oOf=function(B){this.contextMenuController=B};a.prototype.dispose=function(){this.$&&this.$.Ka.nbb(this);this.ib=null;N.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&
this.icg();this.suc&&(h.a.Ia(this.suc),this.suc=null);O.prototype.dispose.call(this)};a.prototype.uGh=function(B){var Q=this.$.da.za(204);Q&&(Q=Q.aHh(this.kqf))&&B.pc.push(Q)};a.prototype.Ud=function(B){return(new J.a(this.$.xa)).Ud(B)};a.prototype.d9e=function(B){B=ik(B.pc);for(var Q=B.next();!Q.done;Q=B.next())if(Q=Q.value,Object(u.a)(532,Q)){Q.title&&(Q.title=a.rh(Q.title));Q=ik(Q.buttons);for(var U=Q.next();!U.done;U=Q.next())U=U.value,Object(u.a)(533,U)?(U.label=a.rh(U.label),U.$R(a.rh(U.alt))):
Object(u.a)(534,U)&&this.d9e(U.menu)}};a.prototype.hqf=function(B,Q){Q=void 0===Q?!1:Q;var U=[];B=ik(B);for(var X=B.next();!X.done;X=B.next())U.push(this.pU(X.value,Q));return U};a.prototype.pU=function(B){for(var Q=[],U=ik(B.MenuItems),X=U.next();!X.done;X=U.next())switch(X=X.value,X.Type){case 3:Q.push(this.o6g(X));break;case 2:Q.push(this.Zah(X));break;case 1:Q.push(this.O7g(X))}return Object(c.a)(new k.a,{ControlList:Q,Title:B.Title,DisplayMode:"Menu16",MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,
ShowMenuSectionTitleIcon:!0})};a.prototype.scd=function(B,Q){Q=[this.Lsb,B.RibbonCommand.toString(),Q?this.NZe(Q):this.NZe(B.Label),B.Disabled?B.Disabled.toString():"False"];var U=B.CommandData;U=G.a.hashCode(U).toString();Q.push(U,B.Identifier.toString());Q=Q.join("_");B.IsChecked&&(Q+="_Checked");return Q};a.prototype.bHh=function(B){var Q=[this.Lsb,G.a.hashCode(B.Title).toString()];B=ik(B.MenuItems);for(var U=B.next();!U.done;U=B.next())Q.push(U.value.RibbonCommand.toString());return Q.join("_")};
a.prototype.TVe=function(B){var Q=B.Label;Q=G.a.hashCode(Q).toString();Q=[this.Lsb,Q];N.EwaSettings.isChangeGateEnabled("OfficeVSO:5139850_FixPivotFilterMenuDuplicatingIdenticalFields")&&B.Id&&Q.push(G.a.hashCode(B.Id).toString());Q=Q.join("_");B.IsChecked&&(Q+="_Checked");return Q};a.prototype.o6g=function(B){var Q=this.fac(B,!1);var U=Q.label;var X=Q.vLa;Q=Q.mr;var P=this.scd(B,U);return Object(c.a)(new n.a,{Command:B.Disabled?(-251203935).toString():Q.toString(),ExternalId:P,Id:P,Image16by16Class:X,
LabelText:U||B.Label,MenuItemId:B.CommandData,CommandValueId:B.CommandData})};a.prototype.Zah=function(B){var Q=this.fac(B,B.IsChecked);var U=Q.label;var X=Q.vLa;Q=Q.mr;var P=this.scd(B,U);return Object(c.a)(new f.a,{Command:B.Disabled?(-251203935).toString():Q.toString(),ExternalId:P,Id:P,Image16by16Class:X,LabelText:U||B.Label,MenuItemId:B.CommandData,CommandValueId:B.CommandData,IsChecked:B.IsChecked})};a.prototype.O7g=function(B){var Q=this.cWe(B);var U=Q.label;Q=Q.vLa;var X=Object(c.a)(new e.a,
{MenuSectionList:[],UpdateDynamically:!0});X.MenuSectionList.push.apply(X.MenuSectionList,kk(this.hqf(B.SubMenu.Sections,!0)));var P=this.TVe(B);B=U||B.Label;return Object(c.a)(new v.a,{ExternalId:P,Id:P,LabelText:B,PopulateOnlyOnce:!1,Menu:X,Image16by16Class:Q,ImageIsVisible:!!Q})};a.prototype.cWe=function(B){B=this.fac(B,!0);return{label:B.label,vLa:B.vLa,mr:B.mr}};a.prototype.fac=function(B,Q){switch(B.Identifier){case 26:var U=912804500;Q=z.a.hQe;B=I.a.instance.ga(1938);break;case 3:U=-1902148570;
Q=Q?z.a.uaa:null;B=I.a.instance.ga(1898);break;case 4:U=-1902148570;Q=Q?z.a.uaa:null;B=I.a.instance.ga(1899);break;case 5:U=-1902148570;Q=Q?z.a.uaa:null;B=null;break;case 1:U=-1677817820;Q=z.a.Y8b;B=I.a.instance.ga(235);break;case 2:U=-1649376918;Q=B.IsChecked?z.a.sua:null;B=I.a.instance.ga(2104);break;case 23:U=1701016594;Q=B.IsChecked?z.a.sua:null;B=I.a.instance.ga(2104);break;case 6:U=-87741481;Q=null;B=I.a.instance.ga(2105);break;case 7:U=1948650742;Q=z.a.WOe;B=I.a.instance.ga(1936);break;case 8:U=
1933713114;Q=z.a.VOe;B=I.a.instance.ga(1937);break;case 14:U=504133448;Q=z.a.$Ia;B=I.a.instance.ga(145);break;case 30:U=504133448;Q=z.a.$Ia;B=I.a.instance.ga(149);break;case 32:U=504133448;Q=z.a.$Ia;B=I.a.instance.ga(151);break;case 34:U=504133448;Q=z.a.$Ia;B=I.a.instance.ga(153);break;case 27:U=1701016594;Q=Q?z.a.$8b:z.a.$Ia;B=I.a.instance.ga(145);break;case 15:U=-798968736;Q=z.a.aJa;B=I.a.instance.ga(147);break;case 31:U=-798968736;Q=z.a.aJa;B=I.a.instance.ga(150);break;case 33:U=-798968736;Q=z.a.aJa;
B=I.a.instance.ga(152);break;case 35:U=-798968736;Q=z.a.aJa;B=I.a.instance.ga(154);break;case 28:U=1701016594;Q=Q?z.a.a9b:z.a.aJa;B=I.a.instance.ga(147);break;case 21:U=-2058042992;Q=z.a.B2a;B=null;break;case 29:U=1701016594;Q=z.a.B2a;B=null;break;case 9:U=1701016594;B=Q=null;break;case 11:U=-1494291901;B=Q=null;break;case 25:U=-1045020714;Q=B.IsChecked?z.a.sua:null;B=null;break;case 13:U=1701016594;Q=B.IsChecked?z.a.sua:null;B=I.a.instance.ga(156);break;case 16:U=1701016594;Q=z.a.Q8b;B=I.a.instance.ga(1071);
break;case 17:U=1701016594;Q=z.a.A2a;B=null;break;case 18:U=1701016594;Q=z.a.z2a;B=null;break;case 19:U=1701016594;Q=z.a.R8b;B=I.a.instance.ga(1076);break;case 20:U=1701016594;Q=z.a.t9c;B=I.a.instance.ga(1077);break;case 24:U=1675506831;B=Q=null;break;case 22:U=B.RibbonCommand;Q=B.IsChecked?z.a.uaa:null;B=null;break;case 36:U=1461300262;Q=null;B=I.a.instance.ga(155);break;case 38:U=B.RibbonCommand;Q=z.a.b9b;B=I.a.instance.ga(1809);break;default:d.ULS.shipAssertTag(537167069,0,!1,"Unable to map menu item: "+
JSON.stringify(B)),U=1461300262,B=Q=null}return{label:B,vLa:Q,mr:U}};a.prototype.NZe=function(B){return G.a.hashCode(B+T.HelperMethods.Gpj).toString()};a.prototype.zDg=function(B){if(!this.$.ea.amIAlone){var Q=this.$.da.za(25);if((void 0!==Q&&null!==Q||!N.EwaSettings.isChangeGateEnabled("OfficeVSO:5280339_GuardPresenceView"))&&!m.a.isEmpty(Q.XBa)&&(Q=Q.W0h(),!x.a.gh(Q))){var U=[];l.a.instance.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder").p$g(Q,U);B.MenuSectionList.push.apply(B.MenuSectionList,
kk(U))}}};a.prototype.vOf=function(){this.hod||(this.Iub&&this.Iub.TZb(this.tC),this.gqb&&this.gqb.TZb(this.tC),this.hod=!!this.Iub||!!this.gqb)};a.prototype.icg=function(){this.Iub&&this.Iub.Ysc(this.tC);this.gqb&&this.gqb.Ysc(this.tC);this.hod=!1};a.jnd=function(B,Q){Q=H.C(Q);B=K.g(B).Ea.tKa(Q);return!(null===B||void 0===B||!B.tk)};a.wdd=function(B,Q,U){Q=H.C(Q);var X=K.g(B).Ea.tKa(Q);Q=K.g(B).getCellBounds(X);var P=X.lOg;X=X.kOg;var ea=Q.x+P.x;Q=Q.y+P.y;U&&N.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")&&
(K.g(B).rtl||(ea+=X),Q-=X);return new Sys.UI.Point(ea,Q)};a.iyh=function(B){try{Object(A.a)(B.CommandValueId)}catch(Q){}};a.rh=function(B){var Q=a.N1a.parseFromString(B,"text/html");return Q?Q.body.innerText:(d.ULS.sendTraceTag(537167066,0,15,"Not able to decode htmlFormattedText"),B)};of.Object.defineProperties(a.prototype,{contextMenuRoot:{configurable:!0,enumerable:!0,get:function(){return this.suc}},$:{configurable:!0,enumerable:!0,get:function(){return this.ib}},Va:{configurable:!0,enumerable:!0,
get:function(){return this.$Pc}},menuId:{configurable:!0,enumerable:!0,get:function(){return this.$.zb+this.kqf}},Iub:{configurable:!0,enumerable:!0,get:function(){this.XIc||(this.XIc=S.a(this.$));return this.XIc}},gqb:{configurable:!0,enumerable:!0,get:function(){this.iGc||(this.iGc=K.g(this.$).Wb);return this.iGc}}});a.N1a=new DOMParser;a.fUe="Unsupported";Object(t.a)(a,"ContextMenuBase",E.a,[401,535,6])},996:function(t,E,b){function a(){}b.d(E,"a",function(){return a});t=b(0);a.LMe="ewa-ac";a.Inh=
"ewa-ac-param";a.ENe="ewa-function-help-link";a.m9c="ewa-lb";a.yNe="ewa-fb-refactor";a.listItem="list-item";a.hCb="list-item-selected";a.lCb="list-table-touch";a.kCb="list-table";a.uth="ewa-suggested-cell-name";a.n0g="columnName-header";a.zOe="ewa-tt";a.Kqh="ewa-function-link-container";a.FNe="ewa-function-udf-name";a.rtl="rtl";Object(t.a)(a,"CssClassNames",null,[])}}]);

//# sourceMappingURL=EwaDS.kpae.js.map