(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[28],{1353:function(t,E,b){function a(){Type.registerNamespace("Common.App.Rename");La.a.instance.Qi(new c,7)}function c(){this.jb=this.fb=null}function d(Ra,pb,cb,Sa,Db,Ab,Wb,ub,vb,Ka){var eb=h.call(this,Ra,cb,Sa,Db,Ab,vb)||this;eb.kYb=null;eb.slb=null;eb.Tug=pb;eb.La=Wb;eb.ae=ub;Ka&&Ka.execute(function(yb){eb.T$i(yb)});return eb}function e(Ra,pb,cb,Sa,Db,Ab,Wb,ub){Ra=h.call(this,Ra,pb,cb,Sa,Db,Ab)||this;Ra.Iee=Db;Ra.Qvg=Wb;
Ra.$qg=ub;return Ra}function h(Ra,pb,cb,Sa,Db,Ab){this.Lm=!1;this.AMc=new Aa.a;this.CVa=pb;this.BL=cb;this.fng=Sa;this.jb=Db;this.whe=Ab}function k(Ra,pb,cb,Sa,Db){this.EGc=Db;this.T9d=cb;this.S9d=Sa;this.zzg=Ra;this.pqa=pb}function n(Ra,pb){this.La=Ra;this.Vb=pb}function f(Ra){this.J8=null;this.cqa=0;this.La=Ra;this._initialized=!1}function v(Ra,pb,cb){var Sa=ja.call(this)||this;Sa.La=Ra;Sa.Av=pb;Sa.cqa=cb;Sa.ye="RenameDialog";Sa.Xf=m.Xf;return Sa}function m(){}function x(Ra,pb,cb){this.dialog=null;
this.La=Ra;this.Av=pb;this.cqa=cb}function l(Ra,pb){this.La=Ra;this.wVa=pb}function u(){}function A(Ra,pb,cb,Sa,Db,Ab,Wb,ub,vb,Ka,eb,yb){this.S9d=Ra;this.La=pb;this.EGc=cb;this.Av=Sa;this.dEa=Db;this.vzg=Ab;this.Ara=Wb;this.Oie=ub;this.Svg=vb;this.pqa=Ka;this.jb=eb;this.Rvg=yb}function z(){this.nEi=this.jEi=this.Ybh=null}function y(){}function w(Ra,pb,cb,Sa,Db,Ab,Wb,ub,vb,Ka,eb,yb){this._initialized=!1;this._element=null;this.lEa=0;this.HQc=this.iKc=!1;this.La=Ra;this.AFc=pb;this.Xd=cb;this.iA=Sa;
this.J8=Db;this.Nfe=Ab;this.IWb=Wb;this.uGc=ub;this.Y8=vb;this.H9d=Ka;this.nWa=eb;this.cLc=yb}function D(Ra,pb){this.lEa=0;this.La=Ra;this.J8=pb}function H(Ra,pb,cb,Sa,Db){var Ab=B.call(this)||this;Ab.R1=new N(Ra,pb,cb);Ab.Ara=Sa;Ab.pqa=Db;Ab.ye="RenameDisabledDialog";Ab.Rb=0;Ab.kc(1,CommonUIStrings.l_DialogClose);Ab.Xf=F.Xf;Ab.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);Ab.$W("RenameRow");return Ab}function F(){}function J(Ra,pb,cb,Sa,Db){return S.call(this,Ra,pb,cb,Sa,Db)||
this}function S(Ra,pb,cb,Sa,Db){var Ab=L.call(this)||this;Ab.AVd=[];Ab.R1=new N(Ra,pb,cb);Ab.Ara=Sa;Ab.pqa=Db;Ab.ye="RenameDisabledDialog";Ab.Rb=0;Ab.kc(1,CommonUIStrings.l_DialogClose);Ab.Suj();Ab.Wej();return Ab}function N(Ra,pb,cb){this.oSd=this.pSd=this.qSd=!1;this.FSd=!Ra&&!pb;this.GSd=!Ra&&!cb;this.FSd||this.GSd||(this.qSd=!Ra,this.pSd=!pb,this.oSd=!cb)}t=b(0);var T=b(84),G=b(624),I=b(15),K=b(135);Object(t.a)(N,"RenameDisabledDialogInfo",null,[]);var L=K.StandardDialog;$k(S,L);S.prototype.Suj=
function(){this.R1.FSd?this.zMb(this.Ara?this.pqa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.R1.GSd?this.zMb(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.NCg();this.Jra(this.AVd)};S.prototype.zMb=function(Ra){Array.add(this.AVd,Ra)};S.prototype.NCg=function(){var Ra=[];this.R1.qSd||Array.add(Ra,CommonUIStrings.l_RenameFileRenameDisabledSignIn);this.R1.pSd||
Array.add(Ra,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.R1.oSd||Array.add(Ra,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<Ra.length&&Array.add(this.AVd,Ra)};Object(t.a)(S,"ReactRenameDisabledDialogBase",K.StandardDialog,[]);$k(J,S);J.prototype.Wej=function(){this.kDb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)};Object(t.a)(J,"ReactRenameDisabledDialog",S,[]);var O=b(150);of.Object.defineProperties(F,{Xf:{configurable:!0,enumerable:!0,get:function(){return O.a.Oo(F.rk,
CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}});F.rk="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(t.a)(F,"RenameDisabledDialogHtml",null,[]);var B=O.a;$k(H,B);H.prototype.R9a=function(){if(this.R1.FSd){var Ra=this.Ara?this.pqa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;H.zMb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),Ra)}else this.R1.GSd?H.zMb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),
CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.N7h()};H.prototype.N7h=function(){this.R1.qSd&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.R1.pSd&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display="none");this.R1.oSd&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")};H.zMb=function(Ra,pb,cb){Ra.style.display="none";pb.innerText=cb};Object(t.a)(H,"RenameDisabledDialog",O.a,[]);
var Q=b(4),U=b(29),X=b(107),P=b(25);D.prototype.initialize=function(Ra){if(!this.La||!this.J8)return!1;this.lEa=Ra;this.Ag();return!0};D.prototype.Ag=function(){this.La.Mb(P.a.Vha,X.a.frame,Object(T.a)(this,this.Vha,"commitNewDocumentTitle"))};D.prototype.Vha=function(Ra,pb,cb,Sa,Db){if(1===cb)return this.La.processAction(P.a.renameFile,1);Ra=U.a.oq(this.J8.Pm);Db=(0,Db.getNewDocumentTitle)();Db.length>this.lEa&&(Db=Db.substr(0,this.lEa));if(32!==this.La.$d(P.a.renameFile,2,Db))return this.qX(Ra),
8;this.qX(Db);return 32};D.prototype.qX=function(Ra){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(Ra))};D.Yed=function(){return new D(Q.AFrameworkApplication.ub,Q.AFrameworkApplication.cm)};Object(t.a)(D,"ReactRenameUIHandler",null,[786]);var ea=b(93),ia=b(577),da=b(626),xa=b(13),Z=b(109),ha=b(249),ya=b(89),va=b(39),bb=b(27),ba=b(83);w.prototype.initialize=function(Ra,pb,cb){if(!(this.La&&this.J8&&this.Nfe&&this.IWb&&this.uGc&&pb)||0>=Ra)return!1;this._element=pb;this._element.title=
cb;this._element.setAttribute(ya.a.Gd,ya.a.Js);this._element.setAttribute("Unselectable","on");this.lEa=Ra;this.fv();return this._initialized=!0};w.prototype.fv=function(){this.AFc&&(this.AFc.ra(xa.a.blur,this._element,Object(T.a)(this,this.onBlur,"onBlur")),this.AFc.ra(xa.a.paste,this._element,Object(T.a)(this,this.onPaste,"onPaste")));this.Xd.ra(xa.a.Lb,this._element,Object(T.a)(this,this.onKeyDown,"onKeyDown"));this.iA.ra(xa.a.pointerDown,this._element,Object(T.a)(this,this.onPointerDown,"onPointerDown"));
this.iA.ra(xa.a.Hf,this._element,Object(T.a)(this,this.Ff,"onPointerUp"))};w.prototype.onBlur=function(){this.isActive&&!this.iKc&&(this.H9d||this.uGc(this._element),this.LAe(),this.C5c(!1));return this.iKc=!1};w.prototype.onPaste=function(){I.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0};w.prototype.onKeyDown=function(Ra){return this.isActive?this.YOi(Ra):this.ZOi(Ra)};w.prototype.YOi=function(Ra){var pb=!1;switch(Ra.Ca.keyCode){case Sys.UI.Key.enter:this.LAe();
this.C5c(this.nWa||this.cLc);pb=!0;break;case Sys.UI.Key.tab:this.H9d&&this.uGc(this._element);break;case Sys.UI.Key.esc:this.GLd(),this.C5c(this.nWa||this.cLc),pb=!0}return pb};w.prototype.ZOi=function(Ra){var pb=!1;switch(Ra.Ca.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.Dag(this.cLc),this.isActive&&this.IWb(this._element),pb=!0}return pb};w.prototype.onPointerDown=function(){this.isActive||(this.Dag(!1),this.isActive&&(this._element.focus(),this.IWb(this._element),this.HQc=!0));return!1};
w.prototype.Ff=function(){return this.HQc?(this.IWb(this._element),this.HQc=!1,!0):!1};w.prototype.Y6a=function(){return 32===this.La.processAction(P.a.renameFile,1)};w.prototype.LAe=function(){var Ra=U.a.oq(this.J8.Pm),pb=this._element.innerText.trim();pb.length>this.lEa&&(pb=pb.substr(0,this.lEa));pb!==Ra&&""!==pb?32!==this.La.$d(P.a.renameFile,2,pb)?this.GLd():this.qX(pb):this.GLd()};w.prototype.GLd=function(){this.qX(U.a.oq(this.J8.Pm))};w.prototype.qX=function(Ra){this._initialized&&(this._element.innerText=
Ra,this.Nfe())};w.prototype.Dag=function(Ra){this.Y6a()?this.isActive||(Ra&&(this.iKc=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(ya.a.Gd,ya.a.fXc),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,ea.CuiHelper.gKe),this.Y8&&this.Y8.execute(function(pb){pb.vLf(!0)}),Ra&&this._element.focus(),I.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.La.processAction(P.a.Ldb,
2)};w.prototype.C5c=function(Ra){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(ya.a.Gd,ya.a.Js);Sys.UI.DomElement.removeCssClass(this._element,ea.CuiHelper.gKe);this.Y8&&this.Y8.execute(function(pb){pb.vLf(!1)});Ra&&(this._element.blur(),this._element.focus())};w.Hz=function(){ia.a.Hz(Q.AFrameworkApplication.isRtl)};w.Yed=function(){return new w(Q.AFrameworkApplication.ub,da.a.instance,Z.KeyInputManager.instance,ha.a.instance,
Q.AFrameworkApplication.cm,w.Hz,va.a.cnj,va.a.KZg,ba.a.instance.Tb("Common.App.Header.HeaderEventSource"),bb.a.Kka,bb.a.Ug,bb.a.Pf)};of.Object.defineProperties(w.prototype,{isActive:{configurable:!0,enumerable:!0,get:function(){return"true"===this._element.getAttribute("contentEditable")}}});Object(t.a)(w,"RenameUIHandler",null,[786]);of.Object.defineProperties(y,{instance:{configurable:!0,enumerable:!0,get:function(){return Q.AFrameworkApplication.ta.Qa.isReactSharedHeaderUxEnabled?y.Ma||(y.Ma=D.Yed()):
y.Ma||(y.Ma=w.Yed())}}});y.Ma=null;Object(t.a)(y,"RenameUIHandlerFactory",null,[]);var fa=b(99),ra=b(136);Object(t.a)(z,"RenameMruEntryProperties",null,[]);var pa=b(396),Za=b(170),Ua=b(749),Ma;(function(Ra){Ra[Ra.unknown=-1]="unknown";Ra[Ra.success=0]="success";Ra[Ra.renameInvalidFileName=1]="renameInvalidFileName";Ra[Ra.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";Ra[Ra.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";Ra[Ra.permissionDenied=4]="permissionDenied";Ra[Ra.serverCommunicationFailure=
5]="serverCommunicationFailure";Ra[Ra.fileNameTooLong=6]="fileNameTooLong"})(Ma||(Ma={}));Object(t.b)("CommonOperationResult",Ma);A.prototype.Ag=function(){Q.AFrameworkApplication.ta&&Q.AFrameworkApplication.ta.Qa.isReactSharedHeaderUxEnabled||this.oi.Mb(P.a.Ayb,X.a.frame,Object(T.a)(this,this.Ayb,"initializeRenameUIHandler"));this.oi.Mb(P.a.Ldb,X.a.frame,Object(T.a)(this,this.Ldb,"showRenameDisabledDialog"));this.oi.Mb(P.a.renameFile,X.a.frame,Object(T.a)(this,this.renameFile,"renameFile"));this.oi.He(P.a.fileNameUpdate,
X.a.frame,Object(T.a)(this,this.D8i,"refreshFilename"),64);this.oi.He(P.a.Plc,X.a.frame,Object(T.a)(this,this.Plc,"moveToFolderCompleteByHost"),64);this.oi.Mb(P.a.iOa,X.a.frame,Object(T.a)(this,this.iOa,"moveToFolder"));Q.AFrameworkApplication.ta&&(Q.AFrameworkApplication.fa.qa("PostMessageEmbedded")||Q.AFrameworkApplication.fa.qa("IsJsApi"))&&Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",!0)&&Q.AFrameworkApplication.iV().execute(function(Ra){Ra.Tn(Za.a.drf);
Ra.Ml(Za.a.drf,A.q7i);Ra.Tn(Za.a.iad);Ra.Ml(Za.a.iad,A.o7i)})};A.prototype.Y6a=function(){return 0===this.Rvg.F1e()?32:8};A.prototype.kWj=function(){return this.Uy?this.Ara?this.Uy.gJe:this.Uy.$ub:!0};A.prototype.Ayb=function(){return y.instance.initialize(Q.AFrameworkApplication.R9b,Q.AFrameworkApplication.K1a,Q.AFrameworkApplication.YJd||CommonUIStrings.l_RenameFileTooltip)?32:8};A.prototype.Ldb=function(){var Ra=this.kWj(),pb=this.vzg();I.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.dEa,pb,Ra,this.Ara);Q.AFrameworkApplication.ta&&Q.AFrameworkApplication.ta.Qa.Yu&&Q.AFrameworkApplication.fa.qa("ReactRenameDisabledDialogIsEnabled")?new J(this.dEa,!pb,!Ra,this.Ara,this.pqa()):new H(this.dEa,!pb,!Ra,this.Ara,this.pqa());return 32};A.prototype.renameFile=function(Ra,pb,cb,Sa,Db){if(1===cb)return this.Y6a();if(!Q.AFrameworkApplication.q9b)return 8;if(8===this.Y6a())return this.oi.processAction(P.a.Ldb,2),8;I.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");Q.AFrameworkApplication.q9b(Db,
Object(T.a)(this,this.xFb,"onRenameFileSuccess"),Object(T.a)(this,this.HRi,"onRenameFileFailure"));return 32};A.prototype.xFb=function(Ra,pb){Ra?0!==Ra.OperationResult?this.x5e(Ra.OperationResult):(this.toj(pb,Ra.NewName),this.JRj(Ra,Object(T.a)(Q.AFrameworkApplication.ta.Qa,Q.AFrameworkApplication.ta.Qa.aeg,"updateOpenInClientDocumentUrl")),Q.AFrameworkApplication.fa.qa("DocumentNameInJewelInfoMenuIsEnabled")&&Q.AFrameworkApplication.ta.updateCommandUI(),this.Svg.Icg()):this.x5e(5)};A.prototype.toj=
function(Ra,pb){var cb={};cb[pa.a.yAh]=pb;Ra.wj(Za.a.iad,cb)};A.prototype.JRj=function(Ra,pb){this.XRj(Ra);Q.AFrameworkApplication.U6b=Ra.DirectInvokeDavUrl;pb=pb(Ra.EditDocInClientUrl);var cb=new z;cb.nEi=this.Av.Pm;cb.Ybh=pb;cb.jEi=Ra.EditDocInClientUrl;this.oi.$d(P.a.renameMostRecentlyUsedFileEntry,2,cb)};A.prototype.x5e=function(Ra){switch(Ra){case 1:Ra=new K.StandardDialog,Ra.Rb=0,Ra.fX(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.hUf()}};A.prototype.XRj=
function(Ra){this.Av.Pm=A.jLg(this.Av.Pm,Ra.NewName);Ra.BreadcrumbFolderName&&(this.Av.breadcrumbFolderName=Ra.BreadcrumbFolderName);Ra.BreadcrumbFolderUrl&&(this.Av.breadcrumbFolderUrl=Ra.BreadcrumbFolderUrl);this.Oie(Ra.NewName)};A.prototype.HRi=function(Ra){var pb=new K.StandardDialog;pb.Rb=0;switch(Ra){case 1:I.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");pb.PAa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:I.ULS.sendTraceTag(38114564,
203,50,"OnRenameFileFailure: FileNameTooLong");pb.PAa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,null);break;default:var cb={};I.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",(cb.Result=Ra,cb));pb.PAa(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}Q.AFrameworkApplication.iV().execute(function(Sa){var Db={};Sa.wj(Za.a.xAh,(Db.FailureMessage=Ma[Ra],Db))});this.hUf()};A.prototype.D8i=function(Ra,pb,
cb){if(1===cb)return this.Y6a();if(!Q.AFrameworkApplication.iJa)return 8;Q.AFrameworkApplication.iJa(Object(T.a)(this,this.uoc,"onRefreshFilenameSuccess"),Object(T.a)(this,this.toc,"onRefreshFilenameFailure"),!1);return 32};A.prototype.iOa=function(Ra,pb,cb,Sa,Db){if(1===cb)return Q.AFrameworkApplication.fa.qa("UiHostSupportsMoveToFolder")?32:8;if(2===cb){var Ab={};Ra=Q.AFrameworkApplication.Tba;pb=Q.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures");Ra=(!Ra||Ra&&pb)&&Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",
!1);Ab[pa.a.cIj]=Ra;Db&&Db.MoveButtonClickedTime&&(Ab[pa.a.ECi]=Db.MoveButtonClickedTime.getTime());Q.AFrameworkApplication.iV().execute(function(Wb){Wb.wj(Za.a.iOa,Ab)});if(Db&&Db.MoveButtonClickedTime){if(Ra=ra.a.Er())Db=(new Date).getTime()-Db.MoveButtonClickedTime.getTime(),Ra.set("MovePostDuration",Db.toString());fa.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",Ra)}return 32}return 8};A.prototype.Plc=function(Ra,pb,cb,Sa,Db){if(1===cb)return Q.AFrameworkApplication.fa.qa("UiHostSupportsMoveToFolder")?
this.Y6a():8;if(2===cb){if(!Q.AFrameworkApplication.WXf)return fa.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),8;if(!Db)return fa.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(Db[pa.a.zhi])if(Db[pa.a.Weg])if(Ra=Db[pa.a.Weg].toLowerCase(),pb=Q.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures"),cb=Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",
!1),pb&&Q.AFrameworkApplication.Tba&&cb){var Ab={};Ab[pa.a.XPa]="1";Ab[pa.a.documentUrl]=Ra;Ab[pa.a.reason]=Ua.a.saveAs;fa.Health.instance.recordKpiSuccess("MoveToFolder",null);Q.AFrameworkApplication.iV().execute(function(Wb){Wb.wj(Za.a.Sta,Ab)})}else if(!Q.AFrameworkApplication.Tba&&cb)fa.Health.instance.recordKpiSuccess("MoveToFolder",null),va.a.Te(Ra,va.a.sX(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return fa.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",
!1,!1,null),8;else fa.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else Q.AFrameworkApplication.iJa(Object(T.a)(this,this.uoc,"onRefreshFilenameSuccess"),Object(T.a)(this,this.toc,"onRefreshFilenameFailure"),!1),Q.AFrameworkApplication.WXf(),fa.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32};A.prototype.Xzj=function(Ra,pb){return Ra&&pb?Ra!==this.Av.breadcrumbFolderName||pb!==this.Av.breadcrumbFolderUrl:!1};A.prototype.uoc=function(Ra,pb){Ra&&(Ra.NewName!==
U.a.oq(this.Av.Pm)||this.Xzj(Ra.BreadcrumbFolderName,Ra.BreadcrumbFolderUrl))&&this.xFb(Ra,pb)};A.prototype.toc=function(){};A.prototype.hUf=function(){this.Oie(U.a.oq(this.Av.Pm))};A.avb=function(){return new A(Q.AFrameworkApplication.Z6a,new G.a(function(){return Q.AFrameworkApplication.ub}),new G.a(function(){return Q.AFrameworkApplication.Uy}),Q.AFrameworkApplication.cm,Q.AFrameworkApplication.limitedEdit,function(){return Q.AFrameworkApplication.userCanRename},Q.AFrameworkApplication.otc,Object(T.a)(y.instance,
y.instance.qX,"updateTitle"),ba.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),function(){return Q.AFrameworkApplication.isReadOnlyRecommended},Q.AFrameworkApplication.fa,ba.a.instance.resolve("Common.IRenameProps"))};A.jLg=function(Ra,pb){Ra=U.a.l4(Ra);return pb+Ra};A.q7i=function(Ra){var pb=Ra.Values[pa.a.ali];I.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",pb);pb?Q.AFrameworkApplication.ub.$d(P.a.Plc,2,Ra.Values):fa.Health.instance.recordKpiFailure("MoveToFolder",
"MoveToFolder Server Failure",!1,!1,null)};A.o7i=function(Ra){Q.AFrameworkApplication.ub.$d(P.a.renameFile,2,Ra.Values.NewName)};of.Object.defineProperties(A.prototype,{oi:{configurable:!0,enumerable:!0,get:function(){return this.La.value}},Uy:{configurable:!0,enumerable:!0,get:function(){return this.EGc.value}}});of.Object.defineProperties(A,{instance:{configurable:!0,enumerable:!0,get:function(){return A.Ma||(A.Ma=A.avb())}}});A.Ma=null;Object(t.a)(A,"RenameActor",null,[]);b(641);Object(t.a)(function(){},
"ActivityEventName",null,[]);u.compatMode="CompatMode";u.noSelection="NoSelection";Object(t.a)(u,"ActivityEventReason",null,[]);var oa=b(748);l.prototype.Ag=function(){this.La.Mb(P.a.C4f,X.a.frame,Object(T.a)(this,this.GCj,"showRenameDialogAction"))};l.prototype.GCj=function(Ra,pb,cb){Ra=32;if(1===cb)return oa.SessionStatusManager.instance.jxb||Q.AFrameworkApplication.h5?8:32;2===cb&&(32!==this.La.processAction(P.a.renameFile,1)?(this.La.processAction(P.a.Ldb,2),Ra=8):32===this.La.processAction(P.a.yMb,
1)?this.La.processAction(P.a.yMb,2):this.wVa.value.create().Lxc());return Ra};Object(t.a)(l,"RenameDialogActor",null,[779]);x.prototype.RWh=function(){var Ra={},pb={};Ra.nameInputProps=(pb.type="AppInputProps",pb.id=x.J1a,pb.label=CommonUIStrings.l_RenameDialogLabel,pb.value=U.a.oq(this.Av.Pm),pb.maxLength=this.cqa,pb);return Ra};x.prototype.Lxc=function(){var Ra=this.RWh(),pb={};Ra=(pb.id="RenameDialog",pb.bodyControls=Ra,pb);this.dialog=new O.a(!1,!1,!0);this.dialog.Rb=1;this.dialog.ye="RenameDialog";
this.dialog.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(T.a)(this,this.WJd,"renameDialogHandler"),Ra)};x.prototype.WJd=function(Ra,pb){pb&&1===Ra&&pb[x.J1a]&&(Ra=U.a.oq(this.Av.Pm),pb=(pb[x.J1a]||"").trim(),pb!==Ra&&""!==pb&&this.La.$d(P.a.renameFile,2,pb))};x.J1a="txtDocumentName";Object(t.a)(x,"ReactRenameDialog",null,[787]);of.Object.defineProperties(m,{Xf:{configurable:!0,enumerable:!0,get:function(){return O.a.Oo(m.rk,CommonUIStrings.l_RenameDialogLabel)}}});m.rk="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(t.a)(m,"RenameDialogHtml",null,[]);var ja=O.a;$k(v,ja);v.prototype.Lxc=function(){var Ra={};Ra=(Ra.txtDocumentName=U.a.oq(this.Av.Pm),Ra);this.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(T.a)(this,this.WJd,"renameDialogHandler"),Ra);Ra=document.getElementById(v.J1a);0<this.cqa&&(Ra.maxLength=this.cqa);Ra.focus()};v.prototype.WJd=function(Ra,pb){1===Ra&&(Ra=U.a.oq(this.Av.Pm),pb=(pb[v.J1a]||"").trim(),pb!==Ra&&""!==pb&&this.La.$d(P.a.renameFile,2,pb))};v.J1a="txtDocumentName";
Object(t.a)(v,"RenameDialog",O.a,[787]);f.prototype.initialize=function(Ra,pb){this.J8=Ra;this.cqa=pb;this._initialized=!0};f.prototype.create=function(){return this._initialized?Q.AFrameworkApplication.ta&&Q.AFrameworkApplication.ta.Qa.Yu&&Q.AFrameworkApplication.fa.qa("ReactRenameDialogIsEnabled")?new x(this.La,this.J8,this.cqa):new v(this.La,this.J8,this.cqa):null};Object(t.a)(f,"RenameDialogFactory",null,[770]);var ta=b(275),aa=b(188),ma=b(167),Ea=b(108),Ha=b(104);n.prototype.Ag=function(){this.La.Mb(P.a.yMb,
X.a.frame,Object(T.a)(this,this.HCj,"showRenameFlyoutAction"))};n.prototype.IVg=function(){return ma.d("setDocumentTitleFlyoutOpened")&&Q.AFrameworkApplication.ta.Qa.isReactSharedHeaderUxEnabled};n.prototype.HCj=function(Ra,pb,cb){if(1===cb)return this.IVg()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32};n.prototype.ZDg=function(){var Ra=this;n.Uni&&Q.AFrameworkApplication.N6a&&Ha.a.instance.Cg(new Ea.a(5,1,5E3,function(){32===Ra.La.processAction(P.a.yMb,
1)&&Ra.Vb&&Ra.Vb.ji.name===ta.AFrame.jaa&&(aa.a("RenameFloatieShownOnNewDocumentLoad",!0),Ra.La.processAction(P.a.yMb,2))}))};of.Object.defineProperties(n,{Uni:{configurable:!0,enumerable:!0,get:function(){n.nUb&&null!=n.nUb||(Q.AFrameworkApplication.Bkc("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),n.nUb=Q.AFrameworkApplication.fa?Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return n.nUb}}});
n.nUb=null;Object(t.a)(n,"RenameFlyoutActor",null,[769]);k.prototype.F1e=function(){if(!this.S9d())return 5;if(this.pqa())return 1;if(this.Uy){if(this.T9d&&!this.Uy.gJe)return 3;if(!this.T9d&&!this.Uy.$ub)return 4}return this.zzg()?0:2};of.Object.defineProperties(k.prototype,{Uy:{configurable:!0,enumerable:!0,get:function(){return this.EGc.value}}});Object(t.a)(k,"RenameProps",null,[768]);b(192);var Aa=b(100);h.prototype.enable=function(){this.Lm||(this.Icg(),this.$Td(),this.Lm=!0)};h.prototype.generateKey=
function(Ra,pb,cb){return String.format("{0}/{1}/{2}",cb,Ra,pb)};h.prototype.WRh=function(){var Ra=U.a.oq(this.CVa().Pm);return this.generateKey(this.CVa().breadcrumbFolderName,this.CVa().breadcrumbFolderUrl,Ra)};h.prototype.XRh=function(Ra,pb,cb){return Ra&&pb?this.generateKey(Ra,pb,cb):cb};h.prototype.vgh=function(Ra,pb,cb){return Ra&&Ra!==this.CVa().breadcrumbFolderName||pb&&pb!==this.CVa().breadcrumbFolderUrl?!0:cb!==U.a.oq(this.CVa().Pm)};h.prototype.Icg=function(){var Ra=this.WRh();this.AMc.ia(Ra,
new Date)};h.prototype.xDd=function(Ra){this.Fyj(Ra)&&this.Yje(Ra)};h.prototype.Fyj=function(Ra){var pb=this.fng();return pb?this.whe&&this.whe.Qzb||!pb.sdf||!Q.AFrameworkApplication.iJa?(this.f7f(Ra),this.Lm=!1):!0:!1};h.prototype.ADf=function(Ra,pb,cb,Sa){var Db=this.vgh(Ra,pb,cb);Ra=this.XRh(Ra,pb,cb);pb=this.AMc.yc(Ra).returnValue;Db&&!pb&&(this.y5e(Sa),I.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.nud));Db||this.AMc.ia(Ra,this.BL())};Object(t.a)(h,"ARenamedFileChecker",
null,[736]);$k(e,h);e.prototype.$Td=function(){this.Iee.rVc(Object(T.a)(this,this.k6e,"handleSettingsRefresh"))};e.prototype.k6e=function(Ra,pb){pb&&pb.ODb&&pb.SGi&&(pb.j7a("BreadcrumbDocName")||pb.j7a("BreadcrumbFolderName")||pb.j7a("BreadcrumbFolderUrl")||pb.j7a("DirectInvokeDAVUrl")||pb.j7a("EditDocInClientUrl"))&&(I.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.nud),this.xDd(pb))};e.prototype.f7f=function(){this.Iee.Ddj(Object(T.a)(this,this.k6e,"handleSettingsRefresh"))};
e.prototype.Yje=function(Ra){if(Ra&&Ra.ODb){var pb=Ra.ODb;this.ADf(pb.Wa("BreadcrumbFolderName"),pb.Wa("BreadcrumbFolderUrl"),pb.Wa("BreadcrumbDocName"),Ra)}};e.prototype.y5e=function(Ra){var pb=this,cb={OperationResult:0,classId:1};Ra=Ra.ODb;cb.BreadcrumbFolderName=Ra.Wa("BreadcrumbFolderName");cb.BreadcrumbFolderUrl=Ra.Wa("BreadcrumbFolderUrl");cb.DirectInvokeDavUrl=Ra.Wa("DirectInvokeDAVUrl");cb.EditDocInClientUrl=Ra.Wa("EditDocInClientUrl");Ra=Ra.Wa("BreadcrumbDocName");cb.NewName=Q.AFrameworkApplication.Rta?
Ra:U.a.oq(Ra);this.$qg.execute(function(Sa){pb.Sei(cb,Sa)})};e.prototype.Sei=function(Ra,pb){this.Qvg().xFb(Ra,pb)};of.Object.defineProperties(e.prototype,{nud:{configurable:!0,enumerable:!0,get:function(){return"RenamedFileCheckerUsingSettingsRefresh"}}});Object(t.a)(e,"RenamedFileCheckerUsingSettingsRefresh",h,[]);$k(d,h);d.prototype.T$i=function(Ra){this.kYb=Ra;this.kYb.EHg(Object(T.a)(this,this.Jid,"handleVisibilityChange"))};d.prototype.Jid=function(Ra,pb){!this.Lm||0!==pb.newState&&1!==pb.newState||
this.slb||(this.$Td(),this.xDd(this.slb))};d.prototype.$Td=function(){this.slb=new Ea.a(3,2,this.Tug(),Object(T.a)(this,this.xDd,"performRenameFileCheckTick"),89);this.ae.Cg(this.slb)};d.prototype.f7f=function(Ra){this.ae.Ep(Ra)};d.prototype.Yje=function(Ra){this.kYb&&2===this.kYb.F0j?this.Taj(Ra):Q.AFrameworkApplication.iJa(Object(T.a)(this,this.uoc,"onRefreshFilenameSuccess"),Object(T.a)(this,this.toc,"onRefreshFilenameFailure"),!0)};d.prototype.Taj=function(Ra){this.ae.Ep(Ra);this.slb=null};d.prototype.uoc=
function(Ra){Ra&&this.ADf(Ra.BreadcrumbFolderName,Ra.BreadcrumbFolderUrl,Ra.NewName,null)};d.prototype.y5e=function(){this.La.processAction(P.a.fileNameUpdate,2)};d.prototype.toc=function(){};of.Object.defineProperties(d.prototype,{nud:{configurable:!0,enumerable:!0,get:function(){return"RenamedFileCheckerUsingTask"}}});Object(t.a)(d,"RenamedFileCheckerUsingTask",h,[]);var V=b(96);c.prototype.Sh=function(Ra){var pb=this;this.fb=Ra;this.jb=Q.AFrameworkApplication.fa;this.fb.register(l,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Dc(function(){return new l(Q.AFrameworkApplication.ub,
pb.fb.zLd("Common.App.Rename.IRenameDialogFactory"))}).tc();this.fb.register(f,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Dc(function(){return new f(Q.AFrameworkApplication.ub)}).tc();this.fb.register(736,"Common.App.Rename.IRenamedFileChecker").Dc(function(){return pb.I$g()}).tc();this.fb.register(n,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Dc(function(){return new n(Q.AFrameworkApplication.ub,V.FocusManager.instance())}).tc()};
c.prototype.I$g=function(){var Ra=this;if(this.jb.qa("RenamedFileCheckerWithSettingsRefreshIsEnabled")){var pb=this.fb.nh("Common.IRefreshableAppSettings");if(pb&&pb.Ypd)return new e(function(){return pb.kd("RenamedFileCheckerMaxCachedAgeInMs",48E4)},function(){return Q.AFrameworkApplication.cm},function(){return new Date},function(){return Q.AFrameworkApplication.Uy},pb,this.fb.nh("Common.ISessionStatus"),function(){return A.instance},this.fb.Tb("Postmessage.IHostPostmessenger"))}return new d(function(){return Ra.jb.kd("RenamedFileCheckerMaxCachedAgeInMs",
48E4)},function(){return Ra.jb.kd("RenamedFileCheckerPingIntervalInMs",12E4)},function(){return Q.AFrameworkApplication.cm},function(){return new Date},function(){return Q.AFrameworkApplication.Uy},Q.AFrameworkApplication.fa,Q.AFrameworkApplication.ub,Q.AFrameworkApplication.zi,this.fb.nh("Common.ISessionStatus"),this.fb.Tb("Common.App.VisibilityManagement.IVisibilityManager"))};c.prototype.init=function(){this.jb.Vu(Object(T.a)(this,this.pB,"onFullAppSettingsReady"))};c.prototype.pB=function(){var Ra=
Q.AFrameworkApplication.ta.Qa.isReactSharedHeaderUxEnabled;Q.AFrameworkApplication.Z6a()&&y.instance.initialize(Q.AFrameworkApplication.R9b,Ra?null:Q.AFrameworkApplication.K1a,Ra?null:Q.AFrameworkApplication.YJd||CommonUIStrings.l_RenameFileTooltip)&&(this.fb.register(k,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Dc(function(){return new k(function(){return Q.AFrameworkApplication.userCanRename},function(){return Q.AFrameworkApplication.isReadOnlyRecommended},Q.AFrameworkApplication.otc,
Q.AFrameworkApplication.Z6a,new G.a(function(){return Q.AFrameworkApplication.Uy}))}).tc(),A.instance.Ag(),this.jb.qa("RenameDialogIsEnabled")&&(this.fb.resolve("Common.App.Rename.RenameDialogFactory").initialize(Q.AFrameworkApplication.cm,Q.AFrameworkApplication.R9b),this.fb.resolve("Common.App.Rename.IRenameDialogActor").Ag()),this.fb.resolve("Common.App.Rename.IRenameFlyoutActor").Ag(),Q.AFrameworkApplication.otc&&this.fb.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.fb.resolve("Common.App.Rename.IRenameFlyoutActor").ZDg())};
c.prototype.dispose=function(){};of.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.RenameFile"}}});Object(t.a)(c,"PackageManager",null,[10,11]);var La=b(258);b.d(E,"a",function(){return a})},1659:function(t,E,b){function a(Z){return xa.call(this,Z)||this}function c(Z){this.oi=Z}function d(Z){var ha=da.call(this)||this;ha.renameFileManager=null;ha.WY=null;ha.$=Z;ha.Eb();return ha}function e(Z,ha){var ya=ea.call(this)||this;ya.J5c=null;ya.xRf=
null;ya.XJd=null;ya.jda=null;ya.Yja=function(){var va=ya.$.ea.io;if(va&&va.WorkbookFileName){var bb=S.a.oq(va.WorkbookFileName),ba=!!Q.a.compare(ya.$.workbookContext.WorkbookFileName,va.WorkbookFileName,!1),fa=B.EwaSettings.ma(542)&&!!va.BreadcrumbFolderUrl&&!!Q.a.compare(ya.$.workbookContext.FullDocumentInfo.BreadcrumbFolderUrl,va.BreadcrumbFolderUrl,!1);if(ba||fa)ya.jda={},ya.jda.NewFileName=bb,ya.jda.EditDocInClientUrl=va.EditDocInClientUrl,ya.jda.DirectInvokeDAVUrl=va.DirectInvokeDAVUrl,ya.jda.DownloadACopyUrl=
va.DownloadACopyUrl,B.EwaSettings.ma(542)&&va.BreadcrumbFolderUrl&&(ya.jda.BreadcrumbFolderName=va.BreadcrumbFolderName,ya.jda.BreadcrumbFolderUrl=va.BreadcrumbFolderUrl),va=l.AFrameworkApplication.ub.$d(z.a.fileNameUpdate,2,bb),ya.jda=null,J.ULS.shipAssertTag(537154064,0,32===va,"RenameFileManager.HandleWorkbookMetadataChanged - Workbook Name Update Failed")}};ya.bLi=function(va,bb,ba){ya.xRf=bb;ya.XJd=ba;bb={};ya.$.Ka.Kb(new L.a(1897077126,G.a.Cb,2,3,null),(bb.newFileName=va,bb))};ya.aLi=function(va){ya.jda&&
va(ya.G1e(ya.jda),ya.Pr)};ya.xFb=function(va){O.a(va)||!va.Result?(va=e.AHh(va),P.a(ya.$).dd.eJ([-414480287,650565124,-782844485,1223808266,-62451516,1636785843]),ya.XJd(va)):ya.xRf(ya.G1e(va.Result),ya.Pr)};ya.GRi=function(){ya.XJd(5)};ya.$=Z;ya.Pr=ha;ya.$.ea.Bu(ya.Yja);return ya}function h(Z){this.$=Z}function k(Z){return w.call(this,Z)||this}function n(Z){this.renameFileManager=Z}b.r(E);t=b(1353);var f=b(10);E=b(0);var v=b(915),m=b(50),x=b(37),l=b(4),u=b(59),A=b(187),z=b(25),y=b(58);n.prototype.executeCommand=
function(Z,ha,ya){switch(ha.command){case z.a.Vha:return u.a.pg.isReactSharedHeaderUxEnabled?2!==l.AFrameworkApplication.ub.$d(z.a.Vha,2,ya)?y.Task.Ua(!0):A.a(ha.command):A.a(ha.command);case 1897077126:return this.renameFileManager.renameFile(ya,ha),y.Task.Ua(!0);default:return A.a(ha.command)}};n.prototype.Ac=function(Z,ha,ya,va){switch(ha.command){case z.a.Vha:return u.a.pg.isReactSharedHeaderUxEnabled;case 1897077126:return!!va&&2===va.Ry}return!1};n.prototype.Tc=function(){return!1};n.prototype.Nc=
function(){return!1};n.prototype.dispose=function(){this.renameFileManager=null};Object(E.a)(n,"RenameFileCommandHandler",null,[401,6]);var w=v.a;$k(k,w);k.prototype.zd=function(){var Z=this,ha=m.GetServiceTaskFactory.create(this.$.da,119,this.la,this.hb);x.TaskExtensions.Aa(ha,function(){Z.jd([new n(ha.result)])},this.la,3)};k.ka=function(Z){v.a.Pd(118,new k(Z))};Object(E.a)(k,"RenameFileCommandHandlerFactory",v.a,[]);var D=b(87),H=b(235),F=b(226),J=b(15),S=b(29),N=b(79),T=b(402),G=b(76),I=b(394),
K=b(177),L=b(91),O=b(299),B=b(1),Q=b(22),U=b(298);of.Object.defineProperties(h.prototype,{sdf:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.FileCoauthorable}},Qzb:{configurable:!0,enumerable:!0,get:function(){return!1}},$ub:{configurable:!0,enumerable:!0,get:function(){return this.$.ea.amIAlone}},gJe:{configurable:!0,enumerable:!0,get:function(){if(this.$ub)return!0;for(var Z=ik(this.$.ea.Bm),ha=Z.next();!ha.done;ha=Z.next())if(!ha.value.SupportsRename)return!1;return!0}}});
Object(E.a)(h,"EwaCoauthManager",null,[312]);var X=b(62),P=b(68),ea=N.a;$k(e,ea);e.prototype.initialize=function(){l.AFrameworkApplication.q9b=this.bLi;l.AFrameworkApplication.iJa=this.aLi;this.J5c=l.AFrameworkApplication.Uy;l.AFrameworkApplication.Uy=new h(this.$)};e.prototype.dispose=function(){l.AFrameworkApplication.q9b=null;l.AFrameworkApplication.iJa=null;this.$.ea.Ew(this.Yja);l.AFrameworkApplication.Uy=this.J5c;this.$=this.J5c=null;ea.prototype.dispose.call(this)};e.prototype.renameFile=function(Z,
ha){var ya=this,va=Z.newFileName;if(va){var bb=this.$.oa.va.Pb();I.a(this.$.userOperationManager,function(ba,fa,ra){var pa=ya.$.oa.va;ba=U.b(ba,ya.xFb);fa=U.a(fa,ya.GRi);var Za=pa.Na(9,bb);Za.newFileName=va;return X.g(pa,"RenameFile",Za,ba,fa,ra,null,0)},function(ba){return new K.a(134,0,ba)},ha)}};e.prototype.jhi=function(){return 32===l.AFrameworkApplication.ub.processAction(z.a.Vha,1)};e.prototype.G1e=function(Z){var ha=this.$.workbookContext;l.AFrameworkApplication.eZ=Z.DownloadACopyUrl;var ya=
B.EwaSettings.ma(542)&&!!Z.BreadcrumbFolderUrl;ya&&(l.AFrameworkApplication.cm.breadcrumbFolderName=Z.BreadcrumbFolderName,l.AFrameworkApplication.cm.breadcrumbFolderUrl=Z.BreadcrumbFolderUrl,ha.FullDocumentInfo.BreadcrumbFolderUrl=Z.BreadcrumbFolderUrl,ha.FullDocumentInfo.BreadcrumbFolderName=Z.BreadcrumbFolderName);ha.FullDocumentInfo.BreadcrumbDocName=Z.NewFileName;T.d(ha,Z.NewFileName);ha={};ha.NewName=Z.NewFileName;ha.DirectInvokeDavUrl=Z.DirectInvokeDAVUrl;ha.EditDocInClientUrl=Z.EditDocInClientUrl;
ya&&(ha.BreadcrumbFolderName=Z.BreadcrumbFolderName,ha.BreadcrumbFolderUrl=Z.BreadcrumbFolderUrl);ha.OperationResult=0;return ha};e.AHh=function(Z){switch(Z.Errors[0].MessageId){case -414480287:Z=2;break;case 650565124:Z=1;break;case 1636785843:Z=6;break;case -782844485:Z=4;break;default:Z=5}return Z};Object(E.a)(e,"RenameFileManager",N.a,[930,6]);var ia=b(51),da=H.a;$k(d,da);d.prototype.create=function(){var Z=this;if(!this.WY){var ha=F.a.UHa(ia.b(),this.la,"Task","IRenameFileManager");this.WY=ha.task;
var ya=m.GetServiceTaskFactory.create(this.$.da,137,this.la,this.hb),va=m.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb);x.TaskExtensions.Aa(x.TaskExtensions.Vd([va,ya],this.la),function(){var bb=new e(Z.$,ya.result);Z.$.da.Ga(120,bb);ha.setResult(bb)},this.la,3)}this.WY.continueWith(function(bb){Z.pb(bb.result)})};d.prototype.dispose=function(){D.a.Ia(this.renameFileManager);this.$=this.renameFileManager=null;da.prototype.dispose.call(this)};d.ka=function(Z){Z.da.Ga(119,new d(Z))};Object(E.a)(d,
"RenameFileManagerServiceFactory",H.a,[]);c.prototype.Nc=function(){return!1};c.prototype.executeCommand=function(Z,ha,ya){return 2!==this.oi.$d(z.a.C4f,2,ya)?y.Task.Ua(!0):A.a(ha.command)};c.prototype.Ac=function(Z,ha){return 1204860550===ha.command};c.prototype.Tc=function(){return!1};Object(E.a)(c,"RenameFileDialogCommandHandler",null,[401]);var xa=v.a;$k(a,xa);a.prototype.zd=function(){var Z=this;x.TaskExtensions.Aa(m.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb),function(){Z.jd([new c(l.AFrameworkApplication.ub)])},
this.la,3)};a.ka=function(Z){v.a.Pd(131,new a(Z))};Object(E.a)(a,"RenameFileDialogCommandHandlerFactory",v.a,[]);Type.registerNamespace("_Ewa");Object(t.a)();(function(){f.a.Fa(function(Z){d.ka(Z);k.ka(Z)})})();f.a.Fa(a.ka)}}]);

//# sourceMappingURL=EwaDS.rn.js.map