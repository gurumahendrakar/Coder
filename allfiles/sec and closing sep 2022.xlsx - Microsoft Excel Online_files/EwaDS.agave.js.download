/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <http://feross.org>
 @license  MIT
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1030:function(t,E,b){function a(d,e,h){this.TQb=d;this.clg=e;this.dlg=h}function c(){this.title=this.id=this.tabs=null}t=b(0);Object(t.a)(c,"AddInDataTransferObject",null,[]);b.d(E,"a",function(){return a});a.w3a=function(d){return(d=d.ZV)?Object.assign(new c,{tabs:d.Fs.toArray(),id:d.FCg,title:d.GCg}):null};of.Object.defineProperties(a.prototype,{Fs:{configurable:!0,enumerable:!0,get:function(){return this.TQb}},FCg:{configurable:!0,
enumerable:!0,get:function(){return this.clg}},GCg:{configurable:!0,enumerable:!0,get:function(){return this.dlg}}});Object(t.a)(a,"OneLineRibbonExtensibility",null,[])},1067:function(t,E,b){function a(J,S,N){N=void 0===N?null:N;this.JEc=new m.a;var T=new f.a;S&&T.add(S.Syi);N&&T.addRange(N);this.Jm=J;this.Zyg=T}function c(J,S,N,T){this.jT=new f.a;this.lG=new f.a;this.xpa=null;this.nlb=new f.a;this.V$d=Promise.resolve(null);this.Yge=!1;this.oWb=S;this.Rng=J;this.Bhe=N;this.hlg=T}function d(){var J=
e.call(this)||this;J.errorCode=0;return J}function e(){this.xRb=new f.a;this.b$=this.a$=!1;this.toa=this.authChallenge=null;this.startTime=this.retryCount=0;this.Noe=null}function h(){this.token=null;this.expiresOn=0;this.lha=this.authChallenge=null}function k(){this.accessToken=null}function n(){this.startTime=0;this.callback=null}b.r(E);t=b(0);var f=b(192),v=b(15),m=b(100);Object(t.a)(n,"SSOCallbackInfo",null,[]);Object(t.a)(k,"AccessTokenInformation",null,[255]);var x=b(1181);Object(t.a)(h,"CachedTokenInfo",
null,[]);of.Object.defineProperties(e.prototype,{callbacks:{configurable:!0,enumerable:!0,get:function(){return this.xRb}}});Object(t.a)(e,"SSORequestInfo",null,[]);$k(d,e);Object(t.a)(d,"SSOFailedRequestInfo",e,[]);var l=b(4);c.prototype.Xyj=function(J){if(this.xpa&&this.xpa.authChallenge===J.authChallenge){if(Date.now()/1E3+c.qAi>this.xpa.expiresOn)return this.xpa=null,!1;J=new x.a;J.token=this.xpa.token;J.expiresOn=this.xpa.expiresOn;J.lha=this.xpa.lha;J.lTa=!0;J.Hwb=0;this.$wb(J);return!0}return!1};
c.prototype.Exj=function(J){for(var S=0;S<this.lG.count;S++)if(this.lG.na(S).authChallenge===J.authChallenge&&this.lG.na(S).toa===J.toa){var N=void 0;(N=this.lG.na(S)).retryCount=N.retryCount+1;J.retryCount=this.lG.na(S).retryCount;if(this.lG.na(S).retryCount<c.NAi||!this.lG.na(S).a$&&J.a$||!this.lG.na(S).b$&&J.b$){if(!this.lG.na(S).a$&&J.a$||!this.lG.na(S).b$&&J.b$)J.retryCount=0;this.lG.removeAt(S);break}J=new x.a;J.errorCode=this.lG.na(S).errorCode;this.$wb(J);return!0}return!1};c.prototype.yEg=
function(J,S){for(var N=0;N<this.lG.count;N++)if(this.lG.na(N).toa===J.toa&&this.lG.na(N).authChallenge===J.authChallenge)return;this.lG.add(Object.assign(new d,{a$:J.a$,b$:J.b$,authChallenge:J.authChallenge,toa:J.toa,errorCode:S,retryCount:J.retryCount}))};c.prototype.Acd=function(J,S,N,T,G,I){var K=this,L=b(1067).AppsForOfficeSingleSignOnManager;""===N&&(N=null);if(this.Yge)L.Q5(I,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{for(var O=null,B=ik(this.jT),Q=B.next();!Q.done;Q=
B.next())if(Q=Q.value,Q.a$===J&&Q.b$===S&&Q.authChallenge===N&&Q.toa===G){O=Q;break}O||(O=Object.assign(new e,{a$:J,b$:S,authChallenge:N,Noe:T,toa:G,retryCount:0,startTime:L.dw()}),this.jT.add(O));O.retryCount=0;O.callbacks.add(I);this.V$d=this.V$d.then(function(){var U=b(1067).AppsForOfficeSingleSignOnManager;if(0<K.jT.count){var X=K.jT.na(0);if(K.Xyj(X)||K.Exj(X))return null;for(var P=0;P<K.nlb.count;)K.nlb.na(P)+c.uKj<U.dw()?K.nlb.removeAt(P):P++;if(K.nlb.count>=c.IAi||K.jT.count>=c.mAi)return X=
new x.a,X.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,K.$wb(X),null;var ea=null;l.AFrameworkApplication.ta&&(U=l.AFrameworkApplication.ta.sD)&&(ea=U.sc("ComponentAttach",K.Rng+c.Wxg));return X.toa.zAg(K.resource,X.a$,X.b$,X.authChallenge,K.hlg,X.Noe).then(function(ia){ea&&ea.stop();K.$wb(ia)},function(){ea&&ea.stop();var ia=new x.a;ia.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;K.$wb(ia)})}return null})}};c.prototype.$wb=function(J){var S=b(1067).AppsForOfficeSingleSignOnManager;
try{if(this.jT.count){var N=this.jT.na(0);this.jT.removeAt(0);var T=null;J.errorCode||(T=new k,T.accessToken=J.token);J.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&J.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&J.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&J.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.yEg(N,J.errorCode);var G={};null!=J.Hwb&&(G.getTokenSilentTime=J.Hwb.toString());null!=J.Zgd&&
(G.getTokenPopupTime=J.Zgd.toString());null!=J.Med&&(G.getIDTokenTime=J.Med.toString());null!=J.lTa&&(G.tokenCached=J.lTa.toString());J.uVd&&(G.detailedError=J.uVd);J.lha&&(G.authLibrary=J.lha);N.retryCount&&(G.retryCount=N.retryCount);for(var I=ik(N.callbacks),K=I.next();!K.done;K=I.next())S.Q5(K.value,J.errorCode,T,G);null!=J.lTa&&J.lTa||this.nlb.add(N.startTime);if(!J.errorCode)for(null!=J.expiresOn&&(this.xpa=Object.assign(new h,{token:J.token,expiresOn:J.expiresOn,authChallenge:N.authChallenge,
lha:J.lha})),this.lG.clear(),I=0;I<this.jT.count;)if(this.jT.na(I).authChallenge===N.authChallenge){var L=ik(this.jT.na(I).callbacks);for(K=L.next();!K.done;K=L.next())S.Q5(K.value,J.errorCode,T,G);this.jT.removeAt(I)}else I++}}catch(O){v.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",O.message)}};c.prototype.shutdown=function(){this.Yge=!0;this.jT.clear()};of.Object.defineProperties(c.prototype,{resource:{configurable:!0,enumerable:!0,get:function(){return this.oWb}}});
c.uKj=6E4;c.IAi=6;c.mAi=6;c.NAi=3;c.qAi=300;c.Wxg="GetAccessToken";Object(t.a)(c,"SSOCallbackManager",null,[]);var u=b(941),A=b(953),z=b(124),y=b(81),w=b(27),D=b(29),H=b(153),F=b(360);b.d(E,"AppsForOfficeSingleSignOnManager",function(){return a});a.prototype.Bcd=function(J,S,N,T,G,I,K,L,O,B){B=Object.assign(new n,{startTime:a.dw(),callback:B});try{var Q=!!N&&""!==N,U=B.startTime,X=this.getOsfControl(J),P=X.getStoreType()||"",ea=X.getOwnerAddinStoreType()||"",ia=X.getSolutionId()||"",da=X.getVersion()||
"";P=P.toLowerCase();ea=ea.toLowerCase();ia=ia.toLowerCase();var xa=y.a.Led(S)||"",Z=y.a.Led(X.getIframeUrl())||"",ha=xa.toLowerCase()===Z.toLowerCase();xa=P;"inmemory"===P&&(xa=ea);var ya=Telemetry.PrivacyRules.GetPrivacyCompliantId(ia,xa,X.getAssetId(),null,null,X.getStoreId());X={};var va=(X.callInstanceId=U.toString(),X.controlAssetId=ya,X.controlVersion=da,X.storeType=P,X.ownerStoreType=ea,X.allowConsentPrompt=T.toString(),X.forMSGraphAccess=G.toString(),X.allowSignInPrompt=I.toString(),X.hasAddinAuthChallenge=
Q.toString(),X.securityOriginEqualsSourceLocation=ha.toString(),X.singleSignOnEnabled=K.toString(),X.accountTypeFilter=L||"",X);v.ULS.sendTraceTag(51401115,344,50,"{0}",va);H.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:z.a.Gk(va)}));U=!0;var bb=l.AFrameworkApplication.fa.Wa("HostAuthType");switch(L){case "aad":U="aad"===bb;break;case "msa":U="msa"===bb;break;default:U=!L||"noFilter"===L}if(U){L=null;if(K)for(var ba=ik(this.Zyg),
fa=ba.next();!fa.done;fa=ba.next()){var ra=fa.value;if(ra.rii(ia)){L=ra;break}}L?this.isSSOAddin(J)?(K=!0,"omex"===xa&&(K=!1),"spapp"===xa||"spcatalog"===xa?(v.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),a.Q5(B,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):G&&!K?(v.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),a.Q5(B,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,
null,null)):(G&&"exchange"===xa&&(T=!1),this.Acd(J,S,N,xa,T,I,O,L,B))):(v.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),a.Q5(B,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):a.Q5(B,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else a.Q5(B,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(pa){this.rkc(),v.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",
pa.message),a.Q5(B,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}};a.prototype.getAccessToken=function(J,S,N,T){this.Bcd(J,N[u.a.MVc]||null,N[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,N[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,N[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,N[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,S,N[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||
null,N[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,T)};a.prototype.Acd=function(J,S,N,T,G,I,K,L,O){this.JEc.kb(J)?T=this.JEc.na(J):(T=new c(J,this.getWebApplicationResource(J).split(",")[0],T,this.getDefaultDisplayName(J)),this.JEc.add(J,T));var B=T.resource;J=a.jXh(B,this.getWebApplicationId(J));var Q=OfficeExt.WACUtils.getHostSecure(S);J&&Q?J.toLowerCase()===Q.toLowerCase()?T.Acd(G,I,N,K,L,O):(a.ONa('SSO Resource "'+B+'" cannot be used from "'+S+'" origin due to domain mismatch.'),
v.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),a.Q5(O,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(J||v.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),Q||v.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),a.Q5(O,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))};a.prototype.rkc=function(){var J={};v.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",
(J.UserAgent=window.navigator.userAgent,J))};a.prototype.getOsfControl=function(J){return this.Jm.getOsfControl(J)};a.prototype.isSSOAddin=function(J){return this.getOsfControl(J).getManifest().isSSOAddin()};a.prototype.getWebApplicationId=function(J){return this.getOsfControl(J).getManifest().getWebApplicationId()};a.prototype.getWebApplicationResource=function(J){return this.getOsfControl(J).getManifest().getWebApplicationResource()};a.prototype.getDefaultDisplayName=function(J){return this.getOsfControl(J).getManifest().getDefaultDisplayName()};
a.TYh=function(){try{var J={};w.a.mxa&&A.a.Sxb&&(J.UiHostSupportsAuthTokenAddinList=a.RTe);J.UiHostSupportsAuthToken=A.a.Sxb;return J}catch(S){v.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",S.message)}return null};a.getInstance=function(J,S,N){a.Ma||(a.Ma=new a(J,void 0===N?null:N));return a.Ma};a.ONa=function(J){window.console.warn&&window.console.warn(J)};a.jXh=function(J,S){if(!J)return"";S||(S="");var N=J.toLowerCase(),T=S.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(T)||
(a.ONa('SSO App Id "'+S+'" is not a valid format. It will be rejected from store submission.'),v.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));N.endsWith(T)||(a.ONa('SSO Resource "'+J+'" does not end with App Id "'+S+'". It will be rejected from store submission.'),v.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!N.startsWith("https://")&&!N.startsWith("api://"))return a.ONa('SSO Resource "'+J+'" must be https:// or api:// protocol.'),v.ULS.sendTraceTag(590962909,
344,10,"Resource not using https or api protocol."),"";for(S=0;S<J.length;S++){T=J.charAt(S);var G=D.a.charCodeAt(J,S);if(33>G||126<G||"&"===T||"?"===T||"#"===T||"%"===T||"\\"===T)return a.ONa('SSO Resource "'+J+'" contains an invalid character "'+T+'".'),v.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+T+"' in resource URI."),""}if(0<=J.indexOf("::"))return a.ONa('SSO Resource "'+J+'" contains an invalid string "::".'),v.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<
J.length)return a.ONa('SSO Resource "'+J+'" is '+J.length+" characters and exceeds the max length of 120 characters."),v.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+J.length+"."),"";N.startsWith("api://")&&(N="https://"+N.substring(6,N.length));return 8===N.length?"":OfficeExt.WACUtils.getHostSecure(N)||""};a.Q5=function(J,S,N,T){var G=J.startTime,I=0;0<G&&(I=a.dw()-G);var K={};G=(K.callInstanceId=G.toString(),K.callDuration=I.toString(),K.errorCode=S.toString(),K);if(T)for(var L in T)G[L]=
T[L];v.ULS.sendTraceTag(51401116,344,50,"{0}",G);H.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:z.a.Gk(G)}));J.callback(S,N)};a.dw=function(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(J){}return Date.now()};a.RTe="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");a.Ma=null;Object(t.a)(a,
"AppsForOfficeSingleSignOnManager",null,[216])},1082:function(t,E,b){function a(){var d={};this.hRe=(d.tabhome="Ribbon.Home",d.tabinsert="Ribbon.Insert",d.tabdata="Ribbon.Data",d.tabreview="Ribbon.Review",d.tabview="Ribbon.View",d);d={};this.gRe=(d.tabpagelayoutexcel=["Ribbon.PageLayoutExcel",c.a.instance.ga(1625),c.a.instance.ga(1629)],d.tabformulas=["Ribbon.Formulas",c.a.instance.ga(1626),c.a.instance.ga(1630)],d.tabdeveloper=["Ribbon.Developer",c.a.instance.ga(1627),c.a.instance.ga(1631)],d.tabaddins=
["Ribbon.AddIns",c.a.instance.ga(1628),c.a.instance.ga(1632)],d);this.k9b=null}b.d(E,"a",function(){return a});t=b(0);var c=b(14);a.prototype.bTh=function(){if(!this.k9b){this.k9b={};for(var d=ik(Object.keys(this.hRe)),e=d.next();!e.done;e=d.next())e=e.value,this.k9b[e]=this.hRe[e];d=ik(Object.keys(this.gRe));for(e=d.next();!e.done;e=d.next())e=e.value,this.k9b[e]=this.gRe[e][0]}};of.Object.defineProperties(a.prototype,{$ha:{configurable:!0,enumerable:!0,get:function(){return"SourceControlId"}},TM:{configurable:!0,
enumerable:!0,get:function(){return"Workbook"}},formFactor:{configurable:!0,enumerable:!0,get:function(){return"DesktopFormFactor"}}});Object(t.a)(a,"AddinCommandsStringProvider",null,[795])},1084:function(t,E,b){function a(){this.FLa=0;this.Bha=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.mec=!1;this.x9e=this.ria=null}b.d(E,"a",function(){return a});t=b(0);Object(t.a)(a,"AddInCommandsNotificationParameters",null,[])},1154:function(t,E,b){function a(){}function c(){}
function d(G,I,K,L,O,B){G=e.call(this,G,I,K,L,O,void 0===B?null:B)||this;G.eVb=null;return G}function e(G,I,K,L,O,B){G=h.call(this,G,K,O.jX,void 0===B?null:B)||this;G.sbe=0;G.o1=G.gTh(L);G.WXa=I;G.Ue=O;G.vLj=7;G.hl=G.WXa.ownerDocument.createElement("div");G.hl.className="ModalCalloutControlOverlay";G.hl.tabIndex=0;G.WXa.insertBefore(G.hl,G.WXa.firstChild);return G}function h(G,I,K,L){var O=x.call(this,document.createElement("div"))||this;O.Rqa=null;O.spa=null;O.nG=null;O.iG=null;O.Tw=null;O.JS=null;
O.NS=null;O.gqa=!1;O.ajb=!1;O.xp=null;O.content=null;O.o1=0;O.wte=null;O.XT=0;O.nDf=null;O.Xhe=G;O.jde=I;O.fP=K;O.rJ=L;O.ng=I.ownerDocument;O.ujb=!1;O.Su=!1;O.kjd=!1;return O}t=b(0);var k=b(15),n=b(84),f=b(158),v=b(13),m=b(89),x=Sys.UI.Control;$k(h,x);h.prototype.show=function(){this.ujb||(this.r7g(),this.Vn(),this.jde.appendChild(this.bW),this.bW.style.display="Block",this.Auj(),this.ujb=!0,this.nDf&&this.nDf())};h.prototype.dismiss=function(){this.ujb&&(this.y1a(),this.jde.removeChild(this.bW),
this.ujb=!1,this.rJ&&this.rJ())};h.prototype.dispose=function(){this.dismiss();this.JS=this.Tw=this.iG=this.spa=this.nG=this.Rqa=null;Sys.Component.prototype.dispose.call(this)};h.prototype.di=function(G){return this.get_element().id+G};h.prototype.r7g=function(){this.nG=this.ng.createElement("div");this.nG.id=this.di("WACCalloutHeader");this.nG.className="WACCalloutHeader";this.Su&&this.lle();this.kjd&&this.Cme();this.iG=this.ng.createElement("div");this.iG.id=this.di("WACCalloutContent");this.iG.className=
"WACCalloutContent";this.iG.style.width=190<this.o1?this.o1-26+"px":"164px";this.iG.appendChild(this.content);this.bW.appendChild(this.W0b);this.bW.appendChild(this.nG);this.bW.appendChild(this.iG)};h.prototype.lle=function(){this.Tw=this.ng.createElement("a");this.Tw.className="WACCalloutCloseAnchor";this.Tw.id=this.di("WACCalloutCloseAnchor");this.Tw.href="#";this.nG.appendChild(this.Tw);var G=f.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);
this.Tw.appendChild(G)};h.prototype.Cme=function(){this.JS=this.ng.createElement("div");this.JS.className="WACCalloutTitle UIFontBold";this.JS.style.width=190<this.o1?this.o1-30+"px":"160px";this.JS.id=this.di("WACCalloutTitle");this.JS.innerText=this.title;this.nG.contains(this.Tw)?this.nG.insertBefore(this.JS,this.Tw):this.nG.appendChild(this.JS)};h.prototype.Auj=function(){var G=this.Xhe;if(1===this.XT){var I=this.wte.y+16;var K=-16}else 2===this.XT||3===this.XT||0===this.XT?(I=G.y+G.height+15,
K=-15):(I=G.y-this.bW.clientHeight-15-2,K=this.bW.clientHeight-1);this.bW.style.top=I+"px";this.W0b.style.top=K+"px";1===this.XT?(G=this.wte.x-16,this.bW.style.left="50%",this.bW.style.marginLeft=-this.o1/2+"px",I=Sys.UI.DomElement.getBounds(this.bW),this.W0b.style.left=G-I.x+"px"):(I=G.x+this.Xhe.width/2,2===this.XT||5===this.XT?(G=20,I-=36):0===this.XT||4===this.XT?(G=this.o1/2-16,I-=this.o1/2):(G=this.o1-20-32,I=I-this.o1+36),this.bW.style.left=I+"px",this.W0b.style.left=G+"px")};h.prototype.Vn=
function(){this.Su&&!this.NS&&(this.NS=Object(n.a)(this,this.I$,"closeHandler"),this.fP.ra(v.a.click,this.Tw,this.NS,null))};h.prototype.y1a=function(){this.Su&&this.NS&&(this.fP.Ba(v.a.click,this.Tw,this.NS),this.NS=null)};h.prototype.I$=function(){this.dismiss();return!0};of.Object.defineProperties(h.prototype,{bW:{configurable:!0,enumerable:!0,get:function(){this.Rqa||(this.Rqa=this.ng.createElement("div"),this.Rqa.id=this.di("WACCalloutOuter"),this.Rqa.className="WACCalloutOuter",this.Rqa.setAttribute(m.a.Gd,
m.a.yZa),this.Rqa.style.width=this.o1+"px");return this.Rqa}},W0b:{configurable:!0,enumerable:!0,get:function(){if(!this.spa){this.spa=this.ng.createElement("div");this.spa.id=this.di("WACCalloutBeakContainer");this.spa.className="WACCalloutBeakContainer";var G="CalloutBeakTopFilled_32x16x32";if(5===this.XT||6===this.XT||4===this.XT)G="CalloutBeakBottomFilled_32x16x32";G=f.createClusteredImage(32,16,G,"WACCalloutBeak",!0,"");this.spa.appendChild(G)}return this.spa},set:function(G){this.spa=G}},iMa:{configurable:!0,
enumerable:!0,get:function(){return this.ujb}},title:{configurable:!0,enumerable:!0,get:function(){return this.xp},set:function(G){this.xp!==G&&(this.xp=G,this.JS&&(this.JS.innerText=this.xp))}},Su:{configurable:!0,enumerable:!0,get:function(){return this.gqa},set:function(G){this.gqa!==G&&(this.gqa=G,this.nG&&(this.nG.contains(this.Tw)&&!this.gqa?this.nG.removeChild(this.Tw):!this.nG.contains(this.Tw)&&this.gqa&&this.lle()))}},kjd:{configurable:!0,enumerable:!0,get:function(){return this.ajb},set:function(G){this.ajb!==
G&&(this.ajb=G,this.nG&&(this.nG.contains(this.JS)&&!this.ajb?this.nG.removeChild(this.JS):!this.nG.contains(this.JS)&&this.ajb&&this.Cme()))}}});Object(t.a)(h,"Callout",Sys.UI.Control,[179]);$k(e,h);e.prototype.show=function(){this.iMa||(this.Ue.yqc(),this.Ue.xP(!1),this.hl.style.zIndex=String(this.Ue.r2),h.prototype.show.call(this),this.Pi(),this.sbe=window.setTimeout(Object(n.a)(this,this.dismiss,"dismiss"),1E3*this.vLj))};e.prototype.dismiss=function(){this.iMa&&(this.Ue.wM(!1),this.Tj(),this.WXa&&
this.WXa.contains(this.hl)&&this.WXa.removeChild(this.hl),h.prototype.dismiss.call(this),window.clearTimeout(this.sbe))};e.prototype.Pi=function(){this.Ue.Qra(Object(n.a)(this,this.dismiss,"dismiss"));this.Ue.wy.ra(v.a.click,this.hl,Object(n.a)(this,this.Zc,"onClick"))};e.prototype.Tj=function(){this.Ue.Bbb(Object(n.a)(this,this.dismiss,"dismiss"));this.Ue.wy.Ba(v.a.click,this.hl,Object(n.a)(this,this.Zc,"onClick"))};e.prototype.Zc=function(){this.dismiss();return!0};e.prototype.gTh=function(G){var I=
0;switch(G){case 0:I=190;break;case 1:I=250;break;case 2:I=300;break;case 3:I=360}return I};Object(t.a)(e,"ModalCallout",h,[]);var l=b(637),u=b(209);$k(d,e);d.prototype.show=function(){var G=this;if(!this.iMa){var I=Object.assign(new l.a,{onShow:function(){e.prototype.show.call(G)}});u.UISurfaces.zQ().then(function(K){var L=K.externalNotification();G.eVb=K.addNotification(L,I);return null},function(K){k.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",K);return null})}};
d.prototype.dismiss=function(){var G=this;this.iMa&&this.eVb&&(u.UISurfaces.zQ().then(function(I){I.removeNotification(G.eVb);return G.eVb=null},function(I){k.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",I);return null}),e.prototype.dismiss.call(this))};Object(t.a)(d,"ReactManagedModalCallout",e,[]);var A=b(4);c.c9g=function(G,I,K){var L=void 0===L?null:L;return A.AFrameworkApplication.ta.Qa.VQ?new d(G,I,K,3,A.AFrameworkApplication.ta,L):new e(G,I,K,3,A.AFrameworkApplication.ta,
L)};Object(t.a)(c,"ModalCalloutControlFactory",null,[]);var z=b(52),y=b(1080),w=b(652),D=b(1081),H=b(135),F=b(56),J=b(39),S=b(83),N=b(1030),T=b(916);b.d(E,"a",function(){return a});a.ZCe=function(G,I,K,L){a.RI&&a.RI.iMa&&a.RI.dismiss();a.RI=c.c9g(I,G,G);a.RI.content=K;T.b(L)||(a.RI.title=L,a.RI.kjd=!0);G=new Sys.UI.Bounds(0,0,F.a.Ncc(),F.a.Mcc());a.RI.XT=a.$Kh(G,I,a.RI.o1);a.RI.show();a.r0b&&a.r0b.sendNotification(K.innerText,!0)};a.k3c=function(G,I,K,L){L=void 0===L?null:L;u.UISurfaces.zQ().then(function(O){var B=
null;a.klb&&(O.removeNotification(a.klb),a.klb=null);var Q=O.callout(Object.assign(new y.a,{target:G,title:I,content:K,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new D.a,{onDismiss:function(){O.removeNotification(B)},directionalHint:null!=L?L:null})})),U=Object.assign(new l.a,{expirationOptions:Object.assign(new w.a,{displayTimeoutSeconds:7,onExpire:function(){O.removeNotification(a.klb)}})});B=a.klb=O.addNotification(Q,U);return null},function(O){k.ULS.sendTraceTag(593352342,
383,15,"Failed to GetNotificationsAPIAsync: {0}",O);return null})};a.NRd=function(G,I){I=void 0===I?null:I;a.RI&&a.RI.iMa&&a.RI.dismiss();var K=new H.StandardDialog;K.nSa=!1;K.Rb=0;K.Lz(z.a.bsi,CommonUIStrings.l_DialogError,T.b(G)?a.CYe():G,I)};a.PRd=function(G){a.RI&&a.RI.iMa&&a.RI.dismiss();k.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",G.errorCode));var I=T.b(G.description)?a.CYe():G.description,K=new H.StandardDialog,L=null;G.Bha?(K.Rb=1,K.kc(1,
G.buttonText),K.G0(1)):K.Rb=0;L=function(O){1===O?G.Bha():G.ria&&G.ria()};K.nSa=!1;0===G.FLa?K.Lz(G.errorCode,G.title?G.title:CommonUIStrings.l_DialogError,I,L):1===G.FLa?K.fX(G.title?G.title:CommonUIStrings.l_DialogWarning,I,L):K.PAa(G.title?G.title:CommonUIStrings.l_DialogInfo,I,L)};a.$Kh=function(G,I,K){var L=4,O=G.x+G.width-I.x-I.width;I.x-G.x+I.width/2<=K/2?L=5:O+I.width/2<=K/2&&(L=6);return L};a.BAj=function(G,I,K,L){L=void 0===L?!1:L;(I=N.a.w3a(I))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&
appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(I,function(O){O&&(L||a.k3c(O,K,G,5))})};a.CAj=function(G,I,K){K=void 0===K?!1:K;a.BAj(I.startedNode?I.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,G),I,I.startedNode?I.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,G),K)};a.AAj=function(G,I,K,L){if(a.kfg)G=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,
K,L,CommonUIStrings.l_InsertionDialogRefresh)),a.k3c(I,G,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{I=J.a.Qo(I);var O=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),B=document.createElement("span");B.innerText=O[0];var Q=document.createElement("span");Q.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,K,L,CommonUIStrings.l_InsertionDialogRefresh);Q.className="UIFontBold";K=document.createElement("span");K.innerText=O[1];L=document.createElement("div");
Sys.UI.DomElement.addCssClass(L,"ModalCalloutControl");L.appendChild(B);L.appendChild(Q);L.appendChild(K);a.ZCe(G,I,L,CommonUIStrings.l_ErrorLoadingAddInsTitle)}};a.TBj=function(G,I){var K=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,L=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;a.kfg?a.k3c(I,K,L):(I=J.a.Qo(I),a.ZCe(G,I,a.jTg(L),K))};a.jTg=function(G){var I=document.createElement("div");Sys.UI.DomElement.addCssClass(I,"ModalCalloutControl");I.innerText=G;return I};a.CYe=
function(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive};of.Object.defineProperties(a,{r0b:{configurable:!0,enumerable:!0,get:function(){return a.dfa||(a.dfa=S.a.instance.nh("Common.Utils.IAriaNotifier"))}},kfg:{configurable:!0,enumerable:!0,get:function(){return A.AFrameworkApplication.ta.Qa.wi&&A.AFrameworkApplication.ta.Qa.VQ}}});a.RI=null;a.klb=null;a.dfa=null;Object(t.a)(a,"AddInCommandsNotificationFactory",null,[])},1164:function(t,E,b){function a(u,A,
z,y,w){this.$w=u;this.GI=z;this.D1=y;this.Hd=w;this.Hhb=this.GI.Th;this.Cy=this.Hhb.getOsfControl(A);this.ztg=this.Cy.getManifest()}function c(u,A,z,y){this._id=u;this.$w=A;this.D1=z;this.Hd=y}function d(u,A,z,y){this.dA=!1;this._id=u;this.$w=A;this.D1=z;this.Hd=y}b.r(E);t=b(0);var e=b(15),h=b(1674),k=b(153),n=b(124),f=b(941),v=b(955),m=b(360);d.prototype.setEnabled=function(){};d.prototype._OnAccess=function(){};d.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.RibbonButton"};d.prototype.invokePropertyGet=
function(u){switch(u){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};d.prototype.invokePropertyGetAsync=function(u){u=this.invokePropertyGet(u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)};d.prototype.invokePropertySet=function(u,A){switch(u){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(A,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);
};d.prototype.invokePropertySetAsync=function(u,A){this.invokePropertySet(u,A);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};d.prototype.invokeMethod=function(u,A){switch(u){case 5:return this.lrj(A);case 1:return this.wCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};d.prototype.invokeMethodAsync=function(u,A){u=this.invokeMethod(u,A);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)};d.prototype.lrj=function(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,
0,"boolean");this.setEnabled(u);return null};d.prototype.wCa=function(){this._OnAccess();return null};of.Object.defineProperties(d.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return this.dA},set:function(u){var A=b(1164).DynamicRibbon,z=this.Hd.OwnerAddinStoreType,y=this.Hd.PrimaryMarketplace.MarketplaceRef,w=this.Hd.AssetMarketplace?this.Hd.AssetMarketplace.SolutionId:null,D=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.$w,z,null,null,null,y),H={};z=(H.addinSolutionId=D,
H.ownerAddinSolutionId=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Hd.OwnerAddinSolutionId,z,w,null,null,y),H.ownerAddinStoreType=z,H.ribbonControlType="Button",H.toggle=u,H);k.a.sendTelemetryEvent(Object.assign(new m.a,{name:A.Wzc+"ControlUpdate",dataFields:n.a.Gk(z)}));this.dA=u;u={};D=(u.DynamicAddinCommandsMethodDispatchId=1,u.SolutionId=this.$w,u.PrivacyCompliantSolutionId=D,u.SourceControlId=this.id,u.MethodData=this.dA,u);this.D1.VJ(-1014260128,D)}},id:{configurable:!0,enumerable:!0,
get:function(){return this._id}},label:{configurable:!0,enumerable:!0,get:function(){return null}}});Object(t.a)(d,"RibbonButton",null,[]);c.prototype.setVisibility=function(u){var A=b(1164).DynamicRibbon,z=this.Hd.OwnerAddinStoreType,y=this.Hd.PrimaryMarketplace.MarketplaceRef,w=this.Hd.AssetMarketplace?this.Hd.AssetMarketplace.SolutionId:null,D=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.$w,z,w,null,null,y),H={};y=(H.addinSolutionId=D,H.ownerAddinSolutionId=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Hd.OwnerAddinSolutionId,
z,w,null,null,y),H.ownerAddinStoreType=z,H.ribbonControlType="Tab",H.toggle=u,H);k.a.sendTelemetryEvent(Object.assign(new m.a,{name:A.Wzc+"ControlUpdate",dataFields:n.a.Gk(y)}));A={};u=(A.DynamicAddinCommandsMethodDispatchId=2,A.SolutionId=this.$w,A.PrivacyCompliantSolutionId=D,A.StoreType=z,A.SourceControlId=this.id,A.MethodData=u,A);this.D1.VJ(-1014260128,u)};c.prototype._OnAccess=function(){};c.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.RibbonTab"};c.prototype.invokePropertyGet=
function(u){switch(u){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};c.prototype.invokePropertyGetAsync=function(u){u=this.invokePropertyGet(u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)};c.prototype.invokePropertySet=function(u){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};c.prototype.invokePropertySetAsync=function(u,A){this.invokePropertySet(u,A);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
c.prototype.invokeMethod=function(u,A){switch(u){case 3:return this.evj(A);case 1:return this.wCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};c.prototype.invokeMethodAsync=function(u,A){u=this.invokeMethod(u,A);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)};c.prototype.evj=function(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"boolean");this.setVisibility(u);return null};c.prototype.wCa=function(){this._OnAccess();return null};
of.Object.defineProperties(c.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}}});Object(t.a)(c,"RibbonTab",null,[]);var x=b(1185),l=b(180);b.d(E,"DynamicRibbon",function(){return a});a.prototype.executeRequestCreate=function(u){try{var A=this.Hd.OwnerAddinStoreType,z=this.Hd.PrimaryMarketplace.MarketplaceRef,y=this.Hd.AssetMarketplace?this.Hd.AssetMarketplace.SolutionId:null,w=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.$w,A,y,null,null,z),D={},H=(D.addinSolutionId=
w,D.ownerAddinSolutionId=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Hd.OwnerAddinSolutionId,A,y,null,null,z),D.ownerAddinStoreType=this.Hd.OwnerAddinStoreType,D.ribbonControlType="Ribbon",D);k.a.sendTelemetryEvent(Object.assign(new m.a,{name:a.Wzc+"ExecuteRequestCreate",dataFields:n.a.Gk(H)}));var F=l.a.Wh(u);u={};A={};A[f.a.LIa]=this.Cy;A[f.a.MIa]=F;A[f.a.r7c]=this.Hd;u[f.a.dtb]=3;u[f.a.S3]=this.$w;u[f.a.R7b]=w;u[f.a.R3]=A;this.D1.VJ(-1014260128,u);var J=a.iac("ExecuteRequestCreate",!0,"");
e.ULS.sendTraceTag(538572826,0,50,J)}catch(S){w=a.iac("ExecuteRequestCreate",!1,S.toString()),e.ULS.sendTraceTag(538572825,0,50,w)}return null};a.prototype.executeRequestUpdate=function(u){try{var A=this.Hd.OwnerAddinStoreType,z=this.Hd.PrimaryMarketplace.MarketplaceRef,y=this.Hd.AssetMarketplace?this.Hd.AssetMarketplace.SolutionId:null,w=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.$w,A,y,null,null,z),D={},H=(D.addinSolutionId=w,D.ownerAddinSolutionId=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Hd.OwnerAddinSolutionId,
A,y,null,null,z),D.ownerAddinStoreType=this.Hd.OwnerAddinStoreType,D.ribbonControlType="Ribbon",D);k.a.sendTelemetryEvent(Object.assign(new m.a,{name:a.Wzc+"ExecuteRequestUpdate",dataFields:n.a.Gk(H)}));var F=l.a.Wh(u);u={};A={};A[f.a.LIa]=this.Cy;A[f.a.MIa]=F;A[f.a.r7c]=this.Hd;u[f.a.dtb]=3;u[f.a.S3]=this.$w;u[f.a.R7b]=w;u[f.a.R3]=A;this.D1.VJ(-1014260128,u);var J=a.iac("ExecuteRequestUpdate",!0,"");e.ULS.sendTraceTag(538572824,0,50,J)}catch(S){w=a.iac("ExecuteRequestUpdate",!1,S.toString()),e.ULS.sendTraceTag(538572823,
0,50,w)}return null};a.prototype.getButton=function(u){var A=null;if(!this.Tcf())return this.aDe();if(u&&0<u.length){if(!this.iye(u))return this.tDe(u);A=new d(u,this.$w,this.D1,this.Hd)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(A)};a.prototype.getTab=function(u){var A=null;if(!this.Tcf())return this.aDe();if(this.Cy.getOwnerAddinControlRecreated())return this.q8g();if(u&&0<u.length){if(!this.iye(u))return this.tDe(u);A=new c(u,this.$w,this.D1,this.Hd)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(A)};
a.prototype._OnAccess=function(){};a.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.DynamicRibbon"};a.prototype.invokePropertyGet=function(u){switch(u){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};a.prototype.invokePropertyGetAsync=function(u){u=this.invokePropertyGet(u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)};a.prototype.invokePropertySet=function(u){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);
};a.prototype.invokePropertySetAsync=function(u,A){this.invokePropertySet(u,A);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};a.prototype.invokeMethod=function(u){switch(u){case 1:return this.wCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};a.prototype.invokeMethodAsync=function(u,A){switch(u){case 7:return this.uyh(A);case 6:return this.vyh(A);case 3:return this.FKh(A);case 5:return this.PZh(A)}u=this.invokeMethod(u,A);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)};
a.prototype.uyh=function(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"string");return this.executeRequestCreate(u)};a.prototype.vyh=function(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"string");return this.executeRequestUpdate(u)};a.prototype.FKh=function(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"string");return this.getButton(u)};a.prototype.PZh=function(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"string");
return this.getTab(u)};a.prototype.wCa=function(){this._OnAccess();return null};a.prototype.tDe=function(u){return x.a(v.a.R3g,l.a.ga(1758)+u)};a.prototype.aDe=function(){return x.a(v.a.hjj,l.a.ga(1754))};a.prototype.q8g=function(){return x.a(v.a.hostRestartNeeded,l.a.ga(1759))};a.prototype.Tcf=function(){var u=this.Cy.getSharedRuntimeId();u=!!u&&0<u.length;e.ULS.sendTraceTag(538572822,0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",u));return u};a.prototype.iye=function(u){var A=
this.ztg.getRibbonExtensionControlMap();return u in A||this.bYg(u)};a.prototype.bYg=function(u){var A=this.bCh();if(A){A=ik(A.$Je.tabs);for(var z=A.next();!z.done;z=A.next()){z=z.value;if(z.id===u)return!0;z=ik(z.groups);for(var y=z.next();!y.done;y=z.next()){y=ik(y.value.controls);for(var w=y.next();!w.done;w=y.next()){w=w.value;if(w.id===u)return!0;if("Menu"===w.type){w=ik(w.items);for(var D=w.next();!D.done;D=w.next())if(D.value.id===u)return!0}}}}}return!1};a.prototype.bCh=function(){return h.a.getInstance().Uia(this.Hd.PrimaryMarketplace.MarketplaceType,
this.Hd.PrimaryMarketplace.SolutionId,1)};a.iac=function(u,A,z){var y={};y.methodName="DynamicRibbon."+u;y.result=A?"Succeeded":"Failed";y.message=z;return l.a.xc(y)};of.Object.defineProperties(a.prototype,{buttons:{configurable:!0,enumerable:!0,get:function(){return null}}});a.Wzc="Office.Online.Extensibility.Ribbon.";Object(t.a)(a,"DynamicRibbon",null,[])},1177:function(t,E,b){function a(){this.focusOnIframeWhenLoaded=!1;this.width=0;this.Heb=this.G4=this.Kk=null;this.isFirstPartyOptOutAppContextOptmization=
!1}b.d(E,"a",function(){return a});t=b(0);a.key="InsertAgaveClientSideParametersKey";Object(t.a)(a,"InsertAgaveClientSideParameters",null,[])},1178:function(t,E,b){function a(){}b.d(E,"a",function(){return a});t=b(0);a.w9b="extId";a.dBe="ComponentType";a.vHa="ComponentId";a.gkd="HostProps";a.Xya="OptionalProps";Object(t.a)(a,"ActionPropertyNames",null,[])},1180:function(t,E,b){function a(c,d){var e=!1;c&&(c=d.osfControl,(d=c.getManifest())&&d.getSharedRuntimeForCustomFunctions("Workbook")&&!c.getIsUpgrading()&&
(e=!0));return e}b.d(E,"a",function(){return a})},1181:function(t,E,b){function a(){this.token=null;this.errorCode=0;this.expiresOn=this.lha=this.lTa=this.Med=this.Zgd=this.Hwb=this.uVd=null}b.d(E,"a",function(){return a});t=b(0);Object(t.a)(a,"AppsForOfficeOauthResult",null,[])},1185:function(t,E,b){function a(c,d){return OfficeExtension.WacRuntime.Utility.createPromise(function(e,h){h(OfficeExtension.WacRuntime.Utility.createRichApiException(c,d))})}b.d(E,"a",function(){return a})},1356:function(t,
E,b){function a(){Ub.a.Fa(function(hb){O.ka(hb);c.ka(hb)})}function c(hb){var Xb=Oa.call(this)||this;Xb.$=hb;Xb.Eb();return Xb}function d(hb,Xb){var Gc=e.call(this)||this;Gc.$=hb;Gc.N1a=new DOMParser;Gc.cache=new yb.a;Gc.indexedDB=Xb;Xb.Df()&&Gc.indexedDB.initialize("Scripts","OfficeScriptingCache");Gc.pxb=!1;Gc.Qp=new A([],function(uc){e.QEj(uc)});Gc.Fj=new A([],function(uc){e.Byc(uc)});Gc.vB=new A([],function(uc){e.Byc(uc)});Gc.ft=new A([],function(){});Gc.BNb=new A([],function(uc){e.Byc(uc)});
return Gc}function e(){this.ft=null;this.pxb=this.NHb=this.vW=this.Uab=this.XGd=this.BMf=this.VGd=this.Vab=this.Mdc=!1;this.BNb=this.vB=this.Fj=this.Qp=null}function h(hb,Xb,Gc,uc){var Nc=this;this.l7a=!1;this.y9a=function(){Nc.E2f()?(Nc.dIf(),Wa.g(Nc.$).Ea.cJd(Nc.y9a)):Nc.l7a&&Wa.g(Nc.$).Ea.cJd(Nc.y9a)};this.IJi=function(Fb,ob){Object.getType(ob)===String&&ob.toString().endsWith(Z.a.qwb(Nc.$))&&(Nc.l7a=!1)};this.$=hb;this.nha=Xb;this.Du=Gc;this.businessBarManager=uc;this.bwj()}function k(hb,Xb,Gc,
uc,Nc,Fb,ob,zb,ib){var fc=this;this.sA=null;this.cache=new yb.a;this.Qwa=!1;this.kGa={};this.$=hb;this.$Pc=Gc;this.indexedDB=uc;this.apb=Nc;this.Du=Fb;this.nha=ob;this.Ie=zb;this.$B=ib;this.yOg=new z(this,hb);this.rrg=va.a.Ta.Jb;this.k7f="";uc.Df()&&(this.Qwa=!0,this.indexedDB.initialize("Scripts","OfficeScriptingCache"));hb=!0;if(vb.a.Bue){this.cache.Df()&&!Z.a.Cta&&(Xb=this.Ie.TKh(Z.a.zac(this.$)),Xb.isSuccess&&(hb=ya.getElapsedSeconds(Xb.timeStamp,va.a.Ta.Jb),this.Du.Wx=new m(!0,!0),this.sA=new m(Xb.value,
!0),hb=this.sA.value?604800<hb:86400<hb,this.rxb=this.hSa(!0)));this.TIh();if("undefined"!==typeof makerstorage&&this.sif)if(this.k7f=F(this.$),T(this.$))J(this.$,"localstorageToken"),this.Du.Wx=new m(!0,!0),this.sA=new m(!0,!0),this.rxb=this.hSa(!0);else if((Xb=Z.a.hfd())&&makerstorage.setStorageEnvironmentOverride(Xb),hb||Z.a.Cta)try{this.$.Ycb("automateTab",!0),this.rxb=Z.a.Cta?this.Du.g0c().then(function(){return fc.nha.Xvb()}).then(function(){return fc.hSa(!1)}).catch(function(){return fc.hSa(!1)}):
this.Du.g0c().then(function(){return fc.nha.Xvb()}).then(function(Ic){return fc.R5h(Ic)}).then(function(){return fc.hSa(!1)}).catch(function(){return fc.hSa(!1)})}catch(Ic){Q.ULS.sendTraceTag(537170314,0,15,"AutomateCommandManager: Something went wrong while trying to check the tab state.  Exception: "+Ic.message),this.rxb=Promise.resolve(!1),this.$.Ycb("automateTab",!1)}V.EwaSettings.isChangeGateEnabled("OfficeVSO:5925531_useHasShownAutomateTabPromise")&&this.rxb?this.rxb.then(function(Ic){fc.rKd(Ic);
fc.Ie.c_h()}):this.rKd(!1)}else Q.ULS.sendTraceTag(537170315,0,15,"IsOfficeScriptingEnabled: Turning off office scripting since fetch api is not supported by current browser."),this.rKd(!1)}function n(hb,Xb,Gc,uc,Nc,Fb){this.actionName=hb;this.shapeId=Xb;this.scriptLink=Gc;this.clickId=uc;this.Pba=Nc;this.buttonText=Fb}function f(hb,Xb,Gc,uc){this.gkd=hb;this.Ryh=Xb;this.Xya=Gc;this.vHa=uc}function v(){this.Wx=null;return this}function m(hb,Xb,Gc,uc,Nc){this.value=hb;this.isSuccess=Xb;this.timeStamp=
void 0===Gc?null:Gc;this.errorCode=void 0===uc?"":uc;this.errorMessage=void 0===Nc?"":Nc}function x(){this.Wx=null}function l(hb,Xb){this.mW=null;this.$=hb;this.Ie=Xb;return this}function u(hb){this.V$=Ra.b(hb)||{};this.shareId=this.shareId||null}function A(hb,Xb){this.scripts=hb;this.M5f=Xb}function z(hb,Xb){this.automateCommandManager=hb;this.$=Xb}function y(hb){return Aa.a.rd(hb)?oa.a.cOe:oa.a.bOe}function w(hb){return Aa.a.rd(hb)?hb.isChromeRtl?oa.a.esh:oa.a.dsh:oa.a.y2a}function D(hb){hb=hb.oa.va.Na(1);
hb.request={HttpMethod:"Get",PathAndQuery:"customXmlParts/byNamespace(namespaceUri=@v)/onlyItem/xml?@v='http://schemas.microsoft.com/office/extensibility/maker/v1.0'",RequestHeaders:null,RequestBody:"",RequestFlags:256};return hb}function H(hb,Xb,Gc,uc,Nc){function Fb(){function Yc(Mc,xb,wc){return Ha.g(zb.va,"ExecuteRichApiRequest",uc,La.b(Mc,Xb),La.a(xb,Gc),wc,null,0)}if(ob.BHa()||0<zb.va.a4||0<zb.Fk.a4)return!1;ib&&ob.to(ib);fc&&zb.fs(fc);Ic&&zb.Ez(Ic);V.EwaSettings.Zb()?ob.Rt(new Ea.a(507,0,Yc,
80)):ob.Rt(new ma.a(507,0,Yc,16));return!0}var ob=hb.userOperationManager,zb=hb.oa,ib=null,fc=null,Ic=null;Fb()||(ib=function(){Fb()},fc=function(){Fb()},Ic=function(){Fb()},ob.Br(ib),zb.Rq(fc),zb.Iy(Ic));return Nc.task}function F(hb){if(T(hb))return V.EwaSettings.getBooleanFeatureGate(Z.a.elc,!1)?"makerservicelocal":"localstorage";hb=Z.a.hfd();return Z.a.Q2e(hb)}function J(hb,Xb){T(hb)&&(V.EwaSettings.getBooleanFeatureGate(Z.a.elc,!1)||makerstorage.useLocalStorage(!0),makerstorage.setStorageEnvironmentOverride("local"));
makerstorage.setSessionId(hb.ya.UserSessionId);makerstorage.setUserAccessInfo(new G(Xb,null));makerstorage.setFlightValue(makerstorage.restApiVersionFlightKey,"1")}function S(){return V.EwaSettings.getBooleanFeatureGate(Z.a.Jwj,!1)}function N(hb,Xb){Xb.WacTaskPaneInfra=Aa.a.rd(hb);Xb.TaskpanelessRFB=V.EwaSettings.getBooleanFeatureGate(Z.a.a9f,!1);Xb.OfficeScriptsAutomateTask=Z.a.Ftf;Xb.DeferAdminCheck=Z.a.Cta;Xb.SharedScriptsButton=S()}function T(hb){return"TestHost"===hb.ya.DocumentHostInfo.HostTier}
function G(hb,Xb){this.currentUserMlapiToken=this.currentUserToken=null;this.currentUserToken=hb;this.currentUserMlapiToken=Xb}function I(){this.mW=null}function K(hb,Xb,Gc){var uc,Nc;this.$=hb;this.oAuthManager=Xb;this.Du=Gc;this.Wob=new L;this.Zse=null!==(Nc=null===(uc=this.oAuthManager)||void 0===uc?void 0:uc.Y5a())&&void 0!==Nc?Nc:!1}function L(){this.token=null;this.timeStamp=0}function O(hb){return ia.call(this,hb)||this}function B(hb,Xb){this.automateCommandManager=hb;this.$=Xb}t=b(0);var Q=
b(15),U=b(915),X=b(76),P=b(37);B.prototype.Nc=function(){return!1};B.prototype.executeCommand=function(hb,Xb,Gc){hb=P.TaskExtensions.kk();Xb=Xb.command;switch(Xb){case 1845457202:case -1342227603:case -45542983:case 1904816141:case 1606046412:case 1043696663:case 971811139:case -2126202430:case 1623358083:this.$.Cd(2045014907,-1,0,null),this.automateCommandManager.Ksi(Xb,1904816141===Xb?Gc[X.a.Mc].toString():null)}return hb};B.prototype.Ac=function(hb,Xb){hb=!1;switch(Xb.command){case 1845457202:case -45542983:case -1342227603:case 971811139:case -2126202430:case 1623358083:case 1904816141:case 1043696663:case 1606046412:hb=
this.$.Nba}return hb};B.prototype.Tc=function(hb,Xb,Gc){return"PopulateAutomateGalleryMenu"===Xb&&this.$.Nba?(this.automateCommandManager.Tc(Xb,Gc),!0):!1};Object(t.a)(B,"AutomateCommandHandler",null,[401]);var ea=b(500),ia=U.a;$k(O,ia);O.prototype.zd=function(){var hb=this;ea.a(this.$,374,375,this.hb,function(){var Xb=hb.$.da.za(352);Xb?hb.jd([new B(Xb,hb.$)]):Q.ULS.sendTraceTag(537170316,0,15,"AutomateCommandManager should already been initialized before AutomateCommandHandler.")})};O.ka=function(hb){hb.da.Ga(308,
new O(hb))};Object(t.a)(O,"AutomateCommandHandlerFactory",U.a,[]);U=b(235);var da=b(7),xa=b(4);Object(t.a)(L,"AuthContext",null,[]);var Z=b(944),ha=b(133),ya=b(111),va=b(28),bb=b(1034),ba=b(188),fa=b(80);K.prototype.getAuthContext=function(){return this.Wob};K.prototype.Xvb=function(){function hb(Fb,ob){return(new Promise(function(zb){window.setTimeout(function(){zb(Fb)},ob)})).then(function(zb){uc.push(Object(da.a)(new fa.a,{name:"Error"+Nc,string:zb.ErrorMessage}));uc.push(Object(da.a)(new fa.a,
{name:"ErrorCode"+Nc,string:zb.ErrorCode}));Nc++;return Xb.Uag()})}var Xb=this,Gc=va.a.Ta.Jb,uc=[];if(this.oAuthManager)uc.push(Object(da.a)(new fa.a,{name:"IsAuthSupported",bool:this.Zse}));else return this.E9b(uc,Gc,"need_OAuthManager","No OAuthManager");if(!this.Du.Wx||!this.Du.Wx.value)return this.E9b(uc,Gc,"need_license","No License");if(xa.AFrameworkApplication.fa.qa("IsAnonymousUser"))return this.E9b(uc,Gc,"need_user","Anonymous User");if(33E5>Date.now()-this.Wob.timeStamp)return uc.push(Object(da.a)(new fa.a,
{name:"UsedCachedToken",bool:!0})),ba.a(ha.a.Wyd,!0,0,uc),Promise.resolve(Object(da.a)(new bb.a,{IsSuccess:!0,Token:this.Wob.token}));uc.push(Object(da.a)(new fa.a,{name:"UsedCachedToken",bool:!1}));var Nc=1;return this.Uag().catch(function(Fb){return hb(Fb,200)}).catch(function(Fb){return hb(Fb,400)}).then(function(Fb){Fb.IsSuccess?(Xb.Wob.token=Fb.Token,Xb.Wob.timeStamp=Date.now()):(uc.push(Object(da.a)(new fa.a,{name:"Error"+Nc,string:Fb.ErrorMessage})),uc.push(Object(da.a)(new fa.a,{name:"ErrorCode"+
Nc,string:Fb.ErrorCode})));uc.push(Object(da.a)(new fa.a,{name:"Attempts",int64:Nc}));uc.push(Object(da.a)(new fa.a,{name:"Error",string:Fb.ErrorMessage}));uc.push(Object(da.a)(new fa.a,{name:"ErrorCode",string:Fb.ErrorCode}));ba.a(ha.a.Wyd,Fb.IsSuccess,ya.getElapsedMilliseconds(Gc,va.a.Ta.Jb),uc);return Promise.resolve(Fb)}).catch(function(Fb){uc.push(Object(da.a)(new fa.a,{name:"Error"+Nc,string:Fb.ErrorMessage}));uc.push(Object(da.a)(new fa.a,{name:"ErrorCode"+Nc,string:Fb.ErrorCode}));uc.push(Object(da.a)(new fa.a,
{name:"Attempts",int64:Nc}));return Xb.E9b(uc,Gc,Fb.ErrorCode,Fb.ErrorMessage)})};K.prototype.E9b=function(hb,Xb,Gc,uc){hb.push(Object(da.a)(new fa.a,{name:"Error",string:uc}));hb.push(Object(da.a)(new fa.a,{name:"ErrorCode",string:Gc}));ba.a(ha.a.Wyd,!1,ya.getElapsedMilliseconds(Xb,va.a.Ta.Jb),hb);return Promise.resolve(Object(da.a)(new bb.a,{IsSuccess:!1,ErrorMessage:uc,ErrorCode:Gc}))};K.prototype.Uag=function(){var hb=this,Xb=Z.a.A_h(),Gc=0;Xb=this.oAuthManager.EO("Maker",Xb).then(function(uc){if(uc)return!uc.IsSuccess&&
hb.Vyj(uc)?Promise.reject(uc):Promise.resolve(uc);uc=Object(da.a)(new bb.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"});return Promise.reject(uc)}).catch(function(uc){var Nc=new bb.a;Object.getType(uc)===Object.getType(Nc)?Nc=uc:(Nc.ErrorMessage=uc.toString(),Nc.ErrorCode="exception");return Promise.reject(Nc)});return Promise.race([Xb,new Promise(function(uc,Nc){Gc=window.setTimeout(function(){Nc(Object(da.a)(new bb.a,{IsSuccess:!1,ErrorCode:"Timeout",ErrorMessage:"Timed out waiting auth token promise"}))},
2E4)})]).then(function(uc){window.clearTimeout(Gc);return uc})};K.prototype.Vyj=function(hb){return"interaction_required"===hb.ErrorCode||"InitFailed"===hb.ErrorCode||"invalid_resource"===hb.ErrorCode||"login_required"===hb.ErrorCode&&hb.ErrorMessage.startsWith("AADSTS500341")?!1:!0};Object(t.a)(K,"AutomateCommandAuth",null,[498]);var ra=b(1035);Object(t.a)(I,"AutomateCommandGalleryBase",null,[]);var pa=b(398),Za=b(29),Ua=b(631),Ma=b(1603),oa=b(19),ja=b(53),ta=b(14);b(328);var aa=b(662);Object(t.a)(G,
"UserInfo",null,[]);var ma=b(572),Ea=b(177),Ha=b(62),Aa=b(36),V=b(1),La=b(298);z.prototype.EHh=function(hb){var Xb=this.automateCommandManager.Va.kq().bE();if(!S()){var Gc=z.pU(hb,ta.a.instance.ga(2121));this.MUc(Gc,Z.a.mUi,this.automateCommandManager.Fj,Z.a.TFi,ta.a.instance.ga(2117),this.automateCommandManager.Va);Xb.MenuSectionList.push(Gc)}Gc=z.pU(hb,ta.a.instance.ga(2122));this.MUc(Gc,Z.a.hDi,Z.a.b6?this.automateCommandManager.ft.BTe(this.automateCommandManager.Fj):this.automateCommandManager.Qp.BTe(this.automateCommandManager.Fj),
Z.a.btf,ta.a.instance.ga(2118),this.automateCommandManager.Va);Xb.MenuSectionList.push(Gc);Gc=z.pU(hb,ta.a.instance.ga(2123));this.MUc(Gc,Z.a.Okj,this.automateCommandManager.vB,Z.a.btf,"",this.automateCommandManager.Va);Xb.MenuSectionList.push(Gc);Gc=Object(da.a)(new pa.a,{Id:Z.a.rpe,ExternalId:Z.a.rpe,Command:"1606046412",LabelText:ta.a.instance.ga(2114),Alt:ta.a.instance.ga(2115),Image16by16:ja.a.df(16),Image16by16Class:oa.a.AOe,Visible:!0});hb=z.pU(hb,null);hb.ControlsId="myScriptsSection.Controls";
if(S()){var uc=Object(da.a)(new pa.a,{Id:Z.a.x1f,ExternalId:Z.a.x1f,Command:"1043696663",LabelText:ta.a.instance.ga(2124),Alt:ta.a.instance.ga(2124),ExternalImageId:"PeopleSharedIcon_16",Visible:!0});hb.ControlList.push(uc)}hb.ControlList.push(Gc);Xb.MenuSectionList.push(hb);return Xb};z.prototype.MUc=function(hb,Xb,Gc,uc,Nc,Fb){if(Gc&&0<Gc.length){Xb=Fb.nC(Xb,1,"Size150by20").s1b();Nc={};Fb={};Fb.root=z.Q0a(320,30);Fb.flexContainer={display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"left",
alignItems:"left",lineHeight:"normal"};Fb.label={margin:"0px 3px"};Nc.galleryButtonInExpanded=Fb;Xb.GalleryStyle=Nc;for(Nc=0;Nc<Gc.length&&Nc<uc;Nc++)Fb=Gc.q4(Nc),Xb.GalleryItems.push(z.G3c(Fb.id,Fb));hb.ControlList.push(Xb)}else Gc=Object(da.a)(new aa.a,{Id:Xb,ExternalId:Xb,LabelText:Nc}),hb.ControlsId=Gc.Id+".Controls",hb.ControlList.push(Gc)};z.AGh=function(hb){if(hb){var Xb=String.format(Z.a.Qci,hb.isShared?Z.a.INj:Z.a.gmj,ja.a.df(16));hb=String.format(Z.a.Rci,Za.a.yg(hb.name));return String.format(Z.a.Pci,
Xb,hb)}return""};z.pU=function(hb,Xb){return Object(da.a)(new Ua.a,{Id:hb,Title:Xb,MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0,ControlList:[]})};z.G3c=function(hb,Xb){var Gc=Z.a.GNj,uc=Z.a.emj,Nc=Z.a.HNj,Fb=Z.a.fmj;return Xb?z.SDe(Xb.shareId||Xb.id,Xb.name,Xb.isShared&&!S()?Gc:uc,hb,hb,Xb.isShared&&!S()?Nc:Fb):z.SDe("","","",hb,hb)};z.SDe=function(hb,Xb,Gc,uc,Nc,Fb){uc=void 0===uc?null:uc;Nc=void 0===Nc?null:Nc;Fb=void 0===Fb?null:Fb;var ob=void 0===
ob?null:ob;var zb={},ib={};zb.root=z.Q0a(20,20);ib.root=z.Q0a(20,20);return Object(da.a)(new Ma.a,{Id:hb,ExternalId:uc||hb,MenuItemId:Nc||hb,Command:"1904816141",Icon:Gc,Image:ja.a.df(16),ImageClass:Fb,LabelText:Xb,FullIconStyle:zb,PreviewIconStyle:ib,Alt:ob||Xb})};z.Q0a=function(hb,Xb){var Gc={};Gc.width=hb;Gc["min-width"]=hb;Gc.height=Xb;return Gc};Object(t.a)(z,"AutomateCommandRenderer",null,[]);A.prototype.BKa=function(hb){for(var Xb=0;Xb<this.scripts.length;Xb++)if(this.scripts[Xb].id===hb||
this.scripts[Xb].shareId===hb)return Xb;return-1};A.prototype.sort=function(){this.M5f(this.scripts)};A.prototype.Gs=function(hb){return-1===this.BKa(hb.id)?(this.scripts.push(hb),!0):!1};A.prototype.LUc=function(hb){return-1===this.BKa(hb.id)?(this.scripts=[hb].concat(this.scripts),!0):!1};A.prototype.MCi=function(hb){hb=this.BKa(hb.id);if(-1!==hb){for(var Xb=this.scripts[hb].b0a();0<hb;)this.scripts[hb]=this.scripts[hb-1],hb--;this.scripts[0]=Xb}};A.prototype.Afb=function(hb){var Xb=this.BKa(hb.id);
if(-1!==Xb){var Gc=this.scripts[Xb].shareId;this.scripts[Xb]=hb;this.scripts[Xb].shareId=Gc}};A.prototype.nff=function(hb){var Xb=this.BKa(hb.id);return-1!==Xb?hb.name===this.scripts[Xb].name:!1};A.prototype.u1a=function(hb){hb=this.BKa(hb);return-1!==hb?(this.scripts.splice(hb,1),!0):!1};A.prototype.clear=function(){this.scripts=[]};A.prototype.getScripts=function(){return this.scripts};A.prototype.gH=function(hb){hb=this.BKa(hb);return-1!==hb?this.scripts[hb]:null};A.prototype.q4=function(hb){return 0<=
hb&&this.length>hb?this.scripts[hb]:null};A.prototype.BTe=function(hb){for(var Xb=new A([],this.M5f),Gc=0;Gc<this.scripts.length;Gc++){var uc=this.scripts[Gc];hb.gH(uc.id)||Xb.Gs(uc)}return Xb};A.prototype.Ieb=function(){for(var hb=[],Xb=ik(this.scripts),Gc=Xb.next();!Gc.done;Gc=Xb.next())hb.push(Gc.value.bWd());return hb};of.Object.defineProperties(A.prototype,{length:{configurable:!0,enumerable:!0,get:function(){return this.scripts.length}}});Object(t.a)(A,"ScriptCollection",null,[]);var Ra=b(202);
u.prototype.b0a=function(){return new u(this.V$)};u.prototype.bWd=function(){return this.V$};of.Object.defineProperties(u.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this.V$.id}},shareId:{configurable:!0,enumerable:!0,get:function(){return this.V$.shareId},set:function(hb){this.V$.shareId=hb||null}},name:{configurable:!0,enumerable:!0,get:function(){return this.V$.name}},kGe:{configurable:!0,enumerable:!0,get:function(){return this.V$.dateLastPublished}},body:{configurable:!0,
enumerable:!0,get:function(){return this.V$.body}},description:{configurable:!0,enumerable:!0,get:function(){return this.V$.description}},ucf:{configurable:!0,enumerable:!0,get:function(){return this.V$.isCreator}},isShared:{configurable:!0,enumerable:!0,get:function(){return!!this.shareId&&0<this.shareId.length}}});Object(t.a)(u,"ScriptCore",null,[]);var pb=b(42);$k(l,I);l.prototype.pgd=function(hb){switch(hb){case "1":case "2":case "3":case "4":case "5":case "6":return this.mW.q4(parseInt(hb,10)-
1);default:return this.Ie.ft.gH(hb)||this.Ie.Qp.gH(hb)||this.Ie.Fj.gH(hb)||this.Ie.vB.gH(hb)}};l.prototype.Aed=function(hb,Xb){var Gc=null;if(this.Ie.h5a)switch(hb){case "1":case "2":case "3":case "4":case "5":case "6":Gc=this.mW.q4(parseInt(hb,10)-1);break;default:Gc=this.mW.gH(hb)}Aa.a.isReactRibbonEnabled()?Xb[ra.a.GalleryButtonProps]=z.G3c(hb,Gc):Xb[ra.a.InnerHTML]=z.AGh(Gc);Xb[ra.a.Alt]=Gc?Gc.name:""};l.prototype.UN=function(hb){this.mW=this.gHd();this.$.hf();var Xb=[];Xb.push(Object(da.a)(new fa.a,
{name:"Operation",string:hb}));Xb.push(Object(da.a)(new fa.a,{name:"HasReadRecentCachedScripts",bool:this.Ie.Mdc}));Xb.push(Object(da.a)(new fa.a,{name:"ReadScriptsDone",bool:this.Ie.gjd}));Xb.push(Object(da.a)(new fa.a,{name:"ReadSamplesScriptsDone",bool:this.Ie.NHb}));Xb.push(Object(da.a)(new fa.a,{name:"SamplesScriptCount",int64:this.Ie.vB.length}));Xb.push(Object(da.a)(new fa.a,{name:"ReadRecentScriptsDone",bool:this.Ie.Vab}));Xb.push(Object(da.a)(new fa.a,{name:"RecentScriptCount",int64:this.Ie.ft.length}));
Xb.push(Object(da.a)(new fa.a,{name:"ReadWorkbookScriptsDone",bool:this.Ie.vW}));Xb.push(Object(da.a)(new fa.a,{name:"WorkbookScriptCount",int64:this.Ie.Fj.length}));ba.a(ha.a.Etf,!0,0,Xb)};l.prototype.yid=function(hb){var Xb=!1,Gc="",uc=new u(hb.scriptMetadata),Nc={Operation:"HandleRefreshRibbonGallery"};Nc.RefreshOperation=hb.operationName;switch(hb.operationName){case Z.a.bOf:hb=this.xid(uc);Gc=hb.message;Xb=hb.returnValue;break;case Z.a.$Nf:hb=this.vid(uc);Gc=hb.message;Xb=hb.returnValue;break;
case Z.a.ZNf:hb=this.qid(uc);Gc=hb.message;Xb=hb.returnValue;break;case Z.a.aOf:hb=this.wid(uc);Gc=hb.message;Xb=hb.returnValue;break;case Z.a.I8i:hb=this.T4h(uc),Gc=hb.message,Xb=hb.returnValue}(Nc.GalleryUpdated=Xb)?(Q.ULS.sendTraceTag(537170322,0,50,"AutomateCommandGallery: Calling UpdateToolbarsAndRibbons. Message: "+Gc),this.UN("RefreshGallery")):Q.ULS.sendTraceTag(537170321,0,15,"AutomateCommandGallery: Something went wrong while trying to refresh ribbon gallery.  Message: "+Gc);Nc.Message=
Gc;Q.ULS.sendTraceTag(537170320,0,50,pb.c(Nc))};l.prototype.gHd=function(){for(var hb=new A([],function(){}),Xb=this.Ie.Fj?this.Ie.Fj.length:0,Gc=this.Ie.ft?this.Ie.ft.length:0,uc=this.Ie.vB?this.Ie.vB.length:0,Nc=0,Fb=Z.a.TIf,ob=0;ob<Fb;ob++)if(ob<Xb)hb.Gs(this.Ie.Fj.q4(ob));else if(ob-Xb+Nc<Gc){var zb=this.Ie.ft.q4(ob-Xb+Nc);this.Ie.Fj.gH(zb.id)?(Nc++,ob--):hb.Gs(zb)}else ob-Xb-Gc+Nc<uc&&hb.Gs(this.Ie.vB.q4(ob-Xb+Nc-Gc));return hb};l.prototype.xid=function(hb){if(this.Ie.ft.LUc(hb))var Xb="";else{Xb=
"";var Gc=hb.b0a();this.Ie.Fj.Afb(Gc);this.Ie.Fj.sort();this.Ie.ft.Afb(hb)}return{returnValue:!0,message:Xb}};l.prototype.vid=function(hb){this.Ie.Fj.u1a(hb.id);return this.Ie.ft.u1a(hb.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in recent script collection."}};l.prototype.qid=function(hb){var Xb=hb.b0a();Xb.shareId=null;this.Ie.ft.LUc(Xb);return this.Ie.Fj.Gs(hb)?(this.Ie.Fj.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}};
l.prototype.wid=function(hb){return this.Ie.Fj.u1a(hb.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}};l.prototype.T4h=function(hb){var Xb=hb.b0a(),Gc=!1;this.Ie.Fj.nff(Xb)&&(this.Ie.Fj.Afb(Xb),this.Ie.Fj.sort(),Gc=!0);this.Ie.ft.LUc(hb)?Gc=!0:this.Ie.ft.nff(hb)&&(this.Ie.ft.Afb(hb),this.Ie.ft.MCi(hb),Gc=!0);return{returnValue:Gc,message:""}};Object(t.a)(l,"AutomateCommandGallery",I,[]);var cb=b(83);Object(t.a)(x,"AutomateCommandLicensingBase",
null,[]);Object(t.a)(m,"BoolResultWrapper",null,[]);$k(v,x);v.prototype.g0c=function(){var hb=this,Xb=va.a.Ta.Jb,Gc=[];return new Promise(function(uc){cb.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Nc){Nc.isFeatureEnabled("ExcelOfficeScripting",!1).then(function(Fb){Gc.push(Object(da.a)(new fa.a,{name:"IsLicensed",bool:Fb}));ba.a(ha.a.Atf,!0,ya.getElapsedMilliseconds(Xb,va.a.Ta.Jb),Gc);hb.Wx=new m(Fb,!0);uc(Fb)}).catch(function(Fb){Gc.push(Object(da.a)(new fa.a,
{name:"IsLicensed",bool:!1}));Gc.push(Object(da.a)(new fa.a,{name:"Error",string:Fb.toString()}));Gc.push(Object(da.a)(new fa.a,{name:"ErrorCode",string:"exception"}));ba.a(ha.a.Atf,!1,ya.getElapsedMilliseconds(Xb,va.a.Ta.Jb),Gc);hb.Wx=new m(!1,!1,void 0,"exception",Fb.toString());uc(!1)})})})};Object(t.a)(v,"AutomateCommandLicensing",x,[]);var Sa=b(1517),Db=b(1515),Ab=b(1514),Wb=b(1516),ub=b(1604),vb=b(27),Ka=b(178),eb=b(644),yb=b(329),oc=b(5);Object(t.a)(f,"LaunchSDXParams",null,[]);Object(t.a)(n,
"RunfromButtonParameters",null,[]);var Jb=b(168),dc=b(54),$a=b(1008),Ba=b(51),la=b(46),ka=b(167);k.prototype.hSa=function(hb){var Xb=xa.AFrameworkApplication.fa.qa("IsO365CommercialHost"),Gc="",uc="",Nc=!1,Fb,ob=(Fb=this.Du.Wx&&this.Du.Wx.isSuccess)&&this.Du.Wx.value;Fb=Z.a.Cta?Fb:!(ob&&(!this.sA||!this.sA.isSuccess));this.Du.Wx&&!this.Du.Wx.isSuccess?(uc=this.Du.Wx.errorCode,Gc=this.Du.Wx.errorMessage):this.sA&&!this.sA.isSuccess&&(uc=this.sA.errorCode,Gc=this.sA.errorMessage);ob=[];ob.push(Object(da.a)(new fa.a,
{name:"IsScriptingEnabled",bool:this.Pba}));ob.push(Object(da.a)(new fa.a,{name:"IsValidHost",bool:Xb}));ob.push(Object(da.a)(new fa.a,{name:"IsUserLicensed",bool:this.Du.Wx?this.Du.Wx.value:!1}));Z.a.Cta||ob.push(Object(da.a)(new fa.a,{name:"IsAdminSwitchOn",bool:this.sA?this.sA.value:!1}));ob.push(Object(da.a)(new fa.a,{name:"ShowTab",bool:this.Pba}));Z.a.Cta||ob.push(Object(da.a)(new fa.a,{name:"ServiceChecked",bool:!hb}));this.Pba?Aa.a.dxa(this.$)&&(hb=Jb.a(this.$),(null===hb||void 0===hb?0:hb.Ql)?
(ob.push(Object(da.a)(new fa.a,{name:"RibbonType",string:"React"})),hb.Ql.ICj(oc.a.JHb),hb.Ql.tPd(["AutomateAutomateTask"],!Z.a.Ftf),V.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!V.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&(Nc=!0)):(uc="ribbon_manager_error",Gc="The RibbonManager or RibbonUser is null")):this.G7h();ob.push(Object(da.a)(new fa.a,{name:"Error",string:Gc}));ob.push(Object(da.a)(new fa.a,
{name:"ErrorCode",string:uc}));ba.a(ha.a.HGi,Fb,ya.getElapsedMilliseconds(this.initTime,va.a.Ta.Jb),ob);this.$.Ycb("automateTab",!1);return Promise.resolve(Nc)};k.prototype.Tc=function(hb,Xb){if(!Xb)return!1;Xb.MenuItems=this.yOg.EHh(Xb.MenuId);return!0};k.prototype.f_i=function(){var hb=this;this.Qwa&&(Z.a.b6?this.Ie.CMf(this.$B).continueWith(function(Xb){Xb.result&&hb.$B.UN(Z.a.ZPa)}):this.Ie.c7i(this.$B));T(this.$)?this.Z1e(Object(da.a)(new bb.a,{IsSuccess:!0,Token:"FakeToken"})):this.nha.Xvb().then(function(Xb){hb.Z1e(Xb)})};
k.prototype.Aed=function(hb,Xb,Gc){if(Z.a.b6)this.$B.Aed(hb,Xb,Gc);else{Gc=null;if(this.Ie.h5a)switch(hb){case "1":case "2":case "3":case "4":case "5":case "6":Gc=this.$B.mW.q4(parseInt(hb,10)-1);break;default:Gc=this.$B.mW.gH(hb)}Xb[ra.a.GalleryButtonProps]=z.G3c(hb,Gc);Xb[ra.a.Alt]=Gc?Gc.name:""}};k.prototype.yid=function(hb){if(Z.a.b6)this.$B.yid(hb);else{var Xb=!1,Gc="",uc=new u(hb.scriptMetadata),Nc={Operation:"HandleRefreshRibbonGallery"};Nc.RefreshOperation=hb.operationName;switch(hb.operationName){case Z.a.bOf:hb=
this.xid(uc);Gc=hb.message;Xb=hb.returnValue;break;case Z.a.$Nf:hb=this.vid(uc);Gc=hb.message;Xb=hb.returnValue;break;case Z.a.ZNf:hb=this.qid(uc);Gc=hb.message;Xb=hb.returnValue;break;case Z.a.aOf:hb=this.wid(uc),Gc=hb.message,Xb=hb.returnValue}(Nc.GalleryUpdated=Xb)?(Q.ULS.sendTraceTag(537170313,0,50,"AutomateCommandManager: Calling UpdateToolbarsAndRibbons. Message: "+Gc),this.UN("RefreshGallery")):Q.ULS.sendTraceTag(537170312,0,15,"AutomateCommandManager: Something went wrong while trying to refresh ribbon gallery.  Message: "+
Gc);Nc.Message=Gc;Q.ULS.sendTraceTag(537170311,0,50,pb.c(Nc))}};k.prototype.n5h=function(hb,Xb,Gc,uc){if(V.EwaSettings.isChangeGateEnabled("OfficeVSO:6254340_ExitCellEditModeOnRFBClick")||this.$.iq(null,!1,1023))hb=new n(Z.a.sVf,hb,Xb,Gc,this.Pba,uc),this.apb.Zwb(hb)};k.prototype.l6e=function(hb,Xb,Gc){hb=new n(Z.a.WXj,hb,Xb,Gc,this.Pba);this.apb.Zwb(hb)};k.prototype.V2h=function(hb){this.apb.Shd(Z.a.XCj,hb)};k.prototype.U2h=function(hb){this.apb.Shd(Z.a.W2g,hb)};k.prototype.W2h=function(hb){this.apb.Shd(Z.a.bHj,
hb)};k.prototype.Ksi=function(hb,Xb){var Gc=Ba.b().Xh(hb),uc=[];uc.push(Object(da.a)(new fa.a,{name:"SessionId",string:this.$.ya.UserSessionId}));uc.push(Object(da.a)(new fa.a,{name:"MenuItemId",string:Xb}));uc.push(Object(da.a)(new fa.a,{name:"WorkbookScriptCount",int64:this.Fj.length}));uc.push(Object(da.a)(new fa.a,{name:"PublishedScriptCount",int64:this.Qp.length}));uc.push(Object(da.a)(new fa.a,{name:"RecentScriptCount",int64:this.ft.length}));uc.push(Object(da.a)(new fa.a,{name:"Command",string:Gc}));
Xb=this.SXh(hb,Xb);if(Gc=this.nSh(hb,Gc,Xb))uc.push(Object(da.a)(new fa.a,{name:Z.a.G$,string:Gc.Xya.lq[Z.a.G$]})),Sa.a.instance.sNa(Gc.Ryh,"Taskpane",Gc.vHa,Gc.gkd,Gc.Xya),1904816141===hb&&(uc.push(Object(da.a)(new fa.a,{name:"ScriptId",string:Xb.id})),uc.push(Object(da.a)(new fa.a,{name:"ShareId",string:Xb.shareId})),uc.push(Object(da.a)(new fa.a,{name:"IsPreviewGallery",bool:!!this.$B.mW.gH(Xb.id)})),uc.push(Object(da.a)(new fa.a,{name:"IsOwner",bool:Xb.ucf||!!this.Qp.gH(Xb.id)})),this.$.hf());
ba.a(ha.a.EGi,void 0,void 0,uc)};k.prototype.nSh=function(hb,Xb,Gc){var uc=null,Nc=Z.a.lu,Fb=new Db.a(Z.a.K8e,Z.a.RUe,Z.a.locale),ob=new Ab.a(Z.a.solutionId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,Z.a.cNd),zb=new Wb.a;zb.lq.AdminPolicyForFeedback=pb.c(this.kGa);zb.lq.DocumentHostInfo=dc.a.xc(this.$.ya.DocumentHostInfo);zb.lq.CodeEditorUrl=Z.a.X3a(this.$);zb.lq.MakerTestService=V.EwaSettings.getBooleanFeatureGate(Z.a.elc,!1);zb.lq[Z.a.JUf]=Z.a.F3a(this.$);zb.lq.StorageModePreference=this.k7f||"";zb.lq.Source=
"Ribbon";zb.lq[Z.a.$8f]=dc.a.xc(Nc);zb.lq[Z.a.Rte]=this.$.ztf?"true":"false";zb.lq[Z.a.G$]=Ka.a.create().toString();var ib=w(this.$),fc=y(this.$);zb.optionalProperties.HeaderCssClass=ib;zb.optionalProperties.TitleCssClass=fc;zb.lq[Z.a.E7e]=ib;zb.lq[Z.a.i$f]=fc;ib={};ib.ribbonCommand=Xb;ib[Z.a.i7f]=this.nha.getAuthContext();ib[Z.a.Aab]=this.Ie.BMf?this.Qp.Ieb():null;ib[Z.a.SPb]=this.Ie.XGd?this.Fj.Ieb():null;Z.a.b6&&(ib[Z.a.ZPa]=this.Ie.VGd?this.ft.Ieb():null);zb.lq[Z.a.Saf]=dc.a.xc(ib);Xb={};N(this.$,
Xb);zb.lq[Z.a.eUe]=dc.a.xc(Xb);switch(hb){case -45542983:zb.lq.Script="";zb.lq.Destination="Editor";zb.lq.IsOwner=!0;zb.optionalProperties[ub.a.Rk]=ta.a.instance.ga(2110);zb.optionalProperties[ub.a.taskPaneWidth]=Nc;zb.optionalProperties[ub.a.sourceLocationOverrideResourceId]=Z.a.X3a(this.$);uc=Z.a.n3b;break;case -1342227603:zb.optionalProperties[ub.a.Rk]=ta.a.instance.ga(2112);zb.optionalProperties[ub.a.taskPaneWidth]=Nc;zb.optionalProperties[ub.a.sourceLocationOverrideResourceId]=Z.a.j1e(this.$);
break;case 971811139:case 1606046412:zb.lq.Script="";zb.lq.Destination="BackStage";zb.lq.IsOwner=!0;zb.optionalProperties[ub.a.Rk]=ta.a.instance.ga(2110);zb.optionalProperties[ub.a.taskPaneWidth]=Nc;zb.optionalProperties[ub.a.sourceLocationOverrideResourceId]=Z.a.X3a(this.$);uc=Z.a.n3b;break;case 1043696663:zb.lq.Script="";zb.lq.Destination="BackStage_Workbook";zb.optionalProperties[ub.a.Rk]=ta.a.instance.ga(2110);zb.optionalProperties[ub.a.taskPaneWidth]=Nc;zb.optionalProperties[ub.a.sourceLocationOverrideResourceId]=
Z.a.X3a(this.$);uc=Z.a.n3b;break;case 1845457202:zb.optionalProperties[ub.a.Rk]=ta.a.instance.ga(2111);zb.optionalProperties[ub.a.taskPaneWidth]=Nc;zb.optionalProperties[ub.a.sourceLocationOverrideResourceId]=Z.a.A1e(this.$);uc=Z.a.kmj;break;case -2126202430:case 1623358083:case 1904816141:if(Gc)zb.lq.Script=dc.a.xc(Gc.bWd()),zb.lq.Destination="Details",zb.lq.IsOwner=Gc.ucf||!!this.Qp.gH(Gc.id),zb.optionalProperties[ub.a.Rk]=ta.a.instance.ga(2110),zb.optionalProperties[ub.a.taskPaneWidth]=Nc,zb.optionalProperties[ub.a.sourceLocationOverrideResourceId]=
Z.a.X3a(this.$),uc=Z.a.n3b;else return null;break;default:return null}return new f(Fb,ob,zb,uc)};k.prototype.SXh=function(hb,Xb){switch(hb){case -2126202430:hb=this.Ie.BNb.gH(Z.a.m9f);break;case 1623358083:hb=this.Ie.BNb.gH(Z.a.n9f);break;default:hb=Xb?this.pgd(Xb):null}return hb};k.prototype.TIh=function(){var hb=this;cb.a.instance.Tb("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(function(Xb){hb.kGa.FeedbackEnabled=!0;hb.kGa.ScreenshotEnabled=!0;hb.kGa.EmailEnabled=!0;
Xb.NJ("Enabled").then(function(Gc){hb.kGa.FeedbackEnabled=Gc},function(){});Xb.NJ("IncludeScreenshot").then(function(Gc){hb.kGa.ScreenshotEnabled=Gc},function(){});Xb.NJ("IncludeEmail").then(function(Gc){hb.kGa.EmailEnabled=Gc},function(){})})};k.prototype.R5h=function(hb){var Xb=this,Gc=va.a.Ta.Jb,uc=[];if(!hb||!hb.IsSuccess){var Nc=hb?hb.ErrorCode:"need_token";hb=hb?hb.ErrorMessage:"No Access Token";uc.push(Object(da.a)(new fa.a,{name:"ServiceChecked",bool:!1}));uc.push(Object(da.a)(new fa.a,{name:"Error",
string:hb}));uc.push(Object(da.a)(new fa.a,{name:"ErrorCode",string:Nc}));ba.a(ha.a.Uyd,!1,ya.getElapsedMilliseconds(Gc,va.a.Ta.Jb),uc);this.sA=new m(!1,!1,void 0,Nc,hb);return Promise.resolve(!1)}uc.push(Object(da.a)(new fa.a,{name:"ServiceChecked",bool:!0}));J(this.$,hb.Token);return makerstorage.getUserPermissions(this.$.ya.UserSessionId).then(function(Fb){Xb.sA=new m(Fb.OfficeScriptingEnabled,!0);Xb.Ie.nUg(Z.a.zac(Xb.$),Fb.OfficeScriptingEnabled);uc.push(Object(da.a)(new fa.a,{name:"IsEnabled",
bool:Xb.sA.value}));ba.a(ha.a.Uyd,!0,ya.getElapsedMilliseconds(Gc,va.a.Ta.Jb),uc);return Promise.resolve(Xb.sA.value)}).catch(function(Fb){Object.getType(Fb)===makerstorage.StorageServiceError?(uc.push(Object(da.a)(new fa.a,{name:"Error",string:Fb.message})),uc.push(Object(da.a)(new fa.a,{name:"ErrorCode",string:"makerstorage_"+Fb.errorCode.toString()+"_"+Fb.status.toString()}))):(uc.push(Object(da.a)(new fa.a,{name:"Error",string:Fb.toString()})),uc.push(Object(da.a)(new fa.a,{name:"ErrorCode",string:"exception"})));
ba.a(ha.a.Uyd,!1,ya.getElapsedMilliseconds(Gc,va.a.Ta.Jb),uc);Xb.sA=new m(!1,!1,void 0,"exception",Fb.toString());return Promise.resolve(!1)})};k.prototype.Z1e=function(hb){var Xb=this;this.Ie.MXh(this.$B);Z.a.b6?this.Ie.EWh(hb,this.$B,this.cache):this.bWh(hb);S()||this.Ie.b7i(function(Gc){Xb.Ie.zYh(Gc,hb,Xb.$B)},this.$B)};k.prototype.bWh=function(hb){var Xb=this,Gc=va.a.Ta.Jb,uc=[];if(hb&&hb.IsSuccess){J(this.$,hb.Token);var Nc=eb.a.create().toString();uc.push(Object(da.a)(new fa.a,{name:"CorrelationId",
string:Nc}));makerstorage.getScripts(Nc).then(function(Fb){uc.push(Object(da.a)(new fa.a,{name:"HasReadCachedScripts",bool:Xb.Ie.pxb}));Xb.Qp.clear();Fb=ik(Fb);for(var ob=Fb.next();!ob.done;ob=Fb.next())Xb.Qp.Gs(new u(ob.value));Xb.Qp.sort();Xb.Ie.BMf=!0;Xb.Ie.Uab=!0;Xb.Qwa&&(Fb=dc.a.xc(Xb.Qp.Ieb()),Xb.indexedDB.qcb(new $a.a(Z.a.Aab,Fb)));uc.push(Object(da.a)(new fa.a,{name:"ScriptCount",int64:Xb.Qp.length}));ba.a(ha.a.nEb,!0,ya.getElapsedMilliseconds(Gc,va.a.Ta.Jb),uc);Xb.UN(Z.a.Aab)}).catch(function(Fb){Object.getType(Fb)===
makerstorage.StorageServiceError?(uc.push(Object(da.a)(new fa.a,{name:"Error",string:Fb.message})),uc.push(Object(da.a)(new fa.a,{name:"ErrorCode",string:"makerstorage_"+Fb.errorCode.toString()+"_"+Fb.status.toString()})),17===Fb.errorCode&&Xb.cache.IId(Z.a.zac(Xb.$))):(uc.push(Object(da.a)(new fa.a,{name:"Error",string:Fb.toString()})),uc.push(Object(da.a)(new fa.a,{name:"ErrorCode",string:"exception"})));ba.a(ha.a.nEb,!1,ya.getElapsedMilliseconds(Gc,va.a.Ta.Jb),uc);Xb.Ie.Uab=!0;Xb.UN(Z.a.Aab)})}else Nc=
hb?hb.ErrorCode:"need_token",hb=hb?hb.ErrorMessage:"No Access Token",uc.push(Object(da.a)(new fa.a,{name:"ServiceChecked",bool:!1})),uc.push(Object(da.a)(new fa.a,{name:"Error",string:hb})),uc.push(Object(da.a)(new fa.a,{name:"ErrorCode",string:Nc})),ba.a(ha.a.nEb,!1,ya.getElapsedMilliseconds(Gc,va.a.Ta.Jb),uc),this.Ie.Uab=!0,this.UN(Z.a.Aab)};k.prototype.pgd=function(hb){if(Z.a.b6)return this.$B.pgd(hb);switch(hb){case "1":case "2":case "3":case "4":case "5":case "6":return this.$B.mW.q4(parseInt(hb,
10)-1);default:return this.Qp.gH(hb)||this.Fj.gH(hb)||this.vB.gH(hb)}};k.prototype.xid=function(hb){if(this.Qp.Gs(hb)){this.Qp.sort();var Xb=""}else{Xb="";var Gc=hb.b0a();this.Fj.Afb(Gc);this.Fj.sort();this.Qp.Afb(hb);this.Qp.sort()}return{returnValue:!0,message:Xb}};k.prototype.vid=function(hb){this.Fj.u1a(hb.id);return this.Qp.u1a(hb.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in published collection."}};k.prototype.qid=function(hb){var Xb=
hb.b0a();Xb.shareId=null;this.Qp.Gs(Xb)&&this.Qp.sort();return this.Fj.Gs(hb)?(this.Fj.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}};k.prototype.wid=function(hb){return this.Fj.u1a(hb.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}};k.prototype.UN=function(hb){if(Z.a.b6)this.$B.UN(hb);else{this.gHd();this.$.hf();var Xb=[];Xb.push(Object(da.a)(new fa.a,
{name:"Operation",string:hb}));Xb.push(Object(da.a)(new fa.a,{name:"HasReadCachedScripts",bool:this.Ie.pxb}));Xb.push(Object(da.a)(new fa.a,{name:"ReadScriptsDone",bool:this.Ie.gjd}));Xb.push(Object(da.a)(new fa.a,{name:"ReadSamplesScriptsDone",bool:this.Ie.NHb}));Xb.push(Object(da.a)(new fa.a,{name:"SamplesScriptCount",int64:this.vB.length}));Xb.push(Object(da.a)(new fa.a,{name:"ReadPublishedScriptsDone",bool:this.Ie.Uab}));Xb.push(Object(da.a)(new fa.a,{name:"PublishedScriptCount",int64:this.Qp.length}));
Xb.push(Object(da.a)(new fa.a,{name:"ReadWorkbookScriptsDone",bool:this.Ie.vW}));Xb.push(Object(da.a)(new fa.a,{name:"WorkbookScriptCount",int64:this.Fj.length}));ba.a(ha.a.Etf,!0,0,Xb)}};k.prototype.gHd=function(){this.$B.mW=new A([],function(){});for(var hb=this.Fj?this.Fj.length:0,Xb=this.Qp?this.Qp.length:0,Gc=this.vB?this.vB.length:0,uc=0,Nc=Z.a.TIf,Fb=0;Fb<Nc;Fb++)if(Fb<hb)this.$B.mW.Gs(this.Fj.q4(Fb));else if(Fb-hb+uc<Xb){var ob=this.Qp.q4(Fb-hb+uc);this.Fj.gH(ob.id)?(uc++,Fb--):this.$B.mW.Gs(ob)}else Fb-
hb-Xb+uc<Gc&&this.$B.mW.Gs(this.vB.q4(Fb-hb+uc-Xb))};k.prototype.rKd=function(hb){V.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!V.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&(hb?(la.PageLoadTrackingInfo.instance.h7(oc.a.$N,["automateTab"]),la.PageLoadTrackingInfo.instance.FW(oc.a.$N,["automateTab"]),la.PageLoadTrackingInfo.instance.EW(oc.a.$N,["automateTab"])):la.PageLoadTrackingInfo.instance.xda(oc.a.$N,
["automateTab"]))};k.prototype.G7h=function(){V.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CacheAutomateVisibility",!1)&&ka.c()&&appChrome.api.dispatch(appChrome.actions.deactivateRibbonTab(oc.a.JHb))};of.Object.defineProperties(k.prototype,{Qp:{configurable:!0,enumerable:!0,get:function(){return this.Ie.Qp}},Fj:{configurable:!0,enumerable:!0,get:function(){return S()?new A([],function(){}):this.Ie.Fj}},vB:{configurable:!0,enumerable:!0,get:function(){return this.Ie.vB}},ft:{configurable:!0,
enumerable:!0,get:function(){return this.Ie.ft}},Va:{configurable:!0,enumerable:!0,get:function(){return this.$Pc}},h5a:{configurable:!0,enumerable:!0,get:function(){return this.Ie.h5a}},initTime:{configurable:!0,enumerable:!0,get:function(){return this.rrg}},Pba:{configurable:!0,enumerable:!0,get:function(){var hb=!!this.Du.Wx&&this.Du.Wx.isSuccess&&this.Du.Wx.value,Xb=!!this.sA&&!this.sA.isSuccess,Gc=!!this.sA&&this.Du.Wx.isSuccess&&this.sA.value;Xb=Z.a.Cta||Gc||Xb&&!vb.a.Rka(11);return this.sif&&
hb&&Xb}},sif:{configurable:!0,enumerable:!0,get:function(){var hb="TestHost"===this.$.ya.DocumentHostInfo.HostTier,Xb=xa.AFrameworkApplication.fa.Wa("UserPrincipalName");Xb=!xa.AFrameworkApplication.fa.qa("IsAnonymousUser")&&!!Xb&&!Xb.includes("ext#")&&!Xb.includes("guest#");return!vb.a.Ika&&(hb||this.nha.Zse&&Xb)}}});Object(t.a)(k,"AutomateCommandManager",null,[497]);var ca=b(1571),Ia=b(1519),jb=b(260),nb=b(1177),Na=b(50),sa=b(105),Wa=b(21),Hb=b(1179);h.prototype.Zwb=function(hb){if(hb.Pba){var Xb=
[];Xb.push(Object(da.a)(new fa.a,{name:"isSharedRuntimeInstanceInitialized",bool:this.l7a}));Xb.push(Object(da.a)(new fa.a,{name:"actionName",string:hb.actionName}));Xb.push(Object(da.a)(new fa.a,{name:Z.a.G$,string:hb.clickId.toString()}));this.l7a?this.PXf(hb):this.F3h(hb);ba.a(ha.a.FGi,void 0,void 0,Xb)}};h.prototype.Shd=function(hb,Xb){var Gc={};Gc[Z.a.G$]=Xb;this.MNd(hb,Gc)};h.prototype.bwj=function(){this.E2f()?this.dIf():Wa.g(this.$).Ea.Ume(this.y9a)};h.prototype.E2f=function(){if(this.l7a||
T(this.$))return!1;var hb=sa.a(this.$);return Wa.g(this.$).Ea.I_b&&hb.Rfi()};h.prototype.dIf=function(){var hb=this;this.Du.Wx?this.Du.Wx.value&&this.nha.Xvb():this.Du.g0c().then(function(Xb){Xb&&hb.nha.Xvb()});ba.a(ha.a.AGi)};h.prototype.ooj=function(){var hb=Ka.a.create().toString(),Xb={};N(this.$,Xb);var Gc={};Gc[Z.a.i7f]=this.nha.getAuthContext();var uc={};uc[Z.a.eUe]=dc.a.xc(Xb);uc[Z.a.Saf]=dc.a.xc(Gc);uc[Z.a.Eih]=dc.a.xc(this.$.ya.DocumentHostInfo);uc[Z.a.iHj]=F(this.$);uc[Z.a.$8f]=dc.a.xc(Z.a.lu);
uc[Z.a.Rte]=this.$.ztf?"true":"false";uc[Z.a.JUf]=Z.a.F3a(this.$);uc[Z.a.E7e]=w(this.$);uc[Z.a.i$f]=y(this.$);uc[Z.a.G$]=hb;Xb=[];Xb.push(Object(da.a)(new fa.a,{name:Z.a.G$,string:hb}));ba.a(ha.a.DGi,void 0,void 0,Xb);this.MNd(Z.a.vai,uc)};h.prototype.F3h=function(hb){var Xb=this;this.xAj(hb);T(this.$)&&J(this.$,"localstorage");P.TaskExtensions.Aa(Na.GetServiceTaskFactory.Ra(this.$.da,374,375,1),function(Gc){Xb.qui(Gc.result).continueWith(function(){Xb.noj(hb)});Xb.l7a=!0},this.$.la,3)};h.prototype.qui=
function(hb){var Xb={};Xb.SolutionId=Z.a.solutionId;Xb.Version=Z.a.cNd;Xb.StoreType=OSF.StoreType.Sdx;Xb.StoreId=OSF.StoreType.Sdx;Xb.AssetId=Z.a.solutionId;Xb.AssetStoreId=OSF.StoreType.Sdx;Xb.TargetType=1;Xb.SharedRuntimeId=Z.a.qwb(this.$);Xb.SourceLocationOverrideResourceId=Z.a.qwb(this.$);Xb.IsToBePersisted=!1;var Gc=new ca.a;Gc.Rk=ta.a.instance.ga(2134);Gc.taskPaneWidth=Z.a.lu;var uc=new nb.a;uc.Heb=y(this.$);uc.G4=w(this.$);return hb.OMd(Xb,Gc,void 0,void 0,uc)};h.prototype.noj=function(hb){this.ooj();
jb.a(this.$)&&jb.a(this.$).kne(this.IJi);this.PXf(hb)};h.prototype.PXf=function(hb){var Xb={};Xb[Z.a.ykj]=hb.shapeId;Xb[Z.a.xkj]=hb.scriptLink;Xb[Z.a.G$]=hb.clickId.toString();Xb[Z.a.wkj]=hb.buttonText;this.MNd(hb.actionName,Xb)};h.prototype.MNd=function(hb,Xb){var Gc=new Ab.a(Z.a.solutionId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,Z.a.cNd),uc=new Db.a(Z.a.K8e,Z.a.RUe,this.$.ya.UICultureTag),Nc=new Wb.a;Nc.optionalProperties[ub.a.Rk]=ta.a.instance.ga(2134);Nc.optionalProperties[ub.a.sourceLocationOverrideResourceId]=
Z.a.qwb(this.$);Nc.optionalProperties[ub.a.uTc]=Xb;Nc.optionalProperties[ub.a.taskPaneWidth]=Z.a.lu;Sa.a.instance.sNa(Gc,Ia.a.action,hb,uc,Nc)};h.prototype.xAj=function(hb){V.EwaSettings.getBooleanFeatureGate(Z.a.a9f,!1)&&hb.actionName===Z.a.sVf&&(hb=new Hb.a(hb.scriptLink,"initializing",hb.clickId.toString(),hb.buttonText),this.businessBarManager.$le(64,hb))};Object(t.a)(h,"AutomateCommandRunFromButton",null,[495]);var Yb=b(162),Sb=b(22);e.QEj=function(hb){hb.sort(function(Xb,Gc){return Gc.kGe-Xb.kGe})};
e.Byc=function(hb){hb.sort(function(Xb,Gc){return Sb.a.compare(Xb.name,Gc.name,!0)})};e.oZh=function(hb){var Xb;var Gc=Xb=null;if(hb){var uc=hb.indexOf(":");if(-1!==uc)return Xb=hb.substr(0,uc),Gc=hb.substr(uc+1),{returnValue:!0,j7f:Xb,shareId:Gc}}return{returnValue:!1,j7f:Xb,shareId:Gc}};e.kYh=function(hb,Xb){var Gc={};Gc[Z.a.yhg]=encodeURIComponent(hb.workbookContext.WorkbookFileName);Gc[Z.a.VWf]=Xb.Ieb();return pb.c(Gc)};e.FMf=function(hb,Xb){return P.TaskExtensions.T$(Xb.f4a(Z.a.SPb),function(Gc){Gc=
Gc.result;if(""!==Gc){Gc=pb.b(Gc);var uc=Gc[Z.a.VWf];if(Gc[Z.a.yhg]===encodeURIComponent(hb.workbookContext.WorkbookFileName)){Gc=new A([],function(Fb){e.Byc(Fb)});uc=ik(uc);for(var Nc=uc.next();!Nc.done;Nc=uc.next())Gc.Gs(new u(Nc.value));Gc.sort();return Gc}}},hb.la,3)};of.Object.defineProperties(e.prototype,{h5a:{configurable:!0,enumerable:!0,get:function(){var hb=Z.a.b6?this.Mdc:this.pxb;return this.NHb||hb||this.gjd}},gjd:{configurable:!0,enumerable:!0,get:function(){return(Z.a.b6?this.Vab:this.Uab)&&
this.vW&&this.NHb}}});Object(t.a)(e,"AutomateCommandStorageBase",null,[]);var lb=b(121),wb=b(100);$k(d,e);d.prototype.nUg=function(hb,Xb){if(this.cache.Df()){var Gc={};Gc.TimeStamp=va.a.Ta.Jb;Gc.IsEnabled=Xb;this.cache.ZOd(hb,dc.a.xc(Gc))}};d.prototype.TKh=function(hb){var Xb=!1,Gc=!1,uc=null;this.cache.Df()&&(hb=pb.b(this.cache.Svb(hb)))&&(Gc=hb.IsEnabled,uc=new Date(hb.TimeStamp),Xb=!0);return new m(Gc,Xb,uc)};d.prototype.CMf=function(hb){var Xb=this,Gc=va.a.Ta.Jb,uc=[];return P.TaskExtensions.T$(this.indexedDB.f4a(Z.a.ZPa),
function(Nc){var Fb=!Xb.Vab||!Xb.ft.length;Nc=Nc.result;uc.push(Object(da.a)(new fa.a,{name:"ExistingScriptCount",int64:Xb.ft.length}));if(""!==Nc&&(Nc=pb.b(Nc),uc.push(Object(da.a)(new fa.a,{name:"CachedScriptCount",int64:Nc.length})),Fb)){for(var ob=ik(Nc),zb=ob.next();!zb.done;zb=ob.next())Xb.ft.Gs(new u(zb.value));Xb.Mdc=!0;Xb.VGd=0<Nc.length;ba.a(ha.a.Ctf,Fb,ya.getElapsedMilliseconds(Gc,va.a.Ta.Jb),uc);Xb.FHd(hb);return!0}ba.a(ha.a.Ctf,Fb,ya.getElapsedMilliseconds(Gc,va.a.Ta.Jb),uc);return!1},
this.$.la,3)};d.prototype.c7i=function(hb){V.EwaSettings.getBooleanFeatureGate(Z.a.NXc,!1)&&!S()&&this.i7i(hb);Z.a.b6?this.CMf(hb):this.a7i(hb)};d.prototype.EWh=function(hb,Xb,Gc){var uc=this,Nc=va.a.Ta.Jb,Fb=[];if(hb&&hb.IsSuccess){J(this.$,hb.Token);var ob=eb.a.create().toString();Fb.push(Object(da.a)(new fa.a,{name:"CorrelationId",string:ob}));makerstorage.getRecentScripts(ob).then(function(zb){Fb.push(Object(da.a)(new fa.a,{name:"HasReadCachedScripts",bool:uc.Mdc}));uc.ft.clear();zb=ik(zb);for(var ib=
zb.next();!ib.done;ib=zb.next())uc.ft.Gs(new u(ib.value));uc.VGd=!0;uc.Vab=!0;uc.indexedDB.Df()&&(zb=dc.a.xc(uc.ft.Ieb()),uc.indexedDB.qcb(new $a.a(Z.a.ZPa,zb)));Fb.push(Object(da.a)(new fa.a,{name:"ScriptCount",int64:uc.ft.length}));ba.a(ha.a.nEb,!0,ya.getElapsedMilliseconds(Nc,va.a.Ta.Jb),Fb);Xb.UN(Z.a.ZPa)}).catch(function(zb){Object.getType(zb)===makerstorage.StorageServiceError?(Fb.push(Object(da.a)(new fa.a,{name:"Error",string:zb.message})),Fb.push(Object(da.a)(new fa.a,{name:"ErrorCode",string:"makerstorage_"+
zb.errorCode.toString()+"_"+zb.status.toString()})),17===zb.errorCode&&Gc.IId(Z.a.zac(uc.$))):(Fb.push(Object(da.a)(new fa.a,{name:"Error",string:zb.toString()})),Fb.push(Object(da.a)(new fa.a,{name:"ErrorCode",string:"exception"})));ba.a(ha.a.BGi,!1,ya.getElapsedMilliseconds(Nc,va.a.Ta.Jb),Fb);uc.Vab=!0;Xb.UN(Z.a.ZPa)})}else ob=hb?hb.ErrorCode:"need_token",hb=hb?hb.ErrorMessage:"No Access Token",Fb.push(Object(da.a)(new fa.a,{name:"ServiceChecked",bool:!1})),Fb.push(Object(da.a)(new fa.a,{name:"Error",
string:hb})),Fb.push(Object(da.a)(new fa.a,{name:"ErrorCode",string:ob})),ba.a(ha.a.nEb,!1,ya.getElapsedMilliseconds(Nc,va.a.Ta.Jb),Fb),this.Vab=!0,Xb.UN(Z.a.ZPa)};d.prototype.b7i=function(hb,Xb){var Gc=this,uc=new Yb.a,Nc=D(this.$);H(this.$,function(Fb){if((Fb=Fb.Result)&&200===Fb.ResponseStatusCode)Fb=Fb.ResponseBody.join(""),Fb=JSON.parse(Fb),hb(Gc.gYi(Fb.value)),uc.setResult(!0);else{Fb=Fb?"RichApi_"+Fb.ResponseStatusCode:"RichApiError";var ob=[];ob.push(Object(da.a)(new fa.a,{name:"Error",string:"Failed to read shared script ids from document"}));
ob.push(Object(da.a)(new fa.a,{name:"ErrorCode",string:Fb}));Gc.vW=!0;Gc.R_a(Xb,va.a.Ta.Jb,0,ob);uc.setResult(!1)}},function(Fb){Fb=lb.a.xf(Fb.data);Q.ULS.sendTraceTag(537170309,0,15,"REST API failed to fetch the CustomXmlPart for Automate Gallery.");var ob=[];ob.push(Object(da.a)(new fa.a,{name:"Error",string:"Failure using rich api: "+Fb}));ob.push(Object(da.a)(new fa.a,{name:"ErrorCode",string:"RichApiFailure"}));Gc.vW=!0;Gc.R_a(Xb,va.a.Ta.Jb,0,ob);uc.setResult(!1)},Nc,uc)};d.prototype.zYh=function(hb,
Xb,Gc){var uc=this,Nc=va.a.Ta.Jb,Fb=0,ob=0;this.vW=Fb===hb.count;var zb=[];zb.push(Object(da.a)(new fa.a,{name:"ScriptIds",int64:hb.count}));if(hb.count)if(Xb&&Xb.IsSuccess){J(this.$,Xb.Token);var ib={};Xb=ik(hb);for(var fc=Xb.next();!fc.done;ib={ggb:ib.ggb},fc=Xb.next())fc=fc.value,ib.ggb=eb.a.create().toString(),makerstorage.getSharedScript(fc.value,ib.ggb).then(function(Ic){return function(Yc){var Mc=[];Mc.push(Object(da.a)(new fa.a,{name:"BodySize",int64:Yc.body.length}));Mc.push(Object(da.a)(new fa.a,
{name:"CorrelationId",string:Ic.ggb}));ba.a(ha.a.Dtf,!0,ya.getElapsedMilliseconds(Nc,va.a.Ta.Jb),Mc);Fb++;Yc=new u(Yc);Yc.shareId=hb.na(Yc.id);uc.Fj.Gs(Yc);uc.vW=Fb===hb.count;uc.XGd=!0;uc.R_a(Gc,Nc,ob,zb)}}(ib)).catch(function(Ic){return function(Yc){var Mc=[];Object.getType(Yc)===makerstorage.StorageServiceError?(zb.push(Object(da.a)(new fa.a,{name:"Error",string:Yc.message})),zb.push(Object(da.a)(new fa.a,{name:"ErrorCode",string:"makerstorage_"+Yc.errorCode.toString()+"_"+Yc.status.toString()}))):
(Mc.push(Object(da.a)(new fa.a,{name:"Error",string:Yc.toString()})),Mc.push(Object(da.a)(new fa.a,{name:"ErrorCode",string:"exception"})));Mc.push(Object(da.a)(new fa.a,{name:"CorrelationId",string:Ic.ggb}));ba.a(ha.a.Dtf,!1,ya.getElapsedMilliseconds(Nc,va.a.Ta.Jb),Mc);Fb++;ob++;uc.vW=Fb===hb.count;uc.R_a(Gc,Nc,ob,zb)}}(ib)).finally(function(){if(V.EwaSettings.getBooleanFeatureGate(Z.a.NXc,!1)&&uc.indexedDB.Df()&&uc.vW){var Ic=e.kYh(uc.$,uc.Fj);uc.indexedDB.qcb(new $a.a(Z.a.SPb,Ic))}})}else ib=Xb?
Xb.ErrorCode:"need_token",Xb=Xb?Xb.ErrorMessage:"No Access Token",zb.push(Object(da.a)(new fa.a,{name:"Error",string:Xb})),zb.push(Object(da.a)(new fa.a,{name:"ErrorCode",string:ib})),this.vW=!0,this.R_a(Gc,Nc,ob,zb);else this.vW=this.XGd=!0,this.R_a(Gc,Nc,ob,zb),V.EwaSettings.getBooleanFeatureGate(Z.a.NXc,!1)&&P.TaskExtensions.T$(e.FMf(this.$,this.indexedDB),function(Ic){Ic.result&&(uc.indexedDB.b6c(Z.a.SPb),uc.Fj.clear(),Gc.UN("CachedScripts"))},this.$.la,3)};d.prototype.MXh=function(hb){var Xb=
{id:"samples-6"};Xb.name=ta.a.instance.ga(2128);this.vB.Gs(new u(Xb));Xb.id="samples-8";Xb.name=ta.a.instance.ga(2129);this.vB.Gs(new u(Xb));Xb.id="samples-2";Xb.name=ta.a.instance.ga(2125);this.vB.Gs(new u(Xb));Xb.id="samples-4";Xb.name=ta.a.instance.ga(2126);this.vB.Gs(new u(Xb));Xb.id="samples-5";Xb.name=ta.a.instance.ga(2127);this.vB.Gs(new u(Xb));Xb.id="samples-9";Xb.name=ta.a.instance.ga(2130);this.vB.Gs(new u(Xb));this.NHb=!0;hb.UN("SampleScripts")};d.prototype.c_h=function(){var hb={};hb.id=
Z.a.m9f;hb.name=ta.a.instance.ga(2131);this.BNb.Gs(new u(hb));hb.id=Z.a.n9f;hb.name=ta.a.instance.ga(2132);this.BNb.Gs(new u(hb))};d.prototype.gYi=function(hb){var Xb=new wb.a;if(hb=this.N1a.parseFromString(hb,"text/xml").querySelector('[id="script-ids-node-id"]')){hb=hb.getElementsByTagName("scriptId");for(var Gc={},uc=0;uc<hb.length;Gc={CQb:Gc.CQb,zQb:Gc.zQb,uQb:Gc.uQb},uc++)Gc.CQb=hb[uc].getAttribute("id"),Gc.CQb&&(Gc.zQb=void 0,Gc.uQb=void 0,function(Nc){return function(){var Fb=e.oZh(Nc.CQb);
Nc.zQb=Fb.j7f;Nc.uQb=Fb.shareId;return Fb}}(Gc)().returnValue&&Xb.ia(Gc.zQb,Gc.uQb))}return Xb};d.prototype.i7i=function(hb){var Xb=this,Gc=va.a.Ta.Jb,uc=[];P.TaskExtensions.T$(e.FMf(this.$,this.indexedDB),function(Nc){var Fb=Nc.result;uc.push(Object(da.a)(new fa.a,{name:"ExistingScriptCount",int64:Xb.Fj.length}));if(Fb){uc.push(Object(da.a)(new fa.a,{name:"CachedScriptCount",int64:Fb.length}));if(Nc=!Xb.vW||0===Xb.Fj.length){Fb=ik(Fb.getScripts());for(var ob=Fb.next();!ob.done;ob=Fb.next())Xb.Fj.Gs(ob.value);
Xb.Fj.sort();ba.a(ha.a.Vyd,Nc,ya.getElapsedMilliseconds(Gc,va.a.Ta.Jb),uc);Xb.FHd(hb);return!0}ba.a(ha.a.Vyd,Nc,ya.getElapsedMilliseconds(Gc,va.a.Ta.Jb),uc)}else ba.a(ha.a.Vyd,!1,ya.getElapsedMilliseconds(Gc,va.a.Ta.Jb),uc);return!1},this.$.la,3)};d.prototype.a7i=function(hb){var Xb=this,Gc=va.a.Ta.Jb,uc=[];P.TaskExtensions.T$(this.indexedDB.f4a(Z.a.Aab),function(Nc){var Fb=!Xb.Uab||!Xb.Qp.length;Nc=Nc.result;uc.push(Object(da.a)(new fa.a,{name:"ExistingScriptCount",int64:Xb.Qp.length}));if(""!==
Nc&&(Nc=pb.b(Nc),uc.push(Object(da.a)(new fa.a,{name:"CachedScriptCount",int64:Nc.length})),Fb)){Nc=ik(Nc);for(var ob=Nc.next();!ob.done;ob=Nc.next())Xb.Qp.Gs(new u(ob.value));Xb.Qp.sort();ba.a(ha.a.Btf,Fb,ya.getElapsedMilliseconds(Gc,va.a.Ta.Jb),uc);Xb.FHd(hb);return!0}ba.a(ha.a.Btf,Fb,ya.getElapsedMilliseconds(Gc,va.a.Ta.Jb),uc);return!1},this.$.la,3)};d.prototype.R_a=function(hb,Xb,Gc,uc){this.vW&&(uc.push(Object(da.a)(new fa.a,{name:"ScriptCount",int64:this.Fj.length})),uc.push(Object(da.a)(new fa.a,
{name:"ScriptErrorCount",int64:Gc})),ba.a(ha.a.CGi,!Gc,ya.getElapsedMilliseconds(Xb,va.a.Ta.Jb),uc),this.Fj.sort(),hb.UN(Z.a.SPb))};d.prototype.FHd=function(hb){this.pxb=!0;hb.UN("CachedScripts")};Object(t.a)(d,"AutomateCommandStorage",e,[]);var wa=b(921),Oa=U.a;$k(c,Oa);c.prototype.create=function(){var hb=this,Xb=Na.GetServiceTaskFactory.Ra(this.$.da,349,350,this.hb),Gc=ja.a.loadScript(130,4,this.hb,void 0,void 0,351),uc=Na.GetServiceTaskFactory.create(this.$.da,102,this.$.la,this.hb),Nc=Na.GetServiceTaskFactory.create(this.$.da,
396,this.$.la,this.hb),Fb=Na.GetServiceTaskFactory.Ra(this.$.da,5,4,this.hb);P.TaskExtensions.Aa(P.TaskExtensions.Vd([Xb,Gc,uc,Nc,Fb],this.la,3),function(){var ob=Xb.result,zb=Nc.result,ib=Fb.result,fc=new v,Ic=new K(hb.$,ob,fc),Yc=new d(hb.$,zb),Mc=new l(hb.$,Yc),xb=new h(hb.$,Ic,fc,ib);V.EwaSettings.isChangeGateEnabled("OfficeVSO:6143820_MoveServiceRegistrationFromFAM_V2")?(ib=Object(wa.b)(hb.$.da,352,function(){return new k(hb.$,ob,uc.result,zb,xb,fc,Ic,Yc,Mc)}),hb.pb(ib)):hb.pb(hb.$.da.za(352)||
new k(hb.$,ob,uc.result,zb,xb,fc,Ic,Yc,Mc))},this.la,3)};c.ka=function(hb){hb&&hb.da.Ga(351,new c(hb))};Object(t.a)(c,"AutomateCommandManagerFactory",U.a,[]);var Ub=b(10);b.d(E,"a",function(){return a})},1392:function(t,E,b){function a(){Type.registerNamespace("Common.App.WopiIdentity");c.main()}function c(){this.fb=null}function d(N){this._initialized=!1;this.D$a={};this.bzc={};this.qO=x.AFrameworkApplication.ta.sD;this.fkd=N}function e(N,T,G){this.expiration=this.authority=this.accessToken=null;
this.accessToken=N;this.authority=T;this.expiration=G}function h(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}function k(){}function n(N,T){this.requestCallback=this.requestParameters=null;this.requestParameters=N;this.requestCallback=T}t=b(0);var f=b(15),v=b(84),m;(function(N){N[N.generalException=0]="generalException";N[N.invalidArgument=1]="invalidArgument";N[N.notAllowed=2]="notAllowed";N[N.apiNotAvailable=3]="apiNotAvailable";N[N.unresolvedPendingRequest=
4]="unresolvedPendingRequest";N[N.timeout=5]="timeout";N[N.adalTimeout=6]="adalTimeout";N[N.userNotSignedIn=7]="userNotSignedIn";N[N.userAborted=8]="userAborted";N[N.silentSignInFailed=9]="silentSignInFailed";N[N.invalidResourceUrl=10]="invalidResourceUrl";N[N.invalidGrant=11]="invalidGrant";N[N.connectionLost=12]="connectionLost";N[N.clientError=13]="clientError";N[N.serverError=14]="serverError"})(m||(m={}));Object(t.b)("ErrorCodes",m);b(1513);Object(t.a)(n,"OutstandingRequest",null,[]);k.LEi="AADSTS50058";
k.invalidResourceUrl="AADSTS50001";k.GEi="AADSTS65001";k.WEi="AADSTS70011";k.userAborted="13002";k.U_i="Popup Window is null";k.T_i="Popup Window closed";k.adalTimeout="Token renewal operation failed due to timeout";k.jMj="tokenRevoked";Object(t.a)(k,"WopiHostErrorType",null,[]);var x=b(4),l=b(953),u=b(644),A=b(42),z=b(1512);Object(t.a)(h,"WopiIdentityInfo",null,[375]);Object(t.a)(e,"WopiIdentityToken",null,[374]);var y=b(27),w=b(153),D=b(396),H=b(170),F=b(80),J=b(360);d.prototype.j2a=function(N){this._initialized||
(N.Tn(H.a.QHf),N.Ml(H.a.QHf,Object(v.a)(this,this.xRi,"onReceivedAccessToken")),this._initialized=!0)};d.prototype.getAccessToken=function(N,T,G){var I=this;G=void 0===G?null:G;this.NNa(N,T);return new Promise(function(K,L){if(I.zmd(T))if(T in I.D$a)L("unresolvedPendingRequest");else{var O=window.setTimeout(function(){var Q={};f.ULS.sendTraceTag(37856032,344,10,A.c((Q.error="Request timeout.",Q.callerId=T,Q)));L("timeout")},12E4);I.Bcd(N,T,G,function(Q,U){window.clearTimeout(O);Q?K(Q):(Q={},f.ULS.sendTraceTag(37856033,
369,15,A.c((Q.error=m[U],Q))),L(U))})}else{var B={};f.ULS.sendTraceTag(37856034,344,10,A.c((B.error="Caller is not allowed.",B)));L("notAllowed")}})};d.prototype.getPrimaryIdentityInfo=function(N){var T=this;return new Promise(function(G,I){if(T.zmd(N))T.JVh(function(L,O){L?G(L):(L={},f.ULS.sendTraceTag(37856064,369,10,A.c((L.error=O.toString(),L))),I(O))});else{var K={};f.ULS.sendTraceTag(37856065,344,10,A.c((K.error="Caller is not allowed.",K)));I("notAllowed")}})};d.prototype.getAuthContext=function(N){var T=
this;return new Promise(function(G,I){var K=T.getAuthContextSync(N);K?G(K):I("notAllowed")})};d.prototype.getAuthContextSync=function(N){if(this.zmd(N)){var T=new z.a;T.upn=x.AFrameworkApplication.fa.Wa("UserPrincipalName");T.userId=x.AFrameworkApplication.fa.Wa("LoggableUserId");T.authority=x.AFrameworkApplication.fa.Wa("HostAuthAuthority");T.tenantId=x.AFrameworkApplication.fa.Wa("TenantId");T.isAnonymous=x.AFrameworkApplication.fa.qa("IsAnonymousUser");T.supportsAuthToken=this.w8h(N);N=x.AFrameworkApplication.fa.Wa("HostAuthType");
T.authorityType="aad"===N.toLowerCase()?2:"msa"===N.toLowerCase()?1:0;return T}T={};f.ULS.sendTraceTag(40751647,344,10,A.c((T.error="Caller is not allowed.",T)));return null};d.prototype.w8h=function(N){var T=l.a.Sxb;return y.a.mxa?T&&l.a.f9f?Array.contains(l.a.f9f,N.toLowerCase()):!1:T};d.prototype.Bcd=function(N,T,G,I){var K=this,L=[];Array.add(L,Object.assign(new F.a,{name:"CallerId",string:T}));Array.add(L,Object.assign(new F.a,{name:D.a.ETd,string:N.correlationId}));w.a.sendTelemetryEvent(Object.assign(new J.a,
{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:L}));L=u.a.create().toString();var O="getAccessToken_"+L,B=this.qO.sc("ComponentAttach",O);this.bzc[O]=B;var Q={};Q[D.a.FTd]=L;Q[D.a.zFj]=N.resource;Q[D.a.AFj]=N.scope;Q[D.a.c6f]=x.AFrameworkApplication.fa.Wa("HostAuthType");Q[D.a.DFj]=x.AFrameworkApplication.fa.Wa("UserPrincipalName");Q[D.a.BFj]=N.silentLogin;Q[D.a.wFj]=N.options;Q[D.a.ETd]=N.correlationId;Q[D.a.xFj]=T;G&&(Q[D.a.addinName]=G.AddinName,Q[D.a.vFj]=G.AddinTrustId);
this.fkd.execute(function(U){K.j2a(U);U.wj(H.a.getAuthToken,Q)});this.D$a[L]=new n(N,I)};d.prototype.JVh=function(N){var T=x.AFrameworkApplication.fa.Wa("UserName"),G=x.AFrameworkApplication.fa.Wa("UserPrincipalName"),I=x.AFrameworkApplication.fa.Wa("LoggableUserIdSpace"),K=new h;K.email=G;K.displayName=T;switch(I){case "OrgIdPuid":K.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":K.authority="MicrosoftAccount";break;default:K.authority=I}N(K,null)};d.prototype.xRi=function(N){var T=
null;try{var G=N.Values[D.a.FTd],I=N.Values[D.a.uFj],K=N.Values[D.a.c6f],L=N.Values[D.a.CFj],O=null,B=null,Q=this.D$a[G];if("undefined"!==typeof Q&&Q){var U=[];Array.add(U,Object.assign(new F.a,{name:D.a.ETd,string:Q.requestParameters.correlationId}));w.a.sendTelemetryEvent(Object.assign(new J.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:U}));T=Q.requestCallback;delete this.D$a[G];"undefined"!==typeof I&&I&&I.length?B=new e(I,K,L):O=m[this.Mzi(N)];G="getAccessToken_"+
G;G in this.bzc&&(this.bzc[G].stop(),delete this.bzc[G]);T(B,O)}else O={},f.ULS.sendTraceTag(37856066,344,10,A.c((O.error="No matching outstanding request for request ID.",O.requestId=G,O)))}catch(X){N=N.Values[D.a.FTd],N in this.D$a&&delete this.D$a[N],this.rkc(),N={},f.ULS.sendTraceTag(37856067,344,10,A.c((N.error=X.message,N.stack=X.stack,N))),T&&T(null,"generalException")}};d.prototype.zmd=function(N){var T=x.AFrameworkApplication.K1h();N=N.toLowerCase();T=ik(T);for(var G=T.next();!G.done;G=T.next())if(N===
G.value.toLowerCase())return!0;T=l.a.wWc;for(var I in T)if(N===T[I].toLowerCase())return!0;return!1};d.prototype.Mzi=function(N){N=N.Values[D.a.yFj];this.rkc();var T={};f.ULS.sendTraceTag(39068821,344,15,A.c((T.error=N,T)));return N?-1<N.indexOf(k.LEi)?9:-1<N.indexOf(k.U_i)||-1<N.indexOf(k.T_i)?12:-1<N.indexOf(k.invalidResourceUrl)?10:-1<N.indexOf(k.userAborted)?8:-1<N.indexOf(k.WEi)||-1<N.indexOf(k.GEi)||N===k.jMj?11:-1<N.indexOf(k.adalTimeout)?6:0:13};d.prototype.NNa=function(N,T){N=this.r8i(N.resource);
var G={};f.ULS.sendTraceTag(39921882,344,50,A.c((G.callerId=T,G.resource=N,G)))};d.prototype.rkc=function(){var N={};f.ULS.sendTraceTag(39068822,344,50,A.c((N.userAgent=window.navigator.userAgent,N)))};d.prototype.r8i=function(N){return(N?N:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")};Object(t.a)(d,"WopiIdentityManager",null,[355]);var S=b(258);c.prototype.Sh=function(N){this.fb=N;N.register(d,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").tc().Dc(function(){return new d(N.Tb("Postmessage.IHostPostmessenger"))})};
c.prototype.init=function(){x.AFrameworkApplication.fa&&x.AFrameworkApplication.fa.Vu(Object(v.a)(this,this.pB,"onFullAppSettingsReady"))};c.prototype.pB=function(){try{this.fb.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(N){f.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+N)}};c.prototype.dispose=function(){};c.main=function(){S.a.instance.Qi(new c)};of.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.WopiIdentity"}}});
Object(t.a)(c,"WopiIdentityPackage",null,[10,11]);b.d(E,"a",function(){return a})},1402:function(t,E,b){function a(fa,ra,pa){this.Qwa=!1;this.YE={};this.$=fa;this.hj=ra;this.Yld().ina();this.indexedDB=pa;this.indexedDB.Df()&&(this.Qwa=!0,this.indexedDB.initialize(a.eld,a.fld))}function c(fa,ra){this.TQc=fa;this._message=ra}function d(){}function e(){}function h(fa){switch(fa){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}}function k(fa,ra){l(b(1402).CustomFunctionsInstaller.G_e("CustomFunctionsRuntimeLogging"),
function(pa){if(pa.result&&window.console)switch(pa=h(fa.severity)+" "+fa.message+ra,fa.severity){case 2:window.console.log&&window.console.log(pa);break;case 0:window.console.info&&window.console.info(pa);break;case 1:window.console.error&&window.console.error(pa)}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")}function n(fa,ra,pa,Za,Ua){pa=fa.continueWith(function(){ra(fa)},3,pa,Za);pa.continueWith(function(){F.ULS.sendTraceTag(537163459,
0,10,Ua)},4);return pa}function f(fa,ra,pa){return n(fa,ra,X.a.none,P.a.current,pa)}function v(fa,ra,pa,Za,Ua){pa=fa.Jo(function(){return ra(fa)},3,pa,Za);pa.continueWith(function(){F.ULS.sendTraceTag(537163460,0,10,Ua)},4);return O.TaskExtensions.wBc(pa)}function m(fa,ra,pa){return v(fa,ra,X.a.none,P.a.current,pa)}function x(fa,ra,pa,Za,Ua){pa=fa.Jo(function(){return ra(fa)},3,pa,Za);pa.continueWith(function(){F.ULS.sendTraceTag(537163461,0,10,Ua)},4);return pa}function l(fa,ra,pa){return x(fa,ra,
X.a.none,P.a.current,pa)}function u(fa,ra,pa,Za,Ua){pa=fa.Jo(function(){return ra(fa)},3,pa,Za);pa.continueWith(function(){F.ULS.sendTraceTag(537163462,0,10,Ua)},4);return O.TaskExtensions.wBc(pa)}function A(fa,ra,pa){return u(fa,ra,X.a.none,P.a.current,pa)}function z(fa,ra,pa,Za,Ua){pa=fa.continueWith(function(){ra(fa)},3,pa,Za);pa.continueWith(function(){F.ULS.sendTraceTag(537163463,0,10,Ua)},4);return pa}function y(fa,ra,pa){return z(fa,ra,X.a.none,P.a.current,pa)}function w(){}function D(fa){fa=
fa.split("|");this.$w=fa[1];this.vRc=fa[2];this.rUd=fa[3]}b.r(E);t=b(0);var H=b(7),F=b(15),J=b(4),S=b(162),N=b(192),T=b(85),G=b(572),I=b(177),K=b(62),L=b(50),O=b(37),B=b(226),Q=b(121),U=b(600);of.Object.defineProperties(D.prototype,{solutionId:{configurable:!0,enumerable:!0,get:function(){return this.$w}},solutionVersion:{configurable:!0,enumerable:!0,get:function(){return this.vRc}},needToRestoreManifest:{configurable:!0,enumerable:!0,get:function(){return this.rUd===OSF.StoreTypeEnum.Registry.toString()}}});
Object(t.a)(D,"AddinStoreInfo",null,[]);Object(t.a)(w,"CustomFunctionRegistrationInfos",null,[]);var X=b(205),P=b(63),ea=b(1180);Object(t.a)(e,"InstallationInfo",null,[]);Object(t.a)(d,"UninstallationInfo",null,[]);var ia=b(28),da=b(91),xa=b(34),Z=b(31),ha=b(1),ya=b(22),va=b(298),bb=b(1008),ba=b(58);of.Object.defineProperties(c.prototype,{severity:{configurable:!0,enumerable:!0,get:function(){return this.TQc}},message:{configurable:!0,enumerable:!0,get:function(){return this._message}}});Object(t.a)(c,
"CustomFunctionLog",null,[]);b.d(E,"CustomFunctionsInstaller",function(){return a});a.prototype.taf=function(fa,ra,pa,Za){var Ua=this;if(Za.invariantNamespace)for(var Ma=0;Ma<Za.invariantNamespace.length;++Ma){var oa=Za.invariantNamespace.charAt(Ma);if("."!==oa&&"_"!==oa&&"a">oa&&"z"<oa&&"A">oa&&"Z"<oa&&"0">oa&&"9"<oa)throw F.ULS.sendTraceTag(537163552,0,10,"CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='"+oa+"', Position="+Ma+"."),Error.create("InvariantNamespace validation failed");
}return A(this.rUg(pa,Za.manifest),function(){return A(Ua.SGd(fa),function(ja){var ta=ja.result;return(null===ta||void 0===ta?0:ta.isDynamicMetadata)?Ua.VHd(fa,ra,ta,!1,!1,!1):A(Ua.HZj(fa,ra,Za),function(aa){var ma;ta=(ma=new e,ma.addinId=pa,ma.locale=Za.locale,ma.addinInvariantNamespace=Za.invariantNamespace,ma.addinNamespace=Za.namespace,ma.addinTitle=Za.title,ma.isXllCompatible=Za.isXllCompatible,ma.metadataContent=JSON.stringify(JSON.parse(aa.result)),ma);return Ua.VHd(fa,ra,ta,!1,a.wzh(Za.osfControl.getStoreType()),
ea.a(Ua.$,Za))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")};a.prototype.vaf=function(fa,ra,pa,Za){var Ua=this;if(!a.trd(pa))throw F.ULS.sendTraceTag(537163551,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),Error.create("Invalid Metadata JSON");return A(this.SGd(fa),
function(Ma){Ma=Ma.result;if(!Ma&&(Ma=xa.a.yc(Ua.sV,fa),!Ma))throw F.ULS.sendTraceTag(537163550,0,10,"CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId "+Telemetry.PrivacyRules.GetPrivacyCompliantId(fa,ra,null)+" hasn't been installed yet."),Error.create("Customfunctions dynamic registration failed");Ma.metadataContent=JSON.stringify(JSON.parse(pa));Ma.isDynamicMetadata=!0;return Ua.VHd(fa,ra,Ma,!0,!0,Za)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")};
a.prototype.Tbg=function(fa,ra){var pa=this;this.hj.Cia();var Za=Object(H.a)(new d,{solutionId:fa}),Ua="CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: "+Telemetry.PrivacyRules.GetPrivacyCompliantId(fa,ra,null)+".";return A(this.GId(fa),function(){return A(pa.NId(fa),function(){return pa.$Xd(pa.hj,fa,ra,Za)},"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed")},Ua)};a.prototype.HZj=function(fa,ra,pa){var Za=new S.a;OSF.OUtil.xhrGet(pa.metadataUrl,
function(Ua){Ua?Za.setResult(Ua):Za.setException(Error.create("Invalid manifest"))},function(Ua){F.ULS.sendTraceTag(537163548,0,10,"CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution "+Telemetry.PrivacyRules.GetPrivacyCompliantId(fa,ra,null)+". ErrorCode: "+Ua+".");Za.setException(Error.create("Failed to download manifest"))});return Za.task};a.prototype.Yld=function(){var fa=this;return A(this.Drc(),function(ra){var pa=ra.result;if(!pa.length)return ba.Task.Ua(!0);
F.ULS.sendTraceTag(537163547,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");ra=new N.a;for(var Za=[],Ua={},Ma=0;Ma<pa.length;Ua={xQb:Ua.xQb},Ma++)Ua.xQb=Object(T.a)(String,pa[Ma]),ra.add(l(fa.SGd(Ua.xQb),function(oa){return function(ja){if(ja=ja.result){var ta=xa.a.yc(fa.YE,ja.addinId);ta&&ta===ja.metadataContent||(fa.YE[ja.addinId]=ja.metadataContent,fa.sV[oa.xQb]=ja,Za.push(ja))}return!0}}(Ua),"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"));
return m(ba.Task.WhenAllEnumerable(ra),function(){if(Za.length){var oa,ja=(oa=new w,oa.registrationInfos=Za,oa);return fa.V0b(fa.hj,pa,ja)}F.ULS.sendTraceTag(537163546,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");return ba.Task.Ua(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},"CustomFunctionsInstaller::InstallFromCacheAsync failed")};a.prototype.waf=function(){var fa=this,ra=new S.a;
new N.a;var pa=[],Za=[];Object.keys(this.sV).forEach(function(Ua){Ua=Object(T.a)(String,Ua);var Ma=xa.a.yc(fa.sV,Ua);pa.push(Ma);Za.push(Ua)});if(!Za.length)return ra.setResult(!0),ra.task;ra=Object(H.a)(new w,{registrationInfos:pa});return this.V0b(this.hj,Za,ra)};a.prototype.Drc=function(){return l(this.ffd(U.a.WYa),function(fa){fa=fa.result;return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(fa||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(fa||"[]"):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")};
a.prototype.Fhg=function(fa){return this.ePd(U.a.WYa,Sys.Serialization.JavaScriptSerializer.serialize(fa))};a.prototype.SGd=function(fa){return A(this.ffd(U.a.l4a(fa)),function(ra){ra=ra.result||"";return 0<ra.length?ba.Task.Ua(Sys.Serialization.JavaScriptSerializer.deserialize(ra,!0)):ba.Task.Ua(null)},"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")};a.prototype.AZj=function(fa,ra){var pa=this;return A(this.GLe(fa),function(){return A(pa.ePd(U.a.l4a(fa),
Sys.Serialization.JavaScriptSerializer.serialize(ra)),function(){return a.fPd(U.a.Tid,"true")},"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed")},"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")};a.prototype.GId=function(fa){var ra=this;return A(this.iPf(fa),function(){return A(ra.BPf(U.a.l4a(fa)),function(){return A(ra.Drc(),function(pa){return pa.result.length?ba.Task.Ua(!0):a.fPd(U.a.Tid,
"false")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")};a.prototype.zMf=function(fa){return this.ffd(U.a.k4a(fa))};a.prototype.Chg=function(fa,ra){var pa=this;return A(this.GLe(fa),function(){return pa.ePd(U.a.k4a(fa),
ra)},"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")};a.prototype.NId=function(fa){var ra=this;return A(this.iPf(fa),function(){return ra.BPf(U.a.k4a(fa))},"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")};a.prototype.GLe=function(fa){var ra=this;return A(this.Drc(),function(pa){pa=pa.result;var Za=fa.toLowerCase();if(pa.includes(Za))return ba.Task.Ua(!0);pa.push(Za);return ra.Fhg(pa)},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")};
a.prototype.iPf=function(fa){var ra=this;return A(this.Drc(),function(pa){pa=pa.result;var Za=fa.toLowerCase();return pa.includes(Za)?(pa.splice(Array.indexOf(pa,Za),1),ra.Fhg(pa)):ba.Task.Ua(!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")};a.prototype.rUg=function(fa,ra){if(ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return fa=new OSF.AddinIdInfo(fa),fa.needToRestoreManifest()?this.Chg(fa.getSolutionId(),
ra):ba.Task.Ua(!0);fa=new D(fa);return fa.needToRestoreManifest?this.Chg(fa.solutionId,ra):ba.Task.Ua(!0)};a.prototype.Iij=function(fa){var ra=this;if(ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){var pa=new OSF.AddinIdInfo(fa);return pa.needToRestoreManifest()?l(this.zMf(pa.getSolutionId()),function(Ua){(Ua=Ua.result)&&OSF.OsfManifestManager.cacheManifestFromXml(pa.getSolutionId(),pa.getSolutionVersion(),Ua,ra.$.ya.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):
ba.Task.Ua(!0)}var Za=new D(fa);return Za.needToRestoreManifest?l(this.zMf(Za.solutionId),function(Ua){(Ua=Ua.result)&&OSF.OsfManifestManager.cacheManifestFromXml(Za.solutionId,Za.solutionVersion,Ua,ra.$.ya.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):ba.Task.Ua(!0)};a.prototype.BPf=function(fa){return this.Qwa?this.indexedDB.b6c(fa):a.bbj(fa)};a.prototype.ePd=function(fa,ra){return this.Qwa?this.indexedDB.qcb(new bb.a(fa,ra)):a.fPd(fa,
ra)};a.prototype.ffd=function(fa){return this.Qwa?this.indexedDB.f4a(fa):a.G_e(fa)};a.prototype.VHd=function(fa,ra,pa,Za,Ua,Ma){var oa=this,ja="CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: "+Telemetry.PrivacyRules.GetPrivacyCompliantId(fa,ra,null)+".";return O.TaskExtensions.wBc(l(this.WHd(this.hj,fa,ra,pa,!1,Za,Ma),function(){return Ua?oa.AZj(fa,pa):ba.Task.Ua(!0)},ja))};a.prototype.WHd=function(fa,ra,pa,Za,Ua,Ma,oa){var ja=this;if(!Ma&&(Ma=xa.a.yc(this.YE,
Za.addinId))&&Ma===Za.metadataContent)return ba.Task.Ua(!0);this.YE[Za.addinId]=Za.metadataContent;this.sV[ra]=Za;oa||fa.sIb(ra);fa.Cia();return A(this.B9i(ra,pa,Za),function(){return ja.BFd(Za.addinId,Ua)},"Failed to register functions for customfunction addin")};a.prototype.B9i=function(fa,ra,pa){var Za=this,Ua=new S.a,Ma=this.Cpb(pa);return this.Mia(function(oa){ha.EwaSettings.ma(257)&&k(a.nsb,fa);(oa=oa.Result)&&204===oa.ResponseStatusCode?Ua.setResult(!0):(delete Za.YE[pa.addinId],delete Za.sV[fa],
y(Za.GId(fa),function(){y(Za.NId(fa),function(){Za.G3f()},"Failed to show customfunctions installation error info")},"CustomFunctionsInstaller: Failed to register Custom Functions for solution: "+fa+". Received status code "+(oa?oa.ResponseStatusCode.toString():"Unknown")+"."),Ua.setResult(!1))},function(oa){oa=Q.a.xf(oa.data);F.ULS.sendTraceTag(537163544,0,10,"CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution "+Telemetry.PrivacyRules.GetPrivacyCompliantId(fa,
ra,null)+". Errors: "+Z.a.Cc(oa)+".");ha.EwaSettings.ma(257)&&k(a.msb,fa);delete Za.YE[pa.addinId];delete Za.sV[fa];Ua.setResult(!1)},Ma,Ua,!0)};a.prototype.V0b=function(fa,ra,pa){var Za=this,Ua=new S.a,Ma=ia.a.Ta.Wd.m;ra.forEach(function(ja){ja=Object(T.a)(String,ja);fa.Sxe(ja)});fa.Cia();var oa=this.NYc(pa);return this.Mia(function(ja){ha.EwaSettings.ma(257)&&k(a.nsb,Sys.Serialization.JavaScriptSerializer.serialize(ra));ja=ja.Result;var ta=!0,aa=Sys.Serialization.JavaScriptSerializer.deserialize(ja.ResponseBody.toString());
aa=Array.isArray(aa.value)?aa.value:null;for(var ma=new N.a,Ea={Wea:0};Ea.Wea<aa.length;Ea={Wea:Ea.Wea},Ea.Wea++)if(!aa[Ea.Wea]){ta=!1;var Ha="CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code "+ja.ResponseStatusCode+".";ma.add(A(Za.GId(ra[Ea.Wea]),function(Aa){return function(){delete Za.YE[pa.registrationInfos[Aa.Wea].addinId];delete Za.sV[ra[Aa.Wea]];return Za.NId(ra[Aa.Wea])}}(Ea),Ha))}f(ba.Task.WhenAllEnumerable(ma),function(){y(Za.BFd("",
!1),function(){F.ULS.sendTraceTag(537163542,0,50,"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes "+(ia.a.Ta.Wd.m-Ma)+" Millisecond.");ta?Ua.setResult(ta):f(Za.G3f(),function(){Ua.setResult(ta)},"Failed to show customfunctions installation error info")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},function(ja){ja=
Q.a.xf(ja.data);F.ULS.sendTraceTag(537163541,0,10,"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: "+Z.a.Cc(ja)+".");ha.EwaSettings.ma(257)&&k(a.msb,Sys.Serialization.JavaScriptSerializer.serialize(ra));for(ja=0;ja<pa.registrationInfos.length;ja++)delete Za.YE[pa.registrationInfos[ja].addinId],delete Za.sV[ra[ja]];Ua.setResult(!1)},oa,Ua,!0)};a.prototype.$Xd=function(fa,ra,pa,Za){var Ua=this;return A(this.LQj(fa,ra,pa,Za),function(){return Ua.BFd(Za.solutionId,
!1)},"Failed to unregister functions for customfunction addin")};a.prototype.LQj=function(fa,ra,pa,Za){var Ua=new S.a;fa.sIb(ra);(fa=xa.a.yc(this.sV,ra))&&delete this.YE[fa.addinId];delete this.sV[ra];Za=this.$Yc(Za);return this.Mia(function(){ha.EwaSettings.ma(257)&&k(a.b5c,ra);Ua.setResult(!0)},function(Ma){Ma=Q.a.xf(Ma.data);F.ULS.sendTraceTag(537163539,0,10,"CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution "+Telemetry.PrivacyRules.GetPrivacyCompliantId(ra,
pa,null)+". Errors: "+Z.a.Cc(Ma)+".");ha.EwaSettings.ma(257)&&k(a.a5c,ra);Ua.setResult(!1)},Za,Ua,!1)};a.prototype.Mia=function(fa,ra,pa,Za,Ua){function Ma(){function Ea(V,La,Ra){ha.EwaSettings.ma(257)&&k(Ua?a.$4c:a.c5c,Ha.RequestBody);return K.g(ja.va,"ExecuteRichApiRequest",pa,va.b(V,fa),va.a(La,ra),Ra,null,0)}if(oa.BHa()||0<ja.va.a4||0<ja.Fk.a4)return!1;ta&&oa.to(ta);aa&&ja.fs(aa);ma&&ja.Ez(ma);var Ha=pa.request,Aa=0;ha.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?
Ha.RequestFlags&1&&256!==(Ha.RequestFlags&256)||(Aa=16):Aa=Ha.RequestFlags&1?0:16;ha.EwaSettings.Zb()?oa.Rt(new I.a(507,0,Ea,Aa|64)):oa.Rt(new G.a(507,0,Ea,Aa));return!0}var oa=this.$.userOperationManager,ja=this.$.oa,ta=null,aa=null,ma=null;Ma()||(ta=function(){Ma()},aa=function(){Ma()},ma=function(){Ma()},oa.Br(ta),ja.Rq(aa),ja.Iy(ma));return Za.task};a.prototype.Cpb=function(fa){var ra={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};ra.RequestBody=JSON.stringify(fa);
ra.RequestFlags=1;ha.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(ra.RequestFlags|=256);fa=this.$.oa.va.Na(1);fa.request=ra;return fa};a.prototype.NYc=function(fa){var ra={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};ra.RequestBody=JSON.stringify(fa);ra.RequestFlags=1;ha.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(ra.RequestFlags|=256);fa=this.$.oa.va.Na(1);fa.request=ra;return fa};
a.prototype.$Yc=function(fa){var ra={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};ra.RequestBody=JSON.stringify(fa);ra.RequestFlags=1;ha.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(ra.RequestFlags|=256);fa=this.$.oa.va.Na(1);fa.request=ra;return fa};a.prototype.BFd=function(fa,ra){var pa=this,Za=L.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1);return u(Za,function(){Za.result.ZKd();return fa&&ra?pa.Iij(fa):ba.Task.Ua(!0)},
this.$.la,B.a.instance,"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")};a.prototype.G3f=function(){var fa=new da.a(1949669462,0,this.$.Jc,0,null);return this.$.Ka.Kb(fa)};a.G_e=function(fa){try{return ba.Task.Ua(localStorage.getItem(fa))}catch(ra){return F.ULS.sendTraceTag(537163537,0,50,"CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: "+(ra.message||"Unknown")),ba.Task.Ua(null)}};a.fPd=
function(fa,ra){try{return localStorage.setItem(fa,ra),ba.Task.Ua(!0)}catch(pa){return F.ULS.sendTraceTag(537163536,0,50,"CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: "+(pa.message||"Unknown")),ba.Task.Ua(!1)}};a.bbj=function(fa){try{return localStorage.removeItem(fa),ba.Task.Ua(!0)}catch(ra){return F.ULS.sendTraceTag(537163535,0,50,"CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: "+(ra.message||
"Unknown")),ba.Task.Ua(!1)}};a.wzh=function(fa){return ya.a.equals(fa,"registry",!0)||ya.a.equals(fa,"uploadfiledevcatalog",!0)||J.AFrameworkApplication.userNameUnknown||J.AFrameworkApplication.limitedEdit};a.trd=function(fa){if(!fa)return!1;try{JSON.parse(fa)}catch(ra){return!1}return!0};of.Object.defineProperties(a.prototype,{sV:{configurable:!0,enumerable:!0,get:function(){return this.hj.sV}}});a.eld="CustomFunctionCache";a.fld="CustomFunction";a.$4c=new c(2,"CustomFunctions [Registration] [Begin] SolutionId=");
a.nsb=new c(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");a.msb=new c(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");a.c5c=new c(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");a.b5c=new c(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");a.a5c=new c(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(t.a)(a,"CustomFunctionsInstaller",null,[844])},1407:function(t,E,b){function a(B){this.YE={};this.$=B;this.Yld().ina()}
function c(B,Q){this.TQc=B;this._message=Q}function d(){}function e(){}function h(B){switch(B){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}}function k(B,Q){if(b(1407).CustomFunctionsLegacyInstaller.Wvb("CustomFunctionsRuntimeLogging")&&window.console)switch(Q=h(B.severity)+" "+B.message+Q,B.severity){case 2:window.console.log&&window.console.log(Q);break;case 0:window.console.info&&window.console.info(Q);break;case 1:window.console.error&&window.console.error(Q)}}
function n(){}function f(B){B=B.split("|");this.$w=B[1];this.vRc=B[2];this.rUd=B[3]}b.r(E);t=b(0);var v=b(7),m=b(15),x=b(1154),l=b(162),u=b(85),A=b(572),z=b(177),y=b(62),w=b(50),D=b(37),H=b(121),F=b(600),J=b(1180);of.Object.defineProperties(f.prototype,{solutionId:{configurable:!0,enumerable:!0,get:function(){return this.$w}},solutionVersion:{configurable:!0,enumerable:!0,get:function(){return this.vRc}},needToRestoreManifest:{configurable:!0,enumerable:!0,get:function(){return this.rUd===OSF.StoreTypeEnum.Registry.toString()}}});
Object(t.a)(f,"AddinStoreInfo",null,[]);Object(t.a)(n,"CustomFunctionRegistrationInfos",null,[]);Object(t.a)(e,"InstallationInfo",null,[]);Object(t.a)(d,"UninstallationInfo",null,[]);var S=b(159),N=b(34),T=b(31),G=b(1),I=b(14),K=b(298),L=b(1084),O=b(58);of.Object.defineProperties(c.prototype,{severity:{configurable:!0,enumerable:!0,get:function(){return this.TQc}},message:{configurable:!0,enumerable:!0,get:function(){return this._message}}});Object(t.a)(c,"CustomFunctionLog",null,[]);b.d(E,"CustomFunctionsLegacyInstaller",
function(){return a});a.prototype.taf=function(B,Q,U,X){var P=this,ea=new l.a;if(X.invariantNamespace)for(Q=0;Q<X.invariantNamespace.length;++Q){var ia=X.invariantNamespace.charAt(Q);if("."!==ia&&"_"!==ia&&"a">ia&&"z"<ia&&"A">ia&&"Z"<ia&&"0">ia&&"9"<ia)return m.ULS.sendTraceTag(537163530,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='"+ia+"', Position="+Q+"."),ea.setResult(!1),ea.task}a.cacheManifest(U,X.manifest);var da=a.TGd(B);(null===da||void 0===
da?0:da.isDynamicMetadata)?this.UHd(B,da,ea,!1,!1):OSF.OUtil.xhrGet(X.metadataUrl,function(xa){da=Object(v.a)(new e,{addinId:U,locale:X.locale,addinInvariantNamespace:X.invariantNamespace,addinNamespace:X.namespace,addinTitle:X.title,isXllCompatible:X.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(xa))});P.UHd(B,da,ea,!1,J.a(P.$,X))},function(xa){m.ULS.sendTraceTag(537163528,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution "+B+
". ErrorCode: "+xa+".");ea.setResult(!1)});return ea.task};a.prototype.vaf=function(B,Q,U,X){Q=new l.a;if(!a.trd(U))return m.ULS.sendTraceTag(537163527,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),Q.setResult(!1),Q.task;var P=a.TGd(B);if(!P)return m.ULS.sendTraceTag(537163526,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),Q.setResult(!1),Q.task;P.metadataContent=JSON.stringify(JSON.parse(U));
P.isDynamicMetadata=!0;this.UHd(B,P,Q,!0,X);return Q.task};a.prototype.Tbg=function(B){var Q=this,U=new l.a,X=w.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);D.TaskExtensions.Aa(X,function(){var P=X.result;P.Cia();var ea=Object(v.a)(new d,{solutionId:B});a.HId(B);a.OId(B);D.TaskExtensions.Aa(Q.$Xd(P,B,ea),function(ia){S.b(ia)?U.setResult(ia.result):(ia.Of?m.ULS.sendTraceTag(537163524,0,10,"CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: "+
B+"."):ia.sh&&m.ULS.sendTraceTag(537163523,0,10,"CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: "+B+"."),U.setResult(!1))},Q.$.la,0)},this.$.la,3);return U.task};a.prototype.Yld=function(){var B=this,Q=new l.a,U=a.YGd();0<U.length&&m.ULS.sendTraceTag(537163522,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");var X=[];U.forEach(function(ea){ea=Object(u.a)(String,ea);if(ea=a.TGd(ea)){var ia=
N.a.yc(B.YE,ea.addinId);ia&&ia===ea.metadataContent||(B.YE[ea.addinId]=ea.metadataContent,X.push(ea))}});if(!X.length)return Q.setResult(!0),m.ULS.sendTraceTag(537163521,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),Q.task;var P=w.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);D.TaskExtensions.Aa(P,function(){var ea=P.result,ia=Object(v.a)(new n,{registrationInfos:X});D.TaskExtensions.Aa(B.V0b(ea,U,ia),function(da){S.b(da)?
Q.setResult(da.result):(da.Of?m.ULS.sendTraceTag(537163491,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):da.sh&&m.ULS.sendTraceTag(537163490,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),Q.setResult(!1))},B.$.la,0)},this.$.la,3);return Q.task};a.prototype.Hij=function(B){B=new f(B);if(B.needToRestoreManifest){var Q=a.V6i(B.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(B.solutionId,
B.solutionVersion,Q,this.$.ya.UICultureTag)}};a.prototype.UHd=function(B,Q,U,X,P){var ea=this,ia=w.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);D.TaskExtensions.Aa(ia,function(){D.TaskExtensions.Aa(ea.WHd(ia.result,B,Q,!1,X,P),function(da){S.b(da)?((da=da.result)&&a.BZj(B,Q),U.setResult(da)):(da.Of?m.ULS.sendTraceTag(537163488,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: "+B+"."):da.sh&&m.ULS.sendTraceTag(537163487,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: "+
B+"."),U.setResult(!1))},ea.$.la,0)},this.$.la,3)};a.prototype.WHd=function(B,Q,U,X,P,ea){var ia=this;if(!P&&(P=N.a.yc(this.YE,U.addinId))&&P===U.metadataContent)return O.Task.Ua(!0);this.YE[U.addinId]=U.metadataContent;var da=new l.a;ea||B.sIb(Q);B.Cia();B=this.Cpb(U);return this.Mia(function(xa){G.EwaSettings.ma(257)&&k(a.nsb,Q);var Z=xa.Result;204===Z.ResponseStatusCode?D.TaskExtensions.Aa(ia.AFd(da,U.addinId,X),function(ha){ha.Of?Q?m.ULS.sendTraceTag(537163485,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution "+
Q+"."):m.ULS.sendTraceTag(537163484,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId "+U.addinId+"."):ha.sh&&(Q?m.ULS.sendTraceTag(537163483,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution "+Q+"."):m.ULS.sendTraceTag(537163482,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId "+U.addinId+
"."));da.setResult(!1)},ia.$.la,4):(xa=function(){delete ia.YE[U.addinId];a.HId(Q);a.OId(Q);m.ULS.sendTraceTag(537163481,0,10,"CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: "+Q+". Received status code "+Z.ResponseStatusCode+".");da.setResult(!1)},xa=Object(v.a)(new L.a,{FLa:OSF.InfoType.Error,title:U.addinTitle,description:String.format(I.a.instance.mb(153),I.a.instance.ga(1879)),buttonText:I.a.instance.ga(4),Bha:xa,mec:!1,ria:xa,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),
x.a.PRd(xa))},function(xa){xa=H.a.xf(xa.data);m.ULS.sendTraceTag(537163480,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution "+Q+". Errors: "+T.a.Cc(xa)+".");G.EwaSettings.ma(257)&&k(a.msb,Q);delete ia.YE[U.addinId];da.setResult(!1)},B,da,!0)};a.prototype.V0b=function(B,Q,U){var X=this,P=new l.a;Q.forEach(function(ia){ia=Object(u.a)(String,ia);B.Sxe(ia)});B.Cia();var ea=this.NYc(U);return this.Mia(function(ia){G.EwaSettings.ma(257)&&
k(a.nsb,Sys.Serialization.JavaScriptSerializer.serialize(Q));ia=ia.Result;var da=!0,xa=Sys.Serialization.JavaScriptSerializer.deserialize(ia.ResponseBody.toString());xa=Array.isArray(xa.value)?xa.value:null;for(var Z=0;Z<xa.length;Z++)xa[Z]||(da=!1,delete X.YE[U.registrationInfos[Z].addinId],a.HId(Q[Z]),a.OId(Q[Z]),m.ULS.sendTraceTag(537163478,0,10,"CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: "+Q[Z]+". Received status code "+ia.ResponseStatusCode+"."));D.TaskExtensions.Aa(X.AFd(P,
"",!1),function(ha){ha.Of?m.ULS.sendTraceTag(537163477,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):ha.sh&&m.ULS.sendTraceTag(537163476,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");P.setResult(!1)},X.$.la,4);P.setResult(da)},function(ia){ia=H.a.xf(ia.data);m.ULS.sendTraceTag(537163475,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds "+
Sys.Serialization.JavaScriptSerializer.serialize(Q)+". Errors: "+T.a.Cc(ia)+".");G.EwaSettings.ma(257)&&k(a.msb,Sys.Serialization.JavaScriptSerializer.serialize(Q));ia=ik(U.registrationInfos);for(var da=ia.next();!da.done;da=ia.next())delete X.YE[da.value.addinId];P.setResult(!1)},ea,P,!0)};a.prototype.$Xd=function(B,Q,U){var X=this,P=new l.a;B.sIb(Q);B=this.$Yc(U);return this.Mia(function(){G.EwaSettings.ma(257)&&k(a.b5c,Q);D.TaskExtensions.Aa(X.AFd(P,U.solutionId,!1),function(ea){ea.Of?Q&&m.ULS.sendTraceTag(537163473,
0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution "+Q+"."):ea.sh&&Q&&m.ULS.sendTraceTag(537163472,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution "+Q+".");P.setResult(!1)},X.$.la,4)},function(ea){ea=H.a.xf(ea.data);m.ULS.sendTraceTag(537163471,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution "+
Q+". Errors: "+T.a.Cc(ea)+".");G.EwaSettings.ma(257)&&k(a.a5c,Q);P.setResult(!1)},B,P,!1)};a.prototype.Mia=function(B,Q,U,X,P){function ea(){function ya(ba,fa,ra){G.EwaSettings.ma(257)&&k(P?a.$4c:a.c5c,va.RequestBody);return y.g(da.va,"ExecuteRichApiRequest",U,K.b(ba,B),K.a(fa,Q),ra,null,0)}if(ia.BHa()||0<da.va.a4||0<da.Fk.a4)return!1;xa&&ia.to(xa);Z&&da.fs(Z);ha&&da.Ez(ha);var va=U.request,bb=va.RequestFlags&1?0:16;G.EwaSettings.Zb()?ia.Rt(new z.a(507,0,ya,bb|64)):ia.Rt(new A.a(507,0,ya,bb));return!0}
var ia=this.$.userOperationManager,da=this.$.oa,xa=null,Z=null,ha=null;ea()||(xa=function(){ea()},Z=function(){ea()},ha=function(){ea()},ia.Br(xa),da.Rq(Z),da.Iy(ha));return X.task};a.prototype.Cpb=function(B){var Q={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};Q.RequestBody=JSON.stringify(B);Q.RequestFlags=1;B=this.$.oa.va.Na(1);B.request=Q;return B};a.prototype.NYc=function(B){var Q={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};
Q.RequestBody=JSON.stringify(B);Q.RequestFlags=1;B=this.$.oa.va.Na(1);B.request=Q;return B};a.prototype.$Yc=function(B){var Q={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};Q.RequestBody=JSON.stringify(B);Q.RequestFlags=1;B=this.$.oa.va.Na(1);B.request=Q;return B};a.prototype.AFd=function(B,Q,U){var X=this,P=w.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1);D.TaskExtensions.Aa(P,function(){P.result.ZKd();Q&&U&&X.Hij(Q);B.setResult(!0)},this.$.la,3);return P};
a.prototype.waf=function(){return O.Task.Ua(!0)};a.YGd=function(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(a.Wvb(F.a.WYa)||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(a.Wvb(F.a.WYa)||"[]"):null)||[]};a.Ghg=function(B){a.gPd(F.a.WYa,Sys.Serialization.JavaScriptSerializer.serialize(B))};a.TGd=function(B){B=a.Wvb(F.a.l4a(B))||"";return 0<B.length?Sys.Serialization.JavaScriptSerializer.deserialize(B,!0):null};a.BZj=function(B,Q){a.FLe(B);a.gPd(F.a.l4a(B),Sys.Serialization.JavaScriptSerializer.serialize(Q))};
a.HId=function(B){a.hPf(B);a.CPf(F.a.l4a(B))};a.V6i=function(B){return a.Wvb(F.a.k4a(B))};a.CZj=function(B,Q){a.FLe(B);a.gPd(F.a.k4a(B),Q)};a.OId=function(B){a.hPf(B);a.CPf(F.a.k4a(B))};a.FLe=function(B){var Q=a.YGd();B=B.toLowerCase();Q.includes(B)||(Q.push(B),a.Ghg(Q))};a.hPf=function(B){var Q=a.YGd();B=B.toLowerCase();Q.includes(B)&&(Q.splice(Array.indexOf(Q,B),1),a.Ghg(Q))};a.cacheManifest=function(B,Q){B=new f(B);B.needToRestoreManifest&&a.CZj(B.solutionId,Q)};a.Wvb=function(B){try{return localStorage.getItem(B)}catch(Q){return m.ULS.sendTraceTag(537163469,
0,50,"CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: "+(Q.message||"Unknown")),null}};a.gPd=function(B,Q){try{localStorage.setItem(B,Q)}catch(U){m.ULS.sendTraceTag(537163468,0,50,"CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: "+(U.message||"Unknown"))}};a.CPf=function(B){try{localStorage.removeItem(B)}catch(Q){m.ULS.sendTraceTag(537163467,0,50,"CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: "+
(Q.message||"Unknown"))}};a.trd=function(B){if(!B)return!1;try{JSON.parse(B)}catch(Q){return!1}return!0};a.$4c=new c(2,"CustomFunctions [Registration] [Begin] SolutionId=");a.nsb=new c(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");a.msb=new c(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");a.c5c=new c(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");a.b5c=new c(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");a.a5c=new c(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");
Object(t.a)(a,"CustomFunctionsLegacyInstaller",null,[844])},1447:function(t,E,b){function a(J,S,N,T,G){this.$=J;this.se=S;this.ownerAddinInfo=N;this.Ed=void 0===G?null:G;this.LQa=(void 0===T?null:T)||H.Task.Ua(!0);return this}function c(J){var S=D.call(this)||this;S.fDa="AddInCommandsDialog";S.ye=S.fDa;S.Rb=5;S.dialogWidth=695;S.dialogHeight=438;S.c3g="100%";S.$2g="408px";S.a3g="15px";S.b3g="0";S.mug=J;return S}function d(J,S,N,T,G,I){var K=J.Na(9);K.sharedInfo=S;return m.g(J,"InsertAgaveTaskpane",
K,N,T,G,I,0)}function e(){}t=b(0);var h=b(205),k=b(15);Object(t.a)(e,"AddinCommandsHost",null,[]);var n=b(1528),f=b(1605),v=b(1082),m=b(62),x=b(572),l=b(394),u=b(177),A=b(37),z=b(1),y=b(298),w=b(150),D=w.a;$k(c,D);c.prototype.bD=function(){D.prototype.bD.call(this);this.np.style.width=this.c3g;this.np.style.height=this.$2g;this.np.style.marginTop=this.a3g;this.np.style.padding=this.b3g};c.prototype.lO=function(){D.prototype.lO.call(this);this.Db.style.width=String.format("{0}px",this.dialogWidth);
this.Db.style.height=String.format("{0}px",this.dialogHeight)};c.prototype.dispose=function(){D.prototype.dispose.call(this);this.mug()};of.Object.defineProperties(c.prototype,{containerDiv:{configurable:!0,enumerable:!0,get:function(){return this.np}}});Object(t.a)(c,"AddInCommandsDialog",w.a,[]);var H=b(58),F=b(63);w=b(100);b.d(E,"a",function(){return a});$k(a,e);a.prototype.V2g=function(){var J=this.LQa;this.LQa=H.Task.Ua(!0);return J};a.prototype.disposeHost=function(J){this.se.nQa(J)};a.prototype.setOwnerAddinEToken=
function(J){this.ownerAddinInfo.eToken=J};a.prototype.showTaskpane=function(J,S,N){var T=this;k.ULS.sendTraceTag(537170642,220,50,"ShowTaskpane action called.");var G=null,I=!1,K=(new n.a("m_excelWebRenderer_ewaCtl_",this.ownerAddinInfo.solutionId,new v.a,!0)).XFe(J.solutionId.substr(this.ownerAddinInfo.solutionId.length));G=S.getSharedRuntimeForTaskpane("Workbook",K);I=!!G&&1===G.LifeTime;this.se.Vxe(I?this.ownerAddinInfo.solutionId:J.solutionId,I?G:null,null)||(this.Tmf(I,!0),this.LQa=this.Wld(J,
G,function(L,O){L?(I&&(L.PrimaryMarketplace.SolutionId=T.ownerAddinInfo.solutionId,L.SharedRuntime=G),L.WebExtensionOsfControlType=3,T.se.P0a(L),N(L.InstanceId,O),T.Tmf(I,!1),z.EwaSettings.isChangeGateEnabled("OfficeVSO:6085876_TelemetryForActiveAddinSuccessOnExcelWacEnabled")&&k.ULS.sendTraceTag(524818146,220,50,"ShowTaskpane: succeed to call.")):(k.ULS.sendTraceTag(17306640,220,10,"ShowTaskpane: instance id is null."),N(null,O))}))};a.prototype.getSettings=function(J,S){var N=this.se.Gaa(J.solutionId);
N?S(this.se.pZ(N).OsfPropertyBag):this.LQa=this.Wld(J,null,function(T){T?S(T.OsfPropertyBag):k.ULS.sendTraceTag(537170641,220,10,"GetSettings: insertData is null.")})};a.prototype.showDialog=function(J,S,N){function T(O,B,Q){return d(K,L,y.b(O,G),B,Q,null)}function G(O){var B=O.Result,Q=B?B.AgaveData:null;Q?(I.se.QEe(Q,function(){var U=new c(function(){I.disposeHost(Q.InstanceId)});U.initializeAndShow("",null,null);return U.containerDiv}),N(Q.InstanceId,0)):(k.ULS.sendTraceTag(537170638,220,10,"ShowDialog: instance id is null."),
N(null,O.Errors?O.Errors[0].ErrorCause:5001))}var I=this;k.ULS.sendTraceTag(537170640,220,50,"ShowDialog action called.");var K=this.$.oa.va,L=a.Urb(J,this.ownerAddinInfo);z.EwaSettings.Zb()?this.LQa=l.a(this.$.userOperationManager,T,function(O){return new u.a(500,0,O,64)},this.Ed):this.LQa=l.a(this.$.userOperationManager,T,function(O){return new x.a(500,0,O)},this.Ed)};a.prototype.createUILessSandbox=function(J,S,N){var T=this;k.ULS.sendTraceTag(537170637,220,50,"UILess action called.");var G=S.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),
I=!!G&&1===G.LifeTime;(S=this.se.fCh(I?this.ownerAddinInfo.solutionId:J.solutionId,I?G:null))?N(S,0):this.LQa=this.Wld(J,G,function(K,L){K?(I?(K.PrimaryMarketplace.SolutionId=T.ownerAddinInfo.solutionId,K.SharedRuntime=G,K.TaskpaneVisible=!1,K.WebExtensionOsfControlType=3,T.se.P0a(K)):(K.WebExtensionOsfControlType=4,T.se.QEe(K,function(){a.gfb.ia(K.InstanceId,new f.a);return a.gfb.na(K.InstanceId).B1a})),N(K.InstanceId,L)):(k.ULS.sendTraceTag(537170636,220,10,"UILess: instance id is null."),N(null,
L))})};a.prototype.Wld=function(J,S,N){function T(X,P,ea){return d(L,O,y.b(X,G),P,ea,null)}function G(X){var P=X.Result;(K=P?P.AgaveData:null)||N(null,X.Errors?X.Errors[0].ErrorCause:5001)}var I=this,K=null,L=this.$.oa.va,O=a.Urb(J,this.ownerAddinInfo);S&&(k.ULS.sendTraceTag(537170634,220,50,"Shared runtime agave is inserted."),O.SharedRuntimeId=S.Resid);var B=500,Q=0;void 0===O.IsToBePersisted||null===O.IsToBePersisted||O.IsToBePersisted||(B=538,T=function(X,P,ea){k.ULS.sendTraceTag(537170633,220,
50,"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(I.ownerAddinInfo.solutionId,I.ownerAddinInfo.storeType,I.ownerAddinInfo.assetId,null,null,I.ownerAddinInfo.storeId));X=y.b(X,G);var ia=L.Na(9,null);ia.sharedInfo=O;return m.g(L,"ShowAgaveTaskpane",ia,X,P,ea,null,0)},Q=16);if(z.EwaSettings.Zb()){Q|=64;var U=l.a(this.$.userOperationManager,T,function(X){return new u.a(B,0,X,Q)},this.Ed)}else U=l.a(this.$.userOperationManager,
T,function(X){return new x.a(B,0,X,Q)},this.Ed);return A.TaskExtensions.ts(U,function(){return K?I.Htd(L,K.InstanceId,function(X,P){if(X){S||(K.PrimaryMarketplace.MarketplaceType=J.storeType);K.OwnerAddinSolutionId=I.ownerAddinInfo.solutionId;K.OwnerAddinStoreType=I.ownerAddinInfo.storeType;K.OsfPropertyBag=[];for(P=0;P<X.Settings.length;P++){var ea=[];ea[0]=X.Settings[P].Name;ea[1]=X.Settings[P].Value;K.OsfPropertyBag[P]=ea}N(K,0)}else N(null,P.Errors?P.Errors[0].ErrorCause:5001)}):H.Task.Ua(!1)},
h.a.none,3,F.a.current)};a.prototype.Htd=function(J,S,N){function T(I,K,L){I=y.b(I,G);var O=J.Na(1);O.controlId=S;return m.g(J,"DdaLoadSettings",O,I,K,L,null,0)}function G(I){N(I.Result,I)}return z.EwaSettings.Zb()?l.a(this.$.userOperationManager,T,function(I){return new u.a(501,0,I,80)},this.Ed):l.a(this.$.userOperationManager,T,function(I){return new x.a(501,0,I,16)},this.Ed)};a.prototype.Tmf=function(J,S){var N;J&&(null===(N=window.performance)||void 0===N?0:N.memory)&&k.ULS.sendTraceTag(537170630,
220,50,"Shared runtime memory usage: before="+S+", jsHeapSizeLimit="+window.performance.memory.jsHeapSizeLimit+", totalJSHeapSize="+window.performance.memory.totalJSHeapSize+", usedJSHeapSize="+window.performance.memory.usedJSHeapSize)};a.showUILessDialog=function(J){a.gfb.kb(J)&&a.gfb.na(J).initializeAndShowWithTitle()};a.hideUILessDialog=function(J){a.gfb.kb(J)&&a.gfb.na(J).hide()};a.Urb=function(J,S){var N={};N.SolutionId=J.solutionId;N.Version=J.version;N.StoreType=S.storeType;N.StoreId=J.storeId;
N.AssetId=J.solutionId;N.AssetStoreId="omex";N.TargetType=1;N.Width=350;N.OwnerAddinSolutionId=S.solutionId;N.OwnerAddinStoreType=S.storeType;N.SharedRuntimeId=null;N.Preload=!1;return N};a.gfb=new w.a;Object(t.a)(a,"WACExcelAddinCommandsHost",e,[])},1453:function(t,E,b){function a(){e.a.Fa(function(y){c.ka(y)})}function c(y){return z.call(this,y)||this}function d(y,w,D){this.qsb=null;this.$=y;w?(k.ULS.sendTraceTag(537163346,0,50,"DataFromPictureCommandHandler.constructor - AugmentationLoopManager and UploaderCreator instantiated."),
this.qsb=new v.a(y,w,D)):k.ULS.sendTraceTag(537163347,0,10,"DataFromPictureCommandHandler.constructor - Failed to instantiate AugmentationLoopManager.")}var e=b(10);t=b(0);var h=b(915),k=b(15),n=b(104),f=b(4),v=b(1520),m=b(1),x=b(187),l=b(58);d.prototype.Nc=function(){return!1};d.prototype.executeCommand=function(y,w,D){y=!1;switch(w.command){case 73979048:this.qsb&&this.qsb.Y0i(w,n.a.instance,f.AFrameworkApplication.fa,D),y=!0}return y?l.Task.Ua(!0):x.a(w.command)};d.prototype.Ac=function(y,w){return 73979048===
w.command&&m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)};d.prototype.Tc=function(){return!1};d.prototype.dispose=function(){this.qsb&&this.qsb.dispose()};Object(t.a)(d,"DataFromPictureCommandHandler",null,[401,6]);var u=b(37),A=b(50),z=h.a;$k(c,z);c.prototype.zd=function(){var y=this,w=A.GetServiceTaskFactory.Ra(this.$.da,328,327,1),D=A.GetServiceTaskFactory.Ra(this.$.da,484,485,1);u.TaskExtensions.Aa(u.TaskExtensions.Vd([w,D],this.$.la),function(){y.jd([new d(y.$,
w.result,D.result)])},this.$.la,3)};c.ka=function(y){h.a.Pd(452,new c(y))};Object(t.a)(c,"DataFromPictureCommandHandlerFactory",h.a,[]);b.d(E,"a",function(){return a})},1480:function(t,E,b){function a(){Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=c.a}var c=b(1173);b.d(E,"a",function(){return a})},1512:function(t,E,b){function a(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=
this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}b.d(E,"a",function(){return a});t=b(0);a.KJh=function(c){switch(c){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}};Object(t.a)(a,"WopiAuthContext",null,[279])},1513:function(t,E,b){function a(){}b.d(E,"a",function(){return a});t=b(0);a.WEf="OneDriveWOPI";Object(t.a)(a,"HostApplicationType",null,[])},1514:function(t,
E,b){function a(c,d,e,h){this._id=c;this.Xxg=d;this.Bhe=e;this.RUa=h}b.d(E,"a",function(){return a});t=b(0);a.prototype.getId=function(){return this._id};a.prototype.getStoreId=function(){return this.Xxg};a.prototype.getStoreType=function(){return this.Bhe};Object(t.a)(a,"ExtensionIdentity",null,[163])},1515:function(t,E,b){function a(c,d,e){this.xae=e}b.d(E,"a",function(){return a});t=b(0);Object(t.a)(a,"HostProperties",null,[])},1516:function(t,E,b){function a(){this.optionalProperties={};this.lq=
{}}b.d(E,"a",function(){return a});t=b(0);Object(t.a)(a,"ExtensionLaunchProperties",null,[])},1517:function(t,E,b){function a(){this.La=n.AFrameworkApplication.ub}b.d(E,"a",function(){return a});t=b(0);var c=b(1514),d=b(1516),e=b(1178),h=b(1519),k=b(1515),n=b(4),f=b(644),v=b(25);a.prototype.sNa=function(m,x,l,u,A){this.ssi(m,x,l,u,A)};a.prototype.ssi=function(m,x,l,u,A){var z=b(1518).ExtensionComponentInstance,y={};y[e.a.w9b]=m;y[e.a.dBe]=x;y[e.a.vHa]=l;y[e.a.gkd]=u;y[e.a.Xya]=A;u=8;if(n.AFrameworkApplication.uqd(m.getId()))switch(x){case h.a.action:u=
this.La.$d(v.a.mRe,2,y);break;case h.a.taskpane:u=this.La.$d(v.a.O3f,2,y);break;case h.a.umj:u=this.La.$d(v.a.Lsi,2,y);break;default:u=16}32===u?(u=f.a.create().toString(),A.optionalProperties.InstanceToken&&(u=A.optionalProperties.InstanceToken),m=new z(m,x,l,u),a.Dv[u]=m):m=new z(m,x,l,null);m.Jpj(y)};a.prototype.rsi=function(m){var x=m.ExtId,l=m.ComponentType,u=m.ComponentId,A=m.HostProps;m=m.OptionalProps;x=new c.a(x.Id,x.StoreId,x.StoreType,x.AppVersion);A=new k.a(A.HostType,A.FormFactor,A.Locale);
var z=new d.a;z.optionalProperties=m.OptionalProperties;z.lq=m.DevProperties;a.instance.sNa(x,l,u,A,z)};a.prototype.getInstance=function(m){return a.Dv[m]};a.prototype.Yaj=function(m){delete a.Dv[m]};of.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){a.nIc||(a.nIc=new a);return a.nIc}}});a.nIc=null;a.Dv={};Object(t.a)(a,"ExtensionLifeCycleManager",null,[124])},1518:function(t,E,b){function a(h,k,n,f){this.RUa=this.dG=null;this._id=h;this.Ang=n;this.zrg=f;this.La=
d.AFrameworkApplication.ub?d.AFrameworkApplication.ub:null}b.r(E);b.d(E,"ExtensionComponentInstance",function(){return a});t=b(0);var c=b(1517),d=b(4),e=b(25);a.prototype.udd=function(){return this.Ang};a.prototype.Jpj=function(h){this.dG=h};a.prototype.stop=function(){var h=this.La.$d(e.a.B_g,2,this.dG);c.a.instance.Yaj(this.zrg);return 32===h};a.prototype.buc=function(){this.La.$d(e.a.bUf,2,this.dG)};of.Object.defineProperties(a.prototype,{appVersion:{configurable:!0,enumerable:!0,get:function(){return this.RUa}}});
Object(t.a)(a,"ExtensionComponentInstance",null,[157])},1519:function(t,E,b){function a(){}b.d(E,"a",function(){return a});t=b(0);a.taskpane="Taskpane";a.action="Action";a.umj="SDXDialog";Object(t.a)(a,"ComponentTypeNames",null,[])},1520:function(t,E,b){(function(a){function c(F,J,S){var N=H.call(this)||this;N.I9e=n.a.getTypeName();N.Ed=null;N.iU=null;N.dyb=null;N.imageWidth=0;N.imageHeight=0;N.tableData=null;N.errorMessage=null;N.CLa=null;N.nkd=0;N.tTc=!1;N.eGe=function(T){if(T){var G={};if(function(){var Q=
w.d(N.xdh(T.data));G=Q.Ot;return Q}().returnValue){var I=Object(k.a)(Object,G);if("."===I.DataFromPictureWildcard)if(I.SessionId!==N.CLa)e.ULS.sendTraceTag(523805139,0,10,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(e.ULS.sendTraceTag(523805138,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane"),I.CmdType){case "ACK":N.tTc=!0;N.Z8f.stop();
e.ULS.sendTraceTag(523805137,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - SDX pane launched.");N.moj();0<N.errorMessage.length?N.VXf():0<N.tableData.length&&N.lYf();break;case "insert_html":var K=N.$.oa.va,L={},O=y.g(N.$).ha.sa.Vc.clone();L.PasteId=h.a.create().toString();L.DestinationRanges=m.s(m.v(O,N.$));O=I.Parameters.split("|",3);e.ULS.sendTraceTag(523805136,0,50,"DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - LCC:"+O[0]+"|"+O[1]+"|"+O[2]+".");
O=I.Parameters.indexOf("|");O=I.Parameters.indexOf("|",O+1);O=I.Parameters.indexOf("|",O+1);L.SourceHtml=I.Parameters.substring(O+1);L.CopyOperationId=null;var B=K.Na(1,K.Pb());B.pasteHtmlParameters=L;x.a(N.$.userOperationManager,function(Q,U,X){return u.g(K,"pasteHtmlContent",B,Q,U,X,null,64)},function(Q){return new l.a(204,0,Q,1)},null);N.nkd++;e.ULS.sendTraceTag(523805135,0,50,"DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - Number of pastes to workbook per Session ID:"+N.nkd.toString())}}}};
N.v9h=function(T,G){if(T=G.jJ)if(!G.parentPath||1>=G.parentPath.length||G.parentPath[1]!==N.CLa)e.ULS.sendTraceTag(523805124,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");else{e.ULS.sendTraceTag(523805123,0,50,"DataFromPictureManager.ImageToTableAnnotationHandler() - Annotation Received.");G=T.errorCode;switch(G){case null:case -1:N.errorMessage=z.a.instance.ga(2250);break;case 1:N.errorMessage=z.a.instance.ga(2251);
break;case 2:N.errorMessage=z.a.instance.ga(2252)}0<N.errorMessage.length&&e.ULS.sendTraceTag(523805122,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - ErrorCode:"+(G?G.toString():"null")+".");N.$pe.stop();N.tableData=T.html;N.tTc&&(0<N.errorMessage.length?N.VXf():0<N.tableData.length&&N.lYf())}else e.ULS.sendTraceTag(523805125,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - Received annotation is null.")};N.$=F;N.augmentationLoopManager=J;N.uploaderCreator=S;N.initialize();
return N}b.d(E,"a",function(){return c});var d=b(0),e=b(15),h=b(178),k=b(85),n=b(1525),f=b(38),v=b(260),m=b(41),x=b(394),l=b(177),u=b(62),A=b(91),z=b(14),y=b(21),w=b(42),D=b(1526),H=f.a;$k(c,H);c.prototype.dispose=function(){window.removeEventListener("message",this.eGe,!1);H.prototype.dispose.call(this)};c.prototype.PTi=function(F,J){var S=this;e.ULS.sendTraceTag(523805146,0,50,"DataFromPictureManager.onSuccessfulFileLoad - Start function.");var N=new Image;N.onload=function(){var T=document.createElement("canvas");
T.width=N.width;T.height=N.height;var G=T.getContext("2d");try{G.drawImage(N,0,0,N.width,N.height)}catch(L){e.ULS.sendTraceTag(523805145,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't draw to canvas. ex.Message: "+L.message);return}try{var I=T.toDataURL("image/jpeg")}catch(L){e.ULS.sendTraceTag(523805144,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg. ex.Message: "+L.message);return}T=I.split(",");if(2>T.length)e.ULS.sendTraceTag(523805143,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg.");
else{T=T[1];try{var K=window.self.atob(T)}catch(L){e.ULS.sendTraceTag(523805142,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't convert image to byte string. ex.Message: "+L.message);return}28E5<K.length?(e.ULS.sendTraceTag(523805141,0,15,"DataFromPictureManager.onSuccessfulFileLoad - Image exceeds max size limit."),J.hBj()):(S.ukj(S.Ed,S.iU,T,N.width,N.height),URL.revokeObjectURL(N.src),N=null,e.ULS.sendTraceTag(523805140,0,50,"DataFromPictureManager.onSuccessfulFileLoad - End function."))}};
N.src=F};c.prototype.Y0i=function(F,J,S,N){this.Ed=F;this.iU=N;this.uploaderCreator.abi(this.$,J,S,N,this)};c.prototype.ukj=function(F,J,S,N,T){this.CLa=h.a.create().toString();this.nkd=0;this.dyb=S;this.imageWidth=N;this.imageHeight=T;this.errorMessage=this.tableData="";this.tTc=!1;this.Z8f=this.$.Fb.Mg("LoadResource","DataFromPictureTaskpaneLaunch");this.Z8f.start();this.sWi(F,J);this.$pe=this.$.Fb.Mg("LoadResource","DataFromPictureAnnotation");this.$pe.start();this.SVj()};c.prototype.SVj=function(){if(this.dyb.length){var F=
window.self.atob(this.dyb);for(var J=new Uint8Array(F.length),S=0;S<F.length;S++)J[S]=F.charCodeAt(S);this.augmentationLoopManager.RVj(J,this.CLa,this.imageWidth,this.imageHeight)}else e.ULS.sendTraceTag(523805134,0,10,"DataFromPictureManager.UploadImageToAugmentationLoop - imageDataBase64 is empty")};c.prototype.sWi=function(F,J){J.SessionID=this.CLa;J.DataFromPictureAssetId="FA000000050";J.LoadDataFromPictureTaskpane=!0;F=new A.a(-859308420,F.method,F.mode,F.Ne,F.tabName);this.$.Ka.Kb(F,J)};c.prototype.W7c=
function(F){try{var J=a.from(F,"utf16le").toString("base64");return D.a.IHa(this.CLa,J)}catch(S){return e.ULS.sendTraceTag(523805133,0,10,"DataFromPictureManager.encodeAndEncrypt - Buffer can't encode message."),""}};c.prototype.xdh=function(F){try{var J=D.a.IHa(this.CLa,F);return a.from(J,"base64").toString("utf16le")}catch(S){return e.ULS.sendTraceTag(523805132,0,50,"DataFromPictureManager.decryptAndDecode - Buffer can't decode message."),""}};c.prototype.moj=function(){if(this.dyb.length){var F=
v.a(this.$).Gaa("FA000000050"),J={};J=(J.DataFromPictureWildcard=".",J);J.imageData=this.W7c(this.dyb);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(F,"onCustomMessage",J,function(S){S&&e.ULS.sendTraceTag(523805130,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else e.ULS.sendTraceTag(523805131,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")};c.prototype.lYf=function(){if(this.tableData.length){var F=
v.a(this.$).Gaa("FA000000050"),J={};J=(J.DataFromPictureWildcard=".",J);J.tableHtml=this.W7c(this.tableData);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(F,"onCustomMessage",J,function(S){S&&e.ULS.sendTraceTag(523805128,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else e.ULS.sendTraceTag(523805129,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")};c.prototype.VXf=
function(){if(this.errorMessage.length){var F=v.a(this.$).Gaa("FA000000050"),J={};J=(J.DataFromPictureWildcard=".",J);J.errorMessage=this.W7c(this.errorMessage);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(F,"onCustomMessage",J,function(S){S&&e.ULS.sendTraceTag(523805126,0,10,"DataFromPictureManager.sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else e.ULS.sendTraceTag(523805127,0,10,"DataFromPictureManager.sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")};
c.prototype.initialize=function(){window.addEventListener("message",this.eGe,!1);this.augmentationLoopManager.activateAnnotation(this.I9e);this.augmentationLoopManager.dJ(this.I9e,this.v9h)};Object(d.a)(c,"DataFromPictureManager",f.a,[713])}).call(this,b(1521).tig)},1521:function(t,E,b){(function(a){function c(){try{var T=new Uint8Array(1);T.__proto__={__proto__:Uint8Array.prototype,ubd:function(){return 42}};return 42===T.ubd()&&"function"===typeof T.subarray&&0===T.subarray(1,1).byteLength}catch(G){return!1}}
function d(T,G){if((e.TO?2147483647:1073741823)<G)throw new RangeError("Invalid typed array length");e.TO?(T=new Uint8Array(G),T.__proto__=e.prototype):(null===T&&(T=new e(G)),T.length=G);return T}function e(T,G,I){if(!(e.TO||this instanceof e))return new e(T,G,I);if("number"===typeof T){if("string"===typeof G)throw Error("If encoding is specified then the first argument must be a string");return n(this,T)}return h(this,T,G,I)}function h(T,G,I,K){if("number"===typeof G)throw new TypeError('"value" argument must not be a number');
if("undefined"!==typeof ArrayBuffer&&G instanceof ArrayBuffer){G.byteLength;if(0>I||G.byteLength<I)throw new RangeError("'offset' is out of bounds");if(G.byteLength<I+(K||0))throw new RangeError("'length' is out of bounds");G=void 0===I&&void 0===K?new Uint8Array(G):void 0===K?new Uint8Array(G,I):new Uint8Array(G,I,K);e.TO?(T=G,T.__proto__=e.prototype):T=f(T,G);G=T}else if("string"===typeof G){K=T;T=I;if("string"!==typeof T||""===T)T="utf8";if(!e.Ycf(T))throw new TypeError('"encoding" must be a valid string encoding');
I=x(G,T)|0;K=d(K,I);G=K.write(G,T);G!==I&&(K=K.slice(0,G));G=K}else G=v(T,G);return G}function k(T){if("number"!==typeof T)throw new TypeError('"size" argument must be a number');if(0>T)throw new RangeError('"size" argument must not be negative');}function n(T,G){k(G);T=d(T,0>G?0:m(G)|0);if(!e.TO)for(var I=0;I<G;++I)T[I]=0;return T}function f(T,G){var I=0>G.length?0:m(G.length)|0;T=d(T,I);for(var K=0;K<I;K+=1)T[K]=G[K]&255;return T}function v(T,G){if(e.isBuffer(G)){var I=m(G.length)|0;T=d(T,I);if(0===
T.length)return T;G.copy(T,0,0,I);return T}if(G){if("undefined"!==typeof ArrayBuffer&&G.buffer instanceof ArrayBuffer||"length"in G)return(I="number"!==typeof G.length)||(I=G.length,I=I!==I),I?d(T,0):f(T,G);if("Buffer"===G.type&&J(G.data))return f(T,G.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function m(T){if(T>=(e.TO?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(e.TO?2147483647:
1073741823).toString(16)+" bytes");return T|0}function x(T,G){if(e.isBuffer(T))return T.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(T)||T instanceof ArrayBuffer))return T.byteLength;"string"!==typeof T&&(T=""+T);var I=T.length;if(0===I)return 0;for(var K=!1;;)switch(G){case "ascii":case "latin1":case "binary":return I;case "utf8":case "utf-8":case void 0:return y(T).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*
I;case "hex":return I>>>1;case "base64":return D(T).length;default:if(K)return y(T).length;G=(""+G).toLowerCase();K=!0}}function l(T,G,I){var K=!1;if(void 0===G||0>G)G=0;if(G>this.length)return"";if(void 0===I||I>this.length)I=this.length;if(0>=I)return"";I>>>=0;G>>>=0;if(I<=G)return"";for(T||(T="utf8");;)switch(T){case "hex":T=G;G=I;I=this.length;if(!T||0>T)T=0;if(!G||0>G||G>I)G=I;K="";for(I=T;I<G;++I)T=K,K=this[I],K=16>K?"0"+K.toString(16):K.toString(16),K=T+K;return K;case "utf8":case "utf-8":return z(this,
G,I);case "ascii":T="";for(I=Math.min(this.length,I);G<I;++G)T+=String.fromCharCode(this[G]&127);return T;case "latin1":case "binary":T="";for(I=Math.min(this.length,I);G<I;++G)T+=String.fromCharCode(this[G]);return T;case "base64":return 0===G&&I===this.length?F.nVe(this):F.nVe(this.slice(G,I));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":G=this.slice(G,I);I="";for(T=0;T<G.length;T+=2)I+=String.fromCharCode(G[T]+256*G[T+1]);return I;default:if(K)throw new TypeError("Unknown encoding: "+
T);T=(T+"").toLowerCase();K=!0}}function u(T,G,I,K,L){if(0===T.length)return-1;"string"===typeof I?(K=I,I=0):2147483647<I?I=2147483647:-2147483648>I&&(I=-2147483648);I=+I;isNaN(I)&&(I=L?0:T.length-1);0>I&&(I=T.length+I);if(I>=T.length){if(L)return-1;I=T.length-1}else if(0>I)if(L)I=0;else return-1;"string"===typeof G&&(G=e.from(G,K));if(e.isBuffer(G))return 0===G.length?-1:A(T,G,I,K,L);if("number"===typeof G)return G&=255,e.TO&&"function"===typeof Uint8Array.prototype.indexOf?L?Uint8Array.prototype.indexOf.call(T,
G,I):Uint8Array.prototype.lastIndexOf.call(T,G,I):A(T,[G],I,K,L);throw new TypeError("val must be string, number or Buffer");}function A(T,G,I,K,L){function O(X,P){return 1===B?X[P]:X.g7i(P*B)}var B=1,Q=T.length,U=G.length;if(void 0!==K&&(K=String(K).toLowerCase(),"ucs2"===K||"ucs-2"===K||"utf16le"===K||"utf-16le"===K)){if(2>T.length||2>G.length)return-1;B=2;Q/=2;U/=2;I/=2}if(L)for(K=-1;I<Q;I++)if(O(T,I)===O(G,-1===K?0:I-K)){if(-1===K&&(K=I),I-K+1===U)return K*B}else-1!==K&&(I-=I-K),K=-1;else for(I+
U>Q&&(I=Q-U);0<=I;I--){Q=!0;for(K=0;K<U;K++)if(O(T,I+K)!==O(G,K)){Q=!1;break}if(Q)return I}return-1}function z(T,G,I){I=Math.min(T.length,I);for(var K=[];G<I;){var L=T[G],O=null,B=239<L?4:223<L?3:191<L?2:1;if(G+B<=I)switch(B){case 1:128>L&&(O=L);break;case 2:var Q=T[G+1];128===(Q&192)&&(L=(L&31)<<6|Q&63,127<L&&(O=L));break;case 3:Q=T[G+1];var U=T[G+2];128===(Q&192)&&128===(U&192)&&(L=(L&15)<<12|(Q&63)<<6|U&63,2047<L&&(55296>L||57343<L)&&(O=L));break;case 4:Q=T[G+1];U=T[G+2];var X=T[G+3];128===(Q&
192)&&128===(U&192)&&128===(X&192)&&(L=(L&15)<<18|(Q&63)<<12|(U&63)<<6|X&63,65535<L&&1114112>L&&(O=L))}null===O?(O=65533,B=1):65535<O&&(O-=65536,K.push(O>>>10&1023|55296),O=56320|O&1023);K.push(O);G+=B}T=K.length;if(T<=S)K=String.fromCharCode.apply(String,K);else{I="";for(G=0;G<T;)I+=String.fromCharCode.apply(String,K.slice(G,G+=S));K=I}return K}function y(T,G){G=G||Infinity;for(var I,K=T.length,L=null,O=[],B=0;B<K;++B){I=T.charCodeAt(B);if(55295<I&&57344>I){if(!L){if(56319<I){-1<(G-=3)&&O.push(239,
191,189);continue}else if(B+1===K){-1<(G-=3)&&O.push(239,191,189);continue}L=I;continue}if(56320>I){-1<(G-=3)&&O.push(239,191,189);L=I;continue}I=(L-55296<<10|I-56320)+65536}else L&&-1<(G-=3)&&O.push(239,191,189);L=null;if(128>I){if(0>--G)break;O.push(I)}else if(2048>I){if(0>(G-=2))break;O.push(I>>6|192,I&63|128)}else if(65536>I){if(0>(G-=3))break;O.push(I>>12|224,I>>6&63|128,I&63|128)}else if(1114112>I){if(0>(G-=4))break;O.push(I>>18|240,I>>12&63|128,I>>6&63|128,I&63|128)}else throw Error("Invalid code point");
}return O}function w(T){for(var G=[],I=0;I<T.length;++I)G.push(T.charCodeAt(I)&255);return G}function D(T){var G=F,I=G.FLj;T=(T.trim?T.trim():T.replace(/^\s+|\s+$/g,"")).replace(N,"");if(2>T.length)T="";else for(;0!==T.length%4;)T+="=";return I.call(G,T)}function H(T,G,I,K){for(var L=0;L<K&&!(L+I>=G.length||L>=T.length);++L)G[L+I]=T[L];return L}var F=b(1522);b(1523);var J=b(1524);E.tig=e;E.Y_j=function(T){+T!=T&&(T=0);return e.vpe(+T)};E.u_j=50;e.TO=void 0!==a.TO?a.TO:c();E.u1j=e.TO?2147483647:1073741823;
e.from=function(T,G,I){return h(null,T,G,I)};e.TO&&(e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&e[Symbol.species]===e&&Object.defineProperty(e,Symbol.species,{value:null,configurable:!0}));e.vpe=function(T){k(T);return d(null,T)};e.gKg=function(T){return n(null,T)};e.isBuffer=function(T){return!(null==T||!T.Prg)};e.compare=function(T,G){if(!e.isBuffer(T)||!e.isBuffer(G))throw new TypeError("Arguments must be Buffers");if(T===G)return 0;
for(var I=T.length,K=G.length,L=0,O=Math.min(I,K);L<O;++L)if(T[L]!==G[L]){I=T[L];K=G[L];break}return I<K?-1:K<I?1:0};e.Ycf=function(T){switch(String(T).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};e.concat=function(T,G){if(!J(T))throw new TypeError('"list" argument must be an Array of Buffers');if(0===T.length)return e.vpe(0);var I;if(void 0===G)for(I=G=
0;I<T.length;++I)G+=T[I].length;G=e.gKg(G);var K=0;for(I=0;I<T.length;++I){var L=T[I];if(!e.isBuffer(L))throw new TypeError('"list" argument must be an Array of Buffers');L.copy(G,K);K+=L.length}return G};e.byteLength=x;e.prototype.Prg=!0;e.prototype.toString=function(){var T=this.length|0;return 0===T?"":0===arguments.length?z(this,0,T):l.apply(this,arguments)};e.prototype.equals=function(T){if(!e.isBuffer(T))throw new TypeError("Argument must be a Buffer");return this===T?!0:0===e.compare(this,
T)};e.prototype.compare=function(T,G,I,K,L){if(!e.isBuffer(T))throw new TypeError("Argument must be a Buffer");void 0===G&&(G=0);void 0===I&&(I=T?T.length:0);void 0===K&&(K=0);void 0===L&&(L=this.length);if(0>G||I>T.length||0>K||L>this.length)throw new RangeError("out of range index");if(K>=L&&G>=I)return 0;if(K>=L)return-1;if(G>=I)return 1;G>>>=0;I>>>=0;K>>>=0;L>>>=0;if(this===T)return 0;var O=L-K,B=I-G,Q=Math.min(O,B);K=this.slice(K,L);T=T.slice(G,I);for(G=0;G<Q;++G)if(K[G]!==T[G]){O=K[G];B=T[G];
break}return O<B?-1:B<O?1:0};e.prototype.includes=function(T,G,I){return-1!==this.indexOf(T,G,I)};e.prototype.indexOf=function(T,G,I){return u(this,T,G,I,!0)};e.prototype.lastIndexOf=function(T,G,I){return u(this,T,G,I,!1)};e.prototype.write=function(T,G,I,K){if(void 0===G)K="utf8",I=this.length,G=0;else if(void 0===I&&"string"===typeof G)K=G,I=this.length,G=0;else if(isFinite(G))G|=0,isFinite(I)?(I|=0,void 0===K&&(K="utf8")):(K=I,I=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");
var L=this.length-G;if(void 0===I||I>L)I=L;if(0<T.length&&(0>I||0>G)||G>this.length)throw new RangeError("Attempt to write outside buffer bounds");K||(K="utf8");for(L=!1;;)switch(K){case "hex":G=Number(G)||0;K=this.length-G;I?(I=Number(I),I>K&&(I=K)):I=K;K=T.length;if(0!==K%2)throw new TypeError("Invalid hex string");I>K/2&&(I=K/2);for(K=0;K<I;++K){L=parseInt(T.substr(2*K,2),16);if(isNaN(L))break;this[G+K]=L}return K;case "utf8":case "utf-8":return H(y(T,this.length-G),this,G,I);case "ascii":return H(w(T),
this,G,I);case "latin1":case "binary":return H(w(T),this,G,I);case "base64":return H(D(T),this,G,I);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":K=T;L=this.length-G;for(var O=[],B=0;B<K.length&&!(0>(L-=2));++B){var Q=K.charCodeAt(B);T=Q>>8;Q%=256;O.push(Q);O.push(T)}return H(O,this,G,I);default:if(L)throw new TypeError("Unknown encoding: "+K);K=(""+K).toLowerCase();L=!0}};e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this.c0j||this,0)}};var S=4096;e.prototype.slice=
function(T,G){var I=this.length;T=~~T;G=void 0===G?I:~~G;0>T?(T+=I,0>T&&(T=0)):T>I&&(T=I);0>G?(G+=I,0>G&&(G=0)):G>I&&(G=I);G<T&&(G=T);if(e.TO)G=this.subarray(T,G),G.__proto__=e.prototype;else{I=G-T;G=new e(I,void 0);for(var K=0;K<I;++K)G[K]=this[K+T]}return G};e.prototype.g7i=function(T){if(0!==T%1||0>T)throw new RangeError("offset is not uint");if(T+2>this.length)throw new RangeError("Trying to access beyond buffer length");return this[T]<<8|this[T+1]};e.prototype.copy=function(T,G,I,K){I||(I=0);
K||0===K||(K=this.length);G>=T.length&&(G=T.length);G||(G=0);0<K&&K<I&&(K=I);if(K===I||0===T.length||0===this.length)return 0;if(0>G)throw new RangeError("targetStart out of bounds");if(0>I||I>=this.length)throw new RangeError("sourceStart out of bounds");if(0>K)throw new RangeError("sourceEnd out of bounds");K>this.length&&(K=this.length);T.length-G<K-I&&(K=T.length-G+I);var L=K-I;if(this===T&&I<G&&G<K)for(K=L-1;0<=K;--K)T[K+G]=this[K+I];else if(1E3>L||!e.TO)for(K=0;K<L;++K)T[K+G]=this[K+I];else Uint8Array.prototype.set.call(T,
this.subarray(I,I+L),G);return L};e.prototype.fill=function(T,G,I,K){if("string"===typeof T){"string"===typeof G?(K=G,G=0,I=this.length):"string"===typeof I&&(K=I,I=this.length);if(1===T.length){var L=T.charCodeAt(0);256>L&&(T=L)}if(void 0!==K&&"string"!==typeof K)throw new TypeError("encoding must be a string");if("string"===typeof K&&!e.Ycf(K))throw new TypeError("Unknown encoding: "+K);}else"number"===typeof T&&(T&=255);if(0>G||this.length<G||this.length<I)throw new RangeError("Out of range index");
if(I<=G)return this;G>>>=0;I=void 0===I?this.length:I>>>0;T||(T=0);if("number"===typeof T)for(K=G;K<I;++K)this[K]=T;else for(T=e.isBuffer(T)?T:y((new e(T,K)).toString()),L=T.length,K=0;K<I-G;++K)this[K+G]=T[K%L];return this};var N=/[^+\/0-9A-Za-z-_]/g}).call(this,b(753))},1522:function(t,E){function b(e){var h=e.length;if(0<h%4)throw Error("Invalid string. Length must be a multiple of 4");e=e.indexOf("=");-1===e&&(e=h);return[e,e===h?0:4-e%4]}E.byteLength=function(e){e=b(e);var h=e[1];return 3*(e[0]+
h)/4-h};E.FLj=function(e){var h=b(e);var k=h[0];h=h[1];var n=new d(3*(k+h)/4-h),f=0,v=0<h?k-4:k,m;for(m=0;m<v;m+=4)k=c[e.charCodeAt(m)]<<18|c[e.charCodeAt(m+1)]<<12|c[e.charCodeAt(m+2)]<<6|c[e.charCodeAt(m+3)],n[f++]=k>>16&255,n[f++]=k>>8&255,n[f++]=k&255;2===h&&(k=c[e.charCodeAt(m)]<<2|c[e.charCodeAt(m+1)]>>4,n[f++]=k&255);1===h&&(k=c[e.charCodeAt(m)]<<10|c[e.charCodeAt(m+1)]<<4|c[e.charCodeAt(m+2)]>>2,n[f++]=k>>8&255,n[f++]=k&255);return n};E.nVe=function(e){for(var h=e.length,k=h%3,n=[],f=0,v=
h-k;f<v;f+=16383){for(var m=n,x=m.push,l,u=e,A=f+16383>v?v:f+16383,z=[],y=f;y<A;y+=3)l=(u[y]<<16&16711680)+(u[y+1]<<8&65280)+(u[y+2]&255),z.push(a[l>>18&63]+a[l>>12&63]+a[l>>6&63]+a[l&63]);l=z.join("");x.call(m,l)}1===k?(e=e[h-1],n.push(a[e>>2]+a[e<<4&63]+"==")):2===k&&(e=(e[h-2]<<8)+e[h-1],n.push(a[e>>10]+a[e>>4&63]+a[e<<2&63]+"="));return n.join("")};var a=[],c=[],d="undefined"!==typeof Uint8Array?Uint8Array:Array;for(t=0;64>t;++t)a[t]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[t],
c["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(t)]=t;c[45]=62;c[95]=63},1523:function(t,E){E.read=function(b,a,c,d,e){var h=8*e-d-1;var k=(1<<h)-1,n=k>>1,f=-7;e=c?e-1:0;var v=c?-1:1,m=b[a+e];e+=v;c=m&(1<<-f)-1;m>>=-f;for(f+=h;0<f;c=256*c+b[a+e],e+=v,f-=8);h=c&(1<<-f)-1;c>>=-f;for(f+=d;0<f;h=256*h+b[a+e],e+=v,f-=8);if(0===c)c=1-n;else{if(c===k)return h?NaN:Infinity*(m?-1:1);h+=Math.pow(2,d);c-=n}return(m?-1:1)*h*Math.pow(2,c-d)};E.write=function(b,a,c,d,e,h){var k,
n=8*h-e-1,f=(1<<n)-1,v=f>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0;h=d?0:h-1;var x=d?1:-1,l=0>a||0===a&&0>1/a?1:0;a=Math.abs(a);isNaN(a)||Infinity===a?(a=isNaN(a)?1:0,d=f):(d=Math.floor(Math.log(a)/Math.LN2),1>a*(k=Math.pow(2,-d))&&(d--,k*=2),a=1<=d+v?a+m/k:a+m*Math.pow(2,1-v),2<=a*k&&(d++,k/=2),d+v>=f?(a=0,d=f):1<=d+v?(a=(a*k-1)*Math.pow(2,e),d+=v):(a=a*Math.pow(2,v-1)*Math.pow(2,e),d=0));for(;8<=e;b[c+h]=a&255,h+=x,a/=256,e-=8);d=d<<e|a;for(n+=e;0<n;b[c+h]=d&255,h+=x,d/=256,n-=8);b[c+h-x]|=
128*l}},1524:function(t){var E={}.toString;t.exports=Array.isArray||function(b){return"[object Array]"==E.call(b)}},1525:function(t,E,b){function a(){var e=d.call(this)||this;e.errorCode=null;e.errorDescription=null;e.html=null;e.H_=Object.assign(new c.a,{T_:a.getTypeName(),B_:a.Md()});return e}b.d(E,"a",function(){return a});t=b(0);E=b(945);var c=b(919),d=E.a;$k(a,d);a.getTypeName=function(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"};a.Md=function(){return["AugLoop_Core_Annotation"]};
Object(t.a)(a,"DetectedHtmlTableAnnotation",E.a,[])},1526:function(t,E,b){function a(){}b.d(E,"a",function(){return a});t=b(0);a.IHa=function(c,d){if(!(c&&d&&c.length&&d.length)||256<c.length)return"";var e=Array(256),h=Array(256),k,n=0,f=0,v="";for(k=0;256>k;k++)e[k]=k;for(k=0;256>k;k++){var m=c.charCodeAt(k%c.length);if(256<=m)return"";n=(n+e[k]+m)%256;m=e[k];e[k]=e[n];e[n]=m}for(k=0;256>k;k++)h[k]=e[256-k-1];for(c=n=k=0;c<d.length;c++){k=(k+1)%256;n=(n+e[k])%256;m=e[k];e[k]=e[n];e[n]=m;m=d.charCodeAt(c);
if(256<=m)return"";var x=m^e[(e[k]+e[n])%256];f=(f+h[k])%256;m=h[k];h[k]=h[f];h[f]=m;v+=String.fromCharCode(x^e[(h[k]+h[f])%256])}return v};Object(t.a)(a,"RC4A",null,[])},1528:function(t,E,b){function a(d,e,h,k){this.ykb=d;c.AFrameworkApplication.fa.qa("AddInCommandsMissingTabIsEnabled")&&h.bTh();this.Tlg=this.$w=e;this.exg=k}b.d(E,"a",function(){return a});t=b(0);b(15);var c=b(4);a.prototype.cKa=function(d){d=this.HDb+this.solutionId+d;return this.oRd?(d in a.u_b||(a.u_b[d]="AddinControl"+a.TIg++),
a.u_b[d]):d};a.prototype.XFe=function(d){if(this.oRd){var e=a.u_b,h;for(h in e){var k=h;if(d===e[h])return k.substr(this.HDb.length+this.solutionId.length)}}return d};a.prototype.c3e=function(d){d=this.HDb+this.solutionId+d;return this.oRd?(d in a.OVc||(a.OVc[d]="AddinTab"+a.cJg++),a.OVc[d]):d};of.Object.defineProperties(a.prototype,{HDb:{configurable:!0,enumerable:!0,get:function(){return this.ykb}},solutionId:{configurable:!0,enumerable:!0,get:function(){return this.$w}},assetId:{configurable:!0,
enumerable:!0,get:function(){return this.Tlg}},oRd:{configurable:!0,enumerable:!0,get:function(){return this.exg}}});a.u_b={};a.OVc={};a.cJg=0;a.TIg=0;Object(t.a)(a,"DefaultRibbonNamingProvider",null,[326])},1575:function(t,E,b){function a(l){var u=this;this.OA=null;this.Q$f={};this.S$f={};this.Jad={};this.iyd={};this.zid=function(A,z){A=u.$.Fb.sc("Task","DdaEventDispatch.HandleServerEvent");z=z.rYf;for(var y=0;y<z.length;y++)switch(z[y].EventType){case 2:var w=z[y],D={};D.Name=w.Name;D.BindingType=
w.BindingType;D.ColCount=w.ColCount;D.RowCount=w.RowCount;u.Ova(w.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,D,null);break;case 4:u.Ova(z[y].InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(w=z[y],w.InstanceId){D=Array(w.Entries.length);for(var H=0;H<w.Entries.length;H++)D[H]=a.occ(w.Entries[H],w.IsRemoteOverride);0<w.Entries.length&&1===w.Entries[0].Category?u.q2i(w.InstanceId,D):w.InstanceId&&u.Ova(w.InstanceId,OSF.DDA.EventDispId.dispidRichApiMessageEvent,
null,D)}else{u.Jad={};u.iyd={};for(D=0;D<w.Entries.length;D++)u.CIe(w.Entries[D],w.IsRemoteOverride);c.ULS.sendTraceTag(537170593,0,50,"Number of Fired event: "+u.Jad+", Number of Not Fired event: "+u.iyd+", Total Number of Fired event: "+u.Q$f+", Total Number of Not Fired event: "+u.S$f)}}A.stop()};this.DKb=function(A,z){u.Ova(A,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,z)};this.$=l;this.Jvc=this.zid}b.r(E);t=b(0);var c=b(15),d=b(85),e;(function(l){l[l.none=0]="none";l[l.testEvent=1]="testEvent";
l[l.test1Event=2]="test1Event";l[l.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";l[l.worksheetActivatedEvent=11]="worksheetActivatedEvent";l[l.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";l[l.worksheetAddedEvent=13]="worksheetAddedEvent";l[l.worksheetSelectionChangedEvent=14]="worksheetSelectionChangedEvent";l[l.worksheetDeletedEvent=15]="worksheetDeletedEvent";l[l.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";l[l.worksheetFilteredEvent=17]="worksheetFilteredEvent";
l[l.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";l[l.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";l[l.worksheetColumnSortedEvent=20]="worksheetColumnSortedEvent";l[l.worksheetSingleClickedEvent=21]="worksheetSingleClickedEvent";l[l.worksheetRowHiddenChangedEvent=22]="worksheetRowHiddenChangedEvent";l[l.worksheetFormulaChangedEvent=23]="worksheetFormulaChangedEvent";l[l.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";l[l.worksheetNameChangedEvent=25]=
"worksheetNameChangedEvent";l[l.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";l[l.worksheetMovedEvent=27]="worksheetMovedEvent";l[l.worksheetNavigationObjectChangedEvent=28]="worksheetNavigationObjectChangedEvent";l[l.worksheetRowHeightChangedEvent=29]="worksheetRowHeightChangedEvent";l[l.workbookFormulaReferenceStyleChangedEvent=30]="workbookFormulaReferenceStyleChangedEvent";l[l.chartAddedEvent=50]="chartAddedEvent";l[l.chartActivatedEvent=51]="chartActivatedEvent";l[l.chartDeactivatedEvent=
52]="chartDeactivatedEvent";l[l.chartDeletedEvent=53]="chartDeletedEvent";l[l.tableSelectionChangedEvent=100]="tableSelectionChangedEvent";l[l.tableDataChangedEvent=101]="tableDataChangedEvent";l[l.tableAddedEvent=102]="tableAddedEvent";l[l.tableDeletedEvent=103]="tableDeletedEvent";l[l.tableFilteredEvent=104]="tableFilteredEvent";l[l.agaveVisualUpdateEvent=150]="agaveVisualUpdateEvent";l[l.customFunctionExecutionBeginEvent=200]="customFunctionExecutionBeginEvent";l[l.customFunctionExecutionEndEvent=
201]="customFunctionExecutionEndEvent";l[l.commentAddedEvent=250]="commentAddedEvent";l[l.commentDeletedEvent=251]="commentDeletedEvent";l[l.commentChangedEvent=252]="commentChangedEvent";l[l.invocationMessage=1E3]="invocationMessage";l[l.cancellationMessage=1001]="cancellationMessage";l[l.metadataMessage=1002]="metadataMessage";l[l.visualSelectionChangedEvent=2E3]="visualSelectionChangedEvent";l[l.visualChangeEvent=2001]="visualChangeEvent";l[l.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";
l[l.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";l[l.shapeActivatedEvent=2101]="shapeActivatedEvent";l[l.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";l[l.shapeAddedEvent=2103]="shapeAddedEvent";l[l.shapeDeletedEvent=2104]="shapeDeletedEvent";l[l.workbookAutoSaveSettingChangedEvent=2200]="workbookAutoSaveSettingChangedEvent";l[l.wacOperationEvent=2201]="wacOperationEvent";l[l.recordingStateChangedEvent=2202]="recordingStateChangedEvent";l[l.workbookActivatedEvent=2203]="workbookActivatedEvent";
l[l.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";l[l.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";l[l.linkedDataTypeRefreshRequestCompletedEvent=2500]="linkedDataTypeRefreshRequestCompletedEvent";l[l.linkedDataTypeRefreshModeChangedEvent=2501]="linkedDataTypeRefreshModeChangedEvent";l[l.linkedDataTypeLinkedDataTypeAddedEvent=2502]="linkedDataTypeLinkedDataTypeAddedEvent";l[l.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";
l[l.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";l[l.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";l[l.rangePickerDeactivatedEvent=2701]="rangePickerDeactivatedEvent";l[l.lineageActivityUpdateAvailableEvent=2800]="lineageActivityUpdateAvailableEvent";l[l.lineageActivityFilterUpdatedEvent=2801]="lineageActivityFilterUpdatedEvent";l[l.lineageActivityLoadCompletedEvent=2802]="lineageActivityLoadCompletedEvent";l[l.pivotTableAddedEvent=2900]=
"pivotTableAddedEvent";l[l.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";l[l.namedItemAddedEvent=3E3]="namedItemAddedEvent";l[l.namedItemDeletedEvent=3001]="namedItemDeletedEvent";l[l.guidedReapplyManagerUpdateAvailableEvent=3100]="guidedReapplyManagerUpdateAvailableEvent";l[l.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";l[l.beforeCloseNotifiactionCancelledEvent=65540]="beforeCloseNotifiactionCancelledEvent"})(e||(e={}));Object(t.b)("MessageType",e);var h=b(986),
k=b(260),n=b(957),f=b(54),v=b(37),m=b(159),x=b(1);b.d(E,"DdaEventDispatch",function(){return a});a.prototype.XZb=function(l){l&&(this.Cia(),this.OA.push(l))};a.prototype.$sc=function(l){this.OA&&(Array.remove(this.OA,l),this.OA.length||(this.$.wantServerEvents=!1,this.$.lej(this.Jvc),this.OA=null))};a.prototype.q2i=function(l,u){var A=this,z=Object(d.a)(n.DdaFacade,k.a(this.$));v.TaskExtensions.Aa(z.yUh(l),function(y){if(m.b(y)){var w=y.result;y=z.Tm(w);if(w)if(y.spd)A.Ova(w,OSF.DDA.EventDispId.dispidRichApiMessageEvent,
null,u);else if(y.Z4c)for(w=0;w<u.length;w++)y.Z4c.push(u[w]);else y.Z4c=u}else y.Of?c.ULS.sendTraceTag(537170591,0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):y.sh&&c.ULS.sendTraceTag(537170590,0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.la,0)};a.prototype.L2i=function(l,u){var A=Object(d.a)(n.DdaFacade,k.a(this.$)),z=A.EIh(l);z?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(z,
u,this.DKb):A.s5g(l,u)};a.prototype.CIe=function(l,u){var A=!1,z=parseInt(l.Type,10),y=l.Target,w=Object(d.a)(n.DdaFacade,k.a(this.$));if((y=w.Ri.EUh(z,y))&&0<Object.keys(y).length){A=!0;for(var D in y)if(y=D,w.Ri.i0b(y)){var H=Array(1);H[0]=a.occ(l,u);if(x.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var F=H[0][3];if(void 0!==F&&null!==F&&(F=Object(d.a)(Object,f.a.Wh(F)))&&void 0!==F.triggerControlId&&null!==F.triggerControlId&&void 0!==F.triggerSource&&null!==
F.triggerSource){var J=!1;u?(F.triggerSource="Unknown",J=!0):w.iih(F.triggerControlId,y)&&(F.triggerSource="ThisLocalAddin",J=!0);J&&(H[0][3]=f.a.xc(F))}}this.Ova(y,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,H)}}A?(this.Sec(e[z],this.Jad),this.Sec(e[z],this.Q$f)):(this.Sec(e[z],this.iyd),this.Sec(e[z],this.S$f))};a.prototype.Cia=function(){this.OA||(this.OA=[],this.$.uoe(this.Jvc),this.$.wantServerEvents=!0)};a.prototype.Sec=function(l,u){l in u||(u[l]=0);u[l]+=1};a.prototype.zM=function(l,
u,A){var z={};z.Target=u;z.Category=65536;z.Type=l;z.Message=A;z.Id=-1;this.CIe(z,!1)};a.prototype.uCh=function(l,u){var A={Target:"",Category:2,Type:1E3};A.Message=u;A.Id=0;u=Array(1);u[0]=a.occ(A,!1);this.L2i(l,u)};a.prototype.l$b=function(l,u,A,z){var y={};y.Target=A;y.Category=65536;y.Type=u;y.Message=z;y.Id=-1;u=Array(1);u[0]=a.occ(y,!1);this.Ova(l,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,u)};a.prototype.tCh=function(l,u){this.Ova(l,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,
u)};a.prototype.Ova=function(l,u,A,z){if(this.OA){var y=Object(d.a)(n.DdaFacade,k.a(this.$));if(!y||u!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&u!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||y.Ri.i0b(l))for(l=new h.a(u,l,A,z),u=0,A=this.OA.length;u<A;u++)(z=this.OA[u])&&z(l)}};a.occ=function(l,u){var A=Array(6);A[0]=l.Category;A[1]=l.Type;A[2]=l.Target;A[3]=l.Message;A[4]=l.Id;A[5]=u;return A};Object(t.a)(a,"DdaEventDispatch",null,[])},1604:function(t,E,b){function a(){}b.d(E,"a",
function(){return a});t=b(0);a.taskPaneWidth="TaskPaneWidth";a.sourceLocationOverrideResourceId="SourceLocationOverrideResourceId";a.Rk="TaskPaneTitle";a.Kk="IconCssClass";a.mVd="TaskPaneIconUrl";a.kS="TaskPaneIconId";a.PH="NonPersistedSettings";a.onTaskPaneClose="OnTaskPaneClose";a.uTc="ActionArgs";Object(t.a)(a,"PropertyNames",null,[])},1605:function(t,E,b){function a(){var e=d.call(this,void 0,void 0,void 0,!0)||this;e.fDa="AddinCommandsUILessDialog";e.uSc="WACDialogTitleText";e.kVa="0";e.iDa=
380;e.gib=190;e.ye=e.fDa;e.Rb=5;e.Hng=String.format("{0}px",e.iDa);e.jVa=String.format("{0}px",e.gib);e.Su=!1;e.I6e=!1;e.bD();return e}b.d(E,"a",function(){return a});t=b(0);E=b(150);var c=b(89),d=E.a;$k(a,d);a.prototype.bD=function(){d.prototype.bD.call(this);this.np.style.width=this.Hng;this.np.style.height=this.jVa;this.np.style.padding=this.kVa};a.prototype.lv=function(e){this.lO();document.getElementById(this.di(this.uSc)).innerText=e};a.prototype.lO=function(){d.prototype.lO.call(this);this.Db.style.width=
String.format("{0}px",this.iDa);this.Db.style.height=String.format("{0}px",this.gib);this.Db.removeAttribute(c.a.Gd);this.Db.removeAttribute(c.a.ZD)};a.prototype.hide=function(){this.Oxb()};a.prototype.initializeAndShowWithTitle=function(){this.initializeAndShow(CommonUIStrings.l_NotificationUITitle,null,null)};of.Object.defineProperties(a.prototype,{B1a:{configurable:!0,enumerable:!0,get:function(){return this.np}}});Object(t.a)(a,"AddinCommandsUILessDialog",E.a,[342])},1635:function(t,E,b){function a(M){return bd.call(this,
M)||this}function c(M,na,Pa){this.rangePicker=null;this.$=M;this.se=na;this.re=new K(M.ea);this.Vz=new F(M,this.re);this.Yrf=Pa;this.F9b=new Map}function d(M,na,Pa,rb,cc){this.YSc=null;this.fRb=M;this.hA=na;this.GI=Pa;this.ib=rb;this.Qzg=cc}function e(){}function h(){this.qra=null}function k(M){if(!M)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.Evd=M}function n(M,na,Pa){return function(rb){return function(cc,Dc){dg.TaskExtensions.Aa(Mg.GetServiceTaskFactory.create(na.da,
279,na.la,1),function(Zc){Zc=Zc.result;var nd=!1,Id=Pa.Th.getOsfControl(M),Od=null;Id&&(Od=Id.getStoreType(),(Id=Id.getManifest())&&Id.getSharedRuntimeForCustomFunctions("Workbook")&&(nd=!0));dg.TaskExtensions.Aa(Zc.vaf(M,Od,rb,nd),function(je){Rj.b(je)?je.result?cc(null):Dc(OfficeExtension.WacRuntime.Utility.createRichApiException(rg.a.invalidArgument,qg.a.instance.ga(1756))):Dc(OfficeExtension.WacRuntime.Utility.createRichApiException(rg.a.generalException,qg.a.instance.ga(1752)))},na.la,3)},na.la,
3)}}}function f(M,na){this.VO=Xg.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.hA=M;this.GI=na;this.yug=this.GI.Th.getOsfControl(this.hA)}function v(M,na,Pa,rb){this.U2d="";this.ZSb=0;this.VO=M;this._id=na;this.hA=Pa;this.GI=rb}function m(M,na,Pa){this.Drg=M;this.Erg=na;this.Mvg=Pa}function x(){this.Che=this.Lbe=this.dA=!1}function l(M,na,Pa,rb){this.$w=M;this.D1=Pa;this.Cy=rb.Th.getOsfControl(na)}function u(M,na){this.GI=na;this.hA=M}function A(M){this.hA=M}
function z(M){this.GIa={};this.zAi=M}function y(M,na){var Pa=this;Pa.nhf=function(rb,cc){rb=y.e4g(rb,cc);if(!vj.a(Pa.$,rb))return!0;rb=Pa.$.shortcutKeyManager.E2e(rb);return!!rb&&0<rb.length};Pa.addinId=M;Pa.$=na;return Pa}function w(){}function D(){}function H(M,na,Pa,rb){this.oAh=M;this.fileSize=na;this.TDj=rb}function F(M,na){var Pa=this;this.WH=function(rb,cc){Pa.iQ.RJa(Sf.a.internalError,cc)};this.$=M;this.iQ=na}function J(M,na,Pa,rb){Pa=uj.call(this,576,0,Pa,rb)||this;Pa.eMd=new N("576",M,na);
return Pa}function S(M,na,Pa,rb,cc,Dc,Zc,nd){na=Hi.call(this,10,0,na,nd)||this;na.fmb=Pa;na.Bib=rb;na.B3=cc;na.sFa=Dc;na.request=Zc;na.eMd=new N("10",M,Zc);return na}function N(M,na,Pa){this.parentName=M;this.$=na;this.request=Pa}function T(M,na){this.source=M;this.eventId=na}function G(M,na,Pa,rb,cc,Dc){var Zc=M.Na(1);Zc.request=na;return Kg.g(M,"ExecuteRichApiRequest",Zc,Pa,rb,cc,Dc,0)}function I(M,na,Pa){this.$=M;this.iQ=na;this.Vz=Pa}function K(M){this.ea=M}function L(M,na,Pa,rb){M=ki.call(this,
M,"Select Data")||this;M.kpb=null;M.oGe=na;M.B5c=Pa;M.callback=rb;return M}function O(M){this.ib=M}function B(M){M.add("InternalTest","PreviewExecutionMethod",Q)}function Q(M,na){console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+typeof M+", objectId="+M+", value="+na);return null}function U(M,na){this.Atg=M;this.Wtg=na}function X(M){var na=M.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",
3,0);var Pa=na.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);Pa.addParameter("shortcuts","String[]",1,null,0);na.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);Pa=na.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);Pa.addParameter("shortcuts","Object",1,null,0);na=M.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}","{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);Pa=na.addMethod("GetSharedFilePickerResponse",1,"Object",
1,1,"SharedFilePickerResponse",0);Pa.addParameter("pickerCustomizationJsonString","String",1,null,0);na=M.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}","",3,0);Pa=na.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook",0);Pa.addParameter("base64File","String",1,null,0);na=M.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}","",3,0);na.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",
1,1,"AppRuntimeState",0);Pa=na.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",0);Pa.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);na=M.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);na.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null,0);Pa=na.addMethod("Register",1,"Void",0,0,"Register",0);Pa.addParameter("metadata",
"String",1,null,0);Pa.addParameter("javascript","String",1,null,0);na=M.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);na.addProperty("Enabled",1,"Boolean",1,!1,null,0);na.addProperty("NativeRuntime",3,"Boolean",1,!1,null,0);na.addProperty("StreamingEnabled",2,"Boolean",1,!1,null,0);na=M.addEnumType("Microsoft.Authentication.IdentityType");na.addEnumField("OrganizationAccount",0);na.addEnumField("MicrosoftAccount",1);na=M.addEnumType("Microsoft.Authentication.AuthorityType");
na.addEnumField("External",0);na.addEnumField("Msa",1);na.addEnumField("Aad",2);na=M.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);na.addProperty("DisplayName",4,"String",1,!1,null,0);na.addProperty("Email",3,"String",1,!1,null,0);na.addProperty("FederationProvider",2,"String",1,!1,null,0);na.addProperty("IdentityType",1,"Microsoft.Authentication.IdentityType",1,!1,null,0);na=M.addType("Microsoft.Authentication.AuthContext",
"{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);na.addProperty("AppId",4,"String",1,!1,null,0);na.addProperty("Authority",2,"String",1,!1,null,0);na.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);na.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);na.addProperty("TenantId",6,"String",1,!1,null,0);na.addProperty("Upn",1,"String",1,!1,null,0);na=M.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}",
"{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);na.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,null,0);Pa=na.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4);Pa.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);na.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",2,1,"AuthContext",0);na.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",
2,1,"PrimaryIdentityInfo",4);na=M.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);na.addProperty("AuthChallenge",3,"String",1,!1,null,0);na.addProperty("CorrelationId",7,"String",1,!1,null,0);na.addProperty("Policy",4,"String",1,!1,null,0);na.addProperty("Resource",2,"String",1,!1,null,0);na.addProperty("Scope",5,"String",1,!1,null,0);na.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);na=M.addType("Microsoft.Authentication.SingleSignOnToken",
"{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);na.addProperty("AccessToken",2,"String",1,!1,null,0);na.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);na=M.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);na.addProperty("Id",1,"String",1,!0,null,0);na.addProperty("Value",2,"Object",1,!1,null,0);na=M.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}",
"",3,0);Pa=na.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0);Pa.addParameter("id","String",1,null,0);Pa=na.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0);Pa.addParameter("id","String",1,null,0);na=M.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);na.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",
0);Pa=na.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);Pa.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);na=M.addEnumType("Microsoft.AppRuntime.AppRuntimeState");na.addEnumField("Inactive",0);na.addEnumField("Background",1);na.addEnumField("Visible",2);na=M.addEnumType("Microsoft.AppRuntime.Visibility");na.addEnumField("Hidden",1);na.addEnumField("Visible",2);na=M.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}",
"{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);na.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);Pa=na.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);Pa.addParameter("jsonCreate","String",1,null,0);Pa=na.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);Pa.addParameter("jsonUpdate","String",1,null,0);Pa=na.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);Pa.addParameter("id","String",
1,null,0);Pa=na.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);Pa.addParameter("id","String",1,null,0);na.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);na=M.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);na.addProperty("Id",2,"String",1,!0,null,0);Pa=na.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",0);Pa.addParameter("visibility","Boolean",1,null,0);na.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);na=M.addType("Microsoft.DynamicRibbon.RibbonButton",
"{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);na.addProperty("Enabled",3,"Boolean",1,!1,null,0);na.addProperty("Id",2,"String",1,!0,null,0);na.addProperty("Label",4,"String",1,!0,null,0);Pa=na.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);Pa.addParameter("enabled","Boolean",1,null,0);na.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);na=M.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);na.addMethod("GetCount",3,"Int32",1,1,"Count",
0);Pa=na.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);Pa.addParameter("key","String",1,null,0);na.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);na.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);na=M.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");na.addEnumField("Unknown",0);na.addEnumField("Basic",1);na.addEnumField("Premium",2);na=M.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",
3,0);Pa=na.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);Pa.addParameter("feature","String",1,null,0);Pa.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);Pa=na.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0);Pa.addParameter("feature","String",1,null,0);Pa=na.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);Pa.addParameter("feature","String",
1,null,0);Pa.addParameter("fallbackValue","Boolean",1,null,0);na.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);Pa=na.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);Pa.addParameter("experienceId","String",1,null,0);Pa=na.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4);Pa.addParameter("feature","String",1,null,0);na=M.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}",
"",3,0);na.addProperty("Id",5,"String",1,!0,null,0);na.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);na.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);na=M.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);na.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);na=M.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification",
"{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",3,0);na.addMethod("Disable",3,"Void",0,1,"Disable",0);na.addMethod("Enable",2,"Void",0,1,"Enable",0);na.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)}function P(M,na,Pa,rb){this.menuItemId=M;this.NF=na;this.vHj=Pa;this.zAh=rb}function ea(M){this.Syi=M}function ia(M){this.Rxa=M;this.Pog=Ye.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}function da(){}function xa(){}
function Z(){}function ha(M,na){this.Hhb=na;this.hA=M}function ya(){this.h2d=null;this.Pfe=this.oWb=this.zD="";this.bhe=!0;this.options=null}function va(M,na){this.KQb=M;this.kjb=na}function bb(){}function ba(){this.s6d=this.M5d=this.ofa=null;this.kjb=0}function fa(M){var na=Ui.call(this)||this;na.$=M;na.Eb();return na}function ra(){this.initialized=!1;this.agaveCommandManager=this.se=this.o0a=null;this.lU={}}function pa(M){var na=Ti.call(this)||this;na.$=M;na.Eb();return na}function Za(M,na,Pa,rb,
cc){var Dc=Si.call(this)||this;Dc.SRa={};Dc.Pad={};Dc.mwa=null;Dc.mza=null;Dc.fbb=!1;Dc.q5h=function(Zc,nd,Id,Od,je){if(2!==Id)return 32;Zc=je[uh.a.w9b];Id=je[uh.a.vHa];je=je[uh.a.Xya];nd=new wd.a;nd.vdi=je.optionalProperties.InstanceToken;nd.Rk=je.optionalProperties[lh.a.Rk];nd.kS=je.optionalProperties[lh.a.kS];lh.a.taskPaneWidth in je.optionalProperties&&(nd.taskPaneWidth=je.optionalProperties[lh.a.taskPaneWidth]);nd.sourceLocationOverrideResourceId=je.optionalProperties[lh.a.sourceLocationOverrideResourceId];
nd.PH=je.lq;nd.onTaskPaneClose=je.optionalProperties[lh.a.onTaskPaneClose];nd.vHa=Id;Id=new Vh.a(-859308420,0,2,0,"");Od=Zc.getStoreType()===OSF.StoreType.Sdx;var Ae=new Pg.a;Ae.G4=je.optionalProperties.HeaderCssClass||Jg.a.y2a;Ae.Heb=je.optionalProperties.TitleCssClass;Dc.H7(Id,Zc.getId(),nd,Od,Ae);return 32};Dc.a5h=function(Zc,nd,Id,Od,je){if(2!==Id)return 32;Zc=je[uh.a.w9b].getId();je=je[uh.a.Xya].optionalProperties[lh.a.sourceLocationOverrideResourceId];return Zc?(Dc.se.Th.refreshOsfControl(Zc,
je),32):8};Dc.g0i=function(Zc){Zc=Zc.Result;if(Zc=null===Zc?null:Zc.SolutionId)Dc.se.sle(Zc),Oi.a(Dc.$).nna(3,Zc)};Dc.UHf=function(Zc,nd){var Id,Od=(Zc=Zc.Result)?Zc.AgaveData:null;if(Od){Xd.ULS.shipAssertTag(537170434,0,Od.TaskpaneWidth===Za.ceh,"Taskpane width is "+Od.TaskpaneWidth+", assetId is "+Telemetry.PrivacyRules.GetPrivacyCompliantId(Od.PrimaryMarketplace.SolutionId,Od.PrimaryMarketplace.MarketplaceType,null===(Id=null===Od||void 0===Od?void 0:Od.AssetMarketplace)||void 0===Id?void 0:Id.SolutionId,
null,null,Od.PrimaryMarketplace.MarketplaceRef)+".");if(Id=Dc.Pad[Od.PrimaryMarketplace.SolutionId])Id.Uzc&&(Od.TaskpaneTitle=Id.Uzc),Id.Szc&&(Od.TaskpaneIconId=Id.Szc),Id.qVd&&(Od.TaskpaneButtonTooltip=Id.qVd),0<Id.lu&&(Od.TaskpaneWidth=Id.lu);nd&&(Od.FocusOnIframeWhenLoaded=nd.focusOnIframeWhenLoaded,nd.width&&(Od.TaskpaneWidth=nd.width),Od.TaskpaneIconCssClass=nd.Kk,Od.TaskpaneHeaderCssClass=nd.G4,Od.TaskpaneTitleCssClass=nd.Heb,Od.IsFirstPartyOptOutAppContextOptmization=nd.isFirstPartyOptOutAppContextOptmization);
Dc.SRa[Od.PrimaryMarketplace.SolutionId]&&(Od.OsfPropertyBag=Dc.twd(Od.OsfPropertyBag,Od.PrimaryMarketplace.SolutionId));Kj.a(Od)||(Od.WebExtensionOsfControlType=1);Od&&(Dc.se.sle(Zc.SolutionId),Dc.se.P0a(Od))}else Xd.ULS.sendTraceTag(593285650,220,10,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};Dc.Kzh=function(Zc){Zc&&(Dc.V$c.$if(Zc),Dc.cxe())};Dc.YHf=function(Zc){Zc=Zc.toDataURL("image/jpeg");var nd=Dc.se.Gaa(Za.R7e+"."+Za.w4e);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(nd,
"onScreenshot",{screenshot:Zc},function(){})};Dc.z3h=function(Zc,nd,Id,Od,je){if(2!==Id)return 32;if(Di.a.gh(je)||je[uh.a.dBe]!==be.a.action)return 8;nd=je[uh.a.Xya];return nd?(Zc=(Zc=Dc.DUh(je))?Dc.se.Gaa(Zc):null)?(je=Dc.se.p5g(je[uh.a.vHa],nd.optionalProperties[lh.a.uTc]),af.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&(Id=Dc.se.pZ(Zc),Id.TaskpaneTitle!==nd.optionalProperties[lh.a.Rk]&&(Id.TaskpaneTitle=nd.optionalProperties[lh.a.Rk],Id.TaskpaneIconCssClass=
nd.optionalProperties.IconCssClass,Id.TaskpaneIconUrl=nd.optionalProperties.TaskPaneIconUrl,Id.TaskpaneIconId=nd.optionalProperties.TaskPaneIconId,af.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")?(nd=Dc.se.Th,nd.changeIframeTitle(Zc,Id.TaskpaneTitle),Id=nd.getOsfControl(Zc),nd.raiseOsfControlStatusChange(Id)):(nd=Dc.se.Th.getOsfControl(Zc),Dc.se.Th.raiseOsfControlStatusChange(nd)))),OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Zc,je,Dc.DKb),32):
8:8};Dc.DKb=function(Zc,nd){Dc.se.pCh(Zc,nd)};Dc.eId=function(){dg.TaskExtensions.T$(Mg.GetServiceTaskFactory.Ra(Dc.$.da,20,404,1),function(Zc){Zc.result.Dwb()},Dc.$.la)};Dc.$=M;Dc.viewBlockContainerHelpers=Pa;Dc.se=na;Dc.V$c=rb;Dc.oi=cc;Dc.oi.Mb(Gg.a.O3f,ai.a.frame,Dc.q5h);Dc.oi.Mb(Gg.a.bUf,ai.a.frame,Dc.a5h);Dc.oi.Mb(Gg.a.mRe,ai.a.frame,Dc.z3h);return Dc}function Ua(){var M=di.call(this)||this;M.jVa="calc(100% - 46px)";M.URb="15px";M.kVa="0";M.Cog="WACDialogPanel";M.iDa=695;M.Dog=462;M.gib="80%";
M.omg=350;M.z2d="100%";M.Rb=5;M.ye="AppsForOfficeInsertionDialog";M.aIc=!!Ye.AFrameworkApplication.fa&&Ye.AFrameworkApplication.fa.qa("OfficeAddinEnableInsertDialogAccessibilityFix");return M}function Ma(M,na){this.selection=M;this.tables=na}function oa(){this.autoFilterType=this.autoFilterRange=null;this.id=this.itemIndex=0}function ja(){var M=ta.call(this)||this;M.isTable=!1;M.isPivotTable=!1;M.hasTableHeaders=!1;M.tableName=null;M.userSelectedPivotTable=!1;return M}function ta(){this.addressWithSheet=
this.address=this.sheetName=this.sheetId=null;this.columnIndex=this.columnCount=this.rowIndex=this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=null}function aa(){this.qVd=this.Uzc=null;this.lu=0;this.Szc=null}function ma(){var M=this;this.se=null;this.Cab=function(na,Pa,rb,cc,Dc){if(2===rb){na=Dc?Dc:{};Pa=na.callback;rb=na.refresh?na.refresh:!1;if(!Pa)return 16;Ye.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType")&&null!=na.storeType?M.se.rKf(Pa,
rb,na.storeType):M.se.bda(Pa,rb)}return 32};this.f$i=function(na,Pa,rb,cc,Dc){2===rb&&(na=Dc?Dc.callback:null)&&M.se.GFg(na);return 32}}function Ea(M){return Dh.call(this,M)||this}function Ha(M){var na=Ci.call(this)||this;na.$=M;na.isFirstLaunch=!1;return na}function Aa(M){Xd.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");this.vof=Ye.AFrameworkApplication.fa.qa("IsTellMeUpSellEnterpriseEnabled");this.kyi=Ye.AFrameworkApplication.fa.Wa("SmartLookupApprovedOriginPattern");this.H8a=
Ye.AFrameworkApplication.fa.Wa("SmartLookupShredderServiceEndpoint");this.Qyi=wi.a.GM(Ye.AFrameworkApplication.fa.Wa("AppCatalogUrl")||"");this.G8a=new Ra;this.G8a.EnableAllTabV2=!0;this.G8a.EnableIntentService=!0;this.G8a.EnableInDocumentSearch=Ye.AFrameworkApplication.fa.qa("SmartLookupEnableInDocumentSearch");this.G8a.EnableLocalSearch=Ye.AFrameworkApplication.fa.qa("SmartLookupEnableLocalSearch");this.G8a.IntentServiceEndpoint=V.mYh();this.Kyi=new La(M,this.H8a)}function V(){}function La(M,na,
Pa){this.fMj=9E5;this.iMj=3E5;this.ivd=null;this.Pnf="";this.fvd=0;this.lGe=Date.now;this.Rxa=M;this.H8a=na;(void 0===Pa||Pa)&&this.Ocd()}function Ra(){}function pb(){}function cb(){}function Sa(){}function Db(){}function Ab(M,na,Pa,rb,cc,Dc){this.$=M;this.agaveCommandManager=Dc}function Wb(M){var na=jj.call(this)||this;na.ddaFacade=null;na.VMf=null;na.$=M;M.da.Ga(106,na);na.Eb();return na}function ub(){}function vb(){}function Ka(M){this.yFa=M}function eb(M,na,Pa){this.iframe=M;this.onSuccess=na;
this.onError=Pa;$addHandler(window,"message",Object(Fg.a)(this,this.f6e,"handleResponse"))}function yb(M,na){return zi.a.Gtd(64,function(){return window.OfficeExtension&&window.OfficeExtension.WacRuntime},Ye.AFrameworkApplication.fa.kd("MaxRetriesForLoadingScript",0),M,na)}function oc(M){var na=hj.call(this)||this;na.$=M;na.Eb();return na}function Jb(M,na){var Pa=this;this.UPa=this.VPa=null;this.sag=function(rb,cc){var Dc=null,Zc=null,nd=null;cc?(Object(wf.a)(529,cc)?(Dc=cc.lGa,nd=cc.instanceId):
Object(wf.a)(417,cc)&&(Dc=cc.get_element(),nd=cc.instanceId),Dc)?(Zc=Object(cg.a)(781,rb),Zc)?Pa.WMf(nd,Dc,Zc)||nd in Pa.UPa||(Pa.VPa[nd]=0,Pa.UPa[nd]=ak.a.instance.pE(function(){10<=Pa.VPa[nd]||Pa.WMf(nd,Dc,Zc)?(delete Pa.VPa[nd],Pa.UPa[nd].dispose(),delete Pa.UPa[nd]):Pa.VPa[nd]+=1},500,Ej.a.LJg,!0,!1)):Xd.ULS.sendTraceTag(537170624,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):Xd.ULS.sendTraceTag(537170625,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):
Xd.ULS.sendTraceTag(537170626,0,10,"Invalid parameter for ReadoutSelection")};this.ariaLiveNotifier=M;this.$=na;this.zXc=!1;this.$.da.Ga(224,this)}function dc(M){var na=Xf.call(this)||this;na.$=M;na.Eb();return na}function $a(M){var na=Dj.call(this,M)||this;na.handler=null;na.MAg=function(){Xd.ULS.sendTraceTag(38410434,0,50,"AddinUICommandHandlerFactory.ActivateFeature, isEditMode ["+na.$.isEditMode+"] ShowCommandUI ["+!!(na.$.Bd&16384)+"]");var Pa=new Ji.a;na.$.da.Za(53,function(je){Xd.ULS.sendTraceTag(38410435,
0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");Pa.setResult(je)});var rb=Pa.task,cc=new Sd,Dc=Uj.a.getInstance(),Zc=new de(na.$,Dc),nd=Mg.GetServiceTaskFactory.create(na.$.da,203,na.la,na.hb),Id=na.g9i(cc),Od=Mg.GetServiceTaskFactory.Ra(na.$.da,349,350,na.hb);return dg.TaskExtensions.Aa(dg.TaskExtensions.Vd([rb,nd,Id,Od],na.la),function(){Xd.ULS.sendTraceTag(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");
dg.TaskExtensions.Aa(Mg.GetServiceTaskFactory.create(na.$.da,106,na.la,na.hb),function(je){na.handler=new Ba(na.$,je.result,cc,new df,Dc,Zc,Xg.a.instance.nh("Common.IExternalUICommandDefinitionMapping"));Xd.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");na.jd([na.handler]);na.$.da.Ga(198,na.handler)},na.la,3)},na.la,3)};na.ldh=function(){void 0!==na.handler&&null!==na.handler?(na.$.Ka.nbb(na.handler),na.$.da.BU(198),na.handler=null):Xd.ULS.sendTraceTag(42341715,
0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");na.$.da.BU(204);Zj.a(Yj.a,21,na.$.da,198)};return na}function Ba(M,na,Pa,rb,cc,Dc,Zc){var nd=this;Zc=void 0===Zc?null:Zc;this.disposed=!1;this.JHi=function(Id,Od){if(Od)if(Od)if(Id=Od.Qj){Od=Od.uo;var je=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();if(Id.solutionId in je)Od=je[Id.solutionId];else if(Od=nd.DMh(Od),void 0===Od||null===Od){Xd.ULS.sendTraceTag(528098434,
220,15,"addinCommandControlId is NullOrUndefined");return}je=new Vh.a(Gg.a.y2,0,0,2,null);var Ae={};nd.executeCommand(0,je,(Ae.SourceControlId=Od,Ae),null);Id.isAutoLaunched=!0}else Xd.ULS.sendTraceTag(528098435,220,15,"insertionParam is null");else Xd.ULS.sendTraceTag(528098436,220,15,"agaveParams is null");else Xd.ULS.sendTraceTag(528098437,220,15,"No args for OnAutoLaunchAddin event")};this.oaf=function(Id,Od){"Insert"==Od.tabName&&(Id=nd.$.Ka,null!=Id&&(Id.sRf(nd.oaf),Xd.ULS.sendTraceTag(527286662,
220,50,"Remove insertTabSwitched handler")),nd.jBa.ZCj())};this.fPi=function(Id,Od){Id=null;Od&&(Id=Od);(null===Id||void 0===Id?0:Id.uo)&&nd.Ntj(Id.uo);nd.$.hf();af.EwaSettings.ma(88)&&Id&&Id.Qj&&nd.uOg(Id.Qj)};this.$=M;Xd.ULS.shipAssertTag(537170659,0,!(void 0===na||null===na),"AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: "+th.a.p3());this.se=na;this.QBe=Pa;this.s_b=rb;this.Yga=cc;this.Unb=Dc;this.Co=new dj.a;this.Xga=new we;this.H$c=Zc;gi.a.Rxb=gi.a.iRe;this.K5c=
new cf.a;this.G1a=new cf.a}function la(M){var na=this;this.$Fa=this.eGa=this.Qj=this.uo=null;this.tPf=0;this.ePi=function(){if(na.Qj&&na.$Fa){var Pa=new Vh.a(Gg.a.y2,0,0,2,null),rb={};na.addinUICommandHandler.executeCommand(0,Pa,(rb.SourceControlId=na.$Fa,rb),null);Xd.ULS.sendTraceTag(537170697,220,50,"Launch addin command has been triggered")}};this.DAj=function(Pa,rb){Pa=null;if(rb)if(Pa=rb,na.Qj=Pa.Qj,na.uo=Pa.uo,na.uo&&na.uo.ZV&&na.uo.ZV.Fs&&(na.eGa=na.uo.ZV.Fs.na(0)),na.eGa&&na.eGa.id)if(na.eGa.isOfficeTab)if(rb=
OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),Pa=na.Qj.solutionId,Pa in rb?na.$Fa=rb[Pa]:(Xd.ULS.sendTraceTag(537170695,220,15,"Failed to get button id from controlIdMap for add-in: "+la.GetPrivacyCompliantId(na.Qj)),na.$Fa=na.OIh(na.uo)),na.$Fa)if(yi.a.contains(na.eGa.id,qh.a.uW,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Xh.a.w3a(na.uo),function(){na.M4f(na.Yfd(na.$Fa))});else{if(rb=na.$.Ka)rb.Coe(na.NDf),Xd.ULS.sendTraceTag(537170693,220,50,"ShowCalloutOnAddin registered a tab switched event")}else Xd.ULS.sendTraceTag(537170694,
220,10,"Failed to get button id for addin"),rb={},rb=(rb.AppTeachingUICalloutAction="NoEnabledButtonFound",rb["SDX.Id"]=la.GetPrivacyCompliantId(na.Qj),rb.AppTeachingUICalloutGoal="NewAdminDeployment",rb["SDX.AppInstallOrigin"]="Organization",rb),ug.a.sendTelemetryEvent(Object(Tg.a)(new vg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ag.a.Gk(rb)})),na.V5();else na.O4f(na.Yfd(na.eGa.id),0);else Xd.ULS.sendTraceTag(537170696,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),
rb={},rb=(rb.AppTeachingUICalloutAction="NoTabFound",rb["SDX.Id"]=la.GetPrivacyCompliantId(na.Qj),rb.AppTeachingUICalloutGoal="NewAdminDeployment",rb["SDX.AppInstallOrigin"]="Organization",rb),ug.a.sendTelemetryEvent(Object(Tg.a)(new vg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ag.a.Gk(rb)})),na.V5();else na.V5()};this.NDf=function(){if(yi.a.contains(na.eGa.id,appChrome.selectors.getSelectedTabId(),!0)){var Pa=na.$.Ka;Pa&&Pa.sRf(na.NDf);na.M4f(na.Yfd(na.$Fa))}};this.gPi=
function(){var Pa={};Pa=(Pa.AppTeachingUICalloutAction="ClickOnLaunch",Pa["SDX.Id"]=la.CUa(na.jC),Pa.AppTeachingUICalloutGoal="NewAdminDeployment",Pa["SDX.AppInstallOrigin"]="Organization",Pa);ug.a.sendTelemetryEvent(Object(Tg.a)(new vg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ag.a.Gk(Pa)}));na.V5();var rb={};rb[ch.a.Wf]=na.jC;Pa={};Pa.solutionId=na.jC.solutionId;Pa.assetId=na.jC.assetId;Pa.assetStoreId=na.jC.assetStoreId;Pa.height=0!=na.jC.height?na.jC.height:600;Pa.storeId=
na.jC.storeId;Pa.storeType=na.jC.storeType;Pa.targetType=na.jC.targetType;Pa.width=0!=na.jC.width?na.jC.width:600;Pa.displayName=na.jC.displayName;Pa.version=na.jC.version;Pa.isAddinCommands=!1;rb[hf.a.Sra]=Pa;var cc=new Vh.a(-741808261,0,0,2,null);dg.TaskExtensions.Aa(Mg.GetServiceTaskFactory.Ra(na.$.da,374,375,1),function(Dc){Dc=Dc.result;null!=Dc&&Dc.insertAgave(rb,cc)},na.$.la,3)};this.WIi=function(){var Pa={};Pa=(Pa.AppTeachingUICalloutAction="ClickOnClose",Pa["SDX.Id"]=la.CUa(na.jC),Pa.AppTeachingUICalloutGoal=
"NewAdminDeployment",Pa["SDX.AppInstallOrigin"]="Organization",Pa);ug.a.sendTelemetryEvent(Object(Tg.a)(new vg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ag.a.Gk(Pa)}));na.V5()};this.rKi=function(){var Pa={};Pa=(Pa.AppTeachingUICalloutAction="ClickOnDismiss",Pa["SDX.Id"]=la.CUa(na.jC),Pa.AppTeachingUICalloutGoal="NewAdminDeployment",Pa["SDX.AppInstallOrigin"]="Organization",Pa);ug.a.sendTelemetryEvent(Object(Tg.a)(new vg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:Ag.a.Gk(Pa)}));na.V5()};this.kW=function(Pa){Xd.ULS.sendTraceTag(522981591,306,10,"failed to POST data to Roaming Settings Service with status: "+(Pa?Pa.httpStatus:-1))};this.$=M.$;this.addinUICommandHandler=M;this.appName=Ye.AFrameworkApplication.fa.Wa("WebAppShortName")||"Excel";this.XIg=Ye.AFrameworkApplication.fa.kd("AddinMaxDOMElementDetectionTimesForTeachingUI",10)}function ka(M,na){this.ykb=M;this.GUa=new Wa;this.fVa=new sa(na)}function ca(M,na,Pa,rb,cc,Dc){this.TQb=new cf.a;this.Phb=
this.ifa=this.tVa=null;this.RNc=M;this.GUa=na;this.fVa=Pa;this.$w=rb;this.WQb=cc;this.g6d=Dc}function Ia(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}function jb(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}function nb(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}function Na(){this.iconLocation=this.title=this.id=
null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}function sa(M){this.UCa=M}function Wa(){}function Hb(M){this.ykb=M}function Yb(M,na,Pa){this.EI=this.sVa=null;this.RNc=M;this.fVa=na;this.GUa=Pa;this.Gtg=new cf.a}function Sb(M){this.Epa=null;if(bh.c(M))throw Xd.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=M}function lb(M){this.bbe=null;if(bh.c(M))throw Xd.ULS.sendTraceTag(9175313,
220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=M;this.xla[wa.id]=this._id}function wb(M,na){this.nEa=this.g4d=null;if(bh.c(M)||bh.c(na))throw Xd.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");this.Sng=na;this._id=M;this.nU[wa.id]=this._id}function wa(){}function Oa(M,na,Pa,rb,
cc,Dc,Zc,nd){nd=void 0===nd?null:nd;this.$a=new Ih.a;this.LEc=M;this.Mng=na;this.Jm=Pa;this.Cie=rb;this.oXa=cc;this.elg=Dc;this.WQb=Zc;this.iug=nd;this.Vrg=Ye.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled");this.HKc=Ye.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")}function Ub(M,na,Pa,rb,cc,Dc,Zc){this.LSa=new Bj.a;this.Vr=M;this.Th=na;this.Co=Pa;this.ribbonManager=rb;this.contextMenuManager=cc;this.EF=
Dc;this.Xga=Zc;this.qO=Ye.AFrameworkApplication.ta.sD}function hb(M,na,Pa){this.E1d=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=M;this.eventBuilder=na;this.contextMenuBuilder=Pa}function Xb(M){this.Uog=M.entitlement}function Gc(M,na,Pa){na=void 0===na?null:na;Pa=void 0===Pa?0:Pa;if(bh.c(M))throw Xd.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");
this.qug=M;this.Pxg=na;this.Xpg=Pa}function uc(M){this.sce=null;if(bh.c(M))throw Xd.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.qlg=M}function Nc(){}function Fb(M){this.y$d=null;this.u8d=M}function ob(M,na,Pa){this.QQa=!1;this.AX=null;this.$a=M;this.qjb=na;this.Kgb=Pa}function zb(M,na,Pa,rb,cc,Dc){this.Vr=M;this.Qj=na;this.OW=Pa;this.displayName=cc;this.xjf=Dc}function ib(){new fc(oi.a.instance)}
function fc(M){this.fEa=M}function Ic(){this.Ver=1}function Yc(){}function Mc(M){this.xug=M}function xb(M,na,Pa){this.Pa=new Ih.a;this.context=new Je;this.aSc=this.l7f=this.tTd=this.bGa=this.cI=this.AX=null;this.contextActivationMgr=M;this.UIg=na;this.t_b=Pa;this.appName=Ye.AFrameworkApplication.fa.Wa("WebAppShortName")}function wc(){this.addinId=null;this.targetType=0;this.storeId=this.solutionId=null}function Ob(M){var na=Li.call(this)||this;na.properties=M;return na}function nc(){this.lA=this.Vp=
null;this._count=0}function mb(M,na,Pa){this.next=Pa;this.previous=na;this.data=M}function ic(M){this.yr=null;this.gA=M}function qc(M){var na=-1;switch(M.toLowerCase()){case "omex":na=0;break;case "spcatalog":na=1;break;case "spapp":na=2;break;case "filesystem":na=3;break;case "exchange":na=4;break;case "registry":na=6;break;case "inmemory":na=7;break;case "uploadfiledevcatalog":na=8;break;case "hardcodedpreinstall":na=9;break;case "excatalog":na=10;break;case "wopicatalog":na=16}return na}function hc(M){var na=
null;switch(M){case 0:na="omex";break;case 1:na="spcatalog";break;case 2:na="spapp";break;case 3:na="filesystem";break;case 4:na="exchange";break;case 6:na="registry";break;case 7:na="inmemory";break;case 8:na="uploadfiledevcatalog";break;case 9:na="hardcodedpreinstall";break;case 10:na="excatalog";break;case 16:na="wopicatalog"}return na}function Jc(M){var na={};na.solutionId=M.solutionId;na.version=M.version;na.storeType=M.storeType;na.storeId=M.storeId;na.assetId=M.assetId;na.assetStoreId=M.assetStoreId;
na.targetType=M.targetType;na.requireConsent=M.requireConsent||!1;na.isAddinCommands=!0;na.addinCommandsActionType=0;return na}function rd(){var M=wi.a.GZ(window.location.href.toLowerCase(),"wdomexsrctype");return!!M&&"1"===M}function md(){return wi.a.GZ(window.location.href.toLowerCase(),"wdtpl")}function Cc(){var M=wi.a.GZ(window.location.href.toLowerCase(),"wdomexsrctype");return!!M&&"4"===M}function fd(M){this.XYa=this.Qj=null;this.QQa=!1;this.WRb=this.VQb=this.Hma=this.Th=this.AX=this.cI=null;
this.Pa=M}function Cd(M){var na=vi.call(this)||this;na.solutionId=M.solutionId;na.assetId=M.assetId;na.storeType=M.storeType;na.storeId=M.storeId;na.assetStoreId=M.assetStoreId;na.targetType=M.targetType;na.width=M.width;na.height=M.height;na.displayName=M.displayName;na.version=M.version;return na}function Sc(M,na,Pa,rb){this.MJb=Ye.AFrameworkApplication.fa.Wa("RoamingServiceHandlerWebServiceBase");this.appName=M;this.Yib=na;this.Uib=Pa;this.blb=void 0===rb?null:rb}function Md(){var M=Ki.call(this)||
this;M.Qj=null;M.uo=null;return M}function bc(){this.addinId=null;this.targetType=0;this.storeId=this.solutionId=null}function xe(){}function Je(){this.Vr=this.wR=0;this.KVc=null;this.Wqc=this.EAc=0;this.hrb=this.kja=this.I2=null}function we(){this.UYa=null}function de(M,na){var Pa=ui.call(this)||this;Pa.statusBarManager=null;Pa.agaveCommandManager=null;Pa.Sye=function(){Pa.EF&&Pa.EF.yye()};Pa.Z4e=function(){Pa.raiseEvent("LAC")};Pa.Uc=function(rb,cc){!rb.dc&&aj.b(cc)&&Pa.statusBarManager&&(Pa.statusBarManager.wF(Pa),
Pa.statusBarManager=null)};Pa.EF=na;Pa.$=M;Pa.OGj=M.zb+"OfficeAddinLabel-Medium14";Pa.$.da.Za(29,function(rb){Pa.statusBarManager=rb;rb.gJ(Pa)});Pa.$.ea.Vj(Pa.Uc);Pa.EF.ZEg(Pa.Z4e);Pa.$.da.Za(206,function(rb){Pa.agaveCommandManager=rb;rb.zGg(Pa.Sye)});return Pa}function Le(){}function Ie(){this.mi=null;this.visible=!1}function jf(M,na){this.Va=M;this.t3g=na}function df(){this.k2d=this.tEc=null}function Be(){}function Sd(){this.Lmg=new cf.a}function vc(M){var na=$i.call(this)||this;na.$=M;na.Eb();
return na}function qd(M){this.wb=null;this.$=M}function Jd(){return qa.call(this)||this}function ld(){return qa.call(this)||this}function Kd(){return qa.call(this)||this}function re(){return qa.call(this)||this}function ie(){return qa.call(this)||this}function ef(){return qa.call(this)||this}function Fe(){return qa.call(this)||this}function bf(){return qa.call(this)||this}function Oe(){return qa.call(this)||this}function lc(){return qa.call(this)||this}function Fa(){return qa.call(this)||this}function Kb(){return qa.call(this)||
this}function gb(){return qa.call(this)||this}function Tb(){return qa.call(this)||this}function pc(){return qa.call(this)||this}function Xc(){return qa.call(this)||this}function pd(){return qa.call(this)||this}function Uc(){return qa.call(this)||this}function sd(){return qa.call(this)||this}function Nb(){return qa.call(this)||this}function Ja(){return qa.call(this)||this}function Lb(){return qa.call(this)||this}function ec(){return qa.call(this)||this}function Zb(){return qa.call(this)||this}function Oc(){return qa.call(this)||
this}function td(){return qa.call(this)||this}function Gd(){return qa.call(this)||this}function Pd(){return qa.call(this)||this}function ee(){return qa.call(this)||this}function Ec(){return qa.call(this)||this}function $c(){return qa.call(this)||this}function id(){return qa.call(this)||this}function vd(){return qa.call(this)||this}function he(){return qa.call(this)||this}function Ge(){return qa.call(this)||this}function Ze(){return qa.call(this)||this}function gf(){return qa.call(this)||this}function Df(){return qa.call(this)||
this}function mc(){return qa.call(this)||this}function sc(){return qa.call(this)||this}function hd(){return qa.call(this)||this}function cd(){return qa.call(this)||this}function Ed(){return qa.call(this)||this}function ge(){return qa.call(this)||this}function Nd(){return qa.call(this)||this}function Ld(){return qa.call(this)||this}function De(){return qa.call(this)||this}function ke(){return qa.call(this)||this}function db(){return qa.call(this)||this}function Qb(){return qa.call(this)||this}function Fc(){return qa.call(this)||
this}function Tc(){return qa.call(this)||this}function zd(){return qa.call(this)||this}function Wc(){return qa.call(this)||this}function dd(){return qa.call(this)||this}function oe(){return qa.call(this)||this}function Fd(){return qa.call(this)||this}function We(){return zc.call(this,195,16)||this}function zf(){return zc.call(this,194,8)||this}function Cf(){return qa.call(this)||this}function pf(){return zc.call(this,198,2)||this}function Hf(){return zc.call(this,197,1)||this}function Qa(){return zc.call(this,
196,32)||this}function Mb(){return qa.call(this)||this}function kc(){return zc.call(this,193,4)||this}function zc(M,na){var Pa=qa.call(this)||this;Pa.vfa=M;Pa.NZd=na;return Pa}function Ib(){return qa.call(this)||this}function rc(){return qa.call(this)||this}function Ta(){return qa.call(this)||this}function Cb(){return qa.call(this)||this}function jc(){return qa.call(this)||this}function tc(){return qa.call(this)||this}function kd(){return Ud.call(this,11,16)||this}function Rd(){return Ud.call(this,
10,128)||this}function pe(){return qa.call(this)||this}function le(){return qa.call(this)||this}function Wd(){return qa.call(this)||this}function ve(){return qa.call(this)||this}function Se(){return qa.call(this)||this}function Ve(){return qa.call(this)||this}function Va(){return qa.call(this)||this}function Rb(){return qa.call(this)||this}function Lc(){return qa.call(this)||this}function od(){return Ud.call(this,9,2)||this}function yd(){return Ud.call(this,8,1)||this}function ce(){return Ud.call(this,
7,8)||this}function $d(){return Ud.call(this,6,32)||this}function Ce(){return qa.call(this)||this}function Ue(){return qa.call(this)||this}function Xa(){return qa.call(this)||this}function Bb(){return qa.call(this)||this}function gc(){return qa.call(this)||this}function Pc(){return qa.call(this)||this}function gd(){return qa.call(this)||this}function ud(){return qa.call(this)||this}function Hd(){return qa.call(this)||this}function Zd(){return qa.call(this)||this}function fe(){return qa.call(this)||
this}function ye(){return qa.call(this)||this}function Qe(){return qa.call(this)||this}function Me(){return qa.call(this)||this}function kf(){return Ud.call(this,4,64)||this}function Kf(){return qa.call(this)||this}function Pf(){return qa.call(this)||this}function se(){return qa.call(this)||this}function Ac(){return qa.call(this)||this}function ad(){return qa.call(this)||this}function r(){return qa.call(this)||this}function $b(){return qa.call(this)||this}function yc(){}function Qc(){return qa.call(this)||
this}function jd(){return Ud.call(this,3,4)||this}function Ud(M,na){var Pa=qa.call(this)||this;Pa.vfa=M;Pa.NZd=na;return Pa}function Yd(){return qa.call(this)||this}function ue(){return qa.call(this)||this}function me(){return qa.call(this)||this}function Xe(){return qa.call(this)||this}function He(){return qe.call(this,185,18)||this}function lf(){return qa.call(this)||this}function rf(){return qe.call(this,181,14)||this}function tf(){return qe.call(this,169,2)||this}function vf(){return qe.call(this,
168,1)||this}function Tf(){return qa.call(this)||this}function gg(){return qe.call(this,182,15)||this}function Qf(){return qa.call(this)||this}function Rg(){return qa.call(this)||this}function Sg(){return qe.call(this,180,13)||this}function Og(){return qe.call(this,186,19)||this}function Eg(){return qe.call(this,175,8)||this}function Ig(){return qe.call(this,176,9)||this}function gh(){return qe.call(this,187,20)||this}function yg(){return qe.call(this,174,7)||this}function hg(){return qe.call(this,
179,12)||this}function ab(){return qe.call(this,178,11)||this}function Pb(){return qe.call(this,177,10)||this}function xc(){return qa.call(this)||this}function Vc(){return qe.call(this,170,3)||this}function Bc(){return qe.call(this,172,5)||this}function Ad(){return qe.call(this,173,6)||this}function Td(){return qe.call(this,183,16)||this}function ze(){return qe.call(this,184,17)||this}function te(){return qe.call(this,171,4)||this}function qe(M,na){var Pa=qa.call(this)||this;Pa.vfa=M;Pa.opType=na;
return Pa}function Te(){return qa.call(this)||this}function nf(){return qa.call(this)||this}function Ya(){return qa.call(this)||this}function Da(){return qa.call(this)||this}function Gb(){return qa.call(this)||this}function xd(){return qa.call(this)||this}function Qd(){return qa.call(this)||this}function Ee(){return qa.call(this)||this}function Pe(){return qa.call(this)||this}function uf(){return qa.call(this)||this}function Bf(){return qa.call(this)||this}function qf(){return qa.call(this)||this}
function Of(){return qa.call(this)||this}function bg(){return qa.call(this)||this}function lg(){return qa.call(this)||this}function xg(){return qa.call(this)||this}function Ug(){return qa.call(this)||this}function wg(){return qa.call(this)||this}function zg(){return qa.call(this)||this}function kh(){return qa.call(this)||this}function Gf(){return qa.call(this)||this}function Lg(){return jh.call(this)||this}function Qg(){return qa.call(this)||this}function Zg(){return qa.call(this)||this}function $g(){return qa.call(this)||
this}function oh(){return qa.call(this)||this}function ah(){return qa.call(this)||this}function Wg(){return qa.call(this)||this}function pg(){return qa.call(this)||this}function Vg(){return qa.call(this)||this}function nh(){return qa.call(this)||this}function Oh(){return kb.call(this,78,[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,-125,-124,-126,-216,-217,-218,-219,-221,-222,-220,-129,-130,-131])||this}function Yg(){return kb.call(this,79,[0,1,2,
-102])||this}function fh(){return kb.call(this,75,[-101])||this}function Lf(){return kb.call(this,81,[100,101,102,103,104,105,106])||this}function kg(){return qa.call(this)||this}function Fh(){return kb.call(this,85,[328,329,330,331,332,333,334,335])||this}function Dg(){return jh.call(this)||this}function hh(M,na,Pa){this.response=this.request=this.eventId=this.source=null;M&&(this.source=M.source,this.eventId=M.eventId,this.request=na,this.response=Pa)}function jh(){return qa.call(this)||this}function sh(){return kb.call(this,
83,[500,501,502])||this}function Ca(){return kb.call(this,76,[-100])||this}function C(){return kb.call(this,82,[200,201,202,203,204,205,206,207,208,209,210])||this}function R(){return kb.call(this,80,[-104,-103,300,301,302,303,304,305,306,307,308,309,310,311])||this}function ua(){return kb.call(this,84,[348,349,350,351,352,353,354,355,356,357,372,373,374,375])||this}function kb(M,na){var Pa=qa.call(this)||this;Pa.vfa=M;Pa.RWj=na;return Pa}function za(){return qa.call(this)||this}function Hc(){return qa.call(this)||
this}function ed(){return qa.call(this)||this}function W(){return qa.call(this)||this}function qa(){this.uIc=this.vIc=this.rOc=this.RSc=null}function tb(M,na,Pa){var rb=this;this.j$b=null;this.Wyi=function(cc,Dc){rb.F2f()&&rb.Gad(Dc)};this.Zof=na;this.Yof=Pa;this.$=M;this.$.Nba&&this.$.pHg(this.Wyi);M.da.Ga(297,this)}function Vb(){}function Rc(){}function Bd(){this.Vgb=null}b.r(E);var Vd=b(567),ae=b(1480),ne=b(1392),Ne=b(10),Dd=b(0),$e=b(235),cf=b(192),Ff=b(657);Bd.prototype.agi=function(M){return this.XOg.contains(M.operation)};
Bd.prototype.ZPj=function(M){for(var na=[],Pa=ik(M.payload.batchedOperations),rb=Pa.next();!rb.done;rb=Pa.next())na.push(new Ff.a(M.operation,rb.value));return na};of.Object.defineProperties(Bd.prototype,{XOg:{configurable:!0,enumerable:!0,get:function(){this.Vgb||(this.Vgb=new cf.a,this.Vgb.add(12),this.Vgb.add(11));return this.Vgb}}});Object(Dd.a)(Bd,"MacroRecorderBatchedEventList",null,[]);var Xd=b(15),sf=b(54),If=b(127),$f=b(746);Rc.prototype.equals=function(M,na){return M===na};Rc.prototype.getHashCode=
function(M){return M};Rc.prototype.Aja=function(M){return M};Object(Dd.a)(Rc,"UserOperationNameComparer",null,[19,20]);Vb.I1h=function(){Vb.Hc||(Vb.Hc=new $f.a(new Rc),Vb.Hc.add(507),Vb.Hc.add(10),Vb.Hc.add(576),Vb.Hc.add(563),Vb.Hc.add(564),Vb.Hc.add(565),Vb.Hc.add(566),Vb.Hc.add(567),Vb.Hc.add(568),Vb.Hc.add(569),Vb.Hc.add(570),Vb.Hc.add(571),Vb.Hc.add(572),Vb.Hc.add(573),Vb.Hc.add(574),Vb.Hc.add(575),Vb.Hc.add(501),Vb.Hc.add(520),Vb.Hc.add(1),Vb.Hc.add(1002),Vb.Hc.add(129),Vb.Hc.add(198),Vb.Hc.add(500),
Vb.Hc.add(519),Vb.Hc.add(538),Vb.Hc.add(1E3),Vb.Hc.add(1003),Vb.Hc.add(144),Vb.Hc.add(502),Vb.Hc.add(505),Vb.Hc.add(179),Vb.Hc.add(205),Vb.Hc.add(134),Vb.Hc.add(230),Vb.Hc.add(103),Vb.Hc.add(110),Vb.Hc.add(112),Vb.Hc.add(113),Vb.Hc.add(124),Vb.Hc.add(133),Vb.Hc.add(154),Vb.Hc.add(162),Vb.Hc.add(168),Vb.Hc.add(172),Vb.Hc.add(201),Vb.Hc.add(222),Vb.Hc.add(227),Vb.Hc.add(513),Vb.Hc.add(534),Vb.Hc.add(539),Vb.Hc.add(545),Vb.Hc.add(600),Vb.Hc.add(547),Vb.Hc.add(555),Vb.Hc.add(558),Vb.Hc.add(562),Vb.Hc.add(585),
Vb.Hc.add(1001),Vb.Hc.add(1005),Vb.Hc.add(1008),Vb.Hc.add(1010),Vb.Hc.add(1011),Vb.Hc.add(1012),Vb.Hc.add(1018),Vb.Hc.add(252),Vb.Hc.add(253),Vb.Hc.add(258),Vb.Hc.add(101),Vb.Hc.add(102),Vb.Hc.add(108),Vb.Hc.add(257),Vb.Hc.add(119),Vb.Hc.add(120),Vb.Hc.add(123),Vb.Hc.add(126),Vb.Hc.add(127),Vb.Hc.add(130),Vb.Hc.add(140),Vb.Hc.add(159),Vb.Hc.add(160),Vb.Hc.add(165),Vb.Hc.add(166),Vb.Hc.add(167),Vb.Hc.add(169),Vb.Hc.add(189),Vb.Hc.add(223),Vb.Hc.add(214),Vb.Hc.add(228),Vb.Hc.add(233),Vb.Hc.add(247),
Vb.Hc.add(504),Vb.Hc.add(511),Vb.Hc.add(512),Vb.Hc.add(525),Vb.Hc.add(533),Vb.Hc.add(537),Vb.Hc.add(542),Vb.Hc.add(544),Vb.Hc.add(548),Vb.Hc.add(550),Vb.Hc.add(551),Vb.Hc.add(552),Vb.Hc.add(554),Vb.Hc.add(577),Vb.Hc.add(584),Vb.Hc.add(586),Vb.Hc.add(587),Vb.Hc.add(588),Vb.Hc.add(592),Vb.Hc.add(1009),Vb.Hc.add(1016),Vb.Hc.add(1017));return Vb.Hc};Vb.Hc=null;Object(Dd.a)(Vb,"MacroRecorderUnrecognizedEventList",null,[]);tb.prototype.init=function(M){this.$.Nba&&(M?this.j$b=M:Xd.ULS.sendTraceTag(537155424,
0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))};tb.prototype.Gad=function(M){if(this.F2f())try{if(this.Yof.agi(M))for(var na=this.Yof.ZPj(M),Pa=ik(na),rb=Pa.next();!rb.done;rb=Pa.next())this.KTe(rb.value);else this.KTe(M)}catch(cc){M="MacroRecorderEventHandler.FireMacroRecorderEvent: Error: "+If.a(M.operation)+", Exception: "+cc.stack,Xd.ULS.sendTraceTag(537155423,0,10,M)}};tb.prototype.KTe=function(M){var na=this.Zof.M_e(M,!0);na?(this.j$b(na.eventId,sf.a.xc(M.payload)),
Xd.ULS.sendTraceTag(537155422,0,50,"MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: "+na.eventId)):(na=this.Zof.M_e(M,!1))?Xd.ULS.sendTraceTag(537155421,0,50,"MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: "+na.eventId+", but failed to match filters"):Vb.I1h().contains(M.operation)||(this.j$b(0,sf.a.xc(M.operation)),M="MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: "+If.a(M.operation),Xd.ULS.sendTraceTag(537155420,0,50,M))};tb.prototype.F2f=function(){return this.$.Lka&&
this.j$b&&this.$.Jba?!0:!1};Object(Dd.a)(tb,"MacroRecorderEventHandler",null,[845]);var af=b(1);qa.prototype.jg=function(){};qa.prototype.kwa=function(){};qa.prototype.hd=function(M){this.UCc.add(M)};qa.prototype.Nb=function(M){this.operations.contains(M)||this.operations.add(M)};qa.prototype.knb=function(){this.featureGates.add(675)};qa.prototype.Cle=function(M){this.nSe.add(M)};of.Object.defineProperties(qa.prototype,{operations:{configurable:!0,enumerable:!0,get:function(){this.rOc||(this.rOc=
new cf.a,this.Xb());return this.rOc}},UCc:{configurable:!0,enumerable:!0,get:function(){this.RSc||(this.RSc=new cf.a,this.jg());return this.RSc}},nSe:{configurable:!0,enumerable:!0,get:function(){this.uIc||(this.uIc=new cf.a);return this.uIc}},featureGates:{configurable:!0,enumerable:!0,get:function(){this.vIc||(this.vIc=new cf.a,this.kwa());return this.vIc}}});Object(Dd.a)(qa,"MacroRecorderEventBase",null,[]);$k(W,qa);W.prototype.Xb=function(){this.Nb(100)};of.Object.defineProperties(W.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 130}}});Object(Dd.a)(W,"AccessibilityCheckRunEvent",qa,[]);$k(ed,qa);ed.prototype.Xb=function(){this.Nb(241)};ed.prototype.jg=function(){this.hd(function(M){return M.addToPrintArea})};of.Object.defineProperties(ed.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 160}}});Object(Dd.a)(ed,"AddedToPrintAreaEvent",qa,[]);$k(Hc,qa);Hc.prototype.Xb=function(){this.Nb(516)};of.Object.defineProperties(Hc.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 65}}});Object(Dd.a)(Hc,"AutoFilterToggledEvent",qa,[]);$k(za,qa);za.prototype.Xb=function(){this.Nb(502)};za.prototype.jg=function(){this.hd(function(M){return!(M.C4a().FirstColumn===M.C4a().LastColumn&&M.C4a().FirstRow===M.C4a().LastRow)})};of.Object.defineProperties(za.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 118}}});Object(Dd.a)(za,"AutoSumEvent",qa,[]);$k(kb,qa);kb.prototype.Xb=function(){this.Nb(529);this.Nb(594)};kb.prototype.jg=
function(){var M=this;this.hd(function(na){return M.RWj.includes(na.Dfd())})};of.Object.defineProperties(kb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.vfa}}});Object(Dd.a)(kb,"ChartPropertyAppliedEventBase",qa,[]);$k(ua,kb);Object(Dd.a)(ua,"ChartAxisChangedEvent",kb,[]);$k(R,kb);Object(Dd.a)(R,"ChartAxisTitleChangedEvent",kb,[]);$k(C,kb);Object(Dd.a)(C,"ChartDataLabelsChangedEvent",kb,[]);$k(Ca,kb);Object(Dd.a)(Ca,"ChartDataSelectedEvent",kb,[]);$k(sh,kb);Object(Dd.a)(sh,
"ChartDataTableChangedEvent",kb,[]);var mg=b(625),wf=b(445),cg=b(85);$k(jh,qa);Object(Dd.a)(jh,"RichApiRequestExecutedEventBase",qa,[]);of.Object.defineProperties(hh.prototype,{isValid:{configurable:!0,enumerable:!0,get:function(){return!(void 0===this.source||null===this.source)&&!(void 0===this.eventId||null===this.eventId)&&!0}}});Object(Dd.a)(hh,"MacroRecorderRichApiRequestExecutedPayload",null,[430]);$k(Dg,jh);Dg.prototype.bF=function(M){Dg.d7||(Dg.d7=new $f.a(mg.a.Jk()),Dg.d7.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),
Dg.d7.add("fa000000014"));return!!M&&Dg.d7.contains(M.toLowerCase())};Dg.prototype.Xb=function(){this.Nb(507);this.Nb(10);this.Nb(576)};Dg.prototype.jg=function(){var M=this;this.hd(function(na){return Object(wf.a)(hh,na)&&(na=Object(cg.a)(hh,na),na.isValid&&M.bF(na.source))?(Xd.ULS.sendTraceTag(537155427,0,50,"[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: "+na.eventId),!0):!1})};of.Object.defineProperties(Dg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 117}}});
Dg.d7=null;Object(Dd.a)(Dg,"ChartFormatRichApiRequestExecutedEvent",jh,[]);$k(Fh,kb);Object(Dd.a)(Fh,"ChartGridlinesChangedEvent",kb,[]);$k(kg,qa);kg.prototype.Xb=function(){this.Nb(528)};of.Object.defineProperties(kg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 66}}});Object(Dd.a)(kg,"ChartInsertedEvent",qa,[]);$k(Lf,kb);Object(Dd.a)(Lf,"ChartLegendChangedEvent",kb,[]);$k(fh,kb);Object(Dd.a)(fh,"ChartRowColumnSwitchedEvent",kb,[]);$k(Yg,kb);Object(Dd.a)(Yg,"ChartTitleChangedEvent",
kb,[]);$k(Oh,kb);Object(Dd.a)(Oh,"ChartTypeChangedEvent",kb,[]);$k(nh,qa);nh.prototype.Xb=function(){this.Nb(521)};of.Object.defineProperties(nh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 131}}});Object(Dd.a)(nh,"ConnectorFloatingObjectResizedEvent",qa,[]);$k(Vg,qa);Vg.prototype.Xb=function(){this.Nb(109)};of.Object.defineProperties(Vg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 129}}});Object(Dd.a)(Vg,"EntitySelectedEvent",qa,[]);$k(pg,qa);
pg.prototype.Xb=function(){this.Nb(149);this.Nb(147)};of.Object.defineProperties(pg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 49}}});Object(Dd.a)(pg,"FindCellEvent",qa,[]);$k(Wg,qa);Wg.prototype.Xb=function(){this.Nb(122)};of.Object.defineProperties(Wg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 96}}});Object(Dd.a)(Wg,"FloatingObjectAltTextAppliedEvent",qa,[]);$k(ah,qa);ah.prototype.Xb=function(){this.Nb(522)};of.Object.defineProperties(ah.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 93}}});Object(Dd.a)(ah,"FloatingObjectDeletedEvent",qa,[]);$k(oh,qa);oh.prototype.Xb=function(){this.Nb(524)};of.Object.defineProperties(oh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 94}}});Object(Dd.a)(oh,"FloatingObjectMovedAndResizedEvent",qa,[]);$k($g,qa);$g.prototype.Xb=function(){this.Nb(523)};of.Object.defineProperties($g.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 95}}});
Object(Dd.a)($g,"FloatingObjectRotatedEvent",qa,[]);$k(Zg,qa);Zg.prototype.Xb=function(){this.Nb(543)};of.Object.defineProperties(Zg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 100}}});Object(Dd.a)(Zg,"GroupDetailsShownOrHiddenEvent",qa,[]);$k(Qg,qa);Qg.prototype.Xb=function(){this.Nb(125)};of.Object.defineProperties(Qg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 154}}});Object(Dd.a)(Qg,"HyperlinksRemovedFromRangeEvent",qa,[]);$k(Lg,jh);Lg.prototype.bF=
function(M){Lg.d7||(Lg.d7=new $f.a(mg.a.Jk()),Lg.d7.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),Lg.d7.add("fa000000005"));return!!M&&Lg.d7.contains(M.toLowerCase())};Lg.prototype.Xb=function(){this.Nb(507);this.Nb(10);this.Nb(576)};Lg.prototype.jg=function(){var M=this;this.hd(function(na){return Object(wf.a)(hh,na)?(na=Object(cg.a)(hh,na),na.isValid&&M.bF(na.source)):!1})};of.Object.defineProperties(Lg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 125}}});Lg.d7=null;Object(Dd.a)(Lg,
"IdeasRichApiRequestExecutedEvent",jh,[]);$k(Gf,qa);Gf.prototype.Xb=function(){this.Nb(115)};of.Object.defineProperties(Gf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 136}}});Object(Dd.a)(Gf,"LinkedEntityConvertedEvent",qa,[]);$k(kh,qa);kh.prototype.Xb=function(){this.Nb(114)};of.Object.defineProperties(kh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 148}}});Object(Dd.a)(kh,"LinkedEntityDisambiguationPaneToggledEvent",qa,[]);$k(zg,qa);zg.prototype.Xb=
function(){this.Nb(119)};of.Object.defineProperties(zg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 127}}});Object(Dd.a)(zg,"MovedToEdgeEvent",qa,[]);$k(wg,qa);wg.prototype.Xb=function(){this.Nb(191)};wg.prototype.kwa=function(){this.knb()};of.Object.defineProperties(wg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 135}}});Object(Dd.a)(wg,"NamedSheetViewCreatedEvent",qa,[]);$k(Ug,qa);Ug.prototype.Xb=function(){this.Nb(200)};Ug.prototype.kwa=function(){this.knb()};
of.Object.defineProperties(Ug.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 166}}});Object(Dd.a)(Ug,"NamedSheetViewDeletedEvent",qa,[]);$k(xg,qa);xg.prototype.Xb=function(){this.Nb(192)};xg.prototype.kwa=function(){this.knb()};of.Object.defineProperties(xg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 133}}});Object(Dd.a)(xg,"NamedSheetViewExitedEvent",qa,[]);$k(lg,qa);lg.prototype.Xb=function(){this.Nb(199)};lg.prototype.kwa=function(){this.knb()};
of.Object.defineProperties(lg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 162}}});Object(Dd.a)(lg,"NamedSheetViewRenamedEvent",qa,[]);$k(bg,qa);bg.prototype.Xb=function(){this.Nb(195)};bg.prototype.kwa=function(){this.knb()};of.Object.defineProperties(bg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 167}}});Object(Dd.a)(bg,"NamedSheetViewSwitchedEvent",qa,[]);$k(Of,qa);Of.prototype.Xb=function(){this.Nb(174)};of.Object.defineProperties(Of.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 99}}});Object(Dd.a)(Of,"OutlineLevelSetEvent",qa,[]);$k(qf,qa);qf.prototype.Xb=function(){this.Nb(244)};of.Object.defineProperties(qf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 156}}});Object(Dd.a)(qf,"PageBreakInsertedEvent",qa,[]);$k(Bf,qa);Bf.prototype.Xb=function(){this.Nb(245)};of.Object.defineProperties(Bf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 157}}});Object(Dd.a)(Bf,
"PageBreakRemovedEvent",qa,[]);$k(uf,qa);uf.prototype.Xb=function(){this.Nb(246)};of.Object.defineProperties(uf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 158}}});Object(Dd.a)(uf,"PageBreaksAllResetEvent",qa,[]);$k(Pe,qa);Pe.prototype.Xb=function(){this.Nb(503)};Pe.prototype.jg=function(){this.hd(function(M){return!!M.pasteParameters.ClientEstimationFloatingObjectId&&2===M.pasteParameters.CopyPasteTargetType&&!M.isFromCurrentSession})};of.Object.defineProperties(Pe.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 112}}});Object(Dd.a)(Pe,"PasteArtOtherWorkbookEvent",qa,[]);$k(Ee,qa);Ee.prototype.Xb=function(){this.Nb(503)};Ee.prototype.jg=function(){this.hd(function(M){return!!M.pasteParameters.ClientEstimationFloatingObjectId&&2===M.pasteParameters.CopyPasteTargetType&&M.isFromCurrentSession})};of.Object.defineProperties(Ee.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 52}}});Object(Dd.a)(Ee,"PasteArtSameWorkbookEvent",
qa,[]);$k(Qd,qa);Qd.prototype.Xb=function(){this.Nb(204)};of.Object.defineProperties(Qd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 110}}});Object(Dd.a)(Qd,"PasteHtmlEvent",qa,[]);$k(xd,qa);xd.prototype.Xb=function(){this.Nb(506)};of.Object.defineProperties(xd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 35}}});Object(Dd.a)(xd,"PasteRangeEvent",qa,[]);$k(Gb,qa);Gb.prototype.Xb=function(){this.Nb(503)};Gb.prototype.jg=function(){this.hd(function(M){return 1===
M.pasteParameters.CopyPasteTargetType})};of.Object.defineProperties(Gb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 111}}});Object(Dd.a)(Gb,"PasteShadowWorkbookRangeEvent",qa,[]);$k(Da,qa);Da.prototype.Xb=function(){this.Nb(180)};of.Object.defineProperties(Da.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 42}}});Object(Dd.a)(Da,"PasteStringEvent",qa,[]);$k(Ya,qa);Ya.prototype.Xb=function(){this.Nb(220)};of.Object.defineProperties(Ya.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 134}}});Object(Dd.a)(Ya,"PendingMergeEvent",qa,[]);$k(nf,qa);nf.prototype.Xb=function(){this.Nb(510)};of.Object.defineProperties(nf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 122}}});Object(Dd.a)(nf,"PictureInsertedEvent",qa,[]);$k(Te,qa);Te.prototype.Xb=function(){this.Nb(161)};of.Object.defineProperties(Te.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 153}}});Object(Dd.a)(Te,"PivotDrillToggledEvent",qa,[]);
$k(qe,qa);qe.prototype.Xb=function(){this.Nb(225)};qe.prototype.jg=function(){var M=this;this.hd(function(na){return na.opType===M.opType})};of.Object.defineProperties(qe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.vfa}}});Object(Dd.a)(qe,"PivotTableSettingsChangedEventBase",qa,[]);$k(te,qe);Object(Dd.a)(te,"PivotTableAllItemLabelsRepeatedEvent",qe,[]);$k(ze,qe);Object(Dd.a)(ze,"PivotTableAltTextDescriptionChangedEvent",qe,[]);$k(Td,qe);Object(Dd.a)(Td,"PivotTableAltTextTitleChangedEvent",
qe,[]);$k(Ad,qe);Object(Dd.a)(Ad,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",qe,[]);$k(Bc,qe);Object(Dd.a)(Bc,"PivotTableBlankLineAfterEachItemToggledEvent",qe,[]);$k(Vc,qe);Object(Dd.a)(Vc,"PivotTableColumnGrandTotalShownEvent",qe,[]);$k(xc,qa);xc.prototype.Xb=function(){this.Nb(132)};of.Object.defineProperties(xc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 98}}});Object(Dd.a)(xc,"PivotTableCreatedEvent",qa,[]);$k(Pb,qe);Object(Dd.a)(Pb,"PivotTableDisplayErrorStringToggledEvent",
qe,[]);$k(ab,qe);Object(Dd.a)(ab,"PivotTableDisplayNullStringToggledEvent",qe,[]);$k(hg,qe);Object(Dd.a)(hg,"PivotTableErrorStringChangedEvent",qe,[]);$k(yg,qe);Object(Dd.a)(yg,"PivotTableExpandCollapseButtonsShownEvent",qe,[]);$k(gh,qe);Object(Dd.a)(gh,"PivotTableIndentChangedEvent",qe,[]);$k(Ig,qe);Object(Dd.a)(Ig,"PivotTableItemsWithNoDataOnColumnsShownEvent",qe,[]);$k(Eg,qe);Object(Dd.a)(Eg,"PivotTableItemsWithNoDataOnRowsShownEvent",qe,[]);$k(Og,qe);Object(Dd.a)(Og,"PivotTableLayoutTypeSetEvent",
qe,[]);$k(Sg,qe);Object(Dd.a)(Sg,"PivotTableNullStringChangedEvent",qe,[]);$k(Rg,qa);Rg.prototype.Xb=function(){this.Nb(219)};of.Object.defineProperties(Rg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 149}}});Object(Dd.a)(Rg,"PivotTablePivotLocationChangedEvent",qa,[]);$k(Qf,qa);Qf.prototype.Xb=function(){this.Nb(145)};of.Object.defineProperties(Qf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 102}}});Object(Dd.a)(Qf,"PivotTablePivotedEvent",qa,
[]);$k(gg,qe);Object(Dd.a)(gg,"PivotTableRefreshDataOnLoadToggledEvent",qe,[]);$k(Tf,qa);Tf.prototype.Xb=function(){this.Nb(50)};Tf.prototype.jg=function(){this.hd(function(M){return!!M.pivotTableId&&!!M.pivotTableName})};of.Object.defineProperties(Tf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 104}}});Object(Dd.a)(Tf,"PivotTableRefreshedEvent",qa,[]);$k(vf,qe);Object(Dd.a)(vf,"PivotTableRenamedEvent",qe,[]);$k(tf,qe);Object(Dd.a)(tf,"PivotTableRowGrandTotalShownEvent",
qe,[]);$k(rf,qe);Object(Dd.a)(rf,"PivotTableSaveSourceDataWithFileToggledEvent",qe,[]);var Rh=b(712);$k(lf,qa);lf.prototype.Xb=function(){this.Nb(131)};lf.prototype.jg=function(){this.hd(function(M){M=Object(cg.a)(Rh.a,M);return!!M&&!!M.gKa()&&!!M.hierarchyName})};of.Object.defineProperties(lf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 155}}});Object(Dd.a)(lf,"PivotTableSortedEvent",qa,[]);$k(He,qe);Object(Dd.a)(He,"PivotTableSubTotalsVisibilitySettingSetEvent",qe,[]);
$k(Xe,qa);Xe.prototype.Xb=function(){this.Nb(560)};of.Object.defineProperties(Xe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 206}}});Object(Dd.a)(Xe,"PivotValueFieldSettingAppliedEvent",qa,[]);$k(me,qa);me.prototype.Xb=function(){this.Nb(243)};of.Object.defineProperties(me.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 161}}});Object(Dd.a)(me,"PrintAreaClearedEvent",qa,[]);$k(ue,qa);ue.prototype.Xb=function(){this.Nb(241)};ue.prototype.jg=function(){this.hd(function(M){return!M.addToPrintArea})};
of.Object.defineProperties(ue.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 159}}});Object(Dd.a)(ue,"PrintAreaSetEvent",qa,[]);$k(Yd,qa);Yd.prototype.Xb=function(){this.Nb(517)};of.Object.defineProperties(Yd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 57}}});Object(Dd.a)(Yd,"RangeAutoFilterClearedEvent",qa,[]);$k(Ud,qa);Ud.prototype.Xb=function(){this.Nb(11)};Ud.prototype.jg=function(){var M=this;this.hd(function(na){return 16===na.wZ().ValidMembers});
this.hd(function(na){return na.wZ().Font.ValidMembers===M.NZd})};of.Object.defineProperties(Ud.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.vfa}}});Object(Dd.a)(Ud,"RangeFontFormattedEventBase",qa,[]);$k(jd,Ud);Object(Dd.a)(jd,"RangeBoldedEvent",Ud,[]);$k(Qc,qa);Qc.prototype.Xb=function(){this.Nb(11)};Qc.prototype.jg=function(){this.hd(function(M){return 128===M.wZ().ValidMembers})};of.Object.defineProperties(Qc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 2}}});
Object(Dd.a)(Qc,"RangeBorderedEvent",qa,[]);yc.x$a="Table";yc.fpc="Sheet";Object(Dd.a)(yc,"MacroRecorderEventConstants",null,[]);$k($b,qa);$b.prototype.Xb=function(){this.Nb(208)};$b.prototype.jg=function(){this.hd(function(M){return M.getParameters().FilterType===yc.fpc})};of.Object.defineProperties($b.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 113}}});Object(Dd.a)($b,"RangeCheckedItemsFilteredEvent",qa,[]);$k(r,qa);r.prototype.Xb=function(){this.Nb(105)};of.Object.defineProperties(r.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 109}}});Object(Dd.a)(r,"RangeConditionalFormattingCreatedEvent",qa,[]);$k(ad,qa);ad.prototype.Xb=function(){this.Nb(221)};of.Object.defineProperties(ad.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 124}}});Object(Dd.a)(ad,"RangeConditionalFormattingRuleDeletedEvent",qa,[]);$k(Ac,qa);Ac.prototype.Xb=function(){this.Nb(508)};Ac.prototype.jg=function(){this.hd(function(M){return 3===M.Us()||1===M.Us()||4===M.Us()})};
of.Object.defineProperties(Ac.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 29}}});Object(Dd.a)(Ac,"RangeContentClearedEvent",qa,[]);$k(se,qa);se.prototype.Xb=function(){this.Nb(104)};of.Object.defineProperties(se.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 40}}});Object(Dd.a)(se,"RangeCopiedCutCellsInsertedEvent",qa,[]);$k(Pf,qa);Pf.prototype.Xb=function(){this.Nb(209)};Pf.prototype.jg=function(){this.hd(function(M){return M.getParameters().FilterType===
yc.fpc})};of.Object.defineProperties(Pf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 114}}});Object(Dd.a)(Pf,"RangeCustomFilteredEvent",qa,[]);$k(Kf,qa);Kf.prototype.Xb=function(){this.Nb(121)};of.Object.defineProperties(Kf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 106}}});Object(Dd.a)(Kf,"RangeDataValidationChangedEvent",qa,[]);$k(kf,Ud);Object(Dd.a)(kf,"RangeDoubleUnderlinedEvent",Ud,[]);$k(Me,qa);Me.prototype.Xb=function(){this.Nb(190)};
of.Object.defineProperties(Me.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 69}}});Object(Dd.a)(Me,"RangeDuplicatesRemovedEvent",qa,[]);$k(Qe,qa);Qe.prototype.Xb=function(){this.Nb(527);this.Nb(12)};of.Object.defineProperties(Qe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 1}}});Object(Dd.a)(Qe,"RangeEditedEvent",qa,[]);$k(ye,qa);ye.prototype.Xb=function(){this.Nb(255)};ye.prototype.jg=function(){this.hd(function(M){return 4===M.actionType})};of.Object.defineProperties(ye.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 164}}});Object(Dd.a)(ye,"RangeExternalLinksBrokeAllLinksEvent",qa,[]);$k(fe,qa);fe.prototype.Xb=function(){this.Nb(255)};fe.prototype.jg=function(){this.hd(function(M){return 3===M.actionType})};of.Object.defineProperties(fe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 119}}});Object(Dd.a)(fe,"RangeExternalLinksBrokeLinkEvent",qa,[]);$k(Zd,qa);Zd.prototype.Xb=function(){this.Nb(256)};Zd.prototype.kwa=function(){this.Cle("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")};
of.Object.defineProperties(Zd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 205}}});Object(Dd.a)(Zd,"RangeExternalLinksChangeSourceEvent",qa,[]);$k(Hd,qa);Hd.prototype.Xb=function(){this.Nb(553)};Hd.prototype.jg=function(){this.hd(function(M){return 1===M.actionType})};of.Object.defineProperties(Hd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 163}}});Object(Dd.a)(Hd,"RangeExternalLinksRefreshedAllEvent",qa,[]);$k(ud,qa);ud.prototype.Xb=function(){this.Nb(553)};
ud.prototype.jg=function(){this.hd(function(M){return 0===M.actionType})};of.Object.defineProperties(ud.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 77}}});Object(Dd.a)(ud,"RangeExternalLinksRefreshedEvent",qa,[]);$k(gd,qa);gd.prototype.Xb=function(){this.Nb(224)};of.Object.defineProperties(gd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 165}}});Object(Dd.a)(gd,"RangeExternalLinksSetAutoRefreshEvent",qa,[]);$k(Pc,qa);Pc.prototype.Xb=function(){this.Nb(11)};
Pc.prototype.jg=function(){this.hd(function(M){return 64===M.wZ().ValidMembers})};of.Object.defineProperties(Pc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 5}}});Object(Dd.a)(Pc,"RangeFillColoredEvent",qa,[]);$k(gc,qa);gc.prototype.Xb=function(){this.Nb(155)};of.Object.defineProperties(gc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 59}}});Object(Dd.a)(gc,"RangeFilledEvent",qa,[]);$k(Bb,qa);Bb.prototype.Xb=function(){this.Nb(176)};Bb.prototype.jg=
function(){this.hd(function(M){return M.aV().AutoFilterType===yc.fpc&&!!M.aV().CriteriaType})};of.Object.defineProperties(Bb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 115}}});Object(Dd.a)(Bb,"RangeFilterAppliedEvent",qa,[]);$k(Xa,qa);Xa.prototype.Xb=function(){this.Nb(176)};Xa.prototype.jg=function(){this.hd(function(M){return M.aV().AutoFilterType===yc.fpc&&!M.aV().CriteriaType})};of.Object.defineProperties(Xa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 58}}});
Object(Dd.a)(Xa,"RangeFilterClearedEvent",qa,[]);$k(Ue,qa);Ue.prototype.Xb=function(){this.Nb(518)};of.Object.defineProperties(Ue.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 41}}});Object(Dd.a)(Ue,"RangeFilterReappliedEvent",qa,[]);$k(Ce,qa);Ce.prototype.Xb=function(){this.Nb(150)};of.Object.defineProperties(Ce.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 86}}});Object(Dd.a)(Ce,"RangeFlashFilledEvent",qa,[]);$k($d,Ud);Object(Dd.a)($d,"RangeFontColoredEvent",
Ud,[]);$k(ce,Ud);Object(Dd.a)(ce,"RangeFontItalicizedEvent",Ud,[]);$k(yd,Ud);Object(Dd.a)(yd,"RangeFontNamedEvent",Ud,[]);$k(od,Ud);Object(Dd.a)(od,"RangeFontSizedEvent",Ud,[]);$k(Lc,qa);Lc.prototype.Xb=function(){this.Nb(215)};of.Object.defineProperties(Lc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 74}}});Object(Dd.a)(Lc,"RangeFormattedAsTableEvent",qa,[]);$k(Rb,qa);Rb.prototype.Xb=function(){this.Nb(188)};of.Object.defineProperties(Rb.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 97}}});Object(Dd.a)(Rb,"RangeGroupedOrUngroupedEvent",qa,[]);$k(Va,qa);Va.prototype.Xb=function(){this.Nb(11)};Va.prototype.jg=function(){this.hd(function(M){return 2===M.wZ().ValidMembers})};of.Object.defineProperties(Va.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 60}}});Object(Dd.a)(Va,"RangeHorizontallyAlignedEvent",qa,[]);$k(Ve,qa);Ve.prototype.Xb=function(){this.Nb(526)};of.Object.defineProperties(Ve.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 43}}});Object(Dd.a)(Ve,"RangeHyperlinkAppliedEvent",qa,[]);$k(Se,qa);Se.prototype.Xb=function(){this.Nb(11)};Se.prototype.jg=function(){this.hd(function(M){return 256===M.wZ().ValidMembers})};of.Object.defineProperties(Se.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 63}}});Object(Dd.a)(Se,"RangeIndentChangedEvent",qa,[]);$k(ve,qa);ve.prototype.Xb=function(){this.Nb(156)};ve.prototype.jg=function(){this.hd(function(M){return 2===M.Us()||
5===M.Us()||6===M.Us()||7===M.Us()})};of.Object.defineProperties(ve.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 53}}});Object(Dd.a)(ve,"RangeMergedEvent",qa,[]);$k(Wd,qa);Wd.prototype.Xb=function(){this.Nb(216)};of.Object.defineProperties(Wd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 107}}});Object(Dd.a)(Wd,"RangeNamedCellStyleAppliedEvent",qa,[]);$k(le,qa);le.prototype.Xb=function(){this.Nb(11)};le.prototype.jg=function(){this.hd(function(M){return 32===
M.wZ().ValidMembers})};of.Object.defineProperties(le.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 12}}});Object(Dd.a)(le,"RangeNumberFormattedEvent",qa,[]);var Ph=b(1174);$k(pe,qa);pe.prototype.Xb=function(){this.Nb(141)};pe.prototype.jg=function(){this.hd(function(M){return Object(wf.a)(Ph.a,M)})};of.Object.defineProperties(pe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 108}}});Object(Dd.a)(pe,"RangeSortedEvent",qa,[]);$k(Rd,Ud);Object(Dd.a)(Rd,
"RangeStrikedThroughEvent",Ud,[]);$k(kd,Ud);Object(Dd.a)(kd,"RangeUnderlinedEvent",Ud,[]);$k(tc,qa);tc.prototype.Xb=function(){this.Nb(11)};tc.prototype.jg=function(){this.hd(function(M){return 1===M.wZ().ValidMembers})};of.Object.defineProperties(tc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 61}}});Object(Dd.a)(tc,"RangeVerticallyAlignedEvent",qa,[]);$k(jc,qa);jc.prototype.Xb=function(){this.Nb(11)};jc.prototype.jg=function(){this.hd(function(M){return 8===M.wZ().ValidMembers})};
of.Object.defineProperties(jc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 62}}});Object(Dd.a)(jc,"RangeWrapTextToggledEvent",qa,[]);$k(Cb,qa);Cb.prototype.Xb=function(){this.Nb(51)};of.Object.defineProperties(Cb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 103}}});Object(Dd.a)(Cb,"RefreshedAllEvent",qa,[]);$k(Ta,qa);Ta.prototype.Xb=function(){this.Nb(148)};of.Object.defineProperties(Ta.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 47}}});
Object(Dd.a)(Ta,"ReplaceAllEvent",qa,[]);$k(rc,qa);rc.prototype.Xb=function(){this.Nb(532)};rc.prototype.jg=function(){this.hd(function(M){return 95!==M.getShapeType()&&96!==M.getShapeType()&&97!==M.getShapeType()&&98!==M.getShapeType()&&100!==M.getShapeType()&&102!==M.getShapeType()&&103!==M.getShapeType()})};of.Object.defineProperties(rc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 91}}});Object(Dd.a)(rc,"ShapeInsertedEvent",qa,[]);$k(Ib,qa);Ib.prototype.Xb=function(){this.Nb(531)};
of.Object.defineProperties(Ib.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 92}}});Object(Dd.a)(Ib,"ShapeStyleSetEvent",qa,[]);var Gh=b(1033);$k(zc,qa);zc.prototype.Xb=function(){this.Nb(581)};zc.prototype.jg=function(){var M=this;this.hd(function(na){return Object(wf.a)(Gh.a,na)&&4===na.getShapeTextFormat().ValidMembers});this.hd(function(na){return Object(wf.a)(Gh.a,na)&&na.getShapeTextFormat().Font.ValidMembers===M.NZd})};of.Object.defineProperties(zc.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return this.vfa}}});Object(Dd.a)(zc,"ShapeTextFontFormattedEventBase",qa,[]);$k(kc,zc);Object(Dd.a)(kc,"ShapeTextBoldedEvent",zc,[]);var Hh=b(1176);$k(Mb,qa);Mb.prototype.Xb=function(){this.Nb(581)};Mb.prototype.jg=function(){this.hd(function(M){return Object(wf.a)(Hh.a,M)})};of.Object.defineProperties(Mb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 191}}});Object(Dd.a)(Mb,"ShapeTextChangedEvent",qa,[]);$k(Qa,zc);Object(Dd.a)(Qa,"ShapeTextFontColorChangedEvent",
zc,[]);$k(Hf,zc);Object(Dd.a)(Hf,"ShapeTextFontNameChangedEvent",zc,[]);$k(pf,zc);Object(Dd.a)(pf,"ShapeTextFontSizeChangedEvent",zc,[]);$k(Cf,qa);Cf.prototype.Xb=function(){this.Nb(581)};Cf.prototype.jg=function(){this.hd(function(M){return Object(wf.a)(Gh.a,M)&&2===M.getShapeTextFormat().ValidMembers})};of.Object.defineProperties(Cf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 199}}});Object(Dd.a)(Cf,"ShapeTextHorizontallyAlignedEvent",qa,[]);$k(zf,zc);Object(Dd.a)(zf,
"ShapeTextItalicizedEvent",zc,[]);$k(We,zc);Object(Dd.a)(We,"ShapeTextUnderlinedEvent",zc,[]);$k(Fd,qa);Fd.prototype.Xb=function(){this.Nb(581)};Fd.prototype.jg=function(){this.hd(function(M){return Object(wf.a)(Gh.a,M)&&1===M.getShapeTextFormat().ValidMembers})};of.Object.defineProperties(Fd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 200}}});Object(Dd.a)(Fd,"ShapeTextVerticallyAlignedEvent",qa,[]);$k(oe,qa);oe.prototype.Xb=function(){this.Nb(138)};of.Object.defineProperties(oe.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 13}}});Object(Dd.a)(oe,"SheetAddedEvent",qa,[]);var ph=b(9);$k(dd,qa);dd.prototype.Xb=function(){this.Nb(237)};dd.prototype.jg=function(){this.hd(function(M){return!!M.insertDeleteMultiRangeParameters});this.hd(function(M){return!M.insertDeleteMultiRangeParameters.IsTableCommand});this.hd(function(M){M=M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>M.DeltaColumn&&!M.DeltaRow&&(!!M.InsertDeleteRange.FirstRow||M.InsertDeleteRange.LastRow!==
ph.a.Xx)||!M.DeltaColumn&&0>M.DeltaRow&&(!!M.InsertDeleteRange.FirstColumn||M.InsertDeleteRange.LastColumn!==ph.a.Zu)})};of.Object.defineProperties(dd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 142}}});Object(Dd.a)(dd,"SheetCellsDeletedEvent",qa,[]);$k(Wc,qa);Wc.prototype.Xb=function(){this.Nb(237)};Wc.prototype.jg=function(){this.hd(function(M){return!!M.insertDeleteMultiRangeParameters});this.hd(function(M){return!M.insertDeleteMultiRangeParameters.IsTableCommand});
this.hd(function(M){M=M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<M.DeltaColumn&&!M.DeltaRow&&(!!M.InsertDeleteRange.FirstRow||M.InsertDeleteRange.LastRow!==ph.a.Xx)||!M.DeltaColumn&&0<M.DeltaRow&&(!!M.InsertDeleteRange.FirstColumn||M.InsertDeleteRange.LastColumn!==ph.a.Zu)})};of.Object.defineProperties(Wc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 143}}});Object(Dd.a)(Wc,"SheetCellsInsertedEvent",qa,[]);$k(zd,qa);zd.prototype.Xb=function(){this.Nb(237)};
zd.prototype.jg=function(){this.hd(function(M){return!!M.insertDeleteMultiRangeParameters});this.hd(function(M){return!M.insertDeleteMultiRangeParameters.IsTableCommand});this.hd(function(M){return 0>M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.hd(function(M){return!M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.hd(function(M){return!M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow});this.hd(function(M){return M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===
ph.a.Xx})};of.Object.defineProperties(zd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 139}}});Object(Dd.a)(zd,"SheetColumnDeletedEvent",qa,[]);$k(Tc,qa);Tc.prototype.Xb=function(){this.Nb(237)};Tc.prototype.jg=function(){this.hd(function(M){return!!M.insertDeleteMultiRangeParameters});this.hd(function(M){return!M.insertDeleteMultiRangeParameters.IsTableCommand});this.hd(function(M){return 0<M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.hd(function(M){return!M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});
this.hd(function(M){return!M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow});this.hd(function(M){return M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===ph.a.Xx})};of.Object.defineProperties(Tc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 138}}});Object(Dd.a)(Tc,"SheetColumnInsertedEvent",qa,[]);$k(Fc,qa);Fc.prototype.Xb=function(){this.Nb(137)};of.Object.defineProperties(Fc.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 14}}});Object(Dd.a)(Fc,"SheetDeletedEvent",qa,[]);$k(Qb,qa);Qb.prototype.Xb=function(){this.Nb(185)};of.Object.defineProperties(Qb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 137}}});Object(Dd.a)(Qb,"SheetDirectionChangedEvent",qa,[]);$k(db,qa);db.prototype.Xb=function(){this.Nb(139)};of.Object.defineProperties(db.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 54}}});Object(Dd.a)(db,"SheetDuplicatedEvent",qa,
[]);$k(ke,qa);ke.prototype.Xb=function(){this.Nb(207)};of.Object.defineProperties(ke.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 15}}});Object(Dd.a)(ke,"SheetNameEditedEvent",qa,[]);$k(De,qa);De.prototype.Xb=function(){this.Nb(151)};of.Object.defineProperties(De.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 90}}});Object(Dd.a)(De,"SheetPaneFrozenEvent",qa,[]);$k(Ld,qa);Ld.prototype.Xb=function(){this.Nb(226)};of.Object.defineProperties(Ld.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 120}}});Object(Dd.a)(Ld,"SheetPrintSettingsSavedEvent",qa,[]);var si=b(1077);$k(Nd,qa);Nd.prototype.Xb=function(){this.Nb(507)};Nd.prototype.kwa=function(){this.Cle("Microsoft.Office.Excel.SheetProtectionMacroRecording")};Nd.prototype.jg=function(){this.hd(function(M){return Object.getType(M)===si.a})};of.Object.defineProperties(Nd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 215}}});Object(Dd.a)(Nd,"SheetProtectionPausedResumedEvent",
qa,[]);$k(ge,qa);ge.prototype.Xb=function(){this.Nb(557)};of.Object.defineProperties(ge.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 64}}});Object(Dd.a)(ge,"SheetReorderedEvent",qa,[]);$k(Ed,qa);Ed.prototype.Xb=function(){this.Nb(237)};Ed.prototype.jg=function(){this.hd(function(M){return!!M.insertDeleteMultiRangeParameters});this.hd(function(M){return!M.insertDeleteMultiRangeParameters.IsTableCommand});this.hd(function(M){return!M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});
this.hd(function(M){return 0>M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.hd(function(M){return!M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn});this.hd(function(M){return M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===ph.a.Zu})};of.Object.defineProperties(Ed.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 141}}});Object(Dd.a)(Ed,"SheetRowDeletedEvent",qa,
[]);$k(cd,qa);cd.prototype.Xb=function(){this.Nb(237)};cd.prototype.jg=function(){this.hd(function(M){return!!M.insertDeleteMultiRangeParameters});this.hd(function(M){return!M.insertDeleteMultiRangeParameters.IsTableCommand});this.hd(function(M){return!M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.hd(function(M){return 0<M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.hd(function(M){return!M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn});
this.hd(function(M){return M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===ph.a.Zu})};of.Object.defineProperties(cd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 140}}});Object(Dd.a)(cd,"SheetRowInsertedEvent",qa,[]);$k(hd,qa);hd.prototype.Xb=function(){this.Nb(135)};of.Object.defineProperties(hd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 39}}});Object(Dd.a)(hd,"SheetRowsColumnsAutoFitEvent",qa,[]);
$k(sc,qa);sc.prototype.Xb=function(){this.Nb(136)};of.Object.defineProperties(sc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 36}}});Object(Dd.a)(sc,"SheetRowsColumnsResizedEvent",qa,[]);$k(mc,qa);mc.prototype.Xb=function(){this.Nb(183)};of.Object.defineProperties(mc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 68}}});Object(Dd.a)(mc,"SheetShowGridlinesToggledEvent",qa,[]);$k(Df,qa);Df.prototype.Xb=function(){this.Nb(184)};of.Object.defineProperties(Df.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 67}}});Object(Dd.a)(Df,"SheetShowHeadingsToggledEvent",qa,[]);$k(gf,qa);gf.prototype.Xb=function(){this.Nb(213)};of.Object.defineProperties(gf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 89}}});Object(Dd.a)(gf,"SheetSpellCheckedEvent",qa,[]);$k(Ze,qa);Ze.prototype.Xb=function(){this.Nb(515)};of.Object.defineProperties(Ze.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 70}}});Object(Dd.a)(Ze,
"SheetTabColoredEvent",qa,[]);$k(Ge,qa);Ge.prototype.Xb=function(){this.Nb(157)};of.Object.defineProperties(Ge.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 71}}});Object(Dd.a)(Ge,"SheetVisibilityChangedEvent",qa,[]);$k(he,qa);he.prototype.Xb=function(){this.Nb(239)};of.Object.defineProperties(he.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 126}}});Object(Dd.a)(he,"SheetsVisibilityChangedEvent",qa,[]);$k(vd,qa);vd.prototype.Xb=function(){this.Nb(203)};
of.Object.defineProperties(vd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 188}}});Object(Dd.a)(vd,"SlicerInsertedEvent",qa,[]);$k(id,qa);id.prototype.Xb=function(){this.Nb(173)};id.prototype.jg=function(){this.hd(function(M){return!M.clearFilter})};of.Object.defineProperties(id.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 189}}});Object(Dd.a)(id,"SlicerSelectionAppliedEvent",qa,[]);$k($c,qa);$c.prototype.Xb=function(){this.Nb(173)};$c.prototype.jg=
function(){this.hd(function(M){return M.clearFilter})};of.Object.defineProperties($c.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 190}}});Object(Dd.a)($c,"SlicerSelectionClearedEvent",qa,[]);$k(Ec,qa);Ec.prototype.Xb=function(){this.Nb(208)};Ec.prototype.jg=function(){this.hd(function(M){return M.getParameters().FilterType===yc.x$a})};of.Object.defineProperties(Ec.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 27}}});Object(Dd.a)(Ec,"TableCheckedItemsFilteredEvent",
qa,[]);$k(ee,qa);ee.prototype.Xb=function(){this.Nb(237)};ee.prototype.jg=function(){this.hd(function(M){return!!M.insertDeleteMultiRangeParameters});this.hd(function(M){return M.insertDeleteMultiRangeParameters.IsTableCommand});this.hd(function(M){return 0>M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.hd(function(M){return!M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};of.Object.defineProperties(ee.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 144}}});Object(Dd.a)(ee,"TableColumnDeletedEvent",qa,[]);$k(Pd,qa);Pd.prototype.Xb=function(){this.Nb(237)};Pd.prototype.jg=function(){this.hd(function(M){return!!M.insertDeleteMultiRangeParameters});this.hd(function(M){return M.insertDeleteMultiRangeParameters.IsTableCommand});this.hd(function(M){return 0<M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.hd(function(M){return!M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};
of.Object.defineProperties(Pd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 145}}});Object(Dd.a)(Pd,"TableColumnInsertedEvent",qa,[]);var Sh=b(1175);$k(Gd,qa);Gd.prototype.Xb=function(){this.Nb(141)};Gd.prototype.jg=function(){this.hd(function(M){return Object(wf.a)(Sh.a,M)})};of.Object.defineProperties(Gd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 121}}});Object(Dd.a)(Gd,"TableColumnSortedEvent",qa,[]);$k(td,qa);td.prototype.Xb=function(){this.Nb(193)};
of.Object.defineProperties(td.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 105}}});Object(Dd.a)(td,"TableConvertedToRangeEvent",qa,[]);$k(Oc,qa);Oc.prototype.Xb=function(){this.Nb(206)};of.Object.defineProperties(Oc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 16}}});Object(Dd.a)(Oc,"TableCreatedEvent",qa,[]);$k(Zb,qa);Zb.prototype.Xb=function(){this.Nb(209)};Zb.prototype.jg=function(){this.hd(function(M){return M.getParameters().FilterType===
yc.x$a})};of.Object.defineProperties(Zb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 30}}});Object(Dd.a)(Zb,"TableCustomFilteredEvent",qa,[]);$k(ec,qa);ec.prototype.Xb=function(){this.Nb(187)};ec.prototype.jg=function(){this.hd(function(M){return 1===M.options.OperationType})};of.Object.defineProperties(ec.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 25}}});Object(Dd.a)(ec,"TableCustomSortedEvent",qa,[]);$k(Lb,qa);Lb.prototype.Xb=function(){this.Nb(176)};
Lb.prototype.jg=function(){this.hd(function(M){return M.aV().AutoFilterType===yc.x$a});this.hd(function(M){return 0===M.aV().CriteriaType})};of.Object.defineProperties(Lb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 28}}});Object(Dd.a)(Lb,"TableFilterClearedEvent",qa,[]);$k(Ja,qa);Ja.prototype.Xb=function(){this.Nb(176)};Ja.prototype.jg=function(){this.hd(function(M){return M.aV().AutoFilterType===yc.x$a});this.hd(function(M){var na=new cf.a;na.add(1);na.add(2);na.add(8);
na.add(9);na.add(10);na.add(11);na.add(12);na.add(13);na.add(14);na.add(15);na.add(16);na.add(17);na.add(18);na.add(19);na.add(20);na.add(21);na.add(22);na.add(23);na.add(24);na.add(25);na.add(26);na.add(27);na.add(28);na.add(29);na.add(30);na.add(31);na.add(32);na.add(33);na.add(34);na.add(35);na.add(36);na.add(37);na.add(38);na.add(39);return na.contains(M.aV().CriteriaType)})};of.Object.defineProperties(Ja.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 32}}});Object(Dd.a)(Ja,
"TableItemFilteredEvent",qa,[]);$k(Nb,qa);Nb.prototype.Xb=function(){this.Nb(217)};of.Object.defineProperties(Nb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 101}}});Object(Dd.a)(Nb,"TableRenamedEvent",qa,[]);$k(sd,qa);sd.prototype.Xb=function(){this.Nb(211)};of.Object.defineProperties(sd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 73}}});Object(Dd.a)(sd,"TableResizedEvent",qa,[]);$k(Uc,qa);Uc.prototype.Xb=function(){this.Nb(514)};of.Object.defineProperties(Uc.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 44}}});Object(Dd.a)(Uc,"TableRowColumnRearrangedEvent",qa,[]);$k(pd,qa);pd.prototype.Xb=function(){this.Nb(237)};pd.prototype.jg=function(){this.hd(function(M){return!!M.insertDeleteMultiRangeParameters});this.hd(function(M){return M.insertDeleteMultiRangeParameters.IsTableCommand});this.hd(function(M){return!M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.hd(function(M){return 0>M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};
of.Object.defineProperties(pd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 146}}});Object(Dd.a)(pd,"TableRowDeletedEvent",qa,[]);$k(Xc,qa);Xc.prototype.Xb=function(){this.Nb(237)};Xc.prototype.jg=function(){this.hd(function(M){return!!M.insertDeleteMultiRangeParameters});this.hd(function(M){return M.insertDeleteMultiRangeParameters.IsTableCommand});this.hd(function(M){return!M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.hd(function(M){return 0<
M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};of.Object.defineProperties(Xc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 147}}});Object(Dd.a)(Xc,"TableRowInsertedEvent",qa,[]);$k(pc,qa);pc.prototype.Xb=function(){this.Nb(177)};pc.prototype.jg=function(){this.hd(function(M){return M.aV().AutoFilterType===yc.x$a})};of.Object.defineProperties(pc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 26}}});Object(Dd.a)(pc,"TableSortedEvent",
qa,[]);$k(Tb,qa);Tb.prototype.Xb=function(){this.Nb(212)};of.Object.defineProperties(Tb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 87}}});Object(Dd.a)(Tb,"TableStyleAppliedEvent",qa,[]);$k(gb,qa);gb.prototype.Xb=function(){this.Nb(196)};of.Object.defineProperties(gb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 88}}});Object(Dd.a)(gb,"TableStyleOptionToggledEvent",qa,[]);$k(Kb,qa);Kb.prototype.Xb=function(){this.Nb(210)};Kb.prototype.jg=function(){this.hd(function(M){return M.getParameters().FilterType===
yc.x$a})};of.Object.defineProperties(Kb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 31}}});Object(Dd.a)(Kb,"TableTop10FilteredEvent",qa,[]);$k(Fa,qa);Fa.prototype.Xb=function(){this.Nb(238)};of.Object.defineProperties(Fa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 207}}});Object(Dd.a)(Fa,"TextToColumnsEvent",qa,[]);$k(lc,qa);lc.prototype.Xb=function(){this.Nb(559)};of.Object.defineProperties(lc.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 128}}});Object(Dd.a)(lc,"ValuesSortedEvent",qa,[]);$k(Oe,qa);Oe.prototype.Xb=function(){this.Nb(197)};of.Object.defineProperties(Oe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 55}}});Object(Dd.a)(Oe,"WorkbookCalculationModeSetEvent",qa,[]);$k(bf,qa);bf.prototype.Xb=function(){this.Nb(181)};bf.prototype.jg=function(){this.hd(function(M){return!!M.parentCommentId})};of.Object.defineProperties(bf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 34}}});
Object(Dd.a)(bf,"WorkbookCommentRepliedEvent",qa,[]);$k(Fe,qa);Fe.prototype.Xb=function(){this.Nb(181)};Fe.prototype.jg=function(){this.hd(function(M){return!M.parentCommentId})};of.Object.defineProperties(Fe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 33}}});Object(Dd.a)(Fe,"WorkbookCommentedEvent",qa,[]);$k(ef,qa);ef.prototype.Xb=function(){this.Nb(128)};of.Object.defineProperties(ef.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 56}}});Object(Dd.a)(ef,
"WorkbookRecalculatedEvent",qa,[]);$k(ie,qa);ie.prototype.Xb=function(){this.Nb(171)};of.Object.defineProperties(ie.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 46}}});Object(Dd.a)(ie,"WorkbookRedoEvent",qa,[]);$k(re,qa);re.prototype.Xb=function(){this.Nb(170)};of.Object.defineProperties(re.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 45}}});Object(Dd.a)(re,"WorkbookUndoEvent",qa,[]);$k(Kd,qa);Kd.prototype.Xb=function(){this.Nb(507);this.Nb(576);
this.Nb(10)};Kd.prototype.jg=function(){this.hd(function(M){if(Object(wf.a)(hh,M)&&(M=Object(cg.a)(hh,M),void 0!==M.source&&null!==M.source&&void 0!==M.eventId&&null!==M.eventId))return Xd.ULS.sendTraceTag(537155426,0,50,"[RichApiRecorder]: received a valid but unhandled event: source: "+M.source+"; eventId: "+M.eventId+"."),!0;Xd.ULS.sendTraceTag(537155425,0,50,"[RichApiRecorder]: an invalid event was ignored.");return!1})};of.Object.defineProperties(Kd.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 116}}});Object(Dd.a)(Kd,"DefaultRichApiRequestExecutedEvent",qa,[]);$k(ld,qa);ld.prototype.Xb=function(){this.Nb(1022)};of.Object.defineProperties(ld.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 216}}});Object(Dd.a)(ld,"TablelAltTextEditedEvent",qa,[]);$k(Jd,qa);Jd.prototype.Xb=function(){this.Nb(263)};of.Object.defineProperties(Jd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 217}}});Object(Dd.a)(Jd,"FloatingObjectZOrderChangedEvent",
qa,[]);qd.prototype.M_e=function(M,na){var Pa=this.N_e(M,this.macroRecorderEvents,na);Pa||(Pa=this.N_e(M,qd.C1h(),na),!Pa&&this.Vef(M,qd.QGe,na)&&(Pa=qd.QGe));return Pa};qd.prototype.N_e=function(M,na,Pa){var rb=new cf.a;na=ik(na);for(var cc=na.next();!cc.done;cc=na.next())cc=cc.value,this.Vef(M,cc,Pa)&&rb.add(cc);return 1===rb.count?rb.na(0):1<rb.count?qd.$Jh(rb):null};qd.prototype.Vef=function(M,na,Pa){var rb=qd.yWi(M,na);return Pa?rb&&qd.sXj(M,na):rb};qd.prototype.Faj=function(){for(var M=new cf.a,
na=ik(this.wb),Pa=na.next();!Pa.done;Pa=na.next()){Pa=Pa.value;for(var rb=!1,cc=ik(Pa.featureGates),Dc=cc.next();!Dc.done;Dc=cc.next())if(!af.EwaSettings.ma(Dc.value)){M.add(Pa);rb=!0;break}if(!rb)for(rb=ik(Pa.nSe),cc=rb.next();!cc.done;cc=rb.next())if(!af.EwaSettings.getBooleanFeatureGate(cc.value,!1)){M.add(Pa);break}}M=ik(M);for(na=M.next();!na.done;na=M.next())this.wb.remove(na.value)};qd.C1h=function(){qd.VCb||(qd.VCb=new cf.a,qd.VCb.add(new Dg),qd.VCb.add(new Lg));return qd.VCb};qd.yWi=function(M,
na){return na.operations.contains(M.operation)};qd.sXj=function(M,na){var Pa=na.UCc;if(!Pa.count)return!0;na=!0;Pa=ik(Pa);for(var rb=Pa.next();!rb.done;rb=Pa.next())if(rb=rb.value,!rb(M.payload)){na=!1;break}return na};qd.$Jh=function(M){var na=M.na(0);M=ik(M);for(var Pa=M.next();!Pa.done;Pa=M.next())Pa=Pa.value,Pa.UCc.count>na.UCc.count&&(na=Pa);return na};of.Object.defineProperties(qd.prototype,{macroRecorderEvents:{configurable:!0,enumerable:!0,get:function(){this.wb||(this.wb=new cf.a,this.wb.add(new Qe),
this.wb.add(new Qc),this.wb.add(new jd),this.wb.add(new kf),this.wb.add(new Pc),this.wb.add(new $d),this.wb.add(new ce),this.wb.add(new yd),this.wb.add(new od),this.wb.add(new Rd),this.wb.add(new kd),this.wb.add(new le),this.wb.add(new oe),this.wb.add(new Fc),this.wb.add(new ke),this.wb.add(new Oc),this.wb.add(new ee),this.wb.add(new Pd),this.wb.add(new pd),this.wb.add(new Xc),this.wb.add(new Tc),this.wb.add(new zd),this.wb.add(new cd),this.wb.add(new Ed),this.wb.add(new ec),this.wb.add(new pc),this.wb.add(new Ec),
this.wb.add(new Lb),this.wb.add(new Ac),this.wb.add(new Zb),this.wb.add(new Kb),this.wb.add(new Ja),this.wb.add(new Fe),this.wb.add(new bf),this.wb.add(new xd),this.wb.add(new sc),this.wb.add(new dd),this.wb.add(new Wc),this.wb.add(new hd),this.wb.add(new se),this.wb.add(new Ue),this.wb.add(new Ve),this.wb.add(new Da),this.wb.add(new Uc),this.wb.add(new ie),this.wb.add(new re),this.wb.add(new Ta),this.wb.add(new pg),this.wb.add(new Ee),this.wb.add(new ve),this.wb.add(new db),this.wb.add(new Oe),this.wb.add(new ef),
this.wb.add(new Yd),this.wb.add(new Xa),this.wb.add(new gc),this.wb.add(new Va),this.wb.add(new tc),this.wb.add(new jc),this.wb.add(new Se),this.wb.add(new ge),this.wb.add(new Hc),this.wb.add(new kg),this.wb.add(new Df),this.wb.add(new mc),this.wb.add(new Me),this.wb.add(new Ge),this.wb.add(new Ze),this.wb.add(new sd),this.wb.add(new Lc),this.wb.add(new fh),this.wb.add(new Ca),this.wb.add(new ud),this.wb.add(new Oh),this.wb.add(new Yg),this.wb.add(new R),this.wb.add(new Lf),this.wb.add(new C),this.wb.add(new sh),
this.wb.add(new ua),this.wb.add(new Fh),this.wb.add(new Ce),this.wb.add(new Tb),this.wb.add(new gb),this.wb.add(new gf),this.wb.add(new De),this.wb.add(new rc),this.wb.add(new Ib),this.wb.add(new ah),this.wb.add(new oh),this.wb.add(new $g),this.wb.add(new Wg),this.wb.add(new Rb),this.wb.add(new xc),this.wb.add(new Of),this.wb.add(new Zg),this.wb.add(new Nb),this.wb.add(new Qf),this.wb.add(new Cb),this.wb.add(new Tf),this.wb.add(new td),this.wb.add(new Kf),this.wb.add(new Wd),this.wb.add(new pe),this.wb.add(new r),
this.wb.add(new Qd),this.wb.add(new Gb),this.wb.add(new Pe),this.wb.add(new $b),this.wb.add(new Pf),this.wb.add(new Bb),this.wb.add(new za),this.wb.add(new nf),this.wb.add(new fe),this.wb.add(new Ld),this.wb.add(new Gd),this.wb.add(new ad),this.wb.add(new he),this.wb.add(new zg),this.wb.add(new lc),this.wb.add(new Vg),this.wb.add(new W),this.wb.add(new nh),this.wb.add(new xg),this.wb.add(new Ya),this.wb.add(new wg),this.wb.add(new Gf),this.wb.add(new Qb),this.wb.add(new kh),this.wb.add(new Rg),this.wb.add(new Te),
this.wb.add(new Qg),this.wb.add(new lf),this.wb.add(new qf),this.wb.add(new Bf),this.wb.add(new uf),this.wb.add(new ue),this.wb.add(new ed),this.wb.add(new me),this.wb.add(new lg),this.wb.add(new Hd),this.wb.add(new ye),this.wb.add(new gd),this.wb.add(new Ug),this.wb.add(new bg),this.wb.add(new vf),this.wb.add(new tf),this.wb.add(new Vc),this.wb.add(new te),this.wb.add(new Bc),this.wb.add(new Ad),this.wb.add(new yg),this.wb.add(new Eg),this.wb.add(new Ig),this.wb.add(new Pb),this.wb.add(new ab),this.wb.add(new hg),
this.wb.add(new Sg),this.wb.add(new rf),this.wb.add(new gg),this.wb.add(new Td),this.wb.add(new ze),this.wb.add(new He),this.wb.add(new Og),this.wb.add(new gh),this.wb.add(new vd),this.wb.add(new id),this.wb.add(new $c),this.wb.add(new Mb),this.wb.add(new kc),this.wb.add(new zf),this.wb.add(new We),this.wb.add(new Qa),this.wb.add(new Hf),this.wb.add(new pf),this.wb.add(new Cf),this.wb.add(new Fd),this.wb.add(new Zd),this.wb.add(new Xe),this.wb.add(new Fa),this.wb.add(new Nd),this.wb.add(new ld),this.wb.add(new Jd),
af.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&this.Faj());return this.wb}}});qd.VCb=null;qd.QGe=new Kd;Object(Dd.a)(qd,"MacroRecorderEventList",null,[]);var $i=$e.a;$k(vc,$i);vc.prototype.create=function(){this.pb(this.$.da.za(297)||new tb(this.$,new qd(this.$),new Bd))};vc.ka=function(M){M.da.Ga(298,new vc(M))};Object(Dd.a)(vc,"MacroRecorderEventHandlerFactory",$e.a,[]);var yj=b(1356),zj=b(1453),Tg=b(7);b(631);Sd.prototype.oUh=function(M){Xd.ULS.sendTraceTag(17306645,
220,50,"Context menu id: {0}",M);for(var na=new cf.a,Pa=ik(this.I1b),rb=Pa.next();!rb.done;rb=Pa.next()){rb=ik(rb.value.kEb);for(var cc=rb.next();!cc.done;cc=rb.next())cc=cc.value,cc.id===M&&na.add(cc)}return na};Sd.prototype.ple=function(M){this.I1b.add(M)};Sd.prototype.Aaj=function(M){for(var na=ik(this.I1b),Pa=na.next();!Pa.done;Pa=na.next())if(Pa=Pa.value,Pa.npe===M.npe){this.I1b.remove(Pa);break}};Sd.Igh=function(M,na,Pa){Pa=void 0===Pa?null:Pa;M=Sd.zMh(M);0<M.length&&(Sd.lwc(M,!1),Pa&&Pa(na,
M))};Sd.zMh=function(M){var na=[];if(M&&M.kEb&&0<M.kEb.count){M=ik(M.kEb);for(var Pa=M.next();!Pa.done;Pa=M.next())if(Pa=Pa.value,Pa.controls&&0<Pa.controls.count){Pa=ik(Pa.controls);for(var rb=Pa.next();!rb.done;rb=Pa.next())if(rb=rb.value,rb.menuItems&&0<rb.menuItems.count){rb=ik(rb.menuItems);for(var cc=rb.next();!cc.done;cc=rb.next())Array.add(na,cc.value.id)}}}return na};Sd.lwc=function(M,na){if(M.length){var Pa=[];M=ik(M);for(var rb=M.next();!rb.done;rb=M.next())Pa.push(appChrome.actions.updateControlEnabledDisabledState(rb.value,
na));appChrome.api.dispatch(Pa)}};of.Object.defineProperties(Sd.prototype,{I1b:{configurable:!0,enumerable:!0,get:function(){return this.Lmg}}});Object(Dd.a)(Sd,"ContextMenuExtensibilityCache",null,[337,338]);var Uj=b(1674),Fg=b(84),Ye=b(4),Th=b(1084),Xh=b(1030);Be.prototype.AYa=function(M,na){na=void 0===na?null:na;if(M=Xh.a.w3a(M)){appChrome.addInApi.dispatchActionsToInstallAddIn(M,na);na=ik(M.tabs);for(var Pa=na.next();!Pa.done;Pa=na.next())if(Pa.value.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(M,
function(){});break}}};Be.prototype.XId=function(M){(M=Xh.a.w3a(M))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(M)};Be.Qgh=function(M,na,Pa){Pa=void 0===Pa?null:Pa;M=Be.pXh(M);0<M.length&&(Be.lwc(M,!1),Pa&&Pa(na,M))};Be.pXh=function(M){var na=[];if(M&&(M=M.ZV,M.Fs&&0<M.Fs.count)){M=ik(M.Fs);for(var Pa=M.next();!Pa.done;Pa=M.next())if(Pa=Pa.value,Pa.groups&&0<Pa.groups.length){Pa=ik(Pa.groups);for(var rb=Pa.next();!rb.done;rb=Pa.next())if(rb=rb.value,rb.controls&&0<rb.controls.length){rb=ik(rb.controls);
for(var cc=rb.next();!cc.done;cc=rb.next())Array.add(na,cc.value.id)}}}return na};Be.lwc=function(M){if(M.length){var na=[];M=ik(M);for(var Pa=M.next();!Pa.done;Pa=M.next())na.push(appChrome.actions.updateControlEnabledDisabledState(Pa.value,!0));appChrome.api.dispatch(na)}};Object(Dd.a)(Be,"OneLineRibbonExtensibilityManager",null,[373]);var fi=b(1154);df.prototype.getTaskPaneControlIdFromAssetIdRuntimeId=function(M,na){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromAssetIdRuntimeId(M,
na)};df.prototype.Qhd=function(M,na,Pa,rb,cc,Dc,Zc){Dc=void 0===Dc?null:Dc;Zc=void 0===Zc?null:Zc;Xd.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",M);if((M=na.Uia(cc.ownerAddinInfo.storeType,cc.ownerAddinInfo.solutionId))&&M.rB&&!M.rB.getIsUpgrading())if(na=null,0<M.rB.getNotificationParams().length&&(na=this.Oue(M.rB.getNotificationParams()[0]))&&2147758681===na.errorCode&&(M.isUpgraded=!0),2!==M.rB.getStatus()&&(1!==M.rB.getStatus()||na&&2147758681===na.errorCode))na&&this.q3f(M,na,Zc);else try{Pa.setOwnerAddinEToken(M.rB.getEToken()),
cc.action(Pa,rb.qma),Dc&&Dc()}catch(nd){Xd.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",Ye.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?nd.stack:nd.message)),fi.a.NRd(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}};df.prototype.q3f=function(M,na,Pa){var rb=this;Pa=void 0===Pa?null:Pa;var cc=M.rB;if(1===cc.getNotificationParams().length||na.mec){var Dc=na.Bha,Zc=
na.ria;na.Bha=function(){cc.removeFirstNotification();if(0<cc.getNotificationParams().length){var nd=rb.Oue(cc.getNotificationParams()[0]);rb.q3f(M,nd)}2147758681===na.errorCode&&(Be.Qgh(M.uo,cc,Object(Fg.a)(rb,rb.w$e,"initUpgradeStateDetectTask")),Sd.Igh(M.mrb,cc,Object(Fg.a)(rb,rb.w$e,"initUpgradeStateDetectTask")));Dc&&Dc()};na.ria=function(){Zc&&Zc();Pa&&Pa()};fi.a.PRd(na)}};df.prototype.w$e=function(M,na){var Pa=null;Pa=function(){M.getIsUpgrading()?window.setTimeout(Pa,1E3):M.getUpgradingFailed()?
Be.lwc(na,!0):Ye.AFrameworkApplication.ta.updateCommandUI()};window.setTimeout(Pa,1E3)};df.prototype.Oue=function(M){var na=new Th.a;na.FLa=M.infoType;na.id=M.id;na.title=M.title;na.description=M.description;na.buttonText=M.buttonTxt;na.Bha=M.buttonCallback;na.mec=M.highPriority;na.ria=M.dismissCallback;na.errorCode=M.errorCode;na.x9e=M.iframeNotificationUrl;return na};of.Object.defineProperties(df.prototype,{ake:{configurable:!0,enumerable:!0,get:function(){return this.tEc||(this.tEc=OfficeExt.DefaultControlActionBinder.retrieveActionContext)},
set:function(M){this.tEc=M}},vOg:{configurable:!0,enumerable:!0,get:function(){return this.k2d||(this.k2d=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}}});Object(Dd.a)(df,"AddinCommandsActionHandler",null,[349]);var Xg=b(83),Ji=b(162),Uh=b(915),qh=b(5),Qh=b(958),bh=b(916);jf.prototype.aHh=function(M){if(void 0!==M&&null!==M&&M===qh.a.RBe)M="ContextMenuCell";else return null;var na=this.Va.Bc();this.tGh(na,M);return na};jf.prototype.tGh=function(M,na){na=this.t3g.oUh(na);
na=ik(na);for(var Pa=na.next();!Pa.done;Pa=na.next()){Pa=ik(Pa.value.controls);for(var rb=Pa.next();!rb.done;rb=Pa.next())this.gGh(M,rb.value)}};jf.prototype.gGh=function(M,na){var Pa=na.nU[Qh.a.id],rb=na.nU[Qh.a.AUa],cc=na.nU[Qh.a.DUa],Dc="Image16by16",Zc=na.nU[Qh.a.BUa];bh.c(cc)&&(Dc="None");0<na.menuItems.count?(Pa=this.Va.Tv(Pa,Pa,rb,798637440),Pa.hLb(Dc,cc,null),this.ZGh(Pa.menu,na),M.buttons.push(Pa)):M.buttons.push(this.Va.LHa(Pa,rb,Zc,cc,Dc,null,!1))};jf.prototype.ZGh=function(M,na){var Pa,
rb=this.Va.Bc();na=ik(na.menuItems);for(Pa=na.next();!Pa.done;Pa=na.next()){var cc=Pa.value;Pa=cc.xla[Qh.a.id];var Dc=cc.xla[Qh.a.AUa],Zc=cc.xla[Qh.a.DUa],nd="Image16by16";cc=cc.xla[Qh.a.BUa];bh.c(Zc)&&(nd="None");Pa=this.Va.LHa(Pa,Dc,cc,Zc,nd,null,!1);rb.buttons.push(Pa)}M.pc.push(rb)};Object(Dd.a)(jf,"AddInCommandsContextMenuExtensibilityHandler",null,[871]);var ti=b(1079);Object(Dd.a)(Ie,"AddinStatusCommandValues",null,[]);Le.I3i=function(M){var na=new Ie;na.mi=M.VYa;na.visible=na.mi?!0:!1;return na};
Le.Yxc=function(M,na,Pa,rb,cc){var Dc=document.getElementById(Pa);Dc?Le.OBj(M,na,Dc,rb,cc):Xd.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",Pa))};Le.OBj=function(M,na,Pa,rb,cc){Pa?M.VYa===CommonUIStrings.l_ErrorLoadingAddInsTitle?fi.a.AAj(na,Pa,rb,cc):M.VYa===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&fi.a.TBj(na,Pa):Xd.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))};Object(Dd.a)(Le,"AddinCommandsStatusHandler",
null,[]);var ni=b(38),aj=b(238),qg=b(14),ui=ni.a;$k(de,ui);de.prototype.hq=function(M){this.addHandler("LAC",M)};de.prototype.Fq=function(M){this.removeHandler("LAC",M)};de.prototype.Kr=function(M,na){var Pa=this;if("QueryAddinLabel"!==M)return!1;na[ti.a.LabelText]!==this.EF.VYa&&(M=Le.I3i(this.EF),na[ti.a.LabelText]=M.mi,na[ti.a.Visible]=M.visible,window.setTimeout(function(){Pa.Yxc()},0));return!0};de.prototype.cn=function(){return!0};de.prototype.Yxc=function(){this.$&&Le.Yxc(this.EF,this.$.domElement,
this.OGj,qg.a.instance.ga(338),qg.a.instance.ga(339))};de.prototype.dispose=function(){this.$.ea.wk(this.Uc);this.EF.Jbj(this.Z4e);this.agaveCommandManager&&(this.agaveCommandManager.Vcj(this.Sye),this.agaveCommandManager=null);this.statusBarManager&&(this.statusBarManager.wF(this),this.statusBarManager=null);this.EF=this.$=null;ui.prototype.dispose.call(this)};Object(Dd.a)(de,"AddinCommandsStatusBarManager",ni.a,[455,269]);var gi=b(1527),hf=b(941),ug=b(153),Ag=b(124),Vj=b(644),Wj=b(142);we.prototype.setErrorMessageForAddin=
function(M,na){this.UYa||(this.UYa={});this.UYa[M]=na};we.prototype.TOh=function(M){return this.UYa&&M in this.UYa?this.UYa[M]:null};Object(Dd.a)(we,"AddinCommandsErrorManager",null,[]);var Uf=b(349),Ih=b(97);Object(Dd.a)(Je,"AddinCommandsListLoaderContext",null,[]);var yh=b(1036);Object(Dd.a)(xe,"AppsForOfficeEntitlementQueryInfo",null,[]);var Jh=b(42),bj=b(270),zh=b(29);Object(Dd.a)(bc,"AddinAbstract",null,[]);var Ki=Sys.EventArgs;$k(Md,Ki);Object(Dd.a)(Md,"InsertionParamEventArgs",Sys.EventArgs,
[]);Sc.prototype.n9b=function(M){var na=new Sys.StringBuilder(this.MJb);na.append("RoamingServiceHandler.ashx?action=");na.append("getAddinTeachingCalloutSettings");na.append("&");na.append(this.Xfd(M));na.append("&");na.append(Ye.AFrameworkApplication.Yi);Ye.AFrameworkApplication.nd.Zl(na.toString(),1,null,null,!0,2,Object(Fg.a)(this,this.Jja,"getRequestSuccessCallback"),Object(Fg.a)(this,this.o4,"getRequestFailureCallback"),null)};Sc.prototype.F2a=function(M){var na=new Sys.StringBuilder(this.MJb);
na.append("RoamingServiceHandler.ashx?action=");na.append("saveAddinTeachingCalloutSettings");na.append("&");na.append(Ye.AFrameworkApplication.Yi);na=na.toString();M=Jh.c(M);Ye.AFrameworkApplication.nd.Zl(na,2,M,null,!0,4,null,Object(Fg.a)(this,this.kW,"postRequestFailureCallback"),null)};Sc.prototype.Jja=function(M){var na=!1,Pa=null;try{if(0<M.data.Rd.length){var rb=Object(cg.a)(Object,Jh.a(M.data.Rd)),cc=rb?rb[this.appName]:null;cc&&(Pa=Object(cg.a)(Object,Jh.a(cc.toString())))}na=!0}catch(Dc){this.o4(null)}na&&
this.Yib&&this.Yib(Pa)};Sc.prototype.o4=function(M){this.Uib&&this.Uib(M?M.data:null)};Sc.prototype.kW=function(M){this.blb&&this.blb(M?M.data:null)};Sc.prototype.Xfd=function(M){for(var na=new Sys.StringBuilder("requestedsettings="),Pa=0;Pa<M.count;Pa++)na.append(M.na(Pa)),Pa<M.count-1&&na.append(";");return na.toString()};Object(Dd.a)(Sc,"AddinTeachingUIRoamingRequestHandler",null,[]);var vi=Sys.EventArgs;$k(Cd,vi);Object(Dd.a)(Cd,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);
var vg=b(360);fd.prototype.r$f=function(M){if(!M)return null;var na=new cf.a;M=ik(M);for(var Pa=M.next();!Pa.done;Pa=M.next())na.add(Pa.value);return na};fd.prototype.rUc=function(M,na){window.addEventListener?(this.Qj=M,this.XYa=na,window.addEventListener("LaunchAddinTaskpane",Object(Fg.a)(this,this.RAd,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(Fg.a)(this,this.Vzd,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(Fg.a)(this,
this.Kzd,"onCloseButtonClickedEventHandler"),!0),Ye.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&window.addEventListener("FGWebSurfaceEvent",Object(Fg.a)(this,this.yEb,"onCampaignLaunchedHandler"),!0)):Xd.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")};fd.prototype.cOj=function(M,na,Pa,rb){this.Th=M;this.aGa=na;this.EBe=Pa;this.Hma=rb;Xd.ULS.sendTraceTag(0,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",
na?na.count.toString():"null",Pa?Pa.count.toString():"null");this.aGa?(M=new cf.a,M.add(this.appName),this.Wnb.n9b(M)):this.Hma(new cf.a,null)};fd.prototype.RAd=function(){var M=this,na=new bj.ScriptSharpLegacyMap;this.XYa&&this.XYa.tabs&&!this.XYa.tabs[0].isOfficeTab&&na.ia("SDX.FeatureFlags","NonOfficeTab");this.gla(fd.hV(this.Qj),"ClickOnLaunch",na);Ye.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.sla();this.XYa?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.XYa,
function(){var Pa=new Md;Pa.Qj=M.Qj;M.Pa.raiseEvent(hf.a.Usd,Pa)}):Xd.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")};fd.prototype.Kzd=function(){this.gla(fd.hV(this.Qj),"ClickOnClose");Ye.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.sla()};fd.prototype.Vzd=function(){this.gla(fd.hV(this.Qj),"ClickOnDismiss");Ye.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)&&this.sla()};fd.prototype.yEb=function(M){if(M&&(M=M.detail)&&M.id&&this.Qmd(M.id)){var na=(M.action||"").toLowerCase();if(M.success&&"opened"===na)this.gla(fd.hV(this.Qj),"CampaignLaunched"),Xd.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.sla(),window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",Object(Fg.a)(this,this.yEb,"onCampaignLaunchedHandler"),!0);else try{var Pa=JSON.stringify(M);Xd.ULS.sendTraceTag(523321995,
220,15,"Campaign launch failure. Event:"+Pa)}catch(rb){Pa="id : "+M.id+" telemetryEventName: "+M.telemetryEventName,Xd.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+Pa+" Error: "+(rb?rb.toString():""))}}};fd.prototype.Qmd=function(M){M=zh.a.cl(M);return-1!==M.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==M.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==M.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==M.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||
-1!==M.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==M.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")};fd.prototype.v0=function(M){if(this.appName){var na={},Pa={};Pa.LastTeachingUIShowTime=(new Date).toUTCString();Pa.AddinHasShown=M;na[this.appName]=Jh.c(Pa);this.Wnb.F2a(na);Xd.ULS.sendTraceTag(539530527,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else Xd.ULS.sendTraceTag(539530528,220,10,"Fail to save roaming service since AppName is null")};
fd.prototype.sla=function(){if(!this.QQa){var M=window.g_roamingAddinList;M&&(this.v0(M),this.QQa=!0)}};fd.prototype.Jja=function(M){M?this.DRd(M)?(Xd.ULS.sendTraceTag(527523845,220,50,"should show teaching UI"),this.cI="AddinHasShown"in M&&M.AddinHasShown?M.AddinHasShown.toString():null,this.Zqb()):(Xd.ULS.sendTraceTag(538248466,220,50,"Not Show TeachingUI this time"),this.Hma(this.aGa,null)):(Xd.ULS.sendTraceTag(527523844,220,50,"userSettings is null"),this.cI=null,this.Zqb())};fd.prototype.o4=
function(M){Xd.ULS.sendTraceTag(539530529,220,10,"GET data from Roaming Settings Service with status: {0}, fallback",M?M.httpStatus:-1);this.Hma(this.aGa,null)};fd.prototype.kW=function(M){Xd.ULS.sendTraceTag(539530530,220,10,"failed to POST data to Roaming Settings Service with status: {0}",M?M.httpStatus:-1)};fd.prototype.Zqb=function(){var M=this.k6c();if(0===M.targetType){M.solutionId?this.ZFd(M):this.gla(M.addinId,"NoSolutionId");if(M.addinId){var na=this.cI?this.cI+","+M.addinId:M.addinId;Ye.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)?window.g_roamingAddinList=na:this.v0(na)}this.Hma(this.aGa,null)}else this.Hma(this.aGa,M);Xd.ULS.sendTraceTag(528023563,220,50,"Show teaching callout for: {0}",M.addinId)};fd.prototype.ZFd=function(M){var na=this,Pa=new xe;Pa.callbackFunc=function(rb){if(rb.errorCode)na.gla(M.solutionId,"FailToGetAppDetails"),Ye.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&(rb=window.g_roamingAddinList)&&na.v0(rb);else if(rb.value){var cc=ik(rb.value);
for(rb=cc.next();!rb.done;rb=cc.next()){rb=rb.value;var Dc=rb[1];if(Dc===M.solutionId){cc={solutionId:Dc};cc.assetId=rb[5];Dc=Ye.AFrameworkApplication.fa.isChangeGateEnabled("QueryEntitlementDetailsStoreTypeFixEnabled");cc.storeType=Dc?rb[12]:rb[6];Ye.AFrameworkApplication.fa.isChangeGateEnabled("StoreIdFixEnabled")?cc.storeId=M.storeId:cc.storeId=rb[11];cc.assetStoreId=rb[6];cc.targetType=rb[3];cc.width=rb[7];cc.height=rb[8];cc.displayName=rb[0];cc.version=rb[4];Xd.ULS.sendTraceTag(0,220,50,"Raise a teaching callout event for content addin: {0}.",
M.solutionId);rb=new Cd(cc);na.Pa.raiseEvent(hf.a.TRd,rb);break}}}};Pa.storeType=OSF.StoreTypeEnum.PrivateCatalog;Pa.fromInsertDialog=!1;Pa.refresh=!1;this.Th.queryEntitlementDetails(Pa)};fd.prototype.DRd=function(M){if("LastTeachingUIShowTime"in M){if(M=+new Date-+new Date(M.LastTeachingUIShowTime.toString()),M<Ye.AFrameworkApplication.fa.HM("AddinShowTeachingUIIntervalInMS",864E5))return Xd.ULS.sendTraceTag(538248467,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",M),!1}else Xd.ULS.sendTraceTag(527523846,
220,50,"userSetting has no date key");return!0};fd.prototype.k6c=function(){for(var M=new Uf.a(new bc,0),na=new Uf.a(new bc,0),Pa=0,rb=0,cc=0,Dc=new cf.a,Zc=ik(this.aGa),nd=Zc.next();!nd.done;nd=Zc.next())Dc.add(nd.value);Zc=ik(this.EBe);for(nd=Zc.next();!nd.done;nd=Zc.next())Dc.add(nd.value);Dc=ik(Dc);for(nd=Dc.next();!nd.done;nd=Dc.next())if(nd=nd.value,!("excatalog"!==nd.storeType||bh.c(nd.installTimeInMS)||!nd.installTimeInMS||nd.installTimeInMS<=Ye.AFrameworkApplication.fa.HM("DateTimeInMSForNewAddin",
16409952E5))){Zc=fd.Yub(nd);if(this.cI){var Id=this.cI.split(",");if(0<Id.length&&Array.contains(Id,Zc)){cc++;Xd.ULS.sendTraceTag(528345032,220,50,"This addin has shown teaching UI before");continue}}Zc.startsWith("private_")?(M.value<nd.installTimeInMS&&(M=new Uf.a(Object.assign(new bc,{addinId:Zc,targetType:nd.targetType,storeId:nd.storeId,solutionId:nd.solutionId}),nd.installTimeInMS)),rb++):(na.value<nd.installTimeInMS&&(na=new Uf.a(Object.assign(new bc,{addinId:Zc,targetType:nd.targetType,storeId:nd.storeId,
solutionId:nd.solutionId}),nd.installTimeInMS)),Pa++)}Xd.ULS.sendTraceTag(528345033,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",rb,Pa,cc);return 0<na.value?na.key:0<M.value?M.key:Object.assign(new bc,{addinId:null,targetType:-1,solutionId:null,storeId:null})};fd.prototype.gla=function(M,na,Pa){Pa=void 0===Pa?null:Pa;var rb={};M=(rb.AppTeachingUICalloutAction=na,rb["SDX.Id"]=M,rb.AppTeachingUICalloutGoal="NewAdminDeployment",rb["SDX.AppInstallOrigin"]=
"Organization",rb);if(Pa)for(na=ik(Pa.keys),rb=na.next();!rb.done;rb=na.next())rb=rb.value,M[rb]=Pa.na(rb);ug.a.sendTelemetryEvent(Object.assign(new vg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ag.a.Gk(M)}))};fd.prototype.Koi=function(M,na){return na&&na.addinId?na.addinId===fd.Yub(M):!1};fd.prototype.JUj=function(M){M=this.cI?this.cI+","+M.addinId:M.addinId;Ye.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)?window.g_roamingAddinList=
M:this.v0(M)};fd.hV=function(M){return Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.storeType,M.assetId,null,null,M.storeId)};fd.Yub=function(M){return Telemetry.PrivacyRules.IsPrivateAddin(M.storeType,M.assetId,null,null,M.storeId)?"private_"+M.installTimeInMS:M.solutionId};of.Object.defineProperties(fd.prototype,{appName:{configurable:!0,enumerable:!0,get:function(){return Ye.AFrameworkApplication.fa.Wa("WebAppShortName")}},Wnb:{configurable:!0,enumerable:!0,get:function(){this.AX||
(this.AX=new Sc(this.appName,Object(Fg.a)(this,this.Jja,"getRequestSuccessCallback"),Object(Fg.a)(this,this.o4,"getRequestFailureCallback"),Object(Fg.a)(this,this.kW,"postRequestFailureCallback")));return this.AX}},aGa:{configurable:!0,enumerable:!0,get:function(){this.VQb||(this.VQb=new cf.a);return this.VQb},set:function(M){this.VQb=M}},EBe:{configurable:!0,enumerable:!0,get:function(){this.WRb||(this.WRb=new cf.a);return this.WRb},set:function(M){this.WRb=M}}});Object(Dd.a)(fd,"PrivateCatalogTeachingCalloutHandler2",
null,[]);var wi=b(81),Aj=b(903);ic.prototype.get_current=function(){if(!this.yr)throw Error.argumentOutOfRange();return this.yr.data};ic.prototype.moveNext=function(){if(!this.yr)return this.yr=this.gA,!!this.gA;if(!this.yr.next)return!1;this.yr=this.yr.next;return!0};ic.prototype.Olc=function(){if(!this.yr)return this.yr=this.gA,!!this.gA;if(!this.yr.previous)return!1;this.yr=this.yr.previous;return!0};ic.prototype.reset=function(){this.yr=this.gA};Object(Dd.a)(ic,"ListEnumerator",null,[0]);Object(Dd.a)(mb,
"ListNode",null,[]);nc.prototype.add=function(M){this.Vp?this.lA=this.lA.next=new mb(M,this.lA,null):this.Vp=this.lA=new mb(M,null,null);this._count=this.count+1};nc.prototype.insert=function(M,na){if(M>this.count||0>M)throw Error.argumentOutOfRange("pos");if(M===this.count)this.add(na);else{for(var Pa=this.Vp;0!==M--;)Pa=Pa.next;M=new mb(na,Pa.previous,Pa);M.previous?M.previous.next=M:this.Vp=M;M.next?M.next.previous=M:this.lA=M;this._count=this.count+1}};nc.prototype.remove=function(M){for(var na=
this.Vp;na&&na.data!==M;)na=na.next;if(!na)return!1;na.previous?na.previous.next=na.next:this.Vp=na.next;na.next?na.next.previous=na.previous:this.lA=na.previous;this._count=this.count-1;return!0};nc.prototype.clear=function(){var M=this.Vp;for(this.lA=this.Vp=null;M;){var na=M.next;M.previous=null;M.next=null;M=na}this._count=0};nc.prototype.indexOf=function(M){for(var na=this.Vp,Pa=0;na&&na.data!==M;)na=na.next,Pa++;return na?Pa:-1};nc.prototype.na=function(M){return this.at(M).data};nc.prototype.getEnumerator=
function(){return new ic(this.Vp)};nc.prototype[Symbol.iterator]=function(){return Object(Aj.a)(this.getEnumerator())};nc.prototype.obc=function(M){M=this.at(M);return new ic(M)};nc.prototype.toArray=function(){for(var M=Array(this.count),na=0,Pa=ik(this),rb=Pa.next();!rb.done;rb=Pa.next())M[na]=rb.value,na++;return M};nc.prototype.at=function(M){for(var na=this.Vp,Pa=0;Pa!==M;){if(!na)throw Error.argumentOutOfRange("pos");na=na.next;Pa++}return na};of.Object.defineProperties(nc.prototype,{count:{configurable:!0,
enumerable:!0,get:function(){return this._count}}});Object(Dd.a)(nc,"List",null,[1]);var Li=Sys.EventArgs;$k(Ob,Li);Object(Dd.a)(Ob,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);Object(Dd.a)(wc,"MiniAddinInfo",null,[]);xb.prototype.XEg=function(M){this.Pa.addHandler(hf.a.Snb,M)};xb.prototype.qIg=function(M){this.Pa.addHandler(hf.a.TRd,M)};xb.prototype.uPj=function(M){var na=this;null!==M&&(this.context.wR=M[hf.a.V9],this.context.Vr=M[hf.a.rP],this.context.EAc=this.context.Wqc=0,
M=hf.a.cGa in M?M[hf.a.cGa]:0,-1!==this.context.wR&&0!==this.context.Vr&&(this.context.I2=new nc,this.context.kja=new nc,this.context.hrb=new nc,this.context.KVc=this.UIg.createAddinDataProvider(hc(this.context.wR),this.contextActivationMgr),this.context.KVc?this.context.KVc.getEntitlementsAsync(this.contextActivationMgr.qma,!0,M,function(Pa){na.qPi(Pa)}):Xd.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.wR)))};xb.prototype.qPi=function(M){var na=this;if(M&&
0<M.length){this.context.EAc=M.length;for(var Pa=Ye.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")?md():null,rb=0;rb<M.length;rb++){var cc=M[rb];if(Ye.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")&&rd()&&cc&&cc.storeType&&"omex"===cc.storeType.toLowerCase()&&cc.assetId&&Pa&&cc.assetId.toLowerCase()===Pa.toLowerCase()){var Dc=xb.hV(cc),Zc={};Dc=(Zc.SDX_AppInstallOrigin="DeeplinkUser",Zc.SDX_Id=Dc,Zc);
ug.a.sendTelemetryEvent(Object.assign(new vg.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Ag.a.Gk(Dc)}))}!cc||1!==cc.targetType&&-1!==cc.targetType?this.hzd():(Dc={},Dc.marketplaceId=cc.solutionId,Dc.marketplaceVersion=cc.version,Dc.storeType=cc.storeType,Dc.storeId=cc.storeId,Dc.targetData=cc,this.contextActivationMgr.isAddinCommandsAsync(Dc,function(nd,Id,Od){nd?(Id&&na.context.I2.add(Od.targetData),10===na.context.wR&&(nd=Od.targetData,Id=nd.targetType,Ye.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PropertiesForTeachingUIOfPrivateCatelogEnabled",
!1)&&!bh.c(Od.targetTypeForExp)&&(Id=Od.targetTypeForExp,nd.targetType=Id),na.context.kja.add(nd),0===Id&&na.context.hrb.add(nd))):(Od=Od.targetData,Xd.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Od.solutionId,Od.storeType,Od.assetId,null,null,Od.storeId),Od.storeType));na.hzd()}))}}else this.hzd()};xb.prototype.hzd=function(){var M=this,na;(na=this.context).Wqc=na.Wqc+1;if(this.context.Wqc>=this.context.EAc)if(this.t_b.GYf(this.context.wR,
!1),0<this.context.EAc&&10===this.context.wR&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName))if(na=!1,Ye.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")&&Cc()&&(na=this.Jvi()),this.Xui(),Ye.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&!na)if(xb.c9f){na=this.jBa.r$f(this.context.I2);var Pa=this.jBa.r$f(this.context.hrb);this.jBa.cOj(this.contextActivationMgr,
na,Pa,function(rb,cc){var Dc=new cf.a;rb=ik(rb);for(var Zc=rb.next();!Zc.done;Zc=rb.next()){Zc=Zc.value;var nd=Jc(Zc);cc&&M.jBa.Koi(Zc,cc)&&(nd.showCallout=!0,M.jBa.JUj(cc));Dc.add(nd)}M.Hma(Dc)})}else this.PIh(this.context.I2);else this.rZb(this.context.I2);else this.rZb(this.context.I2)};xb.prototype.rZb=function(M){if(xb.c9f)this.Hma(this.Q1g(M));else{var na=new cf.a;if(M){M=ik(this.context.I2);for(var Pa=M.next();!Pa.done;Pa=M.next())na.add(Jc(Pa.value))}this.context.I2&&1>this.context.I2.count&&
yh.a.efb(hf.a.Tnb,"false",this.context.wR);M={};na=(M.ack2=na,M);na[hf.a.V9]=this.context.wR;na[hf.a.rP]=this.context.Vr;this.Pa.raiseEvent(hf.a.Snb,new Ob(na),this)}};xb.prototype.Q1g=function(M){var na=new cf.a;if(M){M=ik(M);for(var Pa=M.next();!Pa.done;Pa=M.next())na.add(Jc(Pa.value))}return na};xb.prototype.Hma=function(M){M&&M.count||yh.a.efb(hf.a.Tnb,"false",this.context.wR);var na={};M=(na.ack2=M,na);M[hf.a.V9]=this.context.wR;M[hf.a.rP]=this.context.Vr;this.Pa.raiseEvent(hf.a.Snb,new Ob(M),
this)};xb.prototype.v0=function(M){if(this.appName){var na={},Pa={};Pa.LastTeachingUIShowTime=(new Date).toUTCString();Pa.AddinHasShown=M;na[this.appName]=Jh.c(Pa);this.AX&&(this.AX.F2a(na),Xd.ULS.sendTraceTag(539530527,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service"))}else Xd.ULS.sendTraceTag(539530528,306,10,"Fail to save roaming service since AppName is null")};xb.prototype.PIh=function(M){if(this.bGa=M)M=new cf.a,M.add(this.appName),
this.AX=new Sc(this.appName,Object(Fg.a)(this,this.Jja,"getRequestSuccessCallback"),Object(Fg.a)(this,this.o4,"getRequestFailureCallback"),Object(Fg.a)(this,this.kW,"postRequestFailureCallback")),this.AX.n9b(M);else{M=new cf.a;var na={};M=(na.ack2=M,na);M[hf.a.V9]=this.context.wR;M[hf.a.rP]=this.context.Vr;this.Pa.raiseEvent(hf.a.Snb,new Ob(M),this)}};xb.prototype.Jja=function(M){M?this.DRd(M)?(Xd.ULS.sendTraceTag(527523845,306,50,"should show teaching UI"),this.cI="AddinHasShown"in M&&M.AddinHasShown?
M.AddinHasShown.toString():null,this.Zqb()):(Xd.ULS.sendTraceTag(538248466,306,50,"Not Show TeachingUI this time"),this.rZb(this.bGa)):(Xd.ULS.sendTraceTag(527523844,306,50,"userSettings is null"),this.cI=null,this.Zqb())};xb.prototype.o4=function(M){Xd.ULS.sendTraceTag(539530529,306,10,"GET data from Roaming Settings Service with status: {0}, fallback",M?M.httpStatus:-1);this.rZb(this.bGa)};xb.prototype.kW=function(M){Xd.ULS.sendTraceTag(539530530,306,10,"failed to POST data to Roaming Settings Service with status: {0}",
M?M.httpStatus:-1)};xb.prototype.Zqb=function(){var M=this.k6c();if(0===M.targetType){M.solutionId?(this.tTd=M.solutionId,this.l7f=M.storeId,this.ZFd()):this.gla("NoSolutionId");if(M.addinId){var na=this.cI?this.cI+","+M.addinId:M.addinId;Ye.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)?window.g_roamingAddinList=na:this.v0(na)}this.Nle(null)}else this.Nle(M.addinId);Xd.ULS.sendTraceTag(528023563,306,50,"Show teaching callout for: {0}",M.addinId)};
xb.prototype.ZFd=function(){var M=this,na=new xe;na.callbackFunc=function(Pa){if(Pa.errorCode)M.gla("FailToGetAppDetails"),Ye.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&(Pa=window.g_roamingAddinList)&&M.v0(Pa);else if(Pa.value){var rb=ik(Pa.value);for(Pa=rb.next();!Pa.done;Pa=rb.next()){Pa=Pa.value;var cc=Pa[1];if(cc===M.tTd){rb={solutionId:cc};rb.assetId=Pa[5];cc=Ye.AFrameworkApplication.fa.isChangeGateEnabled("QueryEntitlementDetailsStoreTypeFixEnabled");
rb.storeType=cc?Pa[12]:Pa[6];Ye.AFrameworkApplication.fa.isChangeGateEnabled("StoreIdFixEnabled")?rb.storeId=M.l7f:rb.storeId=Pa[11];rb.assetStoreId=Pa[6];rb.targetType=Pa[3];rb.width=Pa[7];rb.height=Pa[8];rb.displayName=Pa[0];rb.version=Pa[4];Pa=new Cd(rb);M.Pa.raiseEvent(hf.a.TRd,Pa);break}}}};na.storeType=OSF.StoreTypeEnum.PrivateCatalog;na.fromInsertDialog=!1;na.refresh=!1;this.contextActivationMgr.queryEntitlementDetails(na)};xb.prototype.DRd=function(M){if("LastTeachingUIShowTime"in M){if(M=
+new Date-+new Date(M.LastTeachingUIShowTime.toString()),M<Ye.AFrameworkApplication.fa.HM("AddinShowTeachingUIIntervalInMS",864E5))return Xd.ULS.sendTraceTag(538248467,306,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",M),!1}else Xd.ULS.sendTraceTag(527523846,306,50,"userSetting has no date key");return!0};xb.prototype.k6c=function(){var M=new Uf.a(new wc,0),na=new Uf.a(new wc,0),Pa=0,rb=0,cc=0,Dc=new nc;if(0<this.context.I2.count)for(var Zc=ik(this.context.I2),nd=Zc.next();!nd.done;nd=
Zc.next())Dc.add(nd.value);if(0<this.context.hrb.count)for(Zc=ik(this.context.hrb),nd=Zc.next();!nd.done;nd=Zc.next())Dc.add(nd.value);Dc=ik(Dc);for(nd=Dc.next();!nd.done;nd=Dc.next())if(nd=nd.value,!("excatalog"!==nd.storeType||bh.c(nd.installTimeInMS)||!nd.installTimeInMS||nd.installTimeInMS<=Ye.AFrameworkApplication.fa.HM("DateTimeInMSForNewAddin",16409952E5))){Zc=xb.Yub(nd);if(this.cI){var Id=this.cI.split(",");if(0<Id.length&&Array.contains(Id,Zc)){cc++;Xd.ULS.sendTraceTag(528345032,306,50,"This addin has shown teaching UI before");
continue}}Zc.startsWith("private_")?(M.value<nd.installTimeInMS&&(M=new Uf.a(Object.assign(new wc,{addinId:Zc,targetType:nd.targetType,storeId:nd.storeId,solutionId:nd.solutionId}),nd.installTimeInMS)),rb++):(na.value<nd.installTimeInMS&&(na=new Uf.a(Object.assign(new wc,{addinId:Zc,targetType:nd.targetType,storeId:nd.storeId,solutionId:nd.solutionId}),nd.installTimeInMS)),Pa++)}Xd.ULS.sendTraceTag(528345033,306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",
rb,Pa,cc);return 0<na.value?na.key:0<M.value?M.key:Object.assign(new wc,{addinId:null,targetType:-1,solutionId:null,storeId:null})};xb.prototype.Nle=function(M){for(var na=new cf.a,Pa=ik(this.bGa),rb=Pa.next();!rb.done;rb=Pa.next()){var cc=rb.value;rb=Jc(cc);M&&(cc=xb.Yub(cc),M===cc&&(rb.showCallout=!0,cc=this.cI?this.cI+","+M:M,Ye.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)?window.g_roamingAddinList=cc:this.v0(cc)));na.add(rb)}this.bGa&&
1>this.bGa.count&&yh.a.efb(hf.a.Tnb,"false",this.context.wR);M={};na=(M.ack2=na,M);na[hf.a.V9]=this.context.wR;na[hf.a.rP]=this.context.Vr;this.Pa.raiseEvent(hf.a.Snb,new Ob(na),this)};xb.prototype.Jvi=function(){var M=!1;if(this.context.kja&&1>this.context.kja.count)return M;var na=md();if(!na)return M;for(var Pa=ik(this.context.kja),rb=Pa.next();!rb.done;rb=Pa.next())if(rb=rb.value,rb.storeId&&rb.storeId.toLowerCase()===na.toLowerCase()||rb.assetId&&rb.assetId.toLowerCase()===na.toLowerCase()){M=
xb.hV(rb);var cc={};rb=(cc.SDX_Id=M,cc.SDX_TargetType=bh.c(rb.targetType)?"":rb.targetType.toString(),cc);ug.a.sendTelemetryEvent(Object.assign(new vg.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:Ag.a.Gk(rb)}));M=!0}return M};xb.prototype.Xui=function(){if(!(this.context.kja&&1>this.context.kja.count))if(this.t_b.Dki()){var M=this.t_b.GVh();M?(M=this.lYe(this.context.kja,M),Xd.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(M=this.lYe(this.context.kja,
null),Xd.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.t_b.ytj(M)}else Xd.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")};xb.prototype.lYe=function(M,na){var Pa={},rb=!1;M=ik(M);for(var cc=M.next();!cc.done;cc=M.next()){cc=cc.value;var Dc=xb.hV(cc);Dc&&(!na||Dc in na||(this.Kxa(cc,Dc),Xd.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===Dc.toLowerCase()?rb||(rb=!0,Pa[Dc]=null):Pa[Dc]=null)}return Pa};xb.prototype.Kxa=function(M,
na){var Pa=M.installTimeInMS?(new Date(M.installTimeInMS)).toISOString():"",rb={};Pa=(rb["SDX.Id"]=na,rb["SDX.AppInstallOrigin"]="Organization",rb["SDX.TargetType"]=bh.c(M.targetType)?"":M.targetType.toString(),rb["SDX.AdminDeploymentTime"]=Pa,rb);ug.a.sendTelemetryEvent(Object.assign(new vg.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Ag.a.Gk(Pa)}));1===M.targetType&&(M={},na=(M["SDX.Id"]=na,M["SDX.AppInstallOrigin"]="Organization",M["SDX.CommandPlacement"]="Ribbon",M),ug.a.sendTelemetryEvent(Object.assign(new vg.a,
{name:"Office.Extensibility.Host.AppPinning",dataFields:Ag.a.Gk(na)})))};xb.prototype.gla=function(M){var na={};M=(na.AppTeachingUICalloutAction=M,na["SDX.Id"]=this.tTd,na.AppTeachingUICalloutGoal="NewAdminDeployment",na["SDX.AppInstallOrigin"]="Organization",na);ug.a.sendTelemetryEvent(Object.assign(new vg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ag.a.Gk(M)}))};xb.hV=function(M){return Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.storeType,M.assetId,null,
null,M.storeId)};xb.Yub=function(M){return Telemetry.PrivacyRules.IsPrivateAddin(M.storeType,M.assetId,null,null,M.storeId)?"private_"+M.installTimeInMS:M.solutionId};of.Object.defineProperties(xb.prototype,{jBa:{configurable:!0,enumerable:!0,get:function(){this.aSc||(this.aSc=new fd(this.Pa));return this.aSc}}});of.Object.defineProperties(xb,{c9f:{configurable:!0,enumerable:!0,get:function(){return Ye.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",
!1)}}});Object(Dd.a)(xb,"AddInCommandsListLoader",null,[]);Mc.prototype.insertOsfControl=function(M){return this.qma.insertOsfControl(M)};Mc.prototype.getManifestInvaildErrorString=function(){return this.qma.getManifestInvaildErrorString()};Mc.prototype.isAddinCommandsAsync=function(M,na){this.qma.isAddinCommandsAsync(M,na)};Mc.prototype.ownerAddinControlRecreated=function(M,na){this.qma.ownerAddinControlRecreated(M,na)};Mc.prototype.queryEntitlementDetails=function(M){this.qma.queryEntitlementDetails(M)};
of.Object.defineProperties(Mc.prototype,{qma:{configurable:!0,enumerable:!0,get:function(){return this.xug}}});Object(Dd.a)(Mc,"ContextActivationMgrWrapper",null,[327]);Yc.prototype.createAddinDataProvider=function(M,na){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(M,na.qma)};of.Object.defineProperties(Yc,{instance:{configurable:!0,enumerable:!0,get:function(){Yc.Ma||(Yc.Ma=new Yc);return Yc.Ma}}});Yc.Ma=null;Object(Dd.a)(Yc,"OSFAddinDataProviderFactory",null,[325]);Object(Dd.a)(Ic,
"CacheItem",null,[]);fc.prototype.ml=function(M){var na=this.fEa.getItem(M);if(na){var Pa=new Ic;try{Pa=Sys.Serialization.JavaScriptSerializer.deserialize(na,!0)}catch(rb){return this.fEa.removeItem(M),null}return Pa.Data?Pa.Data:Pa.data}return null};fc.prototype.lQa=function(M){this.fEa.removeItem(M)};Object(Dd.a)(fc,"AppsDataCacheManager",null,[134]);var oi=b(1037);ib.prototype.GYf=function(M,na){M=hf.a.nZe()+M;oi.a.instance.setItem(M,na.toString())};ib.prototype.GVh=function(){var M=hf.a.n1e();
Xd.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",M);M=oi.a.instance.getItem(M);return Jh.a(M)};ib.prototype.ytj=function(M){var na=hf.a.n1e();Xd.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",na);oi.a.instance.setItem(na,Jh.c(M))};ib.prototype.Dki=function(){return!!oi.a.instance.localStorage};of.Object.defineProperties(ib,{instance:{configurable:!0,enumerable:!0,get:function(){ib.Ma||(ib.Ma=new ib);return ib.Ma}}});ib.Ma=null;Object(Dd.a)(ib,"AddInCommandsCacheManager",null,[336]);
Object(Dd.a)(zb,"PostLaunchAddinCommandsParameters",null,[]);ob.prototype.rUc=function(){window.addEventListener?(window.addEventListener("LaunchAddinTaskpane",Object(Fg.a)(this,this.RAd,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(Fg.a)(this,this.Vzd,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(Fg.a)(this,this.Kzd,"onCloseButtonClickedEventHandler"),!0),Ye.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)&&window.addEventListener("FGWebSurfaceEvent",Object(Fg.a)(this,this.yEb,"onCampaignLaunchedHandler"),!0)):Xd.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")};ob.prototype.RAd=function(){var M=this,na={};na=(na.AppTeachingUICalloutAction="ClickOnLaunch",na["SDX.Id"]=ob.hV(this.qjb),na.AppTeachingUICalloutGoal="NewAdminDeployment",na["SDX.AppInstallOrigin"]="Organization",na);this.Kgb&&this.Kgb.tabs&&!this.Kgb.tabs[0].isOfficeTab&&(na["SDX.FeatureFlags"]=
"NonOfficeTab");ug.a.sendTelemetryEvent(Object.assign(new vg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ag.a.Gk(na)}));Ye.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.sla();this.Kgb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.Kgb,function(){var Pa=new Md;Pa.Qj=M.qjb;M.$a.raiseEvent(hf.a.Usd,Pa)}):Xd.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")};
ob.prototype.Kzd=function(){var M={};M=(M.AppTeachingUICalloutAction="ClickOnClose",M["SDX.Id"]=ob.hV(this.qjb),M.AppTeachingUICalloutGoal="NewAdminDeployment",M["SDX.AppInstallOrigin"]="Organization",M);ug.a.sendTelemetryEvent(Object.assign(new vg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ag.a.Gk(M)}));Ye.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.sla()};ob.prototype.Vzd=function(){var M={};M=(M.AppTeachingUICalloutAction=
"ClickOnDismiss",M["SDX.Id"]=ob.hV(this.qjb),M.AppTeachingUICalloutGoal="NewAdminDeployment",M["SDX.AppInstallOrigin"]="Organization",M);ug.a.sendTelemetryEvent(Object.assign(new vg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ag.a.Gk(M)}));Ye.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.sla()};ob.prototype.yEb=function(M){if(M&&(M=M.detail)&&M.id&&this.Qmd(M.id)){var na=(M.action||"").toLowerCase();if(M.success&&
"opened"===na){var Pa={};Pa=(Pa.AppTeachingUICalloutAction="CampaignLaunched",Pa["SDX.Id"]=ob.hV(this.qjb),Pa.AppTeachingUICalloutGoal="NewAdminDeployment",Pa["SDX.AppInstallOrigin"]="Organization",Pa);ug.a.sendTelemetryEvent(Object.assign(new vg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ag.a.Gk(Pa)}));Xd.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming.");this.sla();window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",
Object(Fg.a)(this,this.yEb,"onCampaignLaunchedHandler"),!0)}else try{Pa=JSON.stringify(M),Xd.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+Pa)}catch(rb){Pa="id : "+M.id+" telemetryEventName: "+M.telemetryEventName,Xd.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+Pa+" Error: "+(rb?rb.toString():""))}}};ob.prototype.Qmd=function(M){M=zh.a.cl(M);return-1!==M.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==M.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||
-1!==M.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==M.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==M.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==M.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")};ob.prototype.v0=function(M){var na=Ye.AFrameworkApplication.fa.Wa("WebAppShortName");if(na){var Pa={},rb={};rb.LastTeachingUIShowTime=(new Date).toUTCString();rb.AddinHasShown=M;Pa[na]=Jh.c(rb);this.AX=new Sc(na,null,null,Object(Fg.a)(this,this.kW,"postRequestFailureCallback")),
this.AX.F2a(Pa),Xd.ULS.sendTraceTag(523535564,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else Xd.ULS.sendTraceTag(523535565,220,10,"Fail to save roaming service since AppName is null")};ob.prototype.sla=function(){if(!this.QQa){var M=window.g_roamingAddinList;M&&(this.v0(M),this.QQa=!0)}};ob.prototype.kW=function(M){Xd.ULS.sendTraceTag(523535566,220,10,"failed to POST data to Roaming Settings Service with status: {0}",M?M.httpStatus:
-1)};ob.hV=function(M){return Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.storeType,M.assetId,null,null,M.storeId)};Object(Dd.a)(ob,"PrivateCatalogTeachingCalloutHandler",null,[]);Fb.prototype.AYa=function(M,na){this.u8d.AYa(M,void 0===na?null:na);this.y$d=M};Fb.prototype.XId=function(M){this.u8d.XId(M)};of.Object.defineProperties(Fb.prototype,{xxa:{configurable:!0,enumerable:!0,get:function(){return this.y$d}}});Object(Dd.a)(Fb,"RibbonExtensibilityManagerWithChangeDetection",null,
[373]);var hi=b(1083),Bj=b(100);Nc.YZe=function(M){var na=new cf.a;if(Nc.TAe)for(var Pa=ik(Nc.TAe),rb=Pa.next();!rb.done;rb=Pa.next())na.add(rb.value);rb=null;switch(M){case "Workbook":rb=Nc.mZj;break;case "Document":rb=Nc.Dih;break;case "Presentation":rb=Nc.s1i}if(rb)for(M=ik(rb),rb=M.next();!rb.done;rb=M.next())na.add(rb.value);return na};Nc.TAe=["PrimaryCommandSurface","ContextMenu"];Nc.mZj=null;Nc.Dih=null;Nc.s1i=null;Object(Dd.a)(Nc,"ExtensionPointType",null,[]);of.Object.defineProperties(uc.prototype,
{kEb:{configurable:!0,enumerable:!0,get:function(){return this.sce||(this.sce=new cf.a)}},npe:{configurable:!0,enumerable:!0,get:function(){return this.qlg}}});Object(Dd.a)(uc,"ContextMenuExtensibility",null,[339]);of.Object.defineProperties(Gc.prototype,{ZV:{configurable:!0,enumerable:!0,get:function(){return this.qug}},startedNode:{configurable:!0,enumerable:!0,get:function(){return this.Pxg}},$Hh:{configurable:!0,enumerable:!0,get:function(){return this.Xpg}}});Object(Dd.a)(Gc,"RibbonExtensibility",
null,[381]);Xb.prototype.createActionContext=function(M,na){M={};M.ownerAddinInfo=this.entitlement;M.action=na;return M};of.Object.defineProperties(Xb.prototype,{entitlement:{configurable:!0,enumerable:!0,get:function(){return this.Uog}}});Object(Dd.a)(Xb,"AddInCommandsContextProvider",null,[]);hb.prototype.Q6g=function(M){return new Xb(M)};hb.prototype.createActionBuilder=function(M,na){return OfficeExt.DefaultControlActionBinder.createActionBuilder(M,na.entitlement,na.manifest)};hb.prototype.startApplyAddin=
function(M){this.E1d=M;var na=this.Q6g(M);this.actionBuilder=this.createActionBuilder(na,M)};hb.prototype.endApplyAddin=function(){};hb.prototype.wcd=function(M,na,Pa){Pa=void 0===Pa?0:Pa;return this.ribbonBuilder.Fs&&0<this.ribbonBuilder.Fs.count?new Gc(this.oHh(M,na),this.Loe.startedNode,Pa):null};hb.prototype.NVe=function(){var M=void 0===M?null:M;if(this.contextMenuBuilder.ulc&&0<this.contextMenuBuilder.ulc.count){M||(M=this.Loe.entitlement.solutionId);M=new uc(M);for(var na=ik(this.contextMenuBuilder.ulc),
Pa=na.next();!Pa.done;Pa=na.next())M.kEb.add(Pa.value);return M}return null};hb.prototype.oHh=function(M,na){return this.ribbonBuilder.Fs&&0<this.ribbonBuilder.Fs.count?new Xh.a(this.ribbonBuilder.Fs,M,na):null};of.Object.defineProperties(hb.prototype,{Loe:{configurable:!0,enumerable:!0,get:function(){return this.E1d}}});Object(Dd.a)(hb,"AddinCommandsBuilder",null,[]);Ub.prototype.WBb=function(M,na,Pa,rb,cc,Dc,Zc){function nd(Re,Ke,Ef,ff){cc(Re,Ke,Ef,ff);Re=hi.a[Id.Vr]+Ke.assetId;Ef=Id.LSa.yc(Re);
Ke=Ef.value;Ef.returnValue&&(Ke.stop(),Id.LSa.remove(Re))}var Id=this;if(0!==this.Vr&&M)for(Xd.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",M.count),4===this.Vr&&(Xd.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",rb)),this.$Yg(M,rb),Dc()),M=ik(M),rb=M.next();!rb.done;rb=M.next())if(rb=rb.value,Xd.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.Co.TM,Telemetry.PrivacyRules.GetPrivacyCompliantId(rb.solutionId,rb.ownerAddinStoreType||
rb.storeType,rb.assetId,null,null,rb.storeId))),this.egg(rb))if(Zc&&rb.requireConsent)Zc(rb,function(Re){try{if(Id.qO){var Ke=hi.a[Id.Vr]+Re.solutionId,Ef=Id.qO.sc("ComponentAttach",Ke);Id.LSa.ia(Ke,Ef)}var ff=Id.EF.Uia(Re.storeType,Re.solutionId);6!==Id.Vr&&(ff&&(Id.O2b(ff),ff.rB.purge(!1)),Id.Th.insertOsfControl(Id.YGb(Re,na,Pa,nd)),ff&&Id.Th.ownerAddinControlRecreated(Re.solutionId,Re.storeType))}catch(xf){Xd.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",
Id.Co.TM,Telemetry.PrivacyRules.GetPrivacyCompliantId(Re.solutionId,Re.ownerAddinStoreType||Re.storeType,Re.assetId,null,null,Re.storeId),Re.version,Re.storeType,Re.storeId,xf.message)),nd(!1,Re,null,null)}});else try{if(this.qO){var Od=hi.a[this.Vr]+rb.solutionId,je=this.qO.sc("ComponentAttach",Od);this.LSa.ia(Od,je)}var Ae=this.EF.Uia(rb.storeType,rb.solutionId);6!==this.Vr&&(Ae&&(this.O2b(Ae),Ae.rB.purge(!1)),this.Th.insertOsfControl(this.YGb(rb,na,Pa,nd)),Ae&&this.Th.ownerAddinControlRecreated(rb.solutionId,
rb.storeType))}catch(Re){Xd.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.Co.TM,Telemetry.PrivacyRules.GetPrivacyCompliantId(rb.solutionId,rb.ownerAddinStoreType||rb.storeType,rb.assetId,null,null,rb.storeId),rb.version,rb.storeType,rb.storeId,Re.message)),nd(!1,rb,null,null)}else nd(!1,rb,null,null)};Ub.prototype.osi=function(M,na,Pa,rb,cc,Dc){function Zc(Ae,Re,Ke,Ef){Dc(Ae,
Re,Ke,Ef);Ae=hi.a[nd.Vr]+Re.solutionId;Ke=nd.LSa.yc(Ae);Re=Ke.value;Ke.returnValue&&(Re.stop(),nd.LSa.remove(Ae))}var nd=this;if(6===this.Vr&&M)if(Xd.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.Co.TM,Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.ownerAddinStoreType||M.storeType,M.assetId,null,null,M.storeId))),this.egg(M))try{if(this.qO){var Id=hi.a[this.Vr]+M.solutionId,Od=this.qO.sc("ComponentAttach",Id);this.LSa.ia(Id,Od)}var je=this.EF.Uia(M.storeType,
M.solutionId);je||Zc(!1,M,null,null);Ye.AFrameworkApplication.ta&&Ye.AFrameworkApplication.ta.Qa.delayInstallAddInIsEnabled?this.kWe(M,na,rb,cc,Pa,function(Ae){Zc(Ae,M,Pa,je.displayName)}):(this.kWe(M,na,rb,cc,Pa),Zc(!0,M,Pa,je.displayName))}catch(Ae){Xd.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",this.Co.TM,Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,
M.ownerAddinStoreType||M.storeType,M.assetId,null,null,M.storeId),M.version,M.storeType,M.storeId,Ae.message)),Zc(!1,M,null,null)}else Zc(!1,M,null,null)};Ub.prototype.eHi=function(M,na,Pa,rb,cc,Dc){if(Dc)if(Dc._isAddinCommandsManifest(this.Co.TM))try{Ye.AFrameworkApplication.ta&&Ye.AFrameworkApplication.ta.Qa.delayInstallAddInIsEnabled?this.jWe(M,na,Pa,cc,Dc,function(Zc){rb(Zc,M,Dc,Dc.getDefaultDisplayName())}):(this.jWe(M,na,Pa,cc,Dc),rb(!0,M,Dc,Dc.getDefaultDisplayName()))}catch(Zc){Xd.ULS.sendTraceTag(17586257,
220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.Co.TM,Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.ownerAddinStoreType||M.storeType,M.assetId,null,null,M.storeId),M.version,M.storeType,M.storeId,Zc.message)),rb(!1,M,Dc,Dc.getDefaultDisplayName())}else Xd.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",
this.Co.TM,Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.ownerAddinStoreType||M.storeType,M.assetId,null,null,M.storeId),M.version,M.storeType,M.storeId)),rb(!1,M,null,null);else Xd.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.Co.TM,Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.ownerAddinStoreType||M.storeType,M.assetId,null,null,M.storeId),M.version,M.storeType,M.storeId)),
rb(!1,M,null,null)};Ub.prototype.YGb=function(M,na,Pa,rb){var cc=this,Dc={},Zc=document.createElement("div");Zc.setAttribute("visible","false");Dc.div=Zc;Dc.id=M.solutionId;Dc.solutionId=M.solutionId;Dc.version=M.version;Dc.storeType=M.storeType;Dc.storeId=M.storeId;Dc.assetId=M.assetId;Dc.assetStoreId=M.assetStoreId;Dc.isvirtualOsfControl=!0;Dc.virtualOsfControlActivationCallback=function(nd,Id){var Od=cc.EF.Uia(M.storeType,M.solutionId);Od&&(Od.isUpgraded&&(M.isUpgraded=!0),cc.O2b(Od));cc.eHi(M,
na,Pa,rb,nd,Id)};Dc.reason=3===this.Vr?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;return Dc};Ub.prototype.jWe=function(M,na,Pa,rb,cc,Dc){Dc=void 0===Dc?null:Dc;var Zc={};Zc.solutionId=rb.getSolutionId();Zc.version=rb.getVersion();Zc.storeType=rb.getStoreType();Zc.storeId=rb.getStoreId();Zc.assetId=rb.getSolutionId();Zc.assetStoreId=rb.getAssetStoreId();Zc.targetType=rb.getOsfControlType();var nd=null,Id=null;if(Ye.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1))nd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Co.TM,this.Co.formFactor)).parseExtensions(Zc,cc,this.Xga),Id=Nc.YZe(this.Co.TM);else try{nd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Co.TM,this.Co.formFactor)).parseExtensions(Zc,cc,this.Xga),Id=Nc.YZe(this.Co.TM)}catch(Nf){throw Xd.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+Nf.message),Nf;}if(Id&&0<Id.count){if(Ye.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1)){var Od=na(M);var je=Pa(M);Pa=!!Ye.AFrameworkApplication.fa&&Ye.AFrameworkApplication.fa.qa("AddinCommandsMultipleCustomTabsEnabled");Od=new hb(Od,null,je);Id=ik(Id);for(je=Id.next();!je.done;je=Id.next())Od.commandSurface=je.value,nd.apply(Od,this.Xga,Pa)}else try{var Ae=na(M),Re=Pa(M),Ke=!!Ye.AFrameworkApplication.fa&&Ye.AFrameworkApplication.fa.qa("AddinCommandsMultipleCustomTabsEnabled");Od=new hb(Ae,null,Re);var Ef=ik(Id);for(je=Ef.next();!je.done;je=Ef.next())Od.commandSurface=je.value,
nd.apply(Od,this.Xga,Ke)}catch(Nf){throw Xd.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+Nf.message),Nf;}if(OSF.OUtil.checkFlight(14))try{var ff=Od.wcd(M.solutionId,cc.getDefaultDisplayName()),xf=Od.NVe();ff&&this.ribbonManager.AYa(ff,Dc);xf&&this.contextMenuManager.ple(xf);this.EF.Tle(rb,ff,xf,cc.getDefaultDisplayName());Xd.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",cc.getDefaultDisplayName())}catch(Nf){throw OfficeExt.DevConsole.log(Nf),Xd.ULS.sendTraceTag(539870850,
220,10,"Error generating ribbon extensibility. Exception: "+Nf.message),Nf;}else try{var yf=Od.wcd(M.solutionId,cc.getDefaultDisplayName()),Wf=Od.NVe();yf&&this.ribbonManager.AYa(yf);Wf&&this.contextMenuManager.ple(Wf);this.EF.Tle(rb,yf,Wf,cc.getDefaultDisplayName());Xd.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",cc.getDefaultDisplayName())}catch(Nf){throw Xd.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+Nf.message),Nf;}}};Ub.prototype.kWe=function(M,
na,Pa,rb,cc,Dc){Dc=void 0===Dc?null:Dc;var Zc={};Zc.solutionId=M.solutionId;Zc.version=M.version;Zc.storeType=M.storeType;Zc.storeId=M.assetStoreId;Zc.assetId=M.assetId;Zc.assetStoreId=M.assetStoreId;Zc.targetType=M.targetType;var nd=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.Co.TM,this.Co.formFactor);try{var Id=na.getManifest(),Od=nd.parse(Zc,Id,cc,this.Xga,na.getSharedRuntimeId(),na),je=Pa(M),Ae=rb(M),Re=new hb(je,null,Ae);Re.commandSurface="PrimaryCommandSurface";Od.apply(Re,this.Xga,
!0);if(Re.ribbonBuilder.Fs&&0<Re.ribbonBuilder.Fs.count){var Ke=Re.wcd(M.solutionId,na.getManifest().getDefaultDisplayName(),1);Ye.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",!1)?this.ribbonManager.AYa(Ke,Dc):Ke&&this.ribbonManager.AYa(Ke,Dc);this.EF.bDg(na,Ke,cc,na.getManifest().getDefaultDisplayName());Xd.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",na.getManifest().getDefaultDisplayName())}}catch(Ef){Xd.ULS.sendTraceTag(592290768,
220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",na.getManifest().getDefaultDisplayName(),Ef.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(Ef)}};Ub.prototype.O2b=function(M){M.uo&&this.ribbonManager.XId(M.uo);M.mrb&&this.contextMenuManager.Aaj(M.mrb);this.EF.iaj(M.rB.getStoreType(),M.rB.getSolutionId())};Ub.prototype.$Yg=function(M,na){na=hc(na);for(var Pa=ik(this.EF.O5a),rb=Pa.next();!rb.done;rb=Pa.next())if(rb=rb.value,rb.rB.getStoreType()===na){for(var cc=
!0,Dc=ik(M),Zc=Dc.next();!Zc.done;Zc=Dc.next())if((Zc=Zc.value)&&rb.Lgf(Zc.storeType,Zc.solutionId)){cc=!1;break}cc&&(this.O2b(rb),rb.rB.purge(!1))}};Ub.prototype.egg=function(M){return!!M&&!!M.solutionId&&!!M.version&&!!M.storeType&&!!M.storeId};Object(Dd.a)(Ub,"AddInCommandsIntegration",null,[]);Oa.prototype.YEg=function(M){this.$a.addHandler(hf.a.Koe,M)};Oa.prototype.OGg=function(M){this.$a.addHandler(hf.a.Usd,M)};Oa.prototype.pIg=function(M){this.$a.addHandler(hf.a.w3f,M)};Oa.prototype.dFg=function(M){this.$a.addHandler(hf.a.KXc,
M)};Oa.prototype.Gsi=function(M,na,Pa){var rb=this,cc=Pa[hf.a.Rnb],Dc=void 0===Pa[hf.a.rP]?0:Pa[hf.a.rP];if(cc&&0!==Dc)if(0>=cc.count&&4!==Dc)this.WHf(new zb(Dc,null,null,na,null,!0));else{var Zc=cc.count,nd=new Fb(new Be),Id=void 0===Pa[hf.a.V9]?-1:Pa[hf.a.V9],Od=new Ub(Dc,this.Jm,this.LEc,nd,this.Mng,this.oXa,this.WQb),je=function(ff){return rb.Cie.pSg(ff.solutionId,rb.WQb,rb.LEc,M)},Ae=function(ff){return rb.Cie.ARg(ff.solutionId)},Re=function(ff,xf,yf){Zc--;yf=new zb(Dc,xf,nd,na,yf,0>=Zc);if(ff&&
xf)rb.WHf(yf);else{if(3===Dc||xf&&xf.isUpgraded)ff="",xf&&(ff=Telemetry.PrivacyRules.GetPrivacyCompliantId(xf.solutionId,xf.ownerAddinStoreType||xf.storeType,xf.assetId,null,null,xf.storeId)),xf={},xf=(xf.SDX_AppInstallOrigin="User",xf.SDX_AppInstallErrorCode="onAddinCompletedBase.fail",xf.SDX_Id=ff,xf),ug.a.sendTelemetryEvent(Object.assign(new vg.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Ag.a.Gk(xf)}));rb.VHf(yf)}Zc||Ye.AFrameworkApplication.ta.updateCommandUI()},Ke=function(ff,xf,
yf,Wf){Re(ff,xf,Wf)},Ef=function(){rb.wyd();0>=cc.count&&4===Dc&&rb.oXa.GOd()};6===Dc?(Id=Pa[hf.a.LIa],Pa=Pa[hf.a.MIa],Od.osi(cc.na(0),Id,Pa,je,Ae,function(ff,xf,yf,Wf){Re(ff,xf,Wf)})):Od.WBb(cc,je,Ae,Id,Ke,Ef,this.iug)}else Od={},Od=(Od.SDX_AppInstallOrigin="User",Od.SDX_AppInstallErrorCode="LaunchOneLineRibbonAddinCommands.fail",Od.SDX_Id="",Od),ug.a.sendTelemetryEvent(Object.assign(new vg.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Ag.a.Gk(Od)})),Xd.ULS.sendTraceTag(24786637,220,
10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.LEc.TM)),this.VHf(new zb(Dc,null,null,na,null,!0))};Oa.prototype.VHf=function(M){this.wyd(M);this.m4f(!1,M)};Oa.prototype.WHf=function(M){var na=M.Qj,Pa=null;null!==na&&(Pa=na.storeType,Pa=Pa.toLowerCase());if(M&&"omex"===Pa&&(3===M.Vr||na.isUpgraded)){var rb={};rb=(rb.SDX_AppInstallOrigin="User",rb.SDX_AppInstallErrorCode="0",rb.SDX_Id=Telemetry.PrivacyRules.GetPrivacyCompliantId(na.solutionId,na.ownerAddinStoreType||
na.storeType,na.assetId,null,null,na.storeId),rb);ug.a.sendTelemetryEvent(Object.assign(new vg.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Ag.a.Gk(rb)}))}this.wyd(M);rb=this.HKc&&rd()&&"omex"===Pa&&!!M.OW&&!!na.solutionId&&na.solutionId.toLowerCase()===md().toLowerCase();if("omex"===Pa&&M.OW&&(3===M.Vr&&"hardcodedpreinstall"!==Pa||na.isUpgraded)||rb)rb=new Md,rb.Qj=na,rb.uo=M.OW.xxa,this.$a.raiseEvent(hf.a.KXc,rb);if(this.Vrg){rb=Cc();var cc=md();rb&&na&&"excatalog"===na.storeType&&
M.OW&&5===M.Vr&&cc&&(na.storeId&&na.storeId.toLowerCase()===cc.toLowerCase()||na.assetId&&na.assetId.toLowerCase()===cc.toLowerCase())&&(rb=new Md,rb.Qj=na,rb.uo=M.OW.xxa,this.$a.raiseEvent(hf.a.KXc,rb),Xd.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event."))}na&&(ib.instance.GYf(qc(Pa),!0),"uploadfiledevcatalog"===Pa&&(rb=this.elg.createAddinDataProvider(Pa,this.Jm))&&rb.localCacheAddinCommands(this.Jm.qma,na.solutionId,na.version,na.storeId),yh.a.efb(hf.a.Tnb,"true",
qc(Pa)));this.m4f(!0,M)};Oa.prototype.m4f=function(M,na){M?Ye.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&na.OW&&5===na.Vr&&na.OW.xxa&&void 0!==na.Qj.showCallout&&null!==na.Qj.showCallout&&na.Qj.showCallout?(Ye.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",!1)?(new fd(this.$a)).rUc(na.Qj,Xh.a.w3a(na.OW.xxa)):(new ob(this.$a,na.Qj,Xh.a.w3a(na.OW.xxa))).rUc(),M=
new Md,M.uo=na.OW.xxa,M.Qj=na.Qj,this.$a.raiseEvent(hf.a.w3f,M)):3!==na.Vr?na.xjf&&this.oXa.GOd():na.OW&&na.OW.xxa&&"hardcodedpreinstall"!==na.Qj.storeType&&fi.a.CAj(na.displayName,na.OW.xxa,na.Qj.isAutoLaunched):3===na.Vr?na.Qj&&"uploadfiledevcatalog"===na.Qj.storeType.toLowerCase()?(na=this.WQb.TOh(na.Qj.solutionId),fi.a.NRd(na?na:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):this.oXa.MZf():na.xjf&&this.oXa.GOd()};Oa.prototype.wyd=function(M){var na=(M=void 0===
M?null:M)?M.Qj:null,Pa=new Md;if(Pa.Qj=na){var rb=this.oXa.Uia(na.storeType,na.solutionId,6===M.Vr?1:0);if(rb&&rb.uo){Pa.uo=rb.uo;var cc=this.HKc?md():null;cc=this.HKc&&rd()&&!!na.solutionId&&!!cc&&na.solutionId.toLowerCase()===cc.toLowerCase();if(3===M.Vr&&"hardcodedpreinstall"!==na.storeType||cc)M="",rb.uo.ZV&&rb.uo.ZV.Fs&&(rb=rb.uo.ZV.Fs.na(0))&&(M=rb.id),rb={},na=(rb.SDX_CommandPlacement=M,rb.SDX_PinningAction="Pinning",rb.SDX_PinningActionErrorCode="0",rb.SDX_Id=Telemetry.PrivacyRules.GetPrivacyCompliantId(na.solutionId,
na.ownerAddinStoreType||na.storeType,na.assetId,null,null,na.storeId),rb),ug.a.sendTelemetryEvent(Object.assign(new vg.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Ag.a.Gk(na)}))}}this.$a.raiseEvent(hf.a.Koe,Pa)};Object(Dd.a)(Oa,"LaunchAddinCommandsHandler",null,[348]);wa.AUa="Alt";wa.BUa="Command";wa.id="Id";wa.DUa="Image16by16";wa.GQb="LabelText";wa.EUa="Title";wa.GROUP="Group";wa.L0d="Groups";wa.zgb="Controls";wa.button="Button";wa.Laa="FlyoutAnchor";wa.LARGE="Large";wa.SMALL="Small";
Object(Dd.a)(wa,"AddinDataNodeConstants",null,[]);b(398);b(640);b(634);b(167);of.Object.defineProperties(wb.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id||""}},nU:{configurable:!0,enumerable:!0,get:function(){return this.g4d||(this.g4d={})}},controlType:{configurable:!0,enumerable:!0,get:function(){return this.Sng||""}},menuItems:{configurable:!0,enumerable:!0,get:function(){return this.nEa||(this.nEa=new cf.a)}}});Object(Dd.a)(wb,"ControlDefinition",null,[341]);of.Object.defineProperties(lb.prototype,
{xla:{configurable:!0,enumerable:!0,get:function(){return this.bbe||(this.bbe={})}},id:{configurable:!0,enumerable:!0,get:function(){return this._id||""}}});Object(Dd.a)(lb,"MenuItemDefinition",null,[376]);of.Object.defineProperties(Sb.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}},controls:{configurable:!0,enumerable:!0,get:function(){return this.Epa||(this.Epa=new cf.a)}}});Object(Dd.a)(Sb,"OfficeMenuDefinition",null,[340]);var Gg=b(25);Yb.prototype.addButton=function(M){Xd.ULS.sendTraceTag(17085952,
220,50,"ContextMenu button actiontype: {0}.",M.actionType);this.EI=new wb(this.tsa(M.id),wa.button);this.EI.nU[wa.GQb]=M.label;this.EI.nU[wa.AUa]=M.label;this.EI.nU[wa.DUa]=M.icon["16"];this.jpb(this.EI.nU[wa.id],M.action);this.MFa(this.EI.nU);this.sVa.controls.add(this.EI);this.EI=null};Yb.prototype.startBuildMenu=function(M){if(bh.c(this.sVa))this.sVa=new Sb(M.id);else{var na=this.tsa(M.id);this.EI=new wb(na,wa.Laa);this.i_a(this.EI.nU,M);this.EI.nU[wa.DUa]=M.icon["16"];this.EI.nU[wa.BUa]=Gg.a.alwaysEnabled}};
Yb.prototype.addMenuItem=function(M){Xd.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",M.actionType);var na=new lb(this.tsa(M.id));this.i_a(na.xla,M);M.icon&&(na.xla[wa.DUa]=M.icon["16"]);this.jpb(na.xla[wa.id],M.action);this.MFa(na.xla);this.EI.menuItems.add(na)};Yb.prototype.endBuildMenu=function(){bh.c(this.EI)?(this.ulc.add(this.sVa),this.sVa=null):(this.sVa.controls.add(this.EI),this.EI=null)};Yb.prototype.jpb=function(M,na){this.vTc.bindAction(M,na)};Yb.prototype.MFa=
function(M){this.Nqb.MFa(M)};Yb.prototype.tsa=function(M){return this.$lc.cKa(M)};Yb.prototype.i_a=function(M,na){M[wa.GQb]=na.label;M[wa.AUa]=na.label};of.Object.defineProperties(Yb.prototype,{$lc:{configurable:!0,enumerable:!0,get:function(){return this.RNc}},Nqb:{configurable:!0,enumerable:!0,get:function(){return this.fVa}},vTc:{configurable:!0,enumerable:!0,get:function(){return this.GUa}},ulc:{configurable:!0,enumerable:!0,get:function(){return this.Gtg}}});Object(Dd.a)(Yb,"ContextMenuExtensibilityCreator",
null,[361,357]);Hb.prototype.cKa=function(M){return this.HDb+M};of.Object.defineProperties(Hb.prototype,{HDb:{configurable:!0,enumerable:!0,get:function(){return this.ykb}}});Object(Dd.a)(Hb,"DefaultContextMenuNamingProvider",null,[360]);var cj=b(1528);Wa.prototype.bindAction=function(M,na){OfficeExt.DefaultControlActionBinder.bindAction(M,na)};Object(Dd.a)(Wa,"DefaultUIControlActionBinder",null,[358]);sa.prototype.MFa=function(M){M[wa.BUa]=this.command};of.Object.defineProperties(sa.prototype,{command:{configurable:!0,
enumerable:!0,get:function(){return this.UCa}}});Object(Dd.a)(sa,"DefaultUIControlCommandBinder",null,[359]);var xi=b(32);Object(Dd.a)(Na,"AddInControl",null,[]);Object(Dd.a)(nb,"AddInGroup",null,[]);Object(Dd.a)(jb,"AddInMenuItem",null,[]);Object(Dd.a)(Ia,"AddInTab",null,[]);ca.prototype.startBuildTab=function(M){var na=M.isOfficeTab?M.id:this.$lc.c3e(M.id),Pa=M.isOfficeTab?null:M.label;this.tVa=Object.assign(new Ia,{id:na,title:Pa,isOfficeTab:M.isOfficeTab,visible:M.visible,groups:[],tabType:M.tabType,
insertBefore:M.insertBefore,insertAfter:M.insertAfter,autoFocus:M.autoFocus})};ca.prototype.startBuildGroup=function(M){var na=this.tsa(M.id);this.ifa=Object.assign(new nb,{id:na,mlrId:M.mlrId,title:M.label,controls:[],groupType:0})};ca.prototype.addNativeGroup=function(M){this.ifa=Object.assign(new nb,{id:M.id,mlrId:M.mlrId,title:M.label,controls:[],groupType:1});this.tVa.groups.push(this.ifa)};ca.prototype.addButton=function(M){var na=this.tsa(M.id);na&&(this.jpb(na,M.action),Xd.ULS.sendTraceTag(24786640,
220,50,"AddInDataTransferObject button actiontype: {0}.",M.actionType),M=Object.assign(new Na,{id:na,title:M.label,iconLocation:this.Ned(M),enabled:M.enabled,controlType:0,attributes:this.i_a()}),this.g6d.dle(new xi.a(na,this.Nqb.command.toString())),this.ifa.controls.push(M))};ca.prototype.addNativeControl=function(M){M.id&&(Xd.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",M.actionType),M=Object.assign(new Na,{id:M.id,title:"",iconLocation:"",enabled:M.enabled,
controlType:2,attributes:this.i_a()}),this.ifa.controls.push(M))};ca.prototype.startBuildMenu=function(M){var na=this.tsa(M.id);na&&(this.Phb=Object.assign(new Na,{id:na,title:M.label,iconLocation:this.Ned(M),controlType:1,attributes:{},menuItems:[]}))};ca.prototype.addMenuItem=function(M){var na=this.tsa(M.id);na&&(this.jpb(na,M.action),Xd.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",M.actionType),M=Object.assign(new jb,{id:na,title:M.label,iconLocation:this.Ned(M),
enabled:M.enabled,attributes:this.i_a()}),this.g6d.dle(new xi.a(na,this.Nqb.command.toString())),this.Phb.menuItems.push(M))};ca.prototype.endBuildMenu=function(){bh.c(this.Phb.id)||this.ifa.controls.push(this.Phb);this.Phb=null};ca.prototype.endBuildGroup=function(){bh.c(this.ifa.id)||this.tVa.groups.push(this.ifa);this.ifa=null};ca.prototype.endBuildTab=function(){bh.c(this.tVa.id)||this.TQb.add(this.tVa);this.tVa=null};ca.prototype.i_a=function(){var M={};this.MFa(M);return M};ca.prototype.Ned=
function(M){return M.icon["80"]?M.icon["80"]:M.icon["32"]};ca.prototype.MFa=function(M){this.Nqb.MFa(M)};ca.prototype.tsa=function(M){return this.$lc.cKa(M)};ca.prototype.jpb=function(M,na){this.vTc.bindAction(M,na)};of.Object.defineProperties(ca.prototype,{$lc:{configurable:!0,enumerable:!0,get:function(){return this.RNc}},Fs:{configurable:!0,enumerable:!0,get:function(){return this.TQb}},vTc:{configurable:!0,enumerable:!0,get:function(){return this.GUa}},Nqb:{configurable:!0,enumerable:!0,get:function(){return this.fVa}}});
Object(Dd.a)(ca,"OneLineRibbonExtensibilityCreator",null,[356,357]);ka.prototype.ARg=function(M){M=new Hb(M);return new Yb(M,this.fVa,this.GUa)};ka.prototype.pSg=function(M,na,Pa,rb){Pa=new cj.a(this.ykb,M,Pa,!0);return new ca(Pa,this.GUa,this.fVa,M,na,rb)};Object(Dd.a)(ka,"UIExtensibilityFactory",null,[328]);var Vh=b(91),dj=b(1082),yi=b(22),dg=b(37),ch=b(76),Mg=b(50);la.GetPrivacyCompliantId=function(M){return Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.storeType,M.assetId,null,null,
M.storeId)};la.CUa=function(M){return Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.storeType,M.assetId,null,null,M.storeId)};la.prototype.D$i=function(M){this.jC=M;window.addEventListener&&(window.addEventListener("LaunchContentAddin",this.gPi,!0),window.addEventListener("DismissCallout",this.rKi,!0),window.addEventListener("CloseCallout",this.WIi,!0))};la.prototype.Yfd=function(M){return"[id="+M+"]"};la.prototype.O4f=function(M,na){var Pa=this;na>this.XIg?(window.clearTimeout(this.tPf),
this.N4f("[data-unique-id='pivotOverflowButton']"),Xd.ULS.sendTraceTag(537170692,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+M)?this.N4f(M):this.tPf=window.setTimeout(function(){Pa.O4f(M,na+1)},1E3)};la.prototype.M4f=function(M){var na=document.querySelector("button[data-unique-id='RightPaddle']");if(na)M={},M=(M.AppTeachingUICalloutAction="RightPaddlePresent",M["SDX.Id"]=la.GetPrivacyCompliantId(this.Qj),M.AppTeachingUICalloutGoal="NewAdminDeployment",
M["SDX.AppInstallOrigin"]="Organization",M),ug.a.sendTelemetryEvent(Object(Tg.a)(new vg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ag.a.Gk(M)}));else if(na=document.querySelector("button"+M),!na||"none"===window.getComputedStyle(na).display)if(na=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!na){na={};na=(na.AppTeachingUICalloutAction="NoAnchor",na["SDX.Id"]=la.GetPrivacyCompliantId(this.Qj),na.AppTeachingUICalloutGoal="NewAdminDeployment",na["SDX.AppInstallOrigin"]=
"Organization",na);ug.a.sendTelemetryEvent(Object(Tg.a)(new vg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ag.a.Gk(na)}));Xd.ULS.sendTraceTag(537170691,220,15,"ShowTeachingCallout failed to get an anchorElement");this.V5();return}this.pag(na,"ShowTeachingUIForAddinButton")};la.prototype.N4f=function(M){M=document.querySelector("button"+M);if(!M&&(M=document.querySelector("button[data-unique-id='pivotOverflowButton']"),!M)){M={};M=(M.AppTeachingUICalloutAction="NoAnchor",M["SDX.Id"]=
la.GetPrivacyCompliantId(this.Qj),M.AppTeachingUICalloutGoal="NewAdminDeployment",M["SDX.AppInstallOrigin"]="Organization",M);ug.a.sendTelemetryEvent(Object(Tg.a)(new vg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ag.a.Gk(M)}));Xd.ULS.sendTraceTag(537170690,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.V5();return}this.pag(M,"ShowTeachingUIForAddinTab")};la.prototype.pag=function(M,na){M.setAttribute("lpp-id","latestAddin");var Pa=Xg.a.instance.Tb("Common.ISystemInitiatedFeedback");
Pa&&M?(Pa.execute(function(rb){rb.logActivity(na,null)}),M={},M=(M.AppTeachingUICalloutAction="Show",M["SDX.Id"]=la.GetPrivacyCompliantId(this.Qj),M.AppTeachingUICalloutGoal="NewAdminDeployment",M["SDX.AppInstallOrigin"]="Organization",M),ug.a.sendTelemetryEvent(Object(Tg.a)(new vg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ag.a.Gk(M)})),Xd.ULS.sendTraceTag(537170688,220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):(Xd.ULS.sendTraceTag(537170689,220,15,"ShowTeachingCalloutToAddinTab failed to get a sifFuture"),
M={},M=(M.AppTeachingUICalloutAction="NoSifFutureObject",M["SDX.Id"]=la.GetPrivacyCompliantId(this.Qj),M.AppTeachingUICalloutGoal="NewAdminDeployment",M["SDX.AppInstallOrigin"]="Organization",M),ug.a.sendTelemetryEvent(Object(Tg.a)(new vg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ag.a.Gk(M)})),this.V5())};la.prototype.OIh=function(M){if(!M)return null;M=M.ZV;if((null===M||void 0===M?0:M.Fs)&&0<M.Fs.count){M=ik(M.Fs);for(var na=M.next();!na.done;na=M.next())if(na=na.value,
na.groups&&0<na.groups.length){na=ik(na.groups);for(var Pa=na.next();!Pa.done;Pa=na.next())if(Pa=Pa.value,Pa.controls&&0<Pa.controls.length){Pa=ik(Pa.controls);for(var rb=Pa.next();!rb.done;rb=Pa.next()){rb=rb.value;if(rb.attributes&&0===rb.controlType&&rb.enabled)return rb.id;if(rb.menuItems)for(var cc=ik(rb.menuItems),Dc=cc.next();!Dc.done;Dc=cc.next())if(Dc=Dc.value,Dc.attributes&&Dc.enabled)return rb.id}}}}return null};la.prototype.ZCj=function(){var M=document.querySelector("button[data-unique-id = 'Ribbon-InsertAppsForOffice']");
if(M&&"none"!==window.getComputedStyle(M).display)Xd.ULS.sendTraceTag(527286666,220,15,"Callout show on OfficeAddin Button");else{M=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']");if(null==M){M={};M=(M.AppTeachingUICalloutAction="NoAnchor",M["SDX.Id"]=la.CUa(this.jC),M.AppTeachingUICalloutGoal="NewAdminDeployment",M["SDX.AppInstallOrigin"]="Organization",M);ug.a.sendTelemetryEvent(Object(Tg.a)(new vg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:Ag.a.Gk(M)}));Xd.ULS.sendTraceTag(527286668,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");this.V5();return}Xd.ULS.sendTraceTag(527286667,220,15,"Callout show on Overflow button")}var na=Xg.a.instance.Tb("Common.ISystemInitiatedFeedback");null==na||null==M?(M={},M=(M.AppTeachingUICalloutAction="NoSifFutureObject",M["SDX.Id"]=la.CUa(this.jC),M.AppTeachingUICalloutGoal="NewAdminDeployment",M["SDX.AppInstallOrigin"]="Organization",M),ug.a.sendTelemetryEvent(Object(Tg.a)(new vg.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ag.a.Gk(M)})),Xd.ULS.sendTraceTag(527286665,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"),this.V5()):(na.execute(function(Pa){Pa.logActivity("ShowTeachingUIForContentAddin",null)}),M={},M=(M.AppTeachingUICalloutAction="Show",M["SDX.Id"]=la.CUa(this.jC),M.AppTeachingUICalloutGoal="NewAdminDeployment",M["SDX.AppInstallOrigin"]="Organization",M),ug.a.sendTelemetryEvent(Object(Tg.a)(new vg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:Ag.a.Gk(M)})),Xd.ULS.sendTraceTag(527286664,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity"))};la.prototype.v0=function(M){var na={},Pa={};Pa.LastTeachingUIShowTime=(new Date).toUTCString();Pa.AddinHasShown=M;na[this.appName]=Jh.c(Pa);this.Wnb=new Sc(this.appName,null,null,this.kW),this.Wnb.F2a(na),Xd.ULS.sendTraceTag(522981592,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")};la.prototype.V5=function(){if(Ye.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)&&!this.QQa){var M=window.g_roamingAddinList;M&&(this.v0(M),this.QQa=!0)}};Object(Dd.a)(la,"AddinTeachingCalloutHandler",null,[]);var Yh=b(1447),Cj=b(399),Zh=b(11),Mi=b(187),th=b(40),Hg=b(21),Kh=b(58);Ba.prototype.dispose=function(){void 0!==this.Unb&&null!==this.Unb&&(this.Unb.dispose(),this.Unb=null);this.se=this.$=null;this.disposed=!0};Ba.prototype.Xxj=function(M,na){switch(M){case Gg.a.y2:M=this.Ixj(na);break;default:M=!1}return M};Ba.prototype.Nc=function(){return!1};Ba.prototype.executeCommand=
function(M,na,Pa){var rb=this;M=dg.TaskExtensions.kk();na=na.command;switch(na){case 843847158:break;case -2025863019:fi.a.NRd(Pa[hf.a.LVc].toString(),function(){Hg.g(rb.$).focus()});break;case -1777565636:Yh.a.showUILessDialog(Pa[hf.a.Vnb].toString());this.se.RAj(Pa[hf.a.Vnb].toString());break;case 1592314317:Yh.a.hideUILessDialog(Pa[hf.a.Vnb].toString());this.se.s7h(Pa[hf.a.Vnb].toString());break;case Gg.a.y2:M=this.Qhd(Pa);break;case Gg.a.VBb:this.WBb(Pa);break;case Gg.a.ena:this.ena(Pa);break;
case Gg.a.ORd:this.Unb.Yxc();break;case Gg.a.refreshAddinCommands:this.t8i();break;case 1949669462:this.Yga.MZf(!0);break;case -1014260128:M=this.executeDynamicAddInCommandsAPI(Pa);break;default:M=Mi.a(na)}return M};Ba.prototype.Ac=function(M,na){M=!1;switch(na.command){case 843847158:case -2025863019:case -1777565636:case 1592314317:case Gg.a.ena:case Gg.a.ORd:case Gg.a.refreshAddinCommands:case 1949669462:case Gg.a.VBb:case -1014260128:M=!0;break;case Gg.a.y2:M=!Ye.AFrameworkApplication.protectedFile}return M};
Ba.prototype.Tc=function(){return!1};Ba.prototype.DMh=function(M){if(!M)return Xd.ULS.sendTraceTag(528098432,220,10,"Failed to get button id for addin"),null;if((M=M.ZV)&&M.Fs&&0<M.Fs.count){M=ik(M.Fs);for(var na=M.next();!na.done;na=M.next()){na=na.value;if(na.groups&&1===na.groups.length){var Pa=na.groups[0];if(Pa.controls&&1===Pa.controls.length){var rb=Pa.controls[0];if(rb.attributes&&!rb.controlType&&rb.enabled)return rb.id}Pa.controls&&Xd.ULS.sendTraceTag(528098403,220,15,"It has multiple buttons")}na.groups&&
Xd.ULS.sendTraceTag(528098402,220,15,"It has multiple groups")}}return null};Ba.prototype.t8i=function(){if(this.Yga.Ktd()){this.Yga.yye();var M=this.Rcd();if(M&&0<M.count){M=ik(M);for(var na=M.next();!na.done;na=M.next()){var Pa={};na=(Pa[hf.a.V9]=na.value,Pa[hf.a.rP]=4,Pa[hf.a.cGa]=(new Date).getTime(),Pa);this.ena(na)}}}};Ba.prototype.ena=function(M){var na=this;Xd.ULS.sendTraceTag(537170657,220,50,"Launch AddinCommands entitlements list, LaunchOperationType "+M[hf.a.rP]+", DataProvider "+M[hf.a.V9]+
".");this.Yga.dqj();window.setTimeout(function(){if(void 0===na.se||null===na.se)Xd.ULS.sendTraceTag(537170656,220,10,"AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: "+th.a.p3());else{var Pa=new xb(new Mc(na.se.Th),Yc.instance,ib.instance);Pa.XEg(function(rb,cc){na.WBb(cc.properties)});Ye.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&Ye.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5837059_TeachingUIForPrivateCatelogOnContentAddinEnabled")&&
Pa.qIg(function(rb,cc){null==cc?(rb={},rb=(rb.AppTeachingUICalloutAction="InvalidEventArgs",rb.AppTeachingUICalloutGoal="NewAdminDeployment",rb["SDX.AppInstallOrigin"]="Organization",rb),ug.a.sendTelemetryEvent(Object(Tg.a)(new vg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ag.a.Gk(rb)}))):(na.jBa=new la(na),na.jBa.D$i(cc),rb=na.$.Ka,null!=rb&&(rb.Coe(na.oaf),Xd.ULS.sendTraceTag(527286663,220,50,"Register tab switched event")))});Pa.uPj(M)}},0)};Ba.prototype.WBb=function(M){var na=
this;if(!this.disposed){Xd.ULS.sendTraceTag(537170655,220,50,"LaunchOperationType "+M[hf.a.rP]+".");try{if(af.EwaSettings.ma(187)){var Pa=M[hf.a.Rnb];if(Pa&&0<Pa.count){for(var rb=Pa.count,cc=rb-1;0<=cc;cc--){var Dc=Pa.na(cc);OSF.OsfControl.isFirstPartyStoreString(Dc.storeType)||Pa.remove(Pa.na(cc))}if(Pa.count<rb){var Zc=Mg.GetServiceTaskFactory.Ra(this.$.da,5,4,0);dg.TaskExtensions.Aa(Zc,function(){Zc.result.Lf(35,null)},this.$.la,3)}if(!Pa.count)return}}if(void 0===this.se||null===this.se)Xd.ULS.sendTraceTag(537170654,
220,10,"LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: "+th.a.p3());else{var nd=null;nd=Ye.AFrameworkApplication.fa.qa("HostInstallAddInsIsEnabled")?new Oa(this.Co,this.QBe,new Mc(this.se.Th),new ka(this.$.zb,Gg.a.y2),this.Yga,Yc.instance,this.Xga,function(Od,je){var Ae={};Ae.InstanceId=Vj.a.create().toString();Ae.PrimaryMarketplace={};Ae.PrimaryMarketplace.SolutionId=Od.solutionId;Ae.PrimaryMarketplace.SolutionVersion=Od.version;Ae.PrimaryMarketplace.MarketplaceType=
Od.storeType;Ae.PrimaryMarketplace.MarketplaceRef=Od.storeId;Ae.WebExtensionType=1;na.se.eDj(Ae,function(){je(Od)})}):new Oa(this.Co,this.QBe,new Mc(this.se.Th),new ka(this.$.zb,Gg.a.y2),this.Yga,Yc.instance,this.Xga);nd.dFg(this.JHi);nd.YEg(this.fPi);if(Ye.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)){var Id=new la(this);nd.OGg(Id.ePi);nd.pIg(Id.DAj)}this.$.da.za(53).Ql&&Wj.a.get_instance().ak(5,null).continueWith(function(){na.disposed||
nd.Gsi(na.H$c,na.$.domElement,M)})}}catch(Od){Xd.ULS.sendTraceTag(537170653,220,10,"LaunchAddinCommands error message : "+Od.message+".")}}};Ba.prototype.Qhd=function(M){var na=dg.TaskExtensions.kk();M=M[this.Co.$ha];var Pa=this.s_b.ake(M),rb=new Yh.a(this.$,this.se,Pa.ownerAddinInfo,na);return this.Y4e(na,M,Pa,rb)};Ba.prototype.Y4e=function(M,na,Pa,rb){var cc=this;this.s_b.Qhd(na,this.Yga,rb,new Mc(this.se.Th),Pa,function(){M=rb.V2g()},function(){Hg.g(cc.$).focus()});return M};Ba.prototype.uOg=function(M){var na=
this,Pa=dg.TaskExtensions.kk(),rb=this.se.Gaa(M.solutionId);if(rb){var cc=this.se.pZ(rb);if(Zh.HelperMethods.hw(cc)&&0!==cc.SharedRuntime.State)return}cc=this.s_b.vOg;var Dc=M.solutionId in cc?cc[M.solutionId]:null;if(Dc){var Zc=this.s_b.ake(Dc),nd=new Yh.a(this.$,this.se,Zc.ownerAddinInfo,Pa);cc=function(Od){if(Od){var je={};Od=ik(Od);for(var Ae=Od.next();!Ae.done;Ae=Od.next())Ae=Ae.value,je[Ae[0]]=Ae[1];(je=hf.a.Joe in je?je[hf.a.Joe]:null)&&"true"===je.toLowerCase()&&(Xd.ULS.sendTraceTag(537170652,
220,50,"Auto-Show AddinCommands TaskPane, StoreType "+M.storeType+", StoreId "+M.storeId+", SolutionId "+Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,null!==Zc.ownerAddinInfo?Zc.ownerAddinInfo.storeType:M.storeType,M.assetId,null,null,M.storeId)+"."),na.Y4e(Pa,Dc,Zc,nd))}};Xd.ULS.sendTraceTag(537170651,220,50,"Check Auto-Show AddinCommands TaskPane, StoreType "+M.storeType+", StoreId "+M.storeId+", SolutionId "+Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,null!==Zc.ownerAddinInfo?
Zc.ownerAddinInfo.storeType:M.storeType,M.assetId,null,null,M.storeId)+".");if(rb)cc(this.se.pZ(rb).OsfPropertyBag);else if(rb=this.$.ea.workbookContext.WebExtensions){rb=ik(rb);for(var Id=rb.next();!Id.done;Id=rb.next())if(Id=Id.value,(1===Id.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent)===M.targetType&&Id.PrimaryMarketplace.MarketplaceType.toLowerCase()===M.storeType.toLowerCase()&&Id.PrimaryMarketplace.MarketplaceRef.toLowerCase()===M.storeId.toLowerCase()&&Id.PrimaryMarketplace.SolutionId.toLowerCase()===
M.solutionId.toLowerCase()){cc(Id.OsfPropertyBag);break}}}};Ba.prototype.cVd=function(M,na,Pa){M&&(void 0===Pa||!Pa||na||this.K5c.contains(M)||this.K5c.add(M),(Pa=this.G1a.contains(M))&&na&&this.G1a.remove(M),Pa||na||this.G1a.add(M))};Ba.prototype.Ntj=function(M){if((M=M.ZV)&&M.Fs){M=ik(M.Fs);for(var na=M.next();!na.done;na=M.next())if(na=na.value,na.groups){na=ik(na.groups);for(var Pa=na.next();!Pa.done;Pa=na.next())if(Pa=Pa.value,Pa.controls){Pa=ik(Pa.controls);for(var rb=Pa.next();!rb.done;rb=
Pa.next())if(rb=rb.value,this.cVd(rb.id,rb.enabled,!0),1===rb.controlType&&rb.menuItems){rb=ik(rb.menuItems);for(var cc=rb.next();!cc.done;cc=rb.next())cc=cc.value,this.cVd(cc.id,cc.enabled,!0)}}}}};Ba.prototype.Rcd=function(){var M=new cf.a;af.EwaSettings.ma(54)&&(this.$.ea.Tg.get(27)&&(M.add(0),M.add(16)),this.$.ea.Tg.get(33)&&M.add(1),M.add(8));return M};Ba.prototype.executeDynamicAddInCommandsAPI=function(M){var na=!0;if(void 0===M||null===M||void 0===M[hf.a.dtb]||null===M[hf.a.dtb])return Kh.Task.Ua(!1);
switch(M[hf.a.dtb]){case 1:na=this.xSj(M);break;case 2:na=this.Rtj(M);break;case 4:this.G1a.clear();this.G1a.addRange(this.K5c);break;case 3:na=this.installContextualTab(M);break;default:na=!1}return Kh.Task.Ua(na)};Ba.prototype.Ixj=function(M){return M&&this.Co.$ha in M?(M=M[this.Co.$ha])?this.G1a.contains(M):!1:!1};Ba.prototype.xSj=function(M){var na=null,Pa=null,rb=null,cc=!0;void 0!==M[hf.a.S3]&&null!==M[hf.a.S3]&&void 0!==M[this.Co.$ha]&&null!==M[this.Co.$ha]&&void 0!==M[hf.a.R3]&&null!==M[hf.a.R3]&&
(na=M[hf.a.S3],Pa=M[hf.a.R7b],rb=M[this.Co.$ha],cc=M[hf.a.R3]);if(!na||!rb)return Xd.ULS.sendTraceTag(537170649,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),!1;M=(new cj.a(this.$.zb,na,this.Co,!0)).cKa(rb);na={DynamicAddinCommandsApiName:"UpdateControlEnableState"};na.AssetId=Pa;na.MaskedTabId=M;na.IsToEnable=cc;Xd.ULS.sendTraceTag(537170648,220,50,sf.a.xc(na));this.cVd(M,cc);Cj.a.pA.updateCommandUI();return!0};Ba.prototype.Rtj=function(M){var na,Pa,rb=null,cc=null,Dc=
null,Zc=null,nd=!0;void 0!==M[hf.a.q7c]&&null!==M[hf.a.q7c]&&void 0!==M[hf.a.S3]&&null!==M[hf.a.S3]&&void 0!==M[this.Co.$ha]&&null!==M[this.Co.$ha]&&void 0!==M[hf.a.R3]&&null!==M[hf.a.R3]&&(rb=M[hf.a.q7c],cc=M[hf.a.S3],Dc=M[hf.a.R7b],Zc=M[this.Co.$ha],nd=M[hf.a.R3]);if(!rb||!cc||!Zc)return Xd.ULS.sendTraceTag(537170647,220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),!1;M=(new cj.a(this.$.zb,cc,this.Co,!0)).c3e(Zc);Zc={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};
Zc.StoreType=rb;Zc.AssetId=Dc;Zc.MaskedTabId=M;Zc.IsToShow=nd;Xd.ULS.sendTraceTag(537170646,220,15,sf.a.xc(Zc));cc=this.Yga.Uia(rb,cc,1);rb=!1;if(null===(Pa=null===(na=null===cc||void 0===cc?void 0:cc.uo)||void 0===na?void 0:na.ZV)||void 0===Pa?0:Pa.Fs)for(na=ik(cc.uo.ZV.Fs),Pa=na.next();!Pa.done;Pa=na.next())if(Pa.value.id===M){rb=!0;break}if(!rb)return Xd.ULS.sendTraceTag(537170645,220,15,"SetRibbonTabVisible failed to get contextual tabs"),!1;na=[];nd?appChrome.selectors.getSelectedTabId()!==M&&
na.push(appChrome.actions.activateRibbonTab(M)):(appChrome.selectors.getSelectedTabId()===M&&na.push(appChrome.actions.setCurrentTab(qh.a.uW)),na.push(appChrome.actions.deactivateRibbonTab(M)));appChrome.api.dispatch(na);return!0};Ba.prototype.installContextualTab=function(M){var na=null,Pa=null,rb=null,cc=null;if(void 0!==M[hf.a.S3]&&null!==M[hf.a.S3]&&void 0!==M[hf.a.R3]&&null!==M[hf.a.R3]){var Dc=M[hf.a.R3];na=M[hf.a.S3];void 0!==Dc[hf.a.LIa]&&null!==Dc[hf.a.LIa]&&void 0!==Dc[hf.a.MIa]&&null!==
Dc[hf.a.MIa]&&(Pa=Dc[hf.a.LIa],rb=Dc[hf.a.MIa],cc=Dc[hf.a.r7c])}if(!(na&&rb&&Pa&&cc))return Xd.ULS.sendTraceTag(537170644,220,15,"InstallContextualTab failed to invalid parameters"),!1;M=this.Yga.Uia(cc.PrimaryMarketplace.MarketplaceType,cc.PrimaryMarketplace.SolutionId,1);if(null===M||void 0===M?0:M.uo)return Xd.ULS.sendTraceTag(537170643,220,15,"InstallContextualTab was called multiple times"),!1;M={};M.solutionId=cc.PrimaryMarketplace.SolutionId;M.version=cc.PrimaryMarketplace.SolutionVersion;
M.storeType=cc.PrimaryMarketplace.MarketplaceType;M.storeId=cc.PrimaryMarketplace.MarketplaceRef;M.assetId=cc.PrimaryMarketplace.SolutionId;M.assetStoreId=cc.PrimaryMarketplace.MarketplaceRef;M.targetType=cc.WebExtensionOsfControlType;M.width=cc.TaskpaneWidth;M.height=0;M.isAddinCommands=!0;cc=new cf.a;cc.add(M);M={};M[hf.a.Rnb]=cc;M[hf.a.rP]=6;M[hf.a.LIa]=Pa;M[hf.a.MIa]=rb;this.WBb(M);return!0};Object(Dd.a)(Ba,"AddinUICommandHandler",null,[870,401,6]);var Xj=b(66),ej=b(705),Yj=b(18),Zj=b(17),Dj=
Uh.a;$k($a,Dj);$a.prototype.zd=function(){var M=this;Xd.ULS.sendTraceTag(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");Xj.a(this.$).add(Object(Tg.a)(new ej.a,{bxc:function(){var na=M.$.ea.dF&&M.$.ea.dc&&!!(M.$.Bd&16384)&&M.$.isEditMode;M.$.ea.dc&&Xd.ULS.sendTraceTag(38410433,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate ["+na+"] IsSessionFullyLoaded ["+M.$.ea.dF+"] IsSessionActive ["+M.$.ea.dc+"] ShowCommandUI ["+!!(M.$.Bd&
16384)+"] IsEditMode ["+M.$.isEditMode+"]");return na},EYb:this.MAg,j6b:this.ldh,L2a:2}))};$a.prototype.g9i=function(M){var na=this,Pa=Mg.GetServiceTaskFactory.create(this.$.da,102,this.la,this.hb);return dg.TaskExtensions.Aa(Pa,function(){Xd.ULS.sendTraceTag(38942483,0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");na.$.da.Ga(204,new jf(Pa.result,M))},this.la,3)};$a.ka=function(M){Uh.a.Pd(199,new $a(M))};Object(Dd.a)($a,"AddinUICommandHandlerFactory",
Uh.a,[]);var $h=b(1402),fj=b(1407),Xf=$e.a;$k(dc,Xf);dc.prototype.create=function(){var M=this,na;if(af.EwaSettings.ma(402)){var Pa=Mg.GetServiceTaskFactory.create(this.$.da,106,this.$.la,this.hb),rb=Mg.GetServiceTaskFactory.create(this.$.da,396,this.$.la,this.hb);dg.TaskExtensions.Aa(Kh.Task.uL(Pa,rb),function(){M.pb(M.$.da.za(278)||new $h.CustomFunctionsInstaller(M.$,Pa.result,rb.result))},this.$.la,3)}else(na=this.$.da.za(278))||(na=this.$.da.Ga(278,new fj.CustomFunctionsLegacyInstaller(this.$))),
this.pb(na)};dc.ka=function(M){M.da.Ga(279,new dc(M))};Object(Dd.a)(dc,"CustomFunctionsInstallerFactory",$e.a,[]);var gj=b(87),ak=b(47),Ej=b(45);Jb.prototype.ka=function(M){this.zXc?Xd.ULS.sendTraceTag(537170629,0,10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):(this.zXc=!0,this.UPa={},this.VPa={},M?M.HFg(this.sag):Xd.ULS.sendTraceTag(537170628,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))};Jb.prototype.detach=function(M){if(M){M.kcj(this.sag);
M=this.UPa;for(var na in M)gj.a.Ia(M[na]);this.VPa=this.UPa=null;this.zXc=!1}else Xd.ULS.sendTraceTag(537170627,0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")};Jb.prototype.WMf=function(M,na,Pa){if(this.Ffi(Pa,M))return!1;M=na.querySelector("iframe");if(!M)return Xd.ULS.sendTraceTag(537170595,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;M=M.title;if(!M||!M.length)return Xd.ULS.sendTraceTag(537170594,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),
!0;this.ariaLiveNotifier.readText(M);return!0};Jb.prototype.Ffi=function(M,na){return(M=M.Th.getOsfControl(na))?M.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0};Object(Dd.a)(Jb,"AgaveOnSelectedReadoutHandler",null,[841]);var hj=$e.a;$k(oc,hj);oc.prototype.create=function(){var M=this,na=this.$.da;dg.TaskExtensions.Aa(Mg.GetServiceTaskFactory.Ra(na,211,212,this.hb),function(Pa){Pa=na.za(224)||new Jb(Pa.result,M.$);M.pb(Pa)},this.la,3)};oc.ka=function(M){M.da.Ga(225,new oc(M))};Object(Dd.a)(oc,
"AgaveOnSelectedReadoutHandlerFactory",$e.a,[]);var dh=b(957),zi=b(53),bk=b(250);eb.prototype.f6e=function(M){try{if(M&&M.rawEvent&&M.rawEvent.origin&&this.iframe&&this.iframe.id){var na=this.mGf(M.rawEvent.origin),Pa=this.mGf(document.domain);if(mg.a.Jk().equals(Pa,na))if(M.rawEvent.source&&M.rawEvent.source.frameElement&&M.rawEvent.source.frameElement.id&&mg.a.Jk().equals(M.rawEvent.source.frameElement.id,this.iframe.id)){na=null;try{na=JSON.parse(M.rawEvent.data)}catch(rb){Xd.ULS.sendTraceTag(39112971,
344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",rb.message)}na?(na.statusCode!==bk.a.QO||void 0!==na.error&&na.error?(Xd.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",na.statusCode,na.error),this.onError()):(Xd.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.onSuccess(na.authorizationCode?na.authorizationCode:
na.signInUrl)),$removeHandler(window,"message",Object(Fg.a)(this,this.f6e,"handleResponse")),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):Xd.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):Xd.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):Xd.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else Xd.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");
else Xd.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else Xd.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(rb){Xd.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",rb.message)}};eb.prototype.mGf=function(M){var na="";try{M&&(na=-1<M.indexOf("//")?M.split("/")[2]:M.split("/")[0])&&(na=na.split(":")[0],na=na.split("?")[0])}catch(Pa){Xd.ULS.sendTraceTag(51451615,
344,10,"Failed to parse host name from url: {0}",Pa.message)}return na};eb.ka=function(M,na,Pa){new eb(M,na,Pa)};Object(Dd.a)(eb,"ResponseHandler",null,[]);var Fj=b(263);Ka.prototype.tryAuthenticate=function(M,na){this.V$a(Ka.erg,function(){M()},na)};Ka.prototype.tryAuthorize=function(M,na){this.V$a(Ka.$lg,M,na)};Ka.prototype.getSignInUrl=function(M,na){this.V$a(Ka.$ge,M,na)};Ka.prototype.signOut=function(M,na){this.V$a(Ka.Axg,M,na)};Ka.prototype.V$a=function(M,na,Pa){var rb=new Fj.QueryStringBuilder("AuthenticationProxyHandler.aspx");
rb.Ei("responseType",M);Ye.AFrameworkApplication.wYa(rb);rb=String.format("{0}{1}&{2}",this.yFa,rb.toString(),Ye.AFrameworkApplication.Yi);var cc=document.createElement("iframe");cc.setAttribute("id","privateCatalogIframe");cc.setAttribute("name","privateCatalogIframe");cc.setAttribute("style","display: none");mg.a.Jk().equals(M,Ka.$ge)||cc.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");eb.ka(cc,na,Pa);cc.setAttribute("src",rb);document.body.appendChild(cc)};
Ka.$lg="authcode";Ka.erg="identitytoken";Ka.$ge="signinurl";Ka.Axg="signout";Object(Dd.a)(Ka,"AuthenticationProxy",null,[]);vb.getUserId="getUserId";vb.getLastStoreUpdate="laststoreupdate";vb.getEntitlement="getEntitlements";vb.getEToken="getEToken";vb.getManifest="getManifest";vb.getAppState="getAppState";vb.getKilledApps="getRemovedAddins";vb.getAppDetails="getAppDetails";vb.removeApps="removeAddin";vb.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";vb.getPrivateCatalogAddIns="getAddIns";
vb.getPrivateCatalogManifests="getAppManifests";vb.isStoreDisabled="isStoreDisabled";Object(Dd.a)(vb,"S2SWebRequestActions",null,[]);var ij=b(649);ub.prototype.getUserId=function(M,na){var Pa=new cf.a;Pa.add(new Uf.a("corr",M));this.ZW(vb.getUserId,Pa,1,na)};ub.prototype.getLastStoreUpdate=function(M,na,Pa){var rb=new cf.a;rb.add(new Uf.a("lc",M));rb.add(new Uf.a("corr",na));this.ZW(vb.getLastStoreUpdate,rb,1,Pa)};ub.prototype.getEntitlement=function(M,na,Pa,rb){M=new cf.a;M.add(new Uf.a("av",na));
M.add(new Uf.a("corr",Pa));this.ZW(vb.getEntitlement,M,1,rb)};ub.prototype.getEToken=function(M,na,Pa,rb,cc,Dc){var Zc=new cf.a;Zc.add(new Uf.a("cmu",M));Zc.add(new Uf.a("cmf",na));Zc.add(new Uf.a("assetid",Pa));Zc.add(new Uf.a("expver",rb));Zc.add(new Uf.a("corr",cc));this.ZW(vb.getEToken,Zc,1,Dc)};ub.prototype.getManifest=function(M,na,Pa,rb){var cc=new cf.a;cc.add(new Uf.a("cmu",M));cc.add(new Uf.a("assetid",na));cc.add(new Uf.a("corr",Pa));this.ZW(vb.getManifest,cc,1,rb)};ub.prototype.getAppState=
function(M,na,Pa){var rb=new cf.a;rb.add(new Uf.a("ma",M));rb.add(new Uf.a("corr",na));this.ZW(vb.getAppState,rb,1,Pa)};ub.prototype.getKilledApps=function(M,na){var Pa=new cf.a;Pa.add(new Uf.a("corr",M));this.ZW(vb.getKilledApps,Pa,1,na)};ub.prototype.getAppDetails=function(M,na,Pa,rb){var cc=new cf.a;cc.add(new Uf.a("cmo",M));cc.add(new Uf.a("corr",Pa));this.sendWithBody(vb.getAppDetails,cc,na,2,rb,!1)};ub.prototype.removeApps=function(M,na,Pa){var rb=new cf.a;rb.add(new Uf.a("corr",na));this.sendWithBody(vb.removeApps,
rb,M,2,Pa,!1)};ub.prototype.getLastPrivateCatalogUpdate=function(M,na,Pa,rb,cc,Dc){var Zc=new cf.a;Zc.add(new Uf.a("catalog","privatecatalog"));Zc.add(new Uf.a("clientCode",M));Zc.add(new Uf.a("clientVersion",na));Zc.add(new Uf.a("corr",cc));M=String.format("authorizationCode={0}&refreshToken={1}",Pa?zh.a.$e(Pa):"",rb?zh.a.$e(rb):"");this.sendWithBody(vb.getLastPrivateCatalogUpdate,Zc,M,2,Dc,!0)};ub.prototype.getPrivateCatalogAddIns=function(M,na,Pa,rb,cc,Dc){var Zc=new cf.a;Zc.add(new Uf.a("catalog",
"privatecatalog"));Zc.add(new Uf.a("clientCode",M));Zc.add(new Uf.a("clientVersion",na));Zc.add(new Uf.a("corr",cc));M=String.format("authorizationCode={0}&refreshToken={1}",Pa?zh.a.$e(Pa):"",rb?zh.a.$e(rb):"");this.sendWithBody(vb.getPrivateCatalogAddIns,Zc,M,2,Dc,!0)};ub.prototype.getPrivateCatalogManifests=function(M,na,Pa,rb,cc){var Dc=new cf.a;Dc.add(new Uf.a("catalog","privatecatalog"));Dc.add(new Uf.a("corr",rb));M=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",zh.a.$e(M),
na?zh.a.$e(na):"",Pa?zh.a.$e(Pa):"");this.sendWithBody(vb.getPrivateCatalogManifests,Dc,M,2,cc,!0)};ub.prototype.isStoreDisabled=function(M,na){var Pa=new cf.a;Pa.add(new Uf.a("corr",M));this.ZW(vb.isStoreDisabled,Pa,2,na)};ub.prototype.ZW=function(M,na,Pa,rb){this.sendWithBody(M,na,null,Pa,rb,!1)};ub.prototype.sendWithBody=function(M,na,Pa,rb,cc,Dc){var Zc=new Fj.QueryStringBuilder("AddinServiceHandler.ashx");Zc.Ei("action",M);Zc.Ei("app",ij.a[Ye.AFrameworkApplication.ta.Qa.rj]);na=ik(na);for(var nd=
na.next();!nd.done;nd=na.next())nd=nd.value,Zc.Ei(nd.key,nd.value);Zc=String.format("{0}{1}&{2}",Ye.AFrameworkApplication.ta.Qa.TV,Zc.toString(),Ye.AFrameworkApplication.Yi);Ye.AFrameworkApplication.nd.Zl(Zc,rb,Pa,null,!1,2,function(Id){var Od=null,je=null;Id&&Id.data&&(Id.data.responseHeaders["X-BlockedForMinor"]&&"1"===Id.data.responseHeaders["X-BlockedForMinor"].toString()&&(Id.data.httpStatus=451),Od=Id.data.Rd,je=Id.data.responseHeaders);cc(Id.data.httpStatus,Od,je)},function(Id){var Od=null,
je=null;Dc&&Id&&Id.data&&Id.data.Rd&&(Od=Id.data.Rd,je=Id.data.responseHeaders);cc(Id.data.httpStatus,Od,je);if(Ye.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){Od={message:"AddinServiceHandler request failed"};Od.code=Id.data.httpStatus;Od.action=M;if(Id.data.request||Id.data.request.get_headers())Od["X-UserSessionId"]=Id.data.request.get_headers()["X-UserSessionId"];408===Id.data.httpStatus||503===Id.data.httpStatus?Xd.ULS.sendTraceTag(538784582,
220,10,JSON.stringify(Od)):Xd.ULS.sendTraceTag(18392345,220,50,JSON.stringify(Od))}else Xd.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",Id.data.httpStatus)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+M,void 0,void 0,void 0,void 0,["X-UserKey"])};Object(Dd.a)(ub,"S2SWebRequestManager",null,[]);var jj=$e.a;$k(Wb,jj);Wb.prototype.create=function(){var M=this;Xd.ULS.sendTraceTag(537170507,0,50,"DdaFacadeServiceFactory:Create.");Ye.AFrameworkApplication.disableWholeAppsForOfficeFeature?
Xd.ULS.sendTraceTag(537170506,0,50,"DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature ["+Ye.AFrameworkApplication.disableWholeAppsForOfficeFeature+"]"):af.EwaSettings.ma(406)?Xg.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(na){na.isFeatureEnabled("mso_officeStore",!0).then(function(Pa){dh.DdaFacade.E2c=Pa;M.ZDe();return null})}):this.ZDe()};Wb.prototype.ZDe=function(){var M=this,na=Mg.GetServiceTaskFactory.Ra(this.$.da,
224,225,this.hb),Pa=zi.a.Gtd(63,function(){return!(void 0===window.OSF||null===window.OSF)},this.$.ya.MaxRetriesForLoadingScript,this.$.la,this.hb,106),rb=yb(this.la,this.hb);dg.TaskExtensions.Aa(dg.TaskExtensions.Vd([na,Pa,rb],this.$.la),function(){"undefined"===typeof OfficeExt||"undefined"===typeof OSF?Xd.ULS.sendTraceTag(537170505,0,15,"DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: "+th.a.p3()):M.W$h();Xd.ULS.sendTraceTag(537170504,
0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");M.VMf=na.result;M.pb(M.se);Xd.ULS.sendTraceTag(537170503,0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.la,3)};Wb.prototype.W$h=function(){af.EwaSettings.ma(65)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new ub);this.$.pe.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new ub,new Ka(Ye.AFrameworkApplication.fa.appSettings.WebServiceBase),af.EwaSettings.ma(72),af.EwaSettings.ma(433));OfficeExt.MosRequestHandler.init&&
OfficeExt.MosRequestHandler.init(new ub)};Wb.prototype.dispose=function(){gj.a.Ia(this.ddaFacade);this.$=this.ddaFacade=null;jj.prototype.dispose.call(this)};Wb.ka=function(M){new Wb(M)};of.Object.defineProperties(Wb.prototype,{se:{configurable:!0,enumerable:!0,get:function(){return this.ddaFacade||(this.ddaFacade=new dh.DdaFacade(this.$,this.VMf))}}});Object(Dd.a)(Wb,"DdaFacadeServiceFactory",$e.a,[]);var pi=b(500);Ab.prototype.Tc=function(){return!1};Ab.prototype.Nc=function(){return!1};Ab.prototype.Ac=
function(M,na,Pa,rb){var cc=!1;switch(na.command){case -684355545:cc=!0;break;case -741808261:cc=!!Pa;break;case -859308420:cc=!!rb&&1===rb.Ry;break;case 418618014:cc=1===M&&!!rb&&1===rb.Ry;break;case -515602470:na=af.EwaSettings.ma(235)&&2===M;cc=(1===M||na)&&!!rb&&1===rb.Ry;break;case 2086613372:cc=af.EwaSettings.ma(235)&&2===M&&!!rb&&1===rb.Ry;break;case -1336341324:cc=af.EwaSettings.ma(481)&&1===M&&!!rb&&1===rb.Ry;break;case 451940422:cc=af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AnalyzeDataInAutoFilter",
!1)&&1===M&&!!rb&&1===rb.Ry;break;case -1444574190:case -336193495:cc=1===M&&!!rb&&1===rb.Ry;break;case 1296389134:cc=1===M&&!!rb&&1===rb.Ry;break;case -1473679467:cc=af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&1===M&&!!rb&&1===rb.Ry;break;case 1221897806:cc=af.EwaSettings.ma(167)&&2===M;break;case 1172793074:case 1930653487:cc=af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&2===M;break;case -1753056834:cc=
af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",!1);break;case 932597253:cc=!0;break;case 301511274:cc=af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationPaneWeb",!1);break;case 515196233:cc=af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",!1)&&this.$.isEditMode;break;case 1723441034:cc=this.$.isEditMode&&this.$.ea.NLb}return cc};Ab.prototype.executeCommand=function(M,na,Pa){var rb=dg.TaskExtensions.kk(),
cc=na.command;switch(na.command){case -1473679467:pi.a(this.$,488,489,1,function(Dc){rb=Dc.Xci(Pa.SourceControlId,na)});break;case 1296389134:this.agaveCommandManager.aGj(Pa.SourceControlId,Pa.LabelText);break;case -684355545:this.agaveCommandManager.VZc();break;case -741808261:rb=this.agaveCommandManager.insertAgave(Pa,na);pi.a(this.$,488,489,1,function(Dc){Dc.lBg(Pa)});break;case -1336341324:af.EwaSettings.ma(481)&&(rb=this.agaveCommandManager.did(Pa,M,na));break;case 1172793074:af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",
!1)&&(rb=this.agaveCommandManager.did(Pa,M,na));break;case -859308420:case -515602470:case 2086613372:case -336193495:case -1444574190:case 451940422:case 418618014:case 1221897806:case 1930653487:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:rb=this.agaveCommandManager.did(Pa,M,na);break;default:rb=Mi.a(cc)}return rb};Object(Dd.a)(Ab,"AgaveCommandHandler",null,[401]);Object(Dd.a)(Db,"Selection",null,[]);var Ai=b(1515),kj=b(1514),Gj=b(1516),lh=b(1604),ii=b(1517);Object(Dd.a)(Sa,
"SmartLookupApplicationInterface",null,[]);Object(Dd.a)(cb,"ApplicationProperties",null,[]);Object(Dd.a)(pb,"EnterpriseUserInfo",null,[]);Object(Dd.a)(Ra,"FeatureGates",null,[]);La.prototype.PYh=function(){var M=void 0===M?!0:M;var na=this.lGe();if(na<this.fvd+this.fMj)return na>this.fvd+this.iMj&&this.Ocd(),this.Pnf;M&&this.Ocd();return""};La.prototype.Ocd=function(){var M=this;this.ivd=this.ivd||new Promise(function(na){M.QYh().then(function(Pa){M.Pnf=Pa;M.fvd=M.lGe();M.ivd=null;na(Pa)})})};La.prototype.QYh=
function(){var M=this;return this.H8a&&this.H8a.length?new Promise(function(na){M.Rxa.EO("SmartLookup",M.H8a).then(function(Pa){Pa.IsSuccess?Pa.Token||(na(""),Xd.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):(Xd.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+Pa.ErrorCode+": "+Pa.ErrorMessage),na(""));na(Pa.Token)}).catch(function(Pa){Pa=Jh.c(Pa);Xd.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+
Pa);na("")})}):(Xd.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))};Object(Dd.a)(La,"SmartLookupAuthenticationManager",null,[82]);V.NOh=function(){switch(Object(cg.a)(String,Ye.AFrameworkApplication.Ob.AudienceGroup)||""){case "Dogfood":if(Ye.AFrameworkApplication.fa){var M=Ye.AFrameworkApplication.fa.Wa("UserPrincipalName");M=zh.a.cl(M);var na=Ye.AFrameworkApplication.fa.Zn("SmartLookupINTEnabledForSKITeam")?Ye.AFrameworkApplication.fa.fw("SmartLookupINTEnabledForSKITeam"):
[];return 0<=Array.indexOf(na,M)?"INT":"EDOG"}return"EDOG";default:return"PROD"}};V.mYh=function(){switch(Ye.AFrameworkApplication.fa.qa("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":Ye.AFrameworkApplication.fa.qa("IntentSvcEnableProdSourceLocationOverride")?"PROD":Ye.AFrameworkApplication.fa.qa("IntentSvcEnableIntSourceLocationOverride")?"INT":V.NOh()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";
default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}};Object(Dd.a)(V,"Utils",null,[]);var rh=b(628),Bi=b(178);Aa.prototype.rJh=function(){return Promise.resolve(this.sJh())};Aa.prototype.sJh=function(){var M=new cb;M.anid="";M.applicationVersion=Ye.AFrameworkApplication.buildVersion;M.appCorrelationId=Bi.a.create().toString();M.themePlatform=Aa.sYj;M.lcid=Ye.AFrameworkApplication.lcid;M.launchUtcTime=(new Date).toUTCString();M.featureGates=this.G8a;var na=rh.a.aH(Ye.AFrameworkApplication.lcid);
na=na?na.name:null;M.market=this.$ac(na);M.uiLanguage=na;M.sessionId=Ye.AFrameworkApplication.userSessionId;M.themeId=0;M.parentalControl=Aa.KXi;var Pa=new pb;Pa.CountryCode=this.$ac(na);Pa.ServiceEndpoint=this.H8a;Pa.IsGoLocal=!1;Pa.IsEnabled=this.vof;Pa.IsEnterpriseEnabled=this.vof;Pa.TenantRoot=this.Qyi;M.enterpriseUserInfo=Pa;M.accessToken=this.Kyi.PYh();return M};Aa.prototype.$ac=function(M){M=M.split("-");return M[M.length-1]};of.Object.defineProperties(Aa.prototype,{approvedOriginPattern:{configurable:!0,
enumerable:!0,get:function(){return this.kyi}}});Aa.sYj="web";Aa.KXi="yes";Object(Dd.a)(Aa,"SmartLookupManager",null,[30]);var Ci=ni.a;$k(Ha,Ci);Ha.prototype.Tc=function(){return!1};Ha.prototype.Nc=function(){return!1};Ha.prototype.Ac=function(M,na){M=af.EwaSettings.ma(135);return-983891024===na.command&&M};Ha.prototype.executeCommand=function(M,na){M=dg.TaskExtensions.kk();-983891024===na.command&&this.psi();return M};Ha.prototype.psi=function(){var M=this,na=new Aa(null),Pa={},rb=Hg.g(this.$).Ub(null).originalText;
rb=Object(Tg.a)(new Db,{neighborhood:rb,mentionStart:0,mentionLength:rb?rb.length:0});var cc=Object(Tg.a)(new Sa,{selection:rb,entryPoint:0});na.rJh().then(function(Zc){Zc.applicationName=Ha.appName;Zc.isFirstLaunch=M.isFirstLaunch;Zc.themeId=5;Pa[Ha.smartLookupApplicationInterface]=JSON.stringify(cc);Pa[Ha.$Kg]=JSON.stringify(Zc);M.isFirstLaunch=!1});na=new Ai.a("ExcelOnline","Web","en-Us");rb=new kj.a("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");var Dc=new Gj.a;Dc.optionalProperties[lh.a.Rk]=
qg.a.instance.ga(1797);Dc.optionalProperties[lh.a.taskPaneWidth]=350;Dc.optionalProperties[lh.a.sourceLocationOverrideResourceId]="WAC.PROD.URL";Dc.lq=Pa;ii.a.instance.sNa(rb,"Taskpane","SmartLookupSDXTaskpane",na,Dc)};Ha.$Kg="AppProperties";Ha.appName="Excel";Ha.smartLookupApplicationInterface="SmartLookupApplicationInterface";Object(Dd.a)(Ha,"SmartLookupCommandHandler",ni.a,[401]);var Dh=Uh.a;$k(Ea,Dh);Ea.prototype.zd=function(){var M=this;pi.a(this.$,374,375,this.hb,function(na){M.jd([new Ab(M.$,
null,null,null,null,na),new Ha(M.$)])})};Ea.ka=function(M){Uh.a.Pd(76,new Ea(M))};Object(Dd.a)(Ea,"AgaveCommandHandlerFactory",Uh.a,[]);var Ni=b(1529),ai=b(107);ma.prototype.initialize=function(M){ma.initialized||(this.se=M,this.Ag(),ma.initialized=!0)};ma.prototype.Ag=function(){Ye.AFrameworkApplication.ub.He(Gg.a.Cab,ai.a.frame,this.Cab,96);Ye.AFrameworkApplication.ub.Mb(Gg.a.W8i,ai.a.frame,this.f$i)};of.Object.defineProperties(ma,{instance:{configurable:!0,enumerable:!0,get:function(){ma.Ma||(ma.Ma=
new ma);return ma.Ma}}});ma.Ma=null;ma.initialized=!1;Object(Dd.a)(ma,"AgaveCommandActor",null,[]);var wd=b(1571),be=b(1519),Di=b(113),Ei=b(375),Hj=b(371),Ij=b(1451),Jg=b(19),Jj=b(362);Object(Dd.a)(aa,"FirstPartyAddinTaskpaneOverrides",null,[]);Object(Dd.a)(ta,"IdeasSelectionContext",null,[]);$k(ja,ta);Object(Dd.a)(ja,"IdeasTableSelectionContext",ta,[]);Object(Dd.a)(function(){this.sheetName=null;this.lastRow=this.firstRow=this.lastColumn=this.firstColumn=0},"AutoFilterRange",null,[]);Object(Dd.a)(oa,
"IdeasAutoFilterSource",null,[]);Object(Dd.a)(Ma,"IdeasXLIMTableBoundaries",null,[]);var Kg=b(62),Pg=b(1177),bi=b(64),ck=b(133),ci=b(41),ji=b(572),qi=b(394),Wh=b(177),Bg=b(169),Kj=b(638),Vf=b(298),Oi=b(105),Pi=b(134),Lh=b(51),Qi=b(150),Af=b(184),di=Qi.a;$k(Ua,di);Ua.prototype.bD=function(){di.prototype.bD.call(this);this.np.style.width=this.z2d;this.np.style.height=this.jVa;this.np.style.marginTop=this.URb;this.np.style.padding=this.kVa};Ua.prototype.QPa=function(){this.np.style.width=this.z2d;this.np.style.height=
this.jVa;this.np.style.marginTop=this.URb;this.np.style.padding=this.kVa;this.iDa>Af.a.I$a?(this.Db.style.width=String.format("{0}px",Af.a.I$a),this.Db.style.overflowX="scroll",Ye.AFrameworkApplication.isRtl?this.Db.style.right="0":this.Db.style.left="0"):(this.Db.style.width=String.format("{0}px",this.iDa),this.Db.style.overflowX="hidden");this.Db.offsetHeight>Af.a.H$a||this.Dog+50>Af.a.H$a?(this.Db.style.height=String.format("{0}px",Af.a.H$a),this.Db.style.overflowY="scroll",this.Db.style.top="0",
Ye.AFrameworkApplication.isRtl?this.Db.style.right="0":this.Db.style.left="0",this.aIc||(this.Db.style.marginTop="-48px"),this.np.style.minHeight=String.format("{0}px",this.omg)):(this.Db.style.overflowY="hidden",this.Db.style.top="10%",this.Db.style.height=this.gib);this.M_a()};Ua.prototype.M_a=function(){if(this.Db){var M=this.Db.style.zIndex;this.Db.style.zIndex="-9999";if(this.iDa>Af.a.I$a)Ye.AFrameworkApplication.isRtl?this.Db.style.marginRight="0":this.Db.style.marginLeft="0";else{var na=String.format("{0}px",
Math.floor(-this.Db.offsetWidth/2));Ye.AFrameworkApplication.isRtl?this.Db.style.marginRight=na:this.Db.style.marginLeft=na;Ye.AFrameworkApplication.isRtl?this.Db.style.right="50%":this.Db.style.left="50%"}this.Db.style.zIndex=String(M)}else Xd.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")};Ua.prototype.lO=function(){di.prototype.lO.call(this);var M=document.getElementById(this.di(this.Cog));M.style.width=String.format("{0}px",this.iDa);M.style.height=this.gib};of.Object.defineProperties(Ua.prototype,
{B1a:{configurable:!0,enumerable:!0,get:function(){return this.np}}});Object(Dd.a)(Ua,"AppsForOfficeInsertionDialog",Qi.a,[123]);var uh=b(1178),ih=b(188),vh=b(647),Fi;(function(M){M[M.Valid=2]="Valid";M[M.Invalid=4]="Invalid";M[M.All=6]="All"})(Fi||(Fi={}));Object(Dd.b)("MetadataState",Fi);var Ri=b(359),Si=ni.a;$k(Za,Si);Za.prototype.zGg=function(M){this.addHandler(Za.mCd,M)};Za.prototype.Vcj=function(M){this.removeHandler(Za.mCd,M)};Za.prototype.dispose=function(){gj.a.Ia(this.mwa);this.mwa=null;
this.fbb&&(this.$.ea.pn(this.eId),this.fbb=!1);Si.prototype.dispose.call(this)};Za.prototype.VZc=function(){this.mwa.hide()};Za.prototype.aGj=function(M,na){if(M){this.raiseEvent(Za.mCd);var Pa=M.split("|");this.uwi(M,na,Pa);this.mwa=new Ua;this.mwa.initializeAndShow("",null,null);this.se.Isi(this.mwa.B1a,Pa)}};Za.prototype.did=function(M,na,Pa){var rb=dg.TaskExtensions.kk();if(-515602470===Pa.command||-336193495===Pa.command||2086613372===Pa.command||-1444574190===Pa.command||-1336341324===Pa.command||
451940422===Pa.command)rb=this.U3h(M,na,Pa);418618014===Pa.command&&(na=new wd.a,na.Rk=qg.a.instance.ga(1810),rb=this.H7(Pa,Za.c7h,na,!0));if((Pa.tabName===this.$.zb+qh.a.zUf||Pa.tabName===qh.a.tW)&&2===Pa.Ne||-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback".split(" "),M[ch.a.Mc])||M[ch.a.Mc]===qh.a.GQ)return this.K5e(M,Pa);if(7===Pa.Ne&&M.SourceControlId===this.$.zb+qh.a.$cc)return M.MenuItemId=qh.a.$Gd,this.K5e(M,Pa);1221897806===Pa.command&&(rb=this.z3f(Pa,"Format"));if(1930653487===
Pa.command||1172793074===Pa.command)rb=this.z3f(Pa,"Data");-1753056834===Pa.command&&(rb=this.MBj(Pa));932597253===Pa.command&&(Xd.ULS.sendTraceTag(537170445,0,50,"InsertPowerBIPivotTable - addin launch requested"),ih.c(932597253,!0),na=new wd.a,na.Rk=qg.a.instance.ga(2145),na.sourceLocationOverrideResourceId=af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",!1)?Za.p0i:Za.r0i,na.focusOnIframeWhenLoaded=!0,na.taskPaneWidth=Za.u9e,rb={},rb.LaunchSource=Object(cg.a)(String,
M.SourceControlId),rb.LaunchMode="Default",na.PH=rb,rb=this.H7(Pa,Za.q0i,na,!0));301511274===Pa.command&&(rb=this.WBj(Pa));515196233===Pa.command&&((na=this.$.da.za(465))&&na.X7e(),na=new wd.a,na.Rk=qg.a.instance.ga(2215),rb={},rb.SourceUILocation=Ei.a[Pa.Ne],na.PH=rb,rb=new Pg.a,rb.G4=Jg.a.y2a,rb=this.H7(Pa,Za.zWi,na,!0,rb,void 0,na.Rk));1723441034===Pa.command&&(na=new wd.a,na.Rk=qg.a.instance.ga(2227),na.focusOnIframeWhenLoaded=!0,na.taskPaneWidth=Za.i3i,rb=new Pg.a,rb.G4=Jg.a.vqh,rb=this.H7(Pa,
vh.a,na,!0,rb));af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)&&M.LoadDataFromPictureTaskpane&&(na={},rb=new wd.a,rb.Rk=qg.a.instance.ga(2253),na.SessionID=M.SessionID,rb.PH=na,rb.focusOnIframeWhenLoaded=!0,rb=this.H7(Pa,M.DataFromPictureAssetId,rb,!0));return rb};Za.prototype.insertAgave=function(M,na){var Pa=this,rb=dg.TaskExtensions.kk(),cc=this.$,Dc=M[hf.a.Sra];var Zc=M[ch.a.Wf];var nd=null;Pg.a.key in M&&(nd=M[Pg.a.key]);this.mwa&&this.mwa.hide();if(!Zc||
!Dc)return Xd.ULS.sendTraceTag(537170444,220,10,"Inserting addin needs inserted agave parameters"),rb;this.$.q5&&qh.a.jea in M&&(Zc.EnabledInViewMode=M[qh.a.jea]);M=this.aMh(na.command);if(!Zc.EnabledInViewMode&&!cc.iq(null,!1,M))return rb;var Id=void 0===Zc.IsToBePersisted||null===Zc.IsToBePersisted||Zc.IsToBePersisted?0:16;if(1===Zc.TargetType)rb=this.rdi(Zc,Dc,na,nd,Id);else{Dc=Hg.g(cc);rb=this.viewBlockContainerHelpers.Sfb(Dc);var Od=cc.ea.isNamedObjectViewMode?cc.pa.sheetName:cc.pa.name;if(rb){Dc=
rb.Fe;var je=Dc.jf.top;var Ae=Dc.jf.left;var Re=rb.xI.x;var Ke=rb.xI.y}else je=Ae=1,rb=this.viewBlockContainerHelpers.JKa(Dc),Re=rb.x,Ke=rb.y;var Ef=this.$.oa.va.Pb();rb=function(ff,xf,yf){var Wf=cc.oa.va,Nf=je,mf=Ae,Mf=Re,Yf=Ke;ff=Vf.b(ff,Pa.g0i);var Rf=Wf.Na(9,Ef);Rf.sharedInfo=Zc;Rf.sheetName=Od;Rf.positionRow=Nf;Rf.positionCol=mf;Rf.positionOffsetX=Mf;Rf.positionOffsetY=Yf;return Kg.g(Wf,"InsertWebExtension",Rf,ff,xf,yf,null,0)};af.EwaSettings.Zb()?(Id|=64,rb=qi.a(this.$.userOperationManager,
rb,function(ff){return new Wh.a(534,0,ff,Id)},na)):rb=qi.a(this.$.userOperationManager,rb,function(ff){return new ji.a(534,0,ff,Id)},na)}return rb};Za.prototype.O2g=function(){var M=Xg.a.instance.Tb("Common.App.ICustomerFeedbackUiWrapper"),na=Xg.a.instance.Tb("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager");this.V$c?this.V$c.Jjb?this.cxe():na.instance.$6c(this.Kzh):Xd.ULS.sendTraceTag(537170443,1302,15,"feedbackFormManager is undefined");na={};Ye.AFrameworkApplication.fa.Lle(na);
M=M.instance.getContext(na);na={};"telemetryGroup"in M&&(na=M.telemetryGroup);na.processSessionId=M.sessionId;na.officeBuild=M.build;M.telemetryGroup=na;M.feedbackType=-1;M.userVoiceEnabled=!1;"disableIncludeScreenshot"in M||(M.disableIncludeScreenshot=!1);"screenshot"in M||(M.screenshot=!1);M.disableScreenshotPreview=!1;M.includeScreenshotSelectedDefault=!0;return M};Za.prototype.E0i=function(M){if(!this.mza&&af.EwaSettings.getBooleanFeatureGate(Za.a9h,!1)){var na=af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",
!1)?"Insights.Https.PPE.Bundle":"Insights.Https.Bundle";na=this.Iue(na);var Pa=new Pg.a;Pa.Kk=Jg.a.b9b;Pa.G4=Jg.a.ZNe;Pa.Heb=Jg.a.p9c;this.mza=this.OMd(na,null,!1,null,Pa);na={};Pi.b(this.$).yd(ck.a.F0i,(na.Location=Ei.a[M.Ne],na.InputMethod=Hj.a[M.method],na),void 0,!0);af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",!1)&&this.jXd()}};Za.prototype.NZf=function(M){var na=this.$.ea.Tg.get(17);Xg.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Pa){Pa.isFeatureEnabled("mso_sendASmile",
na).then(function(rb){M.FeedbackEnabled=na&&rb;return null})})};Za.prototype.z3f=function(M,na){var Pa=Hg.g(this.$),rb=new wd.a,cc={};cc.ActiveTab=na;cc.DatapaneFlighting=af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1);cc.RangePickerFlighting=af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneDataRangePicker",!1);cc.AceFlighting=!0;cc.ChartNewSDXRecording=af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OfficeScriptingChartTaskPaneNewRecording",
!1);cc.ThemeColorsFlighting=af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&af.EwaSettings.isChangeGateEnabled("OfficeVSO:5732064_ThemeColorsInChartsTaskpaneEnabled");cc.UOMirror=af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UOMirror",!1);cc.FormatTaskPaneAceButtonDark=af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneAceButtonDark",!1);cc.FormatTaskPaneBetterFeedbackButton=af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterFeedbackButton",
!1);cc.FormatTaskPaneBetterScrollbar=af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterScrollbar",!1);this.NZf(cc);cc.startTimeMs=Date.now();cc.UserSessionId=this.$.ya.UserSessionId;(na=Pa.ha.Oa.yo)&&(cc.SubSelection=na);Xd.ULS.sendTraceTag(592524688,0,50,"Chart task pane launched. UserSessionId: "+cc.UserSessionId+", UILocation: "+(void 0===M.Ne||null===M.Ne?"Null":Ei.a[M.Ne])+", SubSelection: "+(na||"ChartRoot"));rb.PH=cc;rb.Rk=qg.a.instance.ga(976);cc=new Pg.a;cc.G4=
Jg.a.y2a;return this.H7(M,Za.IXg,rb,!0,cc)};Za.prototype.MBj=function(M){var na=new wd.a;na.PH={};na.Rk=qg.a.instance.ga(1796);na.kS=Za.Xkf;var Pa=new Pg.a;Pa.G4=Jg.a.y2a;return this.H7(M,Za.Xkf,na,!0,Pa,void 0,na.Rk)};Za.prototype.WBj=function(M){var na=new wd.a;na.PH={};na.Rk=qg.a.instance.ga(2169);var Pa=new Pg.a;Pa.G4=Jg.a.fsh;Pa.Heb=Jg.a.dOe;return this.H7(M,Za.TDi,na,!0,Pa)};Za.prototype.K5e=function(M,na){var Pa=Za.R7e,rb=M[ch.a.Mc].toString(),cc={},Dc=new wd.a;Dc.Rk=qg.a.instance.ga(9);switch(rb){case "A0":cc.query=
(M[ch.a.Wf]||"").split("|").slice(2,Jj.a.zS).join("|");break;case "A1":cc.query=M.CommandValueId;break;case "Help":cc.gwdropdownflightinfo=af.EwaSettings.ma(240);cc.query="";break;case qh.a.$Gd:af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?(Dc.Rk=qg.a.instance.ga(1762),Dc.sourceLocationOverrideResourceId=Za.w4e,cc.feedback=this.O2g()):cc.query=rb;break;case "HelpArticle":cc.query=M[ch.a.Wf];break;case "ContactSupport":case "ShowTraining":case "WhatsNew":cc.query=
rb;break;default:return Kh.Task.Ua(!0)}Dc.PH=cc;rb=new Pg.a;rb.G4=Jg.a.y2a;return this.H7(na,Pa,Dc,!1,rb,M[qh.a.jea]||!1)};Za.prototype.Iue=function(M){var na={Version:"0.0.0.0"};na.AssetId=Za.yLa;na.SolutionId=Za.yLa;na.AssetStoreId="";na.StoreType=OSF.StoreType.Sdx;na.Height=0;na.Width=0;na.StoreId=OSF.StoreType.Sdx;na.TargetType=OSF.OsfControlTarget.TaskPane;na.IsToBePersisted=!1;na.SourceLocationOverrideResourceId=M;na.SharedRuntimeId=M;return na};Za.prototype.U3h=function(M,na,Pa){function rb(){nd.LaunchMode=
"Default";af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Dc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":Dc.sourceLocationOverrideResourceId="Insights.Https.Bundle";Dc.Rk=qg.a.instance.ga(1809);Dc.kS=Za.nWc;Dc.Kk=Jg.a.b9b;Zc.Kk=Jg.a.b9b}var cc=this,Dc=new wd.a,Zc=new Pg.a,nd={};this.mza&&this.NZf(nd);nd.LaunchSource="";nd.StartTimeMs=Date.now();nd.CorrelationId=Bi.a.create().toString();Dc.PH=nd;Dc.focusOnIframeWhenLoaded=!0;Dc.taskPaneWidth=Za.u9e;
Zc.G4=Jg.a.ZNe;Zc.Heb=Jg.a.p9c;switch(Pa.command){case -1444574190:var Id,Od;nd.LaunchMode="RecommendedPivotTables";nd.SelectionContext="";nd.LaunchSource="PivotTableHandRaise"===Object(cg.a)(String,M.SourceControlId)?"PivotTableHandRaise":"InsertPivotTable";if(this.$&&af.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&M.SourceSelection){var je=M.SourceSelection.split(",")[0];na=af.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?-1:0;if(function(){var Ke=
ci.Z(je,cc.$.xa);Id=Ke.sheetName;Od=Ke.DHb;Ae=Ke.range;return Ke}().returnValue&&!Hg.g(this.$).Ab.n5(Ae))M=this.$.xa.getItemByName(Id),nd.SelectionContext=JSON.stringify(Object(Tg.a)(new ta,{address:Od,addressWithSheet:Id+"!"+Ae.aB(!1),sheetId:bi.d(M),sheetName:Id,isSheetEmpty:!1,columnCount:Ae.width,rowCount:Ae.height,columnIndex:Ae.left+na,rowIndex:Ae.top+na,selectionType:"Continuous"}));else if((M=this.$.vb.getItemByName(Object(cg.a)(String,M.SourceSelection)))&&bi.n(M)){var Ae=Bg.a(M,!0);var Re=
this.$.xa.getItemByName(M.sheetName);nd.SelectionContext=JSON.stringify(Object(Tg.a)(new ja,{tableName:M.name,hasTableHeaders:Bg.d(M),isPivotTable:!1,isTable:!0,userSelectedPivotTable:!1,address:Ae.aB(!1),addressWithSheet:Re.name+"!"+Ae.aB(!1),sheetId:bi.d(Re),sheetName:Re.name,isSheetEmpty:!1,columnCount:Ae.width,rowCount:Ae.height,columnIndex:Ae.left+na,rowIndex:Ae.top+na,selectionType:"Continuous"}))}}af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Dc.sourceLocationOverrideResourceId=
"RecommendPivotTables.PPE.Bundle":Dc.sourceLocationOverrideResourceId="RecommendPivotTables.Bundle";Dc.Rk=qg.a.instance.ga(1808);Dc.kS=Za.DZi;Dc.Kk=Jg.a.sQe;Zc.Kk=Jg.a.sQe;break;case -336193495:nd.LaunchMode="RecommendedCharts";af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Dc.sourceLocationOverrideResourceId="RecommendCharts.PPE.Bundle":Dc.sourceLocationOverrideResourceId="RecommendCharts.Bundle";Dc.Rk=qg.a.instance.ga(1807);Dc.kS=Za.y7i;Dc.Kk=Jg.a.tQe;Zc.Kk=Jg.a.tQe;
break;case -1336341324:if(!af.EwaSettings.ma(481))return Kh.Task.Ua(!1);nd.LaunchMode="NL";Dc.kS=Za.nWc;af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Dc.sourceLocationOverrideResourceId="IdeasNL.PPE.Bundle":Dc.sourceLocationOverrideResourceId="IdeasNL.Bundle";switch(af.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:Dc.Rk=qg.a.instance.ga(1812);nd.NLLaunchModeBrandingCandidatesIndex=1;break;
case 2:Dc.Rk=qg.a.instance.ga(1813);nd.NLLaunchModeBrandingCandidatesIndex=2;break;default:Dc.Rk=qg.a.instance.ga(1811),nd.NLLaunchModeBrandingCandidatesIndex=0}break;case 2086613372:if(!af.EwaSettings.ma(235))return Kh.Task.Ua(!1);nd.LaunchMode="ChartDesigner";nd.LaunchSelectionMode=na.toString();af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Dc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":Dc.sourceLocationOverrideResourceId="Insights.Https.Bundle";
Dc.Rk=qg.a.instance.ga(1814);Dc.kS=Za.nWc;break;case 451940422:nd.LaunchSource="AutoFilter";na=JSON.parse(M.CommandValueId);nd.AutoFilterSource=JSON.stringify(Object.assign(new oa,{autoFilterRange:{sheetName:na.AutoFilterRange.SheetName,firstColumn:na.AutoFilterRange.FirstColumn,lastColumn:na.AutoFilterRange.LastColumn,firstRow:na.AutoFilterRange.FirstRow,lastRow:na.AutoFilterRange.LastRow},autoFilterType:na.AutoFilterType,itemIndex:na.ItemIndex,id:na.Id}));rb();break;default:af.EwaSettings.ma(235)&&
(nd.LaunchSelectionMode=na.toString()),af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",!1)&&(nd.XlimTableBoundaries=this.QZh()),rb()}af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Dc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":Dc.sourceLocationOverrideResourceId="Insights.Https.Bundle";return this.mza?this.mza.Jo(function(){return cc.OXf(nd,Dc)}):this.wbi(Pa,Dc,Zc,nd)};Za.prototype.wbi=function(M,na,Pa,
rb){var cc=this;this.mza=this.OMd(this.Iue(na.sourceLocationOverrideResourceId),na,!1,M,Pa,!1);return af.EwaSettings.isChangeGateEnabled("OfficeVSO:6256725_NoActionMsgOnFirstInstance")?(rb.NoActionMsgOnFirstInstance=!0,this.SRa[Za.yLa]=rb,this.mza):this.mza.Jo(function(){return cc.OXf(rb,na)})};Za.prototype.OXf=function(M,na){var Pa=this.se.Gaa(this.se.y3a(Za.yLa,na.sourceLocationOverrideResourceId));if(Pa){this.SRa[Za.yLa]=M;var rb=this.twd(this.se.pZ(Pa).OsfPropertyBag,Za.yLa);this.se.pZ(Pa).OsfPropertyBag=
rb}this.sNa(Za.yLa,"LaunchIdeasAction",M,na);return Kh.Task.Ua(!0)};Za.prototype.H7=function(M,na,Pa,rb,cc,Dc,Zc){Pa=void 0===Pa?null:Pa;rb=void 0===rb?!1:rb;cc=void 0===cc?null:cc;Dc=void 0===Dc?!1:Dc;Zc=void 0===Zc?null:Zc;dg.TaskExtensions.kk();Pa||(Pa=new wd.a);var nd={Version:"0.0.0.0"};nd.AssetId=na;nd.SolutionId=na;nd.AssetStoreId="";nd.StoreType=rb?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;nd.Height=0;nd.Width=0;nd.StoreId=rb?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;nd.TargetType=OSF.OsfControlTarget.TaskPane;
nd.IsToBePersisted=!1;nd.SourceLocationOverrideResourceId=Pa.sourceLocationOverrideResourceId;if(Pa.Rk||Zc)this.Pad[na]=Object(Tg.a)(new aa,{Uzc:Pa.Rk,qVd:Zc,Szc:Pa.kS});af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?(Pa.PH||(Pa.PH={}),Pa.PH.ShowFeedback=this.$.isFeedbackEnabled,this.SRa[na]=Pa.PH):Pa.PH&&(this.SRa[na]=Pa.PH);na={};na[ch.a.Wf]=nd;Zc={};Zc.solutionId=nd.SolutionId;Zc.version=nd.Version;Zc.storeType=nd.StoreType;
Zc.storeId=nd.StoreId;Zc.assetId=nd.AssetId;Zc.assetStoreId=nd.AssetStoreId;Zc.height=nd.Height;Zc.targetType=nd.TargetType;Zc.width=nd.Width;Zc.isAddinCommands=!rb;na[hf.a.Sra]=Zc;cc||(cc=new Pg.a);cc.focusOnIframeWhenLoaded=Pa.focusOnIframeWhenLoaded;cc.width=Pa.taskPaneWidth;na[Pg.a.key]=cc;na[qh.a.jea]=Dc;return this.insertAgave(na,M)};Za.prototype.rdi=function(M,na,Pa,rb,cc){function Dc(je){Xd.ULS.sendTraceTag(537170440,220,50,"Insert addincommands for "+Telemetry.PrivacyRules.GetPrivacyCompliantId(je.solutionId,
je.storeType,je.assetId,null,null,je.storeId)+" from "+je.storeType+".");var Ae={},Re=new cf.a;Re.add(je);Ae[hf.a.Rnb]=Re;Ae[hf.a.rP]=3;je=new Vh.a(Gg.a.VBb,0,nd.$.Jc,0,null);return nd.$.Ka.Kb(je,Ae)}function Zc(je,Ae){var Re=je.SolutionId;var Ke=OSF.OsfControl.isFirstPartyStoreString(je.StoreType);Ke&&je.SourceLocationOverrideResourceId&&(Re=nd.se.y3a(Re,je.SourceLocationOverrideResourceId));var Ef=nd.se.Vxe(Re,null,je.SharedRuntimeId);Ke&&(af.EwaSettings.ma(296)&&Ef&&(Ke=nd.se.Gaa(Re))&&(Re=null,
Re=nd.twd(nd.se.pZ(Ke).OsfPropertyBag,je.SolutionId),(Ke=nd.se.Th.getOsfControl(Ke))&&Ke.setSettings(Re)),je.SharedRuntimeId&&Ef||nd.se.Th.refreshOsfControl(je.SolutionId,je.SourceLocationOverrideResourceId));if(!Ef){var ff=nd.$.oa.va.Pb(),xf=519;Ef=function(yf,Wf,Nf){var mf=nd.$.oa.va;yf=Vf.b(yf,nd.UHf);var Mf=mf.Na(9,ff);Mf.sharedInfo=je;return Kg.g(mf,"InsertAgaveTaskpane",Mf,yf,Wf,Nf,rb,0)};void 0===je.IsToBePersisted||null===je.IsToBePersisted||je.IsToBePersisted||(xf=538,Ef=function(yf,Wf,Nf){Xd.ULS.sendTraceTag(537170442,
220,50,"Web Method ShowAgaveTaskpane is called, StoreType "+je.StoreType+", StoreId "+je.StoreId+", SolutionId "+Telemetry.PrivacyRules.GetPrivacyCompliantId(je.SolutionId,je.StoreType,je.AssetId,null,null,je.StoreId)+".");var mf=nd.$.oa.va;yf=Vf.b(yf,nd.UHf);var Mf=mf.Na(9,void 0===ff?null:ff);Mf.sharedInfo=je;return Kg.g(mf,"ShowAgaveTaskpane",Mf,yf,Wf,Nf,rb,0)});return af.EwaSettings.Zb()?(cc|=64,qi.a(nd.$.userOperationManager,Ef,function(yf){return new Wh.a(xf,0,yf,cc)},Ae)):qi.a(nd.$.userOperationManager,
Ef,function(yf){return new ji.a(xf,0,yf,cc)},Ae)}return dg.TaskExtensions.eba()}var nd=this;if(!af.EwaSettings.ma(54)||M.StoreId===OSF.StoreType.FirstParty)return Zc(M,Pa,rb);if(na.isAddinCommands)return Dc(na);var Id=new Ji.a,Od={};Od.marketplaceId=M.SolutionId;Od.marketplaceVersion=M.Version;Od.storeType=M.StoreType;Od.storeId=M.StoreId;Od.targetData=M;af.EwaSettings.ma(94)&&(Od.clearCache=!0);this.se.Th.isAddinCommandsAsync(Od,function(je,Ae,Re){Id.setResult(Ae);je||(je=Re.targetData,Xd.ULS.sendTraceTag(537170438,
220,10,"Judging AddinCommands failed for "+Telemetry.PrivacyRules.GetPrivacyCompliantId(je.SolutionId,je.StoreType,je.AssetId,null,null,je.StoreId)+" from "+je.StoreType+" during addin inserting"))});return dg.TaskExtensions.ts(Id.task,function(je){return je.result?Dc(na):Zc(M,Pa,rb)},this.$.la)};Za.prototype.twd=function(M,na){if(!this.SRa[na])return M;var Pa={};if(M){M=ik(M);for(var rb=M.next();!rb.done;rb=M.next())rb=rb.value,Pa[rb[0]]=rb[1]}M=this.SRa[na];rb=ik(Object.keys(M));for(na=rb.next();!na.done;na=
rb.next())na=na.value,na===Za.Mzh&&af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?Pa[na]=Sys.Serialization.JavaScriptSerializer.serialize(M[na]):Pa[na]=Sys.Serialization.JavaScriptSerializer.serialize(M[na].toString());na=Object.keys(Pa).length;M=Array(na);rb=0;var cc=ik(Object.keys(Pa));for(na=cc.next();!na.done;na=cc.next())na=na.value,M[rb]=[na,Pa[na].toString()],rb++;return M};Za.prototype.uwi=function(M,na,Pa){var rb=this.$.ya.UserSessionId,
cc=this.$.ya.UICultureTag,Dc=this.$.ya.UICultureTagLcid,Zc=this.$.ya.WacHostId,nd="",Id="";5<=Pa.length&&(nd=Pa[3],Id=Pa[4]);this.vwi(nd,Id,M,na,cc,Dc,rb,Zc)};Za.prototype.vwi=function(M,na,Pa,rb,cc,Dc,Zc,nd){var Id={};Id.a=Zc;Id.b=Pa;Id.c=rb;Id.d=M;Id.e=na;Id.f=cc;Id.g=Dc;Id.h=nd;Lh.b().Ce(36,Id)};Za.prototype.cxe=function(){if(Ij.a.rtf())Xd.ULS.sendTraceTag(537170433,1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(this.YHf);return}catch(M){Xd.ULS.sendTraceTag(537170432,
1302,15,"Failed to use createScreenshot "+(M?M.toString():null))}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(this.YHf)}catch(M){Xd.ULS.sendTraceTag(537170403,1302,15,"Failed to use html2canvas"+(M?M.toString():null))}}};Za.prototype.OMd=function(M,na,Pa,rb,cc,Dc){na=void 0===na?null:na;Pa=void 0===Pa?!1:Pa;rb=void 0===rb?null:rb;cc=void 0===cc?null:cc;Dc=void 0===Dc?!0:Dc;var Zc=M.SolutionId,nd=Kh.Task.Ua(!1);M&&Zc&&M.SharedRuntimeId&&(rb=rb||new Vh.a(-859308420,0,2,0,""),Zc=
{},Zc.solutionId=M.SolutionId,Zc.version=M.Version,Zc.storeType=M.StoreType,Zc.storeId=M.StoreId,Zc.assetId=M.AssetId,Zc.assetStoreId=M.AssetStoreId,Zc.height=M.Height,Zc.targetType=M.TargetType,Zc.width=0,Zc.isAddinCommands=!1,Zc.sharedRuntimeId=M.SharedRuntimeId,M.Preload=Dc,cc=cc?cc:new Pg.a,cc.width=0,na&&(cc.focusOnIframeWhenLoaded=na.focusOnIframeWhenLoaded,Dc=new aa,na.Rk&&(Dc.Uzc=na.Rk),0<na.taskPaneWidth&&(Dc.lu=na.taskPaneWidth),na.kS&&(Dc.Szc=na.kS),this.Pad[M.SolutionId]=Dc),na={},na[ch.a.Wf]=
M,na[hf.a.Sra]=Zc,na[Pg.a.key]=cc,na[qh.a.jea]=Pa,nd=this.insertAgave(na,rb));return nd};Za.prototype.sNa=function(M,na,Pa,rb){rb=void 0===rb?null:rb;if(M&&na){M=new kj.a(M,OSF.StoreType.Sdx,OSF.StoreType.Sdx,"1.0.0.0");var cc=new Ai.a("ExcelOnline","Web",this.$.ya.UICultureTag),Dc=new Gj.a;Dc.optionalProperties[lh.a.uTc]=Pa;rb&&(Pa=rb,Pa.sourceLocationOverrideResourceId&&(Dc.optionalProperties[lh.a.sourceLocationOverrideResourceId]=Pa.sourceLocationOverrideResourceId),Pa.Rk&&(Dc.optionalProperties[lh.a.Rk]=
Pa.Rk),Pa.Kk&&(Dc.optionalProperties.IconCssClass=Pa.Kk),Pa.mVd&&(Dc.optionalProperties.TaskPaneIconUrl=Pa.mVd),Pa.kS&&(Dc.optionalProperties.TaskPaneIconId=Pa.kS));ii.a.instance.sNa(M,be.a.action,na,cc,Dc)}};Za.prototype.DUh=function(M){if(!Di.a.gh(M)){var na=M[uh.a.w9b];if(na&&(na=na.getId(),M=M[uh.a.Xya],na&&M))return this.y3a(na,M.optionalProperties[lh.a.sourceLocationOverrideResourceId])}return null};Za.prototype.y3a=function(M,na){na=void 0===na?null:na;return M&&na?M+"."+na:M};Za.prototype.aMh=
function(M){switch(M){case 1172793074:case 1221897806:case 1930653487:return 2;case -515602470:case 2086613372:return af.EwaSettings.ma(235)?1023:1;case 1723441034:return 1023;case -859308420:return 1023;case 515196233:return 1023;default:return 1}};Za.prototype.jXd=function(){this.$.ea.Lg?this.eId():(this.$.ea.jl(this.eId),this.fbb=!0)};Za.prototype.QZh=function(){var M=this.$.da.za(20);if(!M)return this.jXd(),"";M=M.Dwb();if(!M)return this.jXd(),"";var na=this.$.xa.getItemByName(this.$.ea.isNamedObjectViewMode?
this.$.pa.sheetName:this.$.pa.name);na=bi.d(na);var Pa=Hg.g(this.$).ha.sa.selectedRanges,rb=[];Pa=ik(Pa);for(var cc=Pa.next();!cc.done;cc=Pa.next()){cc=cc.value;var Dc=new Ri.a(cc,na),Zc=M.dgd(Dc,Fi.Valid);Dc=[];if(Zc){Zc=ik(Zc);for(var nd=Zc.next();!nd.done;nd=Zc.next())(nd=nd.value.table.Cu)&&(nd=nd.range.toString())&&Dc.push(nd)}cc=new Ma(cc.toString(),Dc);rb.push(cc)}return JSON.stringify(rb)};Za.a9h="Microsoft.Office.Excel.IdeasXLOPreload";Za.mCd="IDS";Za.R7e="FA000000012";Za.yLa="FA000000005";
Za.c7h="HelloWorld";Za.IXg="FA000000014";Za.w4e="Help.GiveFeedback.Url";Za.Mzh="feedback";Za.Xkf="FA000000066";Za.r0i="PowerBi.Url";Za.p0i="PowerBi.DevUrl";Za.q0i="FA000000054";Za.TDi="FA000000064";Za.zWi="FA000000075";Za.nWc="AnalyzeDataTaskPane";Za.y7i="RecommendedChartsTaskPane";Za.DZi="PivotTableTaskPane";Za.ceh=350;Za.u9e=320;Za.i3i=320;Object(Dd.a)(Za,"AgaveCommandManager",ni.a,[842,843]);var lj=b(921),Ti=$e.a;$k(pa,Ti);pa.prototype.create=function(){var M=this,na=this.$.da,Pa=Mg.GetServiceTaskFactory.create(na,
106,this.la,this.hb),rb=Mg.GetServiceTaskFactory.create(na,104,this.la,this.hb),cc=zi.a.loadScript(36,0,this.hb,void 0,void 0,375);dg.TaskExtensions.Aa(dg.TaskExtensions.Vd([rb,Pa,cc],this.la),function(){var Dc=null;af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)&&(Dc=Xg.a.instance.Tb("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").instance);ma.instance.initialize(Pa.result);var Zc=af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PreloadRaceCondition6395242",
!0)?Object(lj.c)(M.$.da,374,function(){return new Za(M.$,Pa.result,rb.result,Dc,Ye.AFrameworkApplication.ub)}):new Za(M.$,Pa.result,rb.result,Dc,Ye.AFrameworkApplication.ub);na.Ga(206,Zc);M.pb(na.za(374)||na.Ga(374,Zc))},this.la,3);Xg.a.instance.register(Ni.a,"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").tc().Dc(function(){return new Ni.a(M.$.Rv)})};pa.ka=function(M){M.da.Ga(375,new pa(M))};Object(Dd.a)(pa,"AgaveCommandManagerFactory",$e.a,[]);var Lj=b(633);ra.prototype.initialize=
function(M){af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&!this.initialized&&this.zkj(M)};ra.prototype.Xci=function(M,na){var Pa=dg.TaskExtensions.kk();if(this.initialized&&M&&0<M.length){var rb=this.VIh(M);M in this.lU&&(Pa=this.agaveCommandManager.insertAgave(rb,na))}return Pa};ra.prototype.lBg=function(M){var na=this;this.initialized&&(M=M[ch.a.Wf]||{},!M.SolutionId||M.SolutionId in this.lU||this.se.bda(function(Pa){na.bda(Pa)},
!0))};ra.prototype.W4h=function(M){var na=this;this.initialized&&(M=M||"")&&0<M.length&&M in this.lU&&(delete this.lU[M],this.se.bda(function(Pa){na.bda(Pa)},!0))};ra.prototype.VIh=function(M){return M in this.lU?this.lU[M]:{}};ra.prototype.bda=function(M){var na=!1;if(M&&!M.errorCode){if(M.value){M=ik(M.value);for(var Pa=M.next();!Pa.done;Pa=M.next()){Pa=Pa.value;var rb=Pa[1];Pa[3]==OSF.OsfControlTarget.InContent&&rb&&0<rb.length&&!(rb in this.lU)&&(na={NoReporting:!1,IsSystemInitiated:!1},na.description=
Pa[2],na.iconUrl=Pa[9],na[hf.a.Sra]={solutionId:Pa[1],version:Pa[4],storeType:Pa[12],storeId:Pa[11],assetId:Pa[5],assetStoreId:Pa[6],targetType:Pa[3],width:Pa[7],height:Pa[8],displayName:Pa[0],id:Pa[1]},na[ch.a.Wf]={SolutionId:Pa[1],Version:Pa[4],StoreType:Pa[12],StoreId:Pa[11],AssetId:Pa[5],AssetStoreId:Pa[6],TargetType:Pa[3],Width:Pa[7],Height:Pa[8],Id:Pa[1]},this.lU[rb]=na,na=!0)}}na&&this.K6g()}};ra.prototype.K6g=function(){var M=[],na;for(na in this.lU)M.push({id:na,controlType:0,title:this.lU[na][hf.a.Sra].displayName});
if(0<M.length){for(var Pa in this.lU)appChrome.addInApi.registerAddinIcon("AddinIcon_"+Pa,this.lU[Pa].iconUrl);this.RYg();appChrome.addInApi.dispatchActionsToInstallAddIn({tabs:[{id:ra.ytf,isOfficeTab:!0,groups:[{id:ra.xaf,title:ra.yaf,controls:M}]}]});for(var rb in this.lU)this.o0a.addCommandToMaps(Object(Tg.a)(new xi.a(rb,"-1473679467"),{legacyControlId:rb}))}};ra.prototype.RYg=function(){appChrome.addInApi.dispatchActionsToRemoveAddIn({tabs:[{id:ra.ytf,isOfficeTab:!0,groups:[{id:ra.xaf,title:ra.yaf,
controls:[]}]}]})};ra.prototype.zkj=function(M){var na=this,Pa=Mg.GetServiceTaskFactory.Ra(M.da,374,375,1),rb=Mg.GetServiceTaskFactory.create(M.da,106,M.la,1);dg.TaskExtensions.Aa(dg.TaskExtensions.Vd([Pa,rb],M.la),function(){na.agaveCommandManager=Pa.result;na.o0a=Xg.a.instance.nh("Common.IExternalUICommandDefinitionMapping")||new Lj.a(M.zb,M);Ye.AFrameworkApplication.ub.Mb(Gg.a.dPf,ai.a.frame,function(cc,Dc,Zc,nd,Id){na.W4h(Id)});na.se=rb.result;na.se.bda(function(cc){na.bda(cc)},!0);na.initialized=
!0},M.la,3)};ra.ytf="tabinsert";ra.xaf="installedContentAddins";ra.yaf=qg.a.instance.ga(2261);Object(Dd.a)(ra,"AgaveCommandRibbon",null,[869]);var Ui=$e.a;$k(fa,Ui);fa.prototype.create=function(){if(af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)){var M=this.$.da,na=new ra;na.initialize(this.$);this.pb(M.za(488)||M.Ga(488,na))}};fa.ka=function(M){M.da.Ga(489,new fa(M))};Object(Dd.a)(fa,"AgaveCommandRibbonFactory",$e.a,[]);var Mj=b(1513),
rg=b(955);ba.prototype.getTypeName=function(){return"Microsoft.Authentication.OfficeIdentityInfo"};ba.prototype.invokePropertyGet=function(M){switch(M){case 4:return this.displayName;case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};ba.prototype.invokePropertyGetAsync=function(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)};ba.prototype.invokePropertySet=
function(M,na){switch(M){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(na,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(na,0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(na,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(na,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
};ba.prototype.invokePropertySetAsync=function(M,na){this.invokePropertySet(M,na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};ba.prototype.invokeMethod=function(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};ba.prototype.invokeMethodAsync=function(M,na){M=this.invokeMethod(M,na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)};ba.W7g=function(M){var na=new ba;na.displayName=M.displayName;na.email=M.email;switch(M.authority){case Mj.a.WEf:na.identityType=
1;break;default:na.identityType=0}na.federationProvider="";return na};of.Object.defineProperties(ba.prototype,{displayName:{configurable:!0,enumerable:!0,get:function(){return this.ofa},set:function(M){this.ofa=M}},email:{configurable:!0,enumerable:!0,get:function(){return this.M5d},set:function(M){this.M5d=M}},federationProvider:{configurable:!0,enumerable:!0,get:function(){return this.s6d},set:function(M){this.s6d=M}},identityType:{configurable:!0,enumerable:!0,get:function(){return this.kjb},set:function(M){this.kjb=
M}}});Object(Dd.a)(ba,"OfficeIdentityInfo",null,[]);bb.pbc=function(M){return M in bb.mMe?bb.mMe[M].toString():M};of.Object.defineProperties(bb,{mMe:{configurable:!0,enumerable:!0,get:function(){return bb.Yog}}});bb.map=null;var Ah={};bb.Yog=(Ah.GeneralException=rg.a.generalException,Ah.AccessDenied=rg.a.qTc,Ah.ApiNotAvailable=rg.a.apiNotAvailable,Ah.UserNotSignedIn=rg.a.userNotSignedIn,Ah.UserAborted=rg.a.userAborted,Ah.UnsupportedUserIdentity=rg.a.yRj,Ah.InvalidResourceUrl=rg.a.invalidResourceUrl,
Ah.InvalidGrant=rg.a.invalidGrant,Ah.AddinIsAlreadyRequestingToken=rg.a.WIg,Ah.ResourceNotAllowed=rg.a.rij,Ah.ClientError=rg.a.clientError,Ah.ServerError=rg.a.serverError,Ah);Object(Dd.a)(bb,"SingleSignOnErrorCodeMap",null,[]);va.prototype.getTypeName=function(){return"Microsoft.Authentication.SingleSignOnToken"};va.prototype.invokePropertyGet=function(M){switch(M){case 2:return this.accessToken;case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
};va.prototype.invokePropertyGetAsync=function(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)};va.prototype.invokePropertySet=function(M,na){switch(M){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(na,0,"string");return;case 3:this.tokenIdenityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(na,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};va.prototype.invokePropertySetAsync=
function(M,na){this.invokePropertySet(M,na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};va.prototype.invokeMethod=function(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};va.prototype.invokeMethodAsync=function(M,na){M=this.invokeMethod(M,na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)};of.Object.defineProperties(va.prototype,{accessToken:{configurable:!0,enumerable:!0,get:function(){return this.KQb},set:function(M){this.KQb=
M}},tokenIdenityType:{configurable:!0,enumerable:!0,get:function(){return this.kjb},set:function(M){this.kjb=M}}});Object(Dd.a)(va,"SingleSignOnToken",null,[]);ya.prototype.getTypeName=function(){return"Microsoft.Authentication.TokenParameters"};ya.prototype.invokePropertyGet=function(M){switch(M){case 3:return this.authChallenge;case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
};ya.prototype.invokePropertyGetAsync=function(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)};ya.prototype.invokePropertySet=function(M,na){switch(M){case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(na,0,"string");return;case 7:this.correlationId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(na,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(na,0,"string");
return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(na,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(na,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(na,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};ya.prototype.invokePropertySetAsync=function(M,na){this.invokePropertySet(M,na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
ya.prototype.invokeMethod=function(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};ya.prototype.invokeMethodAsync=function(M,na){M=this.invokeMethod(M,na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)};of.Object.defineProperties(ya.prototype,{authChallenge:{configurable:!0,enumerable:!0,get:function(){return this.h2d},set:function(M){this.h2d=M}},correlationId:{configurable:!0,enumerable:!0,get:function(){return this.zD},set:function(M){this.zD=M}},
policy:{configurable:!0,enumerable:!0,get:function(){return null},set:function(){}},resource:{configurable:!0,enumerable:!0,get:function(){return this.oWb},set:function(M){this.oWb=M}},scope:{configurable:!0,enumerable:!0,get:function(){return this.Pfe},set:function(M){this.Pfe=M}},silentLogin:{configurable:!0,enumerable:!0,get:function(){return this.bhe},set:function(M){this.bhe=M}}});Object(Dd.a)(ya,"TokenParameters",null,[555]);ha.prototype.getAccessToken=function(M){var na=this,Pa=this.Hhb.getOsfControl(this.hA),
rb=Pa.getManifest(),cc=rb.getMarketplaceID();this.NNa(M,cc);return OfficeExtension.WacRuntime.Utility.createPromise(function(Dc,Zc){Pa.isFirstParty()&&na.Hhb._enableFirstPartySSO?na.Wfi(rb,M)?Xg.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(M,cc).then(function(nd){Dc(nd)},function(nd){Zc(nd)}):Zc(rg.a.qTc):Zc(rg.a.apiNotAvailable)}).then(function(Dc){switch(Dc.authority){case Mj.a.WEf:var Zc=1;break;default:Zc=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new va(Dc.accessToken,
Zc))},function(Dc){na.logErrorResponse(M,cc,Dc);return Dc?OfficeExtension.WacRuntime.Utility.createPromise(function(Zc,nd){nd(OfficeExtension.WacRuntime.Utility.createRichApiException(Dc,bb.pbc(Dc)))}):OfficeExtension.WacRuntime.Utility.createPromise(function(Zc,nd){nd(OfficeExtension.WacRuntime.Utility.createRichApiException(rg.a.generalException,bb.pbc(rg.a.generalException)))})})};ha.prototype.getAuthContext=function(){return null};ha.prototype.getPrimaryIdentityInfo=function(){var M=this.Hhb.getOsfControl(this.hA);
M.getManifest();var na=M.getManifest().getMarketplaceID();return OfficeExtension.WacRuntime.Utility.createPromise(function(Pa,rb){Xg.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(na).then(function(cc){Pa(cc)},function(cc){rb(cc.toString())})}).then(function(Pa){Pa=ba.W7g(Pa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Pa)},function(Pa){return Pa?OfficeExtension.WacRuntime.Utility.createPromise(function(rb,cc){cc(OfficeExtension.WacRuntime.Utility.createRichApiException(Pa,
bb.pbc(Pa)))}):OfficeExtension.WacRuntime.Utility.createPromise(function(rb,cc){cc(OfficeExtension.WacRuntime.Utility.createRichApiException(rg.a.generalException,bb.pbc(rg.a.generalException)))})})};ha.prototype.getTypeName=function(){return"Microsoft.Authentication.AuthenticationService"};ha.prototype.invokePropertyGet=function(M){switch(M){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};ha.prototype.invokePropertyGetAsync=function(M){M=
this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)};ha.prototype.invokePropertySet=function(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};ha.prototype.invokePropertySetAsync=function(M,na){this.invokePropertySet(M,na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};ha.prototype.invokeMethod=function(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};ha.prototype.invokeMethodAsync=
function(M,na){switch(M){case 1:return this.lIh(na);case 3:return this.HJh();case 2:return this.IVh()}M=this.invokeMethod(M,na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)};ha.prototype.lIh=function(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,ya);return this.getAccessToken(M)};ha.prototype.HJh=function(){return this.getAuthContext()};ha.prototype.IVh=function(){return this.getPrimaryIdentityInfo()};ha.prototype.Wfi=function(M,na){var Pa=!1,rb=M.getWebApplicationAuthorizations();
M=null;rb=ik(rb);for(var cc=rb.next();!cc.done;cc=rb.next())if(cc=cc.value,cc.getResource().toLowerCase()===na.resource.toLowerCase()){M=cc;Pa=!0;break}if(!Pa)return!1;na=na.scope.split(" ,+");na=ik(na);for(Pa=na.next();!Pa.done;Pa=na.next())if((Pa=Pa.value)&&Pa.length){rb=!1;cc=ik(M.getScopes());for(var Dc=cc.next();!Dc.done;Dc=cc.next())Pa.toLowerCase()===Dc.value.toLowerCase()&&(rb=!0);if(!rb)return!1}return!0};ha.prototype.NNa=function(M,na){M=this.ktf(M.resource);var Pa={};Xd.ULS.sendTraceTag(538572831,
369,50,"{0}",(Pa.manifestId=na,Pa.resource=M,Pa))};ha.prototype.logErrorResponse=function(M,na,Pa){M=this.ktf(M.resource);var rb={};Xd.ULS.sendTraceTag(538572830,369,10,"{0}",(rb.manifestId=na,rb.resource=M,rb.error=Pa,rb))};ha.prototype.ktf=function(M){return M.replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")};of.Object.defineProperties(ha.prototype,{roamingSettings:{configurable:!0,enumerable:!0,get:function(){return null}}});Object(Dd.a)(ha,"AuthenticationService",null,
[]);Z.prototype.create=function(M,na){return new ha(M,na)};Object(Dd.a)(Z,"AuthenticationServiceFactory",null,[]);var mj=b(1067),nj=b(1181),dk=b(1165);xa.generalException="generalException";xa.invalidArgument="invalidArgument";xa.notAllowed="notAllowed";xa.apiNotAvailable="apiNotAvailable";xa.unresolvedPendingRequest="unresolvedPendingRequest";xa.timeout="timeout";xa.adalTimeout="adalTimeout";xa.userNotSignedIn="userNotSignedIn";xa.userAborted="userAborted";xa.silentSignInFailed="silentSignInFailed";
xa.invalidResourceUrl="invalidResourceUrl";xa.invalidGrant="invalidGrant";xa.connectionLost="connectionLost";xa.clientError="clientError";xa.serverError="serverError";Object(Dd.a)(xa,"WopiHostErrorCodes",null,[]);var ek=b(953);Object(Dd.a)(da,"OAuthCallerMetadata",null,[]);var Bh=b(27);ia.prototype.zAg=function(M,na,Pa,rb,cc,Dc){var Zc=this;if(!this.Rxa)return rb=new nj.a,rb.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(rb);var nd=new da;nd.AddinName=cc;nd.AddinTrustId=
Dc;var Id=-1;Dc=null;if(rb&&this.uef())Dc=this.Rxa.Zag(hf.a.hAc,M,rb,ia.p1e(cc),nd);else{var Od=Date.now();Dc=this.Rxa.EO(hf.a.hAc,M,nd).then(function(je){Id=Date.now()-Od;var Ae=(na||Pa)&&"login_required"===je.ErrorCode;return(na&&("interaction_required"===je.ErrorCode||"consent_required"===je.ErrorCode||"invalid_grant"===je.ErrorCode)||Ae)&&Zc.uef()?Zc.Rxa.Zag(hf.a.hAc,M,null,ia.p1e(cc),nd):Promise.resolve(je)})}return Dc.then(function(je){var Ae=new nj.a;je.IsSuccess?(Ae.token=je.Token,je.Telemetry&&
(Ae.lTa=je.Telemetry.fromCache,Ae.expiresOn=je.Telemetry.expiresOn)):(Ae.errorCode=Zc.Lzi(je),Ae.uVd=Zc.MXi(je));return Ae}).catch(function(){var je=new nj.a;je.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(je)}).then(function(je){je.lha="OauthManager";0<=Id&&(je.Hwb=Id);return je})};ia.prototype.rii=function(M){var na=(Ye.AFrameworkApplication.fa.Wa(Ye.AFrameworkApplication.xea)||"").toLowerCase();return(Bh.a.mxa||"teams"===na&&ek.a.Sxb)&&!ia.Vhi(M)||!this.Rxa||
!this.Rxa.Y5a()?!1:!0};ia.prototype.uef=function(){return this.Pog||1!==dk.a.vac()};ia.prototype.Lzi=function(M){switch(M.ErrorCode){case "UserCancelled":case "interaction_required":M=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "consent_required":case "invalid_grant":M=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":M=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":M=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;
break;case "invalid_resource":M=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":M=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:M=M.ErrorCode===xa.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:M.ErrorCode===xa.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:M.ErrorCode===xa.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:M.ErrorCode===xa.invalidGrant?
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:M.ErrorCode===xa.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return M};ia.prototype.MXi=function(M){var na="";(M=RegExp("AADSTS(\\d+)").exec(M.ErrorMessage))&&1<M.length&&(na=M[1]);return na};ia.p1e=function(M){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,M)};ia.Vhi=function(M){if(!M)return!1;M=M.toLowerCase();for(var na=
ik(mj.AppsForOfficeSingleSignOnManager.RTe),Pa=na.next();!Pa.done;Pa=na.next())if(Pa.value===M)return!0;return!1};Object(Dd.a)(ia,"AppsforOfficeTokenFromOauthManager",null,[200]);ea.Boa=function(){if(Ye.AFrameworkApplication.fa.qa("AppForOfficeSSOV2IsEnabled")){var M=null;try{M=Xg.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(na){Xd.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+na)}M=new ia(M);ea.Ma=new ea(M)}};ea.getInstance=function(){ea.m8d||(ea.Boa(),ea.m8d=
!0);return ea.Ma};ea.Ma=null;ea.m8d=!1;Object(Dd.a)(ea,"AppsForOfficeOauthManagerFactory",null,[188]);var oj=b(1512),pj=b(135);Object(Dd.a)(P,"NewDocumentParameters",null,[]);var Mh=b(180);U.prototype.createAndOpenWorkbook=function(M){var na=this;if(M&&M.length>this.Atg)throw Xd.ULS.sendTraceTag(538572821,0,15,"Too large base64 stream size:{0}",M.length),OfficeExtension.WacRuntime.Utility.createRichApiException(rg.a.invalidArgument,Mh.a.ga(1756));var Pa=new P("blank","agave",M?"streamBase64":"streamEmpty",
M),rb=null;return OfficeExtension.WacRuntime.Utility.createPromise(function(cc,Dc){var Zc=new pj.StandardDialog;Zc.Rb=4;Zc.rl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,function(nd){2===nd||0===nd?Dc("Cancelled"):(rb=window.open(""),na.Wtg.create(cc,Dc,Pa).O0a())})}).then(function(cc){if(!cc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(rg.a.generalException,Mh.a.ga(1752));try{rb.top.location.href=cc}catch(Dc){Xd.ULS.sendTraceTag(538572820,
0,10,"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",Bh.a.fo,Dc),Xd.ULS.sendTraceTag(538572819,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),rb.location.replace(cc)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},function(cc){if("Cancelled"===cc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(rg.a.qCd,Mh.a.ga(1755));rb.close();na.CKj();return null})};
U.prototype.getTypeName=function(){return"Microsoft.ExcelServices.WacWorkbook"};U.prototype.invokePropertyGet=function(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};U.prototype.invokePropertyGetAsync=function(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)};U.prototype.invokePropertySet=function(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};U.prototype.invokePropertySetAsync=function(M,
na){this.invokePropertySet(M,na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};U.prototype.invokeMethod=function(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};U.prototype.invokeMethodAsync=function(M,na){switch(M){case 1:return this.I5g(na)}M=this.invokeMethod(M,na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)};U.prototype.I5g=function(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.createAndOpenWorkbook(M)};
U.prototype.CKj=function(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(rg.a.generalException,Mh.a.ga(1752));};Object(Dd.a)(U,"WacWorkbook",null,[]);var xh=b(260),Sf=b(954),fk=b(960);of.Object.defineProperties(O.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.ib}}});Object(Dd.a)(O,"RichApiPreviewExecutionContext",null,[]);var qj=b(24),Nj=b(1086),sg=b(36),rj=b(219),Vi=b(221),Oj=b(118),sj=b(12),ki=Vi.a;$k(L,ki);L.prototype.start=function(M,na){var Pa="<div class='"+
Oj.a.Zoh+" "+Jg.a.Mo+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+Oj.a.xC+"' /></div>";Pa=String.format(Pa,zh.a.yg(this.B5c.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");this.Hb.innerHTML=Pa;this.kpb=sj.DOMElementExtensions.getElementById(this.Hb,"bindingText");M=na?M.S2a(na,this.B5c.DdaBindingsMethod.BindingId):null;(null===M||void 0===M?0:M.IsValidRef)?(na=new qj.Range(M.Reference.FirstRow+1,M.Reference.FirstColumn+1,M.Reference.LastRow+
1,M.Reference.LastColumn+1,!1,!1),this.kpb.value=M.Reference.SheetName+"!"+na):(M=Hg.g(this.$).ha,this.kpb.value=bi.f(this.$.pa)||!M.sa.rg?"":M.lia);this.initialize();this.qf()};L.prototype.rn=function(){this.q0c();this.addButton(0);this.addButton(1);ki.prototype.rn.call(this)};L.prototype.setFocus=function(){sj.DOMElementExtensions.setFocus(this.kpb)};L.prototype.validate=function(){return!0};L.prototype.commit=function(){var M=this.kpb.value.trim(),na=M.indexOf("!");-1!==na&&(M=this.HYh(M.substring(0,
na))+M.substr(na));this.oGe.addBinding(this.B5c,M,0,this.callback);return!0};L.prototype.Asa=function(){this.oGe.iQ.kf(Sf.a.internalError,this.callback);ki.prototype.Asa.call(this)};L.prototype.HYh=function(M){M=yi.a.trimStart(M.trim(),"=");return M.length?M.startsWith("'")&&M.endsWith("'")?M:Zh.HelperMethods.A8b(M):""};of.Object.defineProperties(L.prototype,{mc:{configurable:!0,enumerable:!0,get:function(){return"DdaBindingPrompt"}}});Object(Dd.a)(L,"DdaBindingPrompt",Vi.a,[]);K.prototype.kf=function(M,
na){if(na){var Pa={};Pa.Error=M;Pa.Version=this.ea.Ke;na(Pa)}};K.prototype.RJa=function(M,na){this.kf(M,na)};K.prototype.ZG=function(M,na){this.kf(Sf.a.oVe(M.Errors[0].MessageId),na)};K.prototype.Nu=function(M){M&&M(this.QP())};K.prototype.QP=function(){var M={Error:0};M.Version=this.ea.Ke;return M};Object(Dd.a)(K,"DdaErrorGenerator",null,[]);var eh=b(299),Gi=b(95);I.prototype.pxd=function(M,na){function Pa(nd){var Id=rb.$.xa.getItemByName(nd.SheetName);(null===Id||void 0===Id?0:Id.visible)?(Hg.g(rb.$).hg(nd,
null,null,null,3,Gi.a.hdh,void 0,void 0,void 0,void 0,!0),rb.iQ.Nu(na)):rb.iQ.kf(Sf.a.lWg,na)}var rb=this,cc=M.DdaGoToByIdMethod.GoToType,Dc=M.DdaGoToByIdMethod.SelectionMode,Zc=M.DdaGoToByIdMethod.Id.toString().trim();0===cc?this.JDi(Zc,Dc,M.DdaMethod.ControlId,Pa,na):1===cc?this.NDi(Zc,Dc,Pa,na):this.iQ.kf(Sf.a.vRj,na)};I.prototype.JDi=function(M,na,Pa,rb,cc){var Dc=this;this.Vz.ddaGetBinding(Pa,M,function(Zc){if(!eh.a(Zc)&&Zc.Result&&Zc.Result.Reference){Zc=Zc.Result;var nd={};nd.SheetName=Zc.Reference.SheetName;
nd.FirstRow=Zc.Reference.FirstRow;nd.FirstColumn=Zc.Reference.FirstColumn;nd.LastRow=Zc.Reference.LastRow;nd.LastColumn=Zc.Reference.LastColumn;I.$Vc(nd,na);1!==Zc.BindingType?rb(nd):Dc.Vz.ddaGetBindingData(Pa,M,1,0,2,0,0,-1,-1,function(Id){eh.a(Id)||!Id.Result?Dc.iQ.ZG(Id,cc):(Id=Id.Result,2!==na&&(nd.FirstRow-=Id.Headers.length,0>nd.FirstRow&&(nd.FirstRow=0)),rb(nd))},cc)}else Dc.iQ.RJa(Sf.a.T5f,cc)},cc)};I.prototype.NDi=function(M,na,Pa,rb){var cc=this,Dc=ci.z(M);Dc?(Dc=ci.v(Dc,this.$),I.$Vc(Dc,
na),Pa(Dc)):this.$.ea.isNamedObjectViewMode&&this.$.vb.Mj(M)?this.$.vb.pa=this.$.vb.getItemByName(M):(Dc=function(Zc){eh.a(Zc)||!Zc.Result?cc.$.xa.contains(M)?(Zc={},Zc.SheetName=M,Zc.FirstRow=0,Zc.FirstColumn=0,Zc.LastRow=0,Zc.LastColumn=0,Pa(Zc)):cc.iQ.RJa(Sf.a.T5f,rb):(Zc=Zc.Result,I.$Vc(Zc,na),Pa(Zc))},this.$.xa.pa?this.Vz.parseRangeForGoto(M,this.$.xa.pa.name,Dc,rb):this.Vz.parseRange(M,Dc,rb))};I.$Vc=function(M,na){M.LastRow=2===na?M.FirstRow:M.LastRow;M.LastColumn=2===na?M.FirstColumn:M.LastColumn};
Object(Dd.a)(I,"DdaNavigator",null,[]);var tj=b(313),ri;(function(M){M[M.unsupported=0]="unsupported";M[M.surface=1]="surface";M[M.combo=2]="combo";M[M.column=3]="column";M[M.column3D=4]="column3D";M[M.bar=5]="bar";M[M.bar3D=6]="bar3D";M[M.line=7]="line";M[M.line3D=8]="line3D";M[M.pie=9]="pie";M[M.pie3D=10]="pie3D";M[M.scatter=11]="scatter";M[M.bubble=12]="bubble";M[M.area=13]="area";M[M.area3D=14]="area3D";M[M.doughnut=15]="doughnut";M[M.radar=16]="radar";M[M.stock=17]="stock";M[M.waterfall=18]=
"waterfall";M[M.funnel=19]="funnel";M[M.treemap=20]="treemap";M[M.sunburst=21]="sunburst";M[M.boxWhisker=22]="boxWhisker";M[M.histogram=23]="histogram";M[M.pareto=24]="pareto";M[M.regionMap=25]="regionMap";M[M.noVisibleSeries=26]="noVisibleSeries";M[M.complexDataSource=27]="complexDataSource";M[M.pivotChart=28]="pivotChart"})(ri||(ri={}));Object(Dd.b)("ChartCategory",ri);Object(Dd.a)(T,"MacroRecorderEventData",null,[]);N.prototype.ZWh=function(M){var na;if(void 0===M||null===M||void 0===M.RequestBody||
null===M.RequestBody)return null;var Pa=JSON.parse(M.RequestBody);if(void 0!==M.ActiveChartId&&null!==M.ActiveChartId){Pa.ActiveChartId=M.ActiveChartId;var rb=Hg.g(this.$).ha.Oa.Yb;if(null===(na=null===rb||void 0===rb?void 0:rb.floatingObject)||void 0===na?0:na.Pc)Pa.ActiveChartType=ri[rb.floatingObject.Pc.ChartCategory]}void 0!==M.SheetMultiRange&&null!==M.SheetMultiRange&&(Pa.SheetName=M.SheetMultiRange.SheetName);return Pa};N.prototype.lXh=function(M){if(void 0===M||null===M||void 0===M.Result||
null===M.Result)return null;M=M.Result;return void 0===M.ResponseBody||null===M.ResponseBody||M.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(M.ResponseBody.join(""))};N.prototype.Fmi=function(M){return!!M&&!(void 0===M.eventId||null===M.eventId)&&0<M.eventId.length};N.prototype.Zi=function(M){var na=this;return function(){if(na.$.Jba){var Pa=na.ySg(na.request);if(na.Fmi(Pa)){var rb=na.ZWh(na.request),cc=na.lXh(M);if(rb&&!Di.a.isEmpty(rb)&&cc&&!Di.a.isEmpty(cc))return Xd.ULS.sendTraceTag(537163164,
0,50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),new hh(Pa,rb,cc);Xd.ULS.sendTraceTag(537163163,0,50,"[RichApiRecorder]: Failed due to bad data: requestInfo: "+((rb?"(not null)":"(null)")+"; responseInfo: "+(cc?"(not null)":"(null)")))}}return new hh(null,null,null)}};N.prototype.ySg=function(M){var na=this.Gmi(M.SolutionId),Pa=N.GWh(M);if(Pa&&na)return na={},Xd.ULS.sendTraceTag(537163162,0,50,"[RichApiRecorder]["+this.parentName+"]: "+(na.recorderEventId=Pa,
na["request.SolutionId"]=M.SolutionId,na)),new T(M.SolutionId,Pa);var rb={};Xd.ULS.sendTraceTag(537163161,0,50,"[RichApiRecorder]["+this.parentName+"]: "+(rb.recorderEventId=Pa,rb.isRecorderAwareAddin=na,rb["request.SolutionId"]=M.SolutionId,rb));return null};N.prototype.Gmi=function(M){if(!M)return!1;M=M.toLowerCase();return N.F1h().contains(M)};N.F1h=function(){N.Iza||(N.Iza=new $f.a(mg.a.Jk()),N.Iza.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),N.Iza.add("fa000000005"),N.Iza.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),
N.Iza.add("fa000000014"),N.Iza.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));return N.Iza};N.GWh=function(M){var na=null,Pa=RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',"mi");if(Pa.test(M.RequestBody))na=Pa.exec(M.RequestBody)[1];else{M=M.RequestHeaders;if(!M)return na;Pa=ph.a.xGi.toLowerCase();for(var rb=0;rb<M.length;rb++)if(M[rb].Name.toLowerCase()===Pa){na=M[rb].Value;break}}return na};N.Iza=null;Object(Dd.a)(N,"DdaRichApiRequestRecorder",null,[]);var Pj=b(70),Hi=tj.a;
$k(S,Hi);S.prototype.T2=function(M){return Hi.prototype.T2.call(this,M)||this.hVg(M)};S.prototype.Zi=function(){return this.eMd.Zi(this.Wc)};S.prototype.Jeb=function(){var M={OperationType:3};M.RichApiRequest=this.request;return M};S.prototype.hVg=function(M){var na=this;return function(Pa,rb,cc){return G(M,na.request,Vf.b(Pa,na.fmb),Vf.a(rb,na.Bib),cc,na.B3)}};of.Object.defineProperties(S.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return af.EwaSettings.Zb()?Object(Pj.a)(S.prototype,
this,"operationWorkingState"):2}},HCc:{configurable:!0,enumerable:!0,get:function(){return this.sFa}},nt:{configurable:!0,enumerable:!0,get:function(){return this.fmb}},Baa:{configurable:!0,enumerable:!0,get:function(){return this.Bib}}});Object(Dd.a)(S,"DdaRichApiRequestBatchOperation",tj.a,[]);var uj=Wh.a;$k(J,uj);J.prototype.Zi=function(){return this.eMd.Zi(this.Wc)};of.Object.defineProperties(J.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return af.EwaSettings.Zb()?
Object(Pj.a)(J.prototype,this,"operationWorkingState"):0}}});Object(Dd.a)(J,"DdaRichApiRequestOperation",Wh.a,[]);F.prototype.ddaAddBinding=function(M,na,Pa,rb,cc,Dc,Zc){var nd=this;this.GJ(function(Id,Od,je){var Ae=nd.$.oa.va,Re=nd.xja();Id=Vf.b(Id,Dc);Od=Vf.a(Od,nd.WH);var Ke=Ae.Na(9);Ke.controlId=M;Ke.bindingId=na;Ke.bindingType=Pa;Ke.currentSheetName=Re;Ke.formula=rb;Ke.options=cc;return Kg.g(Ae,"DdaAddBinding",Ke,Id,Od,je,Zc,0)},Zc,563)};F.prototype.ddaReleaseBinding=function(M,na,Pa,rb){var cc=
this;this.GJ(function(Dc,Zc,nd){var Id=cc.$.oa.va;Dc=Vf.b(Dc,Pa);Zc=Vf.a(Zc,cc.WH);var Od=Id.Na(9);Od.controlId=M;Od.bindingId=na;return Kg.g(Id,"DdaReleaseBinding",Od,Dc,Zc,nd,rb,0)},rb,564)};F.prototype.ddaGetBinding=function(M,na,Pa,rb){var cc=this;this.GJ(function(Dc,Zc,nd){var Id=cc.$.oa.va;Dc=Vf.b(Dc,Pa);Zc=Vf.a(Zc,cc.WH);var Od=Id.Na(1);Od.controlId=M;Od.bindingId=na;return Kg.g(Id,"DdaGetBinding",Od,Dc,Zc,nd,rb,0)},rb,565,16)};F.prototype.ddaGetAllBindings=function(M,na,Pa){var rb=this;this.GJ(function(cc,
Dc,Zc){var nd=rb.$.oa.va;cc=Vf.b(cc,na);Dc=Vf.a(Dc,rb.WH);var Id=nd.Na(1);Id.controlId=M;return Kg.g(nd,"DdaGetAllBindings",Id,cc,Dc,Zc,Pa,0)},Pa,566,16)};F.prototype.ddaGetBindingData=function(M,na,Pa,rb,cc,Dc,Zc,nd,Id,Od,je){var Ae=this;this.GJ(function(Re,Ke,Ef){var ff=Ae.$.oa.va,xf=Ae.xja();Re=Vf.b(Re,Od);Ke=Vf.a(Ke,Ae.WH);var yf=ff.Na(1);yf.controlId=M;yf.bindingId=na;yf.coerceType=Pa;yf.valueFormat=rb;yf.filterType=cc;yf.startRow=Dc;yf.startCol=Zc;yf.rowCount=nd;yf.colCount=Id;yf.currentSheetName=
xf;return Kg.g(ff,"DdaGetBindingData",yf,Re,Ke,Ef,je,0)},je,567,16)};F.prototype.ddaSetBindingData=function(M,na,Pa,rb,cc,Dc,Zc){var nd=this;this.GJ(function(Id,Od,je){var Ae=nd.$.oa.va,Re=nd.xja();Id=Vf.b(Id,Dc);Od=Vf.a(Od,nd.WH);var Ke=Ae.Na(9);Ke.controlId=M;Ke.bindingId=na;Ke.startRow=Pa;Ke.startCol=rb;Ke.currentSheetName=Re;Ke.bindingData=cc;return Kg.g(Ae,"DdaSetBindingData",Ke,Id,Od,je,Zc,0)},Zc,568)};F.prototype.ddaGetSelectedData=function(M,na,Pa,rb,cc,Dc,Zc){var nd=this;this.GJ(function(Id,
Od,je){var Ae=nd.$.oa.va,Re=nd.xja();Id=Vf.b(Id,Dc);Od=Vf.a(Od,nd.WH);var Ke=Ae.Na(1);Ke.controlId=M;Ke.coerceType=na;Ke.valueFormat=Pa;Ke.filterType=rb;Ke.currentSheetName=Re;Ke.formula=cc;return Kg.g(Ae,"DdaGetSelectedData",Ke,Id,Od,je,Zc,0)},Zc,569,16)};F.prototype.ddaSetSelectedData=function(M,na,Pa,rb,cc){var Dc=this;this.GJ(function(Zc,nd,Id){var Od=Dc.$.oa.va,je=Dc.xja();Zc=Vf.b(Zc,rb);nd=Vf.a(nd,Dc.WH);var Ae=Od.Na(9);Ae.controlId=M;Ae.currentSheetName=je;Ae.formula=na;Ae.bindingData=Pa;return Kg.g(Od,
"DdaSetSelectedData",Ae,Zc,nd,Id,cc,0)},cc,570)};F.prototype.ddaLoadSettings=function(M,na,Pa){var rb=this;this.GJ(function(cc,Dc,Zc){var nd=rb.$.oa.va;cc=Vf.b(cc,na);Dc=Vf.a(Dc,rb.WH);var Id=nd.Na(1);Id.controlId=M;return Kg.g(nd,"DdaLoadSettings",Id,cc,Dc,Zc,Pa,0)},Pa,501,16)};F.prototype.ddaSaveSettings=function(M,na,Pa,rb,cc){var Dc=this;this.GJ(function(Zc,nd,Id){var Od=Dc.$.oa.va;Zc=Vf.b(Zc,rb);nd=Vf.a(nd,Dc.WH);var je=Od.Na(9);je.controlId=M;je.settings=na;je.overwriteIfStale=Pa;return Kg.g(Od,
"DdaSaveSettings",je,Zc,nd,Id,cc,0)},cc,571)};F.prototype.ddaAddRowsColumns=function(M,na,Pa,rb,cc,Dc){var Zc=this;this.GJ(function(nd,Id,Od){var je=Zc.$.oa.va,Ae=Zc.xja();nd=Vf.b(nd,cc);Id=Vf.a(Id,Zc.WH);var Re=je.Na(9);Re.controlId=M;Re.bindingId=na;Re.isRow=Pa;Re.currentSheetName=Ae;Re.bindingData=rb;return Kg.g(je,"DdaAddRowsColumns",Re,nd,Id,Od,Dc,0)},Dc,572)};F.prototype.ddaDeleteAllDataValues=function(M,na,Pa,rb){var cc=this;this.GJ(function(Dc,Zc,nd){var Id=cc.$.oa.va,Od=cc.xja();Dc=Vf.b(Dc,
Pa);Zc=Vf.a(Zc,cc.WH);var je=Id.Na(9);je.controlId=M;je.bindingId=na;je.currentSheetName=Od;return Kg.g(Id,"DdaDeleteAllDataValues",je,Dc,Zc,nd,rb,0)},rb,573)};F.prototype.ddaClearBindingFormats=function(M,na,Pa,rb){var cc=this;this.GJ(function(Dc,Zc,nd){var Id=cc.$.oa.va,Od=cc.xja();Dc=Vf.b(Dc,Pa);Zc=Vf.a(Zc,cc.WH);var je=Id.Na(9);je.controlId=M;je.bindingId=na;je.currentSheetName=Od;return Kg.g(Id,"DdaClearBindingFormats",je,Dc,Zc,nd,rb,0)},rb,574)};F.prototype.ddaSetBindingFormats=function(M,na,
Pa,rb,cc,Dc){var Zc=this;this.GJ(function(nd,Id,Od){var je=Zc.$.oa.va,Ae=Zc.xja();nd=Vf.b(nd,cc);Id=Vf.a(Id,Zc.WH);var Re=je.Na(9);Re.controlId=M;Re.bindingId=na;Re.currentSheetName=Ae;Re.bindingData=Pa;Re.isSetFormats=rb;return Kg.g(je,"DdaSetBindingFormats",Re,nd,Id,Od,Dc,0)},Dc,575)};F.prototype.parseRange=function(M,na,Pa){var rb=this;this.GJ(function(cc,Dc,Zc){var nd=rb.$.oa.va.Pb();return Kg.w(rb.$.oa.va,M,-1,Vf.b(cc,na),Vf.a(Dc,rb.WH),Zc,Pa,nd)},Pa,162,16)};F.prototype.parseRangeForGoto=function(M,
na,Pa,rb){var cc=this;this.GJ(function(Dc,Zc,nd){var Id=cc.$.oa.va.Pb();return Kg.x(cc.$.oa.va,M,na,Vf.b(Dc,Pa),Vf.a(Zc,cc.WH),nd,rb,Id)},rb,562,16)};F.prototype.executeRichApiRequest=function(M,na,Pa){var rb=this;af.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(M.RequestFlags&=8191);if(af.EwaSettings.ma(259))this.Ayh(this.$.oa.va.Pb(),na,function(){rb.iQ.RJa(Sf.a.internalError,Pa)},Pa,M);else{var cc=dh.DdaFacade.Cfd(M);!af.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||
!this.$.ob.pz||cc&16?(af.EwaSettings.Zb()&&(cc|=64),this.$.userOperationManager.Rt(new J(this.$,M,function(Dc,Zc,nd){return G(rb.$.oa.va,M,Vf.b(Dc,na),Vf.a(Zc,rb.WH),nd,Pa)},cc))):(this.iQ.RJa(Sf.a.EDc,Pa),Xd.ULS.sendTraceTag(537163160,0,50,"Write operation is not allowed"))}};F.prototype.xja=function(){return this.$.ea.isNamedObjectViewMode?this.$.pa.sheetName:this.$.activeItemName};F.prototype.GJ=function(M,na,Pa,rb){rb=void 0===rb?0:rb;!af.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||
!this.$.ob.pz||rb&16?af.EwaSettings.Zb()?this.$.userOperationManager.Rt(new Wh.a(Pa,0,M,rb|64)):this.$.userOperationManager.Rt(new ji.a(Pa,0,M,rb)):(this.iQ.RJa(Sf.a.EDc,na),Xd.ULS.sendTraceTag(537163159,0,50,"Write operation is not allowed"))};F.prototype.Ayh=function(M,na,Pa,rb,cc){var Dc=dh.DdaFacade.Cfd(cc);if(!af.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.ob.pz||Dc&16){var Zc=this.$.Fb.sc("UserAction","Rich Api request");af.EwaSettings.Zb()&&
(Dc|=64);this.$.userOperationManager.Sb(new S(this.$,M,na,Pa,rb,Zc,cc,Dc),null)}else this.iQ.RJa(Sf.a.EDc,rb),Xd.ULS.sendTraceTag(537163158,0,50,"Write operation is not allowed")};Object(Dd.a)(F,"DdaWebServiceHelper",null,[]);Object(Dd.a)(H,"DocumentFile",null,[]);D.generalException="GeneralException";D.QKg="ApiNotFound";D.qCd="OperationCancelled";D.invalidArgument="InvalidArgument";Object(Dd.a)(D,"ErrorCodes",null,[]);w.prototype.replaceShortcuts=function(){return Promise.reject("ReplaceShortcuts method is not overridden")};
w.prototype.getShortcuts=function(){return Promise.reject("GetShortcuts method is not overridden")};w.prototype.checkShortcutsInUse=function(){return Promise.reject("CheckShortcutsInUse method is not overridden")};Object(Dd.a)(w,"WacApiDelegates",null,[]);var vj=b(721);$k(y,w);y.prototype.replaceShortcuts=function(M){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,M,this.nhf)};y.prototype.getShortcuts=function(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)};
y.prototype.checkShortcutsInUse=function(M){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(M,this.nhf)};y.F8g=function(M,na){var Pa=document.createEvent("KeyboardEvent");if(Bh.a.eF)Pa.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,!!(M&8),!!(M&32),!!(M&4),!!(M&256));else{var rb=[];M&4&&rb.push("Shift");M&8&&rb.push("Control");M&32&&rb.push("Alt");Pa.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,rb.join(" "),!1,"en-US")}M=new Sys.UI.DomEvent(Pa);M.keyCode=na;return M};y.e4g=
function(M,na){if(Bh.a.Pf)switch(na){case 189:na=173;break;case 187:na=61;break;case 186:na=59}return y.F8g(M,na)};Object(Dd.a)(y,"ExcelWacApiDelegates",w,[]);z.prototype.fCg=function(M,na){this.Idc(M)||(this.GIa[M]={});if(this.Uhi(M))return Xd.ULS.sendTraceTag(537163157,344,50,"App "+M+" has reach the limit of number of cached files."),Sf.a.fBi;this.GIa[M][na.oAh.toString()]=na;return Sf.a.success};z.prototype.nOh=function(M,na){var Pa=null;this.Idc(M)&&(Pa=this.GIa[M][na.toString()]);Pa||Xd.ULS.sendTraceTag(537163156,
344,15,"File cache for [agave:"+M+", fileHandler:"+na+"] doesn't exist");return Pa};z.prototype.Idc=function(M){return M in this.GIa};z.prototype.aaj=function(M,na){if(this.Idc(M)){var Pa=this.GIa[M];delete Pa[na.toString()];1>Object.keys(Pa).length&&delete this.GIa[M];return na.toString()in Pa?Sf.a.internalError:Sf.a.success}return Sf.a.internalError};z.prototype.Uhi=function(M){return this.Idc(M)?Object.keys(this.GIa[M]).length>=this.zAi:!1};z.getInstance=function(M){return M.da.za(200)||M.da.Ga(200,
new z(z.AAi))};z.xEi=function(){return++z.vUg};z.eAi=4194304;z.AAi=1;z.vUg=0;Object(Dd.a)(z,"GetFileApiHelper",null,[]);A.prototype.notifyActionHandlerReady=function(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.hA)};A.prototype.getTypeName=function(){return"Microsoft.InternalService.AddinInternalService"};A.prototype.invokePropertyGet=function(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};A.prototype.invokePropertyGetAsync=function(M){M=this.invokePropertyGet(M);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)};A.prototype.invokePropertySet=function(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};A.prototype.invokePropertySetAsync=function(M,na){this.invokePropertySet(M,na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};A.prototype.invokeMethod=function(M){switch(M){case 1:return this.dFi()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};A.prototype.invokeMethodAsync=
function(M,na){M=this.invokeMethod(M,na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)};A.prototype.dFi=function(){this.notifyActionHandlerReady();return null};Object(Dd.a)(A,"AddinInternalService",null,[]);u.prototype.getAppRuntimeState=function(){return this.GI.getAppRuntimeState(this.hA)?2:1};u.prototype.setAppRuntimeState=function(M){switch(M){case 2:M=!0;break;case 1:M=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException(rg.a.invalidArgument,
Mh.a.ga(1756));}this.GI.setAppRuntimeState(this.hA,M)};u.prototype.getTypeName=function(){return"Microsoft.AppRuntime.AppRuntimeService"};u.prototype.invokePropertyGet=function(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};u.prototype.invokePropertyGetAsync=function(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)};u.prototype.invokePropertySet=function(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
};u.prototype.invokePropertySetAsync=function(M,na){this.invokePropertySet(M,na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};u.prototype.invokeMethod=function(M,na){switch(M){case 2:return this.tJh();case 1:return this.Upj(na)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};u.prototype.invokeMethodAsync=function(M,na){M=this.invokeMethod(M,na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)};u.prototype.tJh=function(){return this.getAppRuntimeState()};
u.prototype.Upj=function(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"int");this.setAppRuntimeState(M);return null};Object(Dd.a)(u,"AppRuntimeService",null,[]);var Wi=b(1185);l.prototype.disable=function(){try{if(!Mh.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.bDe();if(!this.Kgf())return this.cDe();this.D1.DQj(this.$w)}catch(M){return Xd.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",
M.message||"Unknown"),this.$Ce()}return null};l.prototype.enable=function(){try{if(!Mh.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.bDe();if(!this.Kgf())return this.cDe();this.D1.a9i(this.$w)}catch(M){return Xd.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",M.message||"Unknown"),this.$Ce()}return null};l.prototype._OnAccess=function(){};l.prototype.getTypeName=function(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"};
l.prototype.invokePropertyGet=function(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};l.prototype.invokePropertyGetAsync=function(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)};l.prototype.invokePropertySet=function(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};l.prototype.invokePropertySetAsync=function(M,na){this.invokePropertySet(M,na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
l.prototype.invokeMethod=function(M){switch(M){case 1:return this.wCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};l.prototype.invokeMethodAsync=function(M,na){switch(M){case 3:return this.Mgh();case 2:return this.Hlh()}M=this.invokeMethod(M,na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)};l.prototype.Mgh=function(){return this.disable()};l.prototype.Hlh=function(){return this.enable()};l.prototype.wCa=function(){this._OnAccess();return null};
l.prototype.bDe=function(){return Wi.a(rg.a.notImplemented,Mh.a.ga(1757))};l.prototype.cDe=function(){return Wi.a(rg.a.sharedRuntimeNotAvailable,Mh.a.ga(1761))};l.prototype.$Ce=function(){return Wi.a(rg.a.generalException,Mh.a.ga(1752))};l.prototype.Kgf=function(){var M=this.Cy.getSharedRuntimeId();return!!M&&0<M.length};Object(Dd.a)(l,"BeforeDocumentCloseNotification",null,[]);x.prototype.getTypeName=function(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"};x.prototype.invokePropertyGet=
function(M){switch(M){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};x.prototype.invokePropertyGetAsync=function(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)};x.prototype.invokePropertySet=function(M,na){switch(M){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(na,0,"boolean");return;case 3:this.nativeRuntime=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(na,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(na,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};x.prototype.invokePropertySetAsync=function(M,na){this.invokePropertySet(M,na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};x.prototype.invokeMethod=function(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
};x.prototype.invokeMethodAsync=function(M,na){M=this.invokeMethod(M,na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)};of.Object.defineProperties(x.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return this.dA},set:function(M){this.dA=M}},nativeRuntime:{configurable:!0,enumerable:!0,get:function(){return this.Lbe},set:function(M){this.Lbe=M}},streamingEnabled:{configurable:!0,enumerable:!0,get:function(){return this.Che},set:function(M){this.Che=M}}});Object(Dd.a)(x,
"CustomFunctionEngineStatus",null,[]);m.prototype.register=function(M){return OfficeExtension.WacRuntime.Utility.createPromise(this.Mvg(M))};m.prototype.getTypeName=function(){return"Microsoft.ExcelServices.CustomFunctionManager"};m.prototype.invokePropertyGet=function(M){switch(M){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};m.prototype.invokePropertyGetAsync=function(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)};
m.prototype.invokePropertySet=function(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};m.prototype.invokePropertySetAsync=function(M,na){this.invokePropertySet(M,na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};m.prototype.invokeMethod=function(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};m.prototype.invokeMethodAsync=function(M,na){switch(M){case 1:return this.S9i(na)}M=this.invokeMethod(M,na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)};
m.prototype.S9i=function(M){var na=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,1,"string");return this.register(na,M)};of.Object.defineProperties(m.prototype,{status:{configurable:!0,enumerable:!0,get:function(){var M=new x;M.enabled=this.Drg;M.streamingEnabled=this.Erg;M.nativeRuntime=!1;return M}}});Object(Dd.a)(m,"CustomFunctionManager",null,[]);var Qj=b(1164);v.prototype._RegisterStateChange=function(){var M=
this;this.ZSb||this.VO.execute(function(na){M.U2d=na.Lma(M._id,function(Pa){M.GI.sCh(M.hA,M._id,JSON.stringify(Pa))})});this.ZSb++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};v.prototype._UnregisterStateChange=function(){var M=this;this.ZSb--;this.ZSb||this.VO.execute(function(na){na.BId(M._id,M.U2d)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};v.prototype.getTypeName=function(){return"Microsoft.Office.Licensing.LicenseFeature"};v.prototype.invokePropertyGet=
function(M){switch(M){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};v.prototype.invokePropertyGetAsync=function(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)};v.prototype.invokePropertySet=function(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};v.prototype.invokePropertySetAsync=function(M,na){this.invokePropertySet(M,na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
v.prototype.invokeMethod=function(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};v.prototype.invokeMethodAsync=function(M,na){switch(M){case 6:return this.Skg();case 7:return this.Ukg()}M=this.invokeMethod(M,na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)};v.prototype.Skg=function(){return this._RegisterStateChange()};v.prototype.Ukg=function(){return this._UnregisterStateChange()};of.Object.defineProperties(v.prototype,{id:{configurable:!0,enumerable:!0,
get:function(){return this._id}}});Object(Dd.a)(v,"LicenseFeature",null,[]);f.prototype.getFeatureTier=function(M,na){var Pa=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(rb){var cc=1===na?1:2===na?2:0;Pa.VO.execute(function(Dc){Dc.getFeatureTier(M,cc).then(function(Zc){rb(Pa.ySh(Zc))},function(){rb(na)})})})};f.prototype.getLicenseFeature=function(M){M=new v(this.VO,M,this.hA,this.GI);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)};f.prototype.isFeatureEnabled=
function(M,na){var Pa=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(rb){Pa.VO.execute(function(cc){cc.isFeatureEnabled(M,na).then(function(Dc){rb(Dc)},function(){rb(na)})})})};f.prototype.isFreemiumUpsellEnabled=function(){var M=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(na){M.VO.execute(function(Pa){Pa=Pa.isFreemiumUpsellEnabled();na(Pa)})})};f.prototype.launchUpsellExperience=function(M){var na=this;if(this.yug.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(function(){na.VO.execute(function(Pa){Pa.launchUpsellExperience(M)})});
throw OfficeExtension.WacRuntime.Utility.createRichApiException(rg.a.qTc,"");};f.prototype._TestFireStateChangedEvent=function(){};f.prototype.getTypeName=function(){return"Microsoft.Office.Licensing.License"};f.prototype.invokePropertyGet=function(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};f.prototype.invokePropertyGetAsync=function(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)};f.prototype.invokePropertySet=function(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
};f.prototype.invokePropertySetAsync=function(M,na){this.invokePropertySet(M,na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};f.prototype.invokeMethod=function(M,na){switch(M){case 6:return this.Tkg(na)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};f.prototype.invokeMethodAsync=function(M,na){switch(M){case 2:return this.hPh(na);case 5:return this.xSh(na);case 1:return this.Hii(na);case 3:return this.nji();case 4:return this.Rsi(na)}M=this.invokeMethod(M,
na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)};f.prototype.hPh=function(M){var na=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,1,"int");return this.getFeatureTier(na,M)};f.prototype.xSh=function(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.getLicenseFeature(M)};f.prototype.Hii=function(M){var na=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,
0,"string");M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,1,"boolean");return this.isFeatureEnabled(na,M)};f.prototype.nji=function(){return this.isFreemiumUpsellEnabled()};f.prototype.Rsi=function(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.launchUpsellExperience(M)};f.prototype.Tkg=function(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");this._TestFireStateChangedEvent(M);return null};f.prototype.ySh=function(M){switch(M){case 1:return 1;
case 2:return 2;default:return 0}};Object(Dd.a)(f,"License",null,[]);var Rj=b(159);k.prototype.areShortcutsInUse=function(M){var na=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Pa,rb){na.Evd.checkShortcutsInUse(M).then(function(cc){Pa(cc)}).catch(function(cc){rb(cc)})})};k.prototype.getShortcuts=function(){var M=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(na,Pa){M.Evd.getShortcuts().then(function(rb){na(rb)}).catch(function(rb){Pa(rb)})})};k.prototype.replaceShortcuts=
function(M){var na=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Pa,rb){na.Evd.replaceShortcuts(M).then(function(){Pa(null)}).catch(function(cc){rb(cc)})})};k.prototype.getTypeName=function(){return"Microsoft.Office.ActionService"};k.prototype.invokePropertyGet=function(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};k.prototype.invokePropertyGetAsync=function(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)};
k.prototype.invokePropertySet=function(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};k.prototype.invokePropertySetAsync=function(M,na){this.invokePropertySet(M,na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};k.prototype.invokeMethod=function(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};k.prototype.invokeMethodAsync=function(M,na){switch(M){case 3:return this.zMg(na);case 1:return this.MYh();case 2:return this.xfj(na)}M=
this.invokeMethod(M,na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)};k.prototype.zMg=function(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"Array<string>");return this.areShortcutsInUse(M)};k.prototype.MYh=function(){return this.getShortcuts()};k.prototype.xfj=function(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"any");return this.replaceShortcuts(M)};Object(Dd.a)(k,"ActionService",null,[]);var gk=b(575);h.prototype.yYh=function(){this.qra||
(this.qra=gk.a.Kq(Xg.a.instance.Tb("Common.App.SharedFilePicker.ISharedFilePicker")));return this.qra};h.prototype.getSharedFilePickerResponse=function(M){var na=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Pa,rb){try{var cc=na.yYh();Kh.Task.WAA.call(null,cc).continueWith(function(){var Dc=cc.result;if(Dc){var Zc={};(function(){var nd=Jh.d(M);Zc=nd.Ot;return nd})().returnValue?Dc.fed(Zc).then(function(nd){nd&&0<nd.length?Pa(nd):rb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",
"The picker returned null or an empty array."))}).catch(function(nd){rb(nd)}):rb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else rb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker is resolved as null."))})}catch(Dc){rb(Dc)}})};h.prototype.getTypeName=function(){return"Microsoft.Office.SharedFilePicker"};h.prototype.invokePropertyGet=function(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
};h.prototype.invokePropertyGetAsync=function(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)};h.prototype.invokePropertySet=function(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);};h.prototype.invokePropertySetAsync=function(M,na){this.invokePropertySet(M,na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};h.prototype.invokeMethod=function(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
};h.prototype.invokeMethodAsync=function(M,na){switch(M){case 1:return this.xYh(na)}M=this.invokeMethod(M,na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)};h.prototype.xYh=function(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.getSharedFilePickerResponse(M)};Object(Dd.a)(h,"SharedFilePicker",null,[]);e.prototype.createInstance=function(M,na){switch(M){case "Microsoft.Office.ActionService":return new k(na);case "Microsoft.Office.SharedFilePicker":return new h}return null};
Object(Dd.a)(e,"WacApiHost",null,[]);d.prototype.hostName=function(){return"ExcelOnline"};d.prototype.appId=function(){return this.fRb};d.prototype.createInstance=function(M){switch(M){case "Microsoft.Authentication.AuthenticationService":return Xg.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").create(this.hA,this.GI.Th);case "Microsoft.Authentication.TokenParameters":return new ya;case "Microsoft.ExcelServices.CustomFunctionManager":M=this.ib.ma(122);
var na=this.ib.ma(123);return new m(M,na,n(this.fRb,this.ib,this.GI));case "Microsoft.AppRuntime.AppRuntimeService":return new u(this.hA,this.GI);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return M=xh.a(this.ib),new l(this.fRb,this.hA,M,this.GI);case "Microsoft.DynamicRibbon.DynamicRibbon":return M=xh.a(this.ib),new Qj.DynamicRibbon(this.fRb,this.hA,this.GI,M,M.Tm(this.hA).el);case "Microsoft.Office.Licensing.License":return new f(this.hA,this.GI);case "Microsoft.InternalService.AddinInternalService":return new A(this.hA);
default:if(this.YSc||(this.YSc=new e),na=this.YSc.createInstance(M,this.Qzg))return na}Xd.ULS.sendTraceTag(537163155,0,10,"Typename: "+M+" is an invalid parameter for the RichApiHost.CreateInstance method.");throw OfficeExtension.WacRuntime.Utility.createRichApiException(rg.a.generalException,rg.a.generalException);};Object(Dd.a)(d,"RichApiHost",null,[]);var Sj=b(413),Xi=b(28),wj=b(119),Yi=b(34),xj=b(101),Zi=b(301),Y=b(43),Ga=b(261),sb=b(6),ac=b(68),Kc=b(210);c.prototype.dispose=function(){this.$=
this.F9b=null};c.prototype.Nc=function(){return!1};c.prototype.Tc=function(){return!1};c.prototype.executeCommand=function(M,na,Pa){M=na.command;switch(M){case 451041795:this.re.kf(Pa[ch.a.Wf],Pa[ch.a.B3]);break;case 974713501:this.j4h(Pa[ch.a.Wf],Pa[ch.a.B3]);break;case 1237877382:this.re.Nu(Pa[ch.a.B3]);break;default:return Mi.a(M)}return Kh.Task.Ua(!0)};c.prototype.Ac=function(M,na,Pa){if(M=!!Pa)switch(na.command){case 974713501:case 1237877382:case 451041795:break;default:M=!1}return M};c.prototype.j4h=
function(M,na){var Pa,rb=M.DdaMethod;if("undefined"===typeof rb.DispatchId)this.re.kf(Sf.a.internalError,na);else if(c.Nhi(M)||this.$.Bd&1){if(rb.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(new L(this.$,this,M,na)).start(this.se,M.DdaMethod.ControlId):rb.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.YXh(M,na):rb.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.puj(M,na):rb.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?
this.addBinding(M,this.Edd(M.DdaMethod.ControlId),0,na):rb.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.bKh(M,na):rb.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.eqj(M,na):rb.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.aKh(M,na):rb.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?this.$$i(M,na):rb.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.YIh(M,na):rb.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?
this.Htd(M,na):rb.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(M,na):rb.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(M.DdaAddRowsColumns.IsRow=!0,this.nme(M,na)):rb.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(M.DdaAddRowsColumns.IsRow=!1,this.nme(M,na)):rb.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?this.weh(M,na):rb.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.eZg(M,na):rb.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?
(M.DdaSetBindingFormats.IsSetFormats=!0,this.VYf(M,na)):rb.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(M.DdaSetBindingFormats.IsSetFormats=!1,this.VYf(M,na)):rb.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(M,M.DdaBindingsMethod.ItemName,M.DdaBindingsMethod.FailOnCollision?2:1,na):rb.DispatchId===OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.lPh(na):rb.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.pxd(M,na):rb.DispatchId===
OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(M,na):rb.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.kOh(M,na):rb.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.lOh(M,na):rb.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.baj(M,na):rb.DispatchId===OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(M.DdaMethod.ControlId,M),this.re.Nu(na)):
rb.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?af.EwaSettings.ma(24)?this.re.kf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,na):this.BBi(M,na):rb.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?af.EwaSettings.ma(24)?this.re.kf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,na):this.xBi(M,na):rb.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(M,na):rb.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?
this.getAuthContext(M,na):this.re.kf(Sf.a.uCd,na),af.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&rb.DispatchId!==OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod){M=this.se.pZ(M.DdaMethod.ControlId);na="";if(M){na=dh.DdaFacade.getSolutionId(M,this.$);var cc=M.PrimaryMarketplace.MarketplaceType;cc===OSF.StoreType.InMemory?M.OwnerAddinSolutionId&&M.AssetMarketplace&&(cc=M.AssetMarketplace.MarketplaceType):cc===OSF.StoreType.WopiCatalog&&(cc=OSF.StoreType.OMEX);
na=Telemetry.PrivacyRules.GetPrivacyCompliantId(na,cc,null===(Pa=M.AssetMarketplace)||void 0===Pa?void 0:Pa.SolutionId,null,null,M.PrimaryMarketplace.MarketplaceRef)}Xd.ULS.sendTraceTag(537163224,344,50,"DDA method Id: "+rb.DispatchId+", AppID: "+na)}}else this.re.kf(Sf.a.eJe,na)};c.prototype.bKh=function(M,na){var Pa=this;M.DdaGetBindingData.CoerceType=c.p3b(M.DdaGetBindingData.CoerceType);M.DdaGetBindingData.FilterType=c.YSe(M.DdaGetBindingData.FilterType);M.DdaGetBindingData.ValueFormat=c.Zfg(M.DdaGetBindingData.ValueFormat);
if(this.Nic(M.DdaGetBindingData.CoerceType,na)){if(M.DdaGetBindingData){var rb=M.DdaGetBindingData;0===rb.FilterType&&(rb.FilterType=2);rb.StartCol|=0;rb.StartRow|=0;rb.ColCount=void 0===rb.ColCount?-1:rb.ColCount;rb.RowCount=void 0===rb.RowCount?-1:rb.RowCount}this.Vz.ddaGetBindingData(M.DdaMethod.ControlId,M.DdaGetBindingData.BindingId,M.DdaGetBindingData.CoerceType,M.DdaGetBindingData.ValueFormat,M.DdaGetBindingData.FilterType,M.DdaGetBindingData.StartRow,M.DdaGetBindingData.StartCol,M.DdaGetBindingData.RowCount,
M.DdaGetBindingData.ColCount,function(cc){if(eh.a(cc)||!cc.Result)Pa.re.ZG(cc,na);else{var Dc=Pa.re.QP();Dc.Data=c.Gue(cc.Result);na(Dc)}},na)}};c.prototype.eqj=function(M,na){var Pa=this;M.DdaSetBindingData.CoerceType=c.p3b(M.DdaSetBindingData.CoerceType);if(this.Nic(M.DdaSetBindingData.CoerceType,na)){var rb=c.OYc(M.DdaSetBindingData.CoerceType,M.DdaSetBindingData.Data);c.Qfc(rb)?this.re.kf(Sf.a.tBc,na):(1===rb.CoerceType&&(rb.CellFormat||(rb.CellFormat=M.DdaSetBindingData.CellFormat),rb.TableOptions||
(rb.TableOptions=M.DdaSetBindingData.TableOptions)),M.DdaSetBindingData&&(M.DdaSetBindingData.StartCol|=0,M.DdaSetBindingData.StartRow|=0),this.Vz.ddaSetBindingData(M.DdaMethod.ControlId,M.DdaSetBindingData.BindingId,M.DdaSetBindingData.StartRow,M.DdaSetBindingData.StartCol,rb,function(cc){eh.a(cc)?Pa.re.ZG(cc,na):Pa.re.Nu(na)},na))}};c.prototype.YXh=function(M,na){var Pa=this;M.DdaGetBindingData.CoerceType=c.p3b(M.DdaGetBindingData.CoerceType);M.DdaGetBindingData.ValueFormat=c.Zfg(M.DdaGetBindingData.ValueFormat);
M.DdaGetBindingData.FilterType=c.YSe(M.DdaGetBindingData.FilterType);if(this.Nic(M.DdaGetBindingData.CoerceType,na)){var rb=this.Edd(M.DdaMethod.ControlId);rb?this.Vz.ddaGetSelectedData(M.DdaMethod.ControlId,M.DdaGetBindingData.CoerceType,M.DdaGetBindingData.ValueFormat,M.DdaGetBindingData.FilterType,rb,function(cc){if(eh.a(cc))Pa.re.ZG(cc,na);else{var Dc=Pa.re.QP();Dc.Data=c.Gue(cc.Result);na(Dc)}},na):this.re.kf(Sf.a.m2e,na)}};c.prototype.kOh=function(M,na){var Pa=this,rb=M[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],
cc=M[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],Dc=M.DdaMethod.ControlId,Zc=z.getInstance(this.$);if(0>=cc)Xd.ULS.sendTraceTag(537163221,344,15,"Invalid slice size. It should be greater than 0."),this.re.kf(Sf.a.tei,na);else if(cc>z.eAi)Xd.ULS.sendTraceTag(537163220,344,15,"Invalid slice size. It should be not greater than 4MB."),this.re.kf(Sf.a.xYe,na);else{var nd=null;switch(rb){case 1:nd="Compressed";break;case 0:nd="Text";break;case 2:nd="Pdf";break;default:Xd.ULS.sendTraceTag(537163219,
344,15,"Requested file type "+rb+" is not supported.");this.re.kf(Sf.a.MSe,na);return}if("Text"===nd)Xd.ULS.sendTraceTag(537163218,344,15,"Requested file type "+nd+" is not supported."),this.re.kf(Sf.a.MSe,na);else{af.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?(M=new Sys.StringBuilder,M.append(Nj.a(this.$,nd)),"Pdf"===nd&&rj.a.Rg(M,ph.a.bGd,"WholeWorkbook"),M=M.toString()):M=Nj.a(this.$,nd);var Id=null,Od=new XMLHttpRequest;Od.onreadystatechange=function(){if(4===
Od.readyState)if(200===Od.status){var je=Od.response;if(je){Id=new Uint8Array(je);je=Pa.re.QP();for(var Ae=Id.length,Re=z.xEi(),Ke={},Ef=0,ff=0;ff<Ae;ff+=cc){for(var xf=[],yf=ff+cc<Ae?ff+cc:Ae,Wf=0,Nf=ff;Nf<yf;Wf++,Nf++)xf[Wf]=Id[Nf];Ke[(Ef++).toString()]=xf}Ke=new H(Re,Ae,cc,Ke);Ke=Zc.fCg(Dc,Ke);Ke!==Sf.a.success?Pa.re.kf(Ke,na):(je[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=Re,je[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=Ae,Xd.ULS.sendTraceTag(537163216,
344,50,"GetFileAsync get file successfully for file type "+nd+", the file size is "+Ae),na(je))}else Xd.ULS.sendTraceTag(537163217,344,15,"Request is successful, but respone have no data for file type "+nd+"."),Pa.re.kf(Sf.a.internalError,na)}else 500===Od.status?Pa.re.kf(Sf.a.oVe(parseInt(Od.statusText,10)),na):(Xd.ULS.sendTraceTag(537163215,344,15,"Request failed to obtain the file for type "+nd+"."),Pa.re.kf(Sf.a.dEi,na))};Od.open("GET",M,!0);Od.responseType="arraybuffer";Od.setRequestHeader("If-Modified-Since",
"0");Od.send(null)}}};c.prototype.lOh=function(M,na){var Pa=M[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],rb=M[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];M=M.DdaMethod.ControlId;(Pa=z.getInstance(this.$).nOh(M,Pa))?(Pa=Pa.TDj,0>rb||rb>=Object.keys(Pa).length?this.re.kf(Sf.a.Z9h,na):(rb=Pa[rb.toString()],Pa=this.re.QP(),Pa[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=rb,Pa[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=rb.length,na(Pa))):
this.re.kf(Sf.a.internalError,na)};c.prototype.baj=function(M,na){var Pa=M[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];M=M.DdaMethod.ControlId;Pa=z.getInstance(this.$).aaj(M,Pa);Pa===Sf.a.success?this.re.Nu(na):this.re.kf(Pa,na)};c.prototype.puj=function(M,na){var Pa=this;M.DdaSetBindingData.CoerceType=c.p3b(M.DdaSetBindingData.CoerceType);if(this.Nic(M.DdaSetBindingData.CoerceType,na)){var rb=this.Edd(M.DdaMethod.ControlId);if(rb){var cc=c.OYc(M.DdaSetBindingData.CoerceType,M.DdaSetBindingData.Data),
Dc=Hg.g(this.$).ha;1===cc.CoerceType&&(!cc.Data&&Dc.sa.w5&&(cc.Headers||(cc.Headers=[]),cc.Headers.length||cc.Headers.push([]),cc.Headers[0].length||cc.Headers[0].push("")),c.Qfc(cc)||(cc.CellFormat||(cc.CellFormat=M.DdaSetBindingData.CellFormat),cc.TableOptions||(cc.TableOptions=M.DdaSetBindingData.TableOptions)));if(c.Qfc(cc))this.re.kf(Sf.a.tBc,na);else{var Zc=Dc.sa.Vc.clone(),nd=Dc.sa.activeCell.clone();this.Vz.ddaSetSelectedData(M.DdaMethod.ControlId,rb,cc,function(Id){var Od;if(eh.a(Id))Pa.re.ZG(Id,
na);else{Id=Zc.clone();var je=cc.Headers?cc.Headers[0].length:cc.Data[0].length;1!==cc.CoerceType||cc.Data?1===cc.CoerceType&&(null===(Od=cc.TableOptions)||void 0===Od?0:Od.length)&&0==cc.TableOptions[0]?(Id.top+=1,Id.bottom=Id.top+cc.Data.length-1):Id.bottom=Id.top+cc.Data.length-(1===cc.CoerceType?0:1):Id.bottom=Id.top+1;Id.right=Id.left+je-1;Od=Id.contains(nd)?nd:Id.topLeft;Dc.updateSelection(Id,Od,0);Pa.re.Nu(na)}},na)}}else this.re.kf(Sf.a.$we,na)}};c.prototype.addBinding=function(M,na,Pa,rb){var cc=
this;na?this.Vz.ddaAddBinding(M.DdaMethod.ControlId,M.DdaBindingsMethod.BindingId,M.DdaBindingsMethod.BindingType,na,Pa,function(Dc){if(eh.a(Dc))cc.re.ZG(Dc,rb);else{var Zc=cc.re.QP();Zc.Bindings=Array(1);Zc.Bindings[0]=cc.se.Z0b(Dc.Result);rb(Zc)}},rb):this.re.kf(Sf.a.vnj,rb)};c.prototype.aKh=function(M,na){var Pa=this;this.Vz.ddaGetBinding(M.DdaMethod.ControlId,M.DdaBindingsMethod.BindingId,function(rb){if(eh.a(rb)||!rb.Result)Pa.re.ZG(rb,na);else{var cc=Pa.re.QP();cc.Bindings=Array(1);cc.Bindings[0]=
Pa.se.Z0b(rb.Result);na(cc)}},na)};c.prototype.lPh=function(M){var na=this.re.QP(),Pa={};Pa[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;na[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=Pa;M(na)};c.prototype.$$i=function(M,na){var Pa=this;this.Vz.ddaReleaseBinding(M.DdaMethod.ControlId,M.DdaBindingsMethod.BindingId,function(rb){eh.a(rb)?Pa.re.ZG(rb,na):Pa.re.Nu(na)},na)};c.prototype.YIh=function(M,na){var Pa=this;this.Vz.ddaGetAllBindings(M.DdaMethod.ControlId,
function(rb){if(eh.a(rb))Pa.re.ZG(rb,na);else{var cc=Pa.re.QP();if(rb.Result){rb=rb.Result;cc.Bindings=Array(rb.length);for(var Dc=0;Dc<rb.length;Dc++)cc.Bindings[Dc]=Pa.se.Z0b(rb[Dc])}else cc.Bindings=null;na(cc)}},na)};c.prototype.Htd=function(M,na){var Pa=this;this.Vz.ddaLoadSettings(M.DdaMethod.ControlId,function(rb){if(eh.a(rb))Pa.re.ZG(rb,na);else{var cc=Pa.re.QP();cc.Properties=rb.Result;na(cc)}},na)};c.prototype.saveSettings=function(M,na){for(var Pa=this,rb={Settings:[]},cc=0;cc<M.DdaSettingsMethod.Properties.length;cc++){var Dc=
{};Dc.Name=M.DdaSettingsMethod.Properties[cc][0];Dc.Value=M.DdaSettingsMethod.Properties[cc][1];rb.Settings[cc]=Dc}this.Vz.ddaSaveSettings(M.DdaMethod.ControlId,rb,M.DdaSettingsMethod.OverwriteIfStale,function(Zc){eh.a(Zc)?Pa.re.ZG(Zc,na):Pa.re.Nu(na)},na)};c.prototype.nme=function(M,na){var Pa=this,rb=c.OYc(1,M.DdaAddRowsColumns.Data);c.Qfc(rb)?this.re.kf(Sf.a.tBc,na):this.Vz.ddaAddRowsColumns(M.DdaMethod.ControlId,M.DdaAddRowsColumns.BindingId,M.DdaAddRowsColumns.IsRow,rb,function(cc){eh.a(cc)?
Pa.re.ZG(cc,na):Pa.re.Nu(na)},na)};c.prototype.weh=function(M,na){var Pa=this;this.Vz.ddaDeleteAllDataValues(M.DdaMethod.ControlId,M.DdaBindingsMethod.BindingId,function(rb){eh.a(rb)?Pa.re.ZG(rb,na):Pa.re.Nu(na)},na)};c.prototype.eZg=function(M,na){var Pa=this;this.Vz.ddaClearBindingFormats(M.DdaMethod.ControlId,M.DdaClearBindingFormats.BindingId,function(rb){eh.a(rb)?Pa.re.ZG(rb,na):Pa.re.Nu(na)},na)};c.prototype.VYf=function(M,na){var Pa=this,rb={},cc=M.DdaSetBindingFormats.IsSetFormats;cc?rb.CellFormat=
M.DdaSetBindingFormats.CellFormat:rb.TableOptions=M.DdaSetBindingFormats.TableOptions;this.Vz.ddaSetBindingFormats(M.DdaMethod.ControlId,M.DdaSetBindingFormats.BindingId,rb,cc,function(Dc){eh.a(Dc)?Pa.re.ZG(Dc,na):Pa.re.Nu(na)},na)};c.prototype.executeRichApiRequest=function(M,na){var Pa=this,rb,cc=M.ArrayData,Dc={},Zc=Hg.g(this.$).ha;if(cc){if("WacPartition"===cc[0]){this.fyh(M,na);return}var nd=Object(cg.a)(dh.DdaFacade,xh.a(this.$));if("SetOsfControlContainerReadyForCustomFunctions"===cc[0]){var Id=
nd.Tm(M.DdaMethod.ControlId);Id&&(Id.spd=!0,Id.RJf())}Dc.HttpMethod=cc[1];Dc.PathAndQuery=cc[2];Dc.RequestHeaders=c.OZe(cc[3]);Dc.RequestBody=cc[4];Dc.AppPermission=cc[5];Id=cc[6];Dc.RequestFlags=Id;var Od=0;if(bi.i(this.$.pa))switch(Zc.Re){case 1:Od=2;break;case 2:Od=3;break;case 128:Od=4;break;default:Od=1}var je=null;Zc.Oa.pC&&(je=Zc.Oa.pC.ij);Dc.SheetMultiRange=ci.r(Zc.sa.selectedRanges,this.$);Dc.ActiveCell=ci.v(Zc.sa.activeCell,this.$);Dc.ActiveChartId=je;Dc.SelectionState=Od;Od=this.se.pZ(M.DdaMethod.ControlId);
Dc.InstanceId=Od?Od.InstanceId:"";if(Od&&Od.PrimaryMarketplace){je=dh.DdaFacade.getSolutionId(Od,this.$);var Ae=Od.PrimaryMarketplace.MarketplaceType;if(Ae===OSF.StoreType.InMemory){if(!Od.OwnerAddinSolutionId){this.re.kf(Sf.a.Jyb,na);return}if(Od.AssetMarketplace)Ae=Od.AssetMarketplace.MarketplaceType;else{this.re.kf(Sf.a.Jyb,na);return}}else Ae===OSF.StoreType.WopiCatalog&&(Ae=OSF.StoreType.OMEX);var Re=Telemetry.PrivacyRules.GetPrivacyCompliantId(je,Ae,null===(rb=Od.AssetMarketplace)||void 0===
rb?void 0:rb.SolutionId,null,null,Od.PrimaryMarketplace.MarketplaceRef);Dc.CompliantSolutionId=Re;Dc.SolutionId=je;Dc.MarketplaceType=Ae;Dc.SolutionVersion=Od.PrimaryMarketplace.SolutionVersion;Dc.StoreLocation=Od.PrimaryMarketplace.MarketplaceRef}else Dc.SolutionId=Dc.MarketplaceType="",Dc.CompliantSolutionId="";Dc.IsEventsEnabled=void 0===nd||null===nd||nd.Ri.i0b(Dc.InstanceId);Dc.RequestGuid=Bi.a.create().toString();rb=Dc.RequestBody.length;if(af.EwaSettings.isChangeGateEnabled("OfficeVSO:4444309_RichApiPayloadSizeLimit")&&
rb>this.$.ya.ExcelRichApiMaxAllowedRequestPayloadSize){this.re.kf(Sf.a.Rgj,na);Xd.ULS.sendTraceTag(537163213,0,50,"Request payload size:"+rb+" exceeded the limit");return}af.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&Id&4096&&(rb=new O(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(rb,B,cc),Dc.RequestBody=cc[4])}var Ke=c.Q1e(Dc.RequestHeaders);c.mDd++;var Ef=Xi.a.Ta.Jb;af.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&
Dc&&Dc.RequestBody&&Xd.ULS.sendTraceTag(537163212,0,50,"Richapi json request body size is "+Dc.RequestBody.length);this.Vz.executeRichApiRequest(Dc,function(ff){var xf;Pa.eYf(Ef,!0,ff.ServerCorrelationId);var yf=null,Wf=null,Nf=ff.ServerCorrelationId;if(null===(xf=null===ff||void 0===ff?void 0:ff.Errors)||void 0===xf?0:xf[0])yf=ff.Errors[0].MessageIdName,Wf=ff.Errors[0].Description,af.EwaSettings.isChangeGateEnabled("OfficeVSO:4513856_NotShowApiExceptionOnUI")&&ac.a(Pa.$).dd.eJ(ff.Errors[0].MessageId);
if(eh.a(ff)||!ff.Result)Pa.MNa(Nf,Ke,"Server error",yf,Wf),Pa.re.ZG(ff,na);else{var mf=null;if(af.EwaSettings.ma(259))if((xf=ff.Result)&&xf.length){for(var Mf=0;Mf<xf.length;Mf++)if(xf[Mf].RequestGuid===Dc.RequestGuid){mf=xf[Mf];break}mf||Pa.re.ZG(ff,na)}else mf=ff.Result;else mf=ff.Result;if(!yf&&mf&&mf.ResponseBody&&mf.ResponseBody[0])if(ff=mf.ResponseBody[0],ff.startsWith('{"Error":')){1<mf.ResponseBody.length&&(ff=ff.substring(0,ff.indexOf("}")+1),ff+="}");try{var Yf=sf.a.Wh(ff);Yf.Error&&Pa.MNa(Nf,
Ke,"Pipeline error",Yf.Error.Code,Yf.Error.Message)}catch(ng){Pa.MNa(Nf,Ke,"Json deserialize error",null,"Error info cannot be deserialized.")}}else Pa.MNa(Nf,Ke);else Pa.MNa(Nf,Ke,"Server error",yf,Wf);var Rf=(Yf=mf.SheetMultiRange)?Yf.SheetName:null;ff=mf.ActiveChartId;var tg=mf.SelectionState;yf=5===tg&&!!Yf||6===tg||7===tg||8===tg;if(af.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")&&Pa.$.ob.pz&&yf)Pa.re.kf(Sf.a.EDc,na),Xd.ULS.sendTraceTag(537163211,
0,50,tg.toString()+" is not allowed");else if(5===tg&&Yf){if(Pa.$.xa&&Rf)if(Pa.$.xa.Mj(Rf))Pa.PTc(Rf);else{var Cg=null;Cg=function(){Pa.$.xa.Mj(Rf)&&(Xd.ULS.sendTraceTag(537163210,0,50,"Sheets item add event handler called"),Pa.PTc(Rf),Pa.$.xa.OIb(Cg))};Pa.$.xa.Fnb(Cg);if(af.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){var jg=null;jg=function(){Pa.$.xa.Mj(Rf)&&(Pa.PTc(Rf),Pa.$.xa.Vma(jg))};Pa.$.xa.Uga(jg)}}}else if(6===tg||7===tg||8===tg||9===tg){if(Yf){var ag=
ci.g(Yf.Ranges);if(Rf&&ci.cb(ag,!0))if(af.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&!Pa.$.xa.Mj(Rf)){var eg=null;eg=function(){Pa.ueg(Zc,ag,Rf,tg);Pa.$.xa.Vma(eg)};Pa.$.xa.Uga(eg)}else Pa.ueg(Zc,ag,Rf,tg)}7===tg?(ff="38.{"+Kc.e(ff)+"}",Oi.a(Pa.$).nna(0,ff,!0)):8===tg&&Oi.a(Pa.$).nna(2,ff,!0);9===tg&&(Pa.$.ya.ApiCallToSetPageLayout=!0)}mf.PostProcessActions?Pa.$.dgf?(Nf=sf.a.Wh(mf.PostProcessActions),Pa.l0i(Nf).then(function(){Pa.Bcb(mf,na);
Pa.Had(M.DdaMethod.ControlId,Dc);return Promise.resolve(null)},function(ng){Pa.Bcb(mf,na,ng);return Promise.reject(ng)})):(Pa.MNa(Nf,Ke,"Promise not supported",null,"Promise is not supported on this browser."),Pa.re.kf(Sf.a.internalError,na)):Pa.Bcb(mf,na)}},function(ff){Pa.eYf(Ef,!1,null);Pa.MNa(null,Ke,"Web service error");na(ff)})};c.prototype.Had=function(M,na){var Pa=Object(cg.a)(dh.DdaFacade,xh.a(this.$));(null===Pa||void 0===Pa?0:Pa.dMd)&&Pa.Tm(M)&&c.fyj(na.RequestHeaders)&&(Xd.ULS.sendTraceTag(537163209,
0,50,"ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: "+M+"; SolutionId: "+na.SolutionId+"."),Pa.dMd.Nmh(M))};c.prototype.fyh=function(M,na){var Pa=this,rb=this.se.pZ(M.DdaMethod.ControlId),cc=dh.DdaFacade.getSolutionId(rb,this.$),Dc=null;Dc=dh.DdaFacade.Uua(rb,this.$);Dc=new y(Dc,this.$);Dc=new d(cc,M.DdaMethod.ControlId,this.se,this.$,Dc);var Zc={ResponseHeaders:[]};Zc.ResponseBody=Array(1);rb=c.OZe(M.ArrayData[3]);var nd=c.Q1e(rb);rb=new U(this.$.ya.CreateWorkbookMaxAllowedBase64Size,
this.Yrf);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(Dc,X,rb,M.ArrayData).then(function(Id){if(!Id)return Pa.wud(!1,"The rich api executor call failed",nd),Xd.ULS.sendTraceTag(537163208,0,10,"The rich api executor call failed"),Zc.ResponseStatusCode=500,Pa.Bcb(Zc,na),null;Pa.wud(!0,"The rich api executor call succeeded",nd);Zc.ResponseStatusCode=Id[0];Zc.ResponseBody[0]=Id[2];Pa.Bcb(Zc,na);return null},function(Id){Zc.ResponseStatusCode=400;Zc.ResponseBody[0]=Id.toString();Pa.wud(!1,
"The rich api executor call failed",nd);Xd.ULS.sendTraceTag(537163207,0,10,"A Excel Rich API batch execution was failed, AppId:"+cc);Pa.Bcb(Zc,na);return null})};c.prototype.eYf=function(M,na,Pa){c.mDd--;M=wj.a(Xi.a.Ta,M);Xd.ULS.sendTraceTag(36763356,0,50,"Rich Api perf log -- total milliseconds used:"+M+", requests pending:"+c.mDd+", request result:"+(na?"success":"false")+", server correlationid: "+Pa+".")};c.prototype.Bcb=function(M,na,Pa){Pa=void 0===Pa?null:Pa;var rb=Array(3);rb[0]=M.ResponseStatusCode;
rb[1]=c.rZh(M.ResponseHeaders);var cc=[],Dc=!1;if(Pa&&M.ResponseBody){var Zc=sf.a.Wh(M.ResponseBody.join(""));Zc.Error||(Dc={},Dc.Error=Pa,Dc.TraceIds=Zc.TraceIds,Dc.ProcessedResults={},Dc.ProcessedResults.Results=Zc.Results,cc[0]=sf.a.xc(Dc),Dc=!0)}rb[2]=Dc?cc:M.ResponseBody;M=this.re.QP();M.Data=rb;na(M)};c.prototype.pxd=function(M,na){(new I(this.$,this.re,this.Vz)).pxd(M,na)};c.prototype.BBi=function(M,na){Xd.ULS.sendTraceTag(537163206,0,50,"MessageParent API called!");var Pa=M[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],
rb=M[hf.a.MVc],cc=M[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];M=this.$.da.za(232).C1a.CBi(M.DdaMethod.ControlId,Pa,rb,cc);M===Sf.a.success?this.re.Nu(na):(Xd.ULS.sendTraceTag(537163205,0,10,"MessageParent API Failed!"),this.re.kf(M,na))};c.prototype.xBi=function(M,na){Xd.ULS.sendTraceTag(537163204,0,50,"MessageChild API called!");var Pa=M[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],rb=M[hf.a.MVc],cc=M[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];this.$.da.za(232).C1a.soj(M.DdaMethod.ControlId,
Pa,rb,cc);this.re.Nu(na)};c.prototype.getAccessToken=function(M,na){function Pa(Dc,Zc){var nd;if(Dc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)Dc=rb.re.QP(),Dc[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=Zc.accessToken,na(Dc);else{Zc=rb.se.pZ(M.DdaMethod.ControlId);var Id=null!==Zc.OwnerAddinStoreType?Zc.OwnerAddinStoreType:Zc.PrimaryMarketplace.MarketplaceType,Od={};Xd.ULS.sendTraceTag(537163202,0,10,"{0}."+(Od.errorCode=Dc.toString(),Od.appId=Telemetry.PrivacyRules.GetPrivacyCompliantId(dh.DdaFacade.getSolutionId(Zc,
rb.$),Id,null===(nd=Zc.AssetMarketplace)||void 0===nd?void 0:nd.SolutionId,null,null,Zc.PrimaryMarketplace.MarketplaceRef),Od.storeType=Id,Od)+".");rb.re.kf(Dc,na)}}var rb=this;Xd.ULS.sendTraceTag(537163203,0,50,"GetAccessToken API called!");var cc=!af.EwaSettings.ma(24);dg.TaskExtensions.Aa(Mg.GetServiceTaskFactory.create(this.$.da,137,this.$.la,1),function(Dc){var Zc=rb.se.Th,nd=ea.getInstance();mj.AppsForOfficeSingleSignOnManager.getInstance(Zc,Dc.result,nd).getAccessToken(M.DdaMethod.ControlId,
cc,M,Pa)},this.$.la)};c.prototype.getAuthContext=function(M,na){var Pa=this;dg.TaskExtensions.Aa(Mg.GetServiceTaskFactory.create(this.$.da,137,this.$.la,1),function(){var rb=Pa.se.Th.getOsfControl(M.DdaMethod.ControlId);if(!af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.OEP.Block3PGetAuthContext",!0)||rb.isFirstParty()){rb=rb.getManifest();var cc=rb.getMarketplaceID(),Dc=rb.getWebApplicationId(),Zc=rb.getWebApplicationMsaId();Xg.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(cc).then(function(nd){var Id=
Pa.re.QP(),Od={};Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Dc;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=Zc||Dc;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=nd.upn;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=nd.userId;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=nd.authority;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=oj.a.KJh(nd.authorityType);Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=
nd.isAnonymous;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=nd.tenantId;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=nd.supportsAuthToken;Id[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Od;na(Id)},function(nd){var Id=Pa.re.QP(),Od={},je=new oj.a;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Dc;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=Zc||Dc;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=
je.upn;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=je.userId;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=je.authority;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=je.authorityType;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=je.isAnonymous;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=je.tenantId;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=nd;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=
je.supportsAuthToken;Id[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Od;Id.Error=1;na(Id)})}},this.$.la)};c.prototype.Bhi=function(M){var na=Hg.g(this.$).ha;return 16===na.Re&&!!na.Oa.Yb&&!!na.Oa.Yb.floatingObject&&yi.a.equals(na.Oa.Yb.floatingObject.id,M,!0)};c.prototype.Edd=function(M){var na=Hg.g(this.$).ha;return na.sa.rg?1===na.Re||this.Bhi(M)?na.lia:null:null};c.prototype.Nic=function(M,na){return 1!==M&&2!==M&&3!==M?(this.re.kf(Sf.a.dAe,na),!1):!0};c.prototype.wud=function(M,
na,Pa){var rb={};rb.a=this.$.ya.UserSessionId;rb.b=M;rb.c=na;rb.d=null;rb.e=Pa;Lh.b().Ce(37,rb)};c.prototype.MNa=function(M,na,Pa,rb,cc){Pa=void 0===Pa?null:Pa;rb=void 0===rb?null:rb;cc=void 0===cc?null:cc;var Dc={};M&&(Dc.ServerCorrelationId=M);void 0!==na&&null!==na&&(Dc.Source=na);Pa&&(Dc.ErrorType=Pa);rb&&(Dc.MessageId=rb);cc&&(Dc.StatusDescription=cc);af.EwaSettings.isChangeGateEnabled("OfficeVSO:6144055_EUIIDataInDbxheTag")&&rb&&"ExternalDataRefreshFailed"===rb&&(Dc.StatusDescription="");Xd.ULS.sendTraceTag(50688452,
0,50,sf.a.xc(Dc))};c.prototype.l0i=function(M){for(var na=new Promise(function(rb){rb(null)}),Pa=0;Pa<M.length;Pa++)na=this.k0i(na,M[Pa]);return na};c.prototype.k0i=function(M,na){var Pa=this;if(!na)return Xd.ULS.sendTraceTag(537163201,0,10,"Null PostProcessAction."),M.then(function(){return Promise.reject(c.z3a(D.generalException,qg.a.instance.ga(1752),null))});switch(na.actionType){case 1:case 2:M=M.then(function(){var rb=Object(cg.a)(dh.DdaFacade,xh.a(Pa.$));if(rb.Tm(na.controlId))switch(rb.Ri.y3h(na),
na.messageType){case 14:case 100:rb.cMd.G0b(na);break;case 11:case 12:rb.Fjj.Sob(na);break;case 51:case 52:rb.Djj.Sob(na);break;case 2101:case 2102:rb.Ejj.Sob(na);break;case 2E3:rb.Gjj.G0b(na);break;case 2201:Pa.$.Lka&&rb.dMd.sNg(na);break;case 2203:rb.Hjj.tNg(na);break;case 2700:af.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&rb.bMd.G0b(na)}else Xd.ULS.sendTraceTag(537163171,0,10,"OsfControl with instanceId["+na.controlId+"] doesn't exist.");return Promise.resolve(null)});break;
case 3:M=M.then(function(){Pa.k3h(na);return Promise.resolve(null)});break;case 15:af.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&(M=M.then(function(){Pa.Q4h(na);return Promise.resolve(null)}));break;case 4:M=M.then(function(){if(af.EwaSettings.ma(105)){var rb=Hg.g(Pa.$).ha.sa.activeCell;rb.top!==na.row+1&&rb.left!==na.column+1&&(rb=ci.v(qj.Range.Qc(na.row+1,na.column+1),Pa.$),Hg.g(Pa.$).hg(rb,null,null,null,3,Gi.a.fdh));pi.a(Pa.$,243,242,0,function(cc){cc.Fdb(na.row+1,na.column+
1,1,!1,!1)})}return Promise.resolve(null)});break;case 7:M=M.then(function(){Object(cg.a)(dh.DdaFacade,xh.a(Pa.$)).Ri.dLe(na.controlId,na.isEnableEvents);return Promise.resolve(null)});break;case 5:M=M.then(function(){return Pa.Abh(na)});break;case 6:M=M.then(function(){return Pa.tWi(na)});break;case 8:M=M.then(function(){af.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&Object(cg.a)(dh.DdaFacade,xh.a(Pa.$)).dZg();var rb=new Ga.a(sb.a.Dk,5,null);
Y.a(Pa.$).cs(rb);return Promise.resolve(null)});break;case 9:M=M.then(function(){return Pa.iqj(na)});break;case 10:M=M.then(function(){return Pa.tZj(na)});break;case 11:M=M.then(function(){return Pa.sZj()});break;case 12:M=M.then(function(){return Pa.pZj()});break;case 13:M=M.then(function(){return Pa.qZj(na)});break;case 14:M=M.then(function(){return Pa.rZj(na)});break;case 16:M=M.then(function(){return Promise.resolve(na)});break;case 17:M=M.then(function(){return Pa.vmj(na,Object(cg.a)(dh.DdaFacade,
xh.a(Pa.$)))});break;case 18:Hg.g(this.$).focus();break;case 19:this.c5e(na.entryType,!1,na.options);break;case 20:this.c5e(na.entryType,!0,na.options);break;default:M=M.then(function(){return Promise.reject(c.z3a(D.QKg,qg.a.instance.ga(1753),null))})}return M};c.prototype.Q4h=function(M){var na=Object(cg.a)(dh.DdaFacade,xh.a(this.$)).Tm(M.controlId);if(na&&!(0===M.operationType^!na.Fda)){Hg.g(this.$).hic=!0;switch(M.operationType){case 0:var Pa=new Zi.a(document.createElement("input"));Pa.text=M.range;
na.eci(Hg.g(this.$).ig.X$g(Pa,new Sj.a(this.$)));na.Fda.startEdit(!0);break;case 1:na.SPf();this.rangePicker=null;break;case 2:na.Fda.Jeg(M.range);break;case 3:na.Fda.Jeg(M.startingRange);na=M.expandSelection;Pa=M.getNextDataRegionCell;var rb=0;switch(M.keyboardDirectionValue){case 2:rb=38;M=na&&Pa?105288353:na?-31900117:Pa?542791952:137938150;break;case 3:rb=40;M=na&&Pa?-1297307319:na?-1603798598:Pa?1713663844:-798660877;break;case 0:rb=37;M=na&&Pa?-403586027:na?2039316657:Pa?-2012742350:-1470715894;
break;case 1:rb=39;M=na&&Pa?784916030:na?589730764:Pa?1324884057:-1231471547;break;default:M=1461300262}na=this.$4b("keydown",rb,na,Pa);Hg.g(this.$).OJb(na,new Vh.a(M,1,0,8,null))}Hg.g(this.$).hic=!1}};c.prototype.$4b=function(M,na,Pa,rb){var cc=document.createEvent("KeyboardEvent");if(Bh.a.eF)cc.initKeyboardEvent(M,!1,!1,window.self,"A",0,rb,!1,Pa,!1);else{var Dc="";Pa&&(Dc+="Shift");rb&&(Dc+=0<Dc.length?" Control":"Control");cc.initKeyboardEvent(M,!1,!1,window.self,"A",0,Dc,!1,"en-US")}M=new Sys.UI.DomEvent(cc);
M.keyCode=na;return M};c.prototype.k3h=function(M){switch(M.operationType){case 1:dg.TaskExtensions.Aa(Mg.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1),function(na){na.result.ZKd()},this.$.la,3);break;case 2:if(M=Object(cg.a)(dh.DdaFacade,xh.a(this.$)).Tm(M.controlId))M.spd=!0,M.RJf()}};c.prototype.Abh=function(M){var na=this,Pa=M.fileBase64;return Pa&&Pa.length>this.$.ya.CreateWorkbookMaxAllowedBase64Size?Promise.reject(c.z3a(D.invalidArgument,qg.a.instance.ga(1756),"Application.CreateWorkbook")):
(new Promise(function(rb,cc){var Dc=new pj.StandardDialog;Dc.Rb=4;Dc.rl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,function(Zc){2!==Zc&&0!==Zc||cc(c.z3a(D.qCd,qg.a.instance.ga(1755),"Application.CreateWorkbook"));Zc=new P("blank","agave",Pa?"streamBase64":"streamEmpty",Pa);na.Yrf.create(rb,cc,Zc).O0a()})})).then(function(rb){na.F9b.set(M.fakeFileId,rb);return Promise.resolve(null)},function(rb){return rb?Promise.reject(rb):Promise.reject(c.z3a(D.generalException,
qg.a.instance.ga(1752),"Application.CreateWorkbook"))})};c.prototype.tWi=function(M){var na=this;return new Promise(function(Pa,rb){if(na.F9b.has(M.fakeFileId)){var cc=na.F9b.get(M.fakeFileId);rb=new pj.StandardDialog;rb.Rb=4;rb.rl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,function(Dc){1===Dc&&Zh.HelperMethods.Te(cc,void 0,void 0,"DdaMethodHandler.fileUrl");Pa(null)})}else rb(c.z3a(D.generalException,qg.a.instance.ga(1752),"Document.Open"))})};c.prototype.iqj=
function(M){var na=this;return new Promise(function(Pa){Object(cg.a)(dh.DdaFacade,xh.a(na.$)).FUf=M.runtimeCalculationMode;var rb=na.$.da.za(268);rb&&rb.qyd(3===M.runtimeCalculationMode);Pa(null)})};c.prototype.tZj=function(M){sg.a.ZAb(this.$)&&this.$.da.za(331).Ccb(0,M.urlStr,!0,!0,null);return Promise.resolve(null)};c.prototype.sZj=function(){sg.a.ZAb(this.$)&&this.$.da.za(331).Ccb(1,null,!0,!0,null);return Promise.resolve(null)};c.prototype.pZj=function(){sg.a.ZAb(this.$)&&this.$.da.za(331).aLe();
return Promise.resolve(null)};c.prototype.qZj=function(M){sg.a.ZAb(this.$)&&this.$.da.za(331).Ccb(5,M.urlStr,!0,!0,null);return Promise.resolve(null)};c.prototype.rZj=function(M){if(sg.a.ZAb(this.$)){var na=this.$.da.za(331);na=ik(na.yaa);for(var Pa=na.next();!Pa.done;Pa=na.next())Pa=Pa.value,Pa.IsActive&&Pa.HostEditUrl&&Pa.UrlStr===M.hostEditUrlStr&&Zh.HelperMethods.Te(Pa.HostEditUrl,"_blank")}return Promise.resolve(null)};c.prototype.vmj=function(M,na){var Pa=fk.a.QW;M=sf.a.Wh(M.payload);var rb=
{};"eventId"in M&&"payload"in M&&(rb.eventId=M.eventId,rb.payload=M.payload);na.zM(2201,Pa,sf.a.xc(rb));return Promise.resolve(null)};c.prototype.c5e=function(M,na,Pa){var rb=this.$.da.za(5);rb&&(M=this.DKh(M))&&(na?rb.removeEntry(M):rb.$le(M,Pa))};c.prototype.DKh=function(M){switch(M){case 0:return 64}};c.prototype.PTc=function(M){M=Object(cg.a)(xj.a,this.$.xa.getItemByName(M));(null===M||void 0===M?0:M.visible)&&M.activate(!0)};c.prototype.ueg=function(M,na,Pa,rb){var cc=M.sa.Qr,Dc=cc<na.length&&
na[cc].contains(M.sa.activeCell);M=Dc?M.sa.activeCell:na[0].topLeft;cc=Dc?cc:0;Hg.g(this.$).jV(na,cc,Pa,null,M,null,null,3,Gi.a.gdh,void 0,void 0,void 0,6===rb)};c.OZe=function(M){if(!M||!M.length)return null;for(var na=Array(M.length/2),Pa=0;Pa<M.length/2;Pa++)na[Pa]={},na[Pa].Name=M[2*Pa],na[Pa].Value=M[2*Pa+1];return na};c.rZh=function(M){if(!M||!M.length)return null;for(var na=Array(2*M.length),Pa=0;Pa<M.length;Pa++)na[2*Pa]=M[Pa].Name,na[2*Pa+1]=M[Pa].Value;return na};c.Wad=function(M){if(!M||
!M.length)return null;for(var na=Array(M.length),Pa=0,rb=M.length;Pa<rb;Pa++){var cc=M[Pa].length;if(cc){na[Pa]=Array(cc);for(var Dc=0;Dc<cc;Dc++)na[Pa][Dc]=null==M[Pa][Dc]?null:M[Pa][Dc].toString()}else return null}return na};c.p3b=function(M){return"string"===typeof M?Yi.a.Tp(c.bdh,M,0):M};c.YSe=function(M){return"string"===typeof M?Yi.a.Tp(c.edh,M,0):M};c.Zfg=function(M){return"string"===typeof M?Yi.a.Tp(c.idh,M,0):M};c.Nhi=function(M){switch(M.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1};
c.OYc=function(M,na){var Pa={};Pa.CoerceType=M;1===Pa.CoerceType?(Pa.Data=c.Wad(na.Rows),Pa.Headers=c.Wad(na.Headers)):Pa.Data=c.Wad(na);return Pa};c.Gue=function(M){if(1===M.CoerceType){var na={};return na.Headers=M.Headers,na.Rows=M.Data,na}return M.Data};c.Qfc=function(M){return 1===M.CoerceType?!M.Data&&!M.Headers:!M.Data};c.Q1e=function(M){var na="Unknown";if(!M)return na;for(var Pa=0;Pa<M.length;Pa++)if(M[Pa].Name.toLowerCase()===ph.a.Ijj){na=M[Pa].Value;break}return na};c.fyj=function(M){if(!M)return!1;
for(var na=ph.a.yGi.toLowerCase(),Pa=0;Pa<M.length;Pa++)if(M[Pa].Name.toLowerCase()===na)return!0;return!1};c.z3a=function(M,na,Pa){var rb={};rb.Code=M;rb.Message=na;rb.Location=Pa;rb.ActionIndex=0;return rb};of.Object.defineProperties(c.prototype,{iQ:{configurable:!0,enumerable:!0,get:function(){return this.re}}});of.Object.defineProperties(c,{bdh:{configurable:!0,enumerable:!0,get:function(){c.Npa||(c.Npa={},c.Npa[Microsoft.Office.WebExtension.CoercionType.Table]=1,c.Npa[Microsoft.Office.WebExtension.CoercionType.Text]=
2,c.Npa[Microsoft.Office.WebExtension.CoercionType.Matrix]=3,c.Npa[Microsoft.Office.WebExtension.CoercionType.Html]=4,c.Npa[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5);return c.Npa}},edh:{configurable:!0,enumerable:!0,get:function(){c.Vhb||(c.Vhb={},c.Vhb[Microsoft.Office.WebExtension.FilterType.All]=1,c.Vhb[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=2);return c.Vhb}},idh:{configurable:!0,enumerable:!0,get:function(){c.Whb||(c.Whb={},c.Whb[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=
2,c.Whb[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1);return c.Whb}}});c.Npa=null;c.Vhb=null;c.Whb=null;c.mDd=0;Object(Dd.a)(c,"DdaMethodHandler",null,[401,6]);var bd=Uh.a;$k(a,bd);a.prototype.zd=function(){var M=this,na=Mg.GetServiceTaskFactory.create(this.$.da,106,this.la,this.hb),Pa=Mg.GetServiceTaskFactory.create(this.$.da,165,this.la,this.hb),rb=yb(this.la,this.hb);dg.TaskExtensions.Aa(dg.TaskExtensions.Vd([na,Pa,rb],this.la),function(){var Dc=na.result,Zc=Xg.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");
M.jd([new c(M.$,Dc,Zc)])},this.la,3);var cc=Xg.a.instance;dg.TaskExtensions.Aa(Mg.GetServiceTaskFactory.create(this.$.da,137,this.$.la,this.hb),function(){cc.register(Z,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").tc().Dc(function(){return new Z})},this.$.la)};a.ka=function(M){Uh.a.Pd(82,new a(M))};Object(Dd.a)(a,"DdaCommandHandlerFactory",Uh.a,[]);Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("Microsoft.InternalService");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Agave");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.WebExtension");Type.registerNamespace("_Ewa");Vd.a.ti("");Vd.a.ti(".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}");Object(ae.a)();Type.registerNamespace("Common.App.AppsForOfficeCommon");Object(ne.a)();(function(){Ne.a.Fa(function(M){vc.ka(M)})})();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");
Object(yj.a)();Object(zj.a)();Type.registerNamespace("CommandUI.AddInCommands");(function(){Ne.a.Fa(function(M){af.EwaSettings.ma(54)&&$a.ka(M)})})();(function(){Ne.a.Fa(function(M){af.EwaSettings.ma(122)&&dc.ka(M)})})();Ne.a.Fa(oc.ka);Ne.a.Fa(Wb.ka);Type.registerNamespace("Common.App.AppsForOfficeOauth");Type.registerNamespace("Common.App.SmartLookup");(function(){Ne.a.Fa(function(M){Ea.ka(M);pa.ka(M);fa.ka(M)})})();Ne.a.Fa(a.ka)},1674:function(t,E,b){function a(){this.KEc=null;this.uJc=0;this.$Kc=
!1;this.$a=new e.a;this.xrg=new d.a}function c(){this.$Je=this.displayName=this.mrb=this.uo=this.rB=null;this.isUpgraded=!1}t=b(0);var d=b(192),e=b(97);c.prototype.Lgf=function(h,k){return this.rB.getStoreType().toLowerCase()===h.toLowerCase()&&this.rB.getSolutionId().toLowerCase()===k.toLowerCase()};Object(t.a)(c,"AddinCommandsResourceItem",null,[]);b.d(E,"a",function(){return a});a.prototype.ZEg=function(h){this.$a.addHandler("AddinCommandsLoadingMessageChanged",h)};a.prototype.Jbj=function(h){this.$a.removeHandler("AddinCommandsLoadingMessageChanged",
h)};a.prototype.cdb=function(h){h!==this.KEc&&(this.KEc=h,this.$a.raiseEvent("AddinCommandsLoadingMessageChanged"))};a.prototype.dqj=function(){this.uJc++;this.VYa||this.cdb(CommonUIStrings.l_LoadingAddInsTitle)};a.prototype.GOd=function(){this.uJc--;this.Ktd()&&(this.$Kc?this.VYa!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.cdb(CommonUIStrings.l_ErrorLoadingAddInsTitle):this.cdb(null))};a.prototype.MZf=function(h){this.$Kc=!0;this.cdb((void 0===h?0:h)?CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg:
CommonUIStrings.l_ErrorLoadingAddInsTitle)};a.prototype.yye=function(){this.$Kc=!1;this.Ktd()?this.cdb(null):this.cdb(CommonUIStrings.l_LoadingAddInsTitle)};a.prototype.Ktd=function(){return 0>=this.uJc};a.prototype.Uia=function(h,k,n){n=void 0===n?0:n;for(var f=ik(this.O5a),v=f.next();!v.done;v=f.next())if(v=v.value,v.Lgf(h,k)&&(!v.uo||v.uo.$Hh===n))return v;return null};a.prototype.Tle=function(h,k,n,f){var v=new c;v.rB=h;v.uo=k;v.mrb=n;v.displayName=f;this.O5a.add(v)};a.prototype.bDg=function(h,
k,n,f){var v=new c;v.rB=h;v.uo=k;v.mrb=null;v.$Je=n;v.displayName=f;this.O5a.add(v)};a.prototype.iaj=function(h,k){for(var n=0,f=ik(this.O5a),v=f.next();!v.done;v=f.next())v=v.value,v.rB.getStoreType()===h&&v.rB.getSolutionId()===k?this.O5a.removeAt(n):n++};a.getInstance=function(){a.Ma||(a.Ma=new a);return a.Ma};of.Object.defineProperties(a.prototype,{VYa:{configurable:!0,enumerable:!0,get:function(){return this.KEc}},O5a:{configurable:!0,enumerable:!0,get:function(){return this.xrg}}});a.Ma=null;
Object(t.a)(a,"AddinCommandsResourceManager",null,[])},954:function(t,E,b){function a(){}b.d(E,"a",function(){return a});t=b(0);var c=b(34);a.oVe=function(d){return c.a.Tp(a.zBi,d.toString(),a.internalError)};of.Object.defineProperties(a,{zBi:{configurable:!0,enumerable:!0,get:function(){var d={};return a.jbe||(a.jbe=(d["-2002156328"]=a.dAe,d["-1954750170"]=a.m2e,d["317650254"]=a.X_g,d["-1005263101"]=a.mei,d["1353664579"]=a.Mnj,d["159671765"]=a.nei,d["1446690022"]=a.xYe,d["1150069548"]=a.tBc,d["-1409306331"]=
a.$we,d["338507772"]=a.fGe,d["-457159301"]=a.kXi,d["-1037701970"]=a.Dch,d["-1893322318"]=a.sei,d["965579896"]=a.Fch,d["93287890"]=a.Ech,d["358088857"]=a.Sqj,d["-1223650923"]=a.fGe,d["2007306190"]=a.RWg,d["1549955423"]=a.Nte,d["-1275974171"]=a.rei,d["382101082"]=a.wWi,d["-898776235"]=a.nDi,d["335464256"]=a.cDi,d["1677378049"]=a.qei,d["-261992848"]=a.vQj,d["-980820954"]=a.Nte,d["-931375837"]=a.vWi,d["929186550"]=a.nkh,d["-982144310"]=a.h3i,d["-785741187"]=a.kei,d["2125217573"]=a.uei,d["299124955"]=
a.lei,d["1669853884"]=a.Xjj,d["-1515932330"]=a.Y_g,d["314621024"]=a.tEh,d["-300049690"]=a.VWg,d["14766835"]=a.Tvj,d["-1251992761"]=a.eJe,d["-2087635043"]=a.invalidOrTimedOutSession,d["2100961153"]=a.invalidOrTimedOutSession,d["-1218744139"]=a.invalidSheetName,d["-1468309555"]=5006,d["-315732528"]=a.invalidOrTimedOutSession,d["611268539"]=a.invalidOrTimedOutSession,d["1531005923"]=5006,d["1593924569"]=5006,d["299476328"]=a.HFa,d["49173765"]=a.HFa,d["-907155566"]=a.HFa,d["-1201603824"]=a.HFa,d["1541165282"]=
a.HFa,d["-1347753427"]=a.HFa,d["134912532"]=a.HFa,d["1780971550"]=a.responsePayloadSizeLimitExceeded,d))}}});a.success=0;a.dAe=1E3;a.m2e=1001;a.X_g=1002;a.mei=1003;a.Mnj=1004;a.nei=1005;a.xYe=1008;a.MSe=1009;a.invalidSheetName=1014;a.tBc=2E3;a.$we=2001;a.fGe=2002;a.kXi=2003;a.Dch=2004;a.sei=2005;a.Fch=2007;a.Ech=2008;a.Sqj=2009;a.RWg=2014;a.vnj=3E3;a.Nte=3002;a.rei=3004;a.wWi=3005;a.nDi=3006;a.cDi=3007;a.qei=3008;a.vQj=3009;a.vWi=3010;a.Tvj=4002;a.uCd=5E3;a.internalError=5001;a.eJe=5002;a.Jyb=5004;
a.vRj=5007;a.Z9h=5008;a.invalidOrTimedOutSession=5012;a.EDc=5016;a.HFa=5102;a.Rgj=5103;a.responsePayloadSizeLimitExceeded=5104;a.lWg=7001;a.T5f=7002;a.nkh=8E3;a.h3i=8001;a.kei=8010;a.uei=8011;a.lei=8012;a.Xjj=8020;a.Y_g=8021;a.tEh=8022;a.VWg=8023;a.fBi=11E3;a.dEi=11001;a.tei=11002;a.jbe=null;Object(t.a)(a,"DdaErrorIds",null,[])},955:function(t,E,b){function a(){}b.d(E,"a",function(){return a});t=b(0);a.generalException="GeneralException";a.invalidArgument="InvalidArgument";a.notImplemented="NotImplemented";
a.qTc="AccessDenied";a.notSupported="NotSupported";a.apiNotAvailable="ApiNotAvailable";a.notAllowed="NotAllowed";a.qCd="OperationCancelled";a.userNotSignedIn="UserNotSignedIn";a.userAborted="UserAborted";a.yRj="UnsupportedUserIdentity";a.invalidResourceUrl="InvalidResourceUrl";a.invalidGrant="InvalidGrant";a.WIg="AddinIsAlreadyRequestingToken";a.rij="ResourceNotAllowed";a.clientError="ClientError";a.serverError="ServerError";a.R3g="ControlIdNotFound";a.hjj="RibbonApiNotAvailable";a.hostRestartNeeded=
"HostRestartNeeded";a.invalidRibbonDefinition="InvalidRibbonDefinition";a.sharedRuntimeNotAvailable="SharedRuntimeNotAvailable";Object(t.a)(a,"ErrorCodes",null,[])},957:function(t,E,b){function a(Ja,Lb){var ec=Nb.call(this)||this;ec.ea=null;ec.Jm=null;ec.Vh=null;ec.pf=[];ec.RIa=null;ec.KFe=!1;ec.RPb=!1;ec.initialized=!1;ec.disposed=!1;ec.fCa=null;ec.jpc=[];ec.FFe=[];ec.pPa=[];ec.o1a=null;ec.zDd=new Wb.a(ub.a.Jk());ec.r_b=new vb.a(ub.a.Jk());ec.yGb=[];ec.UGf=[];ec.u6b=350;ec.dfa=null;ec.txa=null;ec.cTc=
!1;ec.lfe=null;ec.ife=null;ec.mfe=null;ec.kfe=null;ec.ofe=null;ec.pwg=null;ec.jfe=null;ec.nfe=null;ec.pfe=null;ec.qfe=null;ec.rfe=null;ec.Sf=function(){ec.fCa=ec.ea.io.WebExtensions;for(var Zb=ec.pf.length-1;0<=Zb;--Zb){var Oc=ec.pf[Zb],td;if(td=!ec.lCh(Oc.controlId))td=Oc,td=sa.EwaSettings.ma(122)?!td.iIa:!0;td&&(Oc.inc(),ec.pf.splice(Zb,1))}if(ec.fCa)for(Zb=0,Oc=ec.fCa.length;Zb<Oc;Zb++){td=ec.fCa[Zb];var Gd=ec.Tm(td.WebExtensionId);Gd&&Gd.WAd(td)}};ec.hoc=function(Zb){ec.raiseEvent("csc",Zb.getID())};
ec.GAf=function(Zb,Oc,td){if(sa.EwaSettings.isChangeGateEnabled("OfficeVSO:4841553_AddinKeyboardShortcutsInTaskpane")&&Oc===OSF.AgaveHostAction.KeyboardShortcuts){var Gd=Object(Ka.a)(Object,td);Oc={};Oc.keyCode=Gd.keyCode;Oc.type="keydown";Oc.ctrlKey=Gd.ctrlKey;Oc.shiftKey=Gd.shiftKey;Oc.altKey=Gd.altKey;Oc.metaKey=Gd.metaKey;Zb=ec.Tm(Zb);Gd=Zb.iha;Oc.srcElement=Object(eb.a)(529,Gd)?Gd.lGa:Wa.g(ec.$).hc;Oc=new Sys.UI.DomEvent(Oc);Zb={focusedAddinId:a.Uua(Zb.el,ec.$)};Gd=new Nc.a(1461300262,1,ec.$.Jc,
6,null);Wa.g(ec.$).OJb(Oc,Gd,Zb)}else if(Oc===OSF.AgaveHostAction.Select)ec.$4e(!0);else if(Oc===OSF.AgaveHostAction.UnSelect)ec.$4e(!1);else if(Oc===OSF.AgaveHostAction.CancelDialog)ec.VJ(-684355545,null);else if(Oc===OSF.AgaveHostAction.InsertAgave)Zb={},td&&(Zb[Ra.a.Sra]=td,Zb[ca.a.Wf]=a.Urb(td),ec.VJ(-741808261,Zb));else if(Oc===OSF.AgaveHostAction.InsertDevManifest)Zb={},td&&(Zb[Ra.a.Sra]=td,Zb[ca.a.Wf]=a.Urb(td),ec.VJ(-741808261,Zb));else if(Oc===OSF.AgaveHostAction.InsertDevManifestError)Zb=
Object(Ka.a)(Object,td),Oc={},Zb=(Oc[Ra.a.LVc]=ec.Jm.getDevManifestInvalidUrlErrorString(Zb.manifestUrl),Oc),ec.VJ(-2025863019,Zb);else if(Oc===OSF.AgaveHostAction.NotifyHostError)Zb={},Zb=(Zb[Ra.a.LVc]=ec.Jm.getManifestInvaildErrorString(),Zb),ec.VJ(-2025863019,Zb);else if(Oc===OSF.AgaveHostAction.RefreshAddinCommands)sa.EwaSettings.ma(54)&&ec.VJ(sd.a.refreshAddinCommands,null);else if(Oc===OSF.AgaveHostAction.CtrlF6Exit||Oc===OSF.AgaveHostAction.CtrlF6ExitShift){if(Gd=ec.$.da.za(15)){(Zb=ec.Tm(Zb).iha)&&
Zb.Xyc();Ua.a.Pf&&document.activeElement.blur();var Pd={keyCode:117,type:"keydown",ctrlKey:!0};Pd.shiftKey=Oc===OSF.AgaveHostAction.CtrlF6ExitShift;Pd.srcElement=Object(eb.a)(529,Zb)?Zb.lGa:Wa.g(ec.$).hc;Zb=new Sys.UI.DomEvent(Pd);Gd.ema(Zb)}}else if(Oc===OSF.AgaveHostAction.PageIsReady){if((Zb=ec.Tm(Zb).iha)&&Zb.eZa===OSF.OsfControlTarget.TaskPane&&(Zb=ec.$.da.za(183))&&ec.pf)for(Oc=Ub.a.rd(ec.$),Gd=ik(ec.pf),Pd=Gd.next();!Pd.done;Pd=Gd.next())a.bMa(Pd.value.oU)&&(Oc?Zb.Uf(!0,!1):Zb.setFocusOnToolbarFirstElement())}else if(Oc===
OSF.AgaveHostAction.TabExit){Oc=ec.Tm(Zb);var ee=Oc.iha;if(ee)if(ee.eZa===OSF.OsfControlTarget.InContent)ee.kjf();else{if(ee.eZa===OSF.OsfControlTarget.TaskPane)if(Ub.a.rd(ec.$))Ua.a.Pf&&document.activeElement.blur(),pb.UISurfaces.Cj().then(function(id){var vd=Object(eb.a)(529,ee)?ee:null;vd?vd.isResizable?id.focusResizeHandle():id.focusTabbedTaskPaneArea():id.focusTabbedTaskPaneArea();return null});else if(Zb=ec.$.da.za(183))Ua.a.Pf&&document.activeElement.blur(),(Oc=document.getElementById(ec.$.zb+
dc.a.smc))&&Fb.DOMElementExtensions.isVisible(Oc)?Fb.DOMElementExtensions.setFocus(Oc):Zb.setFocusOnToolbarFirstElement()}else Oc&&4===Oc.osfControlType&&ec.Jm.notifyAgave(Zb,OSF.AgaveHostAction.TabIn)}else if(Oc===OSF.AgaveHostAction.TabExitShift)(Oc=ec.Tm(Zb),Gd=Oc.iha)?Gd.eZa===OSF.OsfControlTarget.InContent?Gd.ljf():Gd.eZa===OSF.OsfControlTarget.TaskPane&&(Zb=Object(eb.a)(529,Gd)?Gd:null)&&(Ua.a.Pf&&document.activeElement.blur(),Zb.UZf()):Oc&&4===Oc.osfControlType&&ec.Jm.notifyAgave(Zb,OSF.AgaveHostAction.TabIn);
else if(Oc===OSF.AgaveHostAction.EscExit||Oc===OSF.AgaveHostAction.ExitNoFocusable||Oc===OSF.AgaveHostAction.ExitNoFocusableShift)if(Gd=ec.Tm(Zb).iha)Gd.Xyc();else{if(Oc===OSF.AgaveHostAction.EscExit){Oc=null;Gd=ik(O.o1h());for(Pd=Gd.next();!Pd.done;Pd=Gd.next())if(Pd=Pd.value,Pd.value.ye===Zb){Pd.value.dialog.hide();Oc=Pd.key;break}Oc&&(Zb=ec.Tm(Oc))&&4!==Zb.osfControlType&&ec.Th.notifyAgave(Oc,OSF.AgaveHostAction.TabIn)}}else if(Oc===OSF.AgaveHostAction.InstallCustomFunctions)if(sa.EwaSettings.ma(122)){ef.a(ec.$).MUe(function(){return!1});
var Ec=ec.$.da;hb.TaskExtensions.Aa(wa.GetServiceTaskFactory.Ra(Ec,278,279,1),function(id){id=id.result;Ec.za(278)||Ec.Ga(278,id);var vd=td.osfControl.getStoreType();id.taf(td.osfControl.getSolutionId(),vd,a.mNh(td.osfControl),td).ina()},ec.la,3)}else va.ULS.sendTraceTag(537170577,0,10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");else if(Oc===OSF.AgaveHostAction.UninstallCustomFunctions)if(sa.EwaSettings.ma(122)){ef.a(ec.$).MUe(function(){return!1});
var $c=ec.$.da;hb.TaskExtensions.Aa(wa.GetServiceTaskFactory.Ra($c,278,279,1),function(id){id=id.result;$c.za(278)||$c.Ga(278,id);id.Tbg(td.solutionId,td.storeType).ina()},ec.la,3)}else va.ULS.sendTraceTag(537170574,0,10,"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");else Oc===OSF.AgaveHostAction.SendTelemetryEvent?d(td):Oc===OSF.AgaveHostAction.SendCustomerContent?c(td):Oc===OSF.AgaveHostAction.LaunchExtensionComponent?bb.a.instance.rsi(td):Oc===
OSF.AgaveHostAction.RefreshRibbonGallery?(Zb=ec.$.da.za(352))&&Zb.yid(td):Oc===OSF.AgaveHostAction.RemoveAppCommandsAddin?(ec.kbj(td.solutionId),Ub.a.rd(ec.$)||(Zb=ec.$.da.za(183))&&Zb.Ow(),sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&pa.AFrameworkApplication.ub.$d(sd.a.dPf,2,td.solutionId)):Oc===OSF.AgaveHostAction.GetOriginalControlId&&(Zb=new Aa.a(ec.$.zb,td.ownerAddinSolutionId,new $a.a,!0),td.originalControlId=Zb?Zb.XFe(td.controlId):
td.controlId)};ec.Doj=function(Zb,Oc){var td=Array(2);td[0]=Oc;td[1]=null;ec.Vh.uCh(Zb,JSON.stringify(td))};ec.pVi=function(){ec.$.pa&&we.o(ec.$.pa)&&ec.$.da.za(34).Bld()};ec.Yc=function(){ec.ilf()};ec.oR=function(Zb,Oc){var td,Gd;1===Oc.Dq&&(Zb=Oc.If)&&(Oc=new h(ie.toTimestamp(Zb.enqueueUtcTime),ie.toTimestamp(Zb.processUtcTime),ie.toTimestamp(Zb.dequeueUtcTime),ie.getElapsedMilliseconds(Zb.enqueueUtcTime,Zb.processUtcTime),ie.getElapsedMilliseconds(Zb.processUtcTime,Zb.dequeueUtcTime),Zb.operationCount,
(null===(Gd=null===(td=Zb.operation)||void 0===td?void 0:td.Wc)||void 0===Gd?0:Gd.ServerCorrelationId)?Zb.operation.Wc.ServerCorrelationId:null,Zb.operation?Enum.toString(Sd.a,Zb.operation.operationName):null,gb.a.eB(ie.getElapsedMilliseconds(Zb.enqueueUtcTime,Fe.a.Ta.Jb))),td=Sys.Serialization.JavaScriptSerializer.serialize(Oc),va.ULS.sendTraceTag(50872916,0,50,td))};ec.Uc=function(Zb,Oc){!ec.ea.dc&&jf.a(Oc)?(Array.forEach(ec.pf,ec.owf),ec.pf.length=0,ec.RPb=!1):(Oc.sH&&(va.ULS.sendTraceTag(537170516,
0,50,"Silent Reload require reset osf controls."),ec.FTf()),ec.QK(),sa.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&(ec.RPb=!1))};ec.ro=function(){sa.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(va.ULS.sendTraceTag(537170515,0,50,"Load on demand occurred require reset osf controls."),ec.FTf());ec.QK();sa.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(ec.RPb=!1)};
ec.owf=function(Zb){Zb.inc();ec.raiseEvent("cd",Zb.controlId)};ec.ib=Ja;ec.dWc=Lb;ec.initialize();T.ka(ec);ec.FUf=0;(Ja=(Ja=!(Ua.a.Wo||Ua.a.Ika))&&(!sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5763473_DisableAddinKeyboardShortcutsInFirefox")||!Ua.a.Pf))&&OfficeExt.ShortcutKeyDispatchManager.init();ec.yrg={};return ec}function c(Ja){pc.a.sendOtelCustomerContent(Object.assign(new Xc.a,{otelEvent:Ja}))}function d(Ja){pc.a.sendOtelEvent(Object.assign(new Xc.a,{otelEvent:Ja}))}function e(Ja,Lb,ec){var Zb=
Ie.call(this,ec,Ja)||this;Zb.hashCode=null;Zb.Hva=null;Zb.f4b=!1;Zb.Dm=function(Oc,td){td.ed.hash===Zb.hashCode&&Zb.Hva&&Object(Ka.a)(b(957).DdaFacade,Zb.$.da.za(35)).wBj(Zb.Hva.InstanceId)};Zb.ff=function(Oc,td){switch(td.ed.block.state){case 1:case 3:case 5:Zb.Dna(td)}};Zb.yi=function(){Zb.zHb(!0)};Zb.oo=function(Oc,td){Zb.isVisible&&Zb.GTa(td.sF);Zb.clearCache()};Zb.me=function(Oc,td){Zb.HSa(td.pa,!!td.sF)};Zb.wN=function(){Zb.$.ea.mma()};Zb.lUa=Lb;Zb.domElement.classList.add(Sc.a.c9b);Zb.domElement.classList.add(Md.a.Mo);
ec.tabIndex=0;Zb.HSa(Zb.$.pa,!1);Zb.zc.ka("mousedown",Zb.wN);Zb.zc.ka("contextmenu",function(Oc){Le.g(Oc)});Zb.$.xa.iJ(Zb.oo);Zb.$.vb.iJ(Zb.oo);Zb.$.vb.Mf(Zb.me);Zb.$.xa.Mf(Zb.me);Zb.Ea.Hs(Zb.ff);Zb.Ea.vG(Zb.Dm);Zb.Ea.lx(Zb.yi);sa.EwaSettings.Zb()&&Zb.Au(Zb.yya);return Zb}function h(Ja,Lb,ec,Zb,Oc,td,Gd,Pd,ee){this.dequeueUtcTime=this.processUtcTime=this.enqueueUtcTime=null;this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=this.ServerCorrelationId=null;
this.IsDocumentHidden=!1;this.enqueueUtcTime=Ja;this.processUtcTime=Lb;this.dequeueUtcTime=ec;this.inQueueDurationInMS=Zb;this.executionDurationInMS=Oc;this.operationCount=td;this.ServerCorrelationId=Gd;this.UserOperationName=Pd;this.IsDocumentHidden=ee}function k(Ja,Lb,ec){this.$=Ja;this.Ri=Lb;this.runtimeCalculationMode=ec}function n(){}function f(Ja,Lb,ec){var Zb=this;this.CFf=null;this.Gad=function(Oc,td){var Gd=Mc.a.QW,Pd={};Pd.eventId=Oc;Pd.payload=td;Zb.Ri.d_(2201,Gd)&&Zb.Vh.zM(2201,Gd,Yc.a.xc(Pd))};
this.$=Ja;this.Ri=Lb;this.Vh=ec;this.Gbi()}function v(Ja,Lb,ec){var Zb=this;this.jIb=0;this.zhg=!0;this.D$b=0;this.hqd=!0;this.cye=function(){var Oc=document.hasFocus();if(Zb.zhg!==Oc){if(Oc){var td=Yc.a.xc({});Zb.Vh.zM(2203,Mc.a.QW,td)}Zb.zhg=Oc}};this.dye=function(Oc){(0<Oc.timeRemaining()||Oc.didTimeout)&&Zb.cye();window.requestIdleCallback(Zb.dye)};this.$=Ja;this.Ri=Lb;this.Vh=ec;window.requestIdleCallback||(this.hqd=!1)}function m(Ja,Lb,ec){var Zb=this;this.iIb=0;this.gab=this.mab=null;this.GEf=
function(){var Oc=Wa.g(Zb.$).ha.Oa.pC;if(Oc)if(Zb.wif(Oc)){var td=Zb.yja();Zb.Iad(td);Zb.mab=Oc.floatingObject.id;Zb.gab=td}else Zb.mab&&(Zb.Iad(Zb.gab),Zb.mab=null,Zb.gab=null);else Zb.mab&&(Zb.Iad(Zb.gab),Zb.mab=null,Zb.gab=null)};this.$=Ja;this.Ri=Lb;this.Vh=ec}function x(Ja,Lb,ec){var Zb=this;this.c3b=null;this.krd=!1;this.onPointerDown=function(Oc){if(3===Oc.nb){var td=Zb.gridView.Eac(Oc.clientPoint).Z_a;Zb.krd=!!td&&Zb.gridView.ha.sa.fJe(td)}else Zb.krd=!1;Zb.c3b=Oc.clientPoint;return!1};this.Zc=
function(Oc){if(Zb.gridView.inRangePicker||Zb.gridView.vi||Zb.krd||Oc.shiftKey||Oc.ctrlKey||Oc.Ca.button!==Sys.UI.MouseButton.leftButton||!Zb.c3b||!Oc.clientPoint||Oc.clientPoint.x!==Zb.c3b.x||Oc.clientPoint.y!==Zb.c3b.y)return!1;var td=Zb.gridView.Eac(Oc.clientPoint);Oc=td.Z_a;td=td.returnValue;var Gd=Object(Ka.a)(Ob.a,Zb.$.xa.pa);if(td&&Gd&&0===Gd.LF){if(!Zb.gridView.ha.sa.i4.contains(Oc))return!1;Oc=new l(Gd,Oc,ob.HelperMethods.IDd(td.x),ob.HelperMethods.IDd(td.y));Zb.JVi(Oc)}return!1};this.$=
Ja;this.gridView=Wa.g(Ja);this.Ri=Lb;this.Vh=ec;this.G$i()}function l(Ja,Lb,ec,Zb){var Oc=md.call(this)||this;Oc.sheet=Ja;Oc.OWg=Lb;Oc.offsetX=ec;Oc.offsetY=Zb;return Oc}function u(Ja,Lb,ec){var Zb=this;this.OOf=this.NOf=this.POf=this.MOf=0;this.FVi=function(Oc,td){Oc=Object(Ka.a)(Ob.a,td.pa);Zb.C7a(Oc)&&(td={},td.worksheetId=Oc.sheetId,td=Yc.a.xc(td),Zb.Xia(11,Oc.sheetId,td))};this.IVi=function(Oc,td){Oc=Object(Ka.a)(Ob.a,td.sF);Zb.C7a(Oc)&&(td={},td.worksheetId=Oc.sheetId,td=Yc.a.xc(td),Zb.Xia(12,
Oc.sheetId,td))};this.GVi=function(Oc,td){Oc=Object(Ka.a)(Ob.a,td.pa);Zb.C7a(Oc)&&(td={},td.worksheetId=Oc.sheetId,Oc=Yc.a.xc(td),Zb.Xia(11,null,Oc,!0))};this.HVi=function(Oc,td){Oc=Object(Ka.a)(Ob.a,td.sF);Zb.C7a(Oc)&&(td={},td.worksheetId=Oc.sheetId,Oc=Yc.a.xc(td),Zb.Xia(12,null,Oc,!0))};this.$=Ja;this.Ri=Lb;this.Vh=ec}function A(Ja,Lb,ec){var Zb=this;this.hQa=this.gQa=0;this.RGa=this.Eha=null;this.xxf=function(){var Oc=Wa.g(Zb.$).ha.Oa.pC;if(0<Zb.hQa&&Zb.Eha&&Zb.RGa){var td={};td.shapeId=Zb.Eha;
td.worksheetId=Zb.RGa;td=Yc.a.xc(td);Zb.fireEvent(2102,Zb.Eha,td)}Zb.Oni(Oc)?(Zb.Eha=Zb.SOj(Oc),Zb.RGa=Zb.yja(),Zb.Eha&&Zb.RGa)?0<Zb.gQa&&(Oc={},Oc.shapeId=Zb.Eha,Oc.worksheetId=Zb.RGa,Oc=Yc.a.xc(Oc),Zb.fireEvent(2101,Zb.Eha,Oc)):va.ULS.sendTraceTag(537170458,344,10,"Something goes wrong, we got invalid shape id: '"+Zb.Eha+"', or worksheet id: '"+Zb.RGa+"' from a Floating object or gridview."):(Zb.Eha=null,Zb.RGa=null)};this.$=Ja;this.Ri=Lb;this.Vh=ec}function z(Ja,Lb,ec){Ja=y.call(this,Ja,Lb,ec)||
this;Ja.Hjf=null;Ja.Gjf=null;return Ja}function y(Ja,Lb,ec){var Zb=ic.call(this)||this;Zb.Oza=0;Zb.DU=0;Zb.Rc=function(Oc,td){if(Zb.enabled&&!(Zb.zef()||null!==td&&void 0!==td&&td.Vhf)&&(Oc=Object(Ka.a)(Ob.a,Zb.$.xa.pa))&&0===Oc.LF){var Gd=Oc.sheetId,Pd=Zb.pYe(),ee=null,Ec=null;Zb.Ri.Khf()&&(ee=Zb.grid.Ab.dk(Zb.grid.ha.sa.activeCell),Ec=Gd in Zb.sjc?Zb.sjc[Gd]:null);Zb.Wre(Gd,Pd)&&hb.TaskExtensions.Aa(mb.Task.Ua(!0),function(){Zb.M5h(Gd,Pd);Zb.y5h(Gd,Pd,ee,Ec)},Zb.la);Zb.$Ie(Gd,Pd,ee)}};Zb.$=Ja;Zb.Ri=
Lb;Zb.Vh=ec;Zb.grid=Wa.g(Ja);Zb.lNa={};Zb.sjc={};return Zb}function w(Ja,Lb,ec){var Zb=this;this.LOf=this.KOf=0;this.MLb=this.pab=null;this.uIi=function(){var Oc=Wa.g(Zb.$).ha.Oa.pC;if(Zb.bnd(Oc)&&(Oc=Zb.Hac(Oc))){var td={chartId:Oc};td.worksheetId=Zb.yja();td=Yc.a.xc(td);Zb.Xia(51,Oc,td);Zb.Xia(51,Zb.yja(),td)}};this.vIi=function(){if(Zb.pab){var Oc={};Oc.chartId=Zb.pab;Oc.worksheetId=Zb.MLb;Oc=Yc.a.xc(Oc);Zb.Xia(52,Zb.pab,Oc);Zb.Xia(52,Zb.MLb,Oc)}Oc=Wa.g(Zb.$).ha.Oa.pC;Zb.bnd(Oc)?(Zb.pab=Zb.Hac(Oc),
Zb.MLb=Zb.yja()):(Zb.pab=null,Zb.MLb=null)};this.$=Ja;this.Ri=Lb;this.Vh=ec}function D(){this.YYa={}}function H(Ja,Lb,ec,Zb){Zb=void 0===Zb?!1:Zb;var Oc=Ic.call(this)||this;Oc.Fcb=0;Oc.vE=null;Oc.dwa=!1;Oc.Mqc=null;Oc.DU=0;Oc.g2d=null;Oc.pHc=null;Oc.vVa=null;Oc.$5b=null;Oc.K9d=!1;Oc.F_d=null;Oc.Fda=null;Oc.sOc=null;Oc.Rc=function(){Oc.enabled&&(Oc.Coj(),Oc.Mqc=wb.d(Wa.g(Oc.$).ha.sa.selectedRanges))};Oc.l5e=function(td){td.controlId===Oc.Hd.InstanceId&&Array.forEach(Oc.vE,function(Gd){Gd.bAi(td)&&
Gd.S1b(td)})};Oc.fuf=function(td){if((td=Object(Ka.a)(529,td))&&!td.Sr())if(!Oc.Hd||OSF.OsfControl.isFirstPartyStoreString(Oc.Hd.PrimaryMarketplace.MarketplaceType)||Oc.$.gha){td.yf=Oc.Hd;td.hj=Oc.Gg;Oc.F_d=td;Oc.zwc(td.lGa);var Gd=sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&Ub.a.rd(Oc.$)&&ob.HelperMethods.hw(Oc.Hd)&&Oc.Hd.Preload&&!Oc.Hd.TaskpaneVisible;Gd?td.JAd():sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?
(td.JAd(),(Oc.Hd.SharedRuntime&&1===Oc.Hd.SharedRuntime.LifeTime||Oc.Hd.SharedRuntimeId)&&!Oc.Hd.TaskpaneVisible&&td.$f(!1)):((Oc.Hd.SharedRuntime&&1===Oc.Hd.SharedRuntime.LifeTime||Oc.Hd.SharedRuntimeId)&&!Oc.Hd.TaskpaneVisible&&td.$f(!1),td.JAd());Oc.X5a||(Ub.a.rd(Oc.$)?Gd||td.I6():Oa.a(Oc.$).result.GF(td,!0));Oc.$.da.za(77).jQf(Oc.fuf);Oc.iha=Object(Ka.a)(570,td)}else va.ULS.sendTraceTag(537170464,0,50,"Taskpane web add-in disabled by doc IRM")};Oc.onFloatingObjectControlAdded=function(td,Gd){3===
Gd.control.floatingObject.type&&Gd.control.floatingObject.el.InstanceId===Oc.n1.WebExtensionId&&(Oc.iha=Object(Ka.a)(570,Gd.control),Oc.zwc(Gd.control.Dd.firstChild),zb.a(Oc.$).Ssc(Oc.onFloatingObjectControlAdded))};Oc.ib=Ja.$;Oc.Gg=Ja;Oc.Hd=ec;Oc.Hd.InstanceId=ec.SrcLocationOverrideResourceId?Ja.y3a(ec.InstanceId,ec.SrcLocationOverrideResourceId):ec.InstanceId;Oc.Vh=Lb;Oc.n1={};Oc.n1.WebExtensionId=ec.InstanceId;Oc.BFf="osfControl_"+ec.InstanceId;Oc.y6c="disabled_"+ec.InstanceId;Oc.n1.BindingData=
ec.BindingData;Oc.X5a=Oc.Gg.X5a(ec.InstanceId);Oc.Ifc=Oc.Gg.Ifc(ec.InstanceId);Oc.Xce=ec.WebExtensionOsfControlType;Oc.OIf=Zb;return Oc}function F(){}function J(Ja,Lb,ec,Zb,Oc,td,Gd,Pd){Ja=Yb.call(this,Ja,Lb,ec)||this;Ja.startRow=0;Ja.startColumn=0;Ja.rowCount=0;Ja.columnCount=0;Ja.startColumn=td-Zb.Reference.FirstColumn;Ja.columnCount=Pd;td=Math.max(Oc,Zb.Reference.FirstRow);Oc=Math.min(Oc+Gd-1,Zb.Reference.LastRow);td>Oc?Ja.startRow=Ja.rowCount=void 0:(Ja.startRow=td-Zb.Reference.FirstRow,Ja.rowCount=
Oc-td+1);return Ja}function S(Ja){var Lb=this;this.vE=null;this.dwa=!1;this.Rc=function(){Lb.vE.forEach(function(ec){ec.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&ec.S1b(new jb.a(ec.eventId,"",null))})};this.Gg=Ja}function N(Ja,Lb){this.OA=null;this.vfa=Ja;this.ryg=Lb}function T(Ja){var Lb=this;this.Th=this.NWc=null;this.LPi=function(ec,Zb){Lb.handlers.kb(Zb.controlId)&&(ec=new I(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,Zb.controlId,null,Zb.messageType,Zb.messageContent,
Zb.messageOrigin,Zb.targetOrigin),Lb.handlers.na(Zb.controlId)(ec),Zb.messageType===OSF.DialogMessageType.DialogClosed&&Lb.handlers.remove(Zb.controlId))};this.KPi=function(ec,Zb){Lb.xlc.kb(Zb.controlId)&&(ec=new G(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,Zb.controlId,null,Zb.messageType,Zb.messageContent,Zb.messageOrigin,Zb.targetOrigin),Lb.xlc.na(Zb.controlId)(ec))};this.handlers=new Ea.a;this.xlc=new Ea.a;this.Gg=Ja;this.C1a.sHg(this.LPi);this.C1a.rHg(this.KPi)}function G(Ja,
Lb,ec,Zb,Oc,td,Gd){Ja=Na.call(this,Ja,Lb,ec)||this;Ja.messageType=0;Ja.messageContent=null;Ja.messageOrigin=null;Ja.targetOrigin=null;Ja.messageType=Zb;Ja.messageContent=Oc;Ja.messageOrigin=td;Ja.targetOrigin=Gd;return Ja}function I(Ja,Lb,ec,Zb,Oc,td,Gd){Ja=nb.call(this,Ja,Lb,ec)||this;Ja.messageType=0;Ja.messageContent=null;Ja.messageOrigin=null;Ja.targetOrigin=null;Ja.messageType=Zb;Ja.messageContent=Oc;Ja.messageOrigin=td;Ja.targetOrigin=Gd;return Ja}function K(Ja,Lb){var ec=Ia.call(this)||this;
ec.requests=[];ec.m2b=!1;ec.disposed=!1;ec.Ef=function(){if(!ec.disposed){ec.grid.Wb.Nl(ec.Ef);ec.m2b=!1;var Zb=ec.requests;ec.requests=[];Zb=ik(Zb);for(var Oc=Zb.next();!Oc.done;Oc=Zb.next())Oc=Oc.value,ec.ddaFacade.VJ(Oc.command,Oc.properties)}};ec.ddaFacade=Ja;ec.grid=Lb;return ec}function L(){this.command=0;this.properties=null}function O(Ja){this.$a=new fa.a;this.Jm=Ja}function B(Ja,Lb,ec,Zb,Oc){ec=void 0===ec?null:ec;Zb=void 0===Zb?"":Zb;Oc=void 0===Oc?"":Oc;var td=ja.call(this)||this;td.controlId=
Ja;td.messageType=Lb;td.messageContent=ec;td.messageOrigin=Zb;td.targetOrigin=Oc;return td}function Q(Ja,Lb,ec,Zb,Oc){ec=void 0===ec?null:ec;Zb=void 0===Zb?"":Zb;Oc=void 0===Oc?"":Oc;var td=oa.call(this)||this;td.controlId=Ja;td.messageType=Lb;td.messageContent=ec;td.messageOrigin=Zb;td.targetOrigin=Oc;return td}function U(){this.height=this.width=0;this.ye=this.controlId=this.pageUrl=null;this.lec=this.H6c=!1}function X(){}function P(){this.dialog=this.ye=null}function ea(Ja,Lb,ec){var Zb=Ma.call(this)||
this;Zb.A9=null;Zb.uSc="WACDialogTitleText";Zb.kVa="0";Zb.URb="15px";Zb.Gng="0px";Zb.jVa="calc(100% - 30px)";Zb.Fng="100%";Zb.Lee=0;Zb.$a=new fa.a;Zb.ilg=new da;Zb.Rb=5;Zb.fDa=ec;Zb.ye=ec;Zb.MHc=Ja;Zb.b5d=Lb;Zb.aIc=!!pa.AFrameworkApplication.fa&&pa.AFrameworkApplication.fa.qa("OfficeAddinEnableInsertDialogAccessibilityFix");return Zb}function ia(){}function da(){}function xa(Ja,Lb){Ja=Z.call(this,1,Ja,Lb)||this;Ja.cbf=OfficeExt.CommandInvokeMode.ExclusiveForNew;return Ja}function Z(Ja,Lb,ec){this._id=
Ja;this.glg=Lb;this.rng=ec;this.cbf=OfficeExt.CommandInvokeMode.Default}b.r(E);var ha=b(0),ya=b(7),va=b(15),bb=b(1517),ba=b(84),fa=b(97);Z.prototype.execute=function(Ja,Lb,ec){var Zb=this;ec=ec||{};ec.commandMode=this.cbf;Lb.invokeAppCommand(this.VIg,this.A0g,ec,function(){Ja.WPi(Zb.id)})};of.Object.defineProperties(Z.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}},VIg:{configurable:!0,enumerable:!0,get:function(){return this.glg}},A0g:{configurable:!0,enumerable:!0,
get:function(){return this.rng}}});Object(ha.a)(Z,"AddinNativeActionBase",null,[185]);$k(xa,Z);Object(ha.a)(xa,"AddinTakeSnapshotAction",Z,[]);da.prototype.t5g=function(Ja){return new Z(3,Ja,this.HIh().getNativeActionName(3))};da.prototype.HIh=function(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()};Object(ha.a)(da,"AddinNativeActionManager",null,[181]);var ra=b(150);ia.prototype.invokeAppCommand=function(Ja,Lb,ec,Zb){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(Ja,Lb,
ec,Zb)};ia.getInstance=function(){ia.Ma||(ia.Ma=new ia);return ia.Ma};ia.Ma=null;Object(ha.a)(ia,"OSFAddinCommandsRuntimeManager",null,[180]);var pa=b(4),Za=b(184),Ua=b(27),Ma=ra.a;$k(ea,Ma);ea.prototype.kHg=function(Ja){this.$a.addHandler("OnDialogClosedEventKey",Ja)};ea.prototype.Nsj=function(){this.pEa=null};ea.prototype.bD=function(){Ma.prototype.bD.call(this);this.np.style.width="100%";this.np.style.height=this.Odc?this.jVa:this.Fng;this.np.style.marginTop=this.Odc?this.URb:this.Gng;this.np.style.padding=
this.kVa};ea.prototype.lO=function(){Ma.prototype.lO.call(this);this.Db.style.width=String.format("{0}px",this.MHc*window.innerWidth/100);this.Db.style.height=String.format("{0}px",this.b5d*window.innerHeight/100);this.Db.style.minWidth="0px";this.aIc&&pa.AFrameworkApplication.isRtl&&100===this.MHc&&(this.Db.style.right="0px",this.Db.style.marginRight="0px");this.A9=document.getElementById(this.di(this.uSc));this.A9.style.position="absolute";this.A9.style.whiteSpace="nowrap";this.A9.style.textOverflow=
"ellipsis";pa.AFrameworkApplication.isRtl?(this.A9.style.right="14px",this.A9.style.left="44px"):(this.A9.style.right="44px",this.A9.style.left="14px")};ea.prototype.lv=function(Ja){Ma.prototype.lv.call(this,Ja);this.A9&&this.A9.setAttribute("title",Ja)};ea.prototype.eLd=function(){this.Db.style.width=String.format("{0}px",this.MHc*window.innerWidth/100);this.Db.style.height=String.format("{0}px",this.b5d*window.innerHeight/100);this.Db.style.overflowY="hidden";this.Db.style.overflowX="hidden";this.Db.style.marginTop=
"";this.Db.style.top="";Ua.a.g5&&pa.AFrameworkApplication.isRtl?(this.Db.style.right="",this.Db.style.marginRight=""):(this.Db.style.left="",this.Db.style.marginLeft="")};ea.prototype.hide=function(){var Ja=this;this.ilg.t5g(this.fDa).execute(this,ia.getInstance(),{});this.Lee=window.setTimeout(function(){Ja.$a.raiseEvent("OnDialogClosedEventKey",Ja.fDa);Za.a.prototype.hide.call(Ja)},500)};ea.prototype.WPi=function(Ja){3===Ja&&(window.clearTimeout(this.Lee),this.$a.raiseEvent("OnDialogClosedEventKey",
this.fDa),Ma.prototype.hide.call(this))};of.Object.defineProperties(ea.prototype,{B1a:{configurable:!0,enumerable:!0,get:function(){return this.np}}});Object(ha.a)(ea,"AppsForOfficeDialog",ra.a,[159,160]);Object(ha.a)(P,"DialogInfo",null,[]);X.url="url";X.height="height";X.width="width";X.H6c="displayInIframe";X.lec="hideTitle";Object(ha.a)(X,"DialogSettings",null,[]);Object(ha.a)(U,"DisplayDialogParams",null,[]);var oa=Sys.EventArgs;$k(Q,oa);Object(ha.a)(Q,"OnMessageDialogEventArgs",Sys.EventArgs,
[]);var ja=Sys.EventArgs;$k(B,ja);Object(ha.a)(B,"OnMessageParentEventArgs",Sys.EventArgs,[]);var ta=b(42),aa=b(29),ma=b(178),Ea=b(100);O.prototype.sHg=function(Ja){this.$a.addHandler("OnMessageParentEventKey",Ja)};O.prototype.rHg=function(Ja){this.$a.addHandler("OnMessageDialogEventKey",Ja)};O.prototype.showDialog=function(Ja,Lb,ec,Zb){if(O.r8.kb(Lb))va.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),ec(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);
else try{var Oc=ta.b(Ja),td=Oc[X.url];if(this.Jm.getOsfControl(Lb).checkAppDomains(td)){var Gd=new U;Gd.width=Oc[X.width];Gd.height=Oc[X.height];Gd.pageUrl=td;Gd.H6c=Oc[X.H6c];Gd.lec=Oc[X.lec];Gd.controlId=Lb;Gd.ye=ma.a.create().toString();var Pd=new P;Pd.ye=Gd.ye;var ee=this.Jm.getOsfControl(Gd.controlId).getManifest().getDefaultDisplayName(),Ec=this.Jm.getOsfControl(Gd.controlId).getStoreType().toLowerCase();Ja=null;var $c=pa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideDialogTitleOption",
!1);Ja=(4===pa.AFrameworkApplication.ta.Qa.rj&&"hardcodedpreinstall"===Ec||$c&&"sdxcatalog"===Ec)&&Gd.lec?this.createAndShowAppsForOfficeDialog(Gd.width,Gd.height,Gd.ye,!0,ee):this.createAndShowAppsForOfficeDialog(Gd.width,Gd.height,Gd.ye,!1,ee);var id=this.Jm.getOsfControl(Gd.controlId),vd=id.getManifest();$c={};$c.id=Gd.ye;$c.solutionId=id.getSolutionId();$c.version=id.getVersion();$c.storeType=Ec;$c.storeId=id.getStoreId();$c.assetId=id.getAssetId();$c.assetStoreId=id.getAssetStoreId();$c.ownerAddinSolutionId=
id.getOwnerAddinSolutionId();$c.ownerAddinStoreType=id.getOwnerAddinStoreType();$c.appDomains=vd.getAppDomains();$c.dialogUrl=td;$c.osfControlType=1;$c.agaveName=ee;$c.div=Ja.B1a;va.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId($c.solutionId,$c.ownerAddinStoreType||$c.storeType,$c.assetId,null,null,$c.storeId),aa.a.Nv(Gd.pageUrl));this.Jm.insertDialogControl($c);Ja.kHg(Object(ba.a)(this,this.mKi,"onDialogClosed"));Pd.dialog=
Ja;O.r8.ia(Gd.controlId,Pd);Zb&&Zb($c);ec(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else va.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),ec(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(he){va.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",he.message),ec(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}};O.prototype.CBi=function(Ja,Lb,ec,Zb){pa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",
!1)||""===Zb&&(Zb=ec);try{var Oc=this.cKa(Ja);Oc&&this.$a.raiseEvent("OnMessageParentEventKey",new B(Oc,OSF.DialogMessageType.DialogMessageReceived,Lb,ec,Zb))}catch(td){return va.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",td.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess};O.prototype.Hqb=function(Ja,Lb){if(O.r8.kb(Ja))try{var ec=O.r8.na(Ja);ec.dialog&&ec.dialog.hide();this.Jm.purgeDialogControl(ec.ye);
O.r8.remove(Ja);Lb(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(Zb){va.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",Zb.message),Lb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else va.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),Lb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)};O.prototype.soj=function(Ja,Lb,ec,Zb){pa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",
!1)||""===Zb&&(Zb=ec);if(O.r8.kb(Ja)&&(Ja=O.r8.na(Ja),Ja.dialog))try{this.$a.raiseEvent("OnMessageDialogEventKey",new Q(Ja.ye,OSF.DialogMessageType.DialogParentMessageReceived,Lb,ec,Zb))}catch(Oc){va.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",Oc.message)}};O.prototype.cKa=function(Ja){for(var Lb=null,ec=ik(O.r8),Zb=ec.next();!Zb.done;Zb=ec.next())if(Zb=Zb.value,Zb.value.ye===Ja){Lb=Zb.key;break}return Lb};O.prototype.mKi=function(Ja,Lb){if(Ja=this.cKa(Lb))this.Jm.purgeDialogControl(Lb),
O.r8.remove(Ja),this.$a.raiseEvent("OnMessageParentEventKey",new B(Ja,OSF.DialogMessageType.DialogClosed,null,null,"*"))};O.prototype.createAndShowAppsForOfficeDialog=function(Ja,Lb,ec,Zb,Oc){Ja=new ea(Ja,Lb,ec);Oc=Zb?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,Oc);Zb&&(Ja.Odc=!1,Ja.Su=!1);Ja.initializeAndShow(Oc,null,null);Ja.Nsj();return Ja};O.o1h=function(){return O.r8};O.getInstance=function(Ja){O.Ma||(O.Ma=new O(Ja));return O.Ma};O.Ma=null;O.r8=new Ea.a;Object(ha.a)(O,"AppsForOfficeDialogManager",
null,[125]);var Ha=b(1067),Aa=b(1528),V=b(1605),La=b(1154),Ra=b(941),pb=b(209),cb=b(1529),Sa=b(120),Db=b(83),Ab=b(87),Wb=b(746),ub=b(625),vb=b(904),Ka=b(85),eb=b(445),yb=b(162),oc=b(192),Jb=b(38),dc=b(5),$a=b(1082),Ba=b(1447),la=b(79);Object(ha.a)(L,"DdaRequestInfo",null,[]);var ka=b(954),ca=b(76),Ia=la.a;$k(K,Ia);K.prototype.neh=function(Ja,Lb){this.disposed||(this.m2b||(this.grid.Wb.um(this.Ef),this.m2b=!0),this.requests.push(Object(ya.a)(new L,{command:Ja,properties:Lb})))};K.prototype.dispose=
function(){if(!this.disposed){this.disposed=!0;this.m2b&&this.grid.Wb.Nl(this.Ef);var Ja=this.requests;this.requests=null;Ja=ik(Ja);for(var Lb=Ja.next();!Lb.done;Lb=Ja.next())Lb=Lb.value,(Lb=Lb.properties?Lb.properties[ca.a.B3]:null)&&this.ddaFacade.kf(ka.a.Jyb,Lb);this.ddaFacade=this.grid=null;Ia.prototype.dispose.call(this)}};K.D0g=function(Ja,Lb){var ec=!1;974713501===Ja&&(Lb=(Ja=Lb?Lb[ca.a.Wf]:null)?Ja.DdaMethod:null)&&Lb.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(ec=
Ja.ArrayData,ec=!!ec&&64===(ec[6]&64));return ec};Object(ha.a)(K,"DdaCellEditDelayRequestHandler",la.a,[]);var jb=b(986),nb=jb.a;$k(I,nb);Object(ha.a)(I,"DialogMessageReceivedEventArgs",jb.a,[]);var Na=jb.a;$k(G,Na);Object(ha.a)(G,"DialogParentMessageReceivedEventArgs",jb.a,[]);var sa=b(1),Wa=b(21);T.prototype.addHandler=function(Ja,Lb,ec,Zb){var Oc=this;if(sa.EwaSettings.ma(24))this.Gg.kf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,ec);else{va.ULS.sendTraceTag(537170502,0,50,"DialogMessageReceivedEventManager.AddHandler called!");
var td=function(Gd){Gd===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(Oc.handlers.ia(Ja,Lb),Oc.Gg.Nu(ec)):(va.ULS.sendTraceTag(537170501,0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),Oc.Gg.kf(Gd,ec))};this.handlers.kb(Ja)?td(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(Ja,Zb,td)}};T.prototype.TCg=function(Ja,Lb,ec){sa.EwaSettings.ma(24)?this.Gg.kf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,ec):(va.ULS.sendTraceTag(537170500,0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!"),
this.xlc.ia(Ja,Lb),this.Gg.Nu(ec))};T.prototype.removeHandler=function(Ja,Lb){var ec=this;sa.EwaSettings.ma(24)?this.Gg.kf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Lb):this.handlers.kb(Ja)?(va.ULS.sendTraceTag(537170499,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.C1a.Hqb(Ja,function(Zb){ec.handlers.remove(Ja);Zb===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?ec.Gg.Nu(Lb):(va.ULS.sendTraceTag(537170498,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),
ec.Gg.kf(Zb,Lb))})):this.Gg.kf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,Lb)};T.prototype.dbj=function(Ja,Lb){sa.EwaSettings.ma(24)?this.Gg.kf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Lb):(va.ULS.sendTraceTag(537170497,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.xlc.remove(Ja),this.Gg.Nu(Lb))};T.prototype.showDialog=function(Ja,Lb,ec){var Zb=this;try{sa.EwaSettings.isChangeGateEnabled("OfficeVSO:6254758_ExitCellEditModeDialogAPI")&&Wa.g(this.Gg.$).isEditing&&
Wa.g(this.Gg.$).xo(!0),this.C1a.showDialog(Lb,Ja,ec,function(Oc){Zb.Gg.kDg(Zb.rTg(Oc))})}catch(Oc){va.ULS.sendTraceTag(537170496,0,10,"DialogMessageReceivedEventManager: show dialog failed. Exception message: "+Oc.message),ec(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}};T.prototype.rTg=function(Ja){var Lb={};Lb.InstanceId=Ja.id;Lb.WebExtensionType=Ja.osfControlType===OSF.OsfControlTarget.InContent?0:1;Lb.PrimaryMarketplace={};Lb.PrimaryMarketplace.SolutionId=Ja.solutionId;Lb.PrimaryMarketplace.SolutionVersion=
Ja.version;Lb.PrimaryMarketplace.MarketplaceRef=Ja.storeId;Lb.PrimaryMarketplace.MarketplaceType=Ja.storeType;return Lb};T.ka=function(Ja){if(!Ja.$.da.za(232)){var Lb=new T(Ja);Ja.$.da.Ga(232,Lb)}};of.Object.defineProperties(T.prototype,{C1a:{configurable:!0,enumerable:!0,get:function(){this.NWc||(this.NWc=O.getInstance(this.contextActivationMgr));return this.NWc}},contextActivationMgr:{configurable:!0,enumerable:!0,get:function(){!this.Th&&this.Gg&&(this.Th=this.Gg.Th);return this.Th}}});Object(ha.a)(T,
"DialogMessageReceivedEventManager",null,[794]);N.prototype.XZb=function(Ja){Ja&&(this.OA||(this.OA=[]),this.OA.push(Ja))};N.prototype.$sc=function(Ja){this.OA&&Array.remove(this.OA,Ja)};N.prototype.bAi=function(Ja){return this.eventId!==Ja.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.targetId===Ja.ddaBinding.Name:!0};N.prototype.S1b=function(Ja){this.OA&&Array.forEach(this.OA,function(Lb){Lb(Ja)})};
N.prototype.Oma=function(){this.OA=[]};of.Object.defineProperties(N.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.vfa}},targetId:{configurable:!0,enumerable:!0,get:function(){return this.ryg}},l6h:{configurable:!0,enumerable:!0,get:function(){return 0<this.OA.length}}});Object(ha.a)(N,"DdaEventRegistration",null,[]);S.prototype.invokeDdaMethod=function(Ja,Lb){var ec={};ec[ca.a.Wf]=Ja;ec[ca.a.B3]=Lb;this.Gg.VJ(974713501,ec)};S.prototype.registerDdaEventAsync=function(Ja,
Lb,ec,Zb,Oc){S.vzb(Ja)?(S.tnd(Ja)&&this.Xjd(),this.vE||(this.vE=[]),Lb=this.fub(Ja,ec),Lb||(Lb=new N(Ja,ec),this.vE.push(Lb)),Lb.XZb(Zb),this.Gg.Nu(Oc)):this.Gg.kf(-1,Oc)};S.prototype.unregisterDdaEventAsync=function(Ja,Lb,ec,Zb,Oc){S.vzb(Ja)?((Ja=this.fub(Ja,ec))&&Ja.$sc(Zb),this.Gg.Nu(Oc)):this.Gg.kf(-1,Oc)};S.prototype.Xjd=function(){this.dwa||(Wa.g(this.Gg.$).ha.WD(this.Rc),this.dwa=!0)};S.prototype.fub=function(Ja,Lb){if(!this.vE)return null;for(var ec=0;ec<this.vE.length;ec++){var Zb=this.vE[ec];
if(Zb.eventId===Ja&&Zb.targetId===Lb)return Zb}return null};S.vzb=function(Ja){return Ja===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};S.tnd=function(Ja){return Ja===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};Object(ha.a)(S,"EmbeddingPage",null,[783]);var Hb=b(182),Yb=jb.a;$k(J,Yb);J.prototype.getStartRow=function(){return this.startRow};J.prototype.getStartColumn=function(){return this.startColumn};J.prototype.getRowCount=function(){return this.rowCount};J.prototype.getColumnCount=
function(){return this.columnCount};Object(ha.a)(J,"DdaBindingSelectionEventArgs",jb.a,[]);var Sb=b(194),lb=b(24),wb=b(41),wa=b(50),Oa=b(446),Ub=b(36),hb=b(37),Xb=b(638),Gc=b(110),uc=b(53),Nc=b(91),Fb=b(12),ob=b(11),zb=b(105);F.Fth="ewa-wx-disabled-div";F.Eth="ewa-wx-container-div";F.aOe="ewa-ptp-nov2-flex";Object(ha.a)(F,"CssClassNames",null,[]);var ib=F.Fth,fc=F.Eth,Ic=Hb.a;$k(H,Ic);H.prototype.eci=function(Ja){this.Fda||(this.Fda=Ja)};H.prototype.SPf=function(){this.Fda&&(this.Fda.dispose(),this.Fda=
null)};H.prototype.old=function(){var Ja=this;if(!OSF.OsfControl.isFirstPartyStoreString(this.Hd.PrimaryMarketplace.MarketplaceType)&&sa.EwaSettings.ma(187)){var Lb=wa.GetServiceTaskFactory.Ra(this.$.da,5,4,0);hb.TaskExtensions.Aa(Lb,function(){Lb.result.Lf(35,null)},this.la,3);return this}if(1===this.Hd.WebExtensionType)hb.TaskExtensions.Aa(Oa.a(this.$),function(Oc){Oc.result.Grb(Ja.$.da,77,6,Ja.fuf,1)},this.la,3);else{var ec=this.fTe(),Zb=zb.a(this.$);ec||(ec={Type:3},ec.Id=this.n1.WebExtensionId,
ec.WebExtensionData=this.Hd,ec.ContentHtml="<div/>",ec.Version=0,ec.AbsoluteLeft=0,ec.AbsoluteTop=0,ec.AbsoluteRight=0,ec.AbsoluteBottom=0,ec.Width=0,ec.Height=0,ec.ZOrder=0,ec.OriginDeltaX=0,ec.OriginDeltaY=0,ec=new Sb.a(ec),Zb.J4b(ec,null),ec=Zb.pq(ec.Ig()));ec?(this.zwc(ec.Dd.firstChild),this.iha=Object(Ka.a)(570,ec)):Zb.OZb(this.onFloatingObjectControlAdded)}return this};H.prototype.p$e=function(Ja){this.zwc(Ja);return this};H.prototype.inc=function(){this.OIf||this.Gg.Th.purgeOsfControl(this.controlId,
!1);this.Qbg(!0);var Ja=this.fTe();Ja&&zb.a(this.$).deleteFloatingObject(Ja);this.Gg.Ri.Naj(this.controlId);this.Gg.Ri.dLe(this.controlId,!0);this.sOc=null};H.prototype.WAd=function(Ja){this.n1=Ja};H.prototype.invokeDdaMethod=function(Ja,Lb){if(sa.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled){var ec={};ec[ca.a.Wf]=Ja;ec[ca.a.B3]=Lb;this.Gg.VJ(974713501,ec)}else this.Gg.kf(ka.a.Jyb,Lb)};H.prototype.i9i=function(Ja,Lb,ec,Zb){if(sa.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||
this.enabled)if(!H.Nih(Ja)||void 0!==Lb&&null!==Lb&&void 0!==this.S2a(Lb)&&null!==this.S2a(Lb))if(va.ULS.sendTraceTag(36444195,0,50,"eventId: "+Ja+", targetId: "+Lb),H.Icf(Ja)&&this.g8h(),H.tnd(Ja)&&this.Xjd(),H.Gcf(Ja))sa.EwaSettings.ma(24)?this.Gg.kf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Zb):this.Gg.$.da.za(232).addHandler(this.controlId,ec,Zb,Lb);else if(H.Hcf(Ja))sa.EwaSettings.ma(24)?this.Gg.kf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Zb):this.Gg.$.da.za(232).TCg(this.controlId,
ec,Zb);else{H.Fcf(Ja)&&this.n5e(-1777565636,Zb);this.vE||(this.vE=[]);var Oc=this.fub(Ja,Lb);Oc||(Oc=new N(Ja,Lb),this.vE.push(Oc));Oc.Oma();Oc.XZb(ec);this.Gg.Nu(Zb);Ja===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.vVa&&(this.$5b=ec)}else this.Gg.kf(3002,Zb);else this.Gg.kf(-1,Zb)};H.prototype.GQj=function(Ja,Lb,ec,Zb){H.Gcf(Ja)?sa.EwaSettings.ma(24)?this.Gg.kf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Zb):this.Gg.$.da.za(232).removeHandler(this.controlId,Zb):H.Hcf(Ja)?
sa.EwaSettings.ma(24)?this.Gg.kf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Zb):this.Gg.$.da.za(232).dbj(this.controlId,Zb):(H.Fcf(Ja)&&this.n5e(1592314317,Zb),Lb=this.fub(Ja,Lb),this.enabled?(Lb&&(Lb.$sc(ec),Lb.l6h||Array.remove(this.vE,Lb),this.vE.length?H.Icf(Ja)&&this.Rbg(!1):this.Qbg(!1)),this.Gg.Nu(Zb)):this.Gg.kf(-1,Zb))};H.prototype.ka=function(Ja){Fb.DOMElementExtensions.getElementById(Ja,this.BFf)||Ja.appendChild(Fb.DOMElementExtensions.gf(this.hy))};H.prototype.showHide=
function(Ja){Fb.DOMElementExtensions.setVisible(this.hy,Ja)};H.prototype.resize=function(Ja,Lb){Fb.DOMElementExtensions.uv(this.hy,Ja);Fb.DOMElementExtensions.vI(this.hy,Lb)};H.prototype.aIe=function(Ja){if(!this.DU&&!Fb.DOMElementExtensions.getElementById(this.hy,this.y6c)&&this.hy){var Lb=document.createElement("div");Lb.id=this.y6c;Lb.className=ib;Lb.style.backgroundImage="url("+uc.a.current.So(102)+")";Lb.style.opacity=Ja?"1":"0";Lb.style.backgroundRepeat="no-repeat";Lb.style.backgroundPosition=
"center";this.hy.insertBefore(Lb,this.hy.firstChild)}this.DU++};H.prototype.Elh=function(){0<this.DU&&this.DU--;this.DU||(Fb.DOMElementExtensions.gf(Fb.DOMElementExtensions.getElementById(this.hy,this.y6c)),this.dwa&&!wb.Q(this.Mqc,Wa.g(this.$).ha.sa.selectedRanges)&&this.Rc(null,null))};H.prototype.S2a=function(Ja){if(!this.n1||!this.n1.BindingData)return null;for(var Lb=0;Lb<this.n1.BindingData.length;Lb++)if(this.n1.BindingData[Lb].Name===Ja)return this.n1.BindingData[Lb];return null};H.prototype.getDefaultIconUrl=
function(){var Ja=this.O0e();return Ja?Ja.getDefaultIconUrl():null};H.prototype.getDefaultDisplayName=function(){if(this.Hd.TaskpaneTitle)return this.Hd.TaskpaneTitle;var Ja=this.O0e();return Ja?Ja.getDefaultDisplayName():null};H.prototype.RJf=function(){if(this.vVa&&this.$5b){var Ja=new jb.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,null,this.vVa);this.$5b(Ja);this.$5b=this.vVa=null}};H.prototype.$f=function(Ja){this.F_d&&this.F_d.$f(Ja)};H.prototype.Fqj=function(){var Ja=this;
this.$.ea.isNamedObjectViewMode&&this.dmi()&&(this.$.da.za(34).Eqj(this.hy),this.showHide(!1));if(this.Gg.HYj){if(!this.OIf){var Lb={};Lb.div=this.hy;Lb.id=this.Hd.InstanceId;Lb.solutionId=this.Hd.PrimaryMarketplace.SolutionId;Lb.version=this.Hd.PrimaryMarketplace.SolutionVersion;Lb.storeId=this.Hd.PrimaryMarketplace.MarketplaceRef;Lb.storeType=this.Hd.PrimaryMarketplace.MarketplaceType;Lb.ownerAddinSolutionId=this.Hd.OwnerAddinSolutionId;Lb.ownerAddinStoreType=this.Hd.OwnerAddinStoreType;this.Hd.AssetMarketplace&&
(Lb.assetId=this.Hd.AssetMarketplace.SolutionId,Lb.assetStoreId=this.Hd.AssetMarketplace.MarketplaceRef);Lb.settings=this.Hd.OsfPropertyBag;sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?Lb.reason=this.X5a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.Ifc?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.ControlActivation:Lb.reason=this.X5a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:
Microsoft.Office.WebExtension.InitializationReason.Inserted;Lb.osfControlType=0===this.Hd.WebExtensionType?OSF.OsfControlTarget.InContent:OSF.OsfControlTarget.TaskPane;Lb.isForUILessAction=4===this.Hd.WebExtensionOsfControlType;Lb.sourceLocationOverrideResourceId=this.Hd.SrcLocationOverrideResourceId;Lb.focusOnIframeWhenLoaded=this.Hd.FocusOnIframeWhenLoaded;Xb.a(this.Hd)&&(Lb.featureGates=pa.AFrameworkApplication.fa.KPh(Lb.solutionId));Lb.hostInfoFlags=0;this.iIa&&(Lb.hostInfoFlags|=2);ob.HelperMethods.hw(this.Hd)&&
(Lb.hostInfoFlags|=1);this.$.gha||(va.ULS.sendTraceTag(537170466,0,50,"Content web add-in disabled by doc IRM"),Lb.hostInfoFlags|=4);sa.EwaSettings.ma(639)&&(Lb.hostInfoFlags|=8);sa.EwaSettings.ma(54)&&sa.EwaSettings.ma(94)&&!this.pHc&&(Lb.virtualOsfControlActivationCallback=function(){Ja.Gg.XBd(Ja.Hd)});Lb.sharedRuntimeId=this.Hd.SharedRuntime?this.Hd.SharedRuntime.Resid:this.Hd.SharedRuntimeId;!ob.HelperMethods.hw(this.Hd)||this.Hd.Preload||Xb.a(this.Hd)||this.Gg.Th.getOsfControl(b(957).DdaFacade.getSolutionId(this.Hd,
this.$))||(sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppCrashInViewMode")?this.$.isEditMode&&this.Gg.XBd(this.Hd):this.Gg.XBd(this.Hd));Lb.initialDisplayMode=this.Hd.TaskpaneVisible?2:1;sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")&&(Lb.titleOverride=this.el.TaskpaneTitle);this.Gg.Th.insertOsfControl(Lb)}this.DU=0}else this.aIe(!0)};H.prototype.Qbg=function(Ja){this.Rbg(Ja);this.oQj()};H.prototype.g8h=function(){this.Fcb||this.Vh.XZb(this.l5e);
this.Fcb++};H.prototype.Rbg=function(Ja){0<this.Fcb&&(Ja?this.Fcb=0:this.Fcb--,this.Fcb||this.Vh.$sc(this.l5e))};H.prototype.Xjd=function(){if(!this.dwa){var Ja=Wa.g(this.$).ha;this.Mqc=wb.d(Wa.g(this.$).ha.sa.selectedRanges);Ja.WD(this.Rc);this.dwa=!0}};H.prototype.oQj=function(){this.dwa&&(Wa.g(this.$).ha.ZH(this.Rc),this.dwa=!1)};H.prototype.wnj=function(Ja){var Lb=new lb.Range(Ja.Reference.FirstRow+1,Ja.Reference.FirstColumn+1,Ja.Reference.LastRow+1,Ja.Reference.LastColumn+1,!1,!1);1===Ja.BindingType&&
(Ja.HasHeaders&&--Lb.top,Ja.HasTotals&&(Lb.bottom+=1));var ec=Wa.g(this.$).ha.sa.selectedRanges;Ja=Lb.Iyb(this.Mqc);ec=Lb.Iyb(ec);return(Lb=Lb.ze(Wa.g(this.$).ha.sa.activeRange))&&(Gc.e(Ja)&&!Gc.e(ec)||!Gc.e(Ja)&&!Gc.e(ec)&&!wb.Q(Ja,ec))?Lb:null};H.prototype.Coj=function(){var Ja=this;Array.forEach(this.vE,function(Lb){if(Lb.eventId!==OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Lb.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Ja.Gg.Ri.i0b(Ja.controlId))if(Lb.eventId===
OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)Lb.S1b(new jb.a(Lb.eventId,Ja.controlId,null));else if(Lb.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){var ec=Ja.S2a(Lb.targetId);if((null===ec||void 0===ec?0:ec.IsValidRef)&&(Ja.$.ea.isNamedObjectViewMode?Ja.$.vb.pa.sheetName:Ja.$.xa.pa.name)===ec.Reference.SheetName){var Zb=Ja.wnj(ec);Zb&&Lb.S1b(new J(Lb.eventId,Ja.controlId,Ja.Gg.Z0b(ec),ec,Zb.top-1,Zb.left-1,Zb.height,Zb.width))}}})};H.prototype.fub=function(Ja,Lb){if(!this.vE)return null;
for(var ec=0;ec<this.vE.length;ec++){var Zb=this.vE[ec];if(Zb.eventId===Ja&&Zb.targetId===Lb)return Zb}return null};H.prototype.fTe=function(){for(var Ja=zb.a(this.$).XU,Lb=Ja.length-1;0<=Lb;--Lb){var ec=Ja[Lb];if(3===ec.floatingObject.type&&ec.floatingObject.el.InstanceId===this.n1.WebExtensionId)return ec}return null};H.prototype.dmi=function(){for(var Ja=0;Ja<this.$.vb.count;Ja++)if(this.$.vb.getItem(Ja).ALa===this.n1.WebExtensionId)return!0;return!1};H.prototype.zwc=function(Ja){this.sOc=Ja;this.hy.id=
this.BFf;this.hy.className=fc;this.hy.dir=this.$.isChromeRtl?"rtl":"ltr";this.Fqj()};H.prototype.O0e=function(){if(!this.enabled)return null;var Ja=Xb.a(this.el)?"":this.el.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.el.PrimaryMarketplace.SolutionId,Ja)};H.prototype.n5e=function(Ja,Lb){if(sa.EwaSettings.ma(24))this.Gg.kf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Lb);else try{if(va.ULS.sendTraceTag(537170462,0,50,"HandleDialogNotificationShownInAddinEvent called!"),
4!==this.Xce)this.Gg.kf(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,Lb);else{var ec={};ec[Ra.a.Vnb]=this.controlId;var Zb=new Nc.a(Ja,0,this.$.isEditMode?2:1,0,null);this.$.Ka.Kb(Zb,ec);this.Gg.Nu(Lb)}}catch(Oc){va.ULS.sendTraceTag(537170461,0,10,"HandleDialogNotificationShownInAddinEvent called. Error message: "+Oc.message+"."),this.Gg.kf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,Lb)}};H.Nih=function(Ja){return Ja===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Ja===
OSF.DDA.EventDispId.dispidBindingDataChangedEvent};H.Icf=function(Ja){return Ja===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||Ja===OSF.DDA.EventDispId.dispidSettingsChangedEvent||Ja===OSF.DDA.EventDispId.dispidRichApiMessageEvent};H.tnd=function(Ja){return Ja===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Ja===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};H.Gcf=function(Ja){return Ja===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent};H.Hcf=function(Ja){return Ja===
OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent};H.Fcf=function(Ja){return Ja===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent};of.Object.defineProperties(H.prototype,{controlId:{configurable:!0,enumerable:!0,get:function(){return this.Hd.InstanceId}},controlType:{configurable:!0,enumerable:!0,get:function(){return this.Hd.WebExtensionType}},ownerAddinSolutionId:{configurable:!0,enumerable:!0,get:function(){return this.Hd.OwnerAddinSolutionId}},$:{configurable:!0,enumerable:!0,
get:function(){return this.ib}},enabled:{configurable:!0,enumerable:!0,get:function(){return!this.DU}},hy:{configurable:!0,enumerable:!0,get:function(){return this.sOc}},oU:{configurable:!0,enumerable:!0,get:function(){return this.Hd.SrcLocationOverrideResourceId?this.Gg.y3a(this.Hd.PrimaryMarketplace.SolutionId,this.Hd.SrcLocationOverrideResourceId):this.Hd.PrimaryMarketplace.SolutionId}},sourceLocationOverrideResourceId:{configurable:!0,enumerable:!0,get:function(){return this.Hd.SrcLocationOverrideResourceId}},
el:{configurable:!0,enumerable:!0,get:function(){return this.Hd}},iha:{configurable:!0,enumerable:!0,get:function(){return this.g2d},set:function(Ja){this.g2d=Ja}},osfControlType:{configurable:!0,enumerable:!0,get:function(){return this.Xce}},iIa:{configurable:!0,enumerable:!0,get:function(){return this.pHc},set:function(Ja){this.pHc=Ja}},Z4c:{configurable:!0,enumerable:!0,get:function(){return this.vVa},set:function(Ja){this.vVa=Ja}},focusOnIframeWhenLoaded:{configurable:!0,enumerable:!0,get:function(){return this.Hd.FocusOnIframeWhenLoaded}},
spd:{configurable:!0,enumerable:!0,get:function(){return this.K9d},set:function(Ja){this.K9d=Ja}}});Object(ha.a)(H,"OsfControl",Hb.a,[793]);D.prototype.add=function(Ja){this.YYa[Ja]=!0};D.prototype.remove=function(Ja){delete this.YYa[Ja]};D.prototype.clear=function(){for(var Ja=ik(Object.keys(this.YYa)),Lb=Ja.next();!Lb.done;Lb=Ja.next())delete this.YYa[Lb.value]};D.prototype.D6e=function(){return 0<Object.keys(this.YYa).length};D.prototype.GIh=function(){return Object.keys(this.YYa)};Object(ha.a)(D,
"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,[]);var Yc=b(54);w.prototype.Sob=function(Ja){51===Ja.messageType?this.KOf=this.xGa(Ja.actionType,this.KOf,this.uIi):52===Ja.messageType&&(this.LOf=this.xGa(Ja.actionType,this.LOf,this.vIi))};w.prototype.xGa=function(Ja,Lb,ec){if(1===Ja)Lb||Wa.g(this.$).ha.Oa.cVc(ec),Lb++,this.ouj();else if(2===Ja){if(1>Lb)return Lb;1===Lb&&Wa.g(this.$).ha.Oa.nJd(ec);Lb--}return Lb};w.prototype.Xia=function(Ja,Lb,ec){Lb&&this.Ri.d_(Ja,Lb)&&this.Vh.zM(Ja,
Lb,ec)};w.prototype.Hac=function(Ja){return Ja&&Ja.floatingObject?(Ja=Ja.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&1===Ja.length?Ja[0]:null:null};w.prototype.yja=function(){var Ja=this.$.xa.pa;return Ja&&0===Ja.LF?Ja.sheetId:null};w.prototype.ouj=function(){var Ja=Wa.g(this.$).ha.Oa.pC;this.bnd(Ja)&&(this.pab=this.Hac(Ja),this.MLb=this.yja())};w.prototype.bnd=function(Ja){return!!Ja&&!!Ja.floatingObject&&0===Ja.floatingObject.type};Object(ha.a)(w,"RichApiEventChartActivatedDeactivatedHandler",
null,[]);var Mc=b(960),xb=b(202),wc=b(717),Ob=b(101),nc=b(363),mb=b(58),ic=la.a;$k(y,ic);y.prototype.G0b=function(Ja){Object(Ka.a)(nc.a,this.$.xa);1===Ja.actionType?(this.Oza||this.grid.ha.WD(this.Rc),this.Oza++):2!==Ja.actionType||1>this.Oza||(1===this.Oza&&this.grid.ha.ZH(this.Rc),this.Oza--)};y.prototype.jwc=function(Ja){Ja?this.DU++:(0<this.DU&&this.DU--,this.DU||this.Rc(null,new wc.a(!1)))};y.prototype.pYe=function(){return this.grid.ha.sa.selectedRanges};y.prototype.Wre=function(Ja,Lb){return sa.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?
(!!Ja&&xb.e(this.lNa)||Ja in this.lNa)&&!wb.Q(this.lNa[Ja],Lb):Ja in this.lNa&&!wb.Q(this.lNa[Ja],Lb)};y.prototype.$Ie=function(Ja,Lb,ec){this.lNa[Ja]=wb.d(Lb);this.sjc[Ja]=ec};y.prototype.zef=function(){return this.grid.isEditing||this.grid.vi};y.prototype.GTe=function(Ja,Lb){this.Ri.d_(14,Ja)&&this.Vh.zM(14,Ja,Lb);this.Ri.d_(14,Mc.a.QW)&&this.Vh.zM(14,Mc.a.QW,Lb)};y.prototype.M5h=function(Ja,Lb){var ec={};ec.worksheetId=Ja;ec.address=this.bgd(Lb);Lb=Yc.a.xc(ec);this.GTe(Ja,Lb)};y.prototype.y5h=
function(Ja,Lb,ec,Zb){if(this.Ri.Khf()){var Oc="",td="";Zb&&(Oc=Zb.ij);ec&&(td=ec.ij);Zb?ec?(Lb=ec.usedRange.Iyb(Lb),Oc!==td&&this.m$b(Oc,"",Ja),this.m$b(td,this.bgd(Lb),Ja)):this.m$b(Oc,"",Ja):ec&&(Oc=ec.usedRange.Iyb(Lb),this.m$b(td,this.bgd(Oc),Ja))}};y.prototype.m$b=function(Ja,Lb,ec){if(this.Ri.d_(100,Ja)){var Zb={};Zb.address=Lb;Zb.worksheetId=ec;this.Vh.zM(100,Ja,Yc.a.xc(Zb))}};y.prototype.bgd=function(Ja){return wb.i(Ja,",",this.$,!1)};y.prototype.dispose=function(){0<this.Oza&&this.grid.ha.ZH(this.Rc);
this.sjc=this.lNa=null;this.Oza=0;this.Vh=this.Ri=this.$=this.grid=null};of.Object.defineProperties(y.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return!this.DU&&0<this.Oza}}});Object(ha.a)(y,"RichApiEventSelectionChangedHandler",la.a,[]);var qc=b(359);$k(z,y);z.prototype.pYe=function(){return qc.a.Prb(this.grid.ha.rangePicker.CK)};z.prototype.Wre=function(Ja,Lb){return this.Hjf!==Ja||!wb.Q(this.Gjf,Lb)};z.prototype.$Ie=function(Ja,Lb){this.Hjf=Ja;this.Gjf=wb.d(Lb)};z.prototype.zef=
function(){return!this.grid.isEditing&&!this.grid.vi};z.prototype.GTe=function(Ja,Lb){this.Ri.d_(2700,Mc.a.QW)&&this.Vh.zM(2700,Mc.a.QW,Lb)};Object(ha.a)(z,"RichApiEventPickedRangesChangedHandler",y,[]);A.prototype.Sob=function(Ja){var Lb=Wa.g(this.$).ha;1===Ja.actionType?(this.gQa||this.hQa||Lb.Oa.cVc(this.xxf),2101===Ja.messageType?this.gQa++:2102===Ja.messageType&&this.hQa++):2===Ja.actionType&&(2101===Ja.messageType?this.gQa=0<this.gQa?this.gQa-1:0:2102===Ja.messageType&&(this.hQa=0<this.hQa?
this.hQa-1:0),this.gQa||this.hQa||Lb.Oa.nJd(this.xxf))};A.prototype.Oni=function(Ja){return!!Ja&&!!Ja.floatingObject&&(0===Ja.floatingObject.type||7===Ja.floatingObject.type||1===Ja.floatingObject.type||3===Ja.floatingObject.type||5===Ja.floatingObject.type)};A.prototype.SOj=function(Ja){if(!Ja||!Ja.floatingObject)return null;Ja=Ja.floatingObject.id;var Lb=Ja.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));Lb=Lb&&1===Lb.length?Lb[0]:null;return Lb?Lb:(va.ULS.sendTraceTag(537170457,344,
10,"Expect get the guid like shape id from the floating object id: '"+Ja+"', but we failed."),null)};A.prototype.yja=function(){var Ja=this.$.xa.pa;return Ja&&0===Ja.LF?Ja.sheetId:null};A.prototype.fireEvent=function(Ja,Lb,ec){Lb&&this.Ri.d_(Ja,Lb)&&this.Vh.zM(Ja,Lb,ec)};Object(ha.a)(A,"RichApiEventShapeActivatedDeactivatedHandler",null,[]);u.prototype.Sob=function(Ja){11===Ja.messageType?Ja.targetId===Mc.a.QW?this.vNg(Ja.actionType):this.uNg(Ja.actionType):12===Ja.messageType&&(Ja.targetId===Mc.a.QW?
this.wNg(Ja.actionType):this.xNg(Ja.actionType))};u.prototype.uNg=function(Ja){this.MOf=this.xGa(Ja,this.MOf,this.FVi)};u.prototype.xNg=function(Ja){this.POf=this.xGa(Ja,this.POf,this.IVi)};u.prototype.vNg=function(Ja){this.NOf=this.xGa(Ja,this.NOf,this.GVi)};u.prototype.wNg=function(Ja){this.OOf=this.xGa(Ja,this.OOf,this.HVi)};u.prototype.xGa=function(Ja,Lb,ec){1===Ja?Lb=this.xXc(Lb,ec):2===Ja&&(Lb=this.j6c(Lb,ec));return Lb};u.prototype.xXc=function(Ja,Lb){Ja||this.$.xa.Mf(Lb);Ja++;return Ja};u.prototype.j6c=
function(Ja,Lb){if(1>Ja)return Ja;1===Ja&&this.$.xa.ug(Lb);Ja--;return Ja};u.prototype.C7a=function(Ja){return!!Ja&&0===Ja.LF};u.prototype.Xia=function(Ja,Lb,ec,Zb){Lb=(void 0===Zb?0:Zb)?Mc.a.QW:Lb;this.Ri.d_(Ja,Lb)&&this.Vh.zM(Ja,Lb,ec)};Object(ha.a)(u,"RichApiEventSheetActivatedDeactivatedHandler",null,[]);var hc=b(249),Jc=b(13),rd=b(236),md=Sys.EventArgs;$k(l,md);Object(ha.a)(l,"ClickInActiveCellEventArgs",Sys.EventArgs,[]);x.prototype.dispose=function(){this.aRj()};x.prototype.G$i=function(){for(var Ja=
ik(this.gridView.hn),Lb=Ja.next();!Lb.done;Lb=Ja.next())Lb=Lb.value.domElement,hc.a.instance.ra(Jc.a.pointerDown,Lb,this.onPointerDown),rd.a.instance.ra(Jc.a.click,Lb,this.Zc)};x.prototype.aRj=function(){for(var Ja=ik(this.gridView.hn),Lb=Ja.next();!Lb.done;Lb=Ja.next())Lb=Lb.value.domElement,hc.a.instance.Ba(Jc.a.pointerDown,Lb,this.onPointerDown),rd.a.instance.Ba(Jc.a.click,Lb,this.Zc)};x.prototype.JVi=function(Ja){var Lb=Ja.sheet;if(this.C7a(Lb)){var ec={};ec.worksheetId=Lb.sheetId;ec.address=
Ja.OWg.toString();ec.offsetX=Ja.offsetX;ec.offsetY=Ja.offsetY;Ja=Lb.sheetId;this.Ri.d_(21,Ja)&&(Lb=Yc.a.xc(ec),this.Vh.zM(21,Ja,Lb));Ja=Mc.a.QW;this.Ri.d_(21,Ja)&&(ec=Yc.a.xc(ec),this.Vh.zM(21,Ja,ec))}};x.prototype.C7a=function(Ja){return!!Ja&&0===Ja.LF};Object(ha.a)(x,"RichApiEventSingleClickedHandler",null,[]);m.prototype.G0b=function(Ja){2E3===Ja.messageType&&(1===Ja.actionType?(this.iIb||Wa.g(this.$).ha.Oa.cVc(this.GEf),this.iIb++,this.Mqj()):2===Ja.actionType&&this.iIb&&(1===this.iIb&&Wa.g(this.$).ha.Oa.nJd(this.GEf),
this.iIb--))};m.prototype.Iad=function(Ja){var Lb,ec={};ec.worksheetId=Ja;ec.revisionLoad=!1;if(sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")&&(sa.EwaSettings.ma(717)||sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSChartPlayerManualPlacement",!1))){var Zb=Wa.g(this.$).ha.Oa.pC;(null===(Lb=null===Zb||void 0===Zb?void 0:Zb.floatingObject)||void 0===Lb?0:Lb.Pc)?ec.selectedVisualId=Zb.floatingObject.Pc.VisualID:ec.selectedVisualId=
null}Lb=Yc.a.xc(ec);Ja&&this.Ri.d_(2E3,Ja)&&this.Vh.zM(2E3,Ja,Lb)};m.prototype.yja=function(){var Ja=this.$.xa.pa;return Ja&&0===Ja.LF?Ja.sheetId:null};m.prototype.Mqj=function(){var Ja=Wa.g(this.$).ha.Oa.pC;this.wif(Ja)&&(this.mab=Ja.floatingObject.id,this.gab=this.yja())};m.prototype.wif=function(Ja){return!!Ja&&Ja.Drd()};Object(ha.a)(m,"RichApiEventVisualSelectionChangedHandler",null,[]);v.prototype.tNg=function(Ja){1===Ja.actionType?(this.jIb||this.PNg(),this.jIb++):2!==Ja.actionType||1>this.jIb||
(1===this.jIb&&this.wfh(),this.jIb--)};v.prototype.PNg=function(){if(this.Ri.d_(2203,Mc.a.QW))if(this.hqd){var Ja={};Ja.timeout=this.$.ya.CheckFocusTimeout;this.D$b=window.requestIdleCallback(this.dye,Ja)}else this.D$b=window.setInterval(this.cye,this.$.ya.CheckFocusTimeInterval)};v.prototype.wfh=function(){this.hqd?window.cancelIdleCallback(this.D$b):window.clearInterval(this.D$b)};Object(ha.a)(v,"RichApiEventWorkbookActivatedHandler",null,[]);var Cc;(function(Ja){Ja[Ja.none=0]="none";Ja[Ja.registerEvent=
1]="registerEvent";Ja[Ja.unregisterEvent=2]="unregisterEvent";Ja[Ja.customFunction=3]="customFunction";Ja[Ja.showCard=4]="showCard";Ja[Ja.createWorkbook=5]="createWorkbook";Ja[Ja.openWorkbook=6]="openWorkbook";Ja[Ja.enableEvents=7]="enableEvents";Ja[Ja.closeWorkbook=8]="closeWorkbook";Ja[Ja.setCalculationMode=9]="setCalculationMode";Ja[Ja.workbookLinksRequestRefresh=10]="workbookLinksRequestRefresh";Ja[Ja.workbookLinksRequestRefreshAll=11]="workbookLinksRequestRefreshAll";Ja[Ja.workbookLinksEnableContent=
12]="workbookLinksEnableContent";Ja[Ja.workbookLinksFindNextLink=13]="workbookLinksFindNextLink";Ja[Ja.workbookLinksOpenWorkbook=14]="workbookLinksOpenWorkbook";Ja[Ja.rangePicker=15]="rangePicker";Ja[Ja.enableRichApiRecording=16]="enableRichApiRecording";Ja[Ja.recordAction=17]="recordAction";Ja[Ja.focus=18]="focus";Ja[Ja.businessBarShow=19]="businessBarShow";Ja[Ja.businessBarHide=20]="businessBarHide"})(Cc||(Cc={}));Object(ha.b)("PostProcessActionType",Cc);var fd=b(260);f.prototype.sNg=function(Ja){1===
Ja.actionType?(this.$.Jba=!0,Object(Ka.a)(b(957).DdaFacade,fd.a(this.$)).Had(!0)):2===Ja.actionType&&(this.$.Jba=!1);this.CFf=Ja.controlId;va.ULS.sendTraceTag(537170456,0,50,"AttachOrDetachMacroRecorderEventHandler: actionType: "+Cc[Ja.actionType]+"; controlId: "+this.CFf+"; this.ewaControl.IsMacroRecorderListening: "+this.$.Jba+".")};f.prototype.Nmh=function(Ja){Object(Ka.a)(b(957).DdaFacade,fd.a(this.$)).JTe(Ja,this.$.Jba)};f.prototype.Gbi=function(){var Ja=this;this.$.Nba&&hb.TaskExtensions.Aa(wa.GetServiceTaskFactory.Ra(this.$.da,
297,298,1),function(Lb){(Lb=Lb.result)&&Lb.init(Ja.Gad)},this.$.la,3)};Object(ha.a)(f,"RichApiMacroRecorderEventHandler",null,[]);Object(ha.a)(n,"SessionRecreationInfo",null,[]);k.prototype.WDi=function(){return sa.EwaSettings.ma(260)?this.Ri.u6h()||0!==this.runtimeCalculationMode:!1};k.prototype.DSg=function(){var Ja={};Ja.eventRegistrationInfos=this.Ri.YOh();Ja.runtimeCalculationMode=this.runtimeCalculationMode;Ja=Object(ya.a)(new n,{runtimeState:Ja});var Lb={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",
RequestHeaders:null};Lb.RequestBody=JSON.stringify(Ja);Lb.RequestFlags=1;return Lb};Object(ha.a)(k,"RichApiRuntimeStateHandler",null,[]);Object(ha.a)(h,"UserOperationQueueItemsStatisticsData",null,[]);var Cd=b(345),Sc=b(30),Md=b(19),bc=b(312),xe=b(48),Je=b(666),we=b(64),de=b(59),Le=b(69),Ie=Cd.a;$k(e,Ie);e.prototype.dispose=function(){this.$&&(this.$.xa.JK(this.oo),this.$.vb.JK(this.oo),this.$.vb.ug(this.me),this.$.xa.ug(this.me));this.lUa&&(this.lUa.Eq(this.ff),this.lUa.YH(this.Dm),this.lUa.gv(this.yi));
sa.EwaSettings.Zb()&&this.ny(this.yya);this.clearCache();Ab.a.Ia(this.lUa);this.lUa=null;Fb.DOMElementExtensions.gf(this.domElement);Ie.prototype.dispose.call(this)};e.prototype.Eqj=function(Ja){Fb.DOMElementExtensions.gf(Fb.DOMElementExtensions.getElementById(this.domElement,Ja.id));this.domElement.appendChild(Ja)};e.prototype.Bld=function(){if(this.Hva&&!this.f4b){var Ja=Object(Ka.a)(b(957).DdaFacade,fd.a(this.$)).Tm(this.Hva.InstanceId);Ja&&(Ja.resize(this.Hva.Width,this.Hva.Height),Ja.ka(this.domElement),
Ja.showHide(!0),this.f4b=!0)}};e.prototype.E7a=function(){return!0};e.prototype.Dna=function(Ja){this.Hva=Ja.ed.block.ke;this.f4b=!1;this.Bld()};e.prototype.GTa=function(Ja){this.$.ea.c_&&Ja&&(Ja.qu||(Ja.qu=new bc.a),Ja.qu.Hh=new xe.a(this.domElement.scrollLeft,this.domElement.scrollTop),Ja.qu.RGb=20)};e.prototype.clearCache=function(){this.Ea.lQa(this.hashCode);this.Hva=this.hashCode=null;this.f4b=!1};e.prototype.HSa=function(Ja,Lb){if(this.isVisible=!!Ja&&we.o(Ja))this.hashCode=this.Ea.Lra(Ja,de.a.o6b,
this.hashCode),this.Nwc(Lb)};e.yGa=function(Ja){if(!Ja.da.za(34)){var Lb=Ja.uf;Ja.da.Ga(34,new e(Ja,new Je.a(Ja,Ja.ea,Ja.oa.Fk,3,0),Lb.appendChild(Lb.ownerDocument.createElement("div"))))}};of.Object.defineProperties(e.prototype,{Ea:{configurable:!0,enumerable:!0,get:function(){return this.lUa}}});Object(ha.a)(e,"WebExtensionView",Cd.a,[790,428,6]);var jf=b(238),df=b(572),Be=b(394),Sd=b(476),vc=b(177),qd=b(62),Jd=b(121),ld=b(47),Kd=b(45),re=b(159),ie=b(111),ef=b(66),Fe=b(28),bf=b(31),Oe=b(299),lc=
b(22),Fa=b(14),Kb=b(298),gb=b(959),Tb=b(51),pc=b(153),Xc=b(1085),pd=b(210),Uc=b(1084),sd=b(25);b.d(E,"DdaFacade",function(){return a});var Nb=Jb.a;$k(a,Nb);a.prototype.kne=function(Ja){this.addHandler("cd",Ja)};a.prototype.jcj=function(Ja){this.removeHandler("cd",Ja)};a.prototype.IFg=function(Ja){this.addHandler("csc",Ja)};a.prototype.lcj=function(Ja){this.removeHandler("csc",Ja)};a.prototype.FFg=function(Ja){this.addHandler("ca",Ja)};a.prototype.icj=function(Ja){this.removeHandler("ca",Ja)};a.prototype.GFg=
function(Ja){this.addHandler("ci",Ja)};a.prototype.HFg=function(Ja){this.addHandler("ekros",Ja)};a.prototype.kcj=function(Ja){this.removeHandler("ekros",Ja)};a.prototype.bDd=function(Ja,Lb){try{return JSON.parse(Ja)[Lb].toLowerCase()}catch(ec){return""}};a.prototype.gxj=function(Ja){var Lb=this.bDd(Ja,"AudienceGroup"),ec=this.bDd(Ja,"SessionOrigin");try{var Zb=parseInt(this.bDd(Ja,"Ring"),10);if("automation"!==Lb&&"bluechicken"!==ec&&-2<=Zb)return!0}catch(Oc){if("automation"!==Lb&&"bluechicken"!==
ec)return!0}return!1};a.prototype.Z0b=function(Ja){var Lb={};Lb.Name=Ja.Name;Lb.BindingType=Ja.BindingType;Lb.HasHeaders=Ja.HasHeaders;Ja.IsValidRef&&(Lb.ColCount=Ja.Reference.LastColumn-Ja.Reference.FirstColumn+1,Lb.RowCount=Ja.Reference.LastRow-Ja.Reference.FirstRow+1);return Lb};a.prototype.Isi=function(Ja,Lb){this.Jm.launchInsertDialog(Ja,null,this.HRg(Lb))};a.prototype.bda=function(Ja,Lb){if(pa.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType"))this.rKf(Ja,
Lb,OSF.StoreTypeEnum.MarketPlace);else{var ec={};ec.callbackFunc=Ja;ec.storeType=OSF.StoreTypeEnum.MarketPlace;ec.fromInsertDialog=!1;ec.refresh=Lb;this.Jm.queryEntitlementDetails(ec)}};a.prototype.rKf=function(Ja,Lb,ec){var Zb={};Zb.callbackFunc=Ja;Zb.storeType=ec;Zb.fromInsertDialog=!1;Zb.refresh=Lb;this.Jm.queryEntitlementDetails(Zb)};a.prototype.invokeDdaMethod=function(Ja,Lb){var ec=this.Tm(Ja.DdaMethod.ControlId);ec?ec.invokeDdaMethod(Ja,Lb):this.kf(ka.a.internalError,Lb)};a.prototype.registerDdaEventAsync=
function(Ja,Lb,ec,Zb,Oc){(Lb=this.Tm(Lb))?a.vzb(Ja)?Lb.i9i(Ja,ec,Zb,Oc):this.kf(ka.a.uCd,Oc):this.kf(ka.a.internalError,Oc)};a.prototype.unregisterDdaEventAsync=function(Ja,Lb,ec,Zb,Oc){(Lb=this.Tm(Lb))?a.vzb(Ja)?Lb.GQj(Ja,ec,Zb,Oc):this.kf(ka.a.uCd,Oc):this.kf(ka.a.internalError,Oc)};a.prototype.dispose=function(){this.disposed||(this.$.sl(this.Yc),this.ea.wk(this.Uc),this.ea.ER(this.ro),this.ea.Ew(this.Sf),this.dWc.detach(this),this.$.userOperationManager.to(this.oR),this.jpc=this.pf=this.Vh=this.dWc=
this.ib=null,this.RIa&&(this.RIa.dispose(),this.RIa=null),Ab.a.Ia(this.cMd),Ab.a.Ia(this.bMd),this.o1a&&(this.o1a.dispose(),this.o1a=null),Nb.prototype.dispose.call(this),this.disposed=!0,va.ULS.sendTraceTag(537170583,0,50,"DdaFacade is disposed"))};a.prototype.Hdd=function(Ja){return(Ja=this.Tm(Ja))?Ja.getDefaultIconUrl():null};a.prototype.jwc=function(Ja){if(this.KFe!==Ja){this.KFe=Ja;for(var Lb=0,ec=this.pf.length;Lb<ec;Lb++){var Zb=this.pf[Lb];Ja?Zb.aIe(!1):Zb.Elh()}this.cMd.jwc(Ja);this.bMd.jwc(Ja)}};
a.prototype.HNh=function(Ja){return(Ja=this.Tm(Ja))?Ja.getDefaultDisplayName():null};a.prototype.kf=function(Ja,Lb,ec){var Zb={};Zb[ca.a.Wf]=Ja;Zb[ca.a.B3]=Lb;this.VJ(451041795,Zb,void 0===ec?!0:ec)};a.prototype.Nu=function(Ja){var Lb={};Lb[ca.a.B3]=Ja;this.VJ(1237877382,Lb)};a.prototype.VJ=function(Ja,Lb,ec){var Zb=this;ec=void 0===ec?!0:ec;var Oc=new Nc.a(Ja,0,this.$.Jc,0,null),td=Lb?Lb[ca.a.B3]:null;this.o1a&&Wa.g(this.$).isEditing&&K.D0g(Ja,Lb)?this.o1a.neh(Ja,Lb):(Ja=this.$.Ka.Kb(Oc,Lb),ec&&
hb.TaskExtensions.Aa(Ja,function(Gd){re.a(Gd)?Zb.kf(ka.a.internalError,td,!1):Gd.result||(Wa.g(Zb.$).isEditing?Zb.kf(ka.a.Jyb,td,!1):Zb.kf(ka.a.internalError,td,!1))},this.la,8))};a.prototype.d3g=function(Ja){var Lb=this;return!!this.Wia(function(ec){return a.getSolutionId(ec.el,Lb.$)===a.getSolutionId(Ja,Lb.$)&&ec.el.PrimaryMarketplace.MarketplaceType===Ja.PrimaryMarketplace.MarketplaceType&&ec.el.PrimaryMarketplace.MarketplaceRef===Ja.PrimaryMarketplace.MarketplaceRef&&ec.el.PrimaryMarketplace.SolutionVersion===
Ja.PrimaryMarketplace.SolutionVersion})};a.prototype.Tm=function(Ja){return this.Wia(function(Lb){return Lb.controlId.startsWith(Ja)})};a.prototype.ZBh=function(Ja){return this.Wia(function(Lb){return Lb.iIa===Ja})};a.prototype.gTe=function(Ja){return this.Wia(function(Lb){return Lb.oU===Ja&&!!Lb.iIa})};a.prototype.yTe=function(Ja,Lb,ec,Zb){return this.Wia(function(Oc){return Oc.oU===Ja&&Oc.el.PrimaryMarketplace.MarketplaceRef.toLowerCase()===Lb.toLowerCase()&&Oc.el.PrimaryMarketplace.MarketplaceType.toLowerCase()===
ec.toLowerCase()&&!!Oc.el.SharedRuntime&&!!Oc.el.SharedRuntime.Resid&&!!Zb&&!!Zb.Resid&&Oc.el.SharedRuntime.Resid.toLowerCase()===Zb.Resid.toLowerCase()})};a.prototype.hNg=function(Ja,Lb){if(Ja=this.Tm(Ja))Ja.ka(Lb),Ja.showHide(!0)};a.prototype.wBj=function(Ja){(Ja=this.Tm(Ja))&&Ja.showHide(!1)};a.prototype.P0a=function(Ja){var Lb;if(1!==Ja.WebExtensionType||this.$.Bd&8388608&&Ja.TaskpaneVisible||this.$.Bd&8388608&&!Ja.TaskpaneVisible&&ob.HelperMethods.hw(Ja)){var ec=null;ob.HelperMethods.hw(Ja)&&
(ec=a.Uua(Ja,this.$),Ja.TaskpaneWidth||(Ja.TaskpaneWidth=this.u6b));var Zb=(new H(this,this.Vh,Ja)).old();va.ULS.sendTraceTag(51263011,0,50,"DdaFacade::CreateOsfControl: SolutionId: "+Telemetry.PrivacyRules.GetPrivacyCompliantId(Ja.PrimaryMarketplace.SolutionId,Ja.PrimaryMarketplace.MarketplaceType,null===(Lb=Ja.AssetMarketplace)||void 0===Lb?void 0:Lb.SolutionId,null,null,Ja.PrimaryMarketplace.MarketplaceRef)+", StoreType: "+Ja.PrimaryMarketplace.MarketplaceType+", UseShareRuntime: "+ob.HelperMethods.hw(Ja));
ec&&(Zb.iIa=ec);this.pf.push(Zb);this.txa=null;this.X5a(Ja.InstanceId)||(Ja=String.format("{0}|{1}|{2}|{3}|{4}",Ja.PrimaryMarketplace.SolutionId,Ja.PrimaryMarketplace.SolutionVersion,Ja.PrimaryMarketplace.MarketplaceRef,Ja.PrimaryMarketplace.MarketplaceType,Ja.WebExtensionType),this.raiseEvent("ci",Ja))}};a.prototype.eDj=function(Ja,Lb){function ec(){Zb.nQa(td.controlId);Zb.Th.purgeOsfControl(td.controlId,!1);Lb()}var Zb=this;Ja.TaskpaneWidth=this.u6b;Ja.TaskpaneVisible=!0;var Oc={};Oc.SolutionId=
Ja.PrimaryMarketplace.SolutionId;Oc.TargetType=Ja.WebExtensionType;Oc.Version=Ja.PrimaryMarketplace.SolutionVersion;Oc.StoreType=Ja.PrimaryMarketplace.MarketplaceType;Oc.StoreId=Ja.PrimaryMarketplace.MarketplaceRef;Oc.AssetId=Ja.PrimaryMarketplace.SolutionId;Oc.AssetStoreId=Ja.PrimaryMarketplace.MarketplaceRef;Oc.Width=Ja.TaskpaneWidth;var td=new H(this,this.Vh,Ja,!0);td.old();this.pf.push(td);var Gd=null;Gd=ld.a.instance.pE(function(){td.hy&&(Ab.a.Ia(Gd),Gd=null,Zb.Th.insertBlankControlWithErrorUX(Zb.YGb(td,
Oc),ec))},100,Kd.a.ddh)};a.prototype.X6g=function(Ja){var Lb=this;if(Ja&&Ja.length){var ec=[];Ja.forEach(function(Zb){if(Zb.ContainsCustomFunctions){var Oc=a.Uua(Zb,Lb.$);Lb.zDd.contains(Oc)||(Lb.zDd.add(Oc),Lb.UGf.push(Zb));Lb.d3g(Zb)||ec.push(Zb)}});ec.length&&this.SCe(ec)}};a.prototype.QEe=function(Ja,Lb){this.Tm(Ja.InstanceId)||(Lb=Lb(),Ja=(new H(this,this.Vh,Ja)).p$e(Lb),this.pf.push(Ja),this.txa=null)};a.prototype.RAj=function(Ja){a.i1a.kb(Ja)&&a.i1a.na(Ja).initializeAndShowWithTitle()};a.prototype.s7h=
function(Ja){a.i1a.kb(Ja)&&a.i1a.na(Ja).hide()};a.prototype.yUh=function(Ja){var Lb=this,ec=null,Zb,Oc=null;var td=a.thd(Ja,!0);if(!td)return va.ULS.sendTraceTag(537170570,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),mb.Task.Ua(null);(Zb=this.Jm.getOsfControl(a.getSolutionId(td,this.$)))&&(ec=Zb.getManifest())&&(Oc=ec.getSharedRuntimeForCustomFunctions("Workbook"));if(ec=Oc&&1===Oc.LifeTime?this.yTe(td.PrimaryMarketplace.SolutionId,td.PrimaryMarketplace.MarketplaceRef,
td.PrimaryMarketplace.MarketplaceType,Oc):this.ZBh(Ja))return mb.Task.Ua(ec.controlId);var Gd=new yb.a;ob.HelperMethods.Qic(Oc)&&(td.SharedRuntime=Oc);Ja=Zb?Zb.getNotificationParams():[];if(!Ja.length)return this.vDe(td);this.s3f(Ja,function(){hb.TaskExtensions.Aa(Gd.task,function(){Lb.vDe(td)},Lb.la,3)},function(){});return Gd.task};a.prototype.EIh=function(Ja){Ja=a.thd(Ja,!1);if(!Ja)return va.ULS.sendTraceTag(537170569,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),null;var Lb=
null,ec=this.Jm.getOsfControl(a.getSolutionId(Ja,this.$));ec&&(ec=ec.getManifest())&&(Lb=ec.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));return ob.HelperMethods.Qic(Lb)&&(Ja=this.yTe(Ja.PrimaryMarketplace.SolutionId,Ja.PrimaryMarketplace.MarketplaceRef,Ja.PrimaryMarketplace.MarketplaceType,Lb))?Ja.controlId:null};a.prototype.s5g=function(Ja,Lb){var ec=this,Zb=a.thd(Ja,!1);if(Zb){var Oc=null,td=this.Jm.getOsfControl(a.getSolutionId(Zb,this.$));td&&(td=td.getManifest())&&(Oc=td.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));
if(ob.HelperMethods.Qic(Oc)){Zb.SharedRuntime=Oc;var Gd=Zb.PrimaryMarketplace.SolutionId;td=Zb.PrimaryMarketplace.SolutionVersion;var Pd=OSF.OsfManifestManager.getCachedManifest(Gd,td);if(Pd)if(this.r_b.kb(Ja))Oc=this.r_b.na(Ja),hb.TaskExtensions.Aa(Oc,function($c){($c=$c.result)&&OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady($c,Lb,ec.Vh.DKb)},this.la,3);else{var ee={solutionId:Gd,version:td};ee.storeType=Zb.PrimaryMarketplace.MarketplaceType;ee.storeId=Zb.PrimaryMarketplace.MarketplaceRef;
ee.assetId=Gd;ee.assetStoreId=null;ee.targetType=OSF.OsfControlTarget.TaskPane;var Ec=new yb.a;Zb=hb.TaskExtensions.kk();Zb=new Ba.a(this.$,this,ee,Zb);Oc=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(Gd,Oc.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(Pd,Oc,td);Zb.createUILessSandbox(ee,Pd,function($c,id){$c&&!id?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady($c,Lb,ec.Vh.DKb),Ec.setResult($c)):Ec.setResult(null);ec.r_b.remove(Ja)});this.r_b.ia(Ja,
Ec.task)}}}else va.ULS.sendTraceTag(537170568,0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")};a.prototype.Sxe=function(Ja){(Ja=this.gTe(Ja))&&(Ja.el.SharedRuntime||this.sIb(Ja.controlId))};a.prototype.sIb=function(Ja){(Ja=this.gTe(Ja))&&this.nQa(Ja.controlId)};a.prototype.iih=function(Ja,Lb){if(!this.pf||!Ja||!Lb)return!1;if(Ja.toLowerCase()===Lb.toLowerCase())return!0;for(var ec=null,Zb=null,Oc=0,td=this.pf.length;Oc<td;Oc++){var Gd=this.pf[Oc];if(Gd.ownerAddinSolutionId&&
(Gd.controlId===Ja&&(ec=Gd.ownerAddinSolutionId.toLowerCase()),Gd.controlId===Lb&&(Zb=Gd.ownerAddinSolutionId.toLowerCase()),ec&&Zb))break}return ec&&ec===Zb?!0:!1};a.prototype.kDg=function(Ja){this.Tm(Ja.InstanceId)||(Ja=new H(this,this.Vh,Ja),this.pf.push(Ja),this.txa=null)};a.prototype.IPf=function(Ja){if(this.pf&&0<=Ja&&Ja<this.pf.length){var Lb=this.pf[Ja],ec=Lb.hy;this.pf.splice(Ja,1);this.owf(Lb);Fb.DOMElementExtensions.gf(ec)}};a.prototype.nQa=function(Ja){if(this.pf)for(var Lb=0,ec=this.pf.length;Lb<
ec;Lb++)if(this.pf[Lb].controlId===Ja){this.IPf(Lb);break}};a.prototype.kbj=function(Ja){if(this.pf){Ja=Ja.toLowerCase();for(var Lb=0,ec=this.pf.length;Lb<ec;Lb++)if(Ja===this.pf[Lb].ownerAddinSolutionId.toLowerCase()){this.IPf(Lb);break}}};a.prototype.ONg=function(Ja){Ja.Zm&&(this.Tm(Ja.floatingObject.el.InstanceId)||(this.Ifc(Ja.floatingObject.el.InstanceId)||this.jpc.push(Ja.floatingObject.el.InstanceId),this.P0a(Ja.floatingObject.el)),this.ea.isNamedObjectViewMode&&this.hNg(Ja.floatingObject.el.InstanceId,
Ja.Dd))};a.prototype.Gaa=function(Ja){if(this.pf)for(var Lb=0,ec=this.pf.length;Lb<ec;Lb++)if(1===this.pf[Lb].controlType&&lc.a.equals(this.pf[Lb].oU,Ja,!0))return this.pf[Lb].controlId;return null};a.prototype.ABh=function(Ja){var Lb=[];if(this.pf)for(var ec=0,Zb=this.pf.length;ec<Zb;ec++)lc.a.equals(this.pf[ec].oU,Ja,!0)&&Lb.push(this.pf[ec].controlId);return Lb};a.prototype.fCh=function(Ja,Lb){if(!Lb||!Ja)return null;if(this.pf)for(var ec=0,Zb=this.pf.length;ec<Zb;ec++)if(1===this.pf[ec].controlType&&
lc.a.equals(this.pf[ec].oU,Ja,!0)&&this.pf[ec].el.SharedRuntime&&lc.a.equals(this.pf[ec].el.SharedRuntime.Resid,Lb.Resid,!0))return this.pf[ec].controlId;return null};a.prototype.y3a=function(Ja,Lb){Lb=void 0===Lb?null:Lb;return Ja?Lb?Ja+"."+Lb:Ja:""};a.prototype.Vxe=function(Ja,Lb,ec){if(this.txa===Ja)return!0;this.txa=Ja;var Zb=null,Oc=!1;if(!Zb&&this.pf)for(var td=0,Gd=this.pf.length;td<Gd;td++)if(1===this.pf[td].controlType&&lc.a.equals(this.pf[td].oU,Ja,!0)){var Pd=!1,ee=!1;Lb?(Pd=!0,ee=!!this.pf[td].el.SharedRuntime&&
lc.a.equals(this.pf[td].el.SharedRuntime.Resid,Lb.Resid,!0)):ec&&(Pd=!0,ee=lc.a.equals(this.pf[td].el.SharedRuntimeId,ec,!0));if(!Pd||ee){ee&&this.pf[td].$f(!0);Zb=this.pf[td].controlId;Oc=!0;this.txa=null;break}}Zb&&this.raiseEvent("ca",Zb);return Oc};a.prototype.setAppRuntimeState=function(Ja,Lb){var ec;if(Ja){var Zb=this.Tm(Ja);if(Zb&&ob.HelperMethods.hw(Zb.el))Zb.$f(Lb),Lb&&(this.raiseEvent("ca",Ja),(null===(ec=Zb.hy)||void 0===ec?0:ec.firstChild)&&(Ja=Zb.hy.firstChild.title)&&0<Ja.length&&this.r0b.uoj(Ja));
else throw va.ULS.sendTraceTag(537170565,0,50,"SetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(Fa.a.instance.ga(2228));}else throw va.ULS.sendTraceTag(537170564,0,15,"SetAppRuntimeState: Invalid controlId."),Error.invalidOperation(Fa.a.instance.ga(2229));};a.prototype.getAppRuntimeState=function(Ja){if(Ja)if((Ja=this.Tm(Ja))&&ob.HelperMethods.hw(Ja.el))Ja=Ja.el.TaskpaneVisible;else throw va.ULS.sendTraceTag(537170563,0,50,"GetAppRuntimeState: run on non-shared runtime app."),
Error.invalidOperation(Fa.a.instance.ga(2228));else throw va.ULS.sendTraceTag(537170562,0,15,"GetAppRuntimeState: Invalid controlId."),Error.invalidOperation(Fa.a.instance.ga(2229));return Ja};a.prototype.S2a=function(Ja,Lb){return(Ja=this.Tm(Ja))?Ja.S2a(Lb):null};a.prototype.X5a=function(Ja){return this.Xxe(this.jpc,Ja)};a.prototype.Ifc=function(Ja){return this.Xxe(this.FFe,Ja)};a.prototype.sle=function(Ja){this.FFe.push(Ja)};a.prototype.pZ=function(Ja){return(Ja=this.Tm(Ja))?Ja.el:null};a.prototype.syd=
function(Ja){this.raiseEvent("ekros",Ja,this)};a.prototype.XBd=function(Ja){if(Ja){var Lb=this.Tm(Ja.InstanceId);Lb&&(Ja.SharedRuntime||Ja.SharedRuntimeId||(this.nQa(Lb.controlId),this.Th.purgeOsfControl(Lb.controlId,!1)),Lb={},Lb.SolutionId=Ja.PrimaryMarketplace.SolutionId,Lb.TargetType=Ja.WebExtensionType,Lb.Version=Ja.PrimaryMarketplace.SolutionVersion,Lb.StoreType=Ja.PrimaryMarketplace.MarketplaceType,Lb.StoreId=Ja.PrimaryMarketplace.MarketplaceRef,Lb.AssetId=Ja.PrimaryMarketplace.SolutionId,
Lb.AssetStoreId=Ja.PrimaryMarketplace.MarketplaceRef,Lb.Width=Ja.TaskpaneWidth,Lb.SharedRuntimeId=Ja.SharedRuntimeId,this.qag(Lb))}};a.prototype.Cia=function(){this.Vh.Cia()};a.prototype.zM=function(Ja,Lb,ec){this.Vh.zM(Ja,Lb,ec)};a.prototype.JTe=function(Ja,Lb){Lb=a.G$g(Lb);Ja=this.pZ(Ja);this.Vh.l$b(Ja.InstanceId,2202,Mc.a.QW,Lb)};a.prototype.Had=function(Ja){for(var Lb=0,ec=this.pf.length;Lb<ec;Lb++)this.JTe(this.pf[Lb].controlId,Ja)};a.prototype.qCh=function(Ja,Lb){Lb=a.Y5g(Lb);this.Vh.l$b(Ja,
65539,"",Lb)};a.prototype.sCh=function(Ja,Lb,ec){this.Vh.l$b(Ja,1,Lb,ec)};a.prototype.pCh=function(Ja,Lb){this.Vh.tCh(Ja,Lb)};a.prototype.p5g=function(Ja,Lb){return[[2,1E3,"",JSON.stringify([Ja,Lb]),0,!1]]};a.prototype.bgi=function(){return!!this.fna&&this.fna.D6e()};a.prototype.dZg=function(){this.fna&&this.fna.clear()};a.prototype.rCh=function(){if(this.fna&&this.fna.D6e()){var Ja=this.fna.GIh();Ja=ik(Ja);for(var Lb=Ja.next();!Lb.done;Lb=Ja.next()){Lb=this.ABh(Lb.value);Lb=ik(Lb);for(var ec=Lb.next();!ec.done;ec=
Lb.next())this.Vh.l$b(ec.value,65540,"","{}")}}};a.prototype.a9i=function(Ja){this.fna.add(Ja)};a.prototype.DQj=function(Ja){this.fna.remove(Ja)};a.prototype.Wia=function(Ja){if(!this.pf)return null;for(var Lb=ik(this.pf),ec=Lb.next();!ec.done;ec=Lb.next())if(ec=ec.value,Ja(ec))return ec;return null};a.prototype.vDe=function(Ja){var Lb=this,ec=new yb.a,Zb=a.Uua(Ja,this.$);if(ob.HelperMethods.hw(Ja))va.ULS.sendTraceTag(537170531,0,50,"Shared runtime custom function agave is started."),this.RGf(Ja,
function(td){td?(Ja.InstanceId=td.InstanceId,Ja.WebExtensionOsfControlType=3,Ja.TaskpaneVisible=!1,Lb.P0a(Ja),ec.setResult(Ja.InstanceId)):(va.ULS.sendTraceTag(537170530,0,10,"InsertAgaveTaskPane for customfunction: "+Telemetry.PrivacyRules.GetPrivacyCompliantId(Ja.PrimaryMarketplace.SolutionId,Ja.PrimaryMarketplace.MarketplaceType,null,null,null,Ja.PrimaryMarketplace.MarketplaceRef)+" failed"),ec.setException(Error.create("Null insert data")))});else{a.i1a.ia(Ja.InstanceId,new V.a);var Oc=a.i1a.na(Ja.InstanceId).B1a;
this.W6g(Ja,Oc,Zb);this.RGf(Ja,null);ec.setResult(Ja.InstanceId)}return ec.task};a.prototype.W6g=function(Ja,Lb,ec){this.Tm(Ja.InstanceId)||(Ja=new H(this,this.Vh,Ja),Ja.iIa=ec,Ja.p$e(Lb),this.pf.push(Ja),this.txa=null)};a.prototype.RGf=function(Ja,Lb){var ec=a.Uua(Ja,this.$);if(!this.zDd.contains(ec))this.yGb.push(Ja),1<=this.yGb.length&&this.SGf(Ja,Lb);else if(Lb){Ja=ik(this.UGf);for(var Zb=Ja.next();!Zb.done;Zb=Ja.next())if(Zb=Zb.value,a.Uua(Zb,this.$)===ec){Lb(Zb,0);break}}};a.prototype.SGf=function(Ja,
Lb){function ec($c){$c&&!Oe.a($c)||va.ULS.sendTraceTag(537170527,0,10,"InsertAgaveTaskPane for addin "+Telemetry.PrivacyRules.GetPrivacyCompliantId(Gd.SolutionId,Gd.StoreType,Gd.AssetId,null,null,Gd.StoreId)+" finish with errors: "+bf.a.Cc($c.Errors));Oc.yGb.shift();0<Oc.yGb.length&&Oc.SGf(Oc.yGb[0],Lb)}function Zb($c){$c=Jd.a.xf($c.data);va.ULS.sendTraceTag(537170528,0,10,"DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: "+bf.a.Cc($c))}
var Oc=this,td=null,Gd={};Gd.SolutionId=a.getSolutionId(Ja,this.$);Gd.TargetType=Ja.WebExtensionType;Gd.Version=Ja.PrimaryMarketplace.SolutionVersion;Gd.StoreType=Ja.PrimaryMarketplace.MarketplaceType;Gd.StoreId=Ja.PrimaryMarketplace.MarketplaceRef;Gd.AssetId=Ja.PrimaryMarketplace.SolutionId;Gd.AssetStoreId=Ja.PrimaryMarketplace.MarketplaceRef;Gd.Width=Ja.TaskpaneWidth;Gd.ContainsCustomFunctions=!0;ob.HelperMethods.hw(Ja)&&(Gd.SharedRuntimeId=Ja.SharedRuntime.Resid);var Pd=this.$.oa.va;Ja=this.$.oa.va.Pb();
var ee=Pd.Na(9,Ja);ee.sharedInfo=Gd;if(Lb){var Ec=function($c){var id=$c.Result;(td=id?id.AgaveData:null)||Lb(null,$c.Errors?$c.Errors[0].ErrorCause:5001);Lb(td,0)};Ja=function($c,id,vd){return qd.g(Pd,"InsertAgaveTaskpane",ee,Kb.b($c,ec,Ec),Kb.a(id,Zb),vd,null,0)}}else Ja=function($c,id,vd){return qd.g(Pd,"InsertAgaveTaskpane",ee,Kb.b($c,ec),Kb.a(id,Zb),vd,null,0)};sa.EwaSettings.Zb()?Be.a(this.$.userOperationManager,Ja,function($c){return new vc.a(519,0,$c,64)},null):Be.a(this.$.userOperationManager,
Ja,function($c){return new df.a(519,0,$c)},null)};a.prototype.Zxj=function(){return this.$.pe.get(35)};a.prototype.TId=function(Ja){Ja=this.Tm(Ja);(null===Ja||void 0===Ja?0:Ja.Fda)&&Ja.SPf()};a.prototype.iFi=function(Ja){var Lb=this.Wia(function(ec){return a.bMa(ec.oU)});Lb&&(Lb=this.Th.getOsfControl(Lb.controlId))&&Lb.notifyAgave(OSF.AgaveHostAction.SendMessage,Ja)};a.prototype.Ogi=function(){return!!this.Wia(function(Ja){return 1===Ja.controlType&&a.bMa(Ja.oU)})};a.prototype.Ngi=function(){var Ja=
this.Wia(function(Lb){return a.bMa(Lb.oU)});return Ja?Ja.hy?Fb.DOMElementExtensions.isVisible(Ja.hy):!1:!1};a.prototype.Frj=function(){var Ja=this.Wia(function(Lb){return a.bMa(Lb.oU)});Ja&&(Ja.$f(!0),this.raiseEvent("ca",Ja.controlId))};a.prototype.initialize=function(){var Ja=b(1575).DdaEventDispatch,Lb=void 0===this.$||null===this.$||sa.EwaSettings.ma(260);void 0!==this.$&&null!==this.$||va.ULS.sendTraceTag(537170525,0,50,"VSO#2693929: Initialize is called. EwaControl is null");Lb&&va.ULS.sendTraceTag(537170524,
0,50,"VSO#2693929: Initialize is called. this.initialized is "+this.initialized);this.initialized||(e.yGa(this.$),this.ea=this.$.ea,this.Vh=new Ja(this.$),this.$.Uk(this.Yc),this.ea.Vj(this.Uc),this.ea.YL(this.ro),this.ea.Bu(this.Sf),this.$.userOperationManager.Br(this.oR),this.ilf(),this.tPi(),this.Tai(),this.$.da.Ga(35,this),this.dWc.ka(this),Lb&&va.ULS.sendTraceTag(537170522,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.lfe=new Mc.a,Lb&&va.ULS.sendTraceTag(537170521,0,50,"VSO#2693929: RichApiEventRegistration is constructed"),
this.ofe=new u(this.$,this.Ri,this.Vh),this.pwg=new x(this.$,this.Ri,this.Vh),this.mfe=new y(this.$,this.Ri,this.Vh),this.kfe=new z(this.$,this.Ri,this.Vh),this.jfe=new w(this.$,this.Ri,this.Vh),this.nfe=new A(this.$,this.Ri,this.Vh),this.pfe=new m(this.$,this.Ri,this.Vh),this.qfe=new v(this.$,this.Ri,this.Vh),this.$.Nba&&(this.rfe=new f(this.$,this.Ri,this.Vh)),sa.EwaSettings.ma(191)&&(this.o1a=new K(this,Wa.g(this.$))),sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&
(this.ife=new D),this.initialized=!0,va.ULS.sendTraceTag(537170520,0,50,"DdaFacade is initialized"))};a.prototype.lCh=function(Ja){if(!this.fCa)return null;for(var Lb=0,ec=this.fCa.length;Lb<ec;Lb++)if(Ja.startsWith(this.fCa[Lb].WebExtensionId))return this.fCa[Lb];return null};a.prototype.ilf=function(){var Ja,Lb=this.ea;if(Lb.dc&&!this.RPb){if(Lb.workbookContext){if(this.cTc=this.$.ea.Tg.get(22),null===(Ja=Lb.workbookContext.WebExtensions)||void 0===Ja?0:Ja.length){Ja=Lb.workbookContext.WebExtensions;
Lb=!1;for(var ec={},Zb=Ja.length-1;0<=Zb;ec={jQb:ec.jQb},Zb--){if(!this.ea.isNamedObjectViewMode){this.jpc.push(Ja[Zb].InstanceId);if(1!==Ja[Zb].WebExtensionType){Ja.splice(Zb,1);continue}if(ob.HelperMethods.hw(Ja[Zb])&&0!==Ja[Zb].SharedRuntime.State)1===Ja[Zb].SharedRuntime.State?Ja[Zb].TaskpaneVisible=!1:2===Ja[Zb].SharedRuntime.State?Ja[Zb].TaskpaneVisible=!0:va.ULS.sendTraceTag(537170519,0,10,"The sharedRuntime state is invalid");else if(!Ja[Zb].ContainsCustomFunctions&&!Ja[Zb].TaskpaneVisible&&
!Xb.a(Ja[Zb])){Ja.splice(Zb,1);continue}}var Oc=OSF.OsfControl.isFirstPartyStoreString(Ja[Zb].PrimaryMarketplace.MarketplaceType);sa.EwaSettings.ma(187)&&!Oc&&(Ja.splice(Zb,1),Lb||(Lb=!0,ec.jQb=wa.GetServiceTaskFactory.Ra(this.$.da,5,4,3),hb.TaskExtensions.Aa(ec.jQb,function(td){return function(){td.jQb.result.Lf(35,null)}}(ec),this.la,3)));sa.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&Ja[Zb].PrimaryMarketplace&&a.bMa(Ja[Zb].PrimaryMarketplace.SolutionId)&&
(va.ULS.sendTraceTag(537170518,0,50,"chart task pane info stored in workbook context webextensions"),Ja.splice(Zb,1))}this.SCe(Ja)}}else this.cTc=!1;this.RPb=!0}};a.prototype.$4e=function(Ja){var Lb=Wa.g(this.$),ec=Lb.ha.Oa.Yb;if(ec&&Ja){Ja=!1;if(this.pf)for(var Zb=ik(this.pf),Oc=Zb.next();!Oc.done;Oc=Zb.next())if(Oc=Oc.value,a.bMa(Oc.oU)||a.Sji(Oc.oU)){Ja=!0;break}Ja||Lb.ha.Oa.NG(ec)}};a.prototype.tPi=function(){this.Th&&this.ea.isNamedObjectViewMode&&this.$.pa&&we.o(this.$.pa)&&(this.$.da.za(34).MQ?
this.$.da.za(34).Bld():this.$.da.za(34).Au(this.pVi))};a.prototype.SCe=function(Ja){var Lb=this,ec=null;ec=function(td){function Gd(){Lb.pPa.shift();0<Lb.pPa.length&&ec(Lb.pPa[0])}var Pd=td.WebExtensionData,ee=td.IsTaskPane,Ec=td.RecordHandler;if(Lb.Gaa(Pd.PrimaryMarketplace.SolutionId))Gd();else{ee&&(Pd.WebExtensionOsfControlType=1);var $c=Xb.a(Pd);if(!ee||Pd.TaskpaneVisible||$c||Pd.SharedRuntime&&0!==Pd.SharedRuntime.State||Pd.ContainsCustomFunctions){var id=new H(Lb,Lb.Vh,Pd,!ee);va.ULS.sendTraceTag(537170517,
0,50,"DdaFacade::CreateAllOsfControls: SolutionId: "+Telemetry.PrivacyRules.GetPrivacyCompliantId(Pd.PrimaryMarketplace.SolutionId,Pd.PrimaryMarketplace.MarketplaceType,null,null,null,Pd.PrimaryMarketplace.MarketplaceRef)+", StoreType: "+Pd.PrimaryMarketplace.MarketplaceType+", UseShareRuntime: "+ob.HelperMethods.hw(Pd));id.old();ob.HelperMethods.hw(Pd)&&(id.iIa=a.Uua(Pd,Lb.$),Pd.TaskpaneWidth=Lb.u6b);$c&&(Pd.WebExtensionToolTip="");ee&&Pd.TaskpaneVisible&&!$c&&(Pd.TaskpaneWidth=Lb.u6b);Lb.pf.push(id);
var vd=Lb.txa=null;vd=ld.a.instance.pE(function(){id.hy&&(Ab.a.Ia(vd),vd=null,Ec&&Ec(td,id),Gd())},100,Kd.a.cdh)}else Gd()}};for(var Zb={},Oc=0;Oc<Ja.length;Zb={p1:Zb.p1},Oc++)if(!this.Tm(Ja[Oc].InstanceId))if(1!==Ja[Oc].WebExtensionType)this.P0a(Ja[Oc]);else if(!sa.EwaSettings.ma(54))this.Nmb(Ja[Oc],ec);else if(this.$.Bd&8388608||Ja[Oc].TaskpaneVisible)Zb.p1={},Zb.p1.marketplaceId=Ja[Oc].PrimaryMarketplace.SolutionId,Zb.p1.marketplaceVersion=Ja[Oc].PrimaryMarketplace.SolutionVersion,Zb.p1.storeType=
Ja[Oc].PrimaryMarketplace.MarketplaceType,Zb.p1.storeId=Ja[Oc].PrimaryMarketplace.MarketplaceRef,Zb.p1.targetData=Ja[Oc],this.Th.isAddinCommandsAsync(Zb.p1,function(td){return function(Gd,Pd,ee){if(Gd){var Ec=ee.targetData;if(Pd){if(sa.EwaSettings.ma(88))if(td.p1.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())Gd=td.p1.storeType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog.toLowerCase(),Pd=td.p1.storeType.toLowerCase()===OSF.StoreType.PrivateCatalog.toLowerCase(),(Gd||Pd)&&ob.HelperMethods.hw(Ec)&&
Lb.Nmb(Ec,ec);else if(sa.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))Lb.v4h(ee,ec);else{var $c=!1;Lb.bda(function(id){if(!id.errorCode){if(id.value){id=ik(id.value);for(var vd=id.next();!vd.done&&!$c;vd=id.next())$c=pd.e(vd.value[1])===pd.e(Ec.PrimaryMarketplace.SolutionId)}$c?ob.HelperMethods.hw(Ec)&&Lb.Nmb(Ec,ec):(id={},id.SolutionId=ee.marketplaceId,id.TargetType=Ec.WebExtensionType,id.Version=ee.marketplaceVersion,id.StoreType=Ec.PrimaryMarketplace.MarketplaceType,
id.StoreId=ee.storeId,id.AssetId=ee.marketplaceId,id.AssetStoreId=ee.storeId,id.Width=Ec.TaskpaneWidth,Ec.TaskpaneVisible=!0,Lb.dke(id,Ec,ec))}},!0)}}else Lb.Nmb(Ec,ec)}else Gd=ee.targetData,va.ULS.sendTraceTag(542185164,220,15,"Judging AddinCommands failed for "+Telemetry.PrivacyRules.GetPrivacyCompliantId(Gd.PrimaryMarketplace.SolutionId,Gd.PrimaryMarketplace.MarketplaceType,null,null,null,Gd.PrimaryMarketplace.MarketplaceRef)+" from "+Gd.PrimaryMarketplace.MarketplaceType+" during document loading")}}(Zb))};
a.prototype.v4h=function(Ja,Lb){var ec=this,Zb=!1;this.bda(function(Oc){var td=Ja.targetData;if(!Oc.errorCode){if(Oc.value){Oc=ik(Oc.value);for(var Gd=Oc.next();!Gd.done&&!Zb;Gd=Oc.next())Zb=pd.e(Gd.value[1])===pd.e(td.PrimaryMarketplace.SolutionId)}Zb?ob.HelperMethods.hw(td)&&ec.Nmb(td,Lb):(Oc={},Oc.SolutionId=Ja.marketplaceId,Oc.TargetType=td.WebExtensionType,Oc.Version=Ja.marketplaceVersion,Oc.StoreType=td.PrimaryMarketplace.MarketplaceType,Oc.StoreId=Ja.storeId,Oc.AssetId=Ja.marketplaceId,Oc.AssetStoreId=
Ja.storeId,Oc.Width=td.TaskpaneWidth,td.TaskpaneVisible=!0,ec.dke(Oc,td,Lb))}},!0)};a.prototype.Nmb=function(Ja,Lb){var ec={};ec.WebExtensionData=Ja;ec.IsTaskPane=!0;this.pPa.push(ec);1===this.pPa.length&&Lb(ec)};a.prototype.dke=function(Ja,Lb,ec){var Zb=this,Oc={};Oc.ActivationInfo=Ja;Oc.WebExtensionData=Lb;Oc.IsTaskPane=!1;Oc.RecordHandler=function(td,Gd){var Pd=td.ActivationInfo;Zb.Th.insertBlankControlWithErrorUX(Zb.YGb(Gd,Pd),function(){Zb.nQa(Gd.controlId);Zb.Th.purgeOsfControl(Gd.controlId,
!1);Zb.qag(Pd)})};this.pPa.push(Oc);1===this.pPa.length&&ec(Oc)};a.prototype.qag=function(Ja){var Lb={};Lb.solutionId=Ja.SolutionId;Lb.version=Ja.Version;Lb.storeType=Ja.StoreType;Lb.storeId=Ja.StoreId;Lb.assetId=Ja.AssetId;Lb.assetStoreId=Ja.AssetStoreId;Lb.targetType=Ja.TargetType;Lb.sharedRuntimeId=Ja.SharedRuntimeId;Ja=new oc.a;Ja.add(Lb);Lb={};Lb[Ra.a.Rnb]=Ja;Lb[Ra.a.rP]=3;Ja=new Nc.a(sd.a.VBb,0,this.$.Jc,0,null);this.$.Ka.Kb(Ja,Lb)};a.prototype.YGb=function(Ja,Lb){var ec={};ec.div=Ja.hy;ec.id=
Ja.controlId;ec.solutionId=Lb.SolutionId;ec.version=Lb.Version;ec.storeId=Lb.StoreId;ec.storeType=Lb.StoreType;ec.osfControlType=OSF.OsfControlTarget.TaskPane;return ec};a.prototype.FTf=function(){var Ja=this;if(sa.EwaSettings.isChangeGateEnabled("OfficeVSO:3935411_RemoveOsfControlsAferSilentReload")){for(var Lb=[],ec=0;ec<this.pf.length;ec++){var Zb=this.pf[ec];0!==Zb.osfControlType&&3!==Zb.osfControlType&&4!==Zb.osfControlType||Lb.push(Zb)}ec=!1;for(Zb=0;Zb<Lb.length;Zb++){var Oc=Lb[Zb];this.nQa(Oc.controlId);
!ec&&Oc&&Oc.el&&(ec=ob.HelperMethods.hw(Oc.el))}ec&&(Lb={},Lb=(Lb.DynamicAddinCommandsMethodDispatchId=4,Lb),this.VJ(-1014260128,Lb))}sa.EwaSettings.ma(402)&&hb.TaskExtensions.Aa(wa.GetServiceTaskFactory.Ra(this.$.da,278,279,3),function(td){td&&(td=td.result)&&(Ja.$.da.za(278)||Ja.$.da.Ga(278,td),td.waf().ina())},this.la,3)};a.prototype.QK=function(){var Ja=this,Lb=new k(this.$,this.Ri,this.FUf);void 0===this.$||null===this.$?va.ULS.sendTraceTag(537170514,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):
sa.EwaSettings.ma(260)&&va.ULS.sendTraceTag(537170513,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+(void 0===this.Ri||null===this.Ri));if(Lb.WDi()){var ec=function(){},Zb=function(Gd){Gd=Jd.a.xf(Gd.data);va.ULS.sendTraceTag(537170511,0,10,"ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: "+bf.a.Cc(Gd)+".")},Oc=Lb.DSg();Lb=function(Gd,Pd,ee){return qd.g(Ja.$.oa.va,"ExecuteRichApiRequest",Ja.ESg(Oc),Kb.b(Gd,ec),
Kb.a(Pd,Zb),ee,null,0)};var td=a.Cfd(Oc);sa.EwaSettings.Zb()?this.$.userOperationManager.Rt(new vc.a(507,0,Lb,td|64)):this.$.userOperationManager.Rt(new df.a(507,0,Lb,td))}};a.prototype.ESg=function(Ja){var Lb=this.$.oa.va.Na(1);Lb.request=Ja;return Lb};a.prototype.Xxe=function(Ja,Lb){if(Ja)for(var ec=0;ec<Ja.length;ec++)if(lc.a.equals(Ja[ec],Lb,!0))return!0;return!1};a.prototype.HRg=function(Ja){var Lb={};Lb.navigationMode=OSF.OsfNavigationMode.DefaultMode;Lb.assetId=null;Lb.category=null;if(!Ja||
3>Ja.length)return Lb;if(Ja[0]){var ec=parseInt(Ja[0],10);isNaN(parseInt(ec,10))||(Lb.navigationMode=ec)}Ja[1]&&(Lb.assetId=Ja[1]);Ja[2]&&(Lb.category=Ja[2]);return Lb};a.prototype.Tai=function(){if(sa.EwaSettings.ma(62)){var Ja=this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(Ja&&"*"!==Ja.trim()){this.RIa=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new S(this),Ja,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.pe.get(2));try{this.RIa.init()}catch(Lb){try{this.RIa.dispose()}catch(ec){}this.RIa=
null;va.ULS.sendTraceTag(537170510,0,10,"EmbeddingEnpoint failed to initialize. Error message: "+Lb.message)}Ja={};Ja.a=this.$.ya.UserSessionId;Tb.b().Ce(39,Ja)}}};a.prototype.s3f=function(Ja,Lb,ec){var Zb=this,Oc=a.UQg(Ja[0]),td=Oc.Bha,Gd=Oc.ria;Oc.Bha=function(){td&&td();var Pd=Oc.FLa!==OSF.InfoType.Error?Lb:null;Ja.shift();Ja.length?Zb.s3f(Ja,Pd,ec):Pd&&Pd()};Oc.ria=function(){Gd&&Gd();ec&&Oc.FLa!==OSF.InfoType.Error&&ec()};La.a.PRd(Oc)};a.prototype.hRh=function(){var Ja={};Ja.AddinRibbonControlsOverriddenByApi=
sa.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();Ja.AddinActionDefinitionHybridMode=sa.EwaSettings.ma(642).toString();Ja.UseActionIdForUILessCommand=sa.EwaSettings.ma(645).toString();Ja.AllowStorageAccessByUserActivationOnIFrame=sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",!1).toString();Ja.RequirementSetRibbonApiOnePointTwo=sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",
!1).toString();Ja.flightingTreatmentVariables=pa.AFrameworkApplication.fa.v$b;Ja.ShortcutInfoArrayInUserPreferenceData=sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();return Ja};a.getSolutionId=function(Ja){var Lb=Ja.PrimaryMarketplace.SolutionId;sa.EwaSettings.ma(294)&&Ja.OwnerAddinSolutionId&&(Lb=Ja.OwnerAddinSolutionId);return Lb};a.Cfd=function(Ja){var Lb=0;sa.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?
Ja.RequestFlags&1&&256!==(Ja.RequestFlags&256)||(Lb=16):Lb=Ja.RequestFlags&1?0:16;return Lb};a.Uua=function(Ja,Lb){Lb=a.getSolutionId(Ja,Lb);return a.tYe(Lb,Ja.PrimaryMarketplace.SolutionVersion,Ja.PrimaryMarketplace.MarketplaceType,Ja.PrimaryMarketplace.MarketplaceRef)};a.G$g=function(Ja){var Lb={};Ja=(Lb.recording=Ja,Lb);return JSON.stringify(Ja)};a.Y5g=function(Ja){var Lb={};Lb.visibility=Ja?"Visible":"Hidden";return JSON.stringify(Lb)};a.mNh=function(Ja){var Lb=Ja.getSolutionId(),ec=Ja.getVersion(),
Zb=Ja.getStoreType();Ja=Ja.getStoreId();return a.tYe(Lb,ec,Zb,Ja)};a.tYe=function(Ja,Lb,ec,Zb){return String.format("{0}|{1}|{2}|{3}|{4}|||","2",Ja,Lb,a.pZh(ec).toString(),Zb)};a.thd=function(Ja,Lb){var ec=Ja.split("|");if(7>ec.length)return va.ULS.sendTraceTag(537170509,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),null;if("2"!==ec[0])return va.ULS.sendTraceTag(537170508,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='"+ec[0]+
"'."),null;var Zb=ec[1],Oc=ec[2],td=a.qZh(ec[3]),Gd=ec[4];ec=ec[5];Zb&&Zb.length||(Zb=ec);ec={};ec.InstanceId=String.format("{{{0}}}",ma.a.create().toString());ec.WebExtensionOsfControlType=4;ec.WebExtensionType=1;ec.PrimaryMarketplace={};ec.PrimaryMarketplace.SolutionId=Zb;ec.PrimaryMarketplace.SolutionVersion=Oc;ec.PrimaryMarketplace.MarketplaceRef=Gd;ec.PrimaryMarketplace.MarketplaceType=td;ec.ContainsCustomFunctions=Lb?!0:!1;Lb&&(ec.OsfPropertyBag=[["customFunctionAddinId",Ja]]);return ec};a.qZh=
function(Ja){Ja=parseInt(Ja,10);return Ja===OSF.StoreTypeEnum.MarketPlace?OSF.StoreType.OMEX:Ja===OSF.StoreTypeEnum.Catalog?OSF.StoreType.SPCatalog:Ja===OSF.StoreTypeEnum.SPApp?OSF.StoreType.SPApp:Ja===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:Ja===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:Ja===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:Ja===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:Ja===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:
Ja===OSF.StoreTypeEnum.FirstParty?OSF.StoreType.FirstParty:Ja===OSF.StoreTypeEnum.UploadFileDevCatalog?OSF.StoreType.UploadFileDevCatalog:Ja===OSF.StoreTypeEnum.WopiCatalog?OSF.StoreType.WopiCatalog:null};a.pZh=function(Ja){return Ja===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:Ja===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:Ja===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:Ja===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:Ja===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:
Ja===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:Ja===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:Ja===OSF.StoreType.HardCodedPreinstall?OSF.StoreTypeEnum.HardCodedPreinstall:Ja===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:Ja===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:Ja===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1};a.Urb=function(Ja){var Lb={};Lb.Version=Ja.version;Lb.AssetId=Ja.assetId;Lb.AssetStoreId=null!==Ja.assetStoreId?
Ja.assetStoreId.toString():null;Lb.StoreType=Ja.storeType;Lb.Height=Ja.height;Lb.SolutionId=Ja.solutionId;Lb.StoreId=Ja.storeId;Lb.TargetType=Ja.targetType;Lb.Width=1===Lb.TargetType?0:Ja.width;Lb.SharedRuntimeId=Ja.sharedRuntimeId;return Lb};a.vzb=function(Ja){return Ja===OSF.DDA.EventDispId.dispidSettingsChangedEvent||Ja===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||Ja===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Ja===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||
Ja===OSF.DDA.EventDispId.dispidRichApiMessageEvent||Ja===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||Ja===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||Ja===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent};a.UQg=function(Ja){return Object(ya.a)(new Uc.a,{FLa:Ja.infoType,id:Ja.id,title:Ja.title,description:Ja.description,buttonText:Ja.buttonTxt,Bha:Ja.buttonCallback,mec:Ja.highPriority,ria:Ja.dismissCallback,errorCode:Ja.errorCode,x9e:Ja.iframeNotificationUrl})};
a.bMa=function(Ja){var Lb="FA000000014"===Ja;Lb||(Lb="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===Ja);return Lb};a.Sji=function(Ja){return"FA000000005"===Ja};of.Object.defineProperties(a.prototype,{r0b:{configurable:!0,enumerable:!0,get:function(){return this.dfa||(this.dfa=new cb.a(this.$.Rv))}},Th:{configurable:!0,enumerable:!0,get:function(){if(!this.Jm){var Ja={},Lb=!(this.$.Bd&1),ec=uc.a.current.ON,Zb=this.$.workbookContext,Oc=Sa.a.hL+Sa.a.D3b;Ja.pageBaseUrl=ec.LayoutsContentUrlPrefix;Ja.appName=
OSF.AppName.ExcelWebApp;Ja.appVersion="16";Ja.appSettings=this.hRh();Ja.singleSignOnSettings=Ha.AppsForOfficeSingleSignOnManager.TYh();Ja.clientMode=Lb?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;Ja.appUILocale=this.$.ya.UICultureTag;Ja.dataLocale=this.$.ya.DataCultureTag;Ja.docUrl=Zb.ClientUrl;Ja.hostControl=this;Ja.formFactor=OSF.FormFactor.Default;Ja.lcid=this.$.$F.toString();Ja.localizedScriptsUrl=Sa.a.hL+Sa.a.V1c;Ja.localizedImagesUrl=Oc;Ja.localizedStylesUrl=Sa.a.hL+Sa.a.SAe;Ja.localizedResourcesUrl=
Oc;Ja.osfOmexBaseUrl=ec.OsfOmexBaseUrl;Ja.firstPartyManifestCDNUrl=ec.FirstPartyAddInManifestCDN;Ja.sdxAssetsToPrefetchMapping=pa.AFrameworkApplication.fa.Wa("SdxAssetsToPrefetchMapping");Ja.sdxCdnUrl=ec.SdxCdnUrl;Ja.sdxDmsUrl=ec.SdxDmsUrl;Ja.devCatalogUrl=ec.DevCatalogUrl;Ja.controlStatusChanged=this.hoc;Ja.notifyHost=this.GAf;Ja.allowExternalMarketplace=this.$.ea.Tg.get(27)&&a.E2c;Ja.enableAddinCommands=sa.EwaSettings.ma(54);Ja.enableBlackForestRedirect=sa.EwaSettings.ma(89);Ja.enableMyOrg=this.$.ea.Tg.get(33);
Ja.enableMyApps=this.$.ea.Tg.get(34);Ja.enableDevCatalog=sa.EwaSettings.ma(45);Ja.enablePrivateCatalog=this.Zxj();Ja.enableTaskpaneUpgradeToAppCommand=sa.EwaSettings.ma(94);Ja.showSignOutFromPrivateCatalogMessage=this.$.ea.Tg.get(36);Ja.enableUploadFileDevCatalog=sa.EwaSettings.ma(54)&&!sa.EwaSettings.ma(283);Ja.userNameHashCode=aa.a.Nv(pa.AFrameworkApplication.userName);Ja.envCode=this.$.ya.OfficeAddinTelemetryDataSourceCode.toString();Ja.enableSingleSignOnForAddin=!sa.EwaSettings.ma(24)&&pa.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;
Ja.enableDisplayBlockedMinorError=sa.EwaSettings.ma(184);Ja.hideAppsExtensionUrl=pa.AFrameworkApplication.hideAppsExtensionUrl;Ja.enableAnonymousUseLegacyCatalogService=sa.EwaSettings.ma(174);Ja.enableInsertDialogAccessibilityFix=sa.EwaSettings.ma(181);Ja.disableAppsForOfficeThirdParty=sa.EwaSettings.ma(187);Ja.enableFirstPartySSO=sa.EwaSettings.ma(199);Ja.wacSessionId=this.$.ya.UserSessionId;Ja.disableLogging=!this.$.ya.AriaLoggingIsEnabled;Ja.enableFirstPartySDXErrorMessages=sa.EwaSettings.ma(212);
Ja.enableRichApiCellEditDelay=sa.EwaSettings.ma(191);Ja.isHostDocumentDomain=sa.EwaSettings.ma(227);Ja.loggableUserId=pa.AFrameworkApplication.fa.Wa("LoggableUserId");Ja.sessionStartInfoJson=pa.AFrameworkApplication.fa.Wa("SessionStartInfoJson");Ja.wopiHostOriginFromPostMessage=pa.AFrameworkApplication.wopiHostOriginFromPostMessage;Ja.wopiHostOriginFromWacPropBag=pa.AFrameworkApplication.fa.Wa("PostMessageOrigin");Ja.wacIsEmbedded=pa.AFrameworkApplication.fa.qa("IsEmbedded");Ja.accessibilityAllowFocusAddinTaskpane=
pa.AFrameworkApplication.fa.qa("AccessibilityAllowFocusAddinTaskpane");Ja.enableRemoveAppCommandsAddin=pa.AFrameworkApplication.fa.qa("RemoveAppCommandsAddinIsEnabled");Ja.isHostFrameTrustCheckEnabledForAddIns=pa.AFrameworkApplication.fa.qa("HostFrameTrustCheckIsEnabledForAddIns");Ja.isHostFrameTrusted=pa.AFrameworkApplication.isHostFrameTrusted;Ja.agaveAddinUploadEnabled=sa.EwaSettings.ma(47);Ja.hostAllowedOfficeStore=pa.AFrameworkApplication.fa.qa("HostAllowedOfficeStore");Ja.hostAllowedSdxEmbedding=
pa.AFrameworkApplication.fa.qa("HostAllowedSdxEmbedding");Ja.hostInstallAddIns=pa.AFrameworkApplication.fa.Wa("HostInstallAddIns");Ja.hostInstallAddInsIsEnabled=pa.AFrameworkApplication.fa.qa("HostInstallAddInsIsEnabled");Ja.approvedAddIns=pa.AFrameworkApplication.fa.Wa("ApprovedAddIns");Ja.addinEnforceHttpsIsEnabled=this.gxj(Ja.sessionStartInfoJson);Ja.hostFeatureGateFlag=0;Ja.isUpnCheckEnabled=pa.AFrameworkApplication.fa.qa("IsUpnCheckEnabled");Ja.wacUpn=pa.AFrameworkApplication.fa.Wa("UserPrincipalName");
Ja.isReactRibbonEnabled=Ub.a.isReactRibbonEnabled();Ja.enableSetFocusOnTaskpaneOnUserAction=sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);Ja.isSafariWithIndexedDBDisabled=sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&Ua.a.JMa;Ja.isIndexedDBDisabled=sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&Ua.a.JMa||sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&
Ua.a.Pf;Ja.enableCustomShortcuts=sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5325526_EnableCustomShortcuts");Ja.changeGetModifierKeyStringOutputOrder=sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");Ja.officeJsUrl=pa.AFrameworkApplication.WK("OfficeJs/excel.js",5);Ja.enableOfficeJsUrlParam=sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableOfficeJsUrlParam",!1);this.Jm=new OSF.ContextActivationManager(Ja);Ja={};this.Jm.setIframeAttributeBag((Ja.frameborder=
0,Ja.marginheight=0,Ja.marginwidth=0,Ja));this.Jm.setWSA(pa.AFrameworkApplication.Gm);this.Jm&&"undefined"!==typeof this.Jm.hostCheckReadyHandler&&pa.AFrameworkApplication.EGg(Object(ba.a)(this.Jm,this.Jm.hostCheckReadyHandler,"hostCheckReadyHandler"));try{var td=Db.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.Jm.setOAuthManager(td)}catch(Gd){}}return this.Jm}},HYj:{configurable:!0,enumerable:!0,get:function(){return this.cTc}},Ri:{configurable:!0,enumerable:!0,get:function(){return this.lfe}},
fna:{configurable:!0,enumerable:!0,get:function(){return this.ife}},cMd:{configurable:!0,enumerable:!0,get:function(){return this.mfe}},bMd:{configurable:!0,enumerable:!0,get:function(){return this.kfe}},Fjj:{configurable:!0,enumerable:!0,get:function(){return this.ofe}},Djj:{configurable:!0,enumerable:!0,get:function(){return this.jfe}},Ejj:{configurable:!0,enumerable:!0,get:function(){return this.nfe}},Gjj:{configurable:!0,enumerable:!0,get:function(){return this.pfe}},Hjj:{configurable:!0,enumerable:!0,
get:function(){return this.qfe}},dMd:{configurable:!0,enumerable:!0,get:function(){return this.rfe}},sV:{configurable:!0,enumerable:!0,get:function(){return this.yrg}},$:{configurable:!0,enumerable:!0,get:function(){return this.ib}}});of.Object.defineProperties(a,{E2c:{configurable:!0,enumerable:!0,get:function(){return a.h4d},set:function(Ja){a.h4d=Ja}}});a.i1a=new Ea.a;a.h4d=!0;Object(ha.a)(a,"DdaFacade",Jb.a,[472,780,781,782,783,6])},960:function(t,E,b){function a(){this.oId=0;this.yW={};this.Zsa=
{}}b.d(E,"a",function(){return a});t=b(0);var c=b(15),d=b(113);a.prototype.EUh=function(e,h){return this.yW[a.RYc(e,h)]};a.prototype.dLe=function(e,h){h||void 0!==this.Zsa[e]&&null!==this.Zsa[e]?h&&void 0!==this.Zsa[e]&&null!==this.Zsa[e]&&delete this.Zsa[e]:this.Zsa[e]=1};a.prototype.i0b=function(e){return void 0===this.Zsa[e]||null===this.Zsa[e]};a.prototype.y3h=function(e){var h=a.RYc(e.messageType,e.targetId);1===e.actionType?this.V4h(e.controlId,e.messageType,h):2===e.actionType&&this.F5h(e.controlId,
e.messageType,h)};a.prototype.Naj=function(e){if(e){var h=Object.keys(this.yW);if(!(void 0===h||null===h||0>=h.length)){h=ik(h);for(var k=h.next();!k.done;k=h.next()){k=k.value;var n=this.yW[k];n[e]&&(delete n[e],Object.keys(n).length||delete this.yW[k])}}}};a.prototype.d_=function(e,h){e=a.RYc(e,h);e=this.yW[e];return!!e&&0<Object.keys(e).length};a.prototype.u6h=function(){return!d.a.isEmpty(this.yW)};a.prototype.Khf=function(){return 0<this.oId};a.prototype.YOh=function(){var e=[],h=this.yW,k;for(k in h){var n=
k,f=h[k],v;for(v in f){f=v;var m={};m.eventType=parseInt(n.split("#")[0],10);m.targetId=n.split("#")[1];m.addinId=f;e.push(m)}}return e};a.prototype.V4h=function(e,h,k){if(this.yW[k])k=this.yW[k],k[e]=k[e]?k[e]+1:1;else{var n={};n[e]=1;this.yW[k]=n}100===h&&this.oId++};a.prototype.F5h=function(e,h,k){if(this.yW[k]){var n=this.yW[k];if(e){var f=n[e];1===f?(delete n[e],Object.keys(n).length||delete this.yW[k]):n[e]=f-1;100===h&&this.oId--}else c.ULS.sendTraceTag(537170459,0,50,"The OsfControl["+e+"] doesn't register event with key["+
k+"].")}else c.ULS.sendTraceTag(537170460,0,50,"The event with key["+k+"] that will be unregistered doesn't exist.")};a.RYc=function(e,h){return String.format("{0}#{1}",e,h)};a.QW="Workbook";Object(t.a)(a,"RichApiEventRegistration",null,[])},986:function(t,E,b){function a(c,d,e,h){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=c;this.controlId=d;this.ddaBinding=e;this.ArrayData=void 0===h?null:h}b.d(E,"a",function(){return a});t=b(0);a.prototype.getDispid=function(){return this.dispid};
a.prototype.getDdaBinding=function(){return this.ddaBinding};Object(t.a)(a,"DdaEventArgs",null,[])}}]);

//# sourceMappingURL=EwaDS.agave.js.map