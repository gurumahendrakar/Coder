(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[13],{1448:function(t,E,b){function a(xa,Z,ha,ya){var va=da.call(this)||this;va.isMac=n.a.isMac;va.pYa=-1;va.z5b=null;va.nta=-1;va.dte=!1;va.s_=!1;va.JSd=!1;va.cjc=!1;va.fN=!1;va.UT=null;va.tg=function(){va.vwa&&va.gridView&&va.dX()};va.Fc=function(){va.Nx()};va.Zc=function(){va.IHa();I.g(va.$).Uf(!0,!1)};va.t6=function(ba,fa){fa?(va.Qcg(va.z5b),va.Mdb()):(ba=[29],va.gridView.qb.fh(ba),va.gridView.qb.Ti(null,ba),va.UT&&va.UT.W7e())};
va.Ni=function(){va.L6a()&&va.Lh.hide();1===va.gridView.ha.Re&&va.dX()};va.mR=function(){var ba=va.gridView.ha.Re;va.gridView.ha.sa.activeCell&&1===ba&&va.dX()};va.onKeyUp=function(ba){return va.XBb?va.s_?!1:17===ba.Ca.keyCode&&va.JSd?(va.fN?(va.Mdb(),va.Bda()):va.pLb(),!0):!1:va.s_=!1};va.onKeyDown=function(ba){if(!va.XBb)return va.s_=!1;va.JSd=!1;va.s_=ba.ctrlKey;switch(ba.Ca.keyCode){case 27:return va.fN?(va.t6(null,!1),va.Bda()):va.UT&&(va.UT.W7e(),va.pLb()),!0;case 13:if(va.fN)return va.fN=!1,
va.IHa(),!0;break;case 17:return va.JSd=!0}return!1};var bb=b(1556).AutoDetectActionButton;va.$=xa;va.Yob=N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AutoDetectRichTooltip",!1);Z||k.ULS.sendTraceTag(537166983,0,15,"AutoDetectManager: SVG icons are enabled, but svgIconProvider is null");va.convertToLinkedEntityManager=ya;ya.cab();va.Lh=new bb(xa,Z,va.Zc,ha,"");va.dOg=new c(va.$,ya);va.gridView=I.g(va.$);va.gridView.ha.qP(va.tg);va.gridView.Wb.GYa(va.tg);va.gridView.Au(va.mR);
xa.Bk(va.Fc);xa.rA(va.Ni);va.gridBlockManager=Object(m.a)(380,va.gridView.Ea);va.hr=xa.frame.ot;va.dX();return va}function c(xa,Z){var ha=L.call(this)||this;ha.$=xa;ha.gridView=I.g(xa);ha.convertToLinkedEntityManager=Z;ha.z1c=new K.a;return ha}function d(xa,Z){var ha=S.call(this)||this;ha.Zc=function(ya){if(ya.yb.id===ha.IIa.firstChild.id){ya=ha.cte;var va={};va.Id=ya.Xob;ha.convertToLinkedEntityManager.L2c(va,!0,ya);ha.IIa.removeChild(ha.IIa.firstChild);return!0}return!1};ha.cte=xa;ha.convertToLinkedEntityManager=
Z;ha.IIa=document.createElement("div");ha.IIa.className="clip16x16";ha.lwa=String.format('<input type="image" id="{0}" class="{1}" src="{2}" alt="Convert To Linked Entities Column Header Button">',D.a.yg("autodetectid"+ha.cte.left),F.a.J9c,J.a.df(11));ha.IIa.innerHTML=ha.lwa;xa=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");H.a.instance.ra(v.a.click,xa,ha.Zc);return ha}function e(xa,Z){this.helpId=this.helpText=this.imageAltText=this.urlValue=this.longDescription=this.convertToDomainName=
this.cardViewManager=null;this.$=Z;this.parentElement=xa}t=b(0);var h=b(7),k=b(15),n=b(27),f=b(87),v=b(13),m=b(85),x=b(445),l=b(79),u=b(9),A=b(67),z=b(500);e.prototype.e6g=function(){var xa=this,Z=this.f6g();z.a(this.$,243,242,0,function(ha){xa.cardViewManager=ha;ha.H3f(xa.parentElement,2,Z)})};e.prototype.W7e=function(){this.cardViewManager&&this.cardViewManager.kLa(-1,-1,this.parentElement)};e.prototype.f6g=function(){var xa={layoutId:"AutoDetectTooltip"};xa.description=this.longDescription;xa.convertToDomainName=
this.convertToDomainName;xa.longDescription=this.longDescription;xa.urlValue=this.urlValue;xa.imageAltText=this.imageAltText;xa.helpText=this.helpText;xa.helpId=this.helpId;return xa};Object(t.a)(e,"AutoDetectCardManager",null,[]);var y=b(30),w=b(222),D=b(29),H=b(236),F=b(19),J=b(53),S=l.a;$k(d,S);d.prototype.dispose=function(){if(this.IIa){var xa=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");H.a.instance.Ba(v.a.click,xa,this.Zc)}S.prototype.dispose.call(this)};of.Object.defineProperties(d.prototype,
{domElement:{configurable:!0,enumerable:!0,get:function(){return this.IIa}}});of.Object.defineProperties(d,{ETg:{configurable:!0,enumerable:!0,get:function(){return"clip16x16"}}});Object(t.a)(d,"AutoDetectColumnHeaderButton",l.a,[]);var N=b(1),T=b(1302),G=b(11),I=b(21),K=b(171),L=l.a;$k(c,L);c.prototype.dispose=function(){L.prototype.dispose.call(this)};c.prototype.qhh=function(xa){for(var Z=ik(this.gridView.NY),ha=Z.next();!ha.done;ha=Z.next()){ha=ik(ha.value);for(var ya=ha.next();!ya.done;ya=ha.next()){ya=
ya.value;var va=ya.Gn,bb=T.a(ya.E4);this.QBg(xa,bb,va);ya.UOd(bb)}}};c.prototype.QBg=function(xa,Z,ha){if(Z.length){var ya=ha.length;ha[ya-1]<xa.left||(ha=G.HelperMethods.nx(new w.a(ha),0,ya,xa.left,G.HelperMethods.PC),0>ha||!(Z=Z[ha]))||(this.gridView.rtl?Z.classList.add(y.a.tvh):Z.classList.add(y.a.svh),this.z1c.kb(xa.left)||this.z1c.add(xa.left,new d(xa,this.convertToLinkedEntityManager)),xa=this.z1c.na(xa.left).domElement,!Z.getElementsByClassName(d.ETg).length&&this.XEj(Z)&&Z.appendChild(xa))}};
c.prototype.XEj=function(xa){var Z=parseInt(xa.style.width,10),ha=document.querySelector(".ewrch-col-cellsel")?"bold":"normal";xa=gridRenderer.CanvasRendererGlobals.measureTextWidth(xa.firstChild.innerHTML,c.Q7g(ha),!0,N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1));return 18.4<Z-(Z/2+xa/2)?!0:!1};c.Q7g=function(xa){return"normal normal "+xa+' 10pt/normal "Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif'};Object(t.a)(c,"AutoDetectColumnHeaderManager",l.a,
[]);var O=b(465),B=b(24),Q=b(64),U=b(151),X=b(12),P=b(14),ea=b(188),ia=b(80);b.d(E,"a",function(){return a});var da=l.a;$k(a,da);a.prototype.dispose=function(){this.gridView&&this.gridView.ha.AW(this.tg);if(this.$){var xa=this.$;xa.Ol(this.Fc);xa.iD(this.Ni);I.g(xa).ny(this.mR)}f.a.Ia(this.Lh);this.hr=this.$=this.gridView=this.Lh=null;da.prototype.dispose.call(this)};a.prototype.Nx=function(){this.t6(null,!1);this.pYa=-1;this.Lh.hide();this.iQj();this.fN=!1};a.prototype.Bda=function(){this.Lh.getButton(a.Eea).Sbb();
this.fN=!1};a.prototype.pLb=function(){this.Lh.getButton(a.Eea).KGb();this.Qcg(this.z5b);this.fN=!0;this.$.da.Za(211,function(xa){xa.TPa(P.a.instance.ga(1738))})};a.prototype.onAutoDetectUIShown=function(){if(this.vwa&&-1!==this.pYa)this.convertToLinkedEntityManager.onAutoDetectUIShown()};a.prototype.eOg=function(xa){var Z=new B.Range(1===xa.top?1:xa.top-1,xa.left,xa.bottom,xa.right,!0,!1);Z=this.gridView.getRangeInformation(Z);Z=ik(Z);for(var ha=Z.next();!ha.done;ha=Z.next())if(ha=ha.value,Object(x.a)(O.AutoDetectRange,
ha)&&this.$fc(xa,!1,ha))return!0;return!1};a.prototype.IHa=function(){if(this.vwa&&-1!==this.pYa){this.Lh.getButton(a.Eea).KGb();var xa={};xa.Id=this.nta;xa.StringId=null;this.convertToLinkedEntityManager.L2c(xa,!0,this.z5b);k.ULS.sendTraceTag(594612633,0,50,"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)");xa=[Object(h.a)(new ia.a,{name:"Domain",int64:this.nta})];ea.a("AssistedAutoConvertMenuConvertClicked",void 0,void 0,xa);this.nta=-1}};a.prototype.EKh=function(){var xa=P.a.instance.ga(1734);
if(-1!==this.nta){xa+=" ";try{xa+=this.convertToLinkedEntityManager.pBb(this.nta.toString())}catch(Z){k.ULS.sendTraceTag(537166982,0,10,"AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain "+this.nta)}}xa+=" ";return xa=this.Yob?xa+P.a.instance.ga(1737):xa+P.a.instance.ga(this.isMac?1736:1735)};a.prototype.Mdb=function(){this.Yob&&(this.UT||(this.UT=new e(this.hc,this.$),this.UT.convertToDomainName=P.a.instance.ga(1739),this.UT.urlValue="https://support.content.office.net/en-us/media/758743e7-a2ca-42db-9f43-a45b05b1b077.png",
this.UT.imageAltText=P.a.instance.ga(1741),this.UT.helpId="HID_DataTypes_Wolfram",this.UT.helpText=P.a.instance.ga(1740)),this.UT.longDescription=this.convertToLinkedEntityManager.xWd(this.pYa.toString()),this.UT.e6g())};a.prototype.$fc=function(xa,Z,ha){if((new B.Range(ha.top,ha.left,ha.bottom===u.a.uh?ha.bottom:ha.bottom+1,ha.right,!0,!1)).xd(xa)){if(Z){if(ha&&ha.Xob!==this.pYa){this.pYa=ha.Xob;xa=ha.Xob.toString();Z=this.Yob?"":this.convertToLinkedEntityManager.xWd(xa);var ya=this.convertToLinkedEntityManager.P8h(xa);
this.Lh.Efb(this.convertToLinkedEntityManager.pBb(xa),Z,ya,a.Eea)}this.nta=ha.Xob;this.z5b=ha}return!0}return!1};a.prototype.dX=function(){if(this.convertToLinkedEntityManager){var xa=this.gridView.ha.Re;if(this.gridBlockManager&&this.gridBlockManager.Nid){var Z=this.gridView.ha.sa.activeCell,ha=!this.gridBlockManager.Lr(Z),ya=this.gridView.getRangeInformation(this.gridView.Vg);ya=ik(ya);for(var va=ya.next();!va.done;va=ya.next())if(va=va.value,Object(x.a)(O.AutoDetectRange,va))switch(va.QYg){case 3:if(this.$fc(Z,
!0,va)){if(1!==xa||ha){this.Nx();return}k.ULS.sendTraceTag(537166981,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.ZHd();this.Lh.NAa(Z,this.t6);this.dte||(this.dte=!0,this.onAutoDetectUIShown());return}break;case 2:case 1:(N.EwaSettings.ma(473)||N.EwaSettings.ma(474))&&this.dOg.qhh(va);break;default:k.ULS.sendTraceTag(537166980,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (Invalid LinkedEntityClassifierTrigger used)")}}this.Nx()}};a.prototype.Qcg=function(xa){var Z=
[29];this.gridView.qb.Ti(xa,Z);this.gridView.qb.sn(Z)};a.prototype.L6a=function(){return this.$.ea.isNamedObjectViewMode&&Q.f(this.$.pa)};a.prototype.ZHd=function(){this.Yob&&!this.cjc&&this.hr&&(this.hr.it(v.a.Lb,this.$.domElement,this.onKeyDown,!0),this.hr.it(v.a.Fd,this.$.domElement,this.onKeyUp,!0),this.cjc=!0)};a.prototype.iQj=function(){this.Yob&&this.cjc&&this.hr&&(this.hr.rt(v.a.Lb,this.$.domElement,this.onKeyDown,!0),this.hr.rt(v.a.Fd,this.$.domElement,this.onKeyUp,!0),this.cjc=!1)};a.JMh=
function(xa){return P.a.instance.ga(1795)+A.a.space+xa};of.Object.defineProperties(a.prototype,{hc:{configurable:!0,enumerable:!0,get:function(){return this.Lh.domElement(1)}},XBb:{configurable:!0,enumerable:!0,get:function(){var xa=this.Lh.domElement(a.Eea);return xa?X.DOMElementExtensions.isVisible(xa):!1}},vwa:{configurable:!0,enumerable:!0,get:function(){return this.$.isEditMode&&N.EwaSettings.ma(136)&&N.EwaSettings.ma(139)&&(new U.a(this.$.xa)).fj?!1:-1!==this.nta}}});of.Object.defineProperties(a,
{Eea:{configurable:!0,enumerable:!0,get:function(){return 1}}});Object(t.a)(a,"AutoDetectManager",l.a,[])},1556:function(t,E,b){function a(n,f,v,m,x){var l=k.call(this)||this;l.$=n;l.Ap=m.e5b(n,f,v,"",d.a.df(11),x,"AutoDetectPointerDown",e.a.instance.ga(1795)+"...");return l}b.r(E);b.d(E,"AutoDetectActionButton",function(){return a});t=b(0);E=b(79);var c=b(1448),d=b(53),e=b(14),h=b(21),k=E.a;$k(a,k);a.prototype.dispose=function(){this.Ap.dispose();this.$=null;k.prototype.dispose.call(this)};a.prototype.domElement=
function(n){return this.Ap.domElement(n)};a.prototype.getButton=function(n){return this.Ap.getButton(n,!1)};a.prototype.Efb=function(n,f,v,m){this.Ap.OTa(c.a.JMh(n),f,m);this.Ap.Ldg(v,f,m)};a.prototype.NAa=function(n,f){var v=h.g(this.$),m=v.eb.dj(n);n=v.gg(n,m);var x=v.Gf(m).jn;if(n&&0<=n.x&&0<=n.y&&x.width>n.width+160){var l=n.bottomRight.x+this.hz,u=n.topLeft.y+this.hz,A=!1;l+160>x.bottomRight.x&&(l=n.topLeft.x-this.hz,A=!0);if(u<x.topLeft.y+this.hz){if(v.eb.qTa){this.hide();return}u=x.topLeft.y+
this.hz}this.Ap.d8b(f,m);this.hp(l,u,v.rtl,m,A)}else this.hide()};a.prototype.hp=function(n,f,v,m,x){this.Ap.hp(n,f,v,m,!1,x)};a.prototype.hide=function(){this.Ap.hide()};of.Object.defineProperties(a.prototype,{hz:{configurable:!0,enumerable:!0,get:function(){return this.Ap.hz}}});Object(t.a)(a,"AutoDetectActionButton",E.a,[])},1661:function(t,E,b){function a(P){var ea=U.call(this)||this;ea.gi=null;ea.Xg=null;ea.$=P;ea.Eb();return ea}function c(P,ea,ia){var da=Q.call(this,P)||this;da.lu=0;da.lp=!1;
da.Fc=function(){da.$f(!1)};da.$=ea;da.taskPaneManager=ia;N.a(ea).Nh(da);da.$.Bk(da.Fc);T.a.rd(da.$)&&(da.isVisible=!1);return da}function d(P){var ea=J.call(this)||this;ea.$=P;ea.Eb();return ea}function e(P){return y.call(this,P)||this}function h(P,ea){this.$=ea;this.convertToLinkedEntityManager=P}b.r(E);t=b(0);var k=b(915),n=b(15),f=b(5),v=b(76),m=b(37),x=b(1),l=b(187),u=b(21),A=b(188);h.prototype.Nc=function(P,ea){switch(ea){case -1203788282:case 48568533:case -1662108744:return P=u.g(this.$),
ea=this.convertToLinkedEntityManager.$Ai||7E3,(null===P||void 0===P?0:P.ha)&&P.ha.sa.Vc.FG>ea?!0:!1;default:return!1}};h.prototype.executeCommand=function(P,ea,ia){P=m.TaskExtensions.kk();ea=ea.command;switch(ea){case -1203788282:this.convertToLinkedEntityManager.z4g(ia[v.a.Mc].toString());break;case 311599363:this.convertToLinkedEntityManager.convertLinkedEntityToText();break;case 439914789:this.convertToLinkedEntityManager.refreshLinkedEntitiesInRange();break;case 2127195269:this.convertToLinkedEntityManager.launchDisambiguationPaneForSearch();
break;case -1662108744:this.convertToLinkedEntityManager.launchLinkedEntityDataTypeSelectorPane(ia[v.a.Mc].toString());break;case 1266950951:this.convertToLinkedEntityManager.nsi();break;case 49813714:this.convertToLinkedEntityManager.convertToLinkedEntityFromAutoDetect();break;case -1081442996:x.EwaSettings.ma(655)&&this.convertToLinkedEntityManager.fLe();break;case 1702917262:x.EwaSettings.ma(655)&&this.convertToLinkedEntityManager.showHelpArticle(f.a.zRj);break;case -90814711:x.EwaSettings.ma(655)&&
this.convertToLinkedEntityManager.showUntrustedImageBusinessBarIfNecessary();break;case 48568533:case -1027730316:if(48568533===ea||ia[v.a.zkf]&&"ConvertToLinkedEntityGallery"===ia[v.a.zkf].toString())n.ULS.sendTraceTag(559982275,0,50,"ConvertToLinkedEntityCommandHandler.ExecuteCommand() - Expanding data types preview gallery"),A.a("ExpandDataTypeGallery");break;default:P=l.a(ea)}return P};h.prototype.Ac=function(P,ea){switch(ea.command){case -1203788282:case 439914789:case 2127195269:case 49813714:return x.EwaSettings.ma(131);
case -1081442996:case 1702917262:case -90814711:return x.EwaSettings.ma(655);case 48568533:case -1027730316:case -1662108744:case 311599363:case 1266950951:return!0;default:return!1}};h.prototype.Tc=function(P,ea,ia){return"PopulateConvertToLinkedEntityMenu"===ea&&x.EwaSettings.ma(131)?this.convertToLinkedEntityManager.Tc(P,ea,ia):!1};Object(t.a)(h,"ConvertToLinkedEntityCommandHandler",null,[401]);var z=b(500),y=k.a;$k(e,y);e.prototype.zd=function(){var P=this;z.a(this.$,271,272,this.hb,function(ea){P.jd([new h(ea,
P.$)])})};e.ka=function(P){k.a.Pd(273,new e(P))};Object(t.a)(e,"ConvertToLinkedEntityCommandHandlerFactory",k.a,[]);E=b(235);var w=b(981),D=b(50),H=b(446),F=b(921),J=E.a;$k(d,J);d.prototype.create=function(){var P=this,ea=D.GetServiceTaskFactory.create(this.$.da,102,this.$.la,this.hb),ia=D.GetServiceTaskFactory.Ra(this.$.da,5,4,this.hb),da=D.GetServiceTaskFactory.Ra(this.$.da,388,387,this.hb);if(this.$.El)m.TaskExtensions.Aa(m.TaskExtensions.Vd([ea,ia,da],this.la),function(){var ha=Object(F.a)(P.$.da,
271,function(){return new w.ConvertToLinkedEntityManager(P.$,ea.result,da.result,null,null,ia.result)});P.pb(ha)},this.$.la,3);else{var xa=D.GetServiceTaskFactory.Ra(this.$.da,257,258,this.hb),Z=H.a(this.$);m.TaskExtensions.Aa(m.TaskExtensions.Vd([ea,xa,Z,ia,da],this.la),function(){P.pb(P.$.da.za(271)||new w.ConvertToLinkedEntityManager(P.$,ea.result,da.result,xa.result,Z.result,ia.result))},this.$.la,3)}};d.ka=function(P){P.da.Ga(272,new d(P))};Object(t.a)(d,"ConvertToLinkedEntityManagerFactory",
E.a,[]);var S=b(248),N=b(274),T=b(36),G=b(257),I=b(12),K=b(924),L=b(19),O=b(70),B=L.a.bvh,Q=S.a;$k(c,Q);c.prototype.pP=function(P){this.get_events().addHandler("EnrichmentTaskPaneRemoved",P)};c.prototype.GR=function(P){this.get_events().removeHandler("EnrichmentTaskPaneRemoved",P)};c.prototype.XD=function(P){this.addHandler("EnrichmentTaskPaneVilibilityChanged",P)};c.prototype.BF=function(P){this.removeHandler("EnrichmentTaskPaneVilibilityChanged",P)};c.prototype.lHg=function(P){this.addHandler("EnrichmentTaskPaneOnFocus",
P)};c.prototype.xdj=function(P){this.removeHandler("EnrichmentTaskPaneOnFocus",P)};c.prototype.qH=function(){};c.prototype.Vo=function(){return this.lp};c.prototype.Sr=function(){return this.lp};c.prototype.qR=function(){};c.prototype.dispose=function(){this.$&&this.$.Ol(this.Fc);this.taskPaneManager=this.$=null;Q.prototype.dispose.call(this)};c.prototype.Uf=function(P,ea){ea||this.raiseEvent("EnrichmentTaskPaneOnFocus");return!ea};c.prototype.ah=function(P){return I.DOMElementExtensions.nf(this.hc,
P)};c.prototype.ej=function(){};c.prototype.Dj=function(){};c.prototype.$f=function(P){this.lp=P;var ea=this.taskPaneManager;this.isVisible=P;T.a.rd(this.$)?P?this.taskPaneManager.I6("EnrichmentTaskPane",this.RF):this.taskPaneManager.hideTaskPane("EnrichmentTaskPane"):(P&&0<ea.Pz.length&&(!ea.wg||10!==ea.wg.taskPane.Pg||ea.isCollapsed)&&ea.GF(this,!0),ea.Ow());P||(u.g(this.$).Uf(!0,!1),this.$.hf())};c.prototype.DQ=function(){return!1};c.ka=function(P,ea){var ia=P.zb,da=document.getElementById(ia+
f.a.CLe);da||(da=K.a("div",P.zb+f.a.CLe,"cui-taskpane"),T.a.rd(P)||(ia=document.getElementById(ia+f.a.kR),void 0!==ia&&null!==ia?ia.appendChild(da):n.ULS.sendTraceTag(537166720,0,10,"EnrichmentTaskPane.Attach: couldn't find novTaskPaneBodyDiv. IsAppUnloading: "+P.$E)));ia=P.da;return ia.za(257)||ia.Ga(257,new c(da,P,ea))};of.Object.defineProperties(c.prototype,{isVisible:{configurable:!0,enumerable:!0,get:function(){return Object(O.a)(c.prototype,this,"isVisible")},set:function(P){Object(O.b)(c.prototype,
this,"isVisible",P);this.raiseEvent("EnrichmentTaskPaneVilibilityChanged")}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},Yd:{configurable:!0,enumerable:!0,get:function(){return G.a.kmh}},Pg:{configurable:!0,enumerable:!0,get:function(){return 10}},Kk:{configurable:!0,enumerable:!0,get:function(){return B}},UM:{configurable:!0,enumerable:!0,get:function(){return this.titleText}},titleText:{configurable:!0,enumerable:!0,get:function(){return"Enrichment"}},lo:{configurable:!0,
enumerable:!0,get:function(){return 300}},isResizable:{configurable:!0,enumerable:!0,get:function(){return!1}},hc:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},height:{configurable:!0,enumerable:!0,get:function(){return this.taskPaneManager.uO.offsetHeight}},RF:{configurable:!0,enumerable:!0,get:function(){var P=this;return this.taskPaneManager.Rua(this.hc,this.titleText,this.lo,this.isResizable,function(){P.isVisible=!0},function(){P.isVisible=!1},function(){P.isVisible=
!0},function(){P.isVisible=!1},this.lo)}}});Object(t.a)(c,"EnrichmentTaskPane",S.a,[923,6,569,429]);var U=E.a;$k(a,U);a.prototype.create=function(){var P=this,ea=D.GetServiceTaskFactory.create(this.$.da,203,this.la,this.hb),ia=D.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb);m.TaskExtensions.Aa(m.TaskExtensions.ts(m.TaskExtensions.Vd([ea,ia],this.la),function(){return P.YC},this.la),function(){P.pb(P.Xg)},this.la,3)};a.prototype.dispose=function(){this.Xg=this.gi=this.$=null;U.prototype.dispose.call(this)};
a.ka=function(P){P.da.Ga(258,new a(P))};of.Object.defineProperties(a.prototype,{YC:{configurable:!0,enumerable:!0,get:function(){var P=this;this.gi||(this.gi=m.TaskExtensions.Aa(H.a(this.$),function(ea){P.Xg=c.ka(P.$,ea.result)},this.la,3));return this.gi}}});Object(t.a)(a,"EnrichmentTaskPaneFactory",E.a,[]);var X=b(10);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.Enrichment");(function(){X.a.Fa(function(P){a.ka(P);d.ka(P);e.ka(P)})})()},981:function(t,E,b){function a(Na,sa,Wa,
Hb,Yb,Sb){var lb=nb.call(this)||this;lb.Dmd=null;lb.V6a=null;lb.Hpd=null;lb.Ipd=null;lb.Ird=null;lb.Sqd=null;lb.zhf=null;lb.Z4a=0;lb.$Db=0;lb.cxb=0;lb.hca=null;lb.Nmd=!1;lb.fMd=null;lb.Cn=null;lb.Ybd=null;lb.Wr=0;lb.BY=null;lb.I0j=null;lb.WKa=8;lb.hPa=!1;lb.xdf=!1;lb.Tkf=!1;lb.PZc=!1;lb.dTe=null;lb.mWe=null;lb.fza=null;lb.LXc=0;lb.sOg=5;lb.O0b=3E4;lb.fag=!1;lb.l$=null;lb.via=Array(5);lb.mYd=!1;lb.Gcg=!1;lb.utd=0;lb.GUf=0;lb.$ae=null;lb.U4f=!0;lb.Uc=function(wb,wa){wa.dc&&!wa.tic&&lb.showUntrustedImageBusinessBarIfNecessary()};
lb.mNi=function(wb){if(wb.Result){var wa=wb.Result;if(wa&&wa.length){y.ULS.sendTraceTag(537166922,0,50,"OnGetRichDataClassificationLabelsSuccess: Received "+wa.length+" labels");var Oa=dc.GetServiceTaskFactory.Ra(lb.$.da,274,275,0);Ba.TaskExtensions.Aa(Oa,function(){Oa.result.CXc(wa,2)||y.ULS.sendTraceTag(537166921,0,10,"OnGetRichDataClassificationLabelsSuccess - Failed to apply the policy label.")},lb.$.la,3)}}else y.ULS.sendTraceTag(537166923,0,50,"OnGetRichDataClassificationLabelsSuccess: Received no result")};
lb.Sf=function(){lb.Rzb&&(lb.COj(),lb.f4h(lb.$.ea.io.LinkedEntityAsyncRefreshStateId));lb.d7a?lb.h5h(lb.$.ea.io.RichDataClassificationLabelStateId):lb.n6a&&lb.AXd(!0)};lb.RKi=function(){lb.mYd=!0;lb.Cn&&lb.Cn.A8i()};lb.FMi=function(wb){if(wb&&!ca.a(wb))try{wb.Result.HasUntrustedImageUrl&&(lb.businessBar.Lf(58,null),lb.Gcg=!0)}catch(wa){y.ULS.sendTraceTag(574718945,0,10,"ConvertToLinkedEntityManager.OnGetHasUntrustedImageUrlsFromServerSuccess: GetHasUntrustedImageUrls encountered exception "+wa+".")}};
lb.ukf=function(){if(!lb.Tkf&&lb.hzb()&&!lb.Fnd())if(eb.a("DataTabActive"),Jb.a.pg.VQ)if(document.querySelector("#ConvertToLinkedEntityGallery-previewExpandButton")){var wb=lb.O4b();if(wb){var wa={};wa.InputMethod=ja.a.Cb;wa.CalloutName=8;wa.Target="[data-unique-id=Ribbon-ConvertToLinkedEntityGallery-previewExpandButton]";lb.$.Ka.Kb(wb,wa);lb.Tkf=!0}else y.ULS.sendTraceTag(537166880,0,10,"RibbonCommandInfo is null for LinkedEntityGalleryCallout")}else y.ULS.sendTraceTag(537166881,0,10,"Could not locate anchor for the LinkedEntityGalleryCallout");
else y.ULS.sendTraceTag(537166882,0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityGalleryCallout() - Attempted to launch linked entity gallery callout but callout not enabled")};lb.NJi=function(wb){V.a.Dg(wb.Errors)||(lb.d7a||lb.AXd(!1),lb.raiseEvent("LinkedEntityConverted"))};lb.NTi=function(){lb.$.da.Za(211,function(wb){wb.readText(Ma.a.instance.ga(1800))})};lb.Yc=function(wb,wa){y.ULS.sendTraceTag(537166867,0,50,"ConvertToLinkedEntityManager.OnWorkbookOpened called");wa.EV?y.ULS.sendTraceTag(537166865,
0,15,"ConvertToLinkedEntityManager.OnWorkbookOpened called while rendering cached content"):(lb.$.isEditMode?lb.aye():lb.rhj(),La.EwaSettings.ma(655)&&lb.mYd&&lb.fLe())};lb.NMi=function(wb){lb.Q2b();if(wb.Result){wb=wb.Result;var wa=wb.DomainDataArray;lb.hca=wb.Ribbon;if(lb.jxa&&lb.hca){var Oa={};Oa.Name=Ma.a.instance.ga(1790);Oa.DomainIds=lb.iK;lb.hca.Categories.splice(a.m8a,0,Oa)}0<wb.MaximumCellsToConvert&&(lb.$ae=wb.MaximumCellsToConvert);lb.Wr=2;wb=!1;if(wa){y.ULS.sendTraceTag(39949271,0,50,
"OnGetLinkedEntityServiceDomainsSuccess: Received "+wa.length+" domains");lb.zNa||(lb.zNa=[]);Oa=Ma.a.instance.ga(1787);var Ub=Ma.a.instance.ga(1789);wa=ik(wa);for(var hb=wa.next();!hb.done;hb=wa.next())if(hb=hb.value,hb.DomainId)if(lb.zNa.push(hb),hb.DomainBlocked){var Xb=!!hb.DomainId.StringId;y.ULS.sendTraceTag(537166861,0,50,"Domain: "+(Xb?hb.DomainId.Id.toString():hb.Name)+" is telemetry only, do not show in menu (Has String ID: "+Xb+")")}else lb.FU.ia(a.O1a(hb.DomainId),hb),hb.Name===Oa||268435456===
hb.DomainId.Id?lb.dTe=hb.DomainId.Id.toString():hb.Name===Ub||536870912===hb.DomainId.Id?lb.mWe=hb.DomainId.Id.toString():268435712===hb.DomainId.Id&&hb.ShowInRibbon&&(lb.PZc=!0),wb=!0;else y.ULS.sendTraceTag(537166862,0,10,"OnGetLinkedEntityServiceDomainsSuccess: DomainId is null.")}wb||(lb.zNa=null);lb.sdg();lb.Xpd&&lb.fMd.FWh();lb.fag||(lb.yOj(),lb.fag=!0)}else lb.zNa=null,lb.Wr=3,-1<lb.WKa&&window.setTimeout(function(){lb.cab()},100*(8-lb.WKa)),y.ULS.sendTraceTag(537166863,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");
lb.Yrc();lb.aEe();lb.PZc&&lb.Oef&&$a.b(lb.ukf,lb.$.la,500);lb.n6a&&!lb.d7a&&lb.AXd(!0)};lb.MMi=function(wb){wb=Ka.a.xf(wb.data);y.ULS.sendTraceTag(34415007,0,15,"OnGetLinkedEntityServiceDomainsFailure [Errors: "+V.a.Cc(wb)+"].");lb.zNa=null;lb.Wr=3;lb.hPa=!0;lb.Yrc()};lb.onContentReady=function(){lb.rbg()&&lb.gridView.ny(lb.onContentReady);lb.U4f&&lb.$.workbookContext.Options&1048576&&(lb.businessBar.mDj(),lb.U4f=!1)};lb.Ni=function(){lb.Q2b()};lb.pPi=function(wb){if(ca.a(wb)){var wa=dc.GetServiceTaskFactory.Ra(lb.$.da,
5,4,0);Ba.TaskExtensions.Aa(wa,function(){var Ub=null;if(null===wb||void 0===wb?0:wb.Errors)Ub=wb.Errors[0];wa.result.B4f(Ub,null)},lb.$.la,3);y.ULS.sendTraceTag(537166800,0,15,"ConvertToLinkedEntityManager.OnLinkedEntityTryAutoRefreshSuccessCore. LinkedEntityTryAutoRefresh returned with errors [Errors: "+V.a.Cc(wb.Errors)+"].");var Oa=V.a.xF(wb.Errors,[-1100324317,-2133389873],"ConvertToLinkedEntityManager:OnLinkedEntityTryAutoRefreshSuccessCore");lb.$.ea.fp(Oa)}};lb.GZc=function(){y.ULS.sendTraceTag(537166796,
0,50,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a "+lb.O0b+" millisecond interval");lb.abf("Periodic auto-refresh check",lb.eIi,lb.dIi)};lb.eIi=function(wb){ca.a(wb)?(y.ULS.sendTraceTag(537166795,0,15,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: "+V.a.Cc(wb.Errors)+"]."),++lb.LXc):lb.LXc=0;w.a.Ia(lb.fza);lb.LXc>=lb.sOg?(y.ULS.sendTraceTag(537166794,0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh"),
lb.fza=null):(y.ULS.sendTraceTag(537166793,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext"),lb.fza=la.a.instance.create(lb.GZc,lb.O0b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck"))};lb.dIi=function(wb){wb=Ka.a.xf(wb.data);D.a.gh(wb)?y.ULS.sendTraceTag(537166791,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):y.ULS.sendTraceTag(537166792,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: "+
V.a.Cc(wb)+"].");w.a.Ia(lb.fza);lb.fza=la.a.instance.create(lb.GZc,lb.O0b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")};lb.rQi=function(wb){wb=!!wb.Result&&wb.Result;y.ULS.sendTraceTag(537166790,0,50,"OnNotifyFeatureLicensingStatusSuccess- operationSucceeded? = "+wb.toString());wb?(y.ULS.sendTraceTag(537166789,0,50,"OnNotifyFeatureLicensingStatusSuccess- successful handshake duration = "+(ka.a.Ta.Wd.m-lb.Z4a)+" ms, retry count = "+lb.$Db),lb.cab()):lb.Oyc()};lb.qQi=function(){y.ULS.sendTraceTag(537166788,
0,15,"OnNotifyFeatureLicensingStatusFailed");lb.Oyc()};lb.CRi=function(wb){wb=!!wb.Result&&wb.Result;y.ULS.sendTraceTag(537166731,0,50,"OnRefreshHandshakeSuccess- operationSucceeded? = "+wb.toString());wb?(y.ULS.sendTraceTag(537166730,0,50,"OnRefreshHandshakeSuccess- successful handshake duration = "+(ka.a.Ta.Wd.m-lb.Z4a)+" ms, retry count = "+lb.cxb),lb.cab()):lb.TNf()};lb.BRi=function(){y.ULS.sendTraceTag(570769947,0,15,"OnRefreshHandshakeFailed");lb.TNf()};lb.pMi=function(wb){wb.Result?(wb=wb.Result)?
(lb.UId(),lb.businessBar.B4f(null,wb)):y.ULS.sendTraceTag(537166725,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result"):y.ULS.sendTraceTag(537166726,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result")};lb.$=Na;lb.businessBar=Sb;lb.svgIconProvider=Wa;lb.zNa=[];lb.iK=[];lb.gridView=pb.g(lb.$);lb.Edc=-1;lb.Hki=La.EwaSettings.isChangeGateEnabled("OfficeVSO:4294127_LongButtonVisibleWhenAnyDomainOverrideShowsInRibbon");lb.n6a=lb.$.ma(442)&&lb.$.ma(292);
lb.d7a=lb.$.ma(677);lb.Rzb=La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityAutoRefresh",!1);lb.jxa=lb.$.ma(676);lb.Xpd=lb.jxa&&La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReadAndWriteRecentlyUsedListToTheRoamingService",!1);lb.Oef=La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityGalleryTeachUIEnabled",!1);lb.FU=new jb.a;lb.U8a=new d(Na,sa,lb);Hb&&(lb.Cn=new e(Na,Hb,Yb,lb,lb));lb.$.Uk(lb.Yc);L.a(lb.$)&&L.a(lb.$).Gqj(lb);lb.aye();(lb.Rzb||
lb.n6a||lb.d7a)&&lb.$.ea.Bu(lb.Sf);La.EwaSettings.ma(131)&&La.EwaSettings.ma(139)&&(lb.rbg()||lb.gridView.Au(lb.onContentReady));lb.$.rA(lb.Ni);La.EwaSettings.ma(655)&&(lb.$.ea.Vj(lb.Uc),lb.showUntrustedImageBusinessBarIfNecessary());lb.Xpd&&(lb.fMd=new c(lb.$,lb));return lb}function c(Na,sa){var Wa=this;this.ejd=this.hjd=!1;this.tRi=function(Hb){y.ULS.sendTraceTag(537166680,0,50,"OnReadRoamingStringSuccess called.");Wa.hjd=!0;if(V.a.Dg(Hb.Errors))y.ULS.sendTraceTag(537166679,0,10,"OnReadRoamingStringSuccess encountered an error. Errors: "+
V.a.Cc(Hb.Errors));else{var Yb=0,Sb=[],lb=!1;try{if(!Hb.Result)return;var wb=Hb.Result;if(!wb){y.ULS.sendTraceTag(537166678,0,50,"OnReadRoamingStringSuccess - Received an empty roamingXml.");return}Sb=Wa.dYi(wb);if(!Sb||!Sb.length)return;Yb=Sb.length;Wa.sBi(Sb);Wa.eAa.uTf();y.ULS.sendTraceTag(537166677,0,50,"OnReadRoamingStringSuccess MruCount:"+Wa.eAa.RHb.length);if(La.EwaSettings.isChangeGateEnabled("OfficeVSO:5199912_LinkedEntityMruWolfram")){for(var wa=ik(Wa.eAa.RHb),Oa=wa.next();!Oa.done;Oa=
wa.next())if(1===(Oa.value.Id&1048320)>>8){lb=!0;break}y.ULS.sendTraceTag(537166676,0,50,"OnReadRoamingStringSuccess MruWolframAvailable:"+lb)}}finally{y.ULS.sendTraceTag(537166675,0,50,"ParseRecentlyUsedLinkedDataTypes returned "+Yb+" data types."),Hb=[],Hb.push(Object(cb.a)(new yb.a,{name:"MruCount",int64:Yb})),Hb.push(Object(cb.a)(new yb.a,{name:"MruWolframAvailable",bool:lb})),eb.a("ReadRecentlyUsedLinkedDataTypes",void 0,void 0,Hb)}Wa.ejd&&(Wa.Ehg(Wa.eAa.RHb),Wa.ejd=!1)}};this.KVi=function(Hb){y.ULS.sendTraceTag(537166674,
0,50,"OnWriteRoamingStringSuccess called.");V.a.Dg(Hb.Errors)?y.ULS.sendTraceTag(537166673,0,10,"OnWriteRoamingStringSuccess encountered an error. Errors: "+V.a.Cc(Hb.Errors)):Hb.Result&&(Hb.Result||y.ULS.sendTraceTag(537166672,0,15,"OnWriteRoamingStringSuccess - Failed to write to the roaming service."))};this.gCf=function(Hb,Yb,Sb){Hb=Ka.a.xf(Hb.data);y.ULS.sendTraceTag(537166671,0,10,"OnRoamingOperationFailure: Encountered errors for "+Sb+". Errors: "+V.a.Cc(Hb)+".")};this.$=Na;this.eAa=sa}function d(Na,
sa,Wa){this.Vkf=2;this.Ukf="Size64by48";this.$=Na;this.Va=sa;this.convertToLinkedEntityManager=Wa;this.jxa=La.EwaSettings.ma(676)}function e(Na,sa,Wa,Hb,Yb){var Sb=this;this.Mta=this.oIe=!1;this.zcb=this.Mwa=!0;this.XFb=this.cMb=!1;this.Tdb=null;this.Bpc=0;this.mR=function(){(Sb.zcb||Sb.Mta)&&2!==Sb.Bpc&&(Sb.XFb||Sb.Xsd(!1))};this.Uc=function(){y.ULS.sendTraceTag(537166944,0,15,"Session ID changed while ambiguous linked entities are present")};this.MJi=function(lb){V.a.Dg(lb.Errors)?(lb=V.a.Cc(lb.Errors),
lb.includes("OperationSucceededWithAlert")?y.ULS.sendTraceTag(537166942,0,50,"Convert to Linked Entity failed with an alert"):y.ULS.sendTraceTag(36975687,0,10,"Failed to Convert to Linked Entity. errors: "+lb)):lb.Result&&(Sb.$.ea.wk(Sb.Uc),Sb.$.ea.Vj(Sb.Uc),lb=lb.Result,Sb.Tdb=lb.SkydanceFeatureBitmask,Sb.Vwd(lb),Sb.cMb=!0)};this.tg=function(){(Sb.zcb||Sb.Mta)&&Sb.Xsd(!1)};this.znc=function(lb,wb){V.a.Dg(lb.Errors)?y.ULS.sendTraceTag(36975688,0,10,"Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: "+
V.a.Cc(lb.Errors)):lb.Result&&(lb=lb.Result,lb.DisambiguationJson?(Sb.cMb=!1,Sb.W_f(wb),Sb.Tdb=lb.SkydanceFeatureBitmask,wb=lb.DisambiguationJson,y.ULS.sendTraceTag(537166940,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Calling LaunchOrUpdateDisambiguationPane"),Sb.XFb=!1,Sb.xkf(wb)):y.ULS.sendTraceTag(537166941,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null"))};this.lMi=function(lb,wb){V.a.Dg(lb.Errors)?y.ULS.sendTraceTag(36975689,
0,10,"Failed to retrieve disambiguation data for search. errors: "+V.a.Cc(lb.Errors)):lb.Result&&(lb=lb.Result,lb.DisambiguationJson?(Sb.W_f(wb),Sb.Tdb=lb.SkydanceFeatureBitmask,wb=lb.DisambiguationJson,y.ULS.sendTraceTag(537166938,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Calling LaunchOrUpdateDisambiguationPane"),Sb.XFb=!0,Sb.xkf(wb)):y.ULS.sendTraceTag(537166939,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null"))};
this.RPi=function(lb){V.a.Dg(lb.Errors)?(y.ULS.sendTraceTag(36975690,0,10,"Failed to move to the next ambiguous Linked Entity. errors: "+V.a.Cc(lb.Errors)),Sb.zcb=!0):lb.Result&&(lb=lb.Result,Sb.Tdb=lb.SkydanceFeatureBitmask,Sb.Vwd(lb),Sb.cMb=!0)};this.ISi=function(lb){V.a.Dg(lb.Errors)&&y.ULS.sendTraceTag(36975691,0,10,"Failed to select Linked Entity for Disambiguation.. errors: "+V.a.Cc(lb.Errors));lb.Result?(Sb.Vwd(lb.Result),Sb.cMb=!0):Sb.Nsa()};this.CCf=function(lb){V.a.Dg(lb.Errors)?y.ULS.sendTraceTag(36975692,
0,15,"Failed to retrieve data for searching in Disambiguation Pane.  Error id names: "+V.a.Cc(lb.Errors)):lb.Result?Sb.m8b.WBc(lb.Result,null):(y.ULS.sendTraceTag(537166927,0,50,"ConvertToLinkedEntityDisambiguationPane:OnSearchLinkedEntitySucceeded: Calling CloseDisambiguationPane"),Sb.Nsa())};this.AOi=function(lb){V.a.Dg(lb.Errors)?y.ULS.sendTraceTag(537166926,0,15,"Failed to insert starter data table. Error id names: "+V.a.Cc(lb.Errors)):Sb.Nsa()};this.$=Na;this.gridView=pb.g(this.$);this.gridView.ha.qP(this.tg);
this.gridView.Au(this.mR);this.dMe=Hb;this.convertToLinkedEntityManager=Yb;Ha.a.rd(this.$)||Wa.JQ(sa);Na=new v(sa);this.m8b=new n(Na);N.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(lb){lb.isFeatureEnabled("mso_sendASmile",!0).then(function(wb){Sb.Mwa=wb;return null})})}function h(){this.market=this.appCorrelationId=this.sessionId=this.anid=this.applicationVersion=this.applicationName=null;this.featuresBitMask=this.themeId=0;this.disambiguationJson=
this.uiLanguage=null}function k(Na){this.campaignId=this.commentQuestion=null;this.isZeroBased=!1;this.ratingValuesAscending=this.ratingQuestion=this.aditionalDataRequested=null;this.showPrompt=this.showEmailRequest=!1;this.surveyType=0;this.title=null;this.campaignId=Na;this.commentQuestion=Ma.a.instance.mb(194);this.isZeroBased=!1;this.aditionalDataRequested=["EmailAddress"];this.ratingQuestion=Ma.a.instance.mb(190);this.ratingValuesAscending=[Ma.a.instance.mb(191),Ma.a.instance.mb(192),Ma.a.instance.mb(193)];
this.showPrompt=!1;this.showEmailRequest=!0;this.surveyType=4;this.title=Ma.a.instance.mb(189)}function n(Na){return f.call(this,Na)||this}function f(Na){this.Dy=null;this.ufa=Na}function v(Na){var sa=m.call(this,H.AFrameworkApplication.ta.wy,H.AFrameworkApplication.ta.ot,H.AFrameworkApplication.ta.oea,H.AFrameworkApplication.ta.xe,H.AFrameworkApplication.ub)||this;sa.taskPane=Na;sa.taskPane.lHg(sa.YZf);return sa}function m(Na,sa,Wa,Hb,Yb){this.Lq=this.Uj=this.p8d=this.o8d=this.Cv=this.uu=null;this.Ww=
!1;this.ni=Na;this.Xd=sa;this.aP=Wa;this.Vb=Hb;this.La=Yb;this.Wpa=bb.KeyInputManager.ol(va.a.ZBa,0)}function x(Na,sa,Wa){Na=l.call(this,Na,sa)||this;Na.telemetryJson=null;Na.telemetryJson=Wa;return Na}function l(Na,sa){Na=u.call(this,Na)||this;Na.messageContent=null;Na.messageContent=sa;return Na}function u(Na){this.messageType=0;this.messageType=Na}function A(){}function z(Na,sa,Wa,Hb,Yb,Sb,lb,wb,wa,Oa,Ub){Ub=Na.Na(1,void 0===Ub?null:Ub);Ub.selectedRanges=sa;Ub.isChangeObject=Wa;Ub.isFloodgateEnabled=
Hb;Ub.isStarterData=Yb;Ub.starterDataDomainId=Sb;return P.g(Na,"GetDataSelectorPaneData",Ub,lb,wb,wa,Oa,4)}b.r(E);t=b(0);var y=b(15),w=b(87),D=b(278),H=b(4),F=b(29),J=b(1035),S=b(142),N=b(83),T=b(85),G=b(38),I=b(19),K=b(5),L=b(168),O=b(1448),B=b(1451),Q=b(178),U=b(628),X=b(362),P=b(62),ea=b(84),ia=b(924),da=b(1011);A.J8h="EnrichmentContentFrame";A.width=320;Object(t.a)(A,"EnrichmentConstants",null,[]);Object(t.a)(u,"EnrichmentResponseMessage",null,[]);$k(l,u);Object(t.a)(l,"EnrichmentResponseMessageWithContent",
u,[]);$k(x,l);Object(t.a)(x,"EnrichmentResponseMessageWithContentAndTelemetryData",l,[]);var xa=b(275),Z=b(13),ha=b(96),ya=b(44),va=b(86),bb=b(109),ba=b(42),fa=b(81),ra=b(27),pa=b(107),Za=b(916),Ua=b(25);m.prototype.dispose=function(){this.VLb&&this.Lq&&(this.ni.Ba(Z.a.click,this.Lq,Object(ea.a)(this,this.Rj,"onClosePaneClick")),this.Xd.Ba(Z.a.Fd,this.Lq,Object(ea.a)(this,this.hzf,"onKeyHide")));this.Lq=null;this.Cv&&(this.PQj(),this.Cv.parentNode.removeChild(this.Cv),this.Cv=null);this.Vb.li("EnrichmentPaneId").ik(this.Wpa)};
m.prototype.show=function(Na,sa,Wa){this.uu=Na;this.Ww||(this.Uj=this.L0a(),this.RQa.appendChild(this.Uj),this.P9i(),this.La.Mb(Ua.a.Aze,pa.a.frame,Object(ea.a)(this,this.w3h,"handleEscapeKeyAction")),this.TRa(),this.Ww=!0);this.Cv.src=this.stb&&this.stb.length?this.stb+"?culture="+sa.market+"&appName="+sa.applicationName+"&themeId="+sa.themeId+"&featuresBitMask="+sa.featuresBitMask:m.Wsf;this.o8d=sa;this.p8d=Wa;this.Hdb()};m.prototype.WBc=function(Na,sa){Na=new x(2,Na,sa);this.qqc(Na)};m.prototype.TRa=
function(){var Na=this.Vb.li("EnrichmentPaneId");Na.parent=xa.AFrame.XNa;this.ni.mnb("EnrichmentPaneId",this.Uj);Na.bindAction(this.Wpa,Ua.a.Aze)};m.prototype.YZf=function(){if(this.Cv){ha.FocusManager.Aoa(this.Cv.contentWindow);var Na=new x(4,null,null);this.qqc(Na)}};m.prototype.Rj=function(){this.i3b();return!0};m.prototype.hzf=function(Na){Na=Na.Ca.keyCode;return Na===Sys.UI.Key.enter||Na===Sys.UI.Key.space?(this.i3b(),!0):!1};m.prototype.i3b=function(){this.hide();if(this.uu)this.uu.onPaneClosed()};
m.prototype.L0a=function(){var Na=ia.a("div","EnrichmentPaneId","EnrichmentPane");this.VLb&&Na.appendChild(this.K3c());this.ubi(Na);return Na};m.prototype.K3c=function(){var Na=ia.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),sa=ia.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle");sa.innerText=CommonUIStrings.l_EnrichmentPaneTitle;sa.title=CommonUIStrings.l_EnrichmentPaneTitle;var Wa=da.a.lb("CloseEnrichmentPane","EnrichmentPaneCloseButton",CommonUIStrings.l_Close,
"ClosePaneGlyph_16x16x32",!1);this.ni.ra(Z.a.click,Wa,Object(ea.a)(this,this.Rj,"onClosePaneClick"));this.Xd.ra(Z.a.Fd,Wa,Object(ea.a)(this,this.hzf,"onKeyHide"));Na.appendChild(sa);Na.appendChild(Wa);this.Lq=Wa;return Na};m.prototype.ubi=function(Na){this.Cv=ia.b("iframe","","EnrichmentFrame");Na.appendChild(this.Cv);this.Cv.id=A.J8h;this.Cv.setAttribute("role","presentation")};m.prototype.P9i=function(){ya.a.addHandler(this.Cv,"load",Object(ea.a)(this,this.Jyf,"onIFrameLoad"));ya.a.addHandler(this.Cv,
"error",Object(ea.a)(this,this.Fnc,"onIFrameError"));$addHandler(window,"message",Object(ea.a)(this,this.Kyf,"onIFrameMessage"))};m.prototype.PQj=function(){ya.a.removeHandler(this.Cv,"load",Object(ea.a)(this,this.Jyf,"onIFrameLoad"));ya.a.removeHandler(this.Cv,"error",Object(ea.a)(this,this.Fnc,"onIFrameError"));$removeHandler(window,"message",Object(ea.a)(this,this.Kyf,"onIFrameMessage"))};m.prototype.ndh=function(){this.Cv.src=m.Wsf};m.prototype.hide=function(){this.hec();this.ndh()};m.prototype.w3h=
function(Na,sa,Wa){if(1!==Wa&&(this.hide(),this.uu))this.uu.onPaneClosed();return 32};m.prototype.Jyf=function(){};m.prototype.Fnc=function(){};m.prototype.Kyf=function(Na){Na=Na.rawEvent;if(!this.Cv||-1!==this.Cv.src.indexOf(Na.origin)){try{var sa=ba.a(Na.data)}catch(Wa){return}if(!Za.c(sa.messageType)){Na=window.g_badCastCallback;window.g_badCastCallback=null;switch(sa.messageType){case 2:this.qqc(new x(1,ba.c(this.o8d),this.p8d));break;case 1:this.qqc(new l(0,this.cJh()));break;case 3:this.uu&&
this.uu.selectEntity(sa.messageContent);break;case 5:this.uu&&this.uu.vDb(sa.messageContent);break;case 8:this.uu&&(sa=ba.a(sa.messageContent),0<sa.DomainId?this.uu.dNd(sa.Query,sa.TelemetryJson,sa.DomainId,sa.DomainIdString):this.uu.searchEntity(sa.Query,sa.TelemetryJson));break;case 6:this.uu&&this.uu.cancelSearch();break;case 11:sa=ba.a(sa.messageContent);sa=m.$4b("keydown","f6",va.a.jEc,!0,!1,sa,!0,!1);this.Cv&&this.Cv.dispatchEvent(sa);break;case 12:if(ba.a(sa.messageContent).keyCode===va.a.pL&&
(sa=m.$4b("keydown","esc",va.a.pL,!0,!1,!1,!1,!1),this.Cv&&(this.Cv.dispatchEvent(sa),this.hide(),this.uu)))this.uu.onPaneClosed();break;case 13:this.uu&&this.uu.selectDataType(sa.messageContent);break;case 14:this.uu&&this.uu.showHelpArticle(sa.messageContent);break;case 15:this.uu&&this.uu.showSurveyDialog(sa.messageContent);break;case 16:this.uu&&(sa=ba.a(sa.messageContent),this.uu.insertTable(sa.DomainId,sa.DomainIdString))}window.g_badCastCallback=Na}}};m.prototype.cJh=function(){return ba.c([2,
1,3,5,8,6])};m.prototype.qqc=function(Na){Na=ba.c(Na);this.Cv.contentWindow.postMessage(Na,fa.a.aba(this.stb))};m.$4b=function(Na,sa,Wa,Hb,Yb,Sb,lb,wb){ra.a.Xu?(Sb=String.format("{0} {1} {2}",Sb?"Shift":"",lb?"Control":"",wb?"Alt":""),Sb.trim(),Wa=document.createEvent("KeyboardEvent"),Wa.initKeyboardEvent(Na,Hb,Yb,window.self,sa,0,Sb,!1,"en-US")):(sa={},sa.keyCode=Wa,sa.ctrlKey=lb,sa.shiftKey=Sb,sa.altKey=wb,sa.bubbles=Hb,sa.cancelable=Yb,Wa=new KeyboardEvent(Na,sa));return Wa};of.Object.defineProperties(m.prototype,
{VLb:{configurable:!0,enumerable:!0,get:function(){return!0}},stb:{configurable:!0,enumerable:!0,get:function(){return H.AFrameworkApplication.fa.Wa("EnrichmentPaneUrl")}}});m.Wsf="about:blank";Object(t.a)(m,"EnrichmentPane",null,[986,6]);$k(v,m);v.prototype.Hdb=function(){this.taskPane.isVisible||this.taskPane.$f(!0)};v.prototype.hec=function(){this.taskPane.$f(!1)};v.prototype.dispose=function(){this.taskPane&&(this.taskPane.xdj(this.YZf),this.taskPane=null);m.prototype.dispose.call(this)};of.Object.defineProperties(v.prototype,
{RQa:{configurable:!0,enumerable:!0,get:function(){return this.taskPane.hc},set:function(Na){this.taskPane.hc.innerHTML=Na.innerHTML}}});Object(t.a)(v,"EnrichmentTaskPaneWrapper",m,[]);f.prototype.qsi=function(Na,sa){this.Dy=Na;this.ufa&&this.ufa.show(this,sa,null)};f.prototype.WBc=function(Na,sa){this.ufa&&this.ufa.WBc(Na,sa)};f.prototype.Mxb=function(){this.ufa&&this.ufa.hide()};f.prototype.dispose=function(){this.ufa&&(this.ufa.dispose(),this.ufa=null)};f.prototype.selectEntity=function(Na){return this.Dy?
this.Dy.selectEntity(Na):!1};f.prototype.searchEntity=function(Na,sa){this.Dy&&this.Dy.searchEntity(Na,sa)};f.prototype.dNd=function(Na,sa,Wa,Hb){this.Dy&&this.Dy.dNd(Na,sa,Wa,Hb)};f.prototype.vDb=function(Na){return this.Dy?this.Dy.vDb(Na):!1};f.prototype.onPaneClosed=function(){if(this.Dy)this.Dy.onPaneClosed()};f.prototype.cancelSearch=function(){this.Dy&&this.Dy.cancelSearch()};f.prototype.selectDataType=function(Na){this.Dy&&this.Dy.selectDataType(Na)};f.prototype.showHelpArticle=function(Na){this.Dy&&
this.Dy.showHelpArticle(Na)};f.prototype.showSurveyDialog=function(Na){this.Dy&&this.Dy.showSurveyDialog(Na)};f.prototype.insertTable=function(Na,sa){this.Dy&&this.Dy.insertTable(Na,sa)};Object(t.a)(f,"EnrichmentManager",null,[985,6]);$k(n,f);n.prototype.dispose=function(){f.prototype.dispose.call(this)};Object(t.a)(n,"ExcelEnrichmentManager",f,[]);var Ma=b(14);Object(t.a)(k,"FloodgateSurvey",null,[]);var oa=b(24),ja=b(76),ta=b(448),aa=b(41),ma=b(394),Ea=b(177),Ha=b(36),Aa=b(91),V=b(31),La=b(1),Ra=
b(298),pb=b(21);Object(t.a)(h,"EnrichmentMessageContentAppProperties",null,[]);e.prototype.dispose=function(){this.$&&(this.gridView.ha.AW(this.tg),this.gridView.ny(this.mR))};e.prototype.selectEntity=function(Na){function sa(){return new ta.a}var Wa=this,Hb=aa.o(this.gridView.ha.sa.activeCell,this.$);ma.a(this.$.userOperationManager,function(Yb,Sb,lb){var wb=Wa.$.oa.va;Yb=Ra.b(Yb,Wa.ISi);var wa=wb.Na(9,null);wa.activeCell=Hb;wa.selectionIndex=Na;return P.g(wb,"SelectLinkedEntityForDisambiguation",
wa,Yb,Sb,lb,null,4)},function(Yb){return new Ea.a(109,0,Yb,void 0,sa)},null);return!0};e.prototype.searchEntity=function(Na,sa,Wa,Hb,Yb){var Sb=this;Wa=void 0===Wa?!1:Wa;Hb=void 0===Hb?0:Hb;Yb=void 0===Yb?null:Yb;y.ULS.sendTraceTag(38846755,0,50,"ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: "+sa);var lb=aa.o(this.gridView.ha.sa.activeCell,this.$);ma.a(this.$.userOperationManager,function(wb,wa,Oa){var Ub=Sb.$.oa.va,hb=Sb.Mwa,Xb=Wa,Gc=Hb,uc=Yb;wb=Ra.b(wb,Sb.CCf);
var Nc=Ub.Na(1,null);Nc.searchCell=lb;Nc.searchQuery=Na;Nc.isFloodgateEnabled=hb;Nc.isStarterData=Xb;Nc.starterDataDomainId=Gc;Nc.starterDataDomainIdString=uc;return P.g(Ub,"LinkedEntitySearch",Nc,wb,wa,Oa,null,4)},function(wb){return new Ea.a(110,0,wb,16)},null)};e.prototype.vDb=function(Na){var sa=this,Wa=aa.o(this.gridView.ha.sa.activeCell,this.$);this.zcb=!1;ma.a(this.$.userOperationManager,function(Hb,Yb,Sb){var lb=sa.$.oa.va;Hb=Ra.b(Hb,sa.RPi);var wb=lb.Na(1,null);wb.activeCell=Wa;wb.isBackward=
Na;return P.g(lb,"MoveToNextAmbiguousLinkedEntity",wb,Hb,Yb,Sb,null,4)},function(Hb){return new Ea.a(111,0,Hb,16)},null);return!0};e.prototype.onPaneClosed=function(){this.Mta=!1;this.oIe=!0;this.Bpc=0;this.XFb=!1};e.prototype.cancelSearch=function(){var Na=this,sa=this.wNd();sa&&ma.a(this.$.userOperationManager,function(Wa,Hb,Yb){var Sb=Na.$.oa.va;Wa=Ra.b(Wa,Na.CCf);var lb=Sb.Na(9,null);lb.activeCell=sa;return P.g(Sb,"CancelSearchLinkedEntity",lb,Wa,Hb,Yb,null,4)},function(Wa){return new Ea.a(112,
0,Wa,16)},null)};e.prototype.selectDataType=function(Na){y.ULS.sendTraceTag(537166977,0,50,"ConvertToLinkedEntityDisambiguationPane:SelectDataType: Calling CloseDisambiguationPane");this.Nsa();if(Na&&Na.length)if(Na=JSON.parse(Na))if(null==Na.domainId)y.ULS.sendTraceTag(537166946,0,10,"Data Selector Pane invoked SelectDataType without passing a DomainId");else{var sa={};sa.Id=Na.domainId;sa.StringId=Na.stringId;this.convertToLinkedEntityManager.convertToLinkedEntity(sa)}else y.ULS.sendTraceTag(537166947,
0,10,"Failed to parse the dataTypeJson from the Data Type Selector Pane");else y.ULS.sendTraceTag(537166976,0,10,"Recevied an empty dataTypeJson payload from the Data Type Selector Pane")};e.prototype.showHelpArticle=function(Na){var sa=new Aa.a(-859308420,ja.a.Cb,this.$.Jc,9,null),Wa={};Na=(Wa[ja.a.Wf]="HelpID="+Na,Wa.InputMethod=ja.a.Cb,Wa.ShouldCanvasTakeFocus=!0,Wa[ja.a.Mc]=K.a.GQ,Wa);this.$.Ka.Kb(sa,Na)};e.prototype.showSurveyDialog=function(Na){B.a.CMb(new k(Na))};e.prototype.insertTable=function(Na,
sa){var Wa=this,Hb=this.wNd();Hb&&ma.a(this.$.userOperationManager,function(Yb,Sb,lb){var wb=Wa.$.oa.va;Yb=Ra.b(Yb,Wa.AOi);var wa=wb.Na(1,null);wa.cell=Hb;wa.starterDataDomainId=Na;wa.starterDataDomainIdString=sa;return P.g(wb,"InsertStarterDataTable",wa,Yb,Sb,lb,null,4)},function(Yb){return new Ea.a(259,0,Yb,1)},null)};e.prototype.Xsd=function(Na){this.launchOrCloseDisambiguationPane(Na)};e.prototype.launchDisambiguationPaneForSearch=function(){var Na=this;y.ULS.sendTraceTag(36975685,0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted");
var sa=this.tnj();sa&&ma.a(this.$.userOperationManager,function(Wa,Hb,Yb){return z(Na.$.oa.va,sa,!0,Na.Mwa,!1,null,Ra.b(Wa,Na.lMi),Hb,Yb,1)},function(Wa){return new Ea.a(114,0,Wa,16)},null)};e.prototype.launchLinkedEntityDataTypeSelectorPane=function(Na,sa){var Wa=this;ma.a(this.$.userOperationManager,function(Hb,Yb,Sb){var lb=Wa.$.oa.va;Hb=Ra.b(Hb,Wa.znc);var wb=lb.Na(1,null);wb.selectedRanges=Na;wb.letyDomainId=sa;return P.g(lb,"GetDataTypeSelectorData",wb,Hb,Yb,Sb,2,4)},function(Hb){return new Ea.a(233,
0,Hb,16)},null)};e.prototype.ksi=function(Na,sa){var Wa=this;Na&&ma.a(this.$.userOperationManager,function(Hb,Yb,Sb){return z(Wa.$.oa.va,Na,!1,!1,!0,sa,Ra.b(Hb,Wa.znc),Yb,Sb,2)},function(Hb){return new Ea.a(257,0,Hb,16)},null)};e.prototype.W_f=function(Na){Na&&(this.Bpc=Na)};e.prototype.xkf=function(Na){if(La.EwaSettings.ma(655)){var sa=new Aa.a(-90814711,ja.a.Cb,0,10,null);this.$.Ka.Kb(sa,null)}this.Mta?this.m8b.WBc(Na,null):(sa=3,null!=this.Tdb?sa=this.Tdb:y.ULS.shipAssertTag(537166937,0,!1,"SkydanceFeatureBitmask was not set"),
(Na=this.OOh(Na,sa))||y.ULS.sendTraceTag(537166936,0,15,"LaunchOrUpdateDisambiguationPane: null appProperties"),this.dMe||y.ULS.sendTraceTag(537166935,0,15,"LaunchOrUpdateDisambiguationPane: null entitymanager"),this.m8b.qsi(this.dMe,Na),this.Mta=!0)};e.prototype.Nsa=function(){this.Mta&&(y.ULS.sendTraceTag(537166934,0,100,"ConvertToLinkedEntityDisambiguationPane:CloseDisambiguationPane"),this.m8b.Mxb(),this.Mta=!1,this.Bpc=0,this.XFb=!1)};e.prototype.Vwd=function(Na){var sa=Na.Row+1;Na=Na.Column+
1;0>sa||0>Na?(y.ULS.sendTraceTag(537166933,0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling CloseDisambiguationPane"),this.Nsa(),this.$.ea.wk(this.Uc)):(sa=new oa.Range(sa,Na,sa,Na,!0,!1),this.gridView.ha.updateSelection(sa,sa,60),this.zcb=!0)};e.prototype.OOh=function(Na,sa){var Wa=new h;Wa.applicationVersion=H.AFrameworkApplication.buildVersion;Wa.applicationName="ExcelWac";Wa.anid="00000000-0000-0000-0000-000000000000";Wa.sessionId=H.AFrameworkApplication.userSessionId;
Wa.appCorrelationId=Q.a.create().toString();var Hb=U.a.aH(H.AFrameworkApplication.lcid);Hb=Hb?Hb.name:null;Wa.uiLanguage=Hb;Wa.market=this.$ac(Hb);Wa.themeId=0;Wa.disambiguationJson=Na;sa<=X.a.zS?Wa.featuresBitMask=sa:y.ULS.sendTraceTag(537166932,0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties");return Wa};e.prototype.$ac=function(Na){Na=Na.split("-");return Na[Na.length-1]};e.prototype.launchOrCloseDisambiguationPane=function(Na){var sa=this,Wa=this.gridView.ha.sa.activeCell;
if(this.wNd()&&Wa)if(this.gridView.Ab.Jfc(Wa)){if((!this.oIe||Na||this.cMb)&&!this.gridView.isEditing){Na&&(this.zcb=!0);var Hb=aa.q(Wa,this.$);ma.a(this.$.userOperationManager,function(Yb,Sb,lb){return z(sa.$.oa.va,Hb,!1,sa.Mwa,!1,null,Ra.b(Yb,sa.znc),Sb,lb,1)},function(Yb){return new Ea.a(114,0,Yb,16)},null)}}else this.Nsa();else this.Nsa()};e.prototype.A8i=function(){var Na=this;if(this.Mta){var sa=this.gridView.ha.sa.activeCell;if(sa){var Wa=aa.q(sa,this.$);ma.a(this.$.userOperationManager,function(Hb,
Yb,Sb){return z(Na.$.oa.va,Wa,!1,Na.Mwa,!1,null,Ra.b(Hb,Na.znc),Yb,Sb,1)},function(Hb){return new Ea.a(114,0,Hb,16)},null)}else this.Nsa()}};e.prototype.wNd=function(){var Na=this.gridView.ha.sa;return Na.Rba()?aa.o(Na.activeCell,this.$):null};e.prototype.tnj=function(){var Na=this.gridView.ha.sa;return Na.Rba()?aa.q(Na.activeCell,this.$):null};Object(t.a)(e,"ConvertToLinkedEntityDisambiguationPane",null,[6]);var cb=b(7),Sa=b(398),Db=b(1603),Ab=b(53),Wb=b(931);d.prototype.WGh=function(Na,sa){var Wa=
b(981).ConvertToLinkedEntityManager;this.lTj();sa=this.Va.kq(sa).bE();for(var Hb=0,Yb=0,Sb=!1,lb=ik(Na.Categories),wb=lb.next();!wb.done;wb=lb.next()){if(wb=this.CHh(wb.value,Hb))this.jxa&&Yb===Wa.m8a&&(Sb=!0),sa.MenuSectionList.push(wb),++Hb;++Yb}this.jxa&&Sb&&Hb<=Wa.Wkf&&sa.MenuSectionList.splice(Wa.m8a,1);Wa=this.Va.Bc().v1b();Hb=Ab.a.df(11);Na=ik(Na.LongButtons);for(Yb=Na.next();!Yb.done;Yb=Na.next())Yb=Yb.value,this.convertToLinkedEntityManager.vzj(Yb)&&this.PDg(Wa,Yb,Hb);0<Wa.ControlList.length&&
sa.MenuSectionList.push(Wa);return sa};d.prototype.PDg=function(Na,sa,Wa){if(sa){var Hb="Data.ConvertToLinkedEntityMenuItem_"+sa.Name,Yb=this.convertToLinkedEntityManager.cQ(sa.DomainId);Yb&&(sa=Object(cb.a)(new Sa.a,{Id:Hb,ExternalId:Hb,Command:"-1662108744",LabelText:sa.Name,Alt:sa.SuperTip,Visible:!0,MenuItemId:b(981).ConvertToLinkedEntityManager.O1a(sa.DomainId),Image16by16:Wa,Image16by16Class:this.r9h(Yb.FontLocator)}),Na.ControlList.push(sa))}};d.prototype.wHh=function(Na,sa){var Wa={};Wa=(Wa.width=
24,Wa["min-width"]=24,Wa.height=24,Wa);var Hb={};return Object(cb.a)(new Db.a,{Id:b(981).ConvertToLinkedEntityManager.ZJe+Na.toString(),ExternalId:b(981).ConvertToLinkedEntityManager.ZJe+Na.toString(),MenuItemId:b(981).ConvertToLinkedEntityManager.s7c+Na.toString(),Command:"-1203788282",QueryCommand:"QueryLinkedEntityGalleryButtons",Icon:this.o9e(sa.FontLocator),LabelText:sa.Name,PreviewIconStyle:(Hb.root=Wa,Hb),Alt:this.Jdd(sa)})};d.prototype.fOg=function(Na){switch(Na){case "Animal":return Wb.a.AKg;
case "Apple":return Wb.a.CLg;case "Atom":return Wb.a.$Mg;case "Beaker":return Wb.a.ZOg;case "Bridge":return Wb.a.zQg;case "Cat":return Wb.a.AWg;case "City":return Wb.a.NYg;case "Constellation":return Wb.a.L2g;case "Dog":return Wb.a.Sih;case "Finance":return Wb.a.ROg;case "GradCap":return Wb.a.d2h;case "HumanAnatomy":return Wb.a.F8h;case "LocationPointer":return Wb.a.Pui;case "Map":return Wb.a.kWi;case "MedicineNeedle":return Wb.a.dBi;case "Mountain":return Wb.a.yCi;case "Movie":return Wb.a.TCi;case "Music":return Wb.a.fDi;
case "OuterSpace":return Wb.a.PWi;case "Planet":return Wb.a.NZi;case "Satellite":return Wb.a.Rkj;case "WolframGeneric":return Wb.a.Jjj;default:return Wb.a.y4g}};d.prototype.r9h=function(Na){if("PowerBIRibbon"!==Na)return I.a.J9c;switch(Na){case "AnimalRibbon":return I.a.ruh;case "AppleRibbon":return I.a.suh;case "AtomRibbon":return I.a.tuh;case "BeakerRibbon":return I.a.uuh;case "BridgeRibbon":return I.a.vuh;case "CenterMapRibbon":return I.a.wuh;case "CityRibbon":return I.a.xuh;case "CurrencyRibbon":return I.a.yuh;
case "ExerciseRibbon":return I.a.zuh;case "FinanceRibbon":return I.a.aQe;case "FirstAidRibbon":return I.a.Auh;case "GlobeLightningRibbon":return I.a.Buh;case "GradCapRibbon":return I.a.Cuh;case "HumanAnatomyRibbon":return I.a.Duh;case "LeafRibbon":return I.a.Euh;case "LocationPointerRibbon":return I.a.Guh;case "MapRibbon":return I.a.ZPe;case "MountainRibbon":return I.a.Huh;case "MovieRibbon":return I.a.Iuh;case "MusicRibbon":return I.a.Juh;case "NotablePeopleRibbon":return I.a.Kuh;case "OuterSpaceRibbon":return I.a.Luh;
case "PartlySunnyWeatherRibbon":return I.a.Muh;case "PowerBIRibbon":return I.a.$Pe;case "SatelliteRibbon":return I.a.Nuh;case "WolframGenericRibbon":return I.a.Fuh;case "YogaRibbon":return I.a.Puh;default:return I.a.YPe}};d.prototype.o9e=function(Na){switch(Na){case "AnimalRibbon":return"AnimalExcelDataTypes_24";case "AppleRibbon":return"AppleExcelDataTypes_24";case "AtomRibbon":return"AtomExcelDataTypes_24";case "BeakerRibbon":return"BeakerExcelDataTypes_24";case "BridgeRibbon":return"BridgeExcelDataTypes_24";
case "CenterMapRibbon":return"CenterMapExcelDataTypes_24";case "CityRibbon":return"CityExcelDataTypes_24";case "CurrencyRibbon":return"CurrencyExcelDataTypes_24";case "ExerciseRibbon":return"ExerciseExcelDataTypes_24";case "FinanceRibbon":return"Bank_32";case "FirstAidRibbon":return"FirstAidExcelDataTypes_24";case "GlobeLightningRibbon":return"GlobeLightning_24";case "GradCapRibbon":return"GradCapExcelDataTypes_24";case "HumanAnatomyRibbon":return"HumanAnatomyExcelDataTypes_24";case "LeafRibbon":return"LeafExcelDataTypes_24";
case "LocationPointerRibbon":return"LocationPointerExcelDataTypes_24";case "MapRibbon":return"OpenMap_24";case "MountainRibbon":return"MountainExcelDataTypes_24";case "MovieRibbon":return"MovieExcelDataTypes_24";case "MusicRibbon":return"MusicExcelDataTypes_24";case "NotablePeopleRibbon":return"NotablePeopleExcelDataTypes_24";case "OuterSpaceRibbon":return"OuterSpaceExcelDataTypes_24";case "PartlySunnyWeatherRibbon":return"PartlySunnyWeatherExcelDataTypes_24";case "PowerBIRibbon":return"DataProtectionExcelDataTypes_24";
case "SatelliteRibbon":return"SatelliteExcelDataTypes_24";case "WolframGenericRibbon":return"Lightning_24";case "YogaRibbon":return"YogaExcelDataTypes_24";default:return"ConvertToEntity_20"}};d.prototype.CHh=function(Na,sa){sa=this.Va.nC("ConvertToLinkedEntitySection_"+sa,this.Vkf,this.Ukf);for(var Wa=!1,Hb=ik(Na.DomainIds),Yb=Hb.next();!Yb.done;Yb=Hb.next()){var Sb=Yb.value;(Yb=this.convertToLinkedEntityManager.cQ(Sb))&&!Yb.DomainBlocked&&Yb.ShowInRibbon&&(Wa=Yb.Name,Sb=b(981).ConvertToLinkedEntityManager.O1a(Sb),
sa.Dt("Data.ConvertToLinkedEntityMenuItem_"+Sb,-1203788282,"QueryLinkedEntityGalleryIcon",void 0,Sb,this.o9e(Yb.FontLocator),void 0,void 0,this.Jdd(Yb),Wa),Wa=!0)}if(!Wa)return null;sa=sa.s1b(!0);Hb=this.Va.Bc();Hb.title=Na.Name;Na=Hb.v1b();Na.ControlList.push(sa);return Na};d.prototype.lTj=function(){this.Vkf=5;this.Ukf="Size112by64"};d.prototype.Jdd=function(Na){return Na.RibbonTooltipHeader?Na.RibbonTooltipHeader+"\n\n"+Na.RibbonTooltip:Na.RibbonTooltip};Object(t.a)(d,"ConvertToLinkedEntityMenuRenderer",
null,[957]);var ub=b(54),vb=b(259),Ka=b(121),eb=b(188),yb=b(80);c.prototype.FWh=function(){this.hjd||La.EwaSettings.isChangeGateEnabled("OfficeVSO:6422438_RoamingHandlerNoSessionIdPresent")&&!this.$.ea.dc||(y.ULS.sendTraceTag(537166691,0,50,"GetRecentlyUsedLinkedDataTypesFromRoamingService - Invoking the GetRecentlyUsedDataTypes operation."),vb.v(this.$.oa.va,0,this.tRi,this.gCf,null,null))};c.prototype.Ehg=function(Na){Na&&Na.length?this.hjd?(Na=this.epj(Na))?(y.ULS.sendTraceTag(537166688,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Invoking the WriteRecentlyUsedDataTypes operation."),
vb.B(this.$.oa.va,0,Na,this.KVi,this.gCf,null,null)):y.ULS.sendTraceTag(537166689,0,15,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Created an empty serialized string."):this.ejd=!0:y.ULS.sendTraceTag(537166690,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Tried writing an empty list of data types.")};c.prototype.epj=function(Na){if(!Na||!Na.length)return y.ULS.sendTraceTag(537166687,0,15,"SerializeRecentlyUsedLinkedDataTypes - Received an empty list of data types."),null;var sa=
[];Na=ik(Na);for(var Wa=Na.next();!Wa.done;Wa=Na.next()){Wa=Wa.value;var Hb={};Hb.Id=Wa.Id;Wa.StringId&&(Hb.StringId=Wa.StringId);sa.push(Hb)}sa="<DataTypes>"+ub.a.xc(sa)+"</DataTypes>";return 1906<sa.length?(y.ULS.sendTraceTag(537166686,0,15,"SerializeRecentlyUsedLinkedDataTypes - Exceeded the MaxSize for ridExcelRecentlyUsedLinkedDataTypes."),null):sa};c.prototype.dYi=function(Na){if(!Na)return y.ULS.sendTraceTag(537166685,0,15,"ParseRecentlyUsedLinkedDataTypes - Received an empty roamingXml."),
null;if(!Na.startsWith("<DataTypes>")||!Na.endsWith("</DataTypes>"))return y.ULS.sendTraceTag(537166684,0,15,"ParseRecentlyUsedLinkedDataTypes - Received a string without a prefix/postfix."),null;Na=Na.substring(11,Na.length-12);if(!Na)return y.ULS.sendTraceTag(537166683,0,15,"ParseRecentlyUsedLinkedDataTypes - Created an empty substring."),null;var sa=[];try{sa=ub.a.Wh(Na)}catch(Wa){return y.ULS.sendTraceTag(537166682,0,10,"ParseRecentlyUsedLinkedDataTypes - Encountered an exception. Message: "+
Wa.message),null}y.ULS.sendTraceTag(537166681,0,50,"ParseRecentlyUsedLinkedDataTypes returned "+sa.length+" data types.");return sa};c.prototype.sBi=function(Na){var sa=this.eAa.RHb,Wa=this.eAa.v7i;if(sa.length!==Wa){for(var Hb=0;Hb<Na.length&&sa.length<Wa;++Hb){var Yb=Na[Hb];this.eAa.cQ(Yb)&&!sa.includes(Yb)&&sa.push(Yb)}this.eAa.RHb=sa}};Object(t.a)(c,"LinkedDataTypeRoamingHandler",null,[]);var oc=b(572),Jb=b(59),dc=b(50),$a=b(267),Ba=b(37),la=b(47),ka=b(28),ca=b(299),Ia=b(22),jb=b(100);b.d(E,"ConvertToLinkedEntityManager",
function(){return a});var nb=G.a;$k(a,nb);a.prototype.dispose=function(){(this.Rzb||this.n6a||this.d7a)&&this.$.ea.Ew(this.Sf);La.EwaSettings.ma(655)&&this.$.ea.wk(this.Uc);!this.l$&&La.EwaSettings.ma(131)&&La.EwaSettings.ma(139)&&this.gridView.ny(this.onContentReady);this.Cn&&this.Cn.dispose();this.$.iD(this.Ni);this.$.sl(this.Yc);this.n6a&&(this.Dmd=null);w.a.Ia(this.fza)};a.prototype.QGg=function(Na){this.addHandler("LinkedEntityConverted",Na)};a.prototype.VQf=function(Na){this.removeHandler("LinkedEntityConverted",
Na)};a.prototype.selectEntity=function(Na){return this.Cn?this.Cn.selectEntity(Na):!1};a.prototype.searchEntity=function(Na,sa){this.Cn&&this.Cn.searchEntity(Na,sa)};a.prototype.dNd=function(Na,sa,Wa,Hb){this.Cn&&this.Cn.searchEntity(Na,sa,!0,Wa,Hb)};a.prototype.vDb=function(Na){return this.Cn?this.Cn.vDb(Na):!1};a.prototype.onPaneClosed=function(){if(this.Cn)this.Cn.onPaneClosed()};a.prototype.cancelSearch=function(){this.Cn&&this.Cn.cancelSearch()};a.prototype.selectDataType=function(Na){this.Cn&&
this.Cn.selectDataType(Na)};a.prototype.showHelpArticle=function(Na){this.Cn&&this.Cn.showHelpArticle(Na)};a.prototype.showSurveyDialog=function(Na){this.Cn&&this.Cn.showSurveyDialog(Na)};a.prototype.insertTable=function(Na,sa){this.Cn&&this.Cn.insertTable(Na,sa)};a.prototype.h5h=function(Na){if(this.$.isEditMode&&this.GUf!==Na&&H.AFrameworkApplication.fa.qa("SupportsPolicies")){this.GUf=Na;y.ULS.sendTraceTag(537166925,0,50,"HandleRichDataClassificationLabelStateIdChanged - Getting rich data classification labels");
Na=this.$.oa.va;var sa=this.mNi,Wa=Na.Na(1,null);P.g(Na,"GetRichDataClassificationLabels",Wa,sa,null,null,null,4)}};a.prototype.fLe=function(){function Na(Wa,Hb,Yb){var Sb=sa.$.oa.va;Wa=Ra.b(Wa,sa.RKi);var lb=Sb.Na(1,null);return P.g(Sb,"LinkedEntitiesEnableUntrustedImages",lb,Wa,Hb,Yb,null,0)}var sa=this;La.EwaSettings.Zb()?this.$.userOperationManager.Sb(new Ea.a(589,0,Na,80),null):this.$.userOperationManager.Sb(new oc.a(589,0,Na,16),null)};a.prototype.showUntrustedImageBusinessBarIfNecessary=function(){this.mYd||
this.Gcg||!this.$.ea.dc||this.joj()};a.prototype.joj=function(){function Na(Wa,Hb,Yb){var Sb=sa.$.oa.va;Wa=Ra.b(Wa,sa.FMi);var lb=Sb.Na(1,null);return P.g(Sb,"GetHasUntrustedImageUrls",lb,Wa,Hb,Yb,null,4)}var sa=this;La.EwaSettings.Zb()?this.$.userOperationManager.Sb(new Ea.a(588,0,Na,80),null):this.$.userOperationManager.Sb(new oc.a(588,0,Na,16),null)};a.prototype.AXd=function(Na){var sa=this;if(this.n6a&&null==this.Dmd&&!this.d7a&&H.AFrameworkApplication.fa.qa("SupportsPolicies")&&null!=this.V6a&&
this.V6a&&(!Na||this.$.workbookContext.Options&262144)){var Wa=dc.GetServiceTaskFactory.Ra(this.$.da,274,275,0);Ba.TaskExtensions.Aa(Wa,function(){sa.Dmd=Wa.result.lOf(2)},this.$.la,3)}};a.prototype.z4g=function(Na){(Na=this.Wih(Na))?this.convertToLinkedEntity(Na):y.ULS.sendTraceTag(537166920,0,10,"Could not convert key into domain ID")};a.prototype.convertToLinkedEntity=function(Na){y.ULS.sendTraceTag(34415004,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: "+
Na.Id+"].");if(this.gridView){var sa=this.gridView.ha.sa.Vc,Wa=sa.ze(this.gridView.YG);this.jxa&&this.Nmd&&this.BEg(Na);if(Wa){Wa=this.gridView.Ab.bxa(Wa);if(!this.O6e(Na)&&this.Uff(Na.Id)){y.ULS.sendTraceTag(537166918,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert to organization data type without curated data");if(Jb.a.pg.VQ){sa=this.$cd();if(!sa){y.ULS.sendTraceTag(537166917,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Wa=this.O4b();if(!Wa){y.ULS.sendTraceTag(537166916,
0,50,"RibbonCommandInfo is null for blankCellConvert");return}var Hb={};Hb=(Hb.InputMethod=ja.a.Cb,Hb);Hb.CalloutName=3;Hb.Target=sa;Hb.RibbonButtonLabel=La.EwaSettings.isChangeGateEnabled("OfficeVSO:4244626_BlankCellCalloutRibbonButtonLabel")?this.vUf(Na):this.pBb(Na.Id.toString());Hb.ExampleEntities=this.bRe(Na);this.$.Ka.Kb(Wa,Hb);return}y.ULS.sendTraceTag(537166915,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert to organization data without curated data, teaching callout not enabled")}if(this.Uff(Na.Id)&&
!Na.StringId)this.launchLinkedEntityDataTypeSelectorPane(a.O1a(Na));else{if(Wa){y.ULS.sendTraceTag(537166914,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range");if(La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LaunchStarterDataForBlankCell",!1)&&this.mIj(Na)){sa=aa.r(this.gridView.ha.sa.selectedRanges,this.$);this.Cn.ksi(sa,Na);return}if(Jb.a.pg.VQ){sa=this.$cd();if(!sa){y.ULS.sendTraceTag(537166913,0,50,"CalloutAnchorElement is null for blankCellConvert");
return}Wa=this.O4b();if(!Wa){y.ULS.sendTraceTag(537166912,0,50,"RibbonCommandInfo is null for blankCellConvert");return}Hb={};Hb=(Hb.InputMethod=ja.a.Cb,Hb);Hb.CalloutName=2;Hb.Target=sa;Hb.RibbonButtonLabel=this.vUf(Na);Hb.ExampleEntities=this.bRe(Na);Hb.BlankCellResourceId=this.APg(Na);Hb.HasBlankCellWalkthrough=this.T5h(Na);Hb.ServiceDomain=Na.Id;this.$.Ka.Kb(Wa,Hb);return}y.ULS.sendTraceTag(537166883,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}this.L2c(Na,
!1,sa)}}}else y.ULS.shipAssertTag(537166919,0,!1,"grid view should not be null")};a.prototype.convertToLinkedEntityFromAutoDetect=function(){this.l$&&this.l$.IHa()};a.prototype.onAutoDetectUIShown=function(){function Na(Wa,Hb,Yb){var Sb=sa.$.oa.va,lb=Sb.Na(1,null);return P.g(Sb,"OnAutoDetectUIShown",lb,Wa,Hb,Yb,null,4)}var sa=this;La.EwaSettings.Zb()?ma.a(this.$.userOperationManager,Na,function(Wa){return new Ea.a(230,0,Wa,80)},null):ma.a(this.$.userOperationManager,Na,function(Wa){return new oc.a(230,
0,Wa,16)},null)};a.prototype.L2c=function(Na,sa,Wa){function Hb(){return new ta.a}var Yb=this,Sb=aa.q(Wa,this.$);ma.a(this.$.userOperationManager,function(lb,wb,wa){var Oa=Yb.$.oa.va;lb=Ra.b(lb,Yb.NJi,Yb.NTi,Yb.Cn.MJi);var Ub=Oa.Na(1,null);Ub.selectedRanges=Sb;Ub.domainId=Na;Ub.autodetect=sa;return P.g(Oa,"ConvertToLinkedEntity",Ub,lb,wb,wa,null,4)},function(lb){return new Ea.a(115,0,lb,void 0,Hb)},null)};a.prototype.BEg=function(Na){if(this.jxa&&this.Nmd){var sa={};sa.Id=Na.Id;Na.StringId&&(sa.StringId=
Na.StringId);if(!(0<this.iK.length&&this.iK[0].Id===sa.Id&&this.iK[0].StringId===sa.StringId)){Na=!1;this.iK.splice(0,0,sa);for(var Wa=1;Wa<this.iK.length;++Wa)if(this.iK[Wa].Id===sa.Id&&this.iK[Wa].StringId===sa.StringId){this.iK.splice(Wa,1);Na=!0;break}for(;5<this.iK.length;)this.iK.splice(this.iK.length-1,1);this.hca.Categories[a.m8a].DomainIds=this.iK;this.uTf();this.Xpd&&!Na&&this.fMd.Ehg(this.iK)}}};a.prototype.convertLinkedEntityToText=function(){var Na=this;y.ULS.sendTraceTag(34719501,0,
50,"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted");if(this.gridView){var sa=aa.q(this.gridView.ha.sa.Vc,this.$);ma.a(this.$.userOperationManager,function(Wa,Hb,Yb){var Sb=Na.$.oa.va,lb=Sb.Na(1,null);lb.selectedRanges=sa;return P.g(Sb,"ConvertLinkedEntityToText",lb,Wa,Hb,Yb,null,4)},function(Wa){return new Ea.a(116,0,Wa)},null)}else y.ULS.shipAssertTag(537166879,0,!1,"grid view should not be null")};a.prototype.refreshLinkedEntitiesInRange=function(){var Na=this;
y.ULS.sendTraceTag(537166878,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange() - refresh attempted");if(pb.g(this.$)){this.$.isEditMode||y.ULS.sendTraceTag(537166876,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange(): Refreshing selection during view mode");this.UId();var sa=aa.r(this.gridView.ha.sa.selectedRanges,this.$);ma.a(this.$.userOperationManager,function(Wa,Hb,Yb){var Sb=Na.$.oa.va,lb=Sb.Na(1,null);lb.selectedRanges=sa;return P.g(Sb,"RefreshLinkedEntitiesInRange",
lb,Wa,Hb,Yb,null,4)},function(Wa){return new Ea.a(248,0,Wa)},null)}else y.ULS.shipAssertTag(537166877,0,!1,"grid view should not be null")};a.prototype.vzj=function(Na){Na=this.cQ(Na.DomainId);if(!Na||Na.DomainBlocked||La.EwaSettings.isChangeGateEnabled("OfficeVSO:4465309_NoCuratedDataNoLongButton")&&!Na.HasCuratedData)return!1;if(this.Hki){for(var sa=ik(this.FU),Wa=sa.next();!Wa.done;Wa=sa.next())if(Wa=Wa.value,Wa.value.DomainId.Id===Na.DomainId.Id&&Wa.value.ShowInRibbon)return!0;return!1}return Na.ShowInRibbon};
a.prototype.myj=function(Na){return 2!==this.Wr||!this.via[Na]};a.prototype.launchDisambiguationPaneForSearch=function(){this.Cn&&this.Cn.launchDisambiguationPaneForSearch()};a.prototype.Tc=function(Na,sa,Wa){if("PopulateConvertToLinkedEntityMenu"!==sa)return!1;this.Ybd=Wa.MenuId;if(0===this.Wr||3===this.Wr)return this.o_i(),!0;if(!this.hca)return y.ULS.sendTraceTag(537166873,0,10,"PopulateMenu: Encountered null ribbon section info"),!1;if(!this.FU)return y.ULS.sendTraceTag(537166872,0,10,"PopulateMenu: Encountered null domain collection"),
!1;this.BY=this.BY||this.U8a.WGh(this.hca,Wa.MenuId);Wa.MenuItems=this.BY;return this.Nmd=!0};a.prototype.o_i=function(){var Na=this;-1===this.Edc&&(this.cab(),this.Edc=window.setInterval(function(){Na.cab()},2E3))};a.prototype.cab=function(){if(this.$.ea.dc&&2!==this.Wr){this.WKa--;y.ULS.sendTraceTag(537166870,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted.");this.Wr=1;var Na=this.$.oa.va,sa=this.NMi,Wa=this.MMi,Hb=Na.Na(1,null);P.g(Na,"GetLinkedEntityMetadata",
Hb,sa,Wa,null,null,4)}};a.prototype.Fnd=function(){return this.$.isEditMode&&2!==this.Wr&&(0<=this.WKa||!this.hPa)};a.prototype.WYd=function(Na){H.AFrameworkApplication.zg?y.ULS.sendTraceTag(537166869,0,50,"UpdatePreviewGalleryVisibility bailed out on shutting down."):L.a(this.$)?(this.KTj(),Na&&this.$.hf()):y.ULS.sendTraceTag(537166868,0,50,"UpdatePreviewGalleryVisibility bailed out on null RibbonManager.")};a.prototype.rhj=function(){this.cxb=this.$Db=0;this.WKa=8;this.hPa=!1;this.Wr=this.Edc=0;
this.zNa=this.hca=null;this.Q2b();for(var Na=0;Na<this.ZNa;++Na)this.via[Na]=null;this.hzb()&&this.WYd(!0)};a.prototype.Q2b=function(){this.BY=null};a.prototype.hzb=function(){var Na=K.a.KHb,sa=L.a(this.$);return!!sa&&sa.Ql.xB===Na};a.prototype.sdg=function(){if(this.hca){var Na=0;if(this.jxa){var sa=-1,Wa=-1,Hb=0,Yb=0,Sb=0,lb=0,wb=[null,null,null,null,null],wa=ik(this.hca.Categories);for(hb=wa.next();!hb.done;hb=wa.next()){var Oa=!1;hb=ik(hb.value.DomainIds);for(Xb=hb.next();!Xb.done;Xb=hb.next()){Xb=
Xb.value;var Ub=this.cQ(Xb);Ub&&!Ub.DomainBlocked&&Ub.ShowInRibbon&&(Na<this.ZNa?(this.via[Na]=Xb,Yb===a.m8a&&(-1===sa&&(sa=Na),Wa=Na,lb=Wa-sa+1),++Na):Na===this.ZNa&&Hb<lb&&Yb!==a.m8a&&(wb[Hb]=Xb,++Hb),Oa=!0)}Oa&&++Sb;++Yb}if(-1<sa&&Sb<=a.Wkf){for(;Wa>=sa;--Wa)this.via.splice(Wa,1);for(sa=0;sa<lb;++sa)this.via.splice(Na+sa,0,wb[sa])}}else{lb=ik(this.hca.Categories);for(var hb=lb.next();!hb.done;hb=lb.next()){wb=ik(hb.value.DomainIds);for(var Xb=wb.next();!Xb.done&&!(sa=Xb.value,(Wa=this.cQ(sa))&&
!Wa.DomainBlocked&&Wa.ShowInRibbon&&(this.via[Na]=sa,++Na,Na>=this.ZNa));Xb=wb.next());if(Na>=this.ZNa)break}}for(;Na<this.ZNa;)this.via[Na]=null,++Na}};a.prototype.rbg=function(){var Na=Object(T.a)(380,pb.g(this.$).Ea),sa=this.gridView.ha.Re;return Na&&Na.Nid&&1===sa&&this.gridView.ha.sa.activeCell?(Na=dc.GetServiceTaskFactory.Ra(this.$.da,12,477,1),this.l$=new O.a(this.$,this.svgIconProvider,Na.result,this),!0):!1};a.prototype.nsi=function(){this.Cn&&this.Cn.Xsd(!0)};a.prototype.launchLinkedEntityDataTypeSelectorPane=
function(Na){if(this.Cn)if(Na=this.Z6c(Na))if(Na.DomainId.StringId)y.ULS.sendTraceTag(537166855,0,10,"Domain with a string ID used when launching Data Type Selector pane");else{var sa=aa.r(this.gridView.ha.sa.selectedRanges,this.$);this.Cn.launchLinkedEntityDataTypeSelectorPane(sa,Na.DomainId.Id)}else y.ULS.sendTraceTag(537166856,0,10,"Unknown domain used when launching Data Type Selector pane")};a.prototype.P2g=function(Na){var sa=this.q9h(Na),Wa=F.a.yg(this.pBb(Na));Na=F.a.yg(this.xWd(Na));return a.zGh(sa,
Ab.a.df(11),Wa,Na)};a.prototype.xWd=function(Na){try{return this.lJe(parseInt(Na,10)).Description}catch(sa){}return Ma.a.instance.ga(1784)};a.prototype.pBb=function(Na){try{return this.lJe(parseInt(Na,10)).Name}catch(sa){}return Ma.a.instance.ga(1770)};a.prototype.vUf=function(Na){try{return this.cQ(Na).Name}catch(sa){}return this.pBb(Na.Id.toString())};a.prototype.APg=function(Na){try{return this.cQ(Na).BlankCellResourceId}catch(sa){}return null};a.prototype.T5h=function(Na){try{return this.cQ(Na).HasBlankCellWalkthrough}catch(sa){}return!1};
a.prototype.O6e=function(Na){try{var sa=a.O1a(Na);if(this.FU.kb(sa))return this.FU.na(sa).HasCuratedData}catch(Wa){}return!1};a.prototype.mIj=function(Na){try{return this.cQ(Na).SupportsStarterData}catch(sa){}return!1};a.prototype.Uff=function(Na){return 268435968===Na};a.prototype.$cd=function(){return 2===L.a(this.$).PW?"[data-unique-id=LinkedEntity_MLR]":"[data-unique-id=LinkedEntity]"};a.prototype.O4b=function(){return new Aa.a(-847286761,ja.a.Cb,this.$.Jc,0,K.a.tW)};a.prototype.aEe=function(){if(this.hzb()&&
!this.Fnd()&&!this.xdf&&La.EwaSettings.ma(442)&&this.O6e({Id:268435968,StringId:null}))if(y.ULS.sendTraceTag(537166819,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - tried to launch first org data teaching callout"),Jb.a.pg.VQ){var Na=this.$cd();if(Na){var sa=this.O4b();if(sa){var Wa={};Wa=(Wa.InputMethod=ja.a.Cb,Wa);Wa.CalloutName=6;Wa.Target=Na;Wa.ShouldCanvasTakeFocus=!0;this.$.Ka.Kb(sa,Wa);this.xdf=!0}else y.ULS.sendTraceTag(537166817,0,10,"RibbonCommandInfo is null for firstOrgData")}else y.ULS.sendTraceTag(537166818,
0,10,"CalloutAnchorElement is null for firstOrgData")}else y.ULS.sendTraceTag(537166816,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - Attempted to launch firstOrgData callout, teaching callout not enabled")};a.prototype.P8h=function(Na){Na=this.Z6c(Na);return Na?this.U8a.fOg(Na.SubdomainFontLocator):(y.ULS.sendTraceTag(537166815,0,10,"ConvertToLinkedEntityManager.IconFromDomainFontLocator: Requested domain that doesn't exist in collection"),null)};a.prototype.$fc=
function(Na){return this.l$?this.l$.eOg(Na):!1};a.prototype.LJh=function(){return this.l$?this.l$.EKh():""};a.prototype.Xfi=function(){return this.l$?this.l$.XBb:!1};a.prototype.xOh=function(Na,sa){var Wa=this.$9e(Na);if(0>Wa)y.ULS.sendTraceTag(537166813,0,10,"Unexpected menuItemKey for dynamic preview gallery button: "+Na);else if(Na=(Na=this.mJe(Na))?this.cQ(Na):null)sa[J.a.GalleryButtonProps]=this.U8a.wHh(Wa,Na),sa[J.a.Alt]=this.U8a.Jdd(Na)};a.prototype.uTf=function(){this.sdg();this.hzb()&&this.WYd(!0);
this.Q2b()};a.prototype.q9h=function(Na){return Na===this.dTe?I.a.aQe:Na===this.mWe?I.a.ZPe:I.a.YPe};a.prototype.bRe=function(Na){try{return this.cQ(Na).ExampleEntities}catch(sa){}return Ma.a.instance.ga(1792)};a.prototype.Yrc=function(){(0>this.WKa||this.hPa)&&y.ULS.sendTraceTag(537166811,0,15,"RefreshFullGalleryIfOpened: Out of GetLinkedEntityServiceDomain retries");(2===this.Wr||0>this.WKa||this.hPa)&&window.clearInterval(this.Edc);this.Fnd()?this.Ybd&&this.$.frame.Pw(this.Ybd):this.WYd(this.hzb())};
a.prototype.Bb=function(Na){return this.$.zb+Na};a.prototype.KTj=function(){var Na=!0,sa=Array(this.ZNa),Wa=L.a(this.$)?L.a(this.$).Ql:null;if(Wa){for(var Hb=0;Hb<sa.length;++Hb)this.myj(Hb)?sa[Hb]=!0:Na=sa[Hb]=!1;Wa.tPd(["ConvertToLinkedEntityGallery"],Na);if(!Na)for(Na=0;Na<sa.length;++Na)sa[Na]&&Wa.tPd([this.wOh(Na)],!0)}else y.ULS.sendTraceTag(537166809,0,15,"UpdateLinkedEntityGalleryButtonsVisibility: ribbonUser should not be null")};a.prototype.cQ=function(Na){var sa=a.O1a(Na);if(this.FU.kb(sa))return this.FU.na(sa);
y.ULS.sendTraceTag(592729218,0,15,"No domain data for domain ID "+Na.Id+" (Has String ID: "+!!Na.StringId+")");return null};a.prototype.wOh=function(Na){return"ConvertToLinkedEntityPreview"+Na.toString()};a.prototype.NYd=function(){var Na=this;S.a.get_instance().ak(10,function(){Na.aEe();Na.PZc&&Na.Oef&&$a.b(Na.ukf,Na.$.la,500)})};a.prototype.tdc=function(Na,sa){switch(Na){case "QueryLinkedEntityGalleryButtons":if(!sa[J.a.InnerHTML]){Na=sa[ja.a.Mc].toString();var Wa=Ia.a.equals(Na,Ma.a.instance.ga(1787),
!0)||Ia.a.equals(Na,Ma.a.instance.ga(1788),!0),Hb=Ia.a.equals(Na,Ma.a.instance.ga(1789),!0);Wa||Hb||this.xOh(Na,sa)}break;case "QueryLinkedEntityMenuGalleryButtons":sa[J.a.InnerHTML]||(sa[J.a.InnerHTML]=this.P2g(sa[ja.a.Mc]))}return sa};a.prototype.Wih=function(Na){var sa=this.mJe(Na);if(sa)return sa;if(sa=this.Z6c(Na))return sa.DomainId;y.ULS.sendTraceTag(537166805,0,10,"Could not convert key into domain: "+Na);return null};a.prototype.lJe=function(Na){var sa={};sa.Id=Na;return this.cQ(sa)};a.prototype.Z6c=
function(Na){return this.FU.kb(Na)?this.FU.na(Na):null};a.prototype.$9e=function(Na){if(!Na.startsWith(a.s7c))return-1;var sa=parseInt(Na.substr(a.s7c.length),10);return isNaN(sa)?(y.ULS.sendTraceTag(537166802,0,10,"Unexpected index in preview gallery button key: "+Na),-1):sa};a.prototype.mJe=function(Na){Na=this.$9e(Na);return 0>Na?null:this.via[Na]};a.prototype.abf=function(Na,sa,Wa){if(this.Rzb&&this.FU&&this.FU.count){y.ULS.sendTraceTag(537166801,0,50,"ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. ("+
Na+")");var Hb=this.$.oa.va.Pb();this.$.ea.dc&&(Na=this.$.oa.va,sa=Ra.b(this.pPi,sa),Hb=Na.Na(1,void 0===Hb?null:Hb),P.g(Na,"LinkedEntityTryAutoRefresh",Hb,sa,Wa,null,null,0))}};a.prototype.yOj=function(){this.abf("Auto-refresh on load",null,null)};a.prototype.COj=function(){this.Rzb&&this.FU&&this.FU.count&&(this.fza?y.ULS.sendTraceTag(537166799,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one"):
this.$.ea.io.HasAutoRefreshableLinkedEntityDomainsEver?(y.ULS.sendTraceTag(537166797,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context"),this.fza=la.a.instance.create(this.GZc,this.O0b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")):y.ULS.sendTraceTag(537166798,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created"))};
a.prototype.Oyc=function(){if(this.$.ea.dc&&null!=this.V6a&&null!=this.Hpd&&null!=this.Ipd&&null!=this.Ird&&null!=this.Sqd)if(++this.$Db,12>=this.$Db){1===this.$Db&&(this.Z4a=ka.a.Ta.Wd.m,y.ULS.sendTraceTag(537166752,0,50,"StartLinkedEntityDelayedHandshake - starting handshake."));var Na=this.$.oa.va.Pb();vb.t(this.$.oa.va,this.Hkf,this.Ikf(),this.rQi,this.qQi,null,Na)}else y.ULS.sendTraceTag(537166751,0,15,"StartLinkedEntityDelayedHandshake - Retry count expired - failed handshake duration "+(ka.a.Ta.Wd.m-
this.Z4a)+" ms"),this.hPa=!0,this.Yrc()};a.prototype.aye=function(){var Na=this;if(this.$.isEditMode)if(null!=this.V6a)this.Oyc();else{var sa=ka.a.Ta.Wd.m,Wa=[];N.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Hb){Hb.isFeatureEnabled("ExcelPowerBiPro",!1).then(function(Yb){y.ULS.sendTraceTag(537166747,0,50,"CheckE5LicensingAndStartDelayedHandshake for ExcelPowerBiPro takes "+(ka.a.Ta.Wd.m-sa)+" Millisecond.");y.ULS.sendTraceTag(537166746,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[ExcelPowerBiPro] isEnabled=["+
Yb+"]");return Na.V6a=Yb}).then(function(){Wa.push(Hb.isFeatureEnabled("ExcelWolframAlpha",!1).then(function(Yb){y.ULS.sendTraceTag(590960588,0,50,"CheckE5LicensingAndStartDelayedHandshake for ExcelWolframAlpha takes "+(ka.a.Ta.Wd.m-sa)+" Millisecond.");y.ULS.sendTraceTag(537166743,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[ExcelWolframAlpha] isEnabled=["+Yb+"]");return Na.Ird=Yb}))}).then(function(){Wa.push(Hb.isFeatureEnabled("ExcelDisableStockGeographyDataTypes",!1).then(function(Yb){y.ULS.sendTraceTag(537166741,
0,50,"CheckE5LicensingAndStartDelayedHandshake for ExcelDisableStockGeographyDataTypes takes "+(ka.a.Ta.Wd.m-sa)+" Millisecond.");y.ULS.sendTraceTag(537166740,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[ExcelDisableStockGeographyDataTypes] isEnabled=["+Yb+"]");var Sb,lb=[(Sb=new yb.a,Sb.name="IsRestrictedByLicense",Sb.bool=Yb,Sb)];eb.a("SatoriStockGeographyLicensingRestrictions",void 0,void 0,lb);Na.zhf=Yb&&La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StockGeographyLicensingCheck",
!1);return Yb}))}).then(function(){Wa.push(Hb.isFeatureEnabled("StockHistory",!1).then(function(Yb){y.ULS.sendTraceTag(537166739,0,50,"CheckE5LicensingAndStartDelayedHandshake for StockHistory takes "+(ka.a.Ta.Wd.m-sa)+" Millisecond.");y.ULS.sendTraceTag(537166738,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[StockHistory] isEnabled=["+Yb+"]");return Na.Sqd=Yb}))}).then(function(){Wa.push(Hb.isFeatureEnabled("ExcelPowerBiFree",!1).then(function(Yb){y.ULS.sendTraceTag(537166736,0,50,
"CheckE5LicensingAndStartDelayedHandshake for ExcelPowerBiFree takes "+(ka.a.Ta.Wd.m-sa)+" Millisecond.");y.ULS.sendTraceTag(537166735,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[ExcelPowerBiFree] isEnabled=["+Yb+"]");return Na.Hpd=Yb}))}).then(function(){Wa.push(Hb.isFeatureEnabled("ExcelPowerBiPremiumPerUser",!1).then(function(Yb){y.ULS.sendTraceTag(537166734,0,50,"CheckE5LicensingAndStartDelayedHandshake for ExcelPowerBiPremiumPerUser takes "+(ka.a.Ta.Wd.m-sa)+" Millisecond.");
y.ULS.sendTraceTag(537166733,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[ExcelPowerBiPremiumPerUser] isEnabled=["+Yb+"]");return Na.Ipd=Yb}))}).then(function(){Promise.all(Wa).then(function(){Na.Oyc()})})})}};a.prototype.TNf=function(){++this.cxb;if(12>=this.cxb){1===this.cxb&&(this.Z4a=ka.a.Ta.Wd.m,y.ULS.sendTraceTag(570769946,0,50,"ConvertToLinkedEntityManager.RefreshHandshake - starting handshake refresh."));var Na=this.$.oa.va,sa=this.Hkf,Wa=this.Ikf(),Hb=this.CRi,Yb=this.BRi,
Sb=Na.Na(1,null);Sb.featureNames=sa;Sb.isEnabledValues=Wa;P.g(Na,"RefreshLinkedEntityWebServiceHandshake",Sb,Hb,Yb,null,null,4)}else y.ULS.sendTraceTag(570769945,0,15,"ConvertToLinkedEntityManager.RefreshHandshake - Retry count expired - failed handshake duration "+(ka.a.Ta.Wd.m-this.Z4a)+" ms"),this.hPa=!0,this.Yrc()};a.prototype.Ikf=function(){return[this.V6a,this.Ird,this.Sqd,this.Hpd,this.Ipd,this.zhf]};a.prototype.UId=function(){this.businessBar&&this.businessBar.mMa(57)&&this.businessBar.removeEntry(57)};
a.prototype.f4h=function(Na){if(this.utd!==Na&&this.businessBar)if(this.utd=Na){Na=this.$.oa.va;var sa=this.pMi,Wa=Na.Na(1,null);P.g(Na,"GetErrorMessageForLinkedDataTypeRefresh",Wa,sa,null,null,null,4)}else this.UId()};a.zGh=function(Na,sa,Wa,Hb){Na=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"></span>',Na,sa,Hb);Wa=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}</p></div>',
Wa);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}</div>',Na,Wa)};a.O1a=function(Na){return Na.StringId?Na.Id.toString()+"."+Na.StringId:Na.Id.toString()};of.Object.defineProperties(a.prototype,{v7i:{configurable:!0,enumerable:!0,get:function(){return 5}},RHb:{configurable:!0,enumerable:!0,get:function(){return this.iK},set:function(Na){this.iK=Na}},ZNa:{configurable:!0,enumerable:!0,get:function(){return this.via.length}},$Ai:{configurable:!0,enumerable:!0,
get:function(){return this.$ae}},Hkf:{configurable:!0,enumerable:!0,get:function(){return"ExcelPowerBiPro ExcelWolframAlpha StockHistory ExcelPowerBiFree ExcelPowerBiPremiumPerUser ExcelDisableStockGeographyDataTypes".split(" ")}}});a.ZJe="ConvertToLinkedEntityPreview";a.s7c="PreviewGalleryButtonIndex.";a.m8a=0;a.Wkf=2;Object(t.a)(a,"ConvertToLinkedEntityManager",G.a,[927,928,6,929])}}]);

//# sourceMappingURL=EwaDS.le.js.map