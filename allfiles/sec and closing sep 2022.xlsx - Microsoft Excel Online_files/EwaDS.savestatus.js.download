(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[31],{1404:function(t,E,b){function a(){Type.registerNamespace("Common.App.SaveStatus");y.a.instance.Qi(new c)}function c(){this.xQc=this.xPc=this.Flb=this.fb=null}function d(w,D,H,F){this.gga=this.aga=this.kga=this.jga=null;this.kEa=0;this.LD=this.wQc=this.ACa=this.gFc=this.jFa=null;this.Jd=w;this.Y8=D;this.I1=H;this.Vi=F;this.k9d=!0;this.IL=!1;this.Yz=3;this.ira=!0}function e(w,D){this.Pr=null;this.jga=CommonUIStrings.l_SavedStatus;
this.kga=CommonUIStrings.l_SavingStatus;this.aga=CommonUIStrings.l_ReadOnlyStatus;this.gga=CommonUIStrings.l_ReviewModeStatus;this.BTb=D;this.I1=w;this.Yz=3;this.ira=!0}function h(w){this.gga=this.aga=this.kga=this.jga=null;this.w7d=this.K$d=this.Ww=this.IL=!1;this.JPc=this.Z$d=null;this.R$d=0;this.jb=this.X$d=null;this.I1=w;this.Yz=3;this.sjb=!0}t=b(0);var k=b(84),n=b(15),f=b(167),v=b(39);h.prototype.initialize=function(w,D,H){var F=this;this.jga=this.mgd(w,D);this.kga=CommonUIStrings.l_SavingStatus;
this.aga=CommonUIStrings.l_ReadOnlyStatus;this.gga=CommonUIStrings.l_ReviewModeStatus;this.I1&&this.I1.execute(function(J){J.nVc(Object(k.a)(F,F.aPb,"updateToSavingStatus"))});this.Ww=!0;this.jb=H;return!0};h.prototype.Dea=function(w,D){this.IL=w;this.Yz=D;this.rS(this.sjb)};h.prototype.rS=function(w){!this.sjb&&w&&(this.X$d=new Date);this.sjb=w;w=null;3===this.Yz&&(w=this.sjb?this.jga:this.kga);this.nhh(w)};h.prototype.mgd=function(w,D){return w?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):
D&&D.length?String.format(CommonUIStrings.l_SavedToStatus,D):CommonUIStrings.l_SavedStatus};h.prototype.aPb=function(){this.rS(!1)};h.prototype.hTh=function(){switch(this.Yz){case 1:return this.aga;case 2:return this.gga;default:return null}};h.prototype.Thi=function(w){return this.K$d===this.IL&&this.R$d===this.Yz&&this.Z$d===w};h.prototype.F6c=function(w){var D=this;appChrome.getHeaderApi().then(function(H){H.updateDocumentTitleStatus(D.IL,w,D.hTh(),D.X$d,D.sjb);D.w7d=!0;return null});this.JPc=
null};h.prototype.nhh=function(w){var D=this;this.Ww&&f.c()&&!this.Thi(w)&&(!this.w7d&&this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.F6c(w):v.a.dTf()?(this.JPc&&n.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.JPc=window.requestIdleCallback(function(){D.F6c(w)})):window.requestAnimationFrame(function(){D.F6c(w)}),this.K$d=this.IL,this.Z$d=w,this.R$d=this.Yz)};Object(t.a)(h,"ReactSaveStatusUIHandler",
null,[766]);var m=b(170);e.prototype.fv=function(){var w=this;this.I1&&this.I1.execute(function(D){D.nVc(Object(k.a)(w,w.aPb,"updateToSavingStatus"))});this.BTb.execute(function(D){w.Pr=D})};e.prototype.Dea=function(w,D){this.Yz=D;3===D?this.rS(this.ira):2===D?this.JXd(this.gga):this.JXd(this.aga)};e.prototype.aPb=function(){this.rS(!1)};e.prototype.rS=function(w){this.ira=w;this.JXd(this.ira?this.jga:this.kga)};e.prototype.JXd=function(w){this.Pr&&this.Pr.wj(m.a.JPj,this.T2g(w))};e.prototype.T2g=
function(w){var D={};D.StatusText=w;return D};Object(t.a)(e,"SaveStatusPostMessageHandler",null,[766]);var x=b(93),l=b(123),u=b(56);d.prototype.initialize=function(w,D){if(!this.Jd)return!1;this.jga=this.mgd(w,D);this.kga=CommonUIStrings.l_SavingStatus;this.aga=CommonUIStrings.l_ReadOnlyStatus;this.gga=CommonUIStrings.l_ReviewModeStatus;this.fv();return!0};d.prototype.mgd=function(w,D){return w?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):D&&D.length?String.format(CommonUIStrings.l_SavedToStatus,
D):CommonUIStrings.l_SavedStatus};d.prototype.fv=function(){var w=this;this.Y8&&this.Y8.execute(function(D){D.CHg(Object(k.a)(w,w.aFe,"createStatusAndModeElements"));D.tHg(Object(k.a)(w,w.ABj,"showHideSaveStatusElement"));D.yMj&&w.aFe(null,null)});this.I1&&this.I1.execute(function(D){D.nVc(Object(k.a)(w,w.aPb,"updateToSavingStatus"))})};d.prototype.tv=function(){this.LD&&this.Jd&&this.Jd.aG(this.LD)};d.prototype.ABj=function(w,D){this.Dea("true"===D,this.Yz)};d.prototype.Dea=function(w,D){this.IL=
w;this.Yz=D;this.gFc&&(this.gFc.style.display=this.IL||3===this.Yz||!this.jFa?"none":"");this.ACa&&(this.ACa.style.display=this.IL||3===this.Yz?"none":"",this.ACa.innerText=1===this.Yz?this.aga:this.gga,this.ACa.title=1===this.Yz?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.wQc&&(this.wQc.style.display=this.IL||1===this.Yz||!this.jFa&&!this.ACa?"none":"");this.LD&&(this.LD.style.display=this.IL||1===this.Yz?"none":"",this.rS(this.ira),this.LD.title=CommonUIStrings.l_SaveStatusTooltip)};
d.prototype.aFe=function(w,D){w=document.getElementById(x.CuiHelper.F7e);D&&D.VYj||!w||""===this.jga||""===this.kga||""===this.aga||""===this.gga||(this.jFa=document.getElementById(x.CuiHelper.n1b),this.gFc=x.CuiHelper.gta(w,"BreadcrumbAppModeDash","-",null,!1),this.ACa=x.CuiHelper.gta(w,"BreadcrumbAppModeStatus",1===this.Yz?this.aga:this.gga,null,!1),this.udg(this.ACa),this.wQc=x.CuiHelper.gta(w,"BreadcrumbSaveStatusDash","-",null,!1),this.LD=x.CuiHelper.gta(w,"BreadcrumbSaveStatus",this.jga,null,
!1),this.udg(this.LD),this.Dea(this.IL,this.Yz))};d.prototype.aPb=function(){this.rS(!1)};d.prototype.rS=function(w){this.ira=w;this.LUj(this.ira?this.jga:this.kga)};d.prototype.LUj=function(w){!this.LD||3!==this.Yz&&2!==this.Yz||(this.k9d&&!this.ira?(this.kEa=this.LD.offsetWidth<this.kEa?this.kEa:this.LD.offsetWidth,this.IRj(this.kga),this.k9d=!1):this.LD.innerText=w)};d.prototype.udg=function(w){w.style.direction=this.Vi?"rtl":"ltr";w.style.width="auto";w.style.textAlign=this.Vi?"right":"left";
w.style.display=this.IL?"none":"";w.setAttribute("Unselectable","on")};d.prototype.IRj=function(w){this.LD&&(this.LD.style.width="",this.LD.innerText=w,this.kEa=this.LD.offsetWidth<this.kEa?this.kEa:this.LD.offsetWidth,w=l.a.YA(this.LD),this.LD.style.width=this.kEa-u.a.ZC(w.paddingLeft)-u.a.ZC(w.paddingRight)+1+"px")};Object(t.a)(d,"SaveStatusUIHandler",null,[766]);var A=b(4),z=b(92);c.prototype.Sh=function(w){var D=this;this.fb=w;A.AFrameworkApplication.fa.qa("PostMessageEmbedded")&&A.AFrameworkApplication.hideHeaderEmbedded?
this.fb.register(e,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").tc().Dc(function(){return new e(D.fb.Tb("Common.App.HostNotification.EditNotificationEventSource"),D.fb.Tb("Postmessage.IHostPostmessenger"))}):A.AFrameworkApplication.ta.Qa.Hhf||(A.AFrameworkApplication.ta.Qa.isReactSharedHeaderUxEnabled?this.fb.register(h,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").tc().Dc(function(){return new h(D.fb.Tb("Common.App.HostNotification.EditNotificationEventSource"))}):
this.fb.register(d,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").tc().Dc(function(){return new d(z.EventHandlerManager.instance,D.fb.Tb("Common.App.Header.HeaderEventSource"),D.fb.Tb("Common.App.HostNotification.EditNotificationEventSource"),A.AFrameworkApplication.isRtl)}))};c.prototype.init=function(){A.AFrameworkApplication.fa.Vu(Object(k.a)(this,this.pB,"onFullAppSettingsReady"))};c.prototype.pB=function(){var w=A.AFrameworkApplication.fa,D=!!A.AFrameworkApplication.ta.Qa&&
4===A.AFrameworkApplication.ta.Qa.rj;if(w.qa("WordEditorAutoSaveImprovementIsEnabled")||w.qa("PptEditorSaveStatusInHeaderEnabled")||D&&w.qa("SimplifiedReactRibbonUxIsEnabled")||w.qa("ExcelSaveStatusInHeaderEnabled")||w.qa("VisioSaveStatusInHeaderEnabled"))A.AFrameworkApplication.fa.qa("PostMessageEmbedded")&&A.AFrameworkApplication.hideHeaderEmbedded?(this.xQc=this.fb.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.xQc.fv():A.AFrameworkApplication.ta.Qa.Hhf||(A.AFrameworkApplication.ta.Qa.isReactSharedHeaderUxEnabled?
(this.xPc=this.fb.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.xPc.initialize(w.qa("IsSkyDrive"),w.Wa("HostNameToIncludeInSavedStatus"),A.AFrameworkApplication.fa):(this.Flb=this.fb.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.Flb.initialize(w.qa("IsSkyDrive"),w.Wa("HostNameToIncludeInSavedStatus")))};c.prototype.dispose=function(){this.Flb&&this.Flb.tv()};of.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveStatus"}}});
Object(t.a)(c,"PackageManager",null,[10,11]);var y=b(258);b.d(E,"a",function(){return a})},1465:function(t,E,b){function a(){e.a.Fa(c.ka)}function c(l){var u=x.call(this)||this;u.Ec=l;u.Eb();return u}function d(l,u){var A=this;this.Kfe=this.LKc=!1;this.Sya=function(z,y){(null===y||void 0===y?0:y.QG)&&f.a.xMg([y.QG])&&(A.Ruc=!0)};this.ro=function(){A.Ruc=!1};this.Uc=function(z,y){n.b(y)&&A.Dea(!0);A.Ruc=!1};this.Yc=function(){A.LQ=A.$.LQ;A.Dea()};this.jCf=function(){A.rS()};this.lBf=function(){A.LQ=
A.$.LQ};this.zzd=function(){v.g(A.$).Ea.gv(A.zzd);A.LQ=A.$.LQ};this.iWf=u;this.$=l;this.$.userOperationManager.Br(this.lBf);this.$.Uk(this.Yc);this.$.ea.bIg(this.jCf);this.$.ea.Vj(this.Uc);this.$.$Zb(this.Sya);this.$.ea.YL(this.ro);this.Dea()}var e=b(10);t=b(0);var h=b(83),k=b(235),n=b(238),f=b(31),v=b(21);d.prototype.dispose=function(){this.$&&(this.$.sl(this.Yc),this.$.dtc(this.Sya),this.$.userOperationManager&&this.$.userOperationManager.to(this.lBf),this.$.ea&&(this.$.ea.fej(this.jCf),this.$.ea.wk(this.Uc),
this.$.ea.ER(this.ro)),v.g(this.$)&&v.g(this.$).Ea&&v.g(this.$).Ea.gv(this.zzd))};d.prototype.Dea=function(l){l=!this.$.isEditMode||(void 0===l?!1:l);this.iWf.Dea(l,this.$.isEditMode?3:1);this.rS()};d.prototype.rS=function(){this.$.isEditMode&&this.iWf.rS(!this.LQ&&!this.Sri&&!this.Ruc)};of.Object.defineProperties(d.prototype,{Sri:{configurable:!0,enumerable:!0,get:function(){return this.$.ea?this.$.ea.bkf:!1}},LQ:{configurable:!0,enumerable:!0,get:function(){return this.LKc},set:function(l){l?this.LKc=
!0:v.g(this.$)&&v.g(this.$).Ea&&(v.g(this.$).Ea.a_()?this.LKc=!1:v.g(this.$).Ea.lx(this.zzd));this.rS()}},Ruc:{configurable:!0,enumerable:!0,get:function(){return this.Kfe},set:function(l){this.Kfe=l;this.rS()}}});Object(t.a)(d,"SaveStatusManager",null,[6]);var m=b(921),x=k.a;$k(c,x);c.prototype.create=function(){var l=this,u=h.a.instance;u.Tb("Common.App.SaveStatus.ISaveStatusUIHandler").execute(function(A){var z=new d(l.Ec,A);u.register(d,"Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager").tc().Dc(function(){return z});
A=Object(m.b)(l.Ec.da,300,function(){return u.resolve("Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager")});l.pb(A)})};c.ka=function(l){l.da.Ga(299,new c(l))};Object(t.a)(c,"SaveStatusFactory",k.a,[]);b.d(E,"a",function(){return a})},1611:function(t,E,b){b.r(E);t=b(1404);b=b(1465);Type.registerNamespace("_Ewa");Object(t.a)();Object(b.a)()}}]);

//# sourceMappingURL=EwaDS.savestatus.js.map