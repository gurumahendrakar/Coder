(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[17],{1068:function(t,E,b){function a(w){var D=this;this.businessBar=this.W7a=null;this.VHi=function(H,F){F.L6c?D.XHi(F):D.WHi(F)};this.ei=function(H,F){H=F.context.methodName;D.W7a&&H===D.W7a&&(v.ULS.sendTraceTag(537155230,0,50,'NetworkConnectionHealthChecker.OnWebMethodSuccess: Failed web method "'+D.W7a+'" has now succeeded. Querying local storage for BB showings.'),D.s8a(a.RKb,!0),D.W7a=null);D.Dmf(!1);D.U3b=!1};this.Kn=function(H,
F){x.a.$g(F.errors,[-1387426400])&&!D.U3b&&(D.U3b=!0,D.A2f()&&window.performance.mark(a.Htf),(new c(D)).isi())};this.sg=function(){D.Dmf(!0);D.s8a(a.KDb,!1);D.s8a(a.RKb,!1)};this.Iya=function(){v.ULS.sendTraceTag(537155225,0,50,"NetworkConnectionHealthChecker.OnNetworkResumed: Network resumed for session. Querying local storage for BB showings.");D.s8a(a.KDb,!0)};this.$=w;this.oa=this.$.oa;this.localStorage=new u.a;this.U3b=!1;this.$.ea.jl(this.sg);this.oa.tf.Gnb(this.Iya);this.oa.Rq(this.ei);this.$.da.Za(5,
function(H){D.businessBar=H;H.jFg(D.VHi)});this.oa.Iy(this.Kn)}function c(w){var D=this;this.jkd=[k.uig,k.hig];this.yn=function(H,F){D.ZN[F]=H;D.w6h()&&D.qgj("OnNetworkDownImmediatePing"===H.caller)};this.Dla=w;this.$=w.$;this.ZN={}}function d(){}function e(w,D,H,F,J){this.url="";this.I5a=!1;this.V7=-1;this.testIteration=0;this.baseUrl=H;this.Nvf=F;this.L8e=D;this.result=new h(D,J)}function h(w,D){this.testName=null;this.startTimeMs=0;this.isSuccess=!1;this.caller=this.errorStatusCode=this.errorMessage=
null;this.reqTotalDurationMs=0;this.browserResourceTiming=null;this.testIteration=0;this.testName=w;this.caller=D;this.reset()}function k(){}function n(){this.scenario=null;this.timeElapsed=0;this.isNewSession=!1;this.rawData=null}b.r(E);t=b(0);var f=b(7),v=b(15),m=b(337),x=b(31),l=b(11),u=b(329);Object(t.a)(n,"ConnectionErrorLogInfo",null,[]);k.hig="b-ring_Apc_Trans";k.uig="cdn_static_resource_ewa_image";Object(t.a)(k,"ResourceHosts",null,[]);var A=b(54),z=b(263);h.prototype.reset=function(){this.isSuccess=
!1;this.startTimeMs=-1;this.errorStatusCode=this.errorMessage="";this.reqTotalDurationMs=-1;this.browserResourceTiming=null};Object(t.a)(h,"NetworkTestResult",null,[]);var y=b(651);e.prototype.runTest=function(){try{if(this.I5a)return v.ULS.sendTraceTag(537155206,0,50,"NetworkTestReq.RunTest: a test for the host "+this.L8e+" is already mid way, not starting a new one."),!1;this.reset();this.I5a=!0;this.result.startTimeMs=Date.now();var w=new z.QueryStringBuilder(this.baseUrl);w.O9("tid",this.result.startTimeMs.toString());
this.url=w.toString();this.Snj();this.testIteration++;this.result.testIteration=this.testIteration;return!0}catch(D){return this.iub("Exeption: "+D.message),!1}};e.prototype.reset=function(){this.url="";this.result.reset();this.I5a=!1;this.V7=-1};e.prototype.clearTimeout=function(){-1!==this.V7&&(window.clearTimeout(this.V7),this.V7=-1)};e.prototype.Snj=function(){var w=this;try{var D=new XMLHttpRequest;D.onreadystatechange=function(){4===D.readyState&&(200===D.status?w.nCh():w.iub("Error when downloading resource. status code: "+
D.status+", status text: "+D.statusText,D.status.toString()))};D.onerror=function(){w.iub("Client error when attempting to download resource. status code: "+D.status+", response: "+D.statusText)};this.V7=window.setTimeout(function(){w.V7=-1;w.iub("Request timeout")},1E4);D.open("GET",this.url,!0);D.send(null)}catch(H){this.iub("Exeption: "+H.message)}};e.prototype.nCh=function(){this.I5a&&(this.result.reqTotalDurationMs=Date.now()-this.result.startTimeMs,this.clearTimeout(),this.result.browserResourceTiming=
y.a(this.url),this.result.isSuccess=!0,this.H3b())};e.prototype.iub=function(w,D){D=void 0===D?null:D;this.I5a&&(this.clearTimeout(),this.result.errorMessage=w,this.result.isSuccess=!1,this.result.errorStatusCode=D,this.H3b())};e.prototype.H3b=function(){this.I5a=!1;this.Nvf&&this.Nvf(this.result,this.L8e)};Object(t.a)(e,"NetworkTestReq",null,[]);d.iHh=function(w,D,H){H=void 0===H?null:H;d.bmc||(d.bmc=Array.isArray(A.a.Wh(D.ya.NetworkMeasurementUrlList))?A.a.Wh(D.ya.NetworkMeasurementUrlList):null);
for(var F=[],J=0;J<d.bmc.length;J++){var S=d.bmc[J],N=S.key;N||(N=S.Key);if(!H||H.includes(N)){var T=S.value;T||(T=S.Value);N&&T&&F.push(new e(D,N,T,w,"OnNetworkDownImmediatePing"))}}return F};d.bmc=null;Object(t.a)(d,"NetworkConnectionHelpers",null,[]);c.prototype.isi=function(){var w=d.iHh(this.yn,this.$,this.jkd);w=ik(w);for(var D=w.next();!D.done;D=w.next())D.value.runTest()};c.prototype.w6h=function(){for(var w=ik(this.jkd),D=w.next();!D.done;D=w.next())if(D=D.value,void 0===this.ZN[D]||null===
this.ZN[D])return!1;return!0};c.prototype.qgj=function(w){var D=this.$.tf.xV;w&&this.rHj(D);w=ik(this.jkd);for(var H=w.next();!H.done;H=w.next())H=H.value,this.ZN[H]=Sys.Serialization.JavaScriptSerializer.serialize(this.ZN[H]);w=Date.now();H=this.Dla.Ygd(b(1068).NetworkConnectionHealthChecker.KDb).returnValue;var F=this.Dla.Ygd(b(1068).NetworkConnectionHealthChecker.RKb).returnValue;this.ZN.isOfflineMode=D;this.ZN.networkDownBBAge=-1===H?H:w-H;this.ZN.transientServerCommunicationFailuresBBAge=-1===
F?F:w-F;this.Dla.businessBar?(this.ZN.isNetworkDownBBShown=this.Dla.businessBar.eC(55).toString(),this.ZN.isServerErrorBBShown=this.Dla.businessBar.eC(21).toString()):(this.ZN.isNetworkDownBBShown="unknown",this.ZN.isServerErrorBBShown="unknown");v.ULS.sendTraceTag(537155224,0,50,"ConnectionHealthTestsRunner.ReportPingResults: "+Sys.Serialization.JavaScriptSerializer.serialize(this.ZN))};c.prototype.rHj=function(w){for(var D=b(1068).NetworkConnectionHealthChecker,H={},F=ik(Object.keys(this.ZN)),J=
F.next();!J.done;J=F.next())J=this.ZN[J.value],H[J.testName]=J.isSuccess;H.isOfflineMode=w;this.Dla.pUd(D.i2c,Sys.Serialization.JavaScriptSerializer.serialize(H))};Object(t.a)(c,"ConnectionHealthTestsRunner",null,[]);b.d(E,"NetworkConnectionHealthChecker",function(){return a});a.prototype.dispose=function(){this.$&&(this.$.ea&&this.$.ea.pn(this.sg),this.oa&&(this.oa.tf.RIb(this.Iya),this.oa.Ez(this.Kn),this.oa.fs(this.ei)))};a.prototype.XHi=function(w){var D={};D.Timestamp=Date.now().toString();switch(w.KGa){case 21:this.W7a=
w.data.FailedMethod;D.FailedMethod=this.W7a;this.pUd(a.RKb,JSON.stringify(D));break;case 55:this.pUd(a.KDb,JSON.stringify(D))}};a.prototype.WHi=function(w){switch(w.KGa){case 21:this.s8a(a.RKb,!0);break;case 55:this.s8a(a.KDb,!0)}};a.prototype.pUd=function(w,D){try{this.localStorage.Df()&&this.localStorage.setItem(w,D)}catch(H){v.ULS.sendTraceTag(537155231,0,15,"NetworkConnectionHealthChecker.StoreDataInLocalStorage: Failed to set item to local storage. reason: "+(H.message||"Unknown"))}};a.prototype.Ygd=
function(w){if(this.localStorage.Df()&&(w=this.localStorage.Svb(w))&&"null"!==w){var D=JSON.parse(w);w=parseInt(D.Timestamp,10);D=Sys.Serialization.JavaScriptSerializer.serialize(D);return{returnValue:w,rawData:D}}return{returnValue:-1,rawData:null}};a.prototype.Dmf=function(w){if(this.localStorage.Df()){var D=this.localStorage.Svb(a.i2c);if(D&&"null"!==D){var H=-1;this.U3b&&(H=this.uOh(a.Htf,a.KGi));v.ULS.sendTraceTag(537155229,0,50,"NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: Ping Results: "+
Sys.Serialization.JavaScriptSerializer.serialize(D)+", Period offline: "+H+", New session: "+w);this.localStorage.removeItem(a.i2c)}}};a.prototype.uOh=function(w,D){if(!this.A2f())return-1;window.performance.measure(D,w);w=window.performance.getEntriesByName(D);return w.length&&w[w.length-1]?w[w.length-1].duration:(v.ULS.sendTraceTag(537155228,0,10,"NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: measure name "+D+" returned no measures."),-1)};a.prototype.s8a=function(w,D){try{var H=
this.Ygd(w);var F=H.rawData;var J=H.returnValue;if(-1!==J){var S=Object(f.a)(new n,{timeElapsed:Date.now()-J,scenario:w,isNewSession:!D,rawData:F});v.ULS.sendTraceTag(537155227,0,50,"NetworkConnectionHealthChecker.LogNetworkIssueBBShown: "+JSON.stringify(S))}this.localStorage.removeItem(w)}catch(N){v.ULS.sendTraceTag(537155226,0,15,"NetworkConnectionHealthChecker.LogNetworkIssueBBShown: Failed to get item from local storage. reason: "+(N.message||"Unknown"))}};a.prototype.A2f=function(){return l.HelperMethods.IYc&&
m.a.spb};a.KDb="NetworkDownBBShown";a.RKb="ServerCommunicationFailureBBShown";a.i2c="ConnectionHealthPingRsults";a.Htf="offMoStMa";a.KGi="offMoDuMea";Object(t.a)(a,"NetworkConnectionHealthChecker",null,[6])},1326:function(t,E,b){function a(){c.a.ti(".insert-media-dialog-old{width:870px;float:left;margin-top:7px}.insert-media-dialog{width:870px;width:clamp(400px,870px,80vw);float:left;margin-top:7px}.app-rtl .insert-media-dialog{float:right}.insert-media-frame{width:100%;height:100%;visibility:visible}.insert-media-panel-old{height:550px}.insert-media-panel{height:550px;height:clamp(300px,550px,90vh)}.keep-focus-start{position:absolute;width:-1000px;top:-1000px}.keep-focus{position:absolute;width:-1000px;top:1000px}.display-none{display:none}.padding-zero{padding:0}")}
b.d(E,"a",function(){return a});var c=b(567)},1349:function(t,E,b){function a(){lc.a.Fa(function(Fa){c.ka(Fa)})}function c(Fa){var Kb=Oe.call(this)||this;Kb.$=Fa;Kb.Fm=oc.a.instance;Kb.Eb();return Kb}function d(Fa){var Kb=this;this.L5b="";this.s2=this.Ms=null;this.Aqc=!1;this.V7e=function(gb,Tb){Kb.hide(void 0===gb?null:gb,void 0===Tb?null:Tb)};this.gridView=ka.g(Fa);this.gridView.ha.wG(this.V7e)}function e(){}function h(Fa,Kb){var gb=Jd.call(this,Fa)||this;gb.Lo=null;gb.$ci=function(Tb,pc){1===Tb?
(Tb=h.Fgh[pc[h.Egh]],Ra.ULS.sendTraceTag(537167683,0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler OK button pressed with valid input, shift direction = "+(0===Tb?"Horizontal":"Vertical")),gb.Lo.setResult(Tb)):(Ra.ULS.sendTraceTag(537167682,0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler cancel button pressed"),gb.Lo.mt())};gb.qg(Kb);return gb}function k(Fa){this.nFc=this.tPc=null;this.$=Fa}function n(){}function f(){}function v(){}function m(){}function x(Fa){this.T2c=
this.dta=null;this.O$a=15;this.$=Fa}function l(Fa,Kb){this.$=Fa;this.Fob=Kb}function u(Fa,Kb,gb,Tb){Fa=Q.call(this,Fa)||this;Fa.isFromCurrentSession=!1;Fa.top=0;Fa.left=0;Fa.isFromCurrentSession=Kb;Fa.top=gb;Fa.left=Tb;return Fa}function A(Fa,Kb,gb,Tb,pc){pc=void 0===pc?null:pc;var Xc=N.call(this,Fa,"ArtCopyPasteHandler")||this;Xc.q_g="XLO";Xc.r_g="3";Xc.AU=new F(Fa);Xc.H$=Kb;Xc.DZa=gb;Xc.ha=ka.g(Fa).ha;Xc.V2c=pc||new S(Xc.H$);Xc.yYi=new z(gb,Fa);Xc.Fob=Tb;return Xc}function z(Fa,Kb){this.qJb=new Nc.a;
this.DZa=Fa;this.$=Kb;this.f3i=function(gb){return Promise.resolve(gb)};this.tFb=function(gb){return Promise.reject(gb)}}function y(Fa,Kb,gb,Tb,pc,Xc,pd,Uc,sd){this.promise=null;this.ribbonCommandInfo=Fa;this.destination=Kb;this.vHe=gb;this.iPb=pc;this.K0=Xc;this.item=pd;this.pasteContext=Uc;this.QNa=gb||Kb.FirstRow+"_"+Kb.FirstColumn;this.Cef=!0;this.jze=sd}function w(Fa,Kb,gb,Tb,pc,Xc,pd){this.floatingObjectId=Fa;this.commandParameters=Kb;this.nt=gb;this.och=Tb;this.Baa=void 0===Xc?null:Xc;this.iPb=
void 0===pd?null:pd;this.J4g=pc}function D(Fa,Kb,gb,Tb){Kb=J.call(this,Fa,Kb,gb,"AcrossSessionRangeCopyPasteHandler",void 0===Tb?null:Tb)||this;Kb.AU=new F(Fa);return Kb}function H(Fa,Kb){Kb=void 0===Kb?null:Kb;var gb=Le.call(this,Je[Fa])||this;gb.copyErrorName=0;gb.ewaErrors=null;gb.copyErrorName=Fa;gb.ewaErrors=Kb;if(null===Kb||void 0===Kb?0:Kb.length)gb.innerError=new de.a(Kb,null);return gb}function F(Fa){this.AU=new xe.a(!0);this.$=Fa}function J(Fa,Kb,gb,Tb,pc){pc=void 0===pc?null:pc;Tb=N.call(this,
Fa,Tb)||this;Tb.T4g=Kb;Tb.H$=gb;Tb.W2c=pc||new S(Tb.H$);Tb.gridView=ka.g(Fa);Tb.ha=Tb.gridView.ha;Tb.clipboardRangeFactory=Fa.da.za(169);return Tb}function S(Fa){this.clipboardItems=this.key=null;this.H$=Fa}function N(Fa,Kb){this._name=Kb;this.$=Fa;this.Fm=oc.a.instance;this.Cp=new L(Fa,ka.g(Fa))}function T(Fa){return Fa.shadowWorkbookSizeExceedsLimit?!0:G(Fa)>eb.a.jlc}function G(Fa){return Fa?Fa.shadowWorkbookSizeExceedsLimit&&void 0!==Fa.shadowWorkbookBlockedSize&&null!==Fa.shadowWorkbookBlockedSize?
Fa.shadowWorkbookBlockedSize:Fa.shadowWorkbookBase64?Fa.shadowWorkbookBase64.length:0:0}function I(){}function K(Fa){var Kb={};this.z7f=(Kb["SourceItemType.Range"]=0,Kb["SourceItemType.Art"]=1,Kb);this.SMb={};Kb={};this.v7f=(Kb["FloatingObjectType.Unknown"]=99,Kb["FloatingObjectType.CardView"]=6,Kb["FloatingObjectType.Chart"]=0,Kb["FloatingObjectType.Group"]=7,Kb["FloatingObjectType.Image"]=1,Kb["FloatingObjectType.Ink"]=8,Kb["FloatingObjectType.InteractiveReport"]=4,Kb["FloatingObjectType.ModernOfficeExtension"]=
3,Kb["FloatingObjectType.Shape"]=5,Kb["FloatingObjectType.Slicer"]=2,Kb["FloatingObjectType.Unsupported"]=100,Kb);Kb={};this.iXc=(Kb["99"]="FloatingObjectType.Unknown",Kb["6"]="FloatingObjectType.CardView",Kb["0"]="FloatingObjectType.Chart",Kb["7"]="FloatingObjectType.Group",Kb["1"]="FloatingObjectType.Image",Kb["8"]="FloatingObjectType.Ink",Kb["4"]="FloatingObjectType.InteractiveReport",Kb["3"]="FloatingObjectType.ModernOfficeExtension",Kb["5"]="FloatingObjectType.Shape",Kb["2"]="FloatingObjectType.Slicer",
Kb["100"]="FloatingObjectType.Unsupported",Kb);Kb={};this.y7f=(Kb["RibbonCommand.Copy"]=-911352779,Kb["RibbonCommand.Cut"]=-1985798686,Kb);Kb={};this.YLd=(Kb["-911352779"]="RibbonCommand.Copy",Kb["-1985798686"]="RibbonCommand.Cut",Kb);Kb={};this.x7f=(Kb["InputManager.InputMethod.NotDefined"]=-1,Kb["InputManager.InputMethod.Unknown"]=0,Kb["InputManager.InputMethod.Keyboard"]=1,Kb["InputManager.InputMethod.Mouse"]=2,Kb["InputManager.InputMethod.Touch"]=3,Kb["InputManager.InputMethod.CrossSlide"]=9,
Kb);this.nka={};Kb={};this.w7f=(Kb["FrameMode.None"]=0,Kb["FrameMode.Reading"]=1,Kb["FrameMode.Edit"]=2,Kb);this.n3a={};Kb={};this.A7f=(Kb["UILocation.Unknown"]=0,Kb["UILocation.UpperRibbon"]=1,Kb["UILocation.Ribbon"]=2,Kb["UILocation.QAT"]=3,Kb["UILocation.Jewel"]=4,Kb["UILocation.NavigationPane"]=5,Kb["UILocation.KeyboardShortcut"]=6,Kb["UILocation.StatusBar"]=7,Kb["UILocation.Dialog"]=8,Kb["UILocation.Floatie"]=9,Kb["UILocation.NotificationBar"]=10,Kb["UILocation.StandaloneCuiRoot"]=11,Kb["UILocation.TaskPane"]=
12,Kb["UILocation.HeroDock"]=13,Kb["UILocation.SingleLineRibbon"]=14,Kb["UILocation.MultilineRibbon"]=15,Kb["UILocation.Overflow"]=16,Kb["UILocation.TellMe"]=17,Kb["UILocation.FarPeripheralControls"]=18,Kb["UILocation.ContextMenu"]=19,Kb["UILocation.DialogMenu"]=20,Kb["UILocation.Header"]=21,Kb["UILocation.FileMenu"]=22,Kb["UILocation.Toolbar"]=26,Kb["UILocation.Canvas"]=30,Kb);this.tr={};this.$=Fa;this.nka.notDefined="InputManager.InputMethod.NotDefined";this.nka.unknown="InputManager.InputMethod.Unknown";
this.nka.keyboard="InputManager.InputMethod.Keyboard";this.nka.mouse="InputManager.InputMethod.Mouse";this.nka.touch="InputManager.InputMethod.Touch";this.nka.crossSlide="InputManager.InputMethod.CrossSlide";this.n3a.none="FrameMode.None";this.n3a.reading="FrameMode.Reading";this.n3a.edit="FrameMode.Edit";this.tr.unknown="UILocation.Unknown";this.tr.upperRibbon="UILocation.UpperRibbon";this.tr.ribbon="UILocation.Ribbon";this.tr.QAT="UILocation.QAT";this.tr.jewel="UILocation.Jewel";this.tr.navigationPane=
"UILocation.NavigationPane";this.tr.keyboardShortcut="UILocation.KeyboardShortcut";this.tr.statusBar="UILocation.StatusBar";this.tr.dialog="UILocation.Dialog";this.tr.floatie="UILocation.Floatie";this.tr.notificationBar="UILocation.NotificationBar";this.tr.standaloneCuiRoot="UILocation.StandaloneCuiRoot";this.tr.taskPane="UILocation.TaskPane";this.tr.heroDock="UILocation.HeroDock";this.tr.singleLineRibbon="UILocation.SingleLineRibbon";this.tr.multilineRibbon="UILocation.MultilineRibbon";this.tr.overflow=
"UILocation.Overflow";this.tr.tellMe="UILocation.TellMe";this.tr.farPeripheralControls="UILocation.FarPeripheralControls";this.tr.header="UILocation.Header";this.tr.fileMenu="UILocation.FileMenu";this.tr.contextMenu="UILocation.ContextMenu";this.tr.dialogMenu="UILocation.DialogMenu";this.tr.toolbar="UILocation.Toolbar";this.tr.canvas="UILocation.Canvas";this.SMb.range="SourceItemType.Range";this.SMb.art="SourceItemType.Art"}function L(Fa,Kb){var gb=this;this.mjc=this.hNa=null;this.oPa=jb.a.oPa;this.fDd=
jb.a.fDd;this.bDb=jb.a.bDb;this.mgc=vb.EwaSettings.getBooleanFeatureGate(jb.a.t5b,!1);this.umd=!1;this.Pwa=vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CopyPasteWFEIncreasedLimits",!1);this.yz=function(Tb,pc){2===pc.Dq?(gb.av.clear(),gb.hNa=null):1===pc.Dq&&gb.av&&gb.av.contains(pc.If)&&(Ra.ULS.sendTraceTag(526758673,0,50,"CopyPasteUtils.OnQueueChanged: web method "+Yc.a(pc.If.operation.operationName)+" returned, it took "+(pc.If.dequeueUtcTime.getTime()-pc.If.enqueueUtcTime.getTime())+
" milliseconds to complete."),gb.av.remove(pc.If),gb.hNa=null)};this.$=Fa;this.gridView=Kb;this.umd&&(this.$.userOperationManager.Br(this.yz),this.av=new ib.a)}function O(Fa,Kb,gb,Tb,pc,Xc,pd,Uc,sd){this.destinationRange=Fa;this.qrb=gb;this.AGf=Tb;this.Ed=pc;this.iPb=Xc;this.pasteContext=pd;this.qqb=Uc;this.FWd=sd}function B(Fa){this.parameters=null;this.parameters=Fa}function Q(Fa){this.pasteParameters=null;this.pasteParameters=Fa}function U(Fa,Kb){this.content=this.destinationRange=null;this.destinationRange=
Fa;this.content=Kb}function X(Fa,Kb,gb){this.destinationRange=this.sourceRange=null;this.pasteFlags=0;this.sourceRange=Fa;this.destinationRange=Kb;this.pasteFlags=gb}function P(Fa,Kb,gb,Tb,pc,Xc,pd,Uc){Uc=void 0===Uc?null:Uc;pd=Fa.Na(1,void 0===pd?null:pd);pd.pasteParameters=Kb;return xb.g(Fa,"Paste",pd,gb,Tb,pc,Xc,64,Uc)}function ea(Fa,Kb,gb,Tb,pc,Xc,pd,Uc){Uc=void 0===Uc?null:Uc;pd=Fa.Na(1,void 0===pd?null:pd);pd.copyParameters=Kb;return xb.g(Fa,"Copy",pd,gb,Tb,pc,Xc,0,Uc)}function ia(Fa,Kb,gb,
Tb,pc,Xc,pd,Uc,sd){sd=void 0===sd?null:sd;Uc=Fa.Na(9,Uc);Uc.destinationRange=Kb;Uc.source=gb;return xb.g(Fa,"PasteString",Uc,Tb,pc,Xc,pd,64,sd)}function da(Fa,Kb,gb,Tb,pc,Xc,pd,Uc){Uc=void 0===Uc?null:Uc;pd=Fa.Na(1,pd);pd.pasteHtmlParameters=Kb;return xb.g(Fa,"PasteHtmlContent",pd,gb,Tb,pc,Xc,64,Uc)}function xa(){this.a0a=this.nze=null}function Z(Fa,Kb,gb,Tb,pc,Xc,pd,Uc,sd){sd=void 0===sd?null:sd;var Nb=zb.call(this)||this;Nb.pasteShortcutManager=null;Nb.ecf=vb.EwaSettings.tb();Nb.Pwa=vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CopyPasteWFEIncreasedLimits",
!1);Nb.K9f=null;Nb.k7a=!1;Nb.Zef=vb.EwaSettings.isChangeGateEnabled("OfficeVSO:6004791_MergedCellOverlapTelemetry");Nb.crd=vb.EwaSettings.isChangeGateEnabled("OfficeVSO:6660890_Tag_aoi75RetryLoggingFix2");Nb.WAd=function(Ja){Nb.yxj(Ja)&&(Nb.Cp.Jxb(),Ra.ULS.sendTraceTag(537167777,0,50,"CopyPasteInfrastructure.OnMetadataChanged: found that cut/copy operation was preformed in another session therefore removed the highlight in this session."))};Nb.wxi=function(Ja,Lb){Ra.ULS.sendTraceTag(537167768,0,50,
"CopyPasteInfrastructure.LogShortcutDialogAndRestoreFocus: Got shortcut dialog, user pressed ["+Ja+"]. userPressedExtensionLink="+Lb);Nb.gridView.focus()};Nb.Yc=function(Ja,Lb){Lb.bN||Lb.kg||Nb.Wq("OnWorkbookOpened",!1).catch(function(){})};Nb.wh=function(Ja,Lb){Ja=pa(Nb.oK);var ec=Nb.Cp.uwb(Ja);ec&&(Lb.pa&&Lb.pa.sheetName===ec.sheetName&&ec.isFromCurrentSession(Nb.$)?Nb.Cp.r8e(ec.ranges,Ja.commandParameters.commandType):Nb.Cp.Jxb())};Nb.Lnc=function(Ja,Lb){Ja=pa(Nb.oK);(Ja=Nb.Cp.uwb(Ja))&&Lb.item&&
Lb.item.sheetName===Ja.sheetName&&Ja.isFromCurrentSession(Nb.$)&&Nb.Wq("OnItemDeleting",!1).catch(function(){})};Nb.HFb=function(Ja,Lb){Nb.ecf?Nb.K9f(Ja,Lb):Nb.HDf()};Nb.oR=function(Ja,Lb){1===Lb.Dq&&Lb.If.operation.flags&2&&Nb.Wq("OnQueueItemChanged/ItemRemoved",!1).catch(function(){})};Nb.$=Fa;Nb.Hg=gb;Nb.gridView=ka.g(Fa);Nb.Cp=pc;Nb.Zci=Xc;Nb.oK=Kb;Nb.t4b=Tb;Nb.getStringifiedError=sd||copyPasteInfra.getStringifiedError;Nb.b3f=1===Uc;Nb.Uad=vb.EwaSettings.isChangeGateEnabled("OfficeVSO:6713439_FixCloneRangeArray");
Nb.Pi();Nb.copyPasteShortcutDialogFactory=Nb.$.da.za(85);Ra.ULS.shipAssertTag(537167825,0,!!Nb.copyPasteShortcutDialogFactory,"CopyPasteInfrastructure.ctor: this.copyPasteShortcutDialogFactory shouldn't be null.");pd||(Ra.ULS.sendTraceTag(537167824,0,50,"CopyPasteInfrastructure.ctor: userId is null, using default userId."),pd=Z.feh);Nb.userHash=cb.a.Nv(pd);Nb.wBi="CultureTag: "+oc.a.instance.xsb+" HASH: ";Nb.oK.addMetadataChangeListener(Z.xqf,Nb.WAd);Nb.nAi=jb.a.bDb;Nb.cya=Nb.Pwa?vb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.CopyPasteHtmlImportMaxLength",
Nb.$.ya.CopyPasteMaxPayloadLength):eb.a.cya;Nb.ho=vb.EwaSettings.getBooleanFeatureGate(jb.a.IPa,!1);Nb.ho&&Fa.da.Za(478,function(Ja){Nb.pasteShortcutManager=Ja});Nb.ecf&&(Nb.K9f=wa.a(function(){Nb.HDf()},1,Nb.$.la,"CopyPasteInfrastructure.OnStartEditInternal",!0));return Nb}function ha(Fa){if(!Fa)return"null";var Kb=[];Fa=ik(Fa.get());for(var gb=Fa.next();!gb.done;gb=Fa.next())gb=gb.value,Kb.push(gb.clipboardDataFormat+"("+gb.data.length+")");Kb.sort();return Kb.join(",")}function ya(Fa){switch(Fa){case 0:return"None";
case 2:return"Art";case 1:return"Range";default:return"Unknown"}}function va(Fa,Kb){return Fa?Kb&&Kb.ya?Fa.sessionId!==Kb.ya.UserSessionId:(Ra.ULS.shipAssertTag(537166209,0,!1,"ewaControl shouldn't be null"),!1):(Ra.ULS.shipAssertTag(537166210,0,!1,"copyContext shouldn't be null"),!1)}function bb(){}function ba(){}function fa(){}function ra(Fa,Kb,gb,Tb){this.$=Fa;this.originalDestinations=Kb;this.u9b=gb;this.mlg=Tb;this.Kvg=this.originalDestinations;this.fpg=this.u9b;this.Xsg="PasteRecoveryUI"}function pa(Fa){return Fa&&
(Fa=Fa.getCachedMetadata(),null===Fa||void 0===Fa?0:Fa.lastCopy)?Fa.lastCopy:null}function Za(Fa){return Fa.clipboardItems&&(Fa=Fa.clipboardItems.getItem(oa.Wgi))&&"1"===Fa?!0:!1}function Ua(Fa){return Ma(Fa)&&!(void 0===Fa.clipboardItems||null===Fa.clipboardItems)&&!!Fa.clipboardItems.getItem(oa.png)&&!Fa.clipboardItems.getItem(oa.plainText)}function Ma(Fa){return Fa.clipboardItems&&(Fa=Fa.clipboardItems.getItem(oa.xki))&&"1"===Fa?!0:!1}function oa(){}function ja(){}function ta(Fa){return!!Fa&&Object.getType(Fa)===
aa}function aa(Fa,Kb,gb,Tb,pc){Tb=Ea.call(this,Tb,pc)||this;Ra.ULS.shipAssertTag(537167645,0,!!Kb&&0<Kb.length,"RangeSourceItem.ctor: ranges should not be null or empty");Tb.$=Fa;Tb.ranges=Kb;Tb.sheetName=gb;return Tb}function ma(Fa,Kb,gb,Tb,pc){gb=Ea.call(this,gb,Tb)||this;gb.activeFloatingObjectControlId=Fa;gb.sheetName=Kb;gb.type=pc;return gb}function Ea(Fa,Kb){var gb=this;this.jGh=function(){var Tb={};Tb.SourceItem=gb.toString();return Tb};this.sessionStateId=Fa;this.sessionId=Kb;this.toJSON=
this.jGh}function Ha(Fa,Kb,gb,Tb,pc){var Xc=Fa.Stopwatch,pd={};pd.a=pc;pd.e=Xc.id;pd.c="RearrangeRowColumn";pd.b="mouse";pd.d=Fa.OperationId.toString();pd.f=gb.toString();pd.g=Tb.toString();pd.h=Kb.toString();pd.i=Fa.DragDropIsShiftKeyDown;pd.j=!0;pd.o=Xc.qc;pd.q=!1;pd.r=Fa.CopyPasteTargetType.toString();pd.s=Fa.EncounteredDeploymentErrors;return pd}function Aa(Fa){Fa=Jb.call(this,Fa)||this;Fa.p_g=function(){Ra.ULS.sendTraceTag(537167827,0,50,"ClipboardReadPermissionAskDialog OK button pressed")};
Ra.ULS.sendTraceTag(537167828,0,50,"ClipboardReadPermissionAskDialog.ClipboardReadPermissionAskDialog");Fa.Rb=0;Fa.kc(1,oc.a.instance.ga(2238));var Kb=oc.a.instance.ga(2236),gb=Fa.JM();Fa.initializeAndShow(Kb,Fa.p_g,gb);return Fa}var V=b(0),La=b(7),Ra=b(15),pb=b(235),cb=b(29),Sa=b(27),Db=b(371),Ab=b(178),Wb=b(278),ub=b(375),vb=b(1),Ka=b(38),eb=b(9),yb=b(300),oc=b(14),Jb=yb.a;$k(Aa,Jb);Aa.prototype.JM=function(){var Fa={};Fa.id=this.mc;var Kb=oc.a.instance.ga(2237);Fa.DialogMessage=Kb;return Fa};of.Object.defineProperties(Aa.prototype,
{mc:{configurable:!0,enumerable:!0,get:function(){return"ClipboardReadPermissionAskDialog"}}});Object(V.a)(Aa,"ClipboardReadPermissionAskDialog",yb.a,[]);var dc=b(51);Ea.prototype.adf=function(Fa){return Fa?this.sessionStateId===Fa.sessionStateId&&this.sessionId===Fa.sessionId:!1};Ea.prototype.isFromCurrentSession=function(Fa){return this.sessionId===Fa.ya.UserSessionId};Object(V.a)(Ea,"SourceItem",null,[]);$k(ma,Ea);ma.prototype.isEqual=function(Fa){return Fa&&Object.getType(Fa)===ma?this.adf(Fa)&&
this.activeFloatingObjectControlId===Fa.activeFloatingObjectControlId&&this.sheetName===Fa.sheetName:!1};ma.prototype.toString=function(){return this.type.toString()};Object(V.a)(ma,"ArtSourceItem",Ea,[]);var $a;(function(Fa){Fa[Fa.valid=0]="valid";Fa[Fa.notPairwiseDisjoint=1]="notPairwiseDisjoint";Fa[Fa.cutNotSupportedInDiscontinuousSelection=2]="cutNotSupportedInDiscontinuousSelection";Fa[Fa.notValidForm=3]="notValidForm";Fa[Fa.temporarilyBlockedCopy=4]="temporarilyBlockedCopy"})($a||($a={}));Object(V.b)("CopySourceValidationOptions",
$a);var Ba=b(41);$k(aa,Ea);aa.prototype.isEqual=function(Fa){return Fa&&Object.getType(Fa)===aa?this.adf(Fa)&&Ba.Q(this.ranges,Fa.ranges)&&this.sheetName===Fa.sheetName:!1};aa.prototype.toString=function(){return Ba.i(this.ranges,",",this.$,!1)};Object(V.a)(aa,"RangeSourceItem",Ea,[]);ja.rWj="PasteError_FailedToReadFromClipboard_UserHashMismatchError";Object(V.a)(ja,"ExpectedErrorNames",null,[]);oa.plainText="text/plain";oa.html="text/html";oa.png="image/png";oa.shadowWorkbook="data/shadow-workbook";
oa.xki="metadata/is-last-copy-was-external";oa.Wgi="metadata/is-last-copy-was-external-XLO-source";oa.KYg="metadata/chrome-extension-id";oa.qrb="copyId";oa.hJg="metadata/additional-signature-data-attributes";Object(V.a)(oa,"ClipboardDataFormat",null,[]);var la=b(48),ka=b(21),ca=b(33);ra.prototype.dKa=function(){return ra.GYi};ra.prototype.eOh=function(){return this.u9b&&1===this.u9b.length?this.fOh(this.u9b[0]):null};ra.prototype.fOh=function(Fa){var Kb=ka.g(this.$),gb=Kb.eb.dj(Fa),Tb=Kb.gg(Fa,gb);
Kb=Kb.rtl;if(!Tb)return null;Fa=ka.g(this.$).Gf(gb);var pc=Fa.jn;if(!pc.xd(Tb))return null;Tb=pc.ze(Tb);var Xc=Tb.topLeft.y,pd=Tb.bottomRight.y,Uc=Kb?Tb.bottomRight.x:Tb.topLeft.x;Tb=Kb?Tb.topLeft.x:Tb.bottomRight.x;var sd=new la.a(Tb+(Kb?-81:81),pd+38+6);if(pc.CHa(sd))return this.t4a(Fa,pc,gb,Tb,pd,Kb?12:-3,66);sd=new la.a(Tb+(Kb?-81:81),pd);if(pc.CHa(sd))return this.t4a(Fa,pc,gb,Tb,pd,Kb?20:3,22);sd=new la.a(Tb,pd+38+6);if(pc.CHa(sd))return this.t4a(Fa,pc,gb,Tb,pd,-81+(Kb?18:0),66);Tb=new la.a(Uc+
(Kb?81:-81),pd);if(pc.CHa(Tb))return this.t4a(Fa,pc,gb,Uc,pd,-81+(Kb?12:-6),22);pd=new la.a(Uc,Xc-38-6);return pc.CHa(pd)?this.t4a(Fa,pc,gb,Uc,Xc,Kb?15:0,16):this.t4a(Fa,pc,gb,Kb?pc.topLeft.x:pc.bottomRight.x,pc.bottomRight.y,-81+(Kb?15:-6),22)};ra.prototype.t4a=function(Fa,Kb,gb,Tb,pc,Xc,pd){var Uc=ka.g(this.$),sd=Uc.rtl;Fa=Sys.UI.DomElement.getLocation(Fa.domElement);Tb=new Sys.UI.Point(Tb+(sd?0:Fa.x)-Kb.topLeft.x,pc+Fa.y-Kb.topLeft.y);sd&&(Uc=Uc.view.visibleArea,Tb.x=Uc.bottomRight.x-Uc.topLeft.x-
Tb.x,2===gb||4===gb)&&(Tb.x+=Kb.bottomRight.x);Tb=ca.a(this.$).Ija(Tb);return new Sys.UI.Point(Tb.x+Xc,Tb.y+pd)};of.Object.defineProperties(ra.prototype,{gJg:{configurable:!0,enumerable:!0,get:function(){return this.mlg}},Ssi:{configurable:!0,enumerable:!0,get:function(){return this.Xsg}},m8i:{configurable:!0,enumerable:!0,get:function(){return this.Kvg}},Kyh:{configurable:!0,enumerable:!0,get:function(){return this.fpg}}});ra.GYi=["PasteRecoveryUI"];Object(V.a)(ra,"PasteRecoveryUI",null,[840]);var Ia=
b(76),jb=b(189);fa.WAg="ActiveSelection";fa.shadowWorkbook="ShadowWorkbook";fa.xjg="GVML";fa.plainText="PlainText";fa.html="Html";fa.wPg="Bitmap";Object(V.a)(fa,"PayloadType",null,[]);ba.QDj="Slice4";ba.RDj="Slice5";ba.SDj="Slice6";Object(V.a)(ba,"SliceName",null,[]);bb.VEi="NotCalled";bb.success="Success";bb.failed="Failed";Object(V.a)(bb,"SucceededPopulatingSystemClipboardOptions",null,[]);var nb=b(380),Na;(function(Fa){Fa[Fa.valid=0]="valid";Fa[Fa.destinationRangesIsEmpty=1]="destinationRangesIsEmpty";
Fa[Fa.discontinuousSelectionNotSupportPasteFromExternal=2]="discontinuousSelectionNotSupportPasteFromExternal";Fa[Fa.discontinuousSelectionNotSupportPasteCrossSession=3]="discontinuousSelectionNotSupportPasteCrossSession";Fa[Fa.multipleSourcesAndMultipleDestinationsAreNotSupported=4]="multipleSourcesAndMultipleDestinationsAreNotSupported";Fa[Fa.multipleDestinationsAreNotMultiplyOfSourceRange=5]="multipleDestinationsAreNotMultiplyOfSourceRange";Fa[Fa.sourceAndDestinationAreOverlapping=6]="sourceAndDestinationAreOverlapping";
Fa[Fa.copySourceNotValid=7]="copySourceNotValid";Fa[Fa.cutNotSupportedInDiscontinuousSelection=8]="cutNotSupportedInDiscontinuousSelection";Fa[Fa.pasteLinkNotSupportMultipleDestination=9]="pasteLinkNotSupportMultipleDestination";Fa[Fa.temporarilyBlockedPaste=10]="temporarilyBlockedPaste";Fa[Fa.unknown=100]="unknown"})(Na||(Na={}));Object(V.b)("PasteValidationOptions",Na);var sa=b(50),Wa=b(36),Hb=b(151),Yb=b(37),Sb=b(160),lb=b(361),wb=b(31),wa=b(333),Oa=b(11),Ub=b(22),hb=b(95),Xb=b(126),Gc=b(112),
uc=b(636),Nc=b(100),Fb=b(58),ob=b(207),zb=Ka.a;$k(Z,zb);Z.prototype.xHg=function(Fa){this.addHandler(Z.RBd,Fa)};Z.prototype.Edj=function(Fa){this.removeHandler(Z.RBd,Fa)};Z.prototype.copy=function(Fa){var Kb=this;Fa.stopwatch=this.$.Fb.sc("UserAction",dc.b().Xh(Fa.ribbonCommandInfo.command)+"ClientSide");if(this.ho){var gb=sa.GetServiceTaskFactory.Ra(this.$.da,478,479,0);Yb.TaskExtensions.Aa(gb,function(){Kb.pasteShortcutManager=gb.result},this.la,3)}var Tb=!!pa(this.oK);vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",
!1)&&!Sa.a.IC&&(this.k7a=!1);this.Wq("Copy/before/"+Db.a[Fa.ribbonCommandInfo.method],!1,void 0,!0,Fa.copyPasteTargetType).catch(function(){});var pc=-1985798686===Fa.ribbonCommandInfo.command;if(1===this.gridView.Re&&(pc=this.Cp.scf(this.gridView.ha.sa.selectedRanges,pc),0!==pc)){var Xc=Z.X3g(pc);this.kza(Xc,$a[pc],!1);return Promise.reject(!1)}Fa.userHash=this.userHash;Fa.id=Ab.a.create().toString();var pd=this,Uc=this;return this.t4b.onCopy(Fa).then(function(sd){sd.isAsyncCopy||Fa.stopwatch.stop();
pd.pasteIndicationManager.zJe();Ra.ULS.sendTraceTag(24150883,0,50,"CopyPasteInfrastructure.OnCopy: Copy operation finished successfully. "+nb.d(Fa));pd.zvi(sd,Tb);sd=vb.EwaSettings.isChangeGateEnabled("OfficeVSO:6591921_CheckTargetTypeForEnterToPaste")?1===Fa.copyPasteTargetType:!0;!Fa.isFormatPainter&&pd.ho&&sd&&(pd.pasteShortcutManager?pd.pasteShortcutManager.Klh():Ra.ULS.shipAssertTag(537167823,0,!1,"Copy: pasteShortcutManager is null."));return Promise.resolve(!0)},function(sd){var Nb=!1,Ja="none",
Lb=Z.vsb,ec=!0,Zb=-1,Oc=Z.copyErrorName+Z.WIa,td=!1,Gd=null;if(sd){Gd=sd.copyContext;Zb=sd.reason;Oc+=Z.kKa(sd);sd.message&&(Lb=sd.message);var Pd=Z.W3g(sd);if(Pd)if(3===Pd.copyErrorName)Nb=!0,Lb=Ja="Async Copy canceled by the user.",ec=!1;else if(wb.a.Tq(Pd.ewaErrors))if(Lb=Uc.qbc(Pd.ewaErrors),wb.a.$g(Pd.ewaErrors,Z.operationSucceededWithAlert))td=Nb=!0;else if(wb.a.$g(Pd.ewaErrors,Z.pasteDataLimitHit)||wb.a.$g(Pd.ewaErrors,Z.copyThrottlingError))Nb=!0;13===sd.reason?(Nb=!0,ec=!1):11===sd.reason&&
(ec=!1)}Nb?Ra.ULS.sendTraceTag(36304157,0,15,"CopyPasteInfrastructure.OnCopy: Copy operation failed with an expected error. clearStateNeeded: "+ec+", Friendly message: "+Ja+", Error Message: "+(sd?Uc.getStringifiedError(sd):"null")+", CommandParameters: "+nb.d(Fa)):Ra.ULS.sendTraceTag(24150912,0,10,"CopyPasteInfrastructure.OnCopy: Copy operation failed with an unexpected error. clearStateNeeded: "+ec+", Error Message: "+(sd?Uc.getStringifiedError(sd):"null")+", CommandParameters: "+nb.d(Fa));ec&&
Uc.Wq("Copy/fail/"+Db.a[Fa.ribbonCommandInfo.method],!0,void 0,void 0,Fa.copyPasteTargetType).catch(function(){});Uc.yvi(Fa,Nb,Lb,Oc,Zb,td,Gd);return Promise.reject(sd)})};Z.prototype.paste=function(Fa){var Kb=this;Fa.stopwatch=this.$.Fb.sc("UserAction",dc.b().Xh(Fa.ribbonCommandInfo.command)+"ClientSide");vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Sa.a.IC&&(Ra.ULS.sendTraceTag(537167822,0,50,"CopyPasteInfrastructure.OnPaste: Cross-app shadow workbook paste is enabled"),
this.k7a=!1,Fa.clipboardPicklingApiDataFormatsToRead=[oa.shadowWorkbook]);ka.g(this.$).si&&ka.g(this.$).si.L7(this.Dfd(Fa.ribbonCommandInfo.command),Fa.stopwatch.id);if(Fa.isPasteCommandFromRecoveryUI){var gb=this.$.da.za(406);var Tb=this.Uad?Ba.d(gb.zjc):Wb.a.clone(gb.zjc);gb=gb.rsd;Fa.pasteRecoveryCachedClipboardItems=gb?gb[Z.CGf]:null}else Tb=this.Uad?Ba.d(this.gridView.ha.sa.selectedRanges):Wb.a.clone(this.gridView.ha.sa.selectedRanges);Fa.originalDestinations=Tb;Fa.expandDestinations=this.AZc(Fa.originalDestinations,
Fa.commandType);if(this.NZc(Fa.commandType,Fa.expandDestinations)||this.JVg())return Fa.userHash=this.userHash,Fa.id=Ab.a.create().toString(),vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PerfImpactExperimentForAsyncApi",!1)&&!Sa.a.IC&&(Fa.clipboardReadPermissionPromptShown=!1,Fa.clipboardAsyncApiDataFormatsToRead=[oa.plainText+"Async"],this.t4b.shouldShowClipboardReadPermissionDialog().then(function(pc){pc&&(Fa.clipboardReadPermissionPromptShown=!0,new Aa(Kb.$));return Promise.resolve(!0)},
function(){return Promise.resolve(!0)})),this.t4b.onPaste(Fa).then(function(pc){return Kb.koc(pc,Fa)},function(pc){return Kb.tFb(Fa,pc)});this.$.Cd(927125067,Ia.a.Cb,30,null);Ra.ULS.sendTraceTag(24150913,0,15,"CopyPasteInfrastructure.OnPaste: paste was triggered but the estimated destination range is not editable, do nothing. ExpandDestinations: "+Ba.i(Fa.expandDestinations,",",this.$,!1)+", CommandType: "+Fa.commandType+', copyPasteTargetType="'+Fa.copyPasteTargetType+'"');return Promise.resolve(!0)};
Z.prototype.Dfd=function(Fa){if(vb.EwaSettings.isChangeGateEnabled("OfficeVSO:4313497_PasteOptionPerfTelemetry"))switch(Fa){case 1804571062:return 6;case -185374993:return 7;case 1766348718:return 8}return 3};Z.prototype.JVg=function(){return!!ka.g(this.$).ha.Oa.activeFloatingObjectControlId&&this.$.iq(null,!1,470)};Z.prototype.JBb=function(){var Fa=pa(this.oK);return Fa&&Fa.commandParameters?Fa.commandParameters.copyPasteTargetType:0};Z.prototype.wki=function(){return!!pa(this.oK)&&va(pa(this.oK),
this.$)};Z.prototype.Wq=function(Fa,Kb,gb,Tb,pc){var Xc=this;gb=void 0===gb?!1:gb;Tb=void 0===Tb?!1:Tb;pc=void 0===pc?0:pc;try{this.ho&&this.pasteShortcutManager&&this.pasteShortcutManager.X6b();var pd=pc,Uc=this.Jri();if(!Tb&&2===Uc)return Ra.ULS.sendTraceTag(537167821,0,50,"CopyPasteInfrastructure.ClearState clipboard won't be cleared as there's art in the clipboard. clearClipboardContent = '"+Kb+"', isExplicit = '"+gb+"', isForce = '"+Tb+"', Current CCP operation copyPasteTargetType = '"+pc+"', LastCopyPasteTargetType = '"+
Uc+"'"),Promise.reject(null);0===pd&&(pd=Uc);var sd=this.$.Fb.sc("UserAction","ClearCopyState"),Nb=sd.id;Ra.ULS.sendTraceTag(537167820,0,50,"CopyPasteInfrastructure.ClearState clear clipboard state. clearClipboardContent = '"+Kb+"', isExplicit = '"+gb+"', isForce = '"+Tb+"', Current CCP operation copyPasteTargetType = '"+pc+"', LastCopyPasteTargetType = '"+Uc+"'");this.Cp.Jxb();this.u5i();return this.t4b.onCancelCopy(Kb).then(function(){Kb&&vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",
!1)&&!Sa.a.IC&&(Xc.k7a=!1);sd.stop();Xc.Xlf(Fa,Nb,!0,gb,Kb,"","",sd.qc,pd);return Promise.resolve(!0)},function(Ja){Ra.ULS.sendTraceTag(24150915,0,15,"CopyPasteInfrastructure.ClearState: error during call to copyPasteFlowManager.OnClear(). error: "+(Ja?Xc.getStringifiedError(Ja):"null"));sd.stop();var Lb=Z.YVg+Z.WIa,ec=Z.vsb;Ja&&(Lb+=Z.kKa(Ja),Ja.message&&(ec=Ja.message));Xc.Xlf(Fa,Nb,!1,gb,Kb,ec,Lb,sd.qc,pd);return Promise.reject(Ja)})}catch(Ja){return Promise.reject(null)}};Z.prototype.V2b=function(Fa,
Kb,gb,Tb,pc){gb=void 0===gb?!1:gb;Tb=void 0===Tb?!1:Tb;pc=void 0===pc?0:pc;return Tb||!vb.EwaSettings.ma(658)||this.Kih()?this.Wq(Fa,Kb,gb,Tb,pc):(Ra.ULS.sendTraceTag(537167819,0,50,"CopyPasteInfrastructure.ClearStateOnlyIfClipboardHasContentFromSameSession clipboard won't be cleared as there is no content in the clipboard from the current session"),Promise.reject(null))};Z.prototype.kza=function(Fa,Kb,gb){Ra.ULS.sendTraceTag(590705172,0,50,"CopyPasteInfrastructure.PopupDiscontinuousSelectionErrorDialog: Blocked CCP due to discontinuous selection, reason: "+
Kb);var Tb=new Nc.a;Tb.ia("reason",Kb);uc.a(Xb.a.discontinuousSelectionBlocking,[gb?Gc.a.AYi:Gc.a.P4g],!0,!0,!1,!1,Tb);Fa=wb.a.Xc(1,1,754,Fa,0,371863010,"DiscontinuousSelectionBlocking");vb.EwaSettings.oz()?new lb.a(this.$,Fa):(Fa=new Sb.ErrorDialog(this.$,Fa),Fa.initialize(),Fa.qf())};Z.prototype.Jri=function(){var Fa=pa(this.oK);return Fa&&Fa.sourceItem?Object.getType(Fa.sourceItem)===ma?2:1:0};Z.prototype.dragDropCells=function(Fa,Kb,gb,Tb,pc){var Xc=this;pc=void 0===pc?!1:pc;Fa.stopwatch=this.$.Fb.sc("UserAction",
"DragDropClientSide");this.Wq("DragDrop/before/"+Db.a[Fa.ribbonCommandInfo.method],!1,void 0,void 0,Fa.copyPasteTargetType).catch(function(){});var pd=pc?2:1,Uc=0;Uc=pc?4:Tb?256:128;var sd={encounteredDeploymentErrors:!1};sd.commandParameters=Fa;Fa.userHash=this.userHash;Fa.id=Ab.a.create().toString();return this.crd?this.Cp.pasteRange(Fa.ribbonCommandInfo,Ba.q(Kb,this.$),Ba.q(gb,this.$),pd,Uc,[Fa.stopwatch],sd,!1,function(){Ra.ULS.sendTraceTag(537167818,0,50,'CopyPasteInfrastructure.DragDropCells: success. copyPasteTargetType="'+
Fa.copyPasteTargetType+'"');Xc.p8a(Fa,pd,Kb,gb,sd)},function(Nb){Ra.ULS.sendTraceTag(537167817,0,10,"CopyPasteInfrastructure.DragDropCells: "+(Nb?Xc.getStringifiedError(Nb):"null")+', copyPasteTargetType="'+Fa.copyPasteTargetType+'"');Xc.L9a(Nb,Fa,pd,Kb,gb,sd)}).then(function(){Xc.gridView.ha.selectionType=-1;return Promise.resolve(!0)},function(Nb){return Promise.reject(Nb)}):this.Cp.pasteRange(Fa.ribbonCommandInfo,Ba.q(Kb,this.$),Ba.q(gb,this.$),pd,Uc,[Fa.stopwatch],sd,!1,null,null).then(function(){Ra.ULS.sendTraceTag(521410075,
0,50,'CopyPasteInfrastructure.DragDropCells: success. copyPasteTargetType="'+Fa.copyPasteTargetType+'"');Xc.gridView.ha.selectionType=-1;Xc.p8a(Fa,pd,Kb,gb,sd);return Promise.resolve(!0)},function(Nb){Ra.ULS.sendTraceTag(521410074,0,10,"CopyPasteInfrastructure.DragDropCells: "+(Nb?Xc.getStringifiedError(Nb):"null")+', copyPasteTargetType="'+Fa.copyPasteTargetType+'"');Xc.L9a(Nb,Fa,pd,Kb,gb,sd);return Promise.reject(Nb)})};Z.prototype.hjh=function(Fa,Kb,gb,Tb,pc){var Xc=this;pc=void 0===pc?!1:pc;Fa.stopwatch=
this.$.Fb.sc("UserAction","DragDropReplaceClientSide");this.V2b("DragDropReplace/before/"+Db.a[Fa.ribbonCommandInfo.method],!1,void 0,void 0,Fa.copyPasteTargetType).catch(function(){});var pd=pc?2:1,Uc=0;Uc=pc?4:Tb?256:128;var sd={encounteredDeploymentErrors:!1};sd.commandParameters=Fa;vb.EwaSettings.getBooleanFeatureGate(jb.a.G7b,!1)&&(Fa.isDragInsert=!1);Fa.userHash=this.userHash;Fa.id=Ab.a.create().toString();return this.crd?this.Cp.pasteRange(Fa.ribbonCommandInfo,Ba.q(Kb,this.$),Ba.q(gb,this.$),
pd,Uc,[Fa.stopwatch],sd,!1,function(){Ra.ULS.sendTraceTag(537167816,0,50,'CopyPasteInfrastructure.DragDropReplaceCells: success. copyPasteTargetType="'+Fa.copyPasteTargetType+'"');Xc.p8a(Fa,pd,Kb,gb,sd)},function(Nb){Ra.ULS.sendTraceTag(537167815,0,10,"CopyPasteInfrastructure.DragDropReplaceCells: "+(Nb?Xc.getStringifiedError(Nb):"null")+', copyPasteTargetType="'+Fa.copyPasteTargetType+'"');return Xc.L9a(Nb,Fa,pd,Kb,gb,sd)}).then(function(){Xc.gridView.ha.selectionType=-1;return Promise.resolve(!0)},
function(Nb){return Promise.reject(Nb)}):this.Cp.pasteRange(Fa.ribbonCommandInfo,Ba.q(Kb,this.$),Ba.q(gb,this.$),pd,Uc,[Fa.stopwatch],sd,!1,null,null).then(function(){Ra.ULS.sendTraceTag(521410073,0,50,'CopyPasteInfrastructure.DragDropReplaceCells: success. copyPasteTargetType="'+Fa.copyPasteTargetType+'"');Xc.gridView.ha.selectionType=-1;Xc.p8a(Fa,pd,Kb,gb,sd);return Promise.resolve(!0)},function(Nb){Ra.ULS.sendTraceTag(521410072,0,10,"CopyPasteInfrastructure.DragDropReplaceCells: "+(Nb?Xc.getStringifiedError(Nb):
"null")+', copyPasteTargetType="'+Fa.copyPasteTargetType+'"');Xc.L9a(Nb,Fa,pd,Kb,gb,sd);return Promise.reject(Nb)})};Z.prototype.gjh=function(Fa,Kb,gb,Tb,pc){var Xc=this;pc=void 0===pc?!1:pc;Fa.stopwatch=this.$.Fb.sc("UserAction","DragDropInsertClientSide");this.V2b("DragDropInsert/before/"+Db.a[Fa.ribbonCommandInfo.method],!1,void 0,void 0,Fa.copyPasteTargetType).catch(function(){});var pd=pc?2:1,Uc=Ba.K(this.AZc([gb],pd)),sd=this.$.ea.pa.sheetName,Nb=this.$.ea.pa.sheetName,Ja=Ba.v(Kb,this.$);Ja.SheetName=
sd;sd=Ba.v(Uc,this.$);sd.SheetName=Nb;Tb=Uc.isRow||Kb.isRow||Tb?1:0;var Lb={encounteredDeploymentErrors:!1};Fa.isDragInsert=!0;Lb.commandParameters=Fa;Fa.userHash=this.userHash;Fa.id=Ab.a.create().toString();if(this.crd)return pc=this.Cp.GJe(Lb,Ja,sd,pc,Tb,Fa.ribbonCommandInfo,function(){Ra.ULS.sendTraceTag(537167814,0,50,'CopyPasteInfrastructure.DragDropInsertCells: success. copyPasteTargetType="'+Fa.copyPasteTargetType+'"');Xc.p8a(Fa,pd,Kb,gb,Lb)},function(Zb){Ra.ULS.sendTraceTag(537167813,0,10,
"CopyPasteInfrastructure.DragDropInsertCells: "+(Zb?Xc.getStringifiedError(Zb):"null")+', copyPasteTargetType="'+Fa.copyPasteTargetType+'"');Xc.L9a(Zb,Fa,pd,Kb,gb,Lb)}),ob.c(pc.then(function(){Xc.gridView.ha.selectionType=-1;return Promise.resolve(!0)},function(Zb){return Promise.reject(Zb)})).Jo(function(){return!0});pc=this.Cp.GJe(Lb,Ja,sd,pc,Tb,Fa.ribbonCommandInfo,null,null);var ec=this;return ob.c(pc.then(function(){Ra.ULS.sendTraceTag(521410071,0,50,'CopyPasteInfrastructure.DragDropInsertCells: success. copyPasteTargetType="'+
Fa.copyPasteTargetType+'"');Xc.gridView.ha.selectionType=-1;Xc.p8a(Fa,pd,Kb,gb,Lb);return Promise.resolve(!0)},function(Zb){Ra.ULS.sendTraceTag(521410070,0,10,"CopyPasteInfrastructure.DragDropInsertCells: "+(Zb?ec.getStringifiedError(Zb):"null")+', copyPasteTargetType="'+Fa.copyPasteTargetType+'"');ec.L9a(Zb,Fa,pd,Kb,gb,Lb);return Promise.reject(Zb)})).Jo(function(){return!0})};Z.prototype.Yci=function(Fa,Kb){var gb=this,Tb=pa(this.oK);if(!Tb)return Ra.ULS.sendTraceTag(537167812,0,50,"InsertCopiedCutCells: CopyContext must not be null or undefined"),
Fb.Task.Ua(!1);if(!ta(Tb.sourceItem))return Ra.ULS.sendTraceTag(537167811,0,50,"InsertCopiedCutCells: CopyContext must be a Range"),Fb.Task.Ua(!1);var pc=Tb.sourceItem;if(!pc)return Ra.ULS.shipAssertTag(537167810,0,!!pc,"InsertCopiedCutCells: rangeSourceItem must not be null or undefined"),Fb.Task.Ua(!1);if(!pc.isFromCurrentSession(this.$))return Ra.ULS.sendTraceTag(537167809,0,50,"InsertCopiedCutCells: rangeSourceItem is from a different session"),Fb.Task.Ua(!1);if(1<pc.ranges.length)return Ra.ULS.sendTraceTag(537167808,
0,50,"InsertCopiedCutCells: multiple source ranges are not supported"),this.kza(2174,"InsertCopiedCutCells",!0),Fb.Task.Ua(!1);Tb=Ba.K(pc.ranges);var Xc=this.gridView.ha.sa.Vc.clone();Fa=Ba.K(this.AZc([Xc],Fa));var pd=this.Rjf();pc=pc.sheetName;Xc=this.$.ea.pa.sheetName;var Uc=Ba.v(Tb,this.$);Uc.SheetName=pc;var sd=Ba.v(Fa,this.$);sd.SheetName=Xc;return(Fa.We||Tb.We?Fb.Task.Ua(0):Fa.isRow||Tb.isRow?Fb.Task.Ua(1):this.Zci.L4b(this.$,ka.g(this.$).rtl)).Jo(function(Nb){return gb.Cp.executeInsertCopiedCutCellsOperation(Uc,
sd,pd,Nb.result,Kb)}).continueWith(function(){pd?gb.Cp.Jxb():gb.Wq("InsertCopiedCutCells/success/"+Db.a[Kb.method],!0)})};Z.prototype.Lod=function(){var Fa=pa(this.oK),Kb=this.gridView.ha.sa.rg;return!!Fa&&ta(Fa.sourceItem)&&Kb&&1===Fa.sourceItem.ranges.length};Z.prototype.Rjf=function(){return this.Sjf(-911352779)};Z.prototype.yjc=function(){return this.Sjf(-1985798686)};Z.prototype.NZc=function(Fa,Kb){var gb=new Hb.a(this.$.xa),Tb=36===Fa,pc=gb.Ud(4);Fa=2===this.JBb()&&gb.Ud(1);Tb=Tb&&pc;gb=!gb.fj||
!this.yjc()||!Hb.a.u7b(Kb,ka.g(this.$));return Tb||Fa||this.$.iq(Kb,!0)&&gb};Z.prototype.Ogc=function(Fa,Kb){return this.Cp.Ogc(Fa,Kb)};Z.prototype.dispose=function(){zb.prototype.dispose.call(this);this.Tj();this.oK.removeMetadataChangeListener(Z.xqf)};Z.prototype.T6c=function(Fa,Kb,gb,Tb,pc,Xc){if(!this.YZg(Fa.commandParameters.ribbonCommandInfo.command))return Fa.cseStatus=2,!1;if(Xc&&Kb.xd(Tb))return Fa.cseStatus=4,!1;if(gb!==pc)return Fa.cseStatus=6,!1;if(vb.EwaSettings.isChangeGateEnabled("OfficeVSO:5593878_PasteCSE_CCPErrorTests")&&
(Tb.width%Kb.width||Tb.height%Kb.height))return Fa.cseStatus=16,!1;if(vb.EwaSettings.getBooleanFeatureGate(jb.a.xFe,!1)){if(gb=Kb,Tb=Tb.ze(this.gridView.Vg),Kb=null===Kb.ze(this.gridView.Vg),pc=Fa.commandParameters.ribbonCommandInfo.command,Kb&&1804571062!==pc&&-185374993!==pc||!Tb)return Fa.cseStatus=7,!1}else if(gb=Kb.ze(this.gridView.Vg),Tb=Tb.ze(this.gridView.Vg),!gb||!Tb)return Fa.cseStatus=7,!1;Kb=Ba.v(gb,this.$);Kb=this.Hg.EYi(this.gridView,Kb,Ba.v(Tb,this.$),Fa.commandParameters.ribbonCommandInfo.command,
Fa.commandParameters.stopwatch);1===Kb&&(Xc&&(this.Hg.C0c(gb,!1),this.Hg.C0c(gb,!0)),-185374993===Fa.commandParameters.ribbonCommandInfo.command&&ka.g(this.$).f5i(),this.pasteIndicationManager.Ajd(Fa.commandParameters.id),this.nvc(Fa.commandParameters.expandDestinations,Fa.commandParameters.isPasteCommandFromRecoveryUI),this.$ye("DoPasteClientEstimation/"+Db.a[Fa.commandParameters.ribbonCommandInfo.method],Fa));Fa.cseStatus=Kb;return 1===Kb};Z.prototype.NHf=function(){this.copyPasteShortcutDialogFactory.create(this.$).showDialog(!0,
!1,!1,this.wxi)};Z.prototype.Gmf=function(Fa,Kb,gb,Tb){Fa=Ha(Fa,Kb,gb,Tb,this.$.ya.UserSessionId);Fa.k=!0;dc.b().Ce(45,Fa,!0)};Z.prototype.ABf=function(Fa,Kb,gb,Tb,pc){var Xc=!1,pd=!1,Uc=Z.vsb,sd=Z.CJe+Z.WIa;Fa&&(sd+=Z.kKa(Fa),wb.a.Tq(Fa.ewaErrors)?(Uc=this.qbc(Fa.ewaErrors),wb.a.$g(Fa.ewaErrors,[-103190598])&&(Xc=!0)):Fa.message&&(Uc=Fa.message));pd||(pd=this.Znd(Fa));Kb=Ha(Kb,gb,Tb,pc,this.$.ya.UserSessionId);Kb.k=!1;Kb.l=pd;Kb.n=Uc;Kb.p=sd;Kb.q=Xc;dc.b().Ce(45,Kb,!0);return Promise.reject(Fa)};
Z.prototype.YZg=function(Fa){switch(Fa){case 237279923:case 808159687:return jb.a.Ili;case -185374993:return!0;case 1804571062:return!0;default:return!1}};Z.prototype.Sjf=function(Fa){var Kb=pa(this.oK);if(!Kb)return!1;var gb=Kb.sourceItem;return gb&&!gb.isFromCurrentSession(this.$)?(Ra.ULS.sendTraceTag(537167779,0,50,"CopyPasteInfrastructure.LastOperationWasCopyCut: Last copy operation was from a different session."),!1):Kb.commandParameters.ribbonCommandInfo.command===Fa};Z.prototype.Kih=function(){var Fa=
pa(this.oK);return Fa?(Fa=Fa.sourceItem)&&!Fa.isFromCurrentSession(this.$)?(Ra.ULS.sendTraceTag(537167778,0,50,"CopyPasteInfrastructure.DoesClipboardHaveCopiedOrCutContent: Last copy/cut operation was from a different session."),!1):!0:!1};Z.prototype.yxj=function(Fa){return Fa&&Fa.lastCopy?va(Fa.lastCopy,this.$):!0};Z.prototype.JYe=function(Fa,Kb,gb,Tb,pc){var Xc={};Xc.a=this.$.ya.UserSessionId;Xc.e=Fa.stopwatch.id;Xc.c=dc.b().Xh(Fa.ribbonCommandInfo.command);Xc.b=Db.a[Fa.ribbonCommandInfo.method];
Xc.d=Fa.id;Xc.f=gb.toString();Xc.g=Tb.toString();Xc.h=Kb.toString();Xc.o=Fa.stopwatch.qc;Xc.q=!1;Xc.r=Fa.copyPasteTargetType.toString();Xc.s=pc.encounteredDeploymentErrors;vb.EwaSettings.getBooleanFeatureGate(jb.a.G7b,!1)&&(Xc.i=pc.commandParameters.dragDropIsShiftKeyDown,Xc.j=pc.commandParameters.isDragInsert);return Xc};Z.prototype.p8a=function(Fa,Kb,gb,Tb,pc){Fa=this.JYe(Fa,Kb,gb,Tb,pc);Fa.k=!0;dc.b().Ce(45,Fa,!0)};Z.prototype.Hvi=function(Fa,Kb,gb,Tb,pc,Xc,pd,Uc,sd){Fa=this.JYe(Fa,Kb,gb,Tb,sd);
Fa.k=!1;Fa.l=pc;Fa.n=Xc;Fa.p=pd;Fa.q=Uc;dc.b().Ce(45,Fa,!0)};Z.prototype.Xlf=function(Fa,Kb,gb,Tb,pc,Xc,pd,Uc,sd){var Nb={};Nb.a=this.$.ya.UserSessionId;Nb.b=Kb;Nb.c=Fa;Nb.f=gb;Nb.e=Tb;Nb.d=pc;Nb.g=Xc;Nb.h=pd;Nb.i=Uc;Nb.j=sd.toString();dc.b().Ce(46,Nb,!0)};Z.prototype.zvi=function(Fa,Kb){Fa=this.hYe(Fa.commandParameters,Fa);Fa.l=!0;Fa.j=Kb;dc.b().Ce(43,Fa,!0)};Z.prototype.yvi=function(Fa,Kb,gb,Tb,pc,Xc,pd){Fa=this.hYe(Fa,pd);Fa.l=!1;Fa.m=Kb;Fa.o=gb;Fa.y=Tb;Fa.x=pc;Fa.z=Xc;dc.b().Ce(43,Fa,!0);Ra.ULS.sendTraceTag(537167776,
0,15,"CopyPasteInfrastructure.LogCopyFailedTelemetry: ErrorName="+Fa.y+",ErrorReason="+Fa.x+",IsExpectedError="+Fa.m+",IsSucceededWithAlert="+Fa.z+",ErrorMessage="+Fa.o)};Z.prototype.hYe=function(Fa,Kb){var gb={};gb.a=this.$.ya.UserSessionId;gb.f=Fa.stopwatch.id;gb.g=Fa.id;gb.c=dc.b().Xh(Fa.ribbonCommandInfo.command);gb.b=Db.a[Fa.ribbonCommandInfo.method];gb.q=Fa.stopwatch.qc;gb.bd=Z.yac();gb.bg=Fa.copyPasteHandlerName;gb.bj=void 0===Fa.ribbonCommandInfo.Ne||null===Fa.ribbonCommandInfo.Ne?null:ub.a[Fa.ribbonCommandInfo.Ne];
gb.bq=Fa.uploadToClipService;gb.br=Fa.floatingObjectType;gb.s=Fa.copyPasteTargetType.toString();gb.bc=ya(Fa.copyPasteTargetType);gb.z=!1;if(Kb){gb.bk=Kb.id;gb.bl=Kb.serverRequestTimeInMs;Kb.requestTelemetryData&&(gb.bm=Kb.requestTelemetryData.EcsOperationDuration,gb.bn=Kb.requestTelemetryData.EcsRequestDuration,gb.bo=Kb.requestTelemetryData.WfeRequestDuration);gb.d=Kb.sourceItem?Kb.sourceItem.toString():null;gb.e=-1;if(ta(Kb.sourceItem)){gb.e=0;Fa=ik(Kb.sourceItem.ranges);for(var Tb=Fa.next();!Tb.done;Tb=
Fa.next())gb.e+=Tb.value.FG}gb.h=Kb.isAsyncCopy;gb.i=Kb.isFromCache;gb.k=Kb.isSelectionAllowed;gb.r=Kb.plainTextPayloadSize;gb.u=Kb.htmlPayloadSize;gb.v=Kb.htmlSizeExceedsLimit;gb.w=Kb.copyTotalSizeExceedsLimit;gb.t=Kb.shadowWorkbookPayloadSize;gb.p=Kb.clientSideCopyTime;gb.ba=Kb.encounteredDeploymentErrors;gb.bb=Kb.shadowWorkbookSizeExceedsLimit;gb.be=Kb.syncClipboardItemsKeys;gb.bf=Kb.asyncClipboardItemsKeys;gb.bh=this.pCe(Kb.succeededPopulatingSystemClipboardSync);gb.bi=this.pCe(Kb.succeededPopulatingSystemClipboardAsync)}return gb};
Z.prototype.nvc=function(Fa,Kb){Kb=void 0===Kb?!1:Kb;if(!this.gridView.isEditing&&!this.gridView.vi){var gb=this.gridView.ha.sa,Tb=!Kb&&1===Fa.length&&Ba.Q(Fa,gb.selectedRanges),pc=Tb?gb.activeCell:Fa[0].topLeft;Fa[0].contains(pc)||(Ra.ULS.shipAssertTag(537167775,0,!1,"CopyPasteInfrastructure.SelectPastedRange: SelectedRanges "+gb.selectedRanges+", IndexOfActiveRange "+gb.Qr+", ActiveCell "+gb.activeCell+", calculatedDestinationRanges "+Fa+", keepThePreviousActiveCell "+Tb+", newActiveCell "+pc+", isPasteCommandFromRecoveryUI "+
Kb),pc=Fa[0].topLeft);this.gridView.ha.Jw(Fa,0,pc,0,void 0,hb.a.U4g)}};Z.prototype.W0e=function(Fa,Kb){var gb={};gb.a=this.$.ya.UserSessionId;gb.g=Fa.stopwatch.id;gb.t=Fa.stopwatch.qc;gb.bz=!1;Kb&&(gb.bv=Kb.id,gb.bw=Kb.serverRequestTimeInMs,gb.n=Kb.commandParameters.clipboardFormatReadTimes,gb.o=Kb.commandParameters.clipboardFormatReadStatus,gb.p=Kb.commandParameters.clipboardReadPermissionPromptShown,gb.q=Kb.commandParameters.asyncApiReadTimedOut,Kb.requestTelemetryData&&(gb.cb=Kb.requestTelemetryData.EcsOperationDuration,
gb.cc=Kb.requestTelemetryData.EcsRequestDuration,gb.cd=Kb.requestTelemetryData.WfeRequestDuration));gb.x=Fa.copyPasteTargetType.toString();gb.bl=ya(Fa.copyPasteTargetType);gb.br=Fa.copyPasteHandlerName;gb.i=Ba.i(Fa.expandDestinations,",",this.$,!1);gb.h=Ba.i(Fa.originalDestinations,",",this.$,!1);gb.e=Fa.id;gb.d=Fa.commandType;gb.c=dc.b().Xh(Fa.ribbonCommandInfo.command);gb.b=Db.a[Fa.ribbonCommandInfo.method];gb.bf=!1;gb.bg=!1;gb.bp=Z.yac();gb.bt=void 0===Fa.ribbonCommandInfo.Ne||null===Fa.ribbonCommandInfo.Ne?
null:ub.a[Fa.ribbonCommandInfo.Ne];gb.cj=Fa.isPasteCommandFromEnterShortcut;if(gb.ca=Fa.isPasteCommandFromRecoveryUI)gb.cf=Fa.pasteRecoveryUndoStopwatch.id,gb.cg=Fa.pasteRecoveryUndoStopwatch.qc;if(Kb){if((Fa=Kb.copyContextSnapshot)&&!Kb.wasLastCopyExternal){gb.f=Fa.commandParameters.id;gb.j=Fa.sourceItem.toString();gb.k=-1;if(ta(Fa.sourceItem)){gb.k=0;for(var Tb=ik(Fa.sourceItem.ranges),pc=Tb.next();!pc.done;pc=Tb.next())gb.k+=pc.value.FG}gb.bg=1===Fa.commandParameters.commandType}else Kb.clipboardItems?
gb.f=Kb.clipboardItems.getItem(oa.qrb):Ra.ULS.sendTraceTag(537167774,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext.ClipboardItems is null");gb.bz=Kb.pasteRecoveryUIDisplayed;gb.ci=Kb.cseStatus}else Ra.ULS.sendTraceTag(537167773,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext is null");return gb};Z.prototype.Nwi=function(Fa,Kb,gb,Tb,pc,Xc,pd,Uc,sd){Fa=this.W0e(Fa,Uc);Fa.l=!1;Fa.m=Kb;Fa.s=gb;Fa.bc=Tb;Fa.be=pc;Fa.bd=Xc;Fa.bf=pd;Uc?(Fa.y=Ma(Uc)||!Uc.copyContextSnapshot,Fa.bi=
!Fa.y&&va(Uc.copyContextSnapshot,this.$),Fa.bj=Uc.shadowWorkbookSizeExceedsLimit,Fa.v=Uc.shadowWorkbookPayloadSize,Fa.w=Uc.htmlPayloadSize,Fa.bq=ha(Uc.clipboardItems),Fa.bb=Uc.activeSelectionType,Fa.bs=Uc.isSameSession,Fa.bn=Uc.payloadOrigin,Fa.bo=Uc.payloadType,Fa.bu=Uc.externalAppSource,Fa.bx=Uc.indicationDisplayScheduled,Fa.by=Uc.pasteIndicationDisplayStatus,Fa.ck=Uc.pasteDestinationHasMergedCells):Fa.bi=va(sd,this.$);dc.b().Ce(44,Fa,!0);Ra.ULS.sendTraceTag(537167772,0,15,"CopyPasteInfrastructure.LogPasteFailedTelemetry: ErrorName="+
Fa.be+",ErrorReason="+Fa.bd+",IsExpectedError="+Fa.m+",IsSucceededWithAlert="+Fa.bf+",ErrorMessage="+Fa.s)};Z.prototype.Owi=function(Fa){var Kb=this.W0e(Fa.commandParameters,Fa);Kb.y=Fa.wasLastCopyExternal;Kb.l=!0;Kb.u=Fa.plainTextPayloadSize;Kb.v=Fa.shadowWorkbookPayloadSize;Kb.w=Fa.htmlPayloadSize;Kb.z=Fa.isClipboardDataContainShadowWorkbook;Kb.ba=Fa.isShadowWorkbookParsedSuccessfully;Kb.bb=Fa.activeSelectionType;Kb.bc=Fa.pasteResult;Kb.bh=Fa.encounteredDeploymentErrors;Kb.bj=Fa.shadowWorkbookSizeExceedsLimit;
Kb.bk=Za(Fa);Kb.bq=ha(Fa.clipboardItems);Kb.bs=Fa.isSameSession;Kb.bn=Fa.payloadOrigin;Kb.bo=Fa.payloadType;Kb.bu=Fa.externalAppSource;Kb.bx=Fa.indicationDisplayScheduled;Kb.by=Fa.pasteIndicationDisplayStatus;Kb.ck=Fa.pasteDestinationHasMergedCells;Kb.bm=Fa.clipboardItems?Fa.clipboardItems.getItem(oa.KYg):null;Kb.bi=!Fa.isSameSession&&!Fa.wasLastCopyExternal;dc.b().Ce(44,Kb,!0)};Z.prototype.Pi=function(){this.$.xa.Mf(this.wh);this.$.xa.Fne(this.Lnc);this.$.userOperationManager.Br(this.oR);this.$.Uk(this.Yc);
ka.g(this.$).Wb.Ak(this.HFb)};Z.prototype.Tj=function(){this.$&&this.$.xa&&(this.$.xa.ug(this.wh),this.$.xa.OQf(this.Lnc));this.$&&this.$.userOperationManager&&this.$.userOperationManager.to(this.oR);this.gridView&&this.gridView.Wb&&this.gridView.Wb.vk(this.HFb)};Z.prototype.tFb=function(Fa,Kb){var gb=null,Tb=!1,pc=null,Xc="UnknownFailure",pd=-1,Uc=Z.vsb,sd=Z.pasteErrorName+Z.WIa,Nb=!1;this.pasteIndicationManager.Ajd(Fa.id);this.Zef&&this.pasteDestinationHasMergedCells(Fa.expandDestinations)&&(Kb.pasteContext.pasteDestinationHasMergedCells=
!0);var Ja=pa(this.oK);(Fa.clearStateOnFinish||Fa.clearSystemClipboard)&&this.Wq("Paste/fail/"+Db.a[Fa.ribbonCommandInfo.method],!0,void 0,void 0,Fa.copyPasteTargetType).catch(function(){});if(Kb){pd=Kb.reason;sd+=Z.kKa(Kb);Kb.message&&(Uc=Kb.message);if(gb=Z.i4g(Kb))if(1===gb.pasteErrorName)Tb=!0,Xc="CopyPasteLengthTooLongPopup",Uc=pc="The pasted content is too long. Popup a dialog to the user.",Ra.ULS.sendTraceTag(25216992,0,15,"CopyPasteInfrastructure.OnPasteFailed: "+pc+', copyPasteTargetType="'+
Fa.copyPasteTargetType+'"'),gb=wb.a.Xc(1,0,26,693,0,1306609195,"CopyPasteOversizeError"),vb.EwaSettings.oz()?new lb.a(this.$,gb):(gb=new Sb.ErrorDialog(this.$,gb),gb.initialize(),gb.qf());else if(7===gb.pasteErrorName)Tb=!0,Xc="No-Op",Uc=pc="The shadow workbook is not ready yet and an async copy failed to populate the clipboard. Do nothing (by the spec)",Ra.ULS.sendTraceTag(33948251,0,15,"CopyPasteInfrastructure.OnPasteFailed: "+pc+', copyPasteTargetType="'+Fa.copyPasteTargetType+'"');else if(8===
gb.pasteErrorName)Tb=!0,Xc="UseShortcutsPopup",Uc=pc="Unable to paste content from the system clipboard. Popup dialog to the user.",Ra.ULS.sendTraceTag(25216994,0,15,"CopyPasteInfrastructure.OnPasteFailed: "+pc+', copyPasteTargetType="'+Fa.copyPasteTargetType+'"'),this.NHf();else if(18===gb.pasteErrorName){Tb=!0;Xc="PasteExternalNotSupportMultipleSelectionPopup";Uc="Paste external not support multiple selection.";pc="Unknown";var Lb=2174;100!==gb.validationFailureReason&&(pc=Na[gb.validationFailureReason],
Lb=Z.iCe(gb.validationFailureReason));this.kza(Lb,pc,!0)}else 20===gb.pasteErrorName||19===gb.pasteErrorName?(Tb=!0,20===gb.pasteErrorName?(Xc="PasteAcrossSessionNotSupportMultipleSelectionPopup",Uc="Paste across session does not support multiple selection."):(Xc="PasteInSameSessionNotSupportMultipleSelectionPopup",Uc="This kind of multiple selection is not supported for same session paste."),pc="Unknown",Lb=2174,100!==gb.validationFailureReason&&(pc=Na[gb.validationFailureReason],Lb=Z.iCe(gb.validationFailureReason)),
gb=6===gb.validationFailureReason,this.NZc(Fa.commandType,Fa.expandDestinations)&&gb&&this.nvc(Fa.expandDestinations),this.kza(Lb,pc,!0)):6===gb.pasteErrorName?(Tb=!0,Xc="No-Op",Uc=pc="Paste Formatting/Transpose is not yet a supported operation on System Clipboard based content",Ra.ULS.sendTraceTag(36263241,0,15,"CopyPasteInfrastructure.OnPasteFailed: "+pc+', copyPasteTargetType="'+Fa.copyPasteTargetType+'"')):17===gb.pasteErrorName?(Tb=!0,Xc="No-Op",Uc=pc="Paste text on Art is not yet a supported operation",
Ra.ULS.sendTraceTag(0,0,15,"CopyPasteInfrastructure.OnPasteFailed: "+pc+', copyPasteTargetType="'+Fa.copyPasteTargetType+'"')):16===gb.pasteErrorName?(Tb=!0,Xc="No-Op",Uc=pc="Paste has failed because the previous copy has failed",Ra.ULS.sendTraceTag(537167771,0,15,"CopyPasteInfrastructure.OnPasteFailed: "+pc+', copyPasteTargetType="'+Fa.copyPasteTargetType+'", error='+this.getStringifiedError(gb))):wb.a.Tq(gb.ewaErrors)?(wb.a.g$(gb.ewaErrors)||wb.a.$g(gb.ewaErrors,wb.a.Xcc())?(Tb=!0,Xc="CommunicationError",
pc=wb.a.Cc(gb.ewaErrors),Ra.ULS.sendTraceTag(36304159,0,15,"CopyPasteInfrastructure.OnPasteFailed: "+Uc+' copyPasteTargetType="'+Fa.copyPasteTargetType+'"')):wb.a.$g(gb.ewaErrors,Z.Alj)?(Tb=!0,Xc="SavingWorkbookError",pc=wb.a.Cc(gb.ewaErrors),Ra.ULS.sendTraceTag(36304160,0,15,"CopyPasteInfrastructure.OnPasteFailed: "+Uc+' copyPasteTargetType="'+Fa.copyPasteTargetType+'"')):wb.a.$g(gb.ewaErrors,Z.operationSucceededWithAlert)&&(Nb=Tb=!0,Xc="OperationSucceededWithAlert",pc=wb.a.Cc(gb.ewaErrors),Ra.ULS.sendTraceTag(36304161,
0,15,"CopyPasteInfrastructure.OnPasteFailed: "+Uc+' copyPasteTargetType="'+Fa.copyPasteTargetType+'"')),Tb||(Uc=this.qbc(gb.ewaErrors),Tb=this.Znd(Kb))):11===gb.pasteErrorName&&(Tb=!0,Xc="No-Op",Uc="Paste has failed because user try copy cross-session oart object");15===Kb.reason&&(Tb=!0,Xc="No-Op",Uc="Rejecting deferred paste there is metadata update without copy context. Usually it means that copy canceled before finished.");Ub.a.equals(sd,ja.rWj,!1)&&(Tb=!0,Xc="No-Op",Uc="User hash of the copy is different then the user hash of the paste during cross-session copy-paste. Do nothing.")}Tb||
Ra.ULS.sendTraceTag(24150916,0,10,"CopyPasteInfrastructure.OnPasteFailed: "+(Kb?this.getStringifiedError(Kb):"null")+', copyPasteTargetType="'+Fa.copyPasteTargetType+'"');this.Nwi(Fa,Tb,Uc,Xc,sd,pd,Nb,Kb.pasteContext,Ja);return Promise.reject(Kb)};Z.prototype.koc=function(Fa,Kb){var gb;Ra.ULS.sendTraceTag(24150917,0,50,'CopyPasteInfrastructure.OnPasteSuccess: paste succeed. copyPasteTargetType="'+Kb.copyPasteTargetType+'"');this.pasteIndicationManager.Ajd(Kb.id);if(this.JYi(Kb.copyPasteTargetType,
Fa)){vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Sa.a.IC&&Fa.wasLastCopyExternal&&Fa.payloadType===fa.shadowWorkbook&&(this.k7a=!0);var Tb=null;(null===(gb=Fa.pastedRange)||void 0===gb?0:gb.Ranges)&&0<Fa.pastedRange.Ranges.length?Tb=Ba.g(Fa.pastedRange.Ranges):Fa.wasLastCopyExternal||(Tb=Kb.expandDestinations);this.lnj(Fa,Tb);if(this.szj(Fa,Tb)){this.Uad?(gb=Ba.d(Kb.originalDestinations),Tb=1028===Kb.commandType?Ba.d(Kb.expandDestinations):Ba.d(Tb)):
(gb=Wb.a.clone(Kb.originalDestinations),Tb=1028===Kb.commandType?Wb.a.clone(Kb.expandDestinations):Wb.a.clone(Tb));var pc=null;Fa.wasLastCopyExternal&&(Kb.isKeyboardEvent||Kb.isPasteCommandFromRecoveryUI)&&(pc={},pc=(pc[Z.CGf]=Fa.clipboardItems,pc));this.Zef&&this.pasteDestinationHasMergedCells(Kb.expandDestinations)&&(Fa.pasteDestinationHasMergedCells=!0);Fa.pasteRecoveryUIDisplayed=!0;var Xc=new ra(this.$,gb,Tb,pc),pd=sa.GetServiceTaskFactory.Ra(this.$.da,406,405,0);Yb.TaskExtensions.Aa(pd,function(){var Uc=
pd.result;Uc.vPg(Xc);Uc.ECj(Kb.ribbonCommandInfo.method)},this.la,8)}}this.$ye("Paste/success/"+Db.a[Kb.ribbonCommandInfo.method],Fa);this.Owi(Fa);this.b3f&&(!Kb.isKeyboardEvent||Za(Fa))&&this.$.ea.Tg.get(66)&&(Ra.ULS.sendTraceTag(537167770,0,15,"CopyPasteInfrastructure.OnPasteSuccess: show localStorage disable notification"),this.b3f=!1,this.N5g());return Promise.resolve(!0)};Z.prototype.szj=function(Fa,Kb){return!Kb||1!==Kb.length||Fa.commandParameters.clearSystemClipboard||Fa.commandParameters.clearStateOnFinish||
Fa.commandParameters.skipClipboardAccess?!1:Ma(Fa)&&(Kb=Fa.clipboardItems.getItem(oa.plainText),Fa=Fa.clipboardItems.getItem(oa.html),void 0===Kb||null===Kb||Kb.length>this.nAi||void 0===Fa||null===Fa||Fa.length>this.cya)?(Ra.ULS.sendTraceTag(537167769,0,50,"CopyPasteInfrastructure.ShouldShowPasteRecoveryUI: Not showing PasteRecoveryUI for external copy."),!1):!0};Z.prototype.JYi=function(Fa,Kb){return 1===Fa||Kb.payloadType===fa.plainText||vb.EwaSettings.ma(162)&&Kb.payloadType===fa.html||vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",
!1)&&!Sa.a.IC&&Kb.payloadType===fa.shadowWorkbook};Z.prototype.pasteDestinationHasMergedCells=function(Fa){var Kb=ka.g(this.$).Ea.KE();if(!Kb||!Kb.length)return!1;Kb=ik(Kb);for(var gb=Kb.next();!gb.done;gb=Kb.next())if(gb.value.gw(Fa[0]))return!0;return!1};Z.prototype.$ye=function(Fa,Kb){var gb=this,Tb;(function(){var pc=gb.Ugi(Kb);Tb=pc.fHa;return pc})().returnValue&&this.Wq(Fa,Tb,void 0,void 0,Kb.commandParameters.copyPasteTargetType).catch(function(){})};Z.prototype.L9a=function(Fa,Kb,gb,Tb,pc,
Xc){Ra.ULS.sendTraceTag(24150918,0,10,"CopyPasteInfrastructure.OnDragAndDropCellsFailed: "+(Fa?this.getStringifiedError(Fa):"null"));var pd=!1,Uc=!1,sd=!1,Nb=Z.vsb,Ja=Z.CJe+Z.WIa;Fa&&(Ja+=Z.kKa(Fa),wb.a.Tq(Fa.ewaErrors)?(Nb=this.qbc(Fa.ewaErrors),wb.a.$g(Fa.ewaErrors,Z.operationSucceededWithAlert)&&(pd=!0),wb.a.$g(Fa.ewaErrors,Z.dragDropNonEmptyRange)&&(Uc=sd=!0)):Fa.message&&(Nb=Fa.message));sd||(sd=this.Znd(Fa));Uc?this.gridView.ha.selectionType=-1:this.Cp.p8i(pc);this.Hvi(Kb,gb,Tb,pc,sd,Nb,Ja,
pd,Xc)};Z.prototype.AZc=function(Fa,Kb){var gb=Fa,Tb=this.lSh();if(null===Tb||void 0===Tb?0:Tb.ranges)gb=this.Cp.WUg(Kb,Tb.ranges,Fa);return gb};Z.prototype.lSh=function(){var Fa=pa(this.oK);return Fa&&ta(Fa.sourceItem)?Fa.sourceItem:null};Z.prototype.u5i=function(){this.raiseEvent(Z.RBd,null)};Z.prototype.lnj=function(Fa,Kb){var gb=Fa.commandParameters.originalDestinations;Kb&&(Ba.Q(this.gridView.ha.sa.selectedRanges,gb)?(this.nvc(Kb),Ra.ULS.sendTraceTag(537167767,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range, range: "+
Oa.HelperMethods.Dob(Kb))):Fa.commandParameters.isPasteCommandFromRecoveryUI?(this.nvc(Kb,!0),Ra.ULS.sendTraceTag(537167766,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range for IsPasteCommandFromRecoveryUI, range: "+Kb+", active cell: "+Kb[0].topLeft)):Ra.ULS.sendTraceTag(537167765,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: user change his selection during paste operation. don't change selection. originalPasteDestinations: "+Oa.HelperMethods.Dob(gb)))};Z.prototype.Ugi=
function(Fa){if(Fa.isPlainTextPaste||Fa.isHtmlPaste||Ua(Fa)||Fa.commandParameters.isPasteCommandFromEnterShortcut)return{returnValue:!0,fHa:!1};var Kb=Fa.copyContextSnapshot;if(Fa.commandParameters.clearStateOnFinish)return{returnValue:!0,fHa:!0};if(Kb&&ta(Kb.sourceItem)){var gb=Kb.sourceItem;if(!gb.isFromCurrentSession(this.$))return{returnValue:!1,fHa:!0};Kb=-1985798686===Kb.commandParameters.ribbonCommandInfo.command;if(!(1<gb.ranges.length||1<Fa.commandParameters.expandDestinations.length)){var Tb=
Ba.K(gb.ranges);Fa=Ba.K(Fa.commandParameters.expandDestinations);var pc=this.$.ea.pa.sheetName;gb=gb.sheetName;if(gb===pc&&Fa.equals(Tb))return{returnValue:!1,fHa:!0};if(gb===pc&&Fa.ze(Tb))return{returnValue:!0,fHa:!1}}return{returnValue:Kb,fHa:!0}}return{returnValue:!1,fHa:!0}};Z.prototype.HDf=function(){var Fa=pa(this.oK);(Fa=this.Cp.uwb(Fa))&&Fa.isFromCurrentSession(this.$)&&this.Wq("OnStartEdit",!1).catch(function(){})};Z.prototype.qbc=function(Fa){Fa=wb.a.UOh(Fa,Z.WIa);return this.wBi+cb.a.Nv(Fa).toString()};
Z.prototype.Znd=function(Fa){Fa=Z.kKa(Fa);return!!Fa&&Ub.a.e2a(Fa,Z.vBi)};Z.prototype.N5g=function(){var Fa=wb.a.Xc(1,2,332,333,Sa.a.fo?334:Sa.a.xH?335:336,530046625,"ActivateLocalStorage"),Kb=sa.GetServiceTaskFactory.Ra(this.$.da,5,4,0);Yb.TaskExtensions.Aa(Kb,function(){Kb.result.Lf(42,Fa)},this.la,3)};Z.prototype.pCe=function(Fa){return void 0===Fa||null===Fa?bb.VEi:Fa?bb.success:bb.failed};Z.i4g=function(Fa){var Kb=Fa.innerError;return Kb&&0!==Kb.pasteErrorName?Fa.innerError:null};Z.W3g=function(Fa){var Kb=
Fa.innerError;return Kb&&0!==Kb.copyErrorName?Fa.innerError:null};Z.kKa=function(Fa){var Kb="";if(!Fa)return Z.HGe;Fa.errorName&&(Kb=Fa.errorName,Fa.innerError&&(Kb+=Z.WIa+Z.kKa(Fa.innerError)));Kb||(Kb=Fa&&Fa.name?Fa.name:Z.HGe);return Kb};Z.yac=function(){Z.fS||(Wa.a.qff()?Z.fS=ba.SDj:Wa.a.hpd()?Z.fS=ba.RDj:Z.fS=ba.QDj);return Z.fS};Z.iCe=function(Fa){switch(Fa){case 7:case 1:return 2181;case 5:return 2178;case 6:return 2177;case 8:case 3:case 2:case 4:case 9:case 10:return 2174;default:return Ra.ULS.shipAssertTag(537167764,
0,!1,"CopyPasteInfrastructure.ConvertPasteValidationOptionToJsStringId: no case for validationOptions = "+Fa),2181}};Z.X3g=function(Fa){switch(Fa){case 3:return 2175;case 1:return 2176;case 2:case 4:return 2174;default:return Ra.ULS.shipAssertTag(537167763,0,!1,"CopyPasteInfrastructure.ConvertCopySourceValidationOptionToJsStringId: no case for validationOptions = "+Fa),2181}};of.Object.defineProperties(Z.prototype,{pasteIndicationManager:{configurable:!0,enumerable:!0,get:function(){return this.$.da.za(373)}}});
Z.xqf="EwaJsMetadataChangeListenerId";Z.RBd="cpiOSC";Z.feh="cpiDID";Z.vsb="Unknown";Z.HGe="UnknownError";Z.WIa="_";Z.CJe="DragAndDropError";Z.pasteErrorName="PasteError";Z.YVg="CancelError";Z.copyErrorName="CopyError";Z.vBi="MergedCellOverlap";Z.CGf="PasteRecoveryCachedClipboardItems";Z.Alj=[1352631530,1679665408];Z.operationSucceededWithAlert=[-103190598];Z.pasteDataLimitHit=[1306609195];Z.copyThrottlingError=[-386183710];Z.dragDropNonEmptyRange=[563945982];Z.fS=null;Object(V.a)(Z,"CopyPasteInfrastructure",
Ka.a,[818,819,6]);Object(V.a)(xa,"ClipboardPlatformInitializationResult",null,[]);var ib=b(192),fc=b(746),Ic=b(625),Yc=b(127),Mc=b(5),xb=b(62);Object(V.a)(X,"MacroRecorderPasteRangePayload",null,[430]);U.prototype.getContent=function(){return this.content};Object(V.a)(U,"MacroRecorderPasteStringPayload",null,[430]);var wc=b(64);Object(V.a)(Q,"MacroRecorderPastePayload",null,[430]);var Ob=b(655),nc=b(984),mb=b(572),ic=b(177),qc=b(219),hc=b(121),Jc=b(298),rd=b(359);B.prototype.getParameters=function(){return this.parameters};
Object(V.a)(B,"MacroRecorderRangeCopyCutCellsInsertedPayload",null,[430]);var md=b(394);Object(V.a)(O,"PasteHtmlRequestParams",null,[]);L.prototype.copy=function(Fa,Kb,gb,Tb,pc){function Xc(Nb,Ja,Lb){var ec={CopyPasteTargetType:1};ec.SourceRanges=Fa;ec.CopyOperationId=Kb.id;Ra.ULS.sendTraceTag(537167756,0,50,"CopyPasteInfrastructure.Copy served from CopyPasteProxy : "+pd.Pwa+", CopyOperationId : "+ec.CopyOperationId);pd.hNa=pd.Pwa?ea(pd.$.oa.Sv,ec,Jc.b(Nb,gb),Tb?Jc.a(Ja,Tb):Ja,Lb,Kb.ribbonCommandInfo,
Uc,pc):ea(pd.$.oa.va,ec,Jc.b(Nb,gb),Tb?Jc.a(Ja,Tb):Ja,Lb,Kb.ribbonCommandInfo,Uc,pc);return pd.hNa}var pd=this;Tb=void 0===Tb?null:Tb;pc=void 0===pc?null:pc;var Uc=this.$.oa.va.Pb();this.umd&&this.fY();this.mjc=Uc.ClientRequestId;var sd=vb.EwaSettings.Zb()?new ic.a(505,0,Xc,80):new mb.a(505,0,Xc,16);sd=this.$.userOperationManager.Sb(sd,Kb.ribbonCommandInfo);this.umd&&this.av.add(sd)};L.prototype.BGf=function(Fa,Kb,gb,Tb,pc,Xc){var pd=this;return new Promise(function(Uc,sd){var Nb,Ja=Xc.commandParameters.stopwatch.qc,
Lb=2;20===Xc.commandParameters.commandType&&(Lb=16);36===Xc.commandParameters.commandType&&(Lb=32);Wa.a.hpd()&&68===Xc.commandParameters.commandType&&(Lb=64);Wa.a.Frd(pd.$)&&1028===Xc.commandParameters.commandType&&(Lb=1024);var ec=null;if(null===(Nb=Xc.copyContextSnapshot)||void 0===Nb?0:Nb.commandParameters)ec=Xc.copyContextSnapshot.commandParameters.id;L.NNd(pd.$,Fa,Tb,Kb,gb,null,function(Zb){L.udc(Zb,Xc,Uc,sd,Ja,pd.$,null,null,null)},function(Zb){Xc.serverRequestTimeInMs=Xc.commandParameters.stopwatch.qc-
Ja;Zb=hc.a.xf(Zb.data);sd(new nc.a(5,Zb))},pc,Lb,ec,Xc.commandParameters.id)})};L.prototype.pasteRange=function(Fa,Kb,gb,Tb,pc,Xc,pd,Uc,sd,Nb){var Ja=this;return new Promise(function(Lb,ec){var Zb=pd.commandParameters.stopwatch.qc;L.voj(Ja.$,Fa,Kb,gb,Tb|-5&pc,function(Oc){L.udc(Oc,pd,Lb,ec,Zb,Ja.$,null,sd,Nb)},function(Oc){pd.serverRequestTimeInMs=pd.commandParameters.stopwatch.qc-Zb;Oc=hc.a.xf(Oc.data);Oc=new nc.a(5,Oc);null===Nb||void 0===Nb?void 0:Nb(Oc);ec(Oc)},Xc,Uc)})};L.prototype.F2i=function(Fa,
Kb,gb,Tb,pc,Xc,pd){var Uc=this;return(new Promise(function(sd,Nb){if(Kb)if(Kb.length>Uc.cya){var Ja=pd.clipboardItems.getItem(oa.plainText),Lb=-1;void 0!==Ja&&null!==Ja&&(Lb=Ja.length);jb.a.ndf&&Kb.length<Uc.fDd&&Kb.length>Uc.oPa&&(Uc.GHf(Kb),Uc.zK=new O(Fa,Kb,gb,Tb,pc,Xc,pd,0,Uc.Opc.length),window.requestIdleCallback&&window.requestIdleCallback(function(){return Uc.vDd()}));Ra.ULS.sendTraceTag(42071712,0,15,"CopyPasteInfrastructure.ProcessPasteHtml copy paste length too long. clipboardHtml.Length: "+
Kb.length+", MaxHtmlImportLength: "+Uc.cya+", PlainTextLength: "+Lb);Nb(new nc.a(1))}else Ja=function(ec,Zb,Oc){Uc.$.py();var td=pd.commandParameters.stopwatch.qc;ec=Jc.b(ec,function(Ec){L.udc(Ec,pd,sd,Nb,td,Uc.$,Kb,null,null)});Zb=Jc.a(Zb,function(Ec){pd.serverRequestTimeInMs=pd.commandParameters.stopwatch.qc-td;Ec=hc.a.xf(Ec.data);Nb(new nc.a(3,Ec))});var Gd=Uc.$.oa.va.Pb(),Pd=Ba.v(Fa,Uc.$),ee={};ee.SourceHtml=Kb;ee.DestinationRanges=Pd?Ba.s(Pd):null;ee.CopyOperationId=gb;ee.PasteId=Tb;Ra.ULS.sendTraceTag(537167755,
0,50,"CopyPasteInfrastructure.ProcessPasteHtml served from CopyPasteProxy : "+Uc.Pwa+". PasteId : "+ee.PasteId);return Uc.Pwa?da(Uc.$.oa.Sv,ee,ec,Zb,Oc,null,Gd,Xc):da(Uc.$.oa.va,ee,ec,Zb,Oc,null,Gd,Xc)},Ja=vb.EwaSettings.Zb()?new ic.a(204,0,Ja,65):new mb.a(204,0,Ja,1),Uc.$.userOperationManager.Sb(Ja,pc);else sd("")})).then(function(){jb.a.ndf&&Kb.length>Uc.oPa&&(Uc.GHf(Kb),Uc.zK=new O(Fa,Kb,gb,Tb,pc,Xc,pd,0,Uc.Opc.length),window.requestIdleCallback&&window.requestIdleCallback(function(){return Uc.vDd()}))})};
L.prototype.GHf=function(Fa){var Kb=this.$.Fb.sc("Task","pasteHtmlChunkOperation"),gb=Math.floor(Fa.length/this.oPa)+1;this.Opc=Array(gb);for(var Tb=0;Tb<gb;)this.Opc[Tb]=Fa.substring(Tb*this.oPa,(Tb+1)*this.oPa),Tb++;Ra.ULS.sendTraceTag(523257954,0,50,"CopyPasteUtils.populatePasteChunks Time taken for chunking: "+Kb.qc)};L.prototype.vDd=function(){var Fa=this,Kb=this.Opc[this.zK.qqb],gb=this.$.Fb.sc("Task","pasteHtmlServerCall");this.CYi(this.zK.destinationRange,Kb,this.zK.qrb,this.zK.AGf,this.zK.Ed,
this.zK.iPb,this.zK.pasteContext,this.zK.qqb,this.zK.FWd);this.zK.qqb++;Ra.ULS.sendTraceTag(523257953,0,15,"CopyPasteUtils.performChunkedPasteHtml server call time: "+gb.qc+",\n       pasteid:"+this.zK.AGf+",\n       chunkIndex:"+this.zK.qqb+",\n       totalChunks:"+this.zK.FWd);this.zK.qqb<this.zK.FWd&&window.requestIdleCallback(function(){return Fa.vDd()})};L.prototype.CYi=function(Fa,Kb,gb,Tb,pc,Xc,pd,Uc,sd){function Nb(ec,Zb,Oc){var td=pd.commandParameters.stopwatch.qc;ec=Jc.b(ec);Zb=Jc.a(Zb,
function(){pd.serverRequestTimeInMs=pd.commandParameters.stopwatch.qc-td});var Gd=Ja.$.oa.va.Pb(),Pd=Ba.v(Fa,Ja.$);Pd={SourceHtml:Kb,DestinationRanges:Pd?Ba.s(Pd):null,CopyOperationId:gb,PasteId:Tb+"_chunk_"+Uc,ChunkIndex:Uc,TotalChunks:sd};Ra.ULS.sendTraceTag(523257952,0,50,"CopyPasteInfrastructure.ProcessPasteHtml served from CopyPasteProxy : "+Ja.Pwa+". PasteId : "+Pd.PasteId);return da(Ja.$.oa.Sv,Pd,ec,Zb,Oc,null,Gd,Xc)}var Ja=this,Lb=vb.EwaSettings.Zb()?new ic.a(204,0,Nb,65):new mb.a(204,0,Nb,
1);this.$.userOperationManager.Sb(Lb,pc)};L.prototype.G2i=function(Fa,Kb,gb,Tb,pc){var Xc=this;return new Promise(function(pd,Uc){Ra.ULS.sendTraceTag(537167754,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: method start. pasteContext.Id="+pc.id);Kb&&(Kb=Ub.a.trimEnd(Kb,"\n","\r"));Ra.ULS.sendTraceTag(537167753,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after clipboardText.TrimEnd. pasteContext.Id="+pc.id);if(Kb)if(Kb.length>Xc.bDb)Ra.ULS.sendTraceTag(24150921,
0,15,"CopyPasteInfrastructure.ProcessPasteText copy paste length too long. clipboardText.Length: {0}, MaxCopyPasteLength: {1}",Kb.length,Xc.bDb),Uc(new nc.a(1));else{var sd=Ba.v(Fa,Xc.$);Ra.ULS.sendTraceTag(537167752,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before treatAsLink calculation. pasteContext.Id="+pc.id);var Nb=!Xc.$.ea.isNamedObjectViewMode&&!Kb.includes("\n")&&!Kb.includes("\t");Ra.ULS.sendTraceTag(537167751,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before isLink check. pasteContext.Id="+
pc.id+". treatAsLink="+Nb);Nb=Nb&&Ub.a.Nef(Kb);Ra.ULS.sendTraceTag(537167750,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after treatAsLink calculation. pasteContext.Id="+pc.id+". treatAsLink="+Nb);var Ja=Xc.$.oa.va.Pb();if(Nb){var Lb=526;Ra.ULS.sendTraceTag(537167749,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before FixUpUrl. pasteContext.Id="+pc.id);var ec=qc.a.Vad(Kb);Ra.ULS.sendTraceTag(537167748,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after FixUpUrl. pasteContext.Id="+
pc.id);var Zb=Ba.s(sd);Nb=function(td,Gd,Pd){var ee=pc.commandParameters.stopwatch.qc;td=Jc.b(td,function(Ec){Ra.ULS.sendTraceTag(537167747,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: on ApplyHyperlink successCallback. pasteContext.Id="+pc.id);pc.requestTelemetryData=Ec.RequestTelemetryData;pc.serverRequestTimeInMs=pc.commandParameters.stopwatch.qc-ee;Ec.Errors&&0<Ec.Errors.length?Uc(new nc.a(2,Ec.Errors)):pd(Kb)});Gd=Jc.a(Gd,function(Ec){pc.serverRequestTimeInMs=pc.commandParameters.stopwatch.qc-
ee;Ec=hc.a.xf(Ec.data);Uc(new nc.a(2,Ec))});Xc.$.py();Ra.ULS.sendTraceTag(537167746,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before ApplyHyperlink. pasteContext.Id="+pc.id);return xb.b(Xc.$.oa.va,Zb,Kb,ec,!1,!1,63,td,Gd,Pd,Fa,Ja,Tb)};var Oc=function(){return new Ob.a(Zb,Kb,ec)}}else Lb=180,Nb=function(td,Gd,Pd){Xc.$.py();var ee=pc.commandParameters.stopwatch.qc;td=Jc.b(td,function(Ec){Ra.ULS.sendTraceTag(537167745,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: on PasteString successCallback. pasteContext.Id="+
pc.id);L.udc(Ec,pc,pd,Uc,ee,Xc.$,Kb,null,null)});Gd=Jc.a(Gd,function(Ec){pc.serverRequestTimeInMs=pc.commandParameters.stopwatch.qc-ee;Ec=hc.a.xf(Ec.data);Uc(new nc.a(4,Ec))});Ra.ULS.sendTraceTag(537167744,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before PasteString. pasteContext.Id="+pc.id);return ia(Xc.$.oa.va,sd,Kb,td,Gd,Pd,null,Ja,Tb)},Oc=function(){return new U(sd,Kb)};Ra.ULS.sendTraceTag(537167715,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before UserNonBlockingWebMethodOperation. pasteContext.Id="+
pc.id);Nb=vb.EwaSettings.Zb()?new ic.a(Lb,0,Nb,65,Oc):new mb.a(Lb,0,Nb,1,Oc);Ra.ULS.sendTraceTag(537167714,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: returning. pasteContext.Id="+pc.id);Xc.$.userOperationManager.Sb(Nb,gb)}else pd("")})};L.prototype.r8e=function(Fa,Kb){Kb=[1===Kb?4:5];this.gridView.qb.Iw(rd.a.W7(wc.d(this.$.pa),Fa),Kb,!0);this.gridView.qb.sn(Kb);this.gridView.qb.update(!0)};L.prototype.Jxb=function(){var Fa=[4,5];this.gridView.qb.fh(Fa,!1,!1);this.gridView.qb.Ti(null,
Fa,!1);1===this.gridView.ha.Re&&this.gridView.sn(!1,!1);this.gridView.qb.update(!1,!1)};L.prototype.WUg=function(Fa,Kb,gb){var Tb=[];gb=ik(gb);for(var pc=gb.next();!pc.done;pc=gb.next())Tb.push(this.ZUg(Fa,Kb,pc.value));return Tb};L.prototype.fY=function(){if(this.av)for(var Fa=ik(this.av),Kb=Fa.next();!Kb.done;Kb=Fa.next())Kb=Kb.value,this.$&&this.$.userOperationManager&&(Kb.operation&&Ra.ULS.sendTraceTag(526758675,0,50,"CopyPasteUtils.AbortOutstandingUserOperation: Trying to abort pending operation "+
Yc.a(Kb.operation.operationName)+"."),this.WVg(),this.$.userOperationManager.Hta(Kb))};L.prototype.WVg=function(){if(this.hNa){var Fa=this.hNa.Gt;Ra.ULS.sendTraceTag(526758674,0,15,"Cancelling pending copy request with Id="+Fa);hc.a.mu(Fa);!vb.EwaSettings.isChangeGateEnabled("OfficeVSO:6151555_DisableCancelCopyRequest")&&this.mjc&&xb.h(this.$.oa.va,this.mjc,null,null,null);this.mjc=this.hNa=null}};L.prototype.ZUg=function(Fa,Kb,gb){Ra.ULS.shipAssertTag(537167713,0,!!Kb,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray shouldn't be null");
Ra.ULS.shipAssertTag(537167712,0,0<Kb.length,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray length shouldn't be zero");var Tb=0,pc=0,Xc=new Set,pd=new Set;Kb=ik(Kb);for(var Uc=Kb.next();!Uc.done;Uc=Kb.next()){Uc=Uc.value;var sd=Uc.left+"_"+Uc.right,Nb=Uc.top+"_"+Uc.bottom;pd.has(sd)||(pd.add(sd),pc+=Uc.width);Xc.has(Nb)||(Xc.add(Nb),Tb+=Uc.height)}if(36===Fa)return gb.isSingle?L.KRe(pc,Tb,gb):gb.clone();516===Fa&&(Fa=Tb,Tb=pc,pc=Fa);Fa=!(gb.width%pc)&&!(gb.height%Tb);Xc=gb.l_&&!(gb.height%
Tb);gb.x5&&!(gb.width%pc)||Xc?gb=L.KRe(pc,Tb,gb):Fa?gb=gb.clone():(gb=gb.clone(),gb.bottom=Math.min(eb.a.uh,gb.top+Tb-1),gb.right=Math.min(eb.a.Eh,gb.left+pc-1));return gb};L.prototype.vMg=function(Fa,Kb,gb,Tb,pc,Xc,pd,Uc,sd,Nb,Ja){if(!Tb||!Tb.length)return 1;if(1<Tb.length){if(!this.mgc&&Xc)return 3;if(Nb)return 0;if(Uc)return 9;if(sd)return 8;if(Ja)return 2;if(1<Kb.length)return 4;var Lb=Kb[0];if(!pd&&!Wb.a.all(Tb,function(ec){return ec.isSingle||!(ec.width%Lb.width)&&!(ec.height%Lb.height)}))return 5;
if((!this.mgc||!Xc)&&Ub.a.equals(Fa,gb,!0))for(pc=ik(pc),Fa=pc.next();!Fa.done;Fa=pc.next())if(Fa=Fa.value,Fa.xd(Lb)&&!Fa.equals(Lb))return 6}else if(Kb&&0<Kb.length){if(0!==this.scf(Kb,sd))return 7;if(1<Kb.length){if(!this.mgc&&Xc)return 3;if((!this.mgc||!Xc)&&Ub.a.equals(Fa,gb,!0))for(Fa=ik(Kb),Kb=Fa.next();!Kb.done;Kb=Fa.next())if(Kb=Kb.value,gb=pc[0],Kb.xd(gb)&&!Kb.equals(gb))return 6}}return 0};L.prototype.scf=function(Fa,Kb){if(!Fa||1>=Fa.length)return 0;if(Kb)return 2;if(!Ba.S(Fa))return 1;
Kb=new fc.a(Ic.a.Jk());for(var gb=ik(Fa),Tb=gb.next();!Tb.done;Tb=gb.next()){Tb=Tb.value;for(var pc=ik(Fa),Xc=pc.next();!Xc.done;Xc=pc.next()){Xc=Xc.value;var pd=Tb.top===Xc.top&&Tb.bottom===Xc.bottom,Uc=Tb.left===Xc.left&&Tb.right===Xc.right,sd=Math.max(Tb.left,Xc.left)<Math.min(Tb.right,Xc.right);if(Math.max(Tb.top,Xc.top)<Math.min(Tb.bottom,Xc.bottom)&&!pd||sd&&!Uc)return 3;Kb.add(Tb.top+"-"+Tb.bottom+"-"+Xc.left+"-"+Xc.right);Kb.add(Xc.top+"-"+Xc.bottom+"-"+Tb.left+"-"+Tb.right)}}Fa=ik(Fa);for(gb=
Fa.next();!gb.done;gb=Fa.next())gb=gb.value,Kb.remove(gb.top+"-"+gb.bottom+"-"+gb.left+"-"+gb.right);return 0<Kb.count?3:0};L.prototype.p8i=function(Fa){var Kb=this.gridView.ha;Kb.updateSelection(Fa,Fa.topLeft,0);Kb.selectionType=-1};L.prototype.uwb=function(Fa){if(null===Fa||void 0===Fa?0:Fa.sourceItem){if(!ta(Fa.sourceItem))return null;if((Fa=Fa.sourceItem)&&Ba.cb(Fa.ranges,!0))return Fa}return null};L.prototype.Ogc=function(Fa,Kb){Ra.ULS.shipAssertTag(537167711,0,!!Fa,"CopyPasteUtils.IsFromKeyboardShortcut: commandInfo shouldn't be null");
return Kb&&Mc.a.NF in Kb||Fa.tabName?!1:1===Fa.method};L.voj=function(Fa,Kb,gb,Tb,pc,Xc,pd,Uc,sd){function Nb(){return new X(gb,Tb,pc)}function Ja(ec,Zb,Oc){Fa.py();var td=Fa.oa.va;ec=Jc.b(ec,Xc);Zb=Jc.a(Zb,pd);var Gd=Uc;Gd=void 0===Gd?null:Gd;var Pd=td.Na(9,Lb);Pd.sourceRanges=gb;Pd.destinationRanges=Tb;Pd.flags=pc;return xb.g(td,"PasteRange",Pd,ec,Zb,Oc,null,64,Gd)}var Lb=Fa.oa.va.Pb(sd?{D_:!0,SZ:1}:{D_:!1,SZ:0});sd=vb.EwaSettings.Zb()?new ic.a(506,0,Ja,65,Nb):new mb.a(506,0,Ja,1,Nb);Fa.userOperationManager.Sb(sd,
Kb)};L.udc=function(Fa,Kb,gb,Tb,pc,Xc,pd,Uc,sd){pd=void 0===pd?null:pd;Ra.ULS.sendTraceTag(537167710,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: on HandlePasteResult start. pasteContext.Id="+Kb.id);Kb.requestTelemetryData=Fa.RequestTelemetryData;Kb.serverRequestTimeInMs=Kb.commandParameters.stopwatch.qc-pc;wb.a.Dg(Fa.Errors)?wb.a.dha(Fa.Errors)?(Kb&&(Kb.encounteredDeploymentErrors=!0),Ra.ULS.sendTraceTag(537167707,0,15,"CopyPasteUtils.HandlePasteServerResponse: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: "+
wb.a.Cc(Fa.Errors))):(Fa=new nc.a(5,Fa.Errors),null===sd||void 0===sd?void 0:sd(Fa),Tb(Fa)):Fa.Result?(Tb=!!Fa&&!!Fa.RequestTelemetryData,ka.g(Xc).si.tla(Kb.commandParameters.stopwatch.id,Fa.StateId,Tb?Fa.RequestTelemetryData.EcsOperationDuration:0,Tb?Fa.RequestTelemetryData.EcsRequestDuration:0,Tb?Fa.RequestTelemetryData.WfeRequestDuration:0),Kb.pastedRange=Fa.Result.SheetMultiRange,Ra.ULS.sendTraceTag(537167708,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise ewaResult.Result is not null. pasteContext.Id="+
Kb.id),null===Uc||void 0===Uc?void 0:Uc(),gb(!0)):(Ra.ULS.sendTraceTag(537167709,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise when ewaResult.Result is null. pasteContext.Id="+Kb.id),gb(pd||!0))};L.NNd=function(Fa,Kb,gb,Tb,pc,Xc,pd,Uc,sd,Nb,Ja,Lb){function ec(){return new Q(td)}function Zb(Gd,Pd,ee){Fa.py();return P(Fa.oa.va,td,Jc.b(Gd,pd),Jc.a(Pd,Uc),ee,Xc,Oc,sd)}var Oc=Fa.oa.va.Pb(),td=L.R9g(gb,Tb,pc,Nb,Ja,Lb);gb=vb.EwaSettings.Zb()?new ic.a(503,0,Zb,65,ec):
new mb.a(503,0,Zb,1,ec);Fa.userOperationManager.Sb(gb,Kb)};L.R9g=function(Fa,Kb,gb,Tb,pc,Xc){var pd={};pd.ShadowWorkbookBase64=Fa.shadowWorkbookBase64;pd.SourceRanges={};pd.SourceRanges.Ranges=Array(1);pd.SourceRanges.Ranges[0]={};pd.SourceRanges.Ranges[0].FirstRow=Fa.rangeRowStart;pd.SourceRanges.Ranges[0].LastRow=Fa.rangeRowEnd;pd.SourceRanges.Ranges[0].FirstColumn=Fa.rangeColumnStart;pd.SourceRanges.Ranges[0].LastColumn=Fa.rangeColumnEnd;vb.EwaSettings.getBooleanFeatureGate(jb.a.t5b,!1)?gb?pd.DestinationRanges=
Ba.u(gb.SheetName,gb.NamedObjectName,Ba.g(gb.Ranges)):(Ra.ULS.sendTraceTag(537167706,0,15,"CopyPasteInfrastructure.CreatePasteParameters: multiRangeDestination is null"),pd.DestinationRanges=null):pd.DestinationRanges=Kb?Ba.s(Kb):null;pd.CopyPasteTargetType=1;pd.PasteType=Tb;pd.CopyOperationId=pc;pd.PasteId=Xc;pd.SourceClientPath=Fa.sourceClientPath;pd.SourceSheetName=Fa.sourceSheetName;pd.SourceWorkbookName=Fa.sourceWorkbookName;if(!Fa.originalSourceRangesCountExceedsLimit&&Fa.originalSourceRanges&&
0<Fa.originalSourceRanges.length&&1024===Tb){pd.OriginalSourceMultiRange={};Kb=Array(Fa.originalSourceRanges.length);for(gb=0;gb<Kb.length;++gb)Kb[gb]={},Kb[gb].FirstRow=Fa.originalSourceRanges[gb][0],Kb[gb].FirstColumn=Fa.originalSourceRanges[gb][1],Kb[gb].LastRow=Fa.originalSourceRanges[gb][2],Kb[gb].LastColumn=Fa.originalSourceRanges[gb][3];pd.OriginalSourceMultiRange.Ranges=Kb}return pd};L.KRe=function(Fa,Kb,gb){gb=gb.clone();gb.height<Kb&&(gb.bottom=Math.min(eb.a.uh,gb.top+Kb-1));gb.width<Fa&&
(gb.right=Math.min(eb.a.Eh,gb.left+Fa-1));return gb};L.prototype.executeInsertCopiedCutCellsOperation=function(Fa,Kb,gb,Tb,pc,Xc,pd){function Uc(){return new B(sd)}Xc=void 0===Xc?null:Xc;pd=void 0===pd?null:pd;var sd={};sd.InsertDirection=Tb;sd.SourceRange=Fa;sd.DestRange=Kb;sd.CopyCutOperation=gb?0:1;var Nb=this.$.oa.va;return md.a(this.$.userOperationManager,function(Ja,Lb,ec){Ja=Xc?Jc.b(Ja,Xc):Ja;Lb=pd?Jc.a(Lb,pd):Lb;var Zb=Nb.Na(41,null);Zb.insertCopiedCutCellsParameters=sd;return xb.g(Nb,"InsertCopiedCutCells",
Zb,Ja,Lb,ec,null,4)},function(Ja){return new ic.a(104,0,Ja,void 0,Uc)},pc)};L.prototype.GJe=function(Fa,Kb,gb,Tb,pc,Xc,pd,Uc){var sd=this;return new Promise(function(Nb,Ja){function Lb(Zb){Zb=hc.a.xf(Zb.data);Zb=new nc.a(21,Zb);null===Uc||void 0===Uc?void 0:Uc(Zb);Ja(Zb)}function ec(Zb){Fa.requestTelemetryData=Zb.RequestTelemetryData;if(Zb.Errors&&0<Zb.Errors.length){var Oc=new nc.a(21,Zb.Errors);null===Uc||void 0===Uc?void 0:Uc(Oc);Ja(new nc.a(21,Zb.Errors))}else null===pd||void 0===pd?void 0:pd(),
Nb(!0)}vb.EwaSettings.isChangeGateEnabled("OfficeVSO:6126613_RemoveClearingRunningAntsICCCForDragInsert")?sd.executeInsertCopiedCutCellsOperation(Kb,gb,Tb,pc,Xc,ec,Lb):sd.executeInsertCopiedCutCellsOperation(Kb,gb,Tb,pc,Xc,ec,Lb).continueWith(function(){if(Tb)sd.Jxb();else{var Zb=sd.$.da.za(254);Zb&&Zb.V2b("DragDropInsert/success/"+Db.a[Xc.method],!0)}})})};of.Object.defineProperties(L.prototype,{cya:{configurable:!0,enumerable:!0,get:function(){return this.Pwa?vb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.CopyPasteHtmlImportMaxLength",
this.$.ya.CopyPasteMaxPayloadLength):eb.a.cya}}});Object(V.a)(L,"CopyPasteUtils",null,[788]);var Cc=b(550),fd;(function(Fa){Fa[Fa.range=0]="range";Fa[Fa.art=1]="art"})(fd||(fd={}));Object(V.b)("SourceItemType",fd);var Cd=b(24),Sc=b(91);K.prototype.serializeSourceItem=function(Fa){var Kb={};if(Fa&&Object.getType(Fa)===aa)Kb.sheetName=Fa.sheetName,Kb.topArray=Wb.a.map(Fa.ranges,function(gb){return gb.top}),Kb.leftArray=Wb.a.map(Fa.ranges,function(gb){return gb.left}),Kb.bottomArray=Wb.a.map(Fa.ranges,
function(gb){return gb.bottom}),Kb.rightArray=Wb.a.map(Fa.ranges,function(gb){return gb.right}),Kb.sessionStateId=Fa.sessionStateId,Kb.sessionId=Fa.sessionId,Kb.sourceItemType=this.oYf(0);else if(Fa&&Object.getType(Fa)===ma)Kb.activeFloatingObjectControlId=Fa.activeFloatingObjectControlId,Kb.sheetName=Fa.sheetName,Kb.sessionStateId=Fa.sessionStateId,Kb.sessionId=Fa.sessionId,Kb.floatingObjectType=this.Yoj(Fa.type),Kb.sourceItemType=this.oYf(1);else return Ra.ULS.shipAssertTag(537167705,0,!1,"EnvironmentSerializationHelper.SerializeSourceItem: sourceItem shouldn't be null."),
null;return JSON.stringify(Kb)};K.prototype.serializeCommandParameters=function(Fa){if(!Fa)return Ra.ULS.shipAssertTag(537167704,0,!1,"EnvironmentSerializationHelper.Serialize: commandParameters shouldn't be null."),null;var Kb={};Kb.id=Fa.id;Kb.commandType=Fa.commandType;Kb.copyPasteTargetType=Fa.copyPasteTargetType;Fa.ribbonCommandInfo&&(Kb.ribbonCommandName=this.fpj(Fa.ribbonCommandInfo.command),Kb.inputMethodName=this.$oj(Fa.ribbonCommandInfo.method),Kb.frameModeName=this.Zoj(Fa.ribbonCommandInfo.mode),
Kb.uiLocationName=this.ipj(Fa.ribbonCommandInfo.Ne),Kb.tabName=Fa.ribbonCommandInfo.tabName);return JSON.stringify(Kb)};K.prototype.deserializeSourceItem=function(Fa){if(!Fa)return null;try{var Kb=JSON.parse(Fa);if(!Kb)return Ra.ULS.shipAssertTag(537167703,0,!1,"EnvironmentSerializationHelper.Deserialize: Json.Parse return null result."),null;var gb=null;switch(this.hfh(Kb.sourceItemType)){case 0:gb=new aa(this.$,this.efh(Kb),Kb.sheetName,Kb.sessionStateId,Kb.sessionId);break;case 1:gb=new ma(Kb.activeFloatingObjectControlId,
Kb.sheetName,Kb.sessionStateId,Kb.sessionId,this.bfh(Kb.floatingObjectType))}return gb}catch(Tb){return Ra.ULS.sendTraceTag(537167702,0,10,"EnvironmentSerializationHelper.DeserializeSourceItem: got exception while try to JSON.Parse string length: "+(Fa?Fa.length:0)+", errror: "+Tb),null}};K.prototype.deserializeCommandParameters=function(Fa){if(!Fa)return null;try{var Kb=JSON.parse(Fa);if(!Kb)return Ra.ULS.shipAssertTag(537167701,0,!1,"EnvironmentSerializationHelper.DeserializeCommandParameters: Json.Parse return null result."),
null;var gb=nb.a();gb.id=Kb.id;gb.ribbonCommandInfo=this.gfh(Kb);gb.commandType=Kb.commandType;gb.copyPasteTargetType=Kb.copyPasteTargetType;return gb}catch(Tb){return Ra.ULS.sendTraceTag(537167700,0,10,"EnvironmentSerializationHelper.DeserializeCommandParameters: got exception while try to JSON.Parse string length: "+(Fa?Fa.length:0)+", errror: "+Tb),null}};K.prototype.efh=function(Fa){var Kb=[];Ra.ULS.shipAssertTag(537167699,0,!!Fa.topArray&&0<Fa.topArray.length,"EnvironmentSerializationHelper.DeserializeRanges: TopArray shouldn't be "+
(Fa.topArray?"empty":"null")+".");Ra.ULS.shipAssertTag(537167698,0,!!Fa.leftArray&&0<Fa.leftArray.length,"EnvironmentSerializationHelper.DeserializeRanges: LeftArray shouldn't be "+(Fa.leftArray?"empty":"null")+".");Ra.ULS.shipAssertTag(537167697,0,!!Fa.bottomArray&&0<Fa.bottomArray.length,"EnvironmentSerializationHelper.DeserializeRanges: BottomArray shouldn't be "+(Fa.bottomArray?"empty":"null")+".");Ra.ULS.shipAssertTag(537167696,0,!!Fa.rightArray&&0<Fa.rightArray.length,"EnvironmentSerializationHelper.DeserializeRanges: RightArray shouldn't be "+
(Fa.rightArray?"empty":"null")+".");if(!(Fa.topArray&&Fa.leftArray&&Fa.bottomArray&&Fa.rightArray))return Kb;Ra.ULS.shipAssertTag(537167695,0,Fa.topArray.length===Fa.bottomArray.length&&Fa.topArray.length===Fa.leftArray.length&&Fa.topArray.length===Fa.rightArray.length,"EnvironmentSerializationHelper.DeserializeRanges: The length of TopArray("+Fa.topArray.length+"), BottomArray("+Fa.bottomArray.length+"), LeftArray("+Fa.leftArray.length+"), RightArray("+Fa.rightArray.length+") should be the same.");
for(var gb=Math.min(Fa.topArray.length,Fa.bottomArray.length,Fa.leftArray.length,Fa.rightArray.length),Tb=0;Tb<gb;Tb++)Kb.push(new Cd.Range(Fa.topArray[Tb],Fa.leftArray[Tb],Fa.bottomArray[Tb],Fa.rightArray[Tb],!1,!1));return Kb};K.prototype.gfh=function(Fa){return new Sc.a(this.ffh(Fa.ribbonCommandName),this.dfh(Fa.inputMethodName),this.cfh(Fa.frameModeName),this.ifh(Fa.uiLocationName),Fa.tabName)};K.prototype.fpj=function(Fa){return void 0!==Fa&&null!==Fa&&Fa.toString()in this.YLd?this.YLd[Fa.toString()]:
(Ra.ULS.shipAssertTag(537167694,0,!1,"EnvironmentSerializationHelper.SerializeRibbonCommand expected to get RibbonCommand.Copy(-911352779) or RibbonCommand.Cut(-1985798686) but got "+Fa),this.YLd["-911352779"])};K.prototype.ffh=function(Fa){return Fa&&Fa in this.y7f?this.y7f[Fa]:(Ra.ULS.shipAssertTag(537167693,0,!1,"EnvironmentSerializationHelper.DeserializeRibbonCommand: expected to get RibbonCommand.Copy(-911352779) or RibbonCommand.Cut(-1985798686) but got "+Fa),-911352779)};K.prototype.$oj=function(Fa){return void 0!==
Fa&&null!==Fa&&Db.a[Fa]in this.nka?this.nka[Db.a[Fa]]:(Ra.ULS.shipAssertTag(537167692,0,!1,"EnvironmentSerializationHelper.SerializeInputMethod: got unexpected value "+Fa),this.nka.unknown)};K.prototype.dfh=function(Fa){return Fa&&Fa in this.x7f?this.x7f[Fa]:(Ra.ULS.shipAssertTag(537167691,0,!1,"EnvironmentSerializationHelper.DeserializeInputMethod: got unexpected value "+Fa),0)};K.prototype.Zoj=function(Fa){return void 0!==Fa&&null!==Fa&&Cc.a[Fa]in this.n3a?this.n3a[Cc.a[Fa]]:(Ra.ULS.shipAssertTag(537167690,
0,!1,"EnvironmentSerializationHelper.SerializeFrameMode: got unexpected value "+Fa),this.n3a.edit)};K.prototype.cfh=function(Fa){return Fa&&Fa in this.w7f?this.w7f[Fa]:(Ra.ULS.shipAssertTag(537167689,0,!1,"EnvironmentSerializationHelper.DeserializeFrameMode: got unexpected value "+Fa),2)};K.prototype.oYf=function(Fa){return void 0!==Fa&&null!==Fa&&fd[Fa]in this.SMb?this.SMb[fd[Fa]]:(Ra.ULS.shipAssertTag(537167688,0,!1,"EnvironmentSerializationHelper.SerializeSourceItemType: got unexpected value "+
Fa),this.SMb.range)};K.prototype.hfh=function(Fa){return Fa&&Fa in this.z7f?this.z7f[Fa]:(Ra.ULS.shipAssertTag(537167687,0,!1,"EnvironmentSerializationHelper.DeserializeSourceItemType: got unexpected value "+Fa),0)};K.prototype.Yoj=function(Fa){return void 0!==Fa&&null!==Fa&&Fa.toString()in this.iXc?this.iXc[Fa.toString()]:(Ra.ULS.shipAssertTag(537167686,0,!1,"EnvironmentSerializationHelper.SerializeArtSourceItemType: got unexpected value "+Fa),this.iXc["99"])};K.prototype.bfh=function(Fa){return Fa&&
Fa in this.v7f?this.v7f[Fa]:(Ra.ULS.shipAssertTag(537167685,0,!1,"EnvironmentSerializationHelper.DeserializeArtSourceItemType: got unexpected value "+Fa),99)};K.prototype.ipj=function(Fa){return void 0!==Fa&&null!==Fa&&ub.a[Fa]in this.tr?this.tr[ub.a[Fa]]:(Ra.ULS.shipAssertTag(36229129,0,!1,"EnvironmentSerializationHelper.SerializeUILocation: got unexpected value "+Fa),this.tr.ribbon)};K.prototype.ifh=function(Fa){return Fa&&Fa in this.A7f?this.A7f[Fa]:(Ra.ULS.shipAssertTag(537167684,0,!1,"EnvironmentSerializationHelper.DeserializeUILocation: got unexpected value "+
Fa),2)};Object(V.a)(K,"EnvironmentSerializationHelper",null,[]);var Md=b(4);I.DVf="SameSession";I.yFe="CrossSession";I.Bkf="LegacyCrossSession";I.external="External";Object(V.a)(I,"PayloadOrigin",null,[]);N.prototype.shouldWaitForCopyToComplete=function(){return!1};N.prototype.onDeferredPasteStarted=function(){};N.prototype.onDeferredPasteCompleted=function(){};N.prototype.beforePaste=function(){};N.prototype.iPj=function(Fa){var Kb=null;try{var gb=Fa.getItem(oa.shadowWorkbook);if(!gb)return{returnValue:!1,
K0:Kb};Kb=JSON.parse(gb);return{returnValue:this.Npi(Kb),K0:Kb}}catch(Tb){return Ra.ULS.sendTraceTag(537167835,0,50,"BaseCopyPasteHandler.TryParseRangeShadowWorkbookPayload: Exception caught: "+Tb),{returnValue:!1,K0:Kb}}};N.prototype.Npi=function(Fa){return!!Fa&&(!!Fa.shadowWorkbookBase64||Fa.shadowWorkbookSizeExceedsLimit)&&void 0!==Fa.rangeRowStart&&void 0!==Fa.rangeRowEnd&&void 0!==Fa.rangeColumnStart&&void 0!==Fa.rangeColumnEnd};N.prototype.Mpc=function(Fa){Fa.wasLastCopyExternal=!0;if(vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",
!1)&&!Sa.a.IC&&516!==Fa.commandParameters.commandType&&1028!==Fa.commandParameters.commandType){var Kb=this.iPj(Fa.clipboardItems);var gb=Kb.K0;if(Kb.returnValue)return Fa.isShadowWorkbookParsedSuccessfully=!0,this.BYi(Fa,gb)}return 516!==Fa.commandParameters.commandType&&36!==Fa.commandParameters.commandType?vb.EwaSettings.ma(162)&&20!==Fa.commandParameters.commandType&&(null===this.$.shortcutKeyManager||this.$.shortcutKeyManager.rgc)&&(gb=Fa.clipboardItems.getItem(oa.html),void 0!==gb&&null!==gb&&
gb&&gb.trim()!==this.lXc&&(gb.startsWith("<")||Sa.a.Pf&&gb.startsWith("\n<")))?(Kb=Fa.clipboardItems.getItem(oa.qrb),this.zYi(Fa,gb,void 0===Kb?null:Kb)):this.wGf(Fa):Promise.reject(new nc.a(6))};N.prototype.BYi=function(Fa,Kb){Ra.ULS.sendTraceTag(537167834,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: Pasting shadow workbook from system clipboard");Fa.pasteResult="SystemClipboardShadowWorkbookPaste";Fa.payloadType=fa.shadowWorkbook;Fa.payloadOrigin=I.external;Fa.shadowWorkbookPayloadSize=
G(Kb);Fa.shadowWorkbookSizeExceedsLimit=T(Kb);var gb=null,Tb=null,pc=Fa.commandParameters.originalDestinations;vb.EwaSettings.getBooleanFeatureGate(jb.a.t5b,!1)?gb=Ba.r(pc,this.$):Tb=Ba.v(Ba.K(pc),this.$);Kb.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(Fa.originalSourceRangesCountExceedsLimit=Kb.originalSourceRangesCountExceedsLimit);if(Fa.shadowWorkbookSizeExceedsLimit)return Ra.ULS.sendTraceTag(537167833,0,15,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: shadow workbook length("+
Fa.shadowWorkbookPayloadSize+") is over the limit("+eb.a.jlc+"). reject the paste request. ShadowWorkbookSizeExceedsLimit: "+Kb.shadowWorkbookSizeExceedsLimit),Promise.reject(new nc.a(1));Ra.ULS.sendTraceTag(537167832,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: trigger Paste request. PasteOperationId="+Fa.commandParameters.id);return this.Cp.BGf(Fa.commandParameters.ribbonCommandInfo,Tb,gb,Kb,[Fa.commandParameters.stopwatch],Fa)};N.prototype.wGf=function(Fa){var Kb=Fa.clipboardItems.getItem(oa.plainText);
if(void 0!==Kb&&null!==Kb&&Kb.trim()===this.lXc)return Promise.reject(new nc.a(7));void 0!==Kb&&null!==Kb&&(Fa.plainTextPayloadSize=Kb.length);Fa.isPlainTextPaste=!0;Fa.pasteResult="SystemClipboardPaste";Fa.payloadOrigin=Za(Fa)?I.Bkf:I.external;Fa.payloadType=fa.plainText;Ra.ULS.sendTraceTag(537167831,0,50,"BaseRangeCopyPasteHandler.PasteByPlainText: trigger ProcessPasteText request. pasteContext.Id="+Fa.id+", PasteOperationId="+Fa.commandParameters.id);Kb=this.Cp.G2i(Ba.K(Fa.commandParameters.originalDestinations),
Kb,Fa.commandParameters.ribbonCommandInfo,[Fa.commandParameters.stopwatch],Fa);Ra.ULS.sendTraceTag(537167830,0,50,"BaseRangeCopyPasteHandler.PasteByPlainText: returned from ProcessPasteText. pasteContext.Id="+Fa.id);return Kb};N.prototype.zYi=function(Fa,Kb,gb){Fa.htmlPayloadSize=Kb.length;Fa.isHtmlPaste=!0;Fa.pasteResult="SystemClipboardHtmlPaste";Fa.payloadType=fa.html;Fa.payloadOrigin=Za(Fa)?I.Bkf:I.external;Ra.ULS.sendTraceTag(42071711,0,50,"BaseRangeCopyPasteHandler.PasteByHtml: trigger ProcessPasteHtml request. PasteOperationId="+
Fa.commandParameters.id);return this.Cp.F2i(Ba.K(Fa.commandParameters.originalDestinations),Kb,gb,Fa.commandParameters.id,Fa.commandParameters.ribbonCommandInfo,[Fa.commandParameters.stopwatch],Fa)};N.prototype.WEe=function(Fa){var Kb={};Fa&&(Kb.shadowWorkbookBase64=Fa.ShadowWorkbookBase64,Kb.shadowWorkbookSizeExceedsLimit=Fa.ShadowWorkbookSizeExceedsLimit,Kb.originalSourceRangesCountExceedsLimit=Fa.OriginalSourceRangesCountExceedsLimit,Kb.originalSourceRangesCount=Fa.OriginalSourceRangesCount,Kb.shadowWorkbookBlockedSize=
Fa.ShadowWorkbookBlockedSize);return Kb};N.prototype.Tfg=function(Fa,Kb){var gb=Ma(Fa),Tb=32===(Fa.commandParameters.commandType&32),pc=1024===(Fa.commandParameters.commandType&1024),Xc=!1,pd=null,Uc=null,sd=!1;if(!gb){Xc=-1985798686===Fa.commandParameters.ribbonCommandInfo.command;var Nb=Fa.copyContextSnapshot;if(Kb)sd=!Nb.sourceItem.isFromCurrentSession(this.$);else if(Nb=this.Cp.uwb(Nb))pd=Nb.ranges,Uc=Nb.sheetName,sd=!Fa.isSameSession}return this.Cp.vMg(Uc,pd,this.$.pa.sheetName,Fa.commandParameters.originalDestinations,
Fa.commandParameters.expandDestinations,sd,Tb,pc,Xc,Kb,gb)};of.Object.defineProperties(N.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},lXc:{configurable:!0,enumerable:!0,get:function(){return this.Fm.Xa(5)}}});Object(V.a)(N,"BaseCopyPasteHandler",null,[776,777,778]);S.prototype.Gva=function(Fa){return this.key&&this.key.isEqual(Fa)?this.createClipboardItems(this.clipboardItems):null};S.prototype.setValue=function(Fa,Kb){this.key=Fa;this.clipboardItems=this.createClipboardItems(Kb)};
S.prototype.createClipboardItems=function(Fa){var Kb=this.H$.create(),gb=Fa.getItem(oa.plainText);gb&&Kb.setItem(oa.plainText,gb);(gb=Fa.getItem(oa.shadowWorkbook))&&Kb.setItem(oa.shadowWorkbook,gb);(Fa=Fa.getItem(oa.html))&&Kb.setItem(oa.html,Fa);return Kb};Object(V.a)(S,"CopyCache",null,[]);var bc=b(74);$k(J,N);J.prototype.getSourceItem=function(){var Fa=vb.EwaSettings.isChangeGateEnabled("OfficeVSO:6713439_FixCloneRangeArray")?Ba.d(this.gridView.ha.sa.selectedRanges):Wb.a.clone(this.gridView.ha.sa.selectedRanges);
return new aa(this.$,Fa,this.$.ea.pa.sheetName,this.$.ea.Ke,this.$.ya.UserSessionId)};J.prototype.beforeSerialize=function(Fa){var Kb=this;Fa.isSelectionAllowed=!1;Fa.isAsyncCopy=!1;Fa.isFromCache=!1;Fa.encounteredDeploymentErrors=!1;Fa.plainTextPayloadSize=0;Fa.shadowWorkbookPayloadSize=0;Fa.htmlPayloadSize=0;Fa.clientSideCopyTime=0;var gb=new Hb.a(this.$.xa),Tb=Fa.sourceItem;Fa.isSelectionAllowed=Wb.a.all(Tb.ranges,function(pc){return Kb.isSelectionAllowed(gb,pc)});Fa.isSelectionAllowed&&this.Cp.r8e(Tb.ranges,
Fa.commandParameters.commandType)};J.prototype.DMa=function(Fa){return this.gridView.Ea.a_()&&ka.i(this.gridView,Fa)};J.prototype.XYi=function(Fa,Kb,gb,Tb){var pc=!1,Xc=1===Kb.commandParameters.commandType,pd=Tb[0].FG;1===gb.ranges.length&&1===Tb.length?vb.EwaSettings.isChangeGateEnabled("OfficeVSO:5593878_PasteCSE_CCPErrorTests1")&&Xc&&1!==pd&&pd!==gb.ranges[0].FG?Fa.cseStatus=17:pc=this.T4g.T6c(Fa,Ba.K(gb.ranges),gb.sheetName,Ba.K(Fa.commandParameters.expandDestinations),this.$.ea.pa.sheetName,
Xc):Fa.cseStatus=5;pc&&ka.g(this.$).si.P0(Fa.commandParameters.stopwatch.id,bc.BasicTelemetryCalculator.KQ);return this.HYi(Fa,gb,Ba.u(this.$.pa.sheetName,null,Tb),Kb.commandParameters.commandType,pc)};J.prototype.isSelectionAllowed=function(Fa,Kb){return Fa.HAb(Kb,this.gridView)};J.prototype.HYi=function(Fa,Kb,gb,Tb,pc){Kb=Ba.u(Kb.sheetName,null,Kb.ranges);Fa.pasteResult="SameSessionPaste";Fa.payloadOrigin=I.DVf;Fa.payloadType=fa.WAg;Ra.ULS.sendTraceTag(537167829,0,50,"BaseRangeCopyPasteHandler.PasteSameSession: trigger PasteRange request. PasteOperationId="+
Fa.commandParameters.id);return this.Cp.pasteRange(Fa.commandParameters.ribbonCommandInfo,Kb,gb,Tb,Fa.commandParameters.commandType,[Fa.commandParameters.stopwatch],Fa,pc,null,null)};Object(V.a)(J,"BaseRangeCopyPasteHandler",N,[]);var xe=b(34);F.prototype.onDeferredPasteStarted=function(Fa){this.AU.kb(Fa.id)||this.AU.add(Fa.id,!0);if(0<this.AU.count){var Kb=sa.GetServiceTaskFactory.Ra(this.$.da,5,4,0);Yb.TaskExtensions.Aa(Kb,function(){Kb.result.Lf(28,null)},this.$.la,3)}};F.prototype.onDeferredPasteCompleted=
function(Fa){var Kb=0<this.AU.count;this.AU.kb(Fa.id)&&this.AU.remove(Fa.id);if(Kb&&!this.AU.count){var gb=sa.GetServiceTaskFactory.Ra(this.$.da,5,4,0);Yb.TaskExtensions.Aa(gb,function(){gb.result.removeEntry(28)},this.$.la,3)}};Object(V.a)(F,"DeferredPasteTracker",null,[]);var Je;(function(Fa){Fa[Fa.none=0]="none";Fa[Fa.loadClipboardFromServerFailed=1]="loadClipboardFromServerFailed";Fa[Fa.loadCopiedDataFromServerFailed=2]="loadCopiedDataFromServerFailed";Fa[Fa.asyncCopyCanceled=3]="asyncCopyCanceled";
Fa[Fa.loadCopiedArtDataFromServerFailed=4]="loadCopiedArtDataFromServerFailed"})(Je||(Je={}));Object(V.b)("CopyErrorType",Je);var we=b(1142),de=b(1325),Le=we.a;$k(H,Le);Object(V.a)(H,"CopyInnerError",we.a,[]);$k(D,J);D.prototype.serialize=function(Fa){var Kb=Fa.sourceItem,gb={},Tb=this.W2c.Gva(Kb);if(Tb)gb.synchronousResult=Tb,Fa.isFromCache=!0,Fa.clientSideCopyTime=Fa.commandParameters.stopwatch.qc;else{var pc=null,Xc=Ba.F(Kb.ranges);if(!Wa.a.jef()&&this.DMa(Xc)){Ra.ULS.sendTraceTag(537167936,0,
50,"AcrossSessionRangeCopyPasteHandler.Serialize: All data is loaded prepare the data in the client side.");Xc=this.clipboardRangeFactory.create(Xc);try{pc=Xc.toString(),Tb=this.H$.create(),Tb.setItem(oa.plainText,pc),this.W2c.setValue(Kb,Tb),gb.synchronousResult=Tb,Fa.clientSideCopyTime=Fa.commandParameters.stopwatch.qc}finally{Xc&&Xc.dispose()}}else Fa.isAsyncCopy=!0,gb.synchronousResult=this.H$.create(),gb.synchronousResult.setItem(oa.plainText,this.lXc);gb.asynchronousResult=this.Add(Fa,Kb,pc)}Fa.syncClipboardItemsKeys=
ha(gb.synchronousResult);return gb};D.prototype.shouldWaitForCopyToComplete=function(Fa){if(!Fa||!Fa.copyContextSnapshot)return Ra.ULS.sendTraceTag(537167907,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: pasteContext or pasteContext.CopyContextSnapshot is not define, return false."),!1;Ra.ULS.shipAssertTag(537167906,0,!!this.$.ya,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: this.EwaControl.BootstrapContext shouldn't be null");if(Fa.copyContextSnapshot.sessionId===
this.$.ya.UserSessionId)return Ra.ULS.sendTraceTag(537167905,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: Same session copy scenario, return false."),!1;Ra.ULS.sendTraceTag(537167904,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0};D.prototype.onDeferredPasteStarted=function(Fa){this.AU.onDeferredPasteStarted(Fa)};D.prototype.onDeferredPasteCompleted=function(Fa){this.AU.onDeferredPasteCompleted(Fa)};D.prototype.deserialize=
function(Fa){Fa.isClipboardDataContainShadowWorkbook=!(void 0===Fa.clipboardItems.getItem(oa.shadowWorkbook)||null===Fa.clipboardItems.getItem(oa.shadowWorkbook));if(ka.g(this.$).ha.Re&326)return Ma(Fa)&&(Fa.wasLastCopyExternal=!0),Promise.reject(new nc.a(17));var Kb=this.Tfg(Fa,!1);if(0!==Kb)return Promise.reject(new nc.a(Ma(Fa)?18:Fa.isSameSession?19:20,void 0,void 0,void 0,Kb));var gb=Fa.copyContextSnapshot,Tb=this.Cp.uwb(gb);if(Ma(Fa))return this.Mpc(Fa);Kb=Fa.commandParameters.originalDestinations;
if(Tb&&Fa.isSameSession)return this.XYi(Fa,gb,Tb,Kb);if(516!==Fa.commandParameters.commandType){Tb=this.hPj(Fa.clipboardItems);gb=Tb.K0;if(Tb.returnValue){Fa.isShadowWorkbookParsedSuccessfully=!0;var pc=Tb=null;vb.EwaSettings.getBooleanFeatureGate(jb.a.t5b,!1)?Tb=Ba.r(Kb,this.$):pc=Ba.v(Ba.K(Kb),this.$);return this.xYi(Fa,pc,Tb,gb)}if(Fa.isClipboardInaccessible)return Promise.reject(new nc.a(8));if(36!==Fa.commandParameters.commandType)return this.wGf(Fa)}return Promise.reject(new nc.a(6))};D.prototype.beforePaste=
function(Fa){this.$.da.za(373).Vlj(Fa);Fa.indicationDisplayScheduled=!0};D.prototype.BOj=function(Fa){if(!(Fa&&Fa.SourceRanges&&Fa.SourceRanges.Ranges&&Fa.SourceRanges.Ranges.length&&(Fa.OriginalSourceRangesCountExceedsLimit||Fa.OriginalSourceMultiRange&&Fa.OriginalSourceMultiRange.Ranges&&Fa.OriginalSourceMultiRange.Ranges.length)))return{returnValue:!1,K0:null};var Kb=Fa.SourceRanges.Ranges[0];if(!Fa.ShadowWorkbookBase64&&!Fa.ShadowWorkbookSizeExceedsLimit)return{returnValue:!1,K0:null};var gb=
this.WEe(Fa);gb.rangeRowStart=Kb.FirstRow;gb.rangeRowEnd=Kb.LastRow;gb.rangeColumnStart=Kb.FirstColumn;gb.rangeColumnEnd=Kb.LastColumn;gb.sourceClientPath=Fa.SourceClientPath;gb.sourceSheetName=Fa.SourceSheetName;gb.sourceWorkbookName=Fa.SourceWorkbookName;if(!Fa.OriginalSourceRangesCountExceedsLimit)for(Fa=Fa.OriginalSourceMultiRange.Ranges,gb.originalSourceRanges=Array(Fa.length),Kb=0;Kb<Fa.length;++Kb)gb.originalSourceRanges[Kb]=[Fa[Kb].FirstRow,Fa[Kb].FirstColumn,Fa[Kb].LastRow,Fa[Kb].LastColumn];
return{returnValue:!0,K0:gb}};D.prototype.hPj=function(Fa){var Kb=null;Fa=Fa.getItem(oa.shadowWorkbook);if(!Fa)return{returnValue:!1,K0:Kb};Kb=JSON.parse(Fa);return{returnValue:this.Mpi(Kb),K0:Kb}};D.prototype.Mpi=function(Fa){return!!Fa&&(!!Fa.shadowWorkbookBase64||Fa.shadowWorkbookSizeExceedsLimit)&&void 0!==Fa.rangeRowStart&&void 0!==Fa.rangeRowEnd&&void 0!==Fa.rangeColumnStart&&void 0!==Fa.rangeColumnEnd};D.prototype.xYi=function(Fa,Kb,gb,Tb){Ra.ULS.shipAssertTag(537167903,0,!!Tb,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadowWorkbookPayload shouldn't be null");
Md.AFrameworkApplication.gN("Microsoft.Office.Excel.Server.Flighting.IDenyListNewCopyPasteExperienceAcrossSessions");Fa.pasteResult="CrossSessionPaste";Fa.payloadOrigin=I.yFe;Fa.payloadType=fa.shadowWorkbook;Fa.shadowWorkbookPayloadSize=G(Tb);Fa.shadowWorkbookSizeExceedsLimit=T(Tb);Tb.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(Fa.originalSourceRangesCountExceedsLimit=Tb.originalSourceRangesCountExceedsLimit);if(Fa.shadowWorkbookSizeExceedsLimit)return Ra.ULS.sendTraceTag(34415003,0,
15,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadow workbook length("+Fa.shadowWorkbookPayloadSize+") is over the limit("+eb.a.jlc+"). reject the paste request. ShadowWorkbookSizeExceedsLimit: "+Tb.shadowWorkbookSizeExceedsLimit),Promise.reject(new nc.a(1));if(1028===Fa.commandParameters.commandType&&Fa.originalSourceRangesCountExceedsLimit)return Ra.ULS.sendTraceTag(572617859,0,15,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: Original source ranges count("+Tb.originalSourceRangesCount+
") is over the limit("+eb.a.oAi+"). Reject the paste request. OriginalSourceRangesCountExceedsLimit: "+Tb.originalSourceRangesCountExceedsLimit),Promise.reject(new nc.a(1));Ra.ULS.sendTraceTag(537167902,0,50,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: trigger Paste request. PasteOperationId="+Fa.commandParameters.id);return this.Cp.BGf(Fa.commandParameters.ribbonCommandInfo,Kb,gb,Tb,[Fa.commandParameters.stopwatch],Fa)};D.prototype.Add=function(Fa,Kb,gb){var Tb=this;Ra.ULS.shipAssertTag(537167901,
0,!!Fa,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: copyContext shouldn't be null");var pc=Fa.commandParameters.stopwatch.qc;return new Promise(function(Xc,pd){Ra.ULS.sendTraceTag(26035421,0,50,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data for copy Id: "+Fa.id);var Uc=Ba.u(Kb.sheetName,null,Kb.ranges);Tb.Cp.copy(Uc,Fa.commandParameters,function(sd){Fa.requestTelemetryData=sd.RequestTelemetryData;Fa.serverRequestTimeInMs=
Fa.commandParameters.stopwatch.qc-pc;if(wb.a.Dg(sd.Errors))wb.a.dha(sd.Errors)?(Fa.encounteredDeploymentErrors=!0,Ra.ULS.sendTraceTag(537167898,0,15,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: "+wb.a.Cc(sd.Errors)+". copy Id: "+Fa.id)):(Ra.ULS.sendTraceTag(26035419,0,10,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: "+wb.a.Cc(sd.Errors)+
". copy Id: "+Fa.id),pd(new H(2,sd.Errors)));else if(Ra.ULS.sendTraceTag(537167900,0,50,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeed for copy Id: "+Fa.id),Fa.markForCancellation)pd(new H(3,sd.Errors));else{sd=sd.Result;var Nb=sd.PlainTextResult;void 0!==gb&&null!==gb&&(Nb=gb);void 0!==Nb&&null!==Nb&&(Fa.plainTextPayloadSize=Nb.length);var Ja=Tb.H$.create(),Lb=Tb.BOj(sd);var ec=Lb.K0;Lb.returnValue&&(Fa.shadowWorkbookPayloadSize=G(ec),Fa.shadowWorkbookSizeExceedsLimit=
T(ec),Fa.originalSourceRangesCountExceedsLimit=sd.OriginalSourceRangesCountExceedsLimit,ec=JSON.stringify(ec),Ja.setItem(oa.shadowWorkbook,ec));Ja.setItem(oa.plainText,Nb);Wa.a.jef()&&(Nb=sd.HtmlResult,Fa.htmlSizeExceedsLimit=sd.HtmlSizeExceedsLimit,void 0!==Nb&&null!==Nb&&(Fa.htmlPayloadSize=Nb.length),Ja.setItem(oa.html,Nb));Fa.copyTotalSizeExceedsLimit=sd.CopyTotalSizeExceedsLimit;Ja.setItem(oa.qrb,Fa.commandParameters.id);Tb.W2c.setValue(Kb,Ja);Fa.asyncClipboardItemsKeys=ha(Ja);Xc(Ja)}},function(sd){Fa.serverRequestTimeInMs=
Fa.commandParameters.stopwatch.qc-pc;sd=hc.a.xf(sd.data);Ra.ULS.sendTraceTag(537167897,0,10,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: "+wb.a.Cc(sd)+". copy Id: "+Fa.id);pd(new H(2,sd))},[Fa.commandParameters.stopwatch])})};Object(V.a)(D,"AcrossSessionRangeCopyPasteHandler",J,[]);Object(V.a)(w,"CopyArtRequest",null,[]);Object(V.a)(y,"PasteArtRequest",null,[]);z.prototype.$4h=function(Fa){if(this.Jli(Fa.QNa)){Ra.ULS.sendTraceTag(537167681,5,
50,"PasteArtRequestManager.HandleRequest: Enqueued paste request as a result of rapid paste on same destination: "+Fa.QNa);var Kb=this.qJb.na(Fa.QNa);this.qJb.ia(Fa.QNa,Fa);var gb=Kb.promise;Kb.Cef=!1;return this.hmh(Fa,gb)}this.qJb.ia(Fa.QNa,Fa);return this.Jsi(Fa)};z.prototype.Jli=function(Fa){return this.qJb.kb(Fa)};z.prototype.Jsi=function(Fa){var Kb=this;return new Promise(function(gb,Tb){Fa.promise=Kb.DZa.vGf(Fa).then(function(pc){gb(null);return Kb.koc(Fa,pc)},function(pc){Tb(null);return Kb.tFb(pc)})})};
z.prototype.hmh=function(Fa,Kb){var gb=this;return new Promise(function(Tb,pc){Fa.promise=Kb.then(function(Xc){gb.nUj(Fa,Xc);return gb.DZa.vGf(Fa).then(function(pd){Tb(null);return gb.koc(Fa,pd)},function(pd){pc(null);return gb.tFb(pd)})},function(Xc){return gb.tFb(Xc)})})};z.prototype.koc=function(Fa,Kb){Fa.Cef&&(this.uZg(Fa.QNa),this.rNd(Fa,Kb));return this.f3i(Kb)};z.prototype.uZg=function(Fa){this.qJb.remove(Fa)};z.prototype.rNd=function(Fa,Kb){var gb=this.ZXh();Fa.QNa===gb&&this.DZa.rNd(Fa.destination,
Kb,Fa.item.type)};z.prototype.ZXh=function(){var Fa=ka.g(this.$).ha.Oa.activeFloatingObjectControlId;Fa||(Fa=Ba.v(ka.g(this.$).ha.sa.activeCell,this.$),Fa=Fa.FirstRow+"_"+Fa.FirstColumn);return Fa};z.prototype.nUj=function(Fa,Kb){Fa.destination=null;Fa.vHe=Kb};Object(V.a)(z,"PasteArtRequestManager",null,[]);var Ie=b(194),jf=b(122),df=b(105);$k(A,N);A.prototype.getSourceItem=function(){Ra.ULS.shipAssertTag(537167896,0,!!this.ha.Oa.activeFloatingObjectControlId,"Expecting a floating object to be currently selected for copy");
Ra.ULS.sendTraceTag(537167895,0,50,"ArtCopyPasteHandler.GetSourceItem: Creating ArtSourceItem with FloatingObjectId=["+this.ha.Oa.activeFloatingObjectControlId+"]");return new ma(this.ha.Oa.activeFloatingObjectControlId,this.$.ea.pa.sheetName,this.$.ea.Ke,this.$.ya.UserSessionId,this.ha.Oa.Yb.floatingObject.type)};A.prototype.beforeSerialize=function(Fa){Fa&&Fa.commandParameters?(Fa?(Fa.isAsyncCopy=!1,Fa.isSelectionAllowed=!1,Fa.isFromCache=!1,Fa.plainTextPayloadSize=0,Fa.shadowWorkbookPayloadSize=
0,Fa.htmlPayloadSize=0,Fa.htmlSizeExceedsLimit=!1,Fa.clientSideCopyTime=0,Fa.encounteredDeploymentErrors=!1,Fa.shadowWorkbookSizeExceedsLimit=!1,Fa.originalSourceRangesCountExceedsLimit=!1,Fa.copyTotalSizeExceedsLimit=!1):Ra.ULS.sendTraceTag(537167826,0,10,"CommonCopyPasteUtils.InitializeCopyContext: copyContext is null."),Fa.commandParameters.copyPasteTargetType=2):Ra.ULS.sendTraceTag(537167894,0,10,"ArtCopyPasteHandler.BeforeSerialize: copyContext or copyContext.CommandParameters is null.")};A.prototype.serialize=
function(Fa){var Kb=Fa.sourceItem,gb={};if(!Kb)return Ra.ULS.sendTraceTag(537167893,0,10,"ArtCopyPasteHandler.Serialize: artSourceItem should not be null"),gb;if(!this.woi())return Ra.ULS.sendTraceTag(36824456,0,50,"ArtCopyPasteHandler.Serialize: Unsupported floating object type. This will clear the clipboard"),gb;Ra.ULS.sendTraceTag(537167892,0,50,"ArtCopyPasteHandler.Serialize: Serializing ArtSourceItem with FloatingObjectId=["+Kb.activeFloatingObjectControlId+"]");this.pEd();var Tb=this.V2c.Gva(Kb);
if(Tb)gb.synchronousResult=Tb,Fa.isFromCache=!0,Fa.isAsyncCopy=!1,Fa.clientSideCopyTime=Fa.commandParameters.stopwatch.qc,1===Fa.commandParameters.commandType&&this.$.Cd(2045211913,Fa.commandParameters.ribbonCommandInfo.method,Fa.commandParameters.ribbonCommandInfo.Ne,null);else{Fa.isFromCache=!1;Fa.isAsyncCopy=!0;Tb=this.H$.create();if(Fa.commandParameters.uploadToClipService){var pc={};pc["data-clipservice-ccpid"]=Fa.commandParameters.id;pc["data-pkey"]=Fa.commandParameters.pKey;pc["data-clipservice-type"]=
Fa.commandParameters.clipServiceDataType;pc["data-clipservice-count"]=Fa.commandParameters.objectCount.toString();pc["data-clipservice-dc"]=Fa.commandParameters.clipServiceDataCenter;pc["data-clipservice-client"]=this.q_g;pc["data-TimeStamp"]=(new Date).toUTCString();pc["data-clipservice-version"]=this.r_g;Tb.setItem(oa.hJg,JSON.stringify(pc))}gb.synchronousResult=this.ECg(Tb);gb.asynchronousResult=this.Add(Fa,Kb,Tb)}Fa.syncClipboardItemsKeys=ha(gb.synchronousResult);return gb};A.prototype.ECg=function(Fa){Ra.ULS.shipAssertTag(537167891,
0,!!this.ha.Oa.Yb,"Expecting a floating object to be currently selected for copy");Fa||(Fa=this.H$.create());var Kb=this.ha.Oa.Yb.Tub();Kb&&Fa.setItem(oa.html,"<img src='"+Kb+"'>");return Fa};A.prototype.pEd=function(){var Fa=this.ha.Oa.Yb;this.Fob.pEd(jf.a.Eqb(Fa.floatingObject),jf.a.t_g(Fa.Qt))};A.prototype.shouldWaitForCopyToComplete=function(){Ra.ULS.sendTraceTag(537167890,0,50,"ArtCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0};A.prototype.onDeferredPasteStarted=function(Fa){this.AU.onDeferredPasteStarted(Fa)};
A.prototype.onDeferredPasteCompleted=function(Fa){this.AU.onDeferredPasteCompleted(Fa)};A.prototype.deserialize=function(Fa){var Kb=Ma(Fa),gb=null,Tb=null,pc=!1;if(!Kb){gb=Fa.copyContextSnapshot;Tb=gb.sourceItem;if(!Tb)return Promise.reject(new nc.a(10));pc=Tb.isFromCurrentSession(this.$)}var Xc=this.Tfg(Fa,!0);if(0!==Xc)return Promise.reject(new nc.a(Kb?18:pc?19:20,void 0,void 0,void 0,Xc));if(Kb)return this.Mpc(Fa);if(!pc&&!A.yhi(Tb))return Fa="User attempted to paste art of type ["+Tb.type+"] between sessions.",
Ra.ULS.sendTraceTag(537167889,0,50,Fa),Promise.reject(new nc.a(11,void 0,void 0,Fa));if(gb.isAsyncSerializeFailed)return Promise.reject(new nc.a(16,void 0,void 0,"Last async serialize failed, therefore no current shadow workbook payload to paste"));try{var pd=Fa.clipboardItems.getItem(oa.shadowWorkbook);var Uc=JSON.parse(pd)}catch(sd){return Ra.ULS.sendTraceTag(537167888,0,10,"ArtCopyPasteHandler.Deserialize: Failed to parse shadow workbook JSON with exception: "+copyPasteInfra.getStringifiedError(sd)),
Promise.reject(new nc.a(12,void 0,sd))}Uc.floatingObjectId!==Tb.activeFloatingObjectControlId?Ra.ULS.sendTraceTag(537167887,0,10,"ArtCopyPasteHandler.Deserialize: FloatingObjectId mismatch! Deserializing with artSourceItem.ActiveFloatingObjectControlId=["+Tb.activeFloatingObjectControlId+"], shadowWorkbookPayload.FloatingObjectId=["+Uc.floatingObjectId+"]"):Ra.ULS.sendTraceTag(537167886,0,50,"ArtCopyPasteHandler.Deserialize: Deserializing with artSourceItem.ActiveFloatingObjectControlId=["+Tb.activeFloatingObjectControlId+
"], shadowWorkbookPayload.FloatingObjectId=["+Uc.floatingObjectId+"]");if(!Uc||!Uc.shadowWorkbookBase64)return Promise.reject(new nc.a(13,void 0,void 0,"shadowWorkbookPayload is null = "+!Uc));Fa.isShadowWorkbookParsedSuccessfully=!0;Fa.shadowWorkbookPayloadSize=G(Uc);Fa.shadowWorkbookSizeExceedsLimit=T(Uc);Fa.payloadOrigin=pc?I.DVf:I.yFe;Fa.payloadType=fa.xjg;if(T(Uc))return Fa="Shadow workbook size ["+Fa.shadowWorkbookPayloadSize+"] is over the limit ["+eb.a.jlc+"]. ShadowWorkbookSizeExceedsLimit: "+
Uc.shadowWorkbookSizeExceedsLimit,Ra.ULS.sendTraceTag(36304156,0,15,"ArtCopyPasteHandler.Deserialize: "+Fa),Promise.reject(new nc.a(1,void 0,void 0,Fa));gb=Kb=null;ka.g(this.$).ha.Re&326?gb=ka.g(this.$).ha.Oa.activeFloatingObjectControlId:Kb=this.$.pa&&this.$.pa.activeCell?Ba.v(this.$.pa.activeCell,this.$):Ba.v(Ba.K(Fa.commandParameters.originalDestinations),this.$);pc=null;if(this.Fob.D2f(Tb))try{pc=this.Fob.T6c()}catch(sd){Ra.ULS.sendTraceTag(537167885,0,10,"ArtCopyPasteHandler.Deserialize: Exception encountered while performing client-side estimation. Exception: "+
copyPasteInfra.getStringifiedError(sd))}return this.yYi.$4h(new y(Fa.commandParameters.ribbonCommandInfo,Kb,gb,Fa.commandParameters.commandType,[Fa.commandParameters.stopwatch],Uc,Tb,Fa,pc))};A.prototype.Mpc=function(Fa){Fa.wasLastCopyExternal=!0;if(Fa.clipboardItems.getItem("image/png")){var Kb=Fa.commandParameters.stopwatch.qc;Fa.payloadType=fa.wPg;var gb={};return ob.b(this.$.Cd(1403967063,Fa.commandParameters.ribbonCommandInfo.method,Fa.commandParameters.ribbonCommandInfo.Ne,(gb.dataUrl=Fa.clipboardItems.getItem("image/png"),
gb))).then(function(Tb){Fa.serverRequestTimeInMs=Fa.commandParameters.stopwatch.qc-Kb;return Tb?Promise.resolve(null):Promise.reject(new nc.a(15))},function(){Fa.serverRequestTimeInMs=Fa.commandParameters.stopwatch.qc-Kb;return Promise.reject(new nc.a(15))})}Ra.ULS.shipAssertTag(537167884,0,!1,"Should not paste external content that is not image via ArtCopyPasteHandler");return N.prototype.Mpc.call(this,Fa)};A.prototype.woi=function(){var Fa=ka.g(this.$).ha;return Fa.Oa.activeFloatingObjectControlId&&
Fa.Oa.Yb&&Fa.Oa.Yb.floatingObject?Fa.Oa.Yb.floatingObject.IUd():!1};A.prototype.Add=function(Fa,Kb,gb){var Tb=this;return new Promise(function(pc,Xc){var pd=Fa.commandParameters.stopwatch.qc;Ra.ULS.sendTraceTag(41562516,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data...");Tb.DZa.L4g(new w(Kb.activeFloatingObjectControlId,Fa.commandParameters,function(Uc){Fa.requestTelemetryData=Uc.RequestTelemetryData;Fa.serverRequestTimeInMs=Fa.commandParameters.stopwatch.qc-
pd;if(wb.a.Dg(Uc.Errors))wb.a.dha(Uc.Errors)?(Fa.encounteredDeploymentErrors=!0,Ra.ULS.sendTraceTag(537167879,0,15,"ArtCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: "+wb.a.Cc(Uc.Errors))):(Ra.ULS.sendTraceTag(36229122,0,10,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: "+wb.a.Cc(Uc.Errors)),Xc(new H(4,Uc.Errors)));else if(Ra.ULS.sendTraceTag(537167883,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeeded for FloatingObjectId=["+
Kb.activeFloatingObjectControlId+"]."),Fa.markForCancellation)Xc(new H(3,Uc.Errors));else{wb.a.Tq(Uc.Errors)&&Ra.ULS.sendTraceTag(537167882,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: Server messages present. Errors: "+wb.a.Cc(Uc.Errors));var sd=Uc.Result;if(sd){sd=Tb.WEe(sd);sd.floatingObjectId=Kb.activeFloatingObjectControlId;Fa.shadowWorkbookPayloadSize=G(sd);Fa.shadowWorkbookSizeExceedsLimit=T(sd);try{var Nb=JSON.stringify(sd)}catch(Ja){Xc(new nc.a(14,void 0,Ja,"Failed to stringify shadow workbook: copyContext.ShadowWorkbookPayloadSize: ["+
Fa.shadowWorkbookPayloadSize+"], shadowWorkbookPayload.FloatingObjectId: ["+sd.floatingObjectId+"]"));return}Ra.ULS.shipAssertTag(537167881,0,!!gb,"Expecting syncClipboardItems to be defined");gb.setItem(oa.shadowWorkbook,Nb);1===Fa.commandParameters.commandType&&(Tb.O0i(Kb.type,Kb.activeFloatingObjectControlId,Uc.StateId),Tb.deleteFloatingObject(Kb.activeFloatingObjectControlId,Kb.type));Tb.V2c.setValue(Kb,gb);Fa.asyncClipboardItemsKeys=ha(gb);pc(gb)}else Ra.ULS.sendTraceTag(537167880,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: Result form server returned null, copied item id: "+
Kb.activeFloatingObjectControlId),pc(Tb.V2c.Gva(Kb))}},Fa.commandParameters.commandType,Kb.type,function(Uc){Fa.serverRequestTimeInMs=Fa.commandParameters.stopwatch.qc-pd;Uc=hc.a.xf(Uc.data);1===Fa.commandParameters.commandType&&Tb.DZa.gQj(Kb.type,Kb.activeFloatingObjectControlId);Ra.ULS.sendTraceTag(537167878,0,10,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: "+wb.a.Cc(Uc));Xc(new H(4,Uc))},[Fa.commandParameters.stopwatch]))})};A.prototype.deleteFloatingObject=
function(Fa,Kb){Fa=Ie.a.$y(Kb,Fa);if(Fa=df.a(this.$).pq(Fa))df.a(this.$).deleteFloatingObject(Fa,14,!0),ka.g(this.$).ha.Oa.pC=null};A.prototype.O0i=function(Fa,Kb,gb){var Tb=this.$.da.za(277);if(Tb){var pc=null;Fa=Ie.a.$y(Fa,Kb);Fa=df.a(this.$).pq(Fa);if(null===Fa||void 0===Fa?0:Fa.Fi)pc=Fa.Fi.block;if(pc){var Xc=Fa.floatingObject.Ig();Tb.pZb(function(){return!pc.Ii.kb(Xc)},gb,"CutArt")}}};A.yhi=function(Fa){return 1===Fa.type||5===Fa.type};Object(V.a)(A,"ArtCopyPasteHandler",N,[]);var Be=b(54);$k(u,
Q);Object(V.a)(u,"MacroRecorderPasteArtPayload",Q,[]);l.prototype.q$h=function(Fa,Kb,gb,Tb,pc,Xc,pd){var Uc=this;Xc=void 0===Xc?null:Xc;pd=void 0===pd?null:pd;var sd=this.$.oa.va.Pb(),Nb=null,Ja={CopyPasteTargetType:2};Ja.FloatingObjectId=Fa;Ja.CopyOperationId=gb.id;gb.floatingObjectType=Kb;Ja.UploadToClipService=gb.uploadToClipService;Ja.PKey=gb.pKey;Ja.ClipServiceDataCenter=gb.clipServiceDataCenter;var Lb=0;2===pc?(pc=505,Lb=16,Nb=function(ec,Zb,Oc){return ea(Uc.$.oa.va,Ja,Jc.b(ec,Tb),Xc?Jc.a(Zb,
Xc):Zb,Oc,gb.ribbonCommandInfo,sd,pd)}):(pc=179,Nb=function(ec,Zb,Oc){Uc.jih(Kb,Fa);Uc.$.py();var td=Uc.$.oa.va;ec=Jc.b(ec,Tb);Zb=Xc?Jc.a(Zb,Xc):Zb;var Gd=gb.ribbonCommandInfo,Pd=pd;Pd=void 0===Pd?null:Pd;var ee=td.Na(1,void 0===sd?null:sd);ee.copyParameters=Ja;return xb.g(td,"Cut",ee,ec,Zb,Oc,Gd,0,Pd)});vb.EwaSettings.Zb()?this.$.userOperationManager.Sb(new ic.a(pc,0,Nb,Lb|64),gb.ribbonCommandInfo):this.$.userOperationManager.Sb(new mb.a(pc,0,Nb,Lb),gb.ribbonCommandInfo)};l.prototype.jih=function(Fa,
Kb){var gb=Ie.a.$y(Fa,Kb);(gb=df.a(this.$).pq(gb))?(ka.g(this.$).ha.Oa.NG(gb),gb.isVisible=!1):Ra.ULS.sendTraceTag(537167876,0,50,"ArtCopyPasteUtils.DoCutClientEstimation: floatingObjectcontrol is null. FloatingObjectType : "+Fa+", FloatingObjectId: "+Kb)};l.prototype.gQj=function(Fa,Kb){Fa=Ie.a.$y(Fa,Kb);if(Fa=df.a(this.$).pq(Fa))Fa.isVisible=!0};l.prototype.L4g=function(Fa){this.q$h(Fa.floatingObjectId,Fa.J4g,Fa.commandParameters,Fa.nt,Fa.och,Fa.Baa,Fa.iPb)};l.prototype.Q$h=function(Fa,Kb,gb,Tb,
pc,Xc,pd,Uc,sd){var Nb=this;Uc=void 0===Uc?null:Uc;sd=void 0===sd?!0:sd;return new Promise(function(Ja,Lb){var ec=Xc.commandParameters.stopwatch.qc;Nb.NNd(Fa,pc,Kb,gb,function(Zb){Xc.requestTelemetryData=Zb.RequestTelemetryData;Xc.serverRequestTimeInMs=Xc.commandParameters.stopwatch.qc-ec;if(wb.a.dha(Zb.Errors))Xc&&(Xc.encounteredDeploymentErrors=!0),Ra.ULS.sendTraceTag(537167875,0,15,"ArtCopyPasteUtils.PasteArt: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: "+
wb.a.Cc(Zb.Errors));else if(wb.a.Dg(Zb.Errors))Ra.ULS.sendTraceTag(36459652,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: "+wb.a.Cc(Zb.Errors)),Lb(new nc.a(9,Zb.Errors));else if(Zb.Result){var Oc=Zb.Result;Ra.ULS.sendTraceTag(537167874,0,50,"ArtCopyPasteUtils.PasteArt: PasteArt succeeded.");Nb.c1i(pd,Oc.FloatingObjectId,Zb.StateId);Ja(l.Mkd(Oc.FloatingObjectId))}else Ra.ULS.sendTraceTag(537167873,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed, result returned from server is null."),
Lb(new nc.a(9,Zb.Errors))},function(Zb){Xc.serverRequestTimeInMs=Xc.commandParameters.stopwatch.qc-ec;Zb=hc.a.xf(Zb.data);Ra.ULS.sendTraceTag(537167872,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: "+wb.a.Cc(Zb));Lb(new nc.a(9,Zb))},Tb,Uc,sd)})};l.prototype.c1i=function(Fa,Kb,gb){var Tb=this,pc=this.$.da.za(277);if(pc){var Xc=Ie.a.$y(Fa,l.Mkd(Kb));pc.pZb(function(){return!!df.a(Tb.$).pq(Xc)},gb,"PasteArt")}};l.prototype.SXd=function(Fa,Kb){Kb&&this.Fob.SXd(Fa,Ie.a.$y(Fa.type,Kb))};l.prototype.vGf=
function(Fa){var Kb=this;return this.Q$h(Fa.ribbonCommandInfo,Fa.destination,Fa.vHe,Fa.iPb,Fa.K0,Fa.pasteContext,Fa.item.type,Fa.jze,Fa.item.isFromCurrentSession(this.$)).then(function(gb){return gb},function(gb){Kb.SXd(Fa.item,Fa.jze);return Promise.reject(gb)})};l.prototype.rNd=function(Fa,Kb,gb){Fa||(Fa=Ba.v(ka.g(this.$).ha.sa.activeCell,this.$));ka.g(this.$).Zhc(Ba.D(Fa),1)?df.a(this.$).nna(gb,Kb,!0):ka.g(this.$).ha.Oa.Hsa(Fa,Kb,gb).continueWith(function(Tb){Tb.result?Ra.ULS.sendTraceTag(537167843,
5,50,"ArtCopyPasteUtils.SelectPastedObject: Selection succeeded in async manner for object ID ["+Kb+"]"):Ra.ULS.sendTraceTag(537167842,5,10,"ArtCopyPasteUtils.SelectPastedObject: Selection failed in async manner for object ID ["+Kb+"]")})};l.prototype.NNd=function(Fa,Kb,gb,Tb,pc,Xc,pd,Uc,sd){function Nb(){if(sd){var Oc=Be.a.Wh(Be.a.xc(Zb));Oc.FloatingObjectId=Kb.floatingObjectId;Zb.DestinationRanges||(Oc.DestinationRanges=Ba.p(Lb.$.xa.pa.sheetName,"",0,0,0,0));return new u(Oc,sd,0,0)}return new u(Zb,
sd,0,0)}function Ja(Oc,td,Gd){Uc||Lb.$.py();return P(Lb.$.oa.va,Zb,Jc.b(Oc,pc),Jc.a(td,Xc),Gd,null,ec,pd)}var Lb=this;sd=void 0===sd?!0:sd;var ec=this.$.oa.va.Pb(),Zb={};Zb.ShadowWorkbookBase64=Kb.shadowWorkbookBase64;Zb.FloatingObjectId=Tb;Zb.DestinationRanges=gb?Ba.s(gb):null;Zb.CopyPasteTargetType=2;Zb.ClientEstimationFloatingObjectId=Uc;gb=vb.EwaSettings.Zb()?new ic.a(503,0,Ja,void 0,Nb):new mb.a(503,0,Ja,void 0,Nb);gb.flags=vb.EwaSettings.Zb()?65:1;this.$.userOperationManager.Sb(gb,Fa)};l.Mkd=
function(Fa){return Fa.length+2+".{"+Fa.toUpperCase()+"}"};Object(V.a)(l,"ArtCopyPasteUtils",null,[720]);var Sd=b(229);x.prototype.pEd=function(Fa,Kb){this.dta=Fa;this.T2c=Kb};x.prototype.T6c=function(){if(!this.dta||!this.T2c)return Ra.ULS.sendTraceTag(537167841,0,15,"ArtPasteClientEstimation.DoPasteClientEstimation: copiedFloatingObjectControl and/or copiedEffectsExtents is null, aborting client side estimation."),"";var Fa=jf.a.Eqb(new Ie.a(this.dta));Fa.Id=l.Mkd(Ab.a.create().toString());Fa.Version=
-1;Fa.Name="";Fa.IsClientEstimation=!0;var Kb=this.dbi(Fa);if(!Kb)return null;var gb=new Ie.a(Fa);Kb.block.Ii.add(gb);gb.vJb();var Tb=df.a(this.$);Tb.J4b(gb,Kb);Kb=Tb.pq(Ie.a.RQh(Fa));!Kb||Kb.floatingObject.oMa||Kb.floatingObject.KMa||Kb.BRa(this.T2c);Tb.nna(Fa.Type,Fa.Id,!0);return Fa.Id};x.prototype.D2f=function(Fa){return vb.EwaSettings.ma(223)&&Fa.isFromCurrentSession(this.$)&&!ka.g(this.$).rtl&&!ka.g(this.$).eb.Ji};x.prototype.SXd=function(Fa,Kb){this.D2f(Fa)&&(Fa=df.a(this.$).pq(Kb))&&(Ra.ULS.sendTraceTag(537167840,
5,50,"ArtPasteClientEstimation.UndoPasteClientEstimation: undoing client-side estimation. Removing floating object with ID: ["+Kb+"] of type ["+Fa.floatingObject.type+"]"),df.a(this.$).deleteFloatingObject(Fa,15,!0),Fa.Fi&&Fa.lbb(Fa.Fi,!1))};x.prototype.dbi=function(Fa){if(!Fa)return Ra.ULS.sendTraceTag(537167839,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: Called with null FloatingObjectData."),null;if(ka.g(this.$).ha.Oa.activeFloatingObjectControlId){var Kb=ka.g(this.$).ha.Oa.pC.floatingObject;
Fa.OriginDeltaX=Kb.offsetX+this.O$a;Fa.OriginDeltaY=Kb.offsetY+this.O$a;Fa.AbsoluteLeft+=this.O$a;Fa.AbsoluteTop+=this.O$a;Fa.AbsoluteRight+=this.O$a;Fa.AbsoluteBottom+=this.O$a;Fa.ZOrder=Kb.zy+1;return ka.g(this.$).ha.Oa.pC.Fi}if(!this.$.pa||!this.$.pa.activeCell)return Ra.ULS.sendTraceTag(537167838,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: ActiveItem/ActiveCell is null - cannot perform estimation for grid paste."),null;var gb=this.$.pa.activeCell;Kb=ka.g(this.$).m1(gb);if(!Kb)return Ra.ULS.sendTraceTag(537167837,
0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: gridViewBlock for range "+gb.toString()+" is null."),null;var Tb=Oa.HelperMethods.fwb(Kb.domElement,Kb.lj.domElement);gb=Kb.gridView.gg(gb,2);if(!Tb||!gb)return Ra.ULS.sendTraceTag(537167836,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: blockPositionRelativeToGridOrigin is null: "+!Tb+". cellPositionRelativeToGridOrigin is null: "+!gb+" ."),null;Fa.OriginDeltaX=gb.topLeft.x-Tb.x;Fa.OriginDeltaY=gb.topLeft.y-Tb.y;Fa.AbsoluteLeft=
gb.topLeft.x;Fa.AbsoluteTop=gb.topLeft.y;Fa.AbsoluteRight=Fa.AbsoluteLeft+Math.abs(this.dta.AbsoluteRight-this.dta.AbsoluteLeft);Fa.AbsoluteBottom=Fa.AbsoluteTop+Math.abs(this.dta.AbsoluteBottom-this.dta.AbsoluteTop);Fa.ZOrder=this.dta.ZOrder+100;return new Sd.a(Kb.gridView.Ea.ml(Kb.hashCode),Kb.hashCode)};Object(V.a)(x,"ArtPasteClientEstimation",null,[719]);m.prototype.create=function(){var Fa=window.clipboardPlatform;return Fa?Fa.createClipboardItems():null};Object(V.a)(m,"ClipboardItemsFactory",
null,[718]);v.undefined="Undefined";Object(V.a)(v,"CCPTelemetryConsts",null,[]);f.cells="Cells";f.floatingObject="FloatingObject";f.unknown="Unknown";Object(V.a)(f,"ActiveSelection",null,[]);n.vhh="DisplayNotInvoked";n.L6c="Displayed";n.m1i="PrerequisitesNotReady";Object(V.a)(n,"PasteIndicationDisplayStatus",null,[]);var vc=b(110);k.prototype.getCopyFlowHandler=function(Fa){var Kb=this.LMh(ka.g(this.$).Re);Fa.commandParameters.copyPasteHandlerName=Kb.name;return Kb};k.prototype.getPasteFlowHandler=
function(Fa){var Kb=Fa.copyContextSnapshot;Kb=Ua(Fa)?this.hXc:Ma(Fa)?this.vGd:(null===Kb||void 0===Kb?0:Kb.sourceItem)&&Object.getType(Kb.sourceItem)===ma?this.hXc:this.vGd;Fa.commandParameters.copyPasteHandlerName=Kb.name;return Kb};k.prototype.initializePasteContext=function(Fa){if(Fa&&(Fa.isSameSession=!1,Fa.isShadowWorkbookParsedSuccessfully=!1,Fa.pasteResult=v.undefined,Fa.payloadOrigin=v.undefined,Fa.payloadType=v.undefined,Fa.encounteredDeploymentErrors=!1,Fa.shadowWorkbookSizeExceedsLimit=
!1,Fa.originalSourceRangesCountExceedsLimit=!1,Fa.activeSelectionType=this.xIh(),Fa.indicationDisplayScheduled=!1,Fa.pasteDestinationHasMergedCells=!1,Fa.pasteIndicationDisplayStatus=n.vhh,Fa.copyContextSnapshot)){var Kb=Fa.copyContextSnapshot,gb=ta(Kb.sourceItem),Tb=Kb.sourceItem;var pc=!!Tb&&Object.getType(Tb)===ma;Tb=0;var Xc=!1;gb?(Xc=Kb.sourceItem,Fa.isSameSession=Xc.isFromCurrentSession(this.$),Tb=1,Xc=this.Kli(Xc,Fa)):pc&&(Fa.isSameSession=Kb.sourceItem.isFromCurrentSession(this.$),Tb=2);if(Fa.copyContextSnapshot.commandParameters){pc=
-1985798686===Kb.commandParameters.ribbonCommandInfo.command;var pd=Fa.commandParameters;var Uc=this.$;Kb?Uc&&Uc.ya?Kb=Kb.sessionId===Uc.ya.UserSessionId:(Ra.ULS.shipAssertTag(537166211,0,!1,"ewaControl shouldn't be null"),Kb=!1):(Ra.ULS.shipAssertTag(537166212,0,!1,"copyContext shouldn't be null"),Kb=!1);pd.clearSystemClipboard=Kb&&pc&&gb&&!Xc;Fa.commandParameters.copyPasteTargetType=Tb}}};k.prototype.getSessionId=function(){return this.$.ya.UserSessionId};k.prototype.Kli=function(Fa,Kb){var gb=
vc.b(Fa.ranges,function(Tb){return Tb.We})&&vc.b(Kb.commandParameters.originalDestinations,function(Tb){return 1!==Tb.top});return vc.b(Fa.ranges,function(Tb){return Tb.isRow})&&vc.b(Kb.commandParameters.originalDestinations,function(Tb){return 1!==Tb.left})||gb};k.prototype.LMh=function(Fa){switch(Fa){case 1:return this.vGd;case 64:case 4:case 2:case 256:return this.hXc;default:throw Error.invalidOperation("Unsupported selection");}};k.prototype.xIh=function(){return ka.g(this.$).ha.Re&470?f.floatingObject:
1===ka.g(this.$).ha.Re?f.cells:f.unknown};k.prototype.getDialogResponse=function(){};of.Object.defineProperties(k.prototype,{vGd:{configurable:!0,enumerable:!0,get:function(){if(!this.tPc){var Fa=this.$.da.za(254,!0);Fa&&(this.tPc=new D(this.$,Fa,new m))}return this.tPc}},hXc:{configurable:!0,enumerable:!0,get:function(){if(!this.nFc&&this.$.da.za(254,!0)){var Fa=new x(this.$);this.nFc=new A(this.$,new m,new l(this.$,Fa),Fa)}return this.nFc}}});Object(V.a)(k,"ExcelCopyPasteApplicationHost",null,[693]);
var qd=b(162),Jd=yb.a;$k(h,Jd);h.prototype.qg=function(Fa){this.Lo=new qd.a;var Kb=oc.a.instance.ga(16);Fa=this.JM(Fa);this.initializeAndShow(Kb,this.$ci,Fa)};h.prototype.JM=function(Fa){var Kb={};return Kb[h.Hu]=this.mc,Kb[h.lni]=Fa,Kb};of.Object.defineProperties(h.prototype,{mc:{configurable:!0,enumerable:!0,get:function(){return"InsertCopiedCutCellsDialog"}}});h.Egh="direction";h.lni="isRtl";var ld={};h.Fgh=(ld.Vertical=1,ld.Horizontal=0,ld);Object(V.a)(h,"InsertCopiedCutCellsDialog",yb.a,[]);
e.prototype.L4b=function(Fa,Kb){return(new h(Fa,Kb)).Lo.task};Object(V.a)(e,"InsertCopiedCutCellsDialogFactory",null,[694]);var Kd=b(87),re=b(47),ie=b(45);d.prototype.zJe=function(){var Fa=this;this.Aqc||(Ra.ULS.sendTraceTag(537167680,0,50,"PasteIndicationManager.DownloadPrerequisitesIfNeeded: Trying to get appChrome"),this.gridView.$.bB(function(Kb){Kb.rja(0).then(function(){Fa.Aqc=!0})}))};d.prototype.Vlj=function(Fa){var Kb=this,gb=Fa.commandParameters.id;Ra.ULS.sendTraceTag(537167651,0,50,"PasteIndicationManager.ScheduleDisplay: pasteCommandId = "+
gb+", cancelCtx is null = "+!this.Ms+", PrerequisitesDownloaded = "+this.Aqc);this.zJe();this.L5b=gb;gb=!this.csf();if(!this.Ms||gb)this.Dwe(),this.Ms=re.a.instance.create(function(){Kb.uhh(Fa)},void 0===Fa.timeoutToShowSpinnerInMs||null===Fa.timeoutToShowSpinnerInMs?100:Fa.timeoutToShowSpinnerInMs,ie.a.DYi);this.s2=Fa.commandParameters.originalDestinations};d.prototype.uhh=function(Fa){this.Aqc?(this.display(Fa.commandParameters.originalDestinations),Fa.pasteIndicationDisplayStatus=n.L6c):(Ra.ULS.sendTraceTag(537167650,
0,50,"PasteIndicationManager.DisplayIfPossible: Prerequisites were not ready, skipping display"),this.hide(),Fa.pasteIndicationDisplayStatus=n.m1i)};d.prototype.display=function(Fa){Ra.ULS.sendTraceTag(537167649,0,50,"PasteIndicationManager.Display: started");this.gridView.qb.Iw(rd.a.W7(wc.d(this.gridView.$.pa),Fa),d.Npc,!0);this.gridView.qb.sn(d.Npc)};d.prototype.Ajd=function(Fa){Ra.ULS.sendTraceTag(537167648,0,50,"PasteIndicationManager.HideForPasteId: pasteCommandId = "+Fa+", currentPasteCommandId = "+
this.L5b);Fa&&Ub.a.equals(Fa,this.L5b,!1)&&this.hide()};d.prototype.hide=function(Fa){this.s2&&(void 0===Fa?0:Fa)&&this.csf()&&Ra.ULS.sendTraceTag(537167647,0,15,"PasteIndicationManager.Hide: Triggered by a SelectionChanged event while indication is (or will be) active but active range did not change");this.L5b="";this.Dwe();this.s2=null;this.gridView.qb.fh(d.Npc);this.gridView.qb.Ti(null,d.Npc)};d.prototype.csf=function(){return Ba.Q(this.gridView.ha.sa.selectedRanges,this.s2)};d.prototype.Dwe=function(){this.Ms&&
(Kd.a.Ia(this.Ms),this.Ms=null)};d.prototype.dispose=function(){this.hide();this.gridView.ha.zF(this.V7e)};d.Npc=[30];Object(V.a)(d,"PasteIndicationManager",null,[692,6]);var ef=b(1195),Fe=b(53),bf=b(921),Oe=pb.a;$k(c,Oe);c.prototype.create=function(){var Fa=this,Kb=Fe.a.aR([73,74],4,this.hb,void 0,void 0,void 0,c.sna),gb=sa.GetServiceTaskFactory.create(this.$.da,18,this.$.la,this.hb);Yb.TaskExtensions.Aa(Yb.TaskExtensions.Vd([gb,Kb],this.la),function(){var Tb=new ef.a,pc=null;Fa.m2g(Tb).then(function(Xc){pc=
Xc.nze;var pd=copyPasteInfra.createCopyPasteInfra(pc,new k(Fa.$),Tb,Fa.$);Ra.ULS.shipAssertTag(537167762,0,!!Fa.$.ya,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext should not be null");Ra.ULS.shipAssertTag(537167761,0,!!Fa.$.ya&&!!Fa.$.ya.DocumentHostInfo,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext.DocumentHostInfo should not be null");var Uc=pc.getMetadataManager(),sd=Object(bf.b)(Fa.$.da,254,function(){return new Z(Fa.$,Uc,gb.result,pd,new L(Fa.$,
ka.g(Fa.$)),new e,Fa.$.ya.DocumentHostInfo.UserId,pc.getInitializationError())});Fa.pb(sd);Xc.a0a?Ra.ULS.sendTraceTag(41731933,0,50,"CopyPasteInfrastructureFactory.Create: Initialize CCP infra succeed. SliceName="+Z.yac()+", StrategyType="+Xc.a0a.dataClipboardStrategyType+", StrategyCapabilities="+JSON.stringify(Xc.a0a.dataClipboardCapabilities)+", IsBestStrategyTypeInitialized="+(Xc.a0a.clipboardStrategiesToInitialize[0].clipboardStrategyType===Xc.a0a.dataClipboardStrategyType)+", InfraLoadTimeMS="+
(void 0===window.bsqmXLSPageLoadStartTime||null===window.bsqmXLSPageLoadStartTime?"-1":(Date.now()-window.bsqmXLSPageLoadStartTime.getTime()).toString())):Ra.ULS.shipAssertTag(537167760,0,!1,"CopyPasteInfrastructureFactory.Create: initResult.ClipboardPlatformEnvironmentInitializationInfo should not be null")},function(Xc){Ra.ULS.shipAssertTag(38847436,0,!1,"CopyPasteInfrastructureFactory.Create: error during call to clipboardPlatformEnvironment.Init(). Copy Paste operations will not be available in this session. SliceName: "+
Z.yac()+" error: "+(Xc?copyPasteInfra.getStringifiedError(Xc):"null"))})},this.la,3)};c.prototype.dispose=function(){Oe.prototype.dispose.call(this)};c.prototype.m2g=function(Fa){var Kb=null,gb=window.clipboardPlatform;gb&&(Kb=gb.getClipboardPlatformEnvironment());if(!Kb)return Ra.ULS.shipAssertTag(537167759,0,!1,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: getClipboardPlatformEnvironment should have returned a valid object"),Promise.reject(null);gb=this.$.ya;var Tb=[gb.OfficeOnlineChromeExtensionId,
gb.ChromeClipboardAccessExtensionId],pc=this.Fm.Xa(5),Xc=this.$.pe.get(57),pd=!Xc&&this.$.pe.get(5),Uc=this.$.ea.ic;Uc&&(Uc.inWebPart||Uc.inViewerFromWebPart||Uc.isDivSyndicated)&&(pd=!1);Xc=this.JLh(pd,!Xc);Ra.ULS.shipAssertTag(537167758,0,!!gb.DocumentHostInfo,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: bootstrapContext.DocumentHostInfo should not be null");return Kb.init(this.$,Fa,Tb,gb.SharedClipboardHostingApp,gb.SharedClipboardHostingApps,gb.SharedClipboardHostingEnvironments,
gb.SharedClipboardOverrideOrigin,gb.SharedClipboardSchemaVersion,gb.SharedClipboardExpirationInMinutes,gb.ClipboardPromiseTimeoutInMinutes,pc,gb.MachineCluster,new K(this.$),Xc,gb.DocumentHostInfo.UserId,gb.ClipboardTtlInMS,vb.EwaSettings.ma(311),gb.UserSessionId).then(function(sd){return Object(La.a)(new xa,{nze:Kb,a0a:sd})},function(sd){return Promise.reject(sd)})};c.prototype.JLh=function(Fa,Kb){var gb=[];Fa&&Kb&&gb.push(this.Oah());Kb&&(gb.push(this.y4c(7)),gb.push(this.y4c(0)));Fa&&gb.push(this.cEe());
gb.push({clipboardStrategyType:4});Ra.ULS.sendTraceTag(39978242,0,50,"CopyPasteInfrastructureFactory.GetClipboardStrategiesInitList: create clipboard stratgy initialization list: isBrowserStorageAllowed="+Fa+", isSystemClipboardAllowed="+Kb+", result = "+(gb?gb.join(","):"[]"));return gb};c.prototype.cEe=function(){var Fa=this.$.ya,Kb={clipboardStrategyType:5};Kb.sessionId=Fa.UserSessionId;Kb.useSharedClipboardIframe=!0;Kb.sharedClipboardHostingApp=Fa.SharedClipboardHostingApp;Kb.sharedClipboardHostingApps=
Fa.SharedClipboardHostingApps;Kb.sharedClipboardHostingEnvironments=Fa.SharedClipboardHostingEnvironments;Kb.sharedClipboardOverrideOrigin=Fa.SharedClipboardOverrideOrigin;Kb.sharedClipboardSchemaVersion=Fa.SharedClipboardSchemaVersion;Kb.sharedClipboardExpirationInMinutes=Fa.SharedClipboardExpirationInMinutes;Kb.wacCluster=Fa.MachineCluster;return Kb};c.prototype.Oah=function(){var Fa={clipboardStrategyType:6};Fa.localStorageStrategyParameters=this.cEe();Fa.systemClipboardStrategyParameters=this.y4c(0);
return Fa};c.prototype.y4c=function(Fa){var Kb={};Kb.clipboardStrategyType=Fa;Kb.skipFilesIfPlainTextExists=!0;return Kb};c.ka=function(Fa){Fa.da.Ga(373,new d(Fa));Fa.da.Ga(c.sna,new c(Fa))};c.sna=255;Object(V.a)(c,"CopyPasteInfrastructureFactory",pb.a,[]);var lc=b(10);b.d(E,"a",function(){return a})},1360:function(t,E,b){function a(){Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");c.main()}function c(){this.fb=null}function d(bb,ba){if(void 0===bb||
null===bb||void 0===ba||null===ba)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.jb=bb;this.Qg=ba;this.RQc=this.he=null}function e(){this.tJe=this.tfg=this.Nt=0;this.uJe=this.ufg=this.HHa="";this.zRc=this.Hea=2}function h(bb,ba){this.oGc=0;this.k3b=null;this.jjb=new u(bb,ba);this.jb=bb;ba=bb.Wa("HostAuthType");this.xEa=bb.qa("OcpsIsEnabled")&&bb.qa("IsO365CommercialHost")&&!(void 0===ba||null===ba)&&"aad"===ba.toLowerCase();this.pce=I.b(bb.Wa("OcpsDefaultSettings")||"{}");
this.Zjb=this.Kbc();ba=this.jb.Zn("ServicesControlsMicrosoftControllerServicesList")?this.jb.fw("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.dSb=new K.a;for(var fa=0;fa<ba.length;fa++)this.dSb.add(ba[fa]);this.xEa&&!bb.qa("IsAnonymousUser")&&bb.qa("SideCarIsEnabled")?this.k3b=this.ZOj():this.k3b=this.Boa(this.xEa,this.hva("/afhs/CloudPolicySettings.ashx"),Object(D.a)(this,this.RXi,"parseCloudPolicySettingsResponse"));this.k3b.then(function(){return null}).catch(function(ra){z.ULS.sendTraceTag(50622685,
3004,10,JSON.stringify(ra))})}function k(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}function n(){}function f(bb,ba){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=bb.PolicySettings;bb=new Date;bb.setMinutes(bb.getMinutes()+ba);this.ExpirationTime=bb.getTime()}function v(bb,ba,fa,ra,pa){var Za=this;fa=void 0===fa?null:fa;ra=void 0===ra?null:ra;pa=void 0===pa?null:pa;this.xua=this.sWb=this.Vee=this.zqa=this.vXb=null;this.jjb=new u(bb,ba);this.jb=bb;this.btg=
bb.kd("LicensingMaxRetryAttempts",0);this.sLc=bb.qa("IsO365ConsumerHost");this.rLc=bb.qa("IsO365CommercialHost");this.bUb=bb.qa("PremiumUpsellIsEnabled");this.D3d=fa;this.eje=ra;this.La=pa;this.yqa=bb.qa("LicensingIsEnabled");this.xEa=bb.qa("OcpsIsEnabled")&&this.rLc;this.PSc=bb.qa("ShowPrivacyDialog")&&!!ra;this.L8d=bb.qa("IsAnonymousUser");this.O$c=new Promise(function(Ua){Ua(!1)});this.FBa=new Promise(function(Ua){Ua(!0)});this.wua=new y.a(w.a.Jk());this.gYb=this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SupportUserConsentBasedFeaturesInAFH",
!1);this.lae=this.zSh();this.npd()&&!this.L8d?(void 0!==N.AFrameworkApplication.ta&&null!==N.AFrameworkApplication.ta&&(this.vXb=N.AFrameworkApplication.ta.sD,void 0!==this.vXb&&null!==this.vXb&&(this.zqa=this.vXb.Mg("WebServiceCall","ApplicationFeatureHelperService"))),this.xua=this.zXd()):this.xua=new Promise(function(Ua){Ua({})});this.xua.catch(function(Ua){z.ULS.sendTraceTag(42513088,3004,10,JSON.stringify(Ua))});this.gYb&&(this.bUb=!1,this.isFeatureEnabled("FreemiumUpsell",!0).then(function(Ua){Za.bUb=
Za.jb.qa("PremiumUpsellIsEnabled")&&Ua;return null}))}function m(bb,ba,fa){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=bb;this.isEnabled=ba;this.tierName=fa}function x(bb,ba){this.gMj=3E5;if(void 0===bb||null===bb||void 0===ba||null===ba)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.jb=bb;this.$Qb=new y.a(w.a.Jk());this.jjb=new u(bb,ba);void 0!==G.a.Nud&&null!==G.a.Nud&&void 0!==G.a.Gkc&&null!==G.a.Gkc&&0<G.a.Gkc&&(bb=new l,bb.Token=G.a.Nud,
bb.ExpirationTime=G.a.Gkc,this.$Qb.ia("loki",bb))}function l(){this.Token=null;this.ExpirationTime=0}function u(bb,ba){this.jb=bb;this.Qg=ba}function A(){this.message=null;this.Bec=0}t=b(0);var z=b(15),y=b(904),w=b(625),D=b(84),H=b(85),F;(function(bb){bb[bb.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";bb[bb.cloudPolicySettings=1]="cloudPolicySettings";bb[bb.alternateAuthToken=2]="alternateAuthToken"})(F||(F={}));Object(t.b)("ApplicationFeatureHelperRequestType",F);Object(t.a)(A,
"HttpRequstToPromiseRejectData",null,[]);var J=b(99),S=b(250);u.prototype.O3c=function(bb,ba,fa,ra,pa,Za,Ua,Ma){var oa=this;ra=void 0===ra?null:ra;pa=void 0===pa?null:pa;Za=void 0===Za?null:Za;Ua=void 0===Ua?null:Ua;Ma=void 0===Ma?null:Ma;var ja=F[fa],ta=ja+"RequestFailure";J.Health.instance.recordKpiUsage(ta,0,"jpittsdirects",null);return new Promise(function(aa,ma){z.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",ja);var Ea=
null!=Ua?Ua:oa.jb.kd("ApplicationFeatureHelperRequestQueueTimeout",15E3),Ha=null!=Ma?Ma:oa.jb.kd("ApplicationFeatureHelperRequestSentTimeout",3E4);oa.Qg.P9(bb,1,null,oa.bRh(fa,ra),Za,!1,1,function(Aa){z.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",ja);try{if(void 0===Aa||null===Aa||void 0===Aa.data||null===Aa.data||void 0===Aa.data.Rd||null===Aa.data.Rd){J.Health.instance.recordKpiFailure(ta,"Invalid RequestSucceededEventArgs",
!1,!0,null);var V=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",ja);ma(oa.vwb(V,Aa))}else if(Aa.data.httpStatus!==S.a.QO){J.Health.instance.recordKpiFailure(ta,"HttpStatusCode_"+Aa.data.httpStatus.toString(),!1,!0,null);var La=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",
Aa.data.httpStatus,ja);ma(oa.vwb(La,Aa))}else{void 0!==pa&&null!==pa&&void 0!==Aa.data.responseHeaders&&null!==Aa.data.responseHeaders&&pa(Aa.data.responseHeaders);var Ra=ba(Aa.data.Rd);if(Ra)z.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",ja),aa(Ra);else{J.Health.instance.recordKpiFailure(ta,"Parse Failure",!1,!0,null);var pb=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",
ja);ma(oa.vwb(pb,Aa))}}}catch(cb){J.Health.instance.recordKpiFailure(ta,"Unexpected Failure",!1,!0,null),V=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",cb,ja),ma(oa.vwb(V,Aa))}},function(Aa){z.ULS.sendTraceTag(50622691,3004,10,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} failed.",ja);if(Aa.data){J.Health.instance.recordKpiFailure(ta,"HttpStatusCode_"+Aa.data.httpStatus.toString(),!1,!0,null);var V=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",
Aa.data.httpStatus,Aa.data.Rd||"No Data",ja)}else J.Health.instance.recordKpiFailure(ta,"Invalid RequestFailedEventArgs",!1,!0,null),V=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",ja);ma(oa.vwb(V,Aa))},null,void 0,void 0,Ea,Ha)})};u.prototype.vwb=function(bb,ba){var fa=new A;fa.message=bb;fa.Bec=ba&&ba.data?ba.data.httpStatus:-1;return fa};u.prototype.bRh=function(bb,ba){var fa={};fa["x-UserDataSignature"]=this.jb.Wa("UserDataSignature");
fa["x-LicensingIsEnabled"]=this.jb.qa("LicensingIsEnabled").toString();fa["x-CacheIsEnabled"]=this.jb.qa("LicensingRedisIsEnabled").toString();fa["x-OcpsIsEnabled"]=this.jb.qa("OcpsIsEnabled").toString();fa["x-LicensingAADIdIsEnabled"]=this.jb.qa("LicensingAadIdIsEnabled").toString();0===bb&&(fa["x-LicenseCheckOnTenantEnabled"]=this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksLicenseCheck",!1).toString(),fa["x-SupportUserConsentDependentFeatures"]=this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SupportUserConsentBasedFeaturesInAFH",
!1).toString(),fa["x-AFHUserConsentGroupValue"]=this.jb.getIntFeatureGate("Microsoft.Office.SharedOnline.AFHUserConsentGroupValue",0).toString(),fa["x-UseShellServiceForUserConsentGroup"]=this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseShellServiceForUserConsentGroup",!1).toString(),fa["x-SMBUserLicensingEnabled"]=this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SMBUserLicensingEnabled",!1).toString());if(ba){bb=ik(ba.keys);for(var ra=bb.next();!ra.done;ra=bb.next())ra=
ra.value,fa[ra]=ba.na(ra)}return fa};Object(t.a)(u,"HttpRequestToPromiseUtility",null,[]);var N=b(4),T;(function(bb){bb[bb.loki=0]="loki";bb[bb.augloopACLP=1]="augloopACLP"})(T||(T={}));Object(t.b)("AlternateAuthSupportApp",T);var G=b(953),I=b(42);Object(t.a)(l,"WacAlternateAuthToken",null,[]);x.prototype.jJh=function(){var bb=null;this.$Qb.kb(T[0])&&(bb=this.$Qb.na(T[0]));return void 0===bb||null===bb||this.ird(bb)?this.Vzh():Promise.resolve(bb.Token)};x.prototype.ird=function(bb){return bb.ExpirationTime-
Date.now()<this.gMj};x.prototype.Vzh=function(){var bb=this,ba=new y.a(w.a.Jk());ba.ia("X-AlternateAuthApp",T[0]);return this.jjb.O3c(this.hva("/afhs/AlternateAuthHelperHandler.ashx"),Object(D.a)(this,this.NXi,"parseAlternateAuthTokenResponse"),2,ba).then(function(fa){z.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",T[0]);bb.$Qb.ia(T[0],fa);return fa.Token},function(fa){fa=Object(H.a)(A,fa);z.ULS.sendTraceTag(545604827,
3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",fa.message,fa.Bec);return null})};x.prototype.NXi=function(bb){var ba=I.d(bb).Ot;z.ULS.sendTraceTag(545821457,3004,ba?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",bb);return ba};x.prototype.hva=function(bb){return String.format("{0}{1}?{2}",this.jb.Wa("WebServiceBase"),bb,N.AFrameworkApplication.Yi)};Object(t.a)(x,"AlternateAuthHelper",null,[514]);var K=b(498);Object(t.a)(m,
"FeatureStateChangeArgs",null,[]);var L=b(136),O=b(263),B=b(27),Q=b(113),U=b(178),X;(function(bb){bb[bb.Enabled=0]="Enabled";bb[bb.Disabled=1]="Disabled"})(X||(X={}));Object(t.b)("FeatureState",X);var P=b(83),ea=b(25),ia=b(193);v.prototype.zSh=function(){for(var bb=this.jb.Zn("AllLicensedFeatures")?this.jb.fw("AllLicensedFeatures"):[],ba=new K.a,fa=0;fa<bb.length;fa++)ba.add(bb[fa]);return ba};v.prototype.npd=function(){return this.rLc||this.sLc};v.prototype.zXd=function(bb,ba){var fa=this;bb=void 0===
bb?0:bb;ba=void 0===ba?!1:ba;z.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",ba);var ra=L.a.Er();ra&&(ra.set("retryAttempt",bb.toString()),ra.set("forceRefresh",ba.toString()),ra.set("isO365ConsumerHost",this.sLc.toString()),ra.set("isO365CommercialHost",this.rLc.toString()),ra.set("isFreemiumUpsellEnabled",this.bUb.toString()));J.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",ra);J.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",
1,"waclicensing",ra);void 0!==this.zqa&&null!==this.zqa&&this.zqa.start();var pa=null;ba&&(pa=new y.a(w.a.Jk()),pa.ia("x-LicensingForceRefresh","true"));this.Vee=new Date;return(this.yqa?this.jjb.O3c(this.hva("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(D.a)(this,this.QXi,"parseApplicationFeatureHelperResponse"),0,pa,Object(D.a)(this,this.i2i,"processApplicationFeatureHelperResponseHeaders"),["Date"]):Promise.resolve({})).then(function(Za){var Ua=Object.assign(new ia.a,{durationMs:fa.S6f()});
Ua.extendedProperties=ra;Ua.extendedProperties&&Za&&(Ua.extendedProperties.set("featureCount",Q.a.count(Za).toString()),Ua.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in Za).toString()),Ua.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in Za).toString()),fa.sWb&&Ua.extendedProperties.set("fromCache",(fa.sWb<fa.Vee).toString()));J.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",Ua);return Za},function(Za){var Ua=Object.assign(new ia.a,
{durationMs:fa.S6f()}),Ma=Object(H.a)(A,Za);if(!Ma)return z.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),J.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,Ua),new Promise(function(oa,ja){ja(Za)});Ua.extendedProperties=ra;Ua.extendedProperties&&Ua.extendedProperties.set("status",Ma.Bec.toString());J.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest",
"RequestFailed",!1,!0,Ua);return 408===Ma.Bec&&++bb<=fa.btg?fa.zXd(bb):new Promise(function(oa,ja){ja(Ma)})})};v.prototype.QXi=function(bb){(bb=I.b(bb))?(z.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),z.ULS.sendTraceTag(50938594,3004,50,"{0}",bb)):z.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");return bb.Features};v.prototype.hva=function(bb){var ba=
String.format("{0}{1}",this.jb.Wa("WebServiceBase"),bb);this.jb.Zn("ApplicationFeatureHelperHttpCachingEnabled")&&this.jb.qa("ApplicationFeatureHelperHttpCachingEnabled")&&(bb=v.Kbc(this.jb))&&0<bb.length&&(this.gYb&&(bb+="ucbf"),ba=new O.QueryStringBuilder(ba),ba.Ei("afhskey",bb),ba=ba.toString());return ba};v.prototype.isFeatureEnabled=function(bb,ba){var fa=this;if(!this.xEa&&!this.PSc&&!this.yqa)return this.FBa;z.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",
bb);if("ConnectedServices"===bb){var ra=this.xEa?this.D3d.NJ("ControllerConnectedServicesEnabled"):this.FBa,pa=this.PSc?this.eje.getSettings().then(function(Ma){return 2!==Ma.Nt},function(){return ba}):this.FBa;return ra.then(function(Ma){return Ma?pa:fa.O$c})}ra=null;ra=this.xEa?this.D3d.isFeatureEnabled(bb):this.FBa;var Za=null;Za=this.yqa?this.Gii(bb,ba):this.FBa;var Ua=null;Ua=this.PSc?this.eje.isFeatureEnabled(bb):this.FBa;return ra.then(function(Ma){return Ma?Ua.then(function(oa){return oa?
Za:fa.O$c}):fa.O$c}).then(function(Ma){fa.gmf(bb,Ma,!0);return Ma},function(){fa.gmf(bb,ba,!1);return ba})};v.prototype.gmf=function(bb,ba,fa){z.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",bb,ba,fa)};v.prototype.getFeatureTier=function(bb,ba){var fa=this;if(!this.yqa)return new Promise(function(ra){ra(2)});z.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",bb);return this.xua.then(function(ra){return fa.Icc(bb,
ra,ba)},function(){return ba})};v.prototype.isFreemiumUpsellEnabled=function(){return this.bUb&&this.sLc&&!this.L8d};v.prototype.launchUpsellExperience=function(bb,ba){ba=void 0===ba?null:ba;z.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",bb));var fa=L.a.Er();fa&&(fa.set("experienceId",bb),ba&&fa.set("campaignId",ba));J.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",fa);
if(fa=P.a.instance.nh("Common.IInProductMessagingUIManager")){var ra=Object(D.a)(this,this.m3h,"handleDimeTaskComplete");fa.rkf(bb,ra,ba)}else z.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),J.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),ba={},this.La.$d(ea.a.S$b,2,(ba.experience=bb,ba))};v.prototype.Lma=function(bb,ba){if(!this.yqa)return null;if(!bb||!ba)return z.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),
null;var fa=U.a.create().toString();this.wua.kb(bb)||this.wua.ia(bb,new y.a(w.a.Jk()));this.wua.na(bb).add(fa,ba);z.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",fa,bb));return fa};v.prototype.BId=function(bb,ba){this.yqa&&(bb&&this.wua.kb(bb)?ba&&U.a.isValid(ba)?this.wua.na(bb).kb(ba)?(z.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",
ba,bb)),this.wua.na(bb).remove(ba)):z.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",ba,bb)):z.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",ba,bb)):z.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",
bb)))};v.prototype.Icc=function(bb,ba,fa){return this.gYb?bb in ba?ba[bb].LicenseTier:fa:bb in ba?this.nYi(ba[bb],fa):fa};v.prototype.nYi=function(bb,ba){switch(bb.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return ba}};v.prototype.m3h=function(){var bb=this;z.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.xua.then(function(ba){bb.WNf(ba)}).catch(function(){bb.WNf({})})};v.prototype.WNf=function(bb){var ba=
this;z.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");var fa=this.zXd(0,!0);fa.then(function(ra){ba.xua=fa;Q.a.count(ra)>Q.a.count(bb)?J.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):J.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(var pa=ik(ba.wua.keys),Za=pa.next();!Za.done;Za=pa.next())if(Za=Za.value,Za in ra){var Ua=ba.Icc(Za,ra,0);Za in bb?ba.Icc(Za,bb,0)!==Ua&&ba.tyd(Za,
!0,Ua):ba.tyd(Za,!0,Ua)}else Za in bb&&ba.tyd(Za,!1,ba.Icc(Za,bb,0))}).catch(function(ra){J.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);z.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(ra))})};v.prototype.tyd=function(bb,ba,fa){z.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",bb,ba,fa);ba=new m(bb,ba,fa);fa=this.wua.na(bb);fa=ik(fa);for(var ra=
fa.next();!ra.done;ra=fa.next()){ra=ra.value;try{ra.value(ba)}catch(pa){z.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",bb,ra.key,pa.message))}}};v.prototype.Ud=function(bb,ba){var fa=this;if(this.yqa){var ra=this.lae.contains(bb),pa=!0,Za="",Ua=!1;return this.xua.then(function(Ma){bb in Ma?(Ma=Ma[bb],Za=X[Ma.FeatureState],pa=1!==Ma.FeatureState):pa=!ra;
fa.qmf(bb,ra,Za,Ua,ba,pa);return pa},function(){Ua=!0;ra&&(pa=ba);fa.qmf(bb,ra,Za,Ua,ba,pa);return pa})}return this.FBa};v.prototype.qmf=function(bb,ba,fa,ra,pa,Za){z.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",bb,ba,ra,fa,pa,Za)};v.prototype.Gii=function(bb,ba){if(this.gYb)return this.Ud(bb,ba);if(this.yqa){if(this.lae.contains(bb))return this.xua.then(function(fa){return bb in fa},
function(){return ba});z.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",bb)}return this.FBa};v.prototype.i2i=function(bb){try{bb&&"Date"in bb&&(this.sWb=new Date(bb.Date),z.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.sWb.toString()))}catch(ba){z.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",
ba)}};v.prototype.S6f=function(){if(void 0!==this.zqa&&null!==this.zqa){var bb=this.zqa.qc;this.zqa.stop();return bb}return null};v.Kbc=function(bb){try{if(B.a.qIj){var ba=bb.Wa("UserDataSignature").split(".");if(1<ba.length){var fa=window.self.atob(ba[1]),ra=JSON.parse(fa).LocalStorageKey;if(void 0!==ra&&null!==ra&&0<ra.length)return ra}}}catch(pa){z.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",pa.toString())}return null};Object(t.a)(v,"ApplicationFeatureHelper",null,
[515]);var da=b(192);Object(t.a)(f,"CloudPolicySettingsCacheData",null,[]);var xa=b(1037),Z=b(397),ha=b(239);n.Z4f=function(){return N.AFrameworkApplication.fa.qa("SideCarIsEnabled")?n.$uc&&n.Gnd?new Promise(function(bb){bb(!0)}):new Promise(function(bb,ba){n.$uc=ha.a.create(N.AFrameworkApplication.fa.Wa("SideCarUrl"));Z.a.Bia(n.$uc);n.$uc.T9(function(fa,ra){(n.Gnd=ra.succeeded)?bb(ra.succeeded):ba(ra.succeeded)})}):new Promise(function(bb){bb(!1)})};n.Gnd=!1;n.$uc=null;Object(t.a)(n,"SideCarLoader",
null,[]);Object(t.a)(k,"CloudPolicySettingsData",null,[]);h.prototype.NJ=function(bb,ba){ba=void 0===ba?!0:ba;if(!this.xEa){var fa=this;return new Promise(function(Ua){Ua(fa.ewb(bb))})}var ra=this,pa=this,Za=this.k3b.then(function(Ua){try{var Ma=null;Ua.PolicySettings&&"unknown"in Ua.PolicySettings&&(Ma=Ua.PolicySettings.unknown);if(Ma){if(bb in Ma&&void 0!==Ma[bb]&&null!==Ma[bb])return new Promise(function(ja){ja("0"!==Ma[bb])});var oa=bb.toLowerCase();if(oa in Ma&&void 0!==Ma[oa]&&null!==Ma[oa])return new Promise(function(ja){ja("0"!==
Ma[oa])});z.ULS.sendTraceTag(51512667,3004,50,"Policy"+bb+" not found, using default");return new Promise(function(ja){ja(ra.ewb(bb))})}return new Promise(function(ja){ja(ra.ewb(bb))})}catch(ja){return z.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+bb+" policy value. Error Message: {0}",ja.message),ra.handleError(ja.toString(),ba,ra.ewb(bb))}},function(Ua){return pa.handleError(Ua,ba,pa.ewb(bb))});Za.then(function(Ua){z.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",
bb,Ua);return null});return Za};h.prototype.isFeatureEnabled=function(bb,ba){ba=void 0===ba?!0:ba;if(this.jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.Iii(bb,ba);var fa=new Promise(function(pa){pa(!0)}),ra="";this.dSb.contains(bb)&&(ra="ControllerConnectedServicesEnabled",fa=this.NJ(ra,ba));fa.then(function(pa){z.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",
bb,pa,ra);return null});return fa};h.prototype.Iii=function(bb,ba){ba=void 0===ba?!0:ba;var fa=new Promise(function(pa){pa(!0)}),ra="";"mso_sendASmile"===bb?ra="Enabled":"Survey"===bb||"FloodgateSurvey"===bb?ra="SurveyEnabled":this.dSb.contains(bb)&&(ra="ControllerConnectedServicesEnabled");""!==ra&&(fa=this.NJ(ra,ba));fa.then(function(pa){z.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",bb,pa,ra);return null});
return fa};h.prototype.handleError=function(bb,ba,fa){return ba?new Promise(function(ra){ra(fa)}):new Promise(function(ra,pa){pa(bb)})};h.prototype.Boa=function(bb,ba,fa){var ra=this;if(!bb)return Promise.resolve(new k);var pa=!1,Za=null;J.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);var Ua=this.l3c("GetCloudPolicySettings");return(new Promise(function(Ma,oa){if(void 0!==ra.Zjb&&null!==ra.Zjb&&0<ra.Zjb.length){var ja=ra.JOj();if(void 0!==ja&&null!==ja){pa=!0;Ma(ja);
return}}ra.jjb.O3c(ba,fa,1,null,Object(D.a)(ra,ra.m2i,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],ra.jb.kd("CloudPolicySettingsRequestQueueTimeout",15E3),ra.jb.kd("CloudPolicySettingsRequestSentTimeout",3E4)).then(function(ta){z.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");ra.yPj(ta);Ma(ta);return ta},function(ta){oa(ta);return null})})).then(function(Ma){var oa=ra.Vyc(Ua);Ua=oa.stopwatch;Za=oa.returnValue;(oa=L.a.Er())&&oa.set("FromCache",
pa.toString());oa=Object.assign(new ia.a,{durationMs:Za,extendedProperties:oa});J.Health.instance.recordKpiSuccess("GetCloudPolicySettings",oa);return Ma})};h.prototype.ZOj=function(){return n.Z4f().then(function(){z.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})};h.prototype.hva=function(bb){return String.format("{0}{1}",this.jb.Wa("WebServiceBase"),bb)};h.prototype.RXi=
function(bb){var ba=I.d(bb).Ot;z.ULS.sendTraceTag(50622687,3004,ba?50:10,"ParseCloudPolicySettingsResponse: fetched CloudPolicySettingsData from {0}",bb);return ba};h.prototype.m2i=function(bb){try{if(void 0!==bb&&null!==bb&&"CheckIn-Interval"in bb){var ba=parseInt(bb["CheckIn-Interval"]);void 0!==ba&&null!==ba&&0<ba&&(this.oGc=ba)}}catch(fa){z.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",fa)}};h.prototype.ewb=function(bb){return bb in this.pce?"0"!==
this.pce[bb]:!0};h.prototype.JOj=function(){try{var bb=xa.a.instance.getItem(this.Zjb);if(void 0===bb||null===bb)return z.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;z.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",bb);var ba=JSON.parse(bb);if(void 0===ba||null===ba)return z.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),
null;if(void 0===ba.ExpirationTime||null===ba.ExpirationTime)return z.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(ba.ExpirationTime)).getTime()<Date.now())return z.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;var fa=new k;fa.PolicySettings=ba.PolicySettings;fa.ControllerConnectedServicesFeatureNames=new da.a;this.jb.Zn("ServicesControlsMicrosoftControllerServicesList")&&
this.jb.fw("ServicesControlsMicrosoftControllerServicesList");for(var ra=ik(this.dSb),pa=ra.next();!pa.done;pa=ra.next())fa.ControllerConnectedServicesFeatureNames.add(pa.value);z.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return fa}catch(Za){return z.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",Za.toString()),null}};h.prototype.yPj=function(bb){try{if(void 0===bb||null===bb||void 0===bb.PolicySettings||
null===bb.PolicySettings)z.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.oGc)z.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{var ba=new f(bb,this.oGc),fa=JSON.stringify(ba);z.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",fa);xa.a.instance.setItem(this.Zjb,fa);z.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(ra){z.ULS.sendTraceTag(51662976,
3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",ra.toString())}};h.prototype.Kbc=function(){var bb=v.Kbc(this.jb);return bb&&0<bb.length?"OCPS"+bb:null};h.prototype.l3c=function(bb){var ba=P.a.instance.nh("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==ba&&null!==ba?ba.sc("WebServiceCall",bb):null};h.prototype.Vyc=function(bb){if(void 0!==bb&&null!==bb){var ba=bb.qc;bb.stop();return{returnValue:ba,stopwatch:null}}return{returnValue:null,stopwatch:bb}};Object(t.a)(h,
"CloudPolicySettingsHelper",null,[512]);e.prototype.clone=function(){var bb=new e;bb.Nt=this.Nt;bb.tfg=this.tfg;bb.tJe=this.tJe;bb.HHa=this.HHa;bb.ufg=this.ufg;bb.uJe=this.uJe;bb.Hea=this.Hea;bb.zRc=this.src;return bb};e.prototype.serialize=function(bb){bb=void 0===bb?null:bb;var ba={};if(!bb||bb.contains(e.qOa))ba[e.qOa]=this.Nt;if(!bb||bb.contains(e.lEb))ba[e.lEb]=this.HHa;if(!bb||bb.contains(e.mEb))ba[e.mEb]=this.Hea;return JSON.stringify(ba)};e.create=function(bb,ba){ba=void 0===ba?null:ba;var fa=
new e;fa.zRc=bb;void 0!==ba&&null!==ba&&(e.qOa in ba&&(fa.Nt=ba[e.qOa]),e.lEb in ba&&(fa.HHa=ba[e.lEb]),e.mEb in ba&&(fa.Hea=ba[e.mEb]));return fa};e.deserialize=function(bb,ba){try{var fa=JSON.parse(bb);if(void 0!==fa&&null!==fa)return e.create(ba,fa);z.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",bb);throw Error.argument("settingsData");}catch(ra){throw z.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",ra.toString()),
ra;}};of.Object.defineProperties(e.prototype,{src:{configurable:!0,enumerable:!0,get:function(){return this.zRc}}});e.qOa="CCS";e.lEb="CCSTime";e.mEb="OfficePrivacyRoamedNoticeShown";Object(t.a)(e,"UserPrivacySettings",null,[]);var ya=b(130);d.prototype.hva=function(bb){var ba=String.format("{0}RoamingServiceHandler.ashx?action=",this.jb.appSettings.RoamingServiceHandlerWebServiceBase||"");ba=new Sys.StringBuilder(ba);ba.append(bb);ba.append("&");ba.append(N.AFrameworkApplication.Yi);return ba.toString()};
d.prototype.executeRequest=function(bb,ba,fa,ra){return this.Qg.unb(bb,ba,void 0===ra?null:ra,null,fa,"33",!1,null,6E4)};d.prototype.saveSettings=function(bb){var ba=this;return new Promise(function(fa,ra){try{if(void 0===ba.he||null===ba.he||void 0===bb||null===bb)z.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),ra("Can't determine setting changes to save");else{var pa=ba.he.Nt!==bb.Nt;if(2===ba.he.src&&pa)ba.olj(bb),fa(!0);else{var Za=ba.gpj(bb);
if(void 0===Za||null===Za||!Za.length)z.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),ra("No changes to save");else if(1===ba.he.src)fa(ba.nbg(Za));else if(0===ba.he.src){z.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",Za);var Ua=ba.executeRequest(ba.hva("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",Za);Ua.continueWith(function(){if(Ua.sh||Ua.Of)z.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),
fa(!1);else{var Ma=Ua.result;void 0!==Ma.Eg&&null!==Ma.Eg&&void 0!==Ma.Eg.data&&null!==Ma.Eg.data&&Ma.Eg.data.httpStatus===S.a.QO?(z.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),fa(!0)):(z.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),fa(!1))}})}}}}catch(Ma){z.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",Ma.toString()),fa(!1)}})};d.prototype.gpj=function(bb){if(void 0===this.he||null===
this.he||void 0===bb||null===bb)throw Error.invalidOperation("User Privacy settings have not been initialized");var ba=new da.a;0===bb.src?(this.he.Nt!==bb.Nt&&(ba.add(e.qOa),ba.add(e.lEb)),this.he.Hea!==bb.Hea&&ba.add(e.mEb)):1===bb.src&&this.he.Nt!==bb.Nt&&ba.add(e.qOa);return ba.count?bb.serialize(ba):(z.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)};d.prototype.getSettings=function(){if(!this.RQc){var bb=this;this.RQc=new Promise(function(ba){try{bb.he?
ba(bb.he.clone()):bb.ROj().then(function(fa){bb.he=fa;ba(bb.he.clone());return null},function(){bb.POj().then(function(fa){bb.he=fa;ba(bb.he.clone());return null},function(){bb.QOj().then(function(fa){bb.he=fa;ba(bb.he.clone());return null},function(){z.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");bb.he=new e;ba(bb.he.clone());return null});return null});return null})}catch(fa){z.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",
fa.toString()),bb.he=new e,ba(bb.he.clone())}})}return this.RQc};d.prototype.ROj=function(){var bb=this;return new Promise(function(ba,fa){try{var ra=-1!==window.location.href.indexOf("&wd_pn=2");if(bb.jb.qa("PrivacyDialogShouldCheckRoaming")||ra){var pa=bb.executeRequest(bb.hva("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");pa.continueWith(function(){try{if(pa.sh||pa.Of)z.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{var Za=
pa.result;if(Za&&Za.Eg&&Za.Eg.data)if(Za.Eg.data.httpStatus!==S.a.QO)z.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",Za.Eg.data.httpStatus);else{if(Za.Eg.data.Rd){ba(d.parse(Za.Eg.data.Rd,0));z.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",Za.Eg.data.Rd);return}z.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else z.ULS.sendTraceTag(50860935,
3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");fa("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(Ua){z.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",Ua.toString()),fa("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else z.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),fa("Roaming should not be used")}catch(Za){z.ULS.sendTraceTag(50860939,
3004,10,"TryGetSettingsFromRoaming Exception = {0}",Za.toString()),fa("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})};d.prototype.POj=function(){var bb=this;return new Promise(function(ba,fa){try{var ra=ya.a.get("WacUPToggleState"),pa=null;void 0!==ra&&null!==ra&&0<ra.length&&(pa=decodeURIComponent(ra));if(void 0!==pa&&null!==pa&&0<pa.length){var Za=d.parse(pa,1);z.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",Za.toString());
ba(Za)}else{var Ua=e.create(1),Ma=new da.a;Ma.add(e.qOa);var oa=Ua.serialize(Ma);bb.nbg(oa)?(z.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",oa),ba(Ua)):(z.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",oa),fa("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(ja){z.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",
ja.toString()),fa("UserPrivacySettings TryGetSettingsFromCookie Eception")}})};d.prototype.QOj=function(){return new Promise(function(bb){try{var ba=-1!==window.location.href.indexOf("&wdccsoff=1"),fa=e.create(2);ba?(fa.Nt=2,N.AFrameworkApplication.bIe(),z.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",fa.toString())):(fa.Nt=1,z.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",
fa.toString()));bb(fa)}catch(ra){z.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",ra.toString()),ba=e.create(2),ba.Nt=1,bb(ba)}})};d.prototype.olj=function(bb){z.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===bb.Nt?N.AFrameworkApplication.bIe():N.AFrameworkApplication.Flh();z.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",bb)};d.prototype.nbg=function(bb){try{z.ULS.sendTraceTag(51258455,
3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",bb);var ba=this.jb.Wa("PrivacyCookieDomain")||"";if(!ba||!ba.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");z.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",bb);return ya.a.MPd("WacUPToggleState",bb,ya.a.RV,"/",ba)}catch(fa){return z.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",fa.toString()),!1}};d.prototype.isFeatureEnabled=
function(bb){var ba=this;return this.getSettings().then(function(fa){for(var ra=ba.jb.Zn("ServicesControlsMicrosoftControllerServicesList")?ba.jb.fw("ServicesControlsMicrosoftControllerServicesList"):[],pa=new K.a,Za=0;Za<ra.length;Za++)pa.add(ra[Za]);return pa.contains(bb)?2!==fa.Nt:!0},function(){z.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",bb);return!0})};d.parse=function(bb,ba){try{return z.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",
bb,ba),e.deserialize(bb,ba)}catch(fa){throw z.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",fa.toString()),fa;}};Object(t.a)(d,"UserPrivacySettingsHelper",null,[513]);var va=b(258);c.prototype.Sh=function(bb){var ba=this;this.fb=bb;this.fb.register(512,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").tc().Dc(function(){return new h(N.AFrameworkApplication.fa,N.AFrameworkApplication.nd)});this.fb.register(513,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").tc().Dc(function(){return new d(N.AFrameworkApplication.fa,
N.AFrameworkApplication.nd)});this.fb.register(514,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").tc().Dc(function(){return new x(N.AFrameworkApplication.fa,N.AFrameworkApplication.nd)});this.fb.register(515,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").tc().Dc(function(){return new v(N.AFrameworkApplication.fa,N.AFrameworkApplication.nd,ba.fb.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),ba.fb.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),
N.AFrameworkApplication.ub)})};c.prototype.init=function(){var bb=this;N.AFrameworkApplication.fa.Vu(function(){var ba=bb.fb.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");N.AFrameworkApplication.fa.qa("LicensingIsEnabled")&&(ba.isFeatureEnabled("LicensingTestFeature",!1).then(function(fa){z.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",fa,N.AFrameworkApplication.fa.Wa("IsAnonymousUser"));
return null}),ba.getFeatureTier("LicensingTestFeature",0).then(function(fa){z.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",fa,N.AFrameworkApplication.fa.Wa("IsAnonymousUser"));return null}));bb.fb.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");bb.NJj()})};c.prototype.dispose=function(){};c.prototype.NJj=function(){try{N.AFrameworkApplication.fa.qa("SideCarIsEnabled")&&n.Z4f().then(function(bb){z.ULS.sendTraceTag(594057429,
3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",bb);return bb})}catch(bb){}};c.main=function(){va.a.instance.Qi(new c)};of.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}}});Object(t.a)(c,"ApplicationFeatureHelperPackage",null,[10,11]);b.d(E,"a",function(){return a})},1369:function(t,E,b){function a(){w.a.Fa(function(Ab){c.ka(Ab)})}function c(Ab){var Wb=
Db.call(this)||this;Wb.$=Ab;Wb.Eb();return Wb}function d(){}function e(Ab,Wb,ub,vb,Ka,eb,yb){Ab=k.call(this,Ab,Wb,ub,vb,Ka,!1)||this;Ab.uZd=!1;Ab.V0=yb;Ab.Jec=e.vGh(eb);eb=Ab.TZd(Ab.Jec.name,Ab.Jec.size);if(0!==eb)return Ab.mSd(eb),Ab.V0.setException(Error.create("DataUrlUploaderWrapper: Invlid data url")),Ab.dispose(),Ab;Ab.yj=new x(Ab.$.domElement,Ab.QFb,Ab.Ooa,vb,!1,Ab.$);return Ab}function h(Ab,Wb){this.filename=Ab;this.blob=Wb}function k(Ab,Wb,ub,vb,Ka,eb){eb=void 0===eb?!0:eb;Ab=v.call(this,
Ab,ub,vb,Ka,!1)||this;Ab.Ed=Wb;eb&&Ab.showDialog();return Ab}function n(Ab,Wb){this.dataUri=this.sheetName=null;this.sheetName=Ab;this.dataUri=Wb}function f(Ab,Wb,ub,vb,Ka,eb){eb=void 0===eb?!0:eb;Wb=v.call(this,Ab,Wb,ub,vb,!1)||this;Wb.wAh=Ka;Wb.S9b=Ab.Fb.Mg("LoadResource","FileReaderUploaderLoadResource");eb&&Wb.showDialog();return Wb}function v(Ab,Wb,ub,vb,Ka){Ka=void 0===Ka?!0:Ka;var eb=Ra.call(this,null,Wb,ub)||this;eb.nt=null;eb.Aaa=null;eb.w7a=!1;eb.DDd=null;eb.Ooa=function(yb){eb.L_d.stop();
eb.B0b.cancel();if(x.Eii(yb))eb.qAc?eb.r5e(4):(yb=new J.a(0,2,null,null,!1,null,null,null),yb.status=8,eb.bXd(new S.a(yb),null,"InsertPictureWebMethod")),H.ULS.sendTraceTag(526399121,0,50,"Http Error occurred, isTimeoutError: "+eb.qAc);else{var oc=v.iXj(yb);0!==oc?(H.ULS.sendTraceTag(526399122,0,50,"Server returned error, response: "+yb),eb.r5e(oc)):eb.u5h(yb)}eb.Voc();eb.dispose()};eb.lLi=function(yb){eb.$Ba(yb,eb.yj)&&eb.finalizeUpload(eb.yj,null)};eb.QFb=function(yb){H.ULS.sendTraceTag(526399120,
0,50,"Upload frame initialized");eb.yj=yb;if(!eb.D1a){if(eb.uZd){if(eb.nwe()||eb.d9a&&N.a.eF){yb.s7b(eb.lLi);return}var oc=yb.s7b(null);if(!eb.$Ba(oc,yb))return}eb.finalizeUpload(yb,null)}};eb.uUi=function(){eb.qAc=!0};eb.ib=Ab;eb.L_d=Ab.Fb.Mg("WebServiceCall","InsertPictureOperation");eb.B0b=Q.a.instance.create(eb.uUi,1E5,U.a.UOg,!1);eb.qAc=!1;eb.glc=eb.$.ya.InsertPictureMaxFileSizeBytes;vb&&(eb.w7a="TestOnly"in vb);Ka&&eb.showDialog();return eb}function m(Ab,Wb,ub){var vb=A.call(this,Ab,!1)||this;
vb.SU=null;vb.dBa=!1;vb.knc=function(){vb.yYd("");vb.qBc();return!1};vb.$=Wb;vb.BCc=Ab;vb.IQ=pa.a.instance;vb.fa=ub;vb.N0f();vb.Cld();vb.$.ob.pz=!0;return vb}function x(Ab,Wb,ub,vb,Ka,eb,yb){Ab=l.call(this,Ab,Wb,ub,vb,Ka,"UploadFrame",eb.ea.sessionId,"image/*",!1,null,void 0===yb?!1:yb)||this;Ab.$=eb;Ab.gfg=!0;P.EwaSettings.isChangeGateEnabled("OfficeVSO:5329840_InsertPictureOpenFileBrowserDirectly")?Ab.Y$e():Ab.Kqe();return Ab}function l(Ab,Wb,ub,vb,Ka,eb,yb,oc,Jb,dc,$a){Jb=void 0===Jb?!0:Jb;$a=
void 0===$a?!1:$a;this.NSe="FileUpload.ashx";this.Qn=null;this._initialized=!1;this.Bg=this.Eib=this.xIc=this.Bga=this.bTb=this.Mq=this.ys=null;this.om=!1;this.zD=this.cTb=this.LSc=null;this._parent=Ab;this.srg=Wb;this.gwg=ub;this.b7d=Ka;this.OQc=yb;this.j1d=oc;this.g3d=void 0===dc?null:dc;this.KSc=!1;this.Rrg=vb.qa("CanaryRenewalForFileUploadIsEnabled");this.gfg=!1;(this.Oqa=$a)||this.H5g(eb);Jb&&this.Y$e()}function u(Ab,Wb,ub){if(Ab){var vb=0;do{try{Ab();break}catch(Ka){if(H.ULS.sendTraceTag(50946190,
306,10,"RetryOnException: [Retries: {0}] [Caller: {1}] [Exception: {2}] [Callstack: {3}].",vb,ub,Ka.message,Ka.stack),vb>=Wb)break}vb++}while(1)}}function A(Ab,Wb){return y.call(this,Ab,void 0===Wb?!0:Wb)||this}function z(){}function y(Ab,Wb){Wb=void 0===Wb?!0:Wb;var ub=ra.call(this,!1,!1,y.ou)||this;ub.gXa=null;ub.x6d=!1;ub.Nm=[];ub.yj=null;ub.$Xb=Ab;ub.Uwg=Wb;ub.Rhe=!1;ub.Bv=!1;ub.Bga=null;ub.yIc=!1;ub.Xf=ub.igh;ub.ye="InsertFileDialog";ub.kc(1,ub.xYb);if(y.ou){Ab={};Wb={};var vb={};ub.gXa=(vb.id=
ub.ye,vb.bodyControls=(Wb.uploadButtonProps=(Ab.label=CommonUIStrings.l_DialogChooseFile,Ab.onExecute=Object(Z.a)(ub,ub.XUi,"onUploadButtonClick"),Ab),Wb),vb.uploadStatusLabel=CommonUIStrings.l_DialogNoFileChosen,vb.onFrameReady=Object(Z.a)(ub,ub.OLi,"onFrameReady"),vb);ub.initializeAndShow(ub.titleText,Object(Z.a)(ub,ub.ofc,"insertDialogHandler"),ub.gXa);ub.ESb=!0}else ub.showDialog(ub.titleText,Object(Z.a)(ub,ub.ofc,"insertDialogHandler")),Wb&&ub.N0f(),(Ab=ub.bV(1))&&ub.Nm.push(Ab),(Ab=ub.bV(0))&&
ub.Nm.push(Ab),ub.Tdg(),ub.ESb=!1;return ub}var w=b(10);t=b(0);var D=b(235),H=b(15),F=b(1572),J=b(742),S=b(621),N=b(27),T=b(87),G=b(29),I=b(162),K=b(9),L=b(54),O=b(160),B=b(361),Q=b(47),U=b(45),X=b(31),P=b(1),ea=b(22),ia=b(14),da=b(105),xa=b(85),Z=b(84),ha=b(150),ya=b(4),va=b(13),bb=b(96),ba=b(44),fa=b(1289),ra=ha.a;$k(y,ra);y.prototype.validate=function(){this.yj.zE||H.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");return this.yj.zE.value?!0:(y.Lz(CommonUIStrings.l_FileUploadNoFileSpecified),
!1)};y.prototype.OLi=function(Ab){this.Uwg&&(this.yj=this.M0f(Ab,this.$Xb))};y.prototype.XUi=function(){this.yj&&this.yj.zE&&(this.x6d||(this.yj.d$i(Object(Z.a)(this,this.jAd,"onFileChosen")),this.x6d=!0),this.yj.HSe())};y.prototype.jAd=function(Ab){this.gXa.uploadStatusLabel=Ab;this.ITa(this.titleText,Object(Z.a)(this,this.ofc,"insertDialogHandler"),this.gXa)};y.prototype.ofc=function(Ab){1===Ab&&this.isEnabled()?y.ou&&this.yj.zE&&!this.yj.zE.value?(this.gXa.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,
this.ITa(this.titleText,Object(Z.a)(this,this.ofc,"insertDialogHandler"),this.gXa)):(this.Oxb(),this.$Xb.finalizeUpload(this.yj,Object(Z.a)(this,this.dispose,"dispose"))):0===Ab&&this.hide()};y.prototype.N0f=function(){this.yIc=!1;this.yj=this.M0f(document.getElementById("uploadFrameContainer"),this.$Xb);ya.AFrameworkApplication.fa.qa("InsertPictureDialogFocusLoopFixIsEnabled")&&(this.Bga=Object(Z.a)(this,this.ZBd,"onUploadFrameLoad"),ba.a.addHandler(this.yj.iFrame,"load",this.Bga));this.yj.zE||H.ULS.sendTraceTag(25798092,
322,15,"UploadFrame.FileInputElement is null");this.MJf()};y.prototype.ZBd=function(){this.MJf()};y.prototype.MJf=function(){if(this.yj&&!this.yIc){var Ab=this.yj.zE;Ab&&(ba.a.addHandler(Ab,va.a.Lb,Object(Z.a)(this,this.onKeyDown,"onKeyDown")),Ab=[Ab],this.Nm=Ab.concat.apply(Ab,this.Nm),this.Tdg(),this.yIc=!0)}};y.prototype.dispose=function(){if(this.yj&&!y.ou){var Ab=this.yj.zE;Ab&&ba.a.removeHandler(Ab,va.a.Lb,Object(Z.a)(this,this.onKeyDown,"onKeyDown"));this.Bga&&ba.a.removeHandler(this.yj.iFrame,
"load",this.Bga)}this.yj=null;ra.prototype.dispose.call(this)};y.prototype.Tdg=function(){if(0<this.Nm.length){var Ab=new fa.a(this.Nm),Wb=bb.FocusManager.instance().vQ();Wb&&(this.Nm[0].focus(),Wb.Xe=Ab,Wb.C_=!0)}};y.prototype.onKeyDown=function(Ab){4!==bb.FocusManager.instance().OJf(Ab)&&Ab.preventDefault()};y.Lz=function(Ab){var Wb=document.getElementById("errorText");Wb.innerText=Ab;Wb.style.display="inline-block"};of.Object.defineProperties(y.prototype,{VVj:{configurable:!0,enumerable:!0,get:function(){return this.$Xb}}});
of.Object.defineProperties(y,{ou:{configurable:!0,enumerable:!0,get:function(){return ya.AFrameworkApplication.ta.Qa.Yu&&ya.AFrameworkApplication.ta.Qa.mgf}}});Object(t.a)(y,"InsertFileDialog",ha.a,[]);of.Object.defineProperties(z,{Xf:{configurable:!0,enumerable:!0,get:function(){return ha.a.Oo(z.rk,CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}});z.rk="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";
Object(t.a)(z,"InsertImageDialogHtml",null,[]);$k(A,y);A.prototype.validate=function(){this.yj.zE||H.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var Ab=Object(xa.a)(F.a,this.VVj),Wb=Ab.Rfg(this.yj.zE.value);return 0!==Wb?(y.Lz(Ab.WYe(Wb)),!1):!0};of.Object.defineProperties(A.prototype,{xYb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_ImageUploadButtonText}},titleText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_ImageUploadingTitle}},
igh:{configurable:!0,enumerable:!0,get:function(){return z.Xf}}});Object(t.a)(A,"InsertImageDialog",y,[]);var pa=b(626),Za=b(108),Ua=b(89),Ma=b(42),oa=b(263),ja=b(210),ta=b(81),aa=b(503),ma=b(178);l.prototype.Y$e=function(){this.zD=ma.a.create().toString();this.Oqa?this.q8c():this.Kqe()};l.prototype.H5g=function(Ab){this.Qn=document.createElement("iframe");this.Qn.className=Ab;this.Qn.id=Ab;this.b7d&&(this.Qn.style.visibility="visible",this.Qn.style.height="30px",this.Qn.setAttribute("frameborder",
"0"));this.Bga=Object(Z.a)(this,this.ZBd,"onUploadFrameLoad");ba.a.addHandler(this.Qn,"load",this.Bga)};l.prototype.s7b=function(Ab){var Wb=this;Ab=void 0===Ab?null:Ab;ya.AFrameworkApplication.ta.yqc();if(!this.Mq)return H.ULS.sendTraceTag(25798093,322,50,"_fileInput is null"),"";ba.a.addHandler(this.Mq,"change",function(){Wb.qAh(Ab)});u(Object(Z.a)(this,this.HSe,"fileInputClick"),1,"DoFileOpenDialog");return this.Mq.value};l.prototype.qAh=function(Ab){Ab&&Ab(this.Mq.value)};l.prototype.rAh=function(){this.bTb&&
(this.bTb.innerText=this.i_e())};l.prototype.d$i=function(Ab){var Wb=this;ba.a.addHandler(this.Mq,"change",function(){Ab(Wb.i_e())})};l.prototype.i_e=function(){var Ab=null;if(this.Mq.value){var Wb=this.Mq.value,ub=Wb.lastIndexOf("\\");0<ub&&(Ab=Wb.substring(ub+1,Wb.length))}return Ab?Ab:""};l.prototype.HSe=function(){try{H.ULS.sendTraceTag(35939520,322,50,"UploadFrame.FileInputClick - Clicking on File input element."),this.Mq.click()}catch(Ab){throw H.ULS.sendTraceTag(36783331,322,10,"UploadFrame.FileInputClick Exception: {0}",
Ab.message),Ab;}};l.prototype.DHj=function(){this.Hni()?this.L7f():(this.lZd(),this.ys.submit())};l.prototype.Hni=function(){return(this.Rrg||this.Oqa)&&!(void 0===window.self.FormData||null===window.self.FormData)};l.prototype.gYf=function(Ab){if(Ab){var Wb=this.PCe();this.Bg=new XMLHttpRequest;this.Bg.open("POST",Wb);this.Bg.setRequestHeader("X-CorrelationId",this.zD);this.Vvi(Ab);this.Bg.onreadystatechange=Object(Z.a)(this,this.Ooa,"uploadResponseReceived");this.Bg.send(Ab)}};l.prototype.Vvi=function(Ab){if(!N.a.Gka&&
Ab.get){var Wb=Ab.get("ImageId");Ab=window.self.navigator;var ub={};Wb=(ub.CorrelationId=this.zD,ub.Canary=ya.AFrameworkApplication.canary,ub.ImageNodeId=Wb,ub);Ab&&(Ab=Ab.connection?Ab.connection:Ab.mozConnection?Ab.mozConnection:Ab.webkitConnection?Ab.webkitConnection:null)&&(Wb.effectiveType=Ab.effectiveType,Wb.downlink=Ab.downlink,Wb.type=Ab.type,Wb.rtt=Ab.rtt);H.ULS.sendTraceTag(573345858,322,50,"LogFileUploadStatistics: FileUpload {0}",Wb)}};l.prototype.L7f=function(){try{this.lZd();H.ULS.sendTraceTag(594888409,
322,50,"SubmitFormWithRequest is preparing to send an upload request");var Ab=new (Type.parse("FormData"))(this.ys);this.gYf(Ab)}catch(Wb){H.ULS.sendTraceTag(594888407,322,10,"SubmitFormWithRequest failed to send the request with exception "+Wb.message),this.p$a(null)}};l.prototype.K7f=function(Ab){try{if(this.lZd(),H.ULS.sendTraceTag(594888406,322,50,"SubmitFormWithBlob is preparing to send an upload request"),this.eXj(Ab)){this.cTb=Ab;this.ys.contains(this.Mq)&&this.ys.removeChild(this.Mq);var Wb=
new (Type.parse("FormData"))(this.ys);Wb.append("applicationfileInput",Ab.blob,Ab.filename);this.gYf(Wb)}else this.p$a(null)}catch(ub){H.ULS.sendTraceTag(591267743,322,10,"SubmitFormWithBlob failed to send the request with exception "+ub.message),this.p$a(null)}};l.prototype.eXj=function(Ab){return Ab&&void 0!==Ab.blob&&null!==Ab.blob&&void 0!==Ab.filename&&null!==Ab.filename&&""!==Ab.filename?void 0===window.self.FormData||null===window.self.FormData?(H.ULS.sendTraceTag(578380442,322,10,"FormData isn't supported"),
!1):!0:(Ab=Ab?String.format("[isNull: false] [blobIsNullorEmpty: {0}] [filenameIsNullOrEmpty: {1}]",void 0===Ab.blob||null===Ab.blob,void 0===Ab.filename||null===Ab.filename||""===Ab.filename):"[isNull: true] [blobIsNullorEmpty: false] [filenameIsNullOrEmpty: false]",H.ULS.sendTraceTag(578380441,322,10,String.format("Content of the blob is empty {0}",Ab)),!1)};l.prototype.Ooa=function(){if(4===this.Bg.readyState)if(200===this.Bg.status){H.ULS.sendTraceTag(594888405,322,50,"UploadResponseReceived received a successful response. CorrelationId: {0}",
this.zD);var Ab=this.Bg.getResponseHeader("X-NewKey"),Wb=this.Bgi(this.Bg),ub=!1;if(void 0!==Ab&&null!==Ab&&Wb&&(ub=this.WWj(Ab),!this.KSc&&ub)){H.ULS.sendTraceTag(594888404,322,50,"UploadResponseReceived resubmitting the upload request with a fresh canary. correlationId: {0}",this.zD);this.KSc=!0;void 0!==this.cTb&&null!==this.cTb?this.K7f(this.cTb):this.L7f();return}H.ULS.sendTraceTag(594888403,322,50,"UploadResponseReceived processing the response [retried: {0}] [canaryInvalid: {1}] [gotNewCanary: {2}] [canaryRenewed: {3}] [CorrelationId: {4}]",
this.KSc,Wb,!(void 0===Ab||null===Ab),ub,this.zD);this.p$a(this.Bg.responseText)}else H.ULS.sendTraceTag(42874946,322,15,"Upload request failed with status: {0} [isResponseNull: {1}] [correlationId: {2}]",this.Bg.status,this.Bg.responseText?!1:!0,this.zD),this.p$a(null)};l.prototype.Bgi=function(Ab){try{var Wb=Ma.a(Ab.responseText).Responses;if(void 0!==Wb&&null!==Wb&&1===Wb.length){var ub=Wb[0];if(void 0!==ub&&null!==ub&&2===ub.length&&28===ub[1].StatusCode)return!0}}catch(vb){}return!1};l.prototype.WWj=
function(Ab){aa.a.Wcg(Ab);return ya.AFrameworkApplication.canary!==Ab?!1:!0};l.prototype.lZd=function(){this.LSc||(this.LSc=new Date)};l.prototype.dispose=function(){this.om||(this.Oqa?this._parent.removeChild(this.ys):(this._parent.removeChild(this.Qn),ba.a.removeHandler(this.Qn,"load",this.Bga),this.Bga=null),this.xIc&&(ba.a.removeHandler(this.Mq,"change",this.xIc),this.xIc=null),this.ISe&&(this.Eib&&(ba.a.removeHandler(this.Mq,"change",this.Eib),this.Eib=null),this.bTb=null),this.Mq=this.ys=this._parent=
this.Qn=null,this.om=!0,this.LSc=null,H.ULS.sendTraceTag(25798094,322,50,"UploadFrame disposed"))};l.prototype.delayedDispose=function(){this.dispose()};l.prototype.l8g=function(Ab){if(this.ys){var Wb;(Wb=this.ys.querySelector("input[name=__REQUESTDIGEST]"))?Wb.value=Ab:(Wb=this.S3c(),Wb.type="hidden",Wb.id="__REQUESTDIGEST",Wb.name="__REQUESTDIGEST",Wb.value=Ab,this.ys.appendChild(Wb))}};l.prototype.S3c=function(){return this.Oqa?document.createElement("input"):this.Qn.contentWindow.document.createElement("input")};
l.prototype.ZBd=function(){try{if(!this.Qn.contentWindow.document.body)return}catch(vb){this.G5h();return}if(!(this._initialized||this.d9a&&N.a.eF))this.q8c();else if(!this.d9a||!N.a.eF||this.Cki){var Ab=N.a.$t?this.Qn.contentWindow.document.body.innerText:this.gfg?this.Qn.contentWindow.document.body.firstChild.innerText:this.Qn.contentWindow.document.body.firstChild.innerHTML;var Wb=this.Qn.contentWindow.document.body.innerText.toLowerCase(),ub=0<=Wb.indexOf("responses")||0<=Wb.indexOf("wopisrc");
Wb=0<=Wb.indexOf("http error");!ub&&Wb&&H.ULS.sendTraceTag(42551183,322,15,"Couldn't obtain a valid response but the frame contains: "+this.Qn.contentWindow.document.body.innerText);this.p$a(Ab)}};l.prototype.q8c=function(){if(!this._initialized){var Ab=this.ga("uploadForm"),Wb=this.ga("fileInput"),ub=this.PCe();this.R7g();this.ys.id=Ab;this.ys.method="post";this.ys.encoding="multipart/form-data";this.ys.action=ub;this.Mq.type="file";this.j1d&&(this.Mq.accept=this.j1d,this.g3d&&(this.Mq.capture=this.g3d));
this.Mq.id=Wb;this.Mq.name=Wb;this.oKg&&(this.Mq.multiple=!0);!this.ISe||N.a.$t||N.a.xH||(this.Eib=Object(Z.a)(this,this.rAh,"fileInputChangedHandleAccessibility"),ba.a.addHandler(this.Mq,"change",this.Eib),this.bTb=Ua.a.Gqe(this.ys,this.Mq,"InputFileDescription"));this.b7d&&(this.Oqa||(Ab=this.Qn.contentWindow.document.body,Ab.style.margin="0",Ab.style.overflow="hidden"),Ab=ya.AFrameworkApplication.ta,this.Mq.style.fontFamily=Ab.d1,this.Mq.style.fontSize=Ab.cBc,this.Mq.style.margin="0");(Ab=document.getElementById("__REQUESTDIGEST"))&&
this.l8g(Ab.value);this.ys.appendChild(this.Mq);this._initialized=!0;this.srg(this)}};l.prototype.R7g=function(){if(this.Oqa)this.ys=document.createElement("form"),this._parent.appendChild(this.ys),this.Mq=document.createElement("input");else{this.ys=this.Qn.contentWindow.document.createElement("form");var Ab=this.Qn.contentWindow.document;Ab.body.appendChild(this.ys);this.Mq=Ab.createElement("input")}};l.prototype.Kqe=function(){this._parent.appendChild(this.Qn);this.d9a&&N.a.eF&&this.q8c()};l.prototype.PCe=
function(){var Ab=new oa.QueryStringBuilder(this.NSe);ya.AFrameworkApplication.wYa(Ab);this.Wpj(Ab);Ab=Ab.toString();if(N.a.Pf||N.a.eF||N.a.xH)Ab=ta.a.oWe(Ab);return Ab};l.prototype.ule=function(){var Ab=new Za.a(2,1,0,Object(Z.a)(this,this.delayedDispose,"delayedDispose"),4);ya.AFrameworkApplication.zi.Cg(Ab)};of.Object.defineProperties(l.prototype,{ZTf:{configurable:!0,enumerable:!0,get:function(){return this.gwg}},sessionId:{configurable:!0,enumerable:!0,get:function(){return this.OQc}},iFrame:{configurable:!0,
enumerable:!0,get:function(){return this.Qn}},zE:{configurable:!0,enumerable:!0,get:function(){return this.Mq}},d9a:{configurable:!0,enumerable:!0,get:function(){return ya.AFrameworkApplication.fa?ya.AFrameworkApplication.fa.qa("NativeFileOpenDialogIsEnabled"):!1}},ISe:{configurable:!0,enumerable:!0,get:function(){return ya.AFrameworkApplication.fa?ya.AFrameworkApplication.fa.qa("FileInputDescriptionAccessibilityIsEnabled"):!1}},Cki:{configurable:!0,enumerable:!0,get:function(){return this.Oqa?!1:
ja.b(this.Qn.contentWindow.location.pathname,this.NSe,0)}},oKg:{configurable:!0,enumerable:!0,get:function(){return!N.a.Gka&&ya.AFrameworkApplication.fa.qa("AllowMultipleImageInsertFromLocalDevice")}}});Object(t.a)(l,"UploadFrame",null,[6]);var Ea=b(41),Ha=b(121),Aa=b(21);$k(x,l);x.prototype.ga=function(Ab){return Ab};x.prototype.Wpj=function(Ab){H.ULS.shipAssertTag(526399105,0,!!this.sessionId,"SessionId shouldn't be null.");Ha.a.CWc(Ab,this.$.ya);Ab.O9(K.a.sessionId,this.sessionId);var Wb=Aa.g(this.$).ha;
Wb=Ea.o(Wb.sa.i4,this.$);Ab.O9(K.a.C3i,this.$.xa.pa.name);Ab.O9(K.a.B3i,Wb.FirstRow.toString());Ab.O9(K.a.A3i,Wb.FirstColumn.toString())};x.prototype.G5h=function(){this.ZTf("ServerUploadError")};x.prototype.p$a=function(Ab){this.ZTf(Ab)};x.Eii=function(Ab){return!Ab||ea.a.equals(Ab,"ServerUploadError",!1)};Object(t.a)(x,"UploadFrameWrapper",l,[]);$k(m,A);m.prototype.M0f=function(Ab,Wb){return new x(Ab,Object(Z.a)(Wb,Wb.QFb,"onUploadFrameInitialized"),Object(Z.a)(Wb,Wb.Ooa,"uploadResponseReceived"),
this.fa,!0,this.$)};m.prototype.dispose=function(){this.qBc();this.IQ=this.BCc=null;A.prototype.dispose.call(this)};m.prototype.hide=function(){A.prototype.hide.call(this);this.$.ob.pz=!1};m.prototype.validate=function(){var Ab=this.BCc.TZd(this.yj.zE.value,this.BCc.Tag(this.yj));return 0!==Ab?(Ab=this.BCc.Wdd(Ab).Description,this.yYd(Ab),this.xUd(),!1):!0};m.prototype.isEnabled=function(){return!0};m.prototype.yYd=function(Ab){this.SU.innerHTML=Ab};m.prototype.Cld=function(){this.SU=document.getElementById("errorText");
this.SU.style.display="inline-block";this.dBa=!1;this.yYd("");this.vIa.style.maxWidth=this.vIa.currentStyle.minWidth};m.prototype.xUd=function(){this.IQ.ra(va.a.click,this.yj.zE,this.knc);this.IQ.ra(va.a.Lb,this.yj.zE,this.knc);this.dBa=!0};m.prototype.qBc=function(){this.dBa&&(this.IQ.Ba(va.a.click,this.yj.zE,this.knc),this.IQ.Ba(va.a.Lb,this.yj.zE,this.knc),this.dBa=!1)};Object(t.a)(m,"InsertImageDialogWrapper",A,[]);var V=b(51),La=b(58),Ra=F.a;$k(v,Ra);v.prototype.dispose=function(){T.a.Ia(this.B0b);
this.yj&&this.yj.ule();this.yj=this.B0b=this.ib=null};v.prototype.$6i=function(Ab){function Wb(){vb.Nw(!0)}var ub=this;if(!this.$)return H.ULS.sendTraceTag(526399119,0,50,"ReadPictureAsDataURLTask: EwaControl is null"),La.Task.Ua(!0);if(!this.$.Jba)return La.Task.Ua(!0);var vb=new I.a,Ka=new FileReader;Ab=Ab.zE.files[0];Ka.onload=function(){ub.DDd=Ka.result;vb.Nw(!0)};Ka.onerror=Wb;Ka.onabort=Wb;Ka.readAsDataURL(Ab);return vb.task};v.prototype.Tag=function(Ab){var Wb=-1;Ab=Ab.zE;(null===Ab||void 0===
Ab?0:Ab.files)&&0<Ab.files.length&&(Wb=Ab.files[0].size);return Wb};v.prototype.TZd=function(Ab,Wb){var ub=v.D4g(F.a.$Ba(Ab));0===ub?-1!==Wb&&(H.ULS.sendTraceTag(526399118,0,50,"Validating picture, pictureSize: "+Wb+", maxAllowedSize: "+this.glc+", remainingWorkbookSize: "+this.$.ea.Xjf),Wb>this.glc?ub=3:Wb>this.$.ea.Xjf&&(ub=7)):6===ub&&this.Txi(Ab);H.ULS.sendTraceTag(526399117,0,50,"Validated file on client, validation result: "+ub);return ub};v.prototype.$Ba=function(Ab,Wb){Ab=this.TZd(Ab,this.Tag(Wb));
return 0!==Ab?(this.D1a||1===Ab||this.mSd(Ab),!1):!0};v.prototype.nag=function(Ab){Ab.DHj()};v.prototype.Wdd=function(Ab){var Wb=0,ub=1,vb=-1100324317,Ka="InsertPictureUnknownError",eb=null;switch(Ab){case 1:Wb=1745;ub=0;vb=940870981;Ka="InsertPictureNoFileSelected";break;case 3:ub=0;vb=1250467391;Ka="InsertPicturePictureTooBig";eb=String.format(ia.a.instance.mb(176),this.fAi.toLocaleString());break;case 6:Wb=1749;ub=0;vb=1380041209;Ka="InsertPictureUnsupportedFormat";break;case 7:Wb=1746;ub=0;vb=
-903115058;Ka="InsertPictureExceedWorkbookSize";break;case 4:Wb=1747;ub=0;vb=1218352119;Ka="InsertPictureUploadTimeout";break;case 5:Wb=1748,ub=0,vb=1979899005,Ka="InsertPictureServiceNonDeterministicError"}Ab=v.Xc(Wb,ub,vb,Ka);eb&&(Ab.Description=eb);return Ab};v.prototype.showDialog=function(){this.nwe()?(this.D1a=!1,this.yj=new x(this.$.domElement,this.QFb,this.Ooa,this.fa,!1,this.$,!0)):(H.ULS.sendTraceTag(526399115,0,50,"Showing Insert Picture dialog"),!this.w7a&&(N.a.Xu||N.a.eF&&72>N.a.rye)?
(this.D1a=!1,this.yj=new x(this.$.domElement,this.QFb,this.Ooa,this.fa,!1,this.$)):(this.D1a=!0,this.yj=(new m(this,this.$,this.fa)).yj))};v.prototype.u5h=function(Ab){var Wb={};try{if(Wb=L.a.Wh(Ab),V.b().qA(this.L_d.id,Wb.ServerCorrelationId,"actions","ServerActions"),!X.a.Dg(Wb.Errors)&&Wb.Result){this.$.ea.pX(Wb.StateId,"BasePictureUploaderWrapper.UploadResponseReceived");var ub=Wb.Result;da.a(this.$).nna(1,ub);var vb=this.$.da.za(277);vb&&vb.wUc(this.$,1,Wb.Result,Wb,"InsertPicture");H.ULS.sendTraceTag(526399114,
0,50,"Insert picture completed successfully :)")}}catch(Ka){H.ULS.sendTraceTag(526399113,0,50,"BasePictureUploaderWrapper.HandleSuccessCallback: got exception while try to JSON.Parse string length: "+(Ab?Ab.length:-1)+", errror: "+Ka)}this.QAc(Wb,null,"InsertPictureWebMethod")};v.prototype.r5e=function(Ab){Ab={Errors:[this.Wdd(Ab)]};this.QAc(Ab,null,"InsertPictureWebMethod")};v.prototype.QAc=function(Ab,Wb,ub){this.nt(Ab,Wb,ub)};v.prototype.bXd=function(Ab,Wb,ub){this.Aaa(Ab,Wb,ub)};v.prototype.mSd=
function(Ab){Ab=this.Wdd(Ab);P.EwaSettings.oz()?new B.a(this.$,Ab):(new O.ErrorDialog(this.$,Ab)).qf()};v.prototype.Txi=function(Ab){var Wb=this.$.ya.InsertPicturUnsupportedExtensionsForLogging;Ab=G.a.cl(Ab);for(var ub=0;ub<Wb.length;++ub)if(Ab.endsWith(Wb[ub])){H.ULS.sendTraceTag(526399112,0,50,"Insert picture blocked invalid extension: "+Wb[ub]);break}};v.iXj=function(Ab){return!Ab||ea.a.equals(Ab,K.a.insertPictureUnknownError,!0)?2:ea.a.equals(Ab,K.a.insertPictureNoFileSelectedError,!0)?1:ea.a.equals(Ab,
K.a.kdi,!0)?3:ea.a.equals(Ab,K.a.ldi,!0)?5:0};v.Xc=function(Ab,Wb,ub,vb){return X.a.Xc(1,0,0,Ab,Wb,ub,vb)};v.D4g=function(Ab){switch(Ab){case 1:return 1;case 2:return 6}return 0};v.prototype.nwe=function(){return P.EwaSettings.isChangeGateEnabled("OfficeVSO:5329840_InsertPictureOpenFileBrowserDirectly")&&!this.w7a&&void 0!==window.self.FormData&&null!==window.self.FormData?!0:!1};of.Object.defineProperties(v.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.ib}},fAi:{configurable:!0,
enumerable:!0,get:function(){return this.glc/1024/1024}}});Object(t.a)(v,"BasePictureUploaderWrapper",F.a,[6]);$k(f,v);f.prototype.hBj=function(){this.glc=28E5;this.mSd(3)};f.prototype.qad=function(Ab){var Wb=this;H.ULS.sendTraceTag(526399111,0,50,"FileReaderUploaderWrapper.finalizeUploadImpl - Start function.");var ub=new FileReader;Ab=Ab.zE.files;if(0==Ab.length)H.ULS.sendTraceTag(526399110,0,15,"FileReaderUploaderWrapper.finalizeUploadImpl - No image file found.");else{var vb=Ab[0];ub.onload=function(){Wb.S9b.stop();
Wb.wAh.PTi(ub.result,Wb);H.ULS.sendTraceTag(526399109,0,50,"FileReaderUploaderWrapper.finalizeUploadImpl - End function. Type:"+vb.type+", Size:"+vb.size.toString())};ub.onerror=function(){Wb.S9b.stop();H.ULS.sendTraceTag(526399108,0,10,"FileReaderUploaderWrapper.finalizeUploadImpl - Can't read image. Type:"+vb.type+", Size:"+vb.size.toString())};ub.onabort=function(){Wb.S9b.stop();H.ULS.sendTraceTag(526399107,0,10,"FileReaderUploaderWrapper.finalizeUploadImpl - Aborted read image. Type:"+vb.type+
", Size:"+vb.size.toString())};this.S9b.start();ub.readAsDataURL(vb)}};f.prototype.finalizeUpload=function(Ab,Wb){this.qad(Ab,Wb)};Object(t.a)(f,"FileReaderUploaderWrapper",v,[710]);var pb=b(572),cb=b(394),Sa=b(177);n.prototype.getSheetName=function(){return this.sheetName};Object(t.a)(n,"MacroRecorderPictureInsertedPayload",null,[430]);$k(k,v);k.prototype.qad=function(Ab,Wb){var ub=this;v.prototype.finalizeUpload.call(this,Ab,Wb);cb.a(this.$.userOperationManager,function(vb,Ka){ub.nt=vb;ub.Aaa=Ka;
ub.L_d.start();ub.B0b.Iq();ub.qAc=!1;ub.nag(Ab);return ub.$6i(Ab)},function(vb){function Ka(){return new n(yb,ub.DDd?ub.DDd:"")}var eb={};ub.$.Oj(eb);var yb=eb.SheetName;vb=P.EwaSettings.Zb()?new Sa.a(510,0,vb,72,Ka):new pb.a(510,0,vb,8,Ka);vb.Ena(function(){return!0});vb.Ed=ub.Ed;return vb},this.Ed)};k.prototype.finalizeUpload=function(Ab,Wb){this.qad(Ab,Wb)};Object(t.a)(k,"PictureUploaderWrapper",v,[]);Object(t.a)(h,"UploadBlobParameters",null,[]);$k(e,k);e.prototype.bXd=function(Ab,Wb,ub){k.prototype.bXd.call(this,
Ab,Wb,ub);this.V0.setException(Error.create("DataUrlUploaderWrapper.TriggerFailedCallback: File upload request failed"))};e.prototype.QAc=function(Ab,Wb,ub){k.prototype.QAc.call(this,Ab,Wb,ub);X.a.Dg(Ab.Errors)?this.V0.setException(Error.create("DataUrlUploaderWrapper.TriggerSuccessCallback: File upload request returned with errors: "+X.a.Cc(Ab.Errors))):this.V0.setResult(!0)};e.prototype.nag=function(Ab){var Wb=new h(this.Jec.name,this.Jec);Ab.K7f(Wb)};e.vGh=function(Ab){var Wb=Ab.split(",");Ab=
Wb[0].includes("base64")?window.self.atob(Wb[1]):window.self.decodeURI(Wb[1]);Wb=Wb[0].split(":")[1].split(";")[0];for(var ub=new Uint8Array(Ab.length),vb=0;vb<Ab.length;vb++)ub[vb]=Ab.charCodeAt(vb);Ab=new Blob([ub],{type:Wb});Ab.name="Image.png";return Ab};Object(t.a)(e,"DataUrlUploaderWrapper",k,[]);d.prototype.Sbi=function(Ab,Wb,ub,vb,Ka){new k(Ab,Wb,ub,vb,Ka,!0)};d.prototype.Pai=function(Ab,Wb,ub,vb,Ka,eb){new e(Ab,null,Wb,ub,vb,Ka,eb)};d.prototype.abi=function(Ab,Wb,ub,vb,Ka){new f(Ab,Wb,ub,
vb,Ka,!0)};Object(t.a)(d,"UploaderCreator",null,[689]);var Db=D.a;$k(c,Db);c.ka=function(Ab){Ab.da.Ga(485,new c(Ab))};c.prototype.create=function(){var Ab;this.pb(null!==(Ab=this.$.da.za(484))&&void 0!==Ab?Ab:this.$.da.Ga(484,new d))};Object(t.a)(c,"UploaderCreatorFactory",D.a,[]);b.d(E,"a",function(){return a})},1401:function(t,E,b){function a(){f.a.Fa(function(aa){c.ka(aa)})}function c(aa){return ta.call(this,aa)||this}function d(aa,ma){this.$=aa;this.uploaderCreator=ma}function e(aa,ma,Ea,Ha,Aa,
V){var La=Ua.call(this,null,Ea,Ha)||this;La.znf=0;La.Ooa=function(Ra){if(Ra){for(var pb=Array(Ra.length),cb=0;cb<Ra.length;cb++){var Sa=Ra[cb];pb[cb]={};pb[cb].SourceUrl=Sa.SourceUrl;y.a.Swa(Sa.LicenseUrl)&&y.a.Swa(Sa.PageUrl)&&(pb[cb].LicenseUrl=Sa.LicenseUrl,pb[cb].LicenseDisplayName=Sa.LicenseDisplayName,pb[cb].PageUrl=Sa.PageUrl);pb[cb].AltText=-2053056795===La.Ed.command?Sa.Caption:""}var Db=-2009825598===La.Ed.command?"bing":"M365";cb=Q.g(La.$);var Ab=J.o(cb.ha.sa.activeCell,La.$);S.a(La.$.userOperationManager,
function(Wb,ub,vb){return T.r(La.$.oa.va,Ab,pb,Db,O.b(Wb,La.SQi),O.a(ub,La.RQi),vb,null)},function(Wb){return new N.a(595,0,Wb)},La.Ed);K.HelperMethods.i_?(cb=new Map,cb.set("MediaProvider",Db),cb.set("ImagesCount",Ra.length.toString()),cb.set("TimeTakenToOpenDialog",La.znf.toString()),w.Health.instance.recordKpiUsage(Za.a.hdi,1,pa.a.i9f,cb)):A.ULS.sendTraceTag(537155805,0,15,"OnlinePictureUploaderWrapper.UploadResponseReceived: KPI Usage not supported.");La.Voc()}else A.ULS.sendTraceTag(537155806,
0,10,"OnlinePictureUploaderWrapper.UploadResponseReceived: Response is null")};La.SQi=function(Ra){I.a(Ra)?A.ULS.sendTraceTag(537155799,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded with errors. Errors: "+G.a.Cc(Ra.Errors)):(A.ULS.sendTraceTag(537155801,0,50,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded."),Ra.Result?B.a(La.$).nna(1,Ra.Result):A.ULS.sendTraceTag(537155800,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess:Result.result is null"))};
La.RQi=function(){A.ULS.sendTraceTag(537155798,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadFailed: Operation failed")};La.$=aa;La.Ed=ma;La.V0=V;La.oqe=D.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");La.showDialog();return La}function h(aa,ma,Ea,Ha,Aa,V){var La=ra.call(this)||this;La.Zgc=!1;La.nwa=null;La.vR=null;La.wNa=null;La.iIi=function(){La.vua(La.tpb)};La.ksd=function(Ra){Ra.keyCode===Sys.UI.Key.tab&&("KeepFocusDiv"!==Ra.target.id||Ra.shiftKey?"KeepFocusStartDiv"===
Ra.target.id&&Ra.shiftKey&&(Ra.preventDefault(),document.getElementById("KeepFocusDiv").focus()):(Ra.preventDefault(),document.getElementById("KeepFocusStartDiv").focus()))};La.hPi=function(){La.job&&(La.job.launchUpsellExperience("stockimages"),A.ULS.sendTraceTag(537155807,0,50,"OnLaunchM365Upsell: Launched Dime Upsell flow"))};La.zl=V;La.$=aa;La.laf=ma;La.job=Ea;La.oAa=[];La.eqf=Ha;La.jgh=Aa;La.Epe=La.$.ya.InsertOnlinePictureMaxCountOfImagesToInsert;La.Xf=La.A8g();return La}function k(){}function n(aa,
ma){return bb.call(this,aa,va.a.aba(ma))||this}var f=b(10);t=b(0);var v=b(915),m=b(162),x=b(104),l=b(4),u=b(187),A=b(15),z=b(1572),y=b(29),w=b(99),D=b(83),H=b(628),F=b(178),J=b(41),S=b(394),N=b(177),T=b(259),G=b(31),I=b(299),K=b(11),L=b(14),O=b(298),B=b(105),Q=b(21),U=b(150),X=b(89),P=b(96),ea=b(170),ia=b(184),da=b(98),xa=b(160),Z=b(361),ha=b(1),ya=b(1452),va=b(81),bb=ya.a;$k(n,bb);n.prototype.bsc=function(aa,ma){this.isEnabled()&&this.LFa(this.targetOrigin)&&(this.Tn(aa),this.Ml(aa,ma))};Object(t.a)(n,
"InsertMediaCrossDocumentMessenger",ya.a,[763,240,6]);var ba=b(7);Object(t.a)(k,"OnlineMediaSearchResult",null,[]);var fa=b(330),ra=U.a;$k(h,ra);h.prototype.HBj=function(aa){var ma=this;this.Zgc=!1;this.showDialog(this.zl,null);this.nwa=document.getElementById(this.di("InsertMediaFrame"));if(!this.nwa)throw this.vua(this.tpb),Error.invalidOperation("Couldn't get InsertMediaIframe.");var Ea=document.getElementById(this.di("WACDialogPanel"));Ea&&Ea.setAttribute(X.a.Gd,X.a.yZa);Ea=document.createElement("div");
Ea.id="KeepFocusStartDiv";Ea.tabIndex=0;Ea.className="keep-focus-start";this.nwa.parentNode.insertBefore(Ea,this.nwa.parentNode.firstChild);Ea=document.createElement("div");Ea.id="KeepFocusDiv";Ea.tabIndex=0;Ea.className="keep-focus";this.nwa.parentNode.appendChild(Ea);$addHandler(this.vIa,"keydown",this.ksd);this.nwa.src=this.laf;this.nwa.frameBorder="0";Ea=document.getElementById(this.di("WACDialogButtonPanel"));if(!Ea)throw Error.invalidOperation("Couldn't get WACDialogButtonPanel.");Ea.className=
"display-none";Ea=document.getElementById(this.di("WACDialogTitleText"));if(!Ea)throw Error.invalidOperation("Couldn't get WACDialogTitleText.");Ea.className="display-none";2===this.eqf&&(document.getElementById(this.di("WACDialogTitlePanel")).className="display-none",document.getElementById(this.di("WACDialogBodyPanel")).className="padding-zero");P.FocusManager.instance().vQ().scope.eN=!0;this.vR=new n(this.nwa.contentWindow,this.laf);this.vR.bsc(ea.a.KCg,function(Ha){ma.dHi(Ha,aa.Ooa)});this.vR.bsc(ea.a.insert,
function(){ma.yOi(aa.Ooa)});this.vR.bsc(ea.a.VZc,this.iIi);2===this.eqf&&0===this.jgh&&(this.vR.bsc(ea.a.zsi,this.hPi),this.wNa=this.job.Lma("MsoPremiumStockImages",function(Ha){A.ULS.sendTraceTag(537155811,0,50,"OnCompleteM365Upsell: Upsell completed from stock images");if(Ha.isEnabled){var Aa={};ma.vR.wj(ea.a.PVj,(Aa.LicenseTier=Ha.toString(),Aa))}else A.ULS.sendTraceTag(537155810,0,10,"OnCompleteM365Upsell: Upsell completed but license tier didn't upgrade.")}))};h.prototype.dispose=function(){this.oAa=
null;this.job&&this.wNa&&this.job.BId("MsoPremiumStockImages",this.wNa);this.vR&&(this.vR.dispose(),this.vR=null);ra.prototype.dispose.call(this)};h.prototype.hide=function(){ra.prototype.hide.call(this);da.a.nwc(this.$)};h.prototype.dHi=function(aa,ma){aa=aa&&aa.Values?(aa=aa.Values)?Object(ba.a)(new k,{Action:aa.action||"",Caption:aa.caption||"",ContentType:aa.contentType||"",FileExtension:aa.extension||"",PageUrl:aa.pageUrl||"",SourceUrl:aa.sourceUrl||"",ThumbnailUrl:aa.thumbnailUrl||"",LicenseUrl:aa.licenseUrl||
"",LicenseDisplayName:aa.licenseDisplayName||"",Height:aa.height||0,Width:aa.width||0}):null:null;aa&&(this.oAa.push(aa),this.Zgc&&(A.ULS.sendTraceTag(537155809,0,50,"InsertMediaDialog.OnAddItem: Insert Message handling was pending"),ma(this.oAa),this.Zgc=!1,this.vua(this.tpb)))};h.prototype.yOi=function(aa){this.oAa&&0<this.oAa.length?this.oAa.length<=this.Epe?(aa(this.oAa),this.vua(this.tpb)):(this.Lz(),A.ULS.sendTraceTag(537155808,0,10,"OnInsert : Tried to insert more than allowed limit of items."),
this.oAa.length=0):this.Zgc=!0};h.prototype.A8g=function(){var aa=document.createElement("div");aa.id="InsertMediaDialog";aa.className=ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixHorizonalScroll",!0)?"insert-media-dialog":"insert-media-dialog-old";var ma=document.createElement("div");ma.id="InsertMediaPanel";ma.className=ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixCancelButton",!0)?"insert-media-panel":
"insert-media-panel-old";var Ea=document.createElement("iframe");Ea.id="InsertMediaFrame";Ea.className="insert-media-frame";aa.appendChild(ma);ma.appendChild(Ea);return fa.b(aa)};h.prototype.Lz=function(){var aa=G.a.Xc(1,0,0,0,0,466721363,"InsertPictureExceededAllowedCount");aa.Description=String.format(L.a.instance.mb(201),this.Epe.toLocaleString());ha.EwaSettings.oz()?new Z.a(this.$,aa):(new xa.ErrorDialog(this.$,aa)).qf()};of.Object.defineProperties(h.prototype,{j4:{configurable:!0,enumerable:!0,
get:function(){return ia.a.O6b+"/InsertMediaDialog"}},canBePreempted:{configurable:!0,enumerable:!0,get:function(){return!1}}});Object(t.a)(h,"InsertMediaDialog",U.a,[]);var pa=b(501),Za=b(401),Ua=z.a;$k(e,Ua);e.prototype.dispose=function(){this.$=null};e.prototype.showDialog=function(){var aa=this,ma=null;ma=this.$.Fb.sc("UserAction","showOnlineImagesDialogTimeStopwatch");switch(this.Ed.command){case -2009825598:this.SAj();break;case -2053056795:this.oqe.execute(function(Ea){Ea.isFeatureEnabled("MsoPremiumStockImages",
!1).catch(function(Ha){return A.ULS.sendTraceTag(557200643,0,10,"OnlinePictureUploaderWrapper::ShowDialog - Failed to load the premium state from application feature helper: "+Ha)}).then(function(Ha){aa.TAj(Ha);return null})})}ma.stop();this.znf=ma.qc};e.prototype.SAj=function(){var aa=this.$.ya.BingPictureEndpoint,ma=H.a.aH(l.AFrameworkApplication.lcid),Ea=F.a.create();aa?(aa=0<aa.search(RegExp("insertmedia.bing.office.net","gi"))?String.format(aa,1,1):String.format(aa,1,l.AFrameworkApplication.lcid,
ma?ma.name:"en-us",l.AFrameworkApplication.buildVersion,Ea.toString(),1,this.$.ya.DocumentHostInfo.LoggableUserId),this.L4b(aa,1,-1,L.a.instance.ga(1751))):(A.ULS.sendTraceTag(537155804,0,10,"OnlinePictureUploaderWrapper::ShowDialogForBingPictures - Can't access the Bing service endpoint"),this.V0.setException(Error.create("Failed to access the Bing service endpoint")))};e.prototype.TAj=function(aa){var ma=this.$.ya.M365PictureEndpoint,Ea=F.a.create();if(ma){var Ha=this.$.ya.DocumentHostInfo.UserId;
Ha=Ha?y.a.Nv(Ha).toString():"0";var Aa=this.oqe.instance.isFreemiumUpsellEnabled();aa=aa?1:Aa?0:-1;Ea=Ea.toString();Aa=H.a.aH(l.AFrameworkApplication.lcid).name;ma=String.format(ma,l.AFrameworkApplication.lcid,Aa,l.AFrameworkApplication.buildVersion,Ea,1,Ha,aa,1);this.L4b(ma,2,aa,L.a.instance.ga(1750))}else A.ULS.sendTraceTag(537155803,0,10,"OnlinePictureUploaderWrapper::ShowDialogForStockImages - Can't access the M365 service endpoint"),this.V0.setException(Error.create("Failed to access the M365 service endpoint"))};
e.prototype.L4b=function(aa,ma,Ea,Ha){try{(new h(this.$,aa,D.a.instance.nh("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),ma,Ea,Ha)).HBj(this),this.V0.setResult(!0)}catch(Aa){A.ULS.sendTraceTag(537155802,0,10,"OnlinePictureUploaderWrapper::CreateAndShowDialog failed [Exception : "+Aa+"] [MediaProvider : "+ma+"] [DialogLicenseTier : "+Ea+"]"),this.V0.setException(Aa)}};Object(t.a)(e,"OnlinePictureUploaderWrapper",z.a,[6]);var Ma=b(58);d.prototype.executeCommand=function(aa,ma,Ea){aa=
ma.command;switch(aa){case 1403967063:if(Ea&&"dataUrl"in Ea)return ma=new m.a,this.uploaderCreator&&this.uploaderCreator.Pai(this.$,x.a.instance,l.AFrameworkApplication.fa,Ea,Ea.dataUrl,ma),ma.task;this.uploaderCreator&&this.uploaderCreator.Sbi(this.$,ma,x.a.instance,l.AFrameworkApplication.fa,Ea);return Ma.Task.Ua(!0);case -2053056795:case -2009825598:return aa=new m.a,new e(this.$,ma,x.a.instance,l.AFrameworkApplication.fa,Ea,aa),aa.task;default:return u.a(aa)}};d.prototype.Ac=function(aa,ma){if(aa=
this.$.isEditMode)switch(ma.command){case 1403967063:aa=!0;break;case -2053056795:aa=!0;break;case -2009825598:aa=!0;break;default:aa=!1}return aa};d.prototype.Tc=function(){return!1};d.prototype.Nc=function(){return!1};Object(t.a)(d,"PictureCommandHandler",null,[401]);var oa=b(37),ja=b(50),ta=v.a;$k(c,ta);c.prototype.zd=function(){var aa=this;oa.TaskExtensions.Aa(ja.GetServiceTaskFactory.Ra(this.$.da,484,485,1),function(ma){aa.jd([new d(aa.$,ma.result)])},this.$.la,3)};c.ka=function(aa){v.a.Pd(90,
new c(aa))};Object(t.a)(c,"PictureCommandHandlerFactory",v.a,[]);b.d(E,"a",function(){return a})},1426:function(t,E,b){function a(){h.a.Fa(function(D){c.ka(D)})}function c(D){var H=w.call(this)||this;H.$=D;H.Eb();return H}function d(D,H){var F=z.call(this)||this;F.$=D;F.Mu=H;F.Kua={};F.jS={};F.Ure=!1;F.styles=null;F.ILi=function(J,S,N){n.ULS.sendTraceTag(520710152,1,50,"FontServiceManager.onFontPreviewRequestComplete: Attempt to request FontUrl method: "+N+" has succeeded.");F.S0i(J);F.Ure=!0;F.K4i()};
F.JLi=function(J,S,N){n.ULS.sendTraceTag(520710151,1,10,"FontServiceManager.onFontPreviewRequestFailed: Encountered errors for "+N+".")};F.Kgj=function(){F.an&&F.oed(F.ILi,F.JLi)};F.an=u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FontServiceIntegration",!1);F.Kgj();return F}function e(){}var h=b(10);t=b(0);var k=b(235),n=b(15),f=b(567),v=b(38),m=b(4),x=b(62);e.oed="GetFontPreviewData";Object(t.a)(e,"FontWebServiceMethods",null,[]);var l=b(11),u=b(1),A={xlyellow:"xlyellow"},z=v.a;$k(d,
z);d.prototype.S0i=function(D){var H=this;if(this.Epi(D)){var F=l.HelperMethods.sca(function(){var J=D.Result;H.styles='@font-face{font-family:"msofpNew";font-style:normal;font-weight:normal;src:url(\''+J.PreviewUrl+"') format('truetype')}";var S=J.FontFacePropertiesList;J.FontNameList.forEach(function(N,T){H.Kua[N]=S[T].Codepoint;H.styles=H.mLg(H.styles,N,"https://fs.microsoft.com/fs/"+J.CatalogVersion+"/rawguids/"+S[T].FontGuid);H.jS[N]=S[T].LocalizedFontName});f.a.ti(H.styles)});10<F&&n.ULS.sendTraceTag(520710159,
1,50,"FontServiceManager.prepareFontCodepointMap: Duration for prepareFontCodepointMap the model, duration="+F)}};d.prototype.Epi=function(D){if(!D.Result)return n.ULS.sendTraceTag(520710158,1,15,"FontServiceManager.isValidFontPreviewData: Result in EwaResult is Null."),!1;D=D.Result;return D?D.PreviewUrl?D.FontFacePropertiesList?D.FontNameList?0===D.FontFacePropertiesList.length||D.FontFacePropertiesList.length!==D.FontNameList.length?(n.ULS.sendTraceTag(520710153,1,15,"FontServiceManager.isValidFontPreviewData: Mismatch in length of FontFacePropertiesList and FontNameList in fontListPreviewData."),
!1):!0:(n.ULS.sendTraceTag(520710154,1,15,"FontServiceManager.isValidFontPreviewData: FontNameList in fontListPreviewData is Null."),!1):(n.ULS.sendTraceTag(520710155,1,15,"FontServiceManager.isValidFontPreviewData: FontFacePropertiesList in fontListPreviewData is Null."),!1):(n.ULS.sendTraceTag(520710156,1,15,"FontServiceManager.isValidFontPreviewData: PreviewUrl in fontListPreviewData is Null."),!1):(n.ULS.sendTraceTag(520710157,1,15,"FontServiceManager.isValidFontPreviewData: fontListPreviewData is Null."),
!1)};d.prototype.mLg=function(D,H,F){return D+('@font-face{font-family:"'+H+"\";src:url('"+F+"')}")};d.prototype.oed=function(D,H){var F=this.Mu,J=this.Mu.Pb(),S=e.oed;J=F.Na(5,void 0===J?null:J);J.locale=m.AFrameworkApplication.uiCulture;return x.g(F,S,J,D,H,null,null,644)};d.prototype.K4i=function(){this.kod&&this.raiseEvent(d.JUe)};d.prototype.isFontSupported=function(D){return this.an&&this.jS&&(!!this.jS[D]||!!A[D.replace(/\s/g,"").toLowerCase()])};d.prototype.$ne=function(D){this.addHandler(d.JUe,
D)};of.Object.defineProperties(d.prototype,{szc:{configurable:!0,enumerable:!0,get:function(){return this.jS}},ZDh:{configurable:!0,enumerable:!0,get:function(){return this.Kua}},kod:{configurable:!0,enumerable:!0,get:function(){return this.Ure}}});d.JUe="fsmFD";Object(t.a)(d,"FontServiceManager",v.a,[506]);var y=b(921),w=k.a;$k(c,w);c.ka=function(D){D.da.Ga(505,new c(D))};c.prototype.create=function(){var D=this;this.pb(Object(y.c)(this.$.da,504,function(){return new d(D.$,D.$.oa.Mu)}))};Object(t.a)(c,
"FontServiceManagerFactory",k.a,[]);b.d(E,"a",function(){return a})},1463:function(t,E,b){function a(){w.a.Fa(function(D){c.ka(D)})}function c(D){var H=y.call(this)||this;H.$=D;H.Eb();return H}function d(D,H,F){var J=A.call(this)||this;J.statusBarManager=null;J.iIe=function(){J.X6b()};J.Ngh=function(){J.X6b()};J.hIe=function(S){10===S&&J.X6b()};J.onKeyDown=function(S){if(13===S.Ca.keyCode){S=new m.a(237279923,1,2,6,null);var N={};J.$.Ka.Kb(S,(N[u.a.skipClipboardAccess]=!0,N[u.a.cMe]=!0,N));return!0}return!1};
J.$=D;J.hr=H;J.km=F;J.C8c=!1;J.c3f=x.EwaSettings.getBooleanFeatureGate(v.a.IPa,!1);J.Bhf=x.EwaSettings.isChangeGateEnabled("OfficeVSO:6082903_PasteToEnterKeyDownEventForGrid");J.c3f&&J.$.da.Za(29,function(S){J.statusBarManager=S;S.gJ(J)});return J}t=b(0);var e=b(109),h=b(235),k=b(15),n=b(13),f=b(38),v=b(189),m=b(91),x=b(1),l=b(21),u=b(5),A=f.a;$k(d,A);d.prototype.dispose=function(){this.Tj();this.km=this.hr=this.$=null;this.statusBarManager&&(this.statusBarManager.wF(this),this.statusBarManager=null)};
d.prototype.cn=function(){return this.c3f};d.prototype.Kr=function(D,H){if("QueryPasteShortcutEnabledLabel"!==D&&!d.NGj.includes(D))return!1;var F=this.ho();"QueryPasteShortcutEnabledLabel"===D?(H.Visible=F,k.ULS.sendTraceTag(537167636,0,100,"PasteShortcutManager.ExecuteRootCommand: Setting visible to "+F+" for commandId "+D)):(H.Visible=!F,k.ULS.sendTraceTag(537167635,0,100,"PasteShortcutManager.ExecuteRootCommand: Setting visible to "+!F+" for commandId "+D));return!0};d.prototype.Klh=function(){this.Pi();
this.raiseEvent("pasteShortcutStatusChanged")};d.prototype.X6b=function(){this.Tj();this.raiseEvent("pasteShortcutStatusChanged")};d.prototype.ho=function(){return this.C8c};d.prototype.hq=function(D){this.addHandler("pasteShortcutStatusChanged",D)};d.prototype.Fq=function(D){this.removeHandler("pasteShortcutStatusChanged",D)};d.prototype.Pi=function(){if(!this.ho()){this.C8c=!0;l.g(this.$).Gi.Ak(this.iIe);this.km.ka("blur",this.Ngh);var D=this.$.da.za(65);D&&D.j3&&D.j3.registerForCommentEvents(this.hIe);
this.hr.it(n.a.Lb,this.Bhf?this.$.Rv:this.$.domElement,this.onKeyDown,!0)}};d.prototype.Tj=function(){if(this.ho()){this.C8c=!1;l.g(this.$).Gi.vk(this.iIe);this.km.detach("blur");var D=this.$.da.za(65);D&&D.j3&&D.j3.unregisterForCommentEvents(this.hIe);this.hr.rt(n.a.Lb,this.Bhf?this.$.Rv:this.$.domElement,this.onKeyDown,!0)}};d.NGj=["QuerySheetNumberButton","QueryWorkbookStatisticsButton"];Object(t.a)(d,"PasteShortcutManager",f.a,[690,455,269,6]);var z=b(129),y=h.a;$k(c,y);c.prototype.create=function(){var D=
this.$;this.pb(D.da.za(478)||this.$.da.Ga(478,new d(D,e.KeyInputManager.instance,z.a.instance.KG())))};c.ka=function(D){D.da.Ga(479,new c(D))};Object(t.a)(c,"PasteShortcutManagerFactory",h.a,[]);var w=b(10);b.d(E,"a",function(){return a})},1464:function(t,E,b){function a(){e.a.Fa(function(G){c.ka(G)})}function c(G){var I=T.call(this)||this;I.$=G;I.Eb();return I}function d(G,I,K,L){var O=this;this.recoveryUI=null;this.Cya=function(){O.Dba()&&(O.grid.xbb(O.Cya),O.oag())};this.oag=function(){if(w.g(O.$).Ab.p5(O.pasteRange))v.ULS.sendTraceTag(526758983,
306,50,"RecoveryUIController:triggerHandRaiseAfterConsistentGrid Last paste was a table. Table hand raise is not triggered.");else if(w.g(O.$).Ab.n5(O.pasteRange))v.ULS.sendTraceTag(526758982,306,50,"RecoveryUIController:triggerHandRaiseAfterConsistentGrid Last paste was a pivot table. Table hand raise is not triggered.");else{var B=F.d(O.$.xa.pa);B=new J.a(O.pasteRange,B);O.bOj(B)}};this.ieg=function(){O.recoveryUI&&(O.x_d=y.a.Ta.Wd.m,O.hide(),z.a.instance.create(function(){O.vUj()},250,"RecoveryUI.UpdatePositionOnVisibleAreaChanged",
void 0,!0))};this.xIe=function(B){10===B&&O.CIa()};this.ehh=function(){if(O.recoveryUI){var B=document.getElementById("PasteRecoveryUI");B&&u.a.Wj===B.getAttribute(u.a.tY)&&B.click();O.documentHidden=!0;O.CIa()}};this.yIe=function(){O.CIa()};this.zIe=function(){O.CIa()};this.onKeyUp=function(B){if(O.recoveryUI){if(O.s_)return!1;if(17===B.Ca.keyCode&&O.v9b){B=document.getElementById("PasteRecoveryUI");if(!B)return v.ULS.shipAssertTag(537154070,0,!1,"RecoveryUIController.OnKeyUp: recoveryUIElement is null."),
!1;var Q=B.getAttribute(u.a.tY)||"";if(u.a.Uq===Q)return B.click(),!0}}return!1};this.onKeyDown=function(B){if(O.recoveryUI){O.v9b=!1;O.s_=B.ctrlKey;B=B.Ca.keyCode;if(27===B)return O.CIa(),D.EwaSettings.isChangeGateEnabled("OfficeVSO:6022397_ClearStateWhileHidingRecoveryUI")&&(B=O.$.da.za(254))&&B.Wq("RecoveryUIController.onKeyDown",!0,!0).catch(function(){}),!0;if(17===B)return O.v9b=!0}return!1};this.lR=function(B,Q){B=Q.Ed;O.uBb=B;-1027730316!==B.command&&-1059615499!==B.command?O.CIa():(Q=Q.properties)&&
Q.launcherId!==O.pSh()&&O.CIa()};this.$=G;this.xrc=I;this.hr=K;this.km=L;this.zjc=this.uBb=this.rsd=null;this.s_=this.v9b=this.b7b=this.dec=!1;this.x_d=0;this.documentHidden=!1;this.grid=w.g(this.$);this.pasteRange=null;D.EwaSettings.xl()||this.$.da.Ga(406,this)}var e=b(10);t=b(0);var h=b(109),k=b(235),n=b(129),f=b(7),v=b(15),m=b(4),x=b(1610),l=b(13),u=b(5),A=b(1255),z=b(47),y=b(28),w=b(21),D=b(1),H=b(41),F=b(64),J=b(359),S=b(37),N=b(50);d.prototype.dispose=function(){this.fcg();this.mcg();this.zjc=
this.rsd=this.recoveryUI=this.km=this.hr=this.xrc=this.$=null;this.x_d=0};d.prototype.vPg=function(G){this.recoveryUI=G;this.rsd=G.gJg;this.zjc=G.m8i};d.prototype.CIa=function(){this.recoveryUI&&(this.pasteRange=H.K(this.recoveryUI.Kyh),this.BEj(),this.hide(),this.fcg(),this.recoveryUI=null)};d.prototype.BEj=function(){var G=[1868184698,-1985798686,753331043,2137617149,237279923,1804571062,1766348718,42074747,-875588320,-958589048,-185374993,-111689794,-1502853784,-1096627081,1441131127,-1027730316];
m.AFrameworkApplication.A_("XLS-SmartView-OnPasteEnabled-Control;XLS-SmartView-OnPasteEnabled-Treatment");D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.OnPasteEnabled",!1)&&this.pasteRange&&(v.ULS.sendTraceTag(523622037,0,50,"RecoveryUIController:smartViewOnPaste RecoveryUI is being dismissed."),null!=this.uBb&&G.includes(this.uBb.command)?(v.ULS.sendTraceTag(526758984,306,50,"RecoveryUIController:smartViewOnPaste Table hand raise is not triggered. Last command was "+A.a[this.uBb.command]),
this.uBb=null):this.documentHidden?(v.ULS.sendTraceTag(523833603,306,50,"RecoveryUIController:smartViewOnPaste Table hand raise is not triggered. User clicked outside of document."),this.documentHidden=!1):this.Dba()?this.oag():(v.ULS.sendTraceTag(520725721,306,50,"RecoveryUIController:smartViewOnPaste Grid is not in consistent state."),this.grid.LYa(this.Cya)))};d.prototype.Dba=function(){return this.grid.Ea.cK(4,this.$.pa)};d.prototype.Hmi=function(){return!!this.recoveryUI&&this.xrc.Sii};d.prototype.ECj=
function(G){this.recoveryUI?this.show(G):v.ULS.shipAssertTag(537154072,0,!1,"RecoveryUIController.ShowRecoveryUI: recoveryUI is null.")};d.prototype.pSh=function(){return this.recoveryUI?this.recoveryUI.Ssi:null};d.prototype.show=function(G){var I=this.recoveryUI.eOh();I?(this.xrc.showFloatie(Object(f.a)(new x.a,{x:I.x,y:I.y}),this.recoveryUI.dKa(),G),this.Pi()):v.ULS.sendTraceTag(537154071,0,100,"RecoveryUIController.Show: point is null.")};d.prototype.hide=function(){this.Hmi()&&this.xrc.tC();this.mcg()};
d.prototype.Pi=function(){if(!this.b7b){var G=w.g(this.$);G.view.Is(this.ieg);G.Gi.Ak(this.yIe);this.km.ka("blur",this.ehh);this.$.Ka.RFa(this.lR);this.$.xa.Mf(this.zIe);(G=this.$.da.za(65))&&G.j3&&G.j3.registerForCommentEvents(this.xIe);this.b7b=!0}this.dec||(this.hr.it(l.a.Lb,this.$.domElement,this.onKeyDown,!0),this.hr.it(l.a.Fd,this.$.domElement,this.onKeyUp,!0),this.dec=!0)};d.prototype.fcg=function(){if(this.b7b){var G=w.g(this.$);G.view.Gq(this.ieg);G.Gi.vk(this.yIe);this.km.detach("blur");
this.$.Ka.Sza(this.lR);this.$.xa.ug(this.zIe);(G=this.$.da.za(65))&&G.j3&&G.j3.unregisterForCommentEvents(this.xIe);this.b7b=!1}};d.prototype.mcg=function(){this.dec&&(this.hr.rt(l.a.Lb,this.$.domElement,this.onKeyDown,!0),this.hr.rt(l.a.Fd,this.$.domElement,this.onKeyUp,!0),this.dec=this.s_=this.v9b=!1)};d.prototype.vUj=function(){this.recoveryUI&&250<=y.a.Ta.Wd.m-this.x_d&&this.show(-1)};d.prototype.bOj=function(G){S.TaskExtensions.Aa(N.GetServiceTaskFactory.Ra(this.$.da,426,427,1),function(I){I.result.vea(G,
"Paste");v.ULS.sendTraceTag(523622036,0,50,"RecoveryUIController.triggerTableInvitationHandRaise: IntelligentMetadataOverlayManager is triggered.")},this.$.la,3)};Object(t.a)(d,"RecoveryUIController",null,[517,6]);var T=k.a;$k(c,T);c.prototype.create=function(){var G=this;if(D.EwaSettings.xl())this.hEi();else{var I=this.$;I.bB(function(K){K.Wec().then(function(L){G.pb(G.$.da.za(406)||new d(I,L,h.KeyInputManager.instance,n.a.instance.KG()))})})}};c.prototype.hEi=function(){var G=this,I=this.$,K=this.$.da.za(406);
K?this.pb(K):I.bB(function(L){L.Wec().then(function(O){K=new d(I,O,h.KeyInputManager.instance,n.a.instance.KG());G.$.da.Ga(406,K);G.pb(K)})})};c.ka=function(G){G.da.Ga(405,new c(G))};Object(t.a)(c,"RecoveryUIControllerFactory",k.a,[]);b.d(E,"a",function(){return a})},1490:function(t,E,b){function a(){Type.registerNamespace("Common.App.InsertFile")}b.d(E,"a",function(){return a})},1491:function(t,E,b){function a(){Type.registerNamespace("Common.App.InsertPicture")}b.d(E,"a",function(){return a})},
1572:function(t,E,b){function a(x,l,u){x=c.call(this,x,l,u)||this;x.zra=null;x.JVb=null;return x}function c(x,l,u){this.yj=this.YBd=null;this.SEa=this.gra=0;this.dTb=null;this.PS=x;this.ae=l;this.jb=u;this.D1a=!1;this.uZd=!0;this.Bhj();this.d9a=this.fa.qa("NativeFileOpenDialogIsEnabled")}t=b(0);var d=b(15),e=b(84);b(108);var h=b(27);c.prototype.QFb=function(x){this.yj=x;if(!this.D1a){if(this.uZd){if(this.d9a&&h.a.eF){this.dTb=x.s7b(Object(e.a)(this,this.jAd,"onFileChosen"));return}this.dTb=x.s7b(null);
if(!this.$Ba(this.dTb,x))return}this.finalizeUpload(x,null)}};c.prototype.jAd=function(x){if(this.$Ba(x,this.yj)){if(h.a.eF||h.a.Pf)this.dTb=x;this.finalizeUpload(this.yj,null)}};c.prototype.Voc=function(){this.YBd&&this.YBd()};c.prototype.Bhj=function(){this.gra=0;this.SEa=this.fa.kd("Box4UploadRetryDelayStart",200);this.yj&&(this.yj.dispose(),this.yj=null)};of.Object.defineProperties(c.prototype,{context:{configurable:!0,enumerable:!0,get:function(){return this.PS}},fa:{configurable:!0,enumerable:!0,
get:function(){return this.jb}},retryCount:{configurable:!0,enumerable:!0,get:function(){return this.gra}},SLd:{configurable:!0,enumerable:!0,get:function(){return this.SEa}}});Object(t.a)(c,"FileUploader",null,[]);var k=b(4),n=b(336),f=b(1005),v=b(135),m=b(29);b.d(E,"a",function(){return a});$k(a,c);a.prototype.WYe=function(x){switch(x){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;default:return""}};a.prototype.Rfg=function(x){return a.$Ba(x,
this.F0h())};a.prototype.F0h=function(){return a.ije};a.prototype.$Ba=function(x,l){l=void 0===l?null:l;x=this.Rfg(x);return 0!==x?(l&&l.ule(),2===x&&this.gj(0,this.WYe(x)),!1):!0};a.prototype.finalizeUpload=function(x,l){d.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");this.YBd=l;this.PBj();n.a.mark(5576);this.JVb=this.qO.sc("LoadResource","PictureUploadTime")};a.prototype.gj=function(x,l){var u=new v.StandardDialog;u.Rb=0;u.Lz(x,CommonUIStrings.l_ImageUploadFailedTitle,l,null)};
a.prototype.Voc=function(){d.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");c.prototype.Voc.call(this);this.JVb&&(this.JVb.stop(),this.JVb=null);this.D_g()};a.prototype.PBj=function(){this.zra=(new f.a).create();this.zra.message=CommonUIStrings.l_ImageUploadWait;this.zra.Rb=5;this.zra.Su=!1;this.zra.TAa(null,null,null)};a.prototype.D_g=function(){this.zra&&(this.zra.close(),this.zra=null)};a.H6h=function(x,l){x=m.a.cl(x);for(var u=0;u<l.length;++u)if(x.endsWith(l[u]))return!0;
return!1};a.$Ba=function(x,l){l=void 0===l?null:l;l||(l=a.ije);return x?a.H6h(x,l)?0:2:1};of.Object.defineProperties(a.prototype,{qO:{configurable:!0,enumerable:!0,get:function(){return k.AFrameworkApplication.ta.sD}}});a.ije=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(t.a)(a,"PictureUploader",c,[])},1644:function(t,E,b){function a(Ec){var $c=td.call(this)||this;$c.$=Ec;$c.Eb();return $c}function c(Ec,$c,id){id=void 0===id?!0:id;var vd=Oc.call(this)||this;vd.rSa=null;vd.Una=null;vd.sOa=
null;vd.W3b=null;vd.N0=null;vd.Srf=0;vd.hbb=!1;vd.gbb=!1;vd.jsc=!1;vd.documentVisibilityObserver=null;vd.Trf=null;vd.sDj=null;vd.Hfa=!1;vd.U7=0;vd.Xkd=0;vd.sAb=!1;vd.h5f=0;vd.hRd=!1;vd.a1=null;vd.nFb=function(){V.ULS.sendTraceTag(537155219,0,50,"NetworkConnectionStateManager.OnNetworkDownEvent: Network down.");vd.Flc(1,!1)};vd.K9a=function(){vd.Aka||vd.ECb?window.setTimeout(function(){vd.kWd()},vd.Srf):vd.kWd();vd.documentVisibilityObserver.KIb(vd.K9a);vd.sAb=!1};vd.Ef=function(){V.ULS.sendTraceTag(537155218,
0,50,"NetworkConnectionStateManager.OnEditEnded: Edit ended. IsInOfflineMode:"+(vd.ECb&&vd.nxc)+", IsInDuringWorkSilentReopenMode:"+(vd.Hkc&&!vd.Hfa&&vd.YLb));vd.ECb&&vd.nxc&&vd.hke();vd.Hkc&&!vd.Hfa&&vd.YLb&&vd.eke();zb.g(vd.$).$b.Nl(vd.Ef);vd.gbb=!1;vd.hbb=!1};vd.sAf=function(){V.ULS.sendTraceTag(537155213,0,50,"NetworkConnectionStateManager.OnNetworkResumedEvent: network was resumed.");vd.Flc(1,!0);vd.gbb&&!vd.hbb&&zb.g(vd.$).$b.Nl(vd.Ef);vd.gbb=!1};vd.UOa=function(he,Ge){vd.Xkd=vd.U7;vd.U7=Ge.lAc};
vd.uDf=function(){vd.$&&(vd.jsc||(Ob.a(vd.$).tQ(wc.a.aPa).ZFg(vd.CAf),vd.$.Uk(vd.Yc),vd.jsc=!0),vd.Hfa=vd.$fi(),vd.Flc(2,!1))};vd.CAf=function(){var he=Ob.a(vd.$).ii,Ge=he.hMg();he=Yc.f(he.vs.dd.errors,function(Ze){return Ze.MessageIdName});V.ULS.sendTraceTag(545842889,0,50,"NetworkConnectionStateManager.OnOpenWebMethodErrorUserAlertExecuting: IsStateUnrecoverable:"+Ge+", IsB2W:"+vd.Hfa+", Errors: "+Kb.a.xc(he));Ge&&(vd.rSa?(vd.Hfa=!1,vd.sGe(),vd.nBc()):vd.Una&&(vd.tGe(),vd.nBc()))};vd.Yc=function(){vd.$?
(V.ULS.sendTraceTag(541193955,0,50,"NetworkConnectionStateManager.OnWorkbookOpened: Workbook opened."),vd.Hfa=!1,Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:5543662_StopSilentReopenDuringWorkTimerMethodContextOnWorkbookOpened")&&vd.N0&&vd.N0.Mp&&(lc.a.Ia(vd.N0),vd.N0=null),Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&vd.a1&&vd.a1.Mp&&(lc.a.Ia(vd.a1),vd.a1=null),vd.Flc(2,!0),vd.nBc()):V.ULS.sendTraceTag(537155212,0,10,"NetworkConnectionStateManager.OnWorkbookOpened: bug monitoring: EwaControl is null.")};
vd.Vvf=function(){vd.Oqf(!0)};vd.Wvf=function(){vd.Oqf(!1)};vd.QWb=u.Nti;vd.j2c=u.connected;vd.$=Ec;vd.tf=Ec.oa.tf;vd.n2f=Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:5618694_BackToWorkLoadingUIEnabled");vd.YLb=Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:5798300_SilentReopenDuringWorkUIEnabled");vd.nxc=Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled");id&&(vd.Trf=new h(Ec,$c));Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:5589104_AlwaysInitDocumentVisibilityObserver")&&
vd.$.da.Za(291,function(he){vd.documentVisibilityObserver=he});vd.nxc&&(Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:5589104_AlwaysInitDocumentVisibilityObserver")||vd.$.da.Za(291,function(he){vd.documentVisibilityObserver=he}),vd.Srf=vd.$.ya.ExcelNetworkCheckAfterTabActivationDelayMs,vd.tf.dHg(vd.nFb),vd.tf.Gnb(vd.sAf),vd.tf.fne(vd.Vvf),vd.tf.EFg(vd.Wvf));if(vd.n2f||vd.YLb)vd.sDj=new d(vd.$,vd);vd.rnf=vd.$.ya.LongInactivityTimePeriodSeconds;vd.$.ea.FVc(vd.uDf);vd.$.ea.ef.Rra(vd.UOa);vd.YLb&&(vd.h5f=
vd.$.ya.SilentReopenDuringWorkDelayMs);return vd}function d(Ec){var $c=this;this.K7=null;this.vDf=function(id,vd){$c.sDf(vd,3)};this.Jzf=function(id,vd){$c.sDf(vd,2)};this.$=Ec;this.Tf=Xc.a(this.$).Tf;this.Tf.One(this.Jzf);this.Tf.rIg(this.vDf)}function e(Ec,$c,id,vd){Ec=l.call(this,Ec,$c,id)||this;Ec.wasInteruptedByOfflineMode=!1;Ec.type=vd;Ec.wasInteruptedByOfflineMode=!1;return Ec}function h(Ec,$c){this.Dla=this.cEi=this.Itf=null;this.$=Ec;!Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled")||
Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&ca.a.Pf||(this.Itf=new k(Ec,$c));!Fb.EwaSettings.ma(561)||Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&ca.a.Pf||(this.Dla=new Lb.NetworkConnectionHealthChecker(this.$));this.I2g=new v(this.$)}function k(Ec,$c){var id=this;this.rOa=this.tU=null;this.$Ed=-1;this.wub=null;this.akf=Wb.Task.delay(0);this.e$a=function(vd,he){he.TL?id.yQi(he.koa):id.zQi()};this.Ica=function(vd,
he){5===he.pGf&&id.$2a()};this.TVf=function(vd,he){id.tU.rrj(he.QU)};this.$2a=function(){id.rOa.ASj();id.ulj(k.cDd,Sys.Serialization.JavaScriptSerializer.serialize(id.rOa))};this.lgj=function(vd){if(vd=vd.result)id.Sgg=!0,V.ULS.sendTraceTag(576811915,0,50,"OfflineModeTelemetryManager.ReportOfflinePartialInteractivityDataFromIDB: Previous session's offline partial interactivy data: "+vd)};this.Daj=function(){id.Sgg&&(id.$?Oe.TaskExtensions.Aa(id.indexedDB.b6c(k.cDd),function(){V.ULS.sendTraceTag(537155204,
0,50,"OfflineModeTelemetryManager.RemoveDataFromIDB: Previous session's offline partial interactivy data successfuly removed from IDB.")},id.$.la):V.ULS.sendTraceTag(537155203,0,10,"OfflineModeTelemetryManager.RemoveDataFromIDB: EwaControl is null when attempting to remove offline mode data stored in IDB."))};this.wOa=function(){if(id.rOa&&0<id.rOa.count){var vd=Sys.Serialization.JavaScriptSerializer.serialize(id.rOa);V.ULS.sendTraceTag(560791644,0,50,"OfflineModeTelemetryManager.OnBeforeUnload: This session's offline partial interactivy data: "+
vd)}};this.$=Ec;this.indexedDB=$c;this.Sgg=!1;this.indexedDB.Df()&&(this.indexedDB.initialize(k.eld,k.fld),this.Ifj(),this.rOa=new f(this.$.ya.UserSessionId),Xc.a(this.$).Tf.mVc(this.e$a));this.km=ec.a.instance.KG();this.km.ka("beforeunload",this.wOa)}function n(Ec,$c,id){Ec=l.call(this,Ec,$c,id)||this;Ec.timeFromLastOffline=0;Ec._errorDataDuringOfflineMode=null;Ec.timeFromLastOffline=-1;Ec.type=5;return Ec}function f(Ec){this._count=0;this.sessionID=this.allOfflinePartialInteractivitiesDataInSession=
null;this.allOfflinePartialInteractivitiesDataInSession=[];this.sessionID=Ec}function v(Ec){var $c=this;this.pjc=this.data=null;this.L$c=0;this.zBe=null;this.Xvf=function(id,vd){vd.TL?($c.data=new x(Be.a.Ta.Jb,$c.$,5===vd.koa,0!==vd.koa,$c.$.tf.disconnectionSource,$c.zBe),$c.pjc=$c.$.tf.gkf,$c.L$c=1,$c.$.oa.tf.OIg($c.Kn),Uc.a($c.$).bVc($c.SVf)):($c.data.tJi($c.$,5===vd.koa),$c.$.oa.tf.tRf($c.Kn),$c.data.lastFailedRequestToOnlineTimeGapSec=Tb.getElapsedSeconds($c.pjc,Be.a.Ta.Jb),Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_7pzab_ConnectivityIssues")?
Ja.b().NKb(557682689,0,50,m.connectivityIssues,$c.data.durationMs,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",Kb.a.xc($c.data)):V.ULS.sendTraceTag(557682689,0,50,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: "+Kb.a.xc($c.data)),Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:5508233_ReportNetworkDownVeto")&&$c.data&&$c.data.isToastShown&&Fa.Health.instance.recordQosError(sd.a.WZg,[Nb.a.Xjc],
!0,!1,!1,!1,null),Uc.a($c.$).mJd($c.SVf),$c.data=null)};this.SVf=function(id,vd){$c.data.qrj(vd.QU)};this.Kn=function(id,vd){$c.data.M7i(vd.context.methodName);id=Be.a.Ta.Jb;vd=Tb.getElapsedSeconds($c.pjc,id);$c.pjc=id;vd>$c.data.longestDurationBetweenFailedRequestsSec&&($c.data.longestDurationBetweenFailedRequestsSec=vd);$c.L$c++;$c.data.averageDurationBetweenFailedRequestsSec=$c.CUg(vd)};this.Uvf=function(id,vd){$c.zBe=vd.fOj};this.$=Ec;Xc.a(this.$).Tf.gne(this.Xvf);this.$.tf.fne(this.Uvf)}function m(){}
function x(Ec,$c,id,vd,he,Ge){Ec=l.call(this,Ec,$c,vd)||this;Ec.swappedByOffline=!1;Ec.swappedOffline=!1;Ec.averageDurationBetweenFailedRequestsSec=0;Ec.longestDurationBetweenFailedRequestsSec=0;Ec.lastFailedRequestToOnlineTimeGapSec=0;Ec.disconnectionSource=null;Ec.errorDataDuringConnectivityIssuesMode=null;Ec.failedRequests=[];Ec.triggeringRequest=null;Ec.type=4;Ec.swappedOffline=id;Ec.disconnectionSource=Enum.toString(pd.a,he);Ec.triggeringRequest=Ge;return Ec}function l(Ec,$c,id){var vd=this,
he;this.type=0;this.startTime=null;this.blockedOperationsCount=this.durationMs=0;this.blockedActions=null;this.blockedUserOperationsWhileToastShown=this.durationUntilToastShownMs=0;this.toastRaiser=null;this.wasUserActiveOnPIEnd=this.wasUserActiveOnPIStart=this.hasTabbedOut=this.isToastShown=!1;this.durationUntilUserInactive=-1;this.isTaskPaneCollapsed=this.isTaskPaneShown=this.isDialogShown=!1;this.Nuf=function(Ge,Ze){vd.blockedOperationsCount++;Ge=Ze.componentName+"_"+Ze.actionName+"_"+Ze.details+
")";vd.blockedActions[Ge]=vd.blockedActions[Ge]?vd.blockedActions[Ge]+1:1;vd.isToastShown&&vd.blockedUserOperationsWhileToastShown++};this.aCd=function(Ge){vd.durationUntilUserInactive=Tb.getElapsedSeconds(vd.startTime,Be.a.Ta.Jb);Ge.VJd(vd.aCd)};this.p6=function(){vd.hasTabbedOut=!0};this.Ica=function(Ge,Ze){Ze.pGf!==vd.type||vd.isToastShown||(vd.durationUntilToastShownMs=pc.a(Be.a.Ta,vd.startTime),vd.toastRaiser=Ze.toastRaiser,vd.isToastShown=!0)};this.startTime=Ec;this.durationUntilToastShownMs=
0;this.blockedActions={};this.isToastShown=id;if(null===(he=$c.ea)||void 0===he?0:he.ef)this.wasUserActiveOnPIStart=$c.ea.ef.Ur;this.Pi($c);Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:5340853_ImprovePIData")?(this.isDialogShown=0<$c.ob.rR,Ec=$c.da.za(183),this.isTaskPaneShown=!!Ec&&Ec.isVisible&&!Ec.isCollapsed,this.isTaskPaneCollapsed=!!Ec&&Ec.isVisible&&Ec.isCollapsed):this.isTaskPaneCollapsed=this.isTaskPaneShown=this.isDialogShown=!1}function u(){}function A(Ec){var $c=Fe.call(this)||this;$c.Ec=
Ec;$c.Eb();return $c}function z(Ec,$c,id){id=void 0===id?null:id;var vd=ef.call(this)||this;vd.K_a=null;vd.A5a=null;vd.Tec=null;vd.TCa=null;V.ULS.sendTraceTag(537155417,0,50,"MergeSuspensionManager.ctor started");vd.$=Ec;vd.YWa=new T(Ec);Fb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SelectionAdjust",!1)&&(vd.pAa=new y(vd.$));vd.EIa=new H(vd.$.oa.va,vd.$,void 0,void 0,vd.pAa);vd.$$h(Ec,id);vd.Qfa=new G(vd.TCa,vd.YWa,vd.EIa);vd.OKd=new J(Ec,vd.Qfa,$c,vd.EIa);Fb.EwaSettings.ma(255)&&(vd.Tec=
new B(Ec,vd));V.ULS.sendTraceTag(588276810,0,50,"MergeSuspensionManager created");return vd}function y(Ec){var $c=this;this.$Mb=0;this.Jy=this.Px=null;this.J1d=new D;this.K1d=new D(!0);this.LC=0;this.SJj=!1;this.Hqf=1E4;this.Yc=function(){$c.TEe()};this.yi=function(){$c.AXc(!0,!1)};this.D9a=function(){$c.AXc(!1,!1)};this.$=Ec;this.gridView=zb.g(this.$);this.gridView.Ea.lx(this.yi);this.gridView.Ea.Hs(this.D9a);this.gridView.Ea.Yme(this.D9a);this.gridView.Ea.Sga(this.D9a);Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:6385622_SelectionAdjustImplementsCustomReportManager")&&
this.$.Uk(this.Yc);this.vgj=Fb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReportSelections",!1);this.TEe();this.yDb=Fb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SelectionAdjustMultiRangeSupport",!1);this.Rfj=Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:6354017_reportEditRaceCondition");this.lSf=Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:6367531_reportDivergenceOnResponse");this.Npe=Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:6409189_alwaysVerifyMaxBlockRevisionBeforeAdjust")}
function w(Ec,$c,id,vd,he,Ge){var Ze=this;this.NI=void 0;this.ib=Ec;this.eG=$c;this.x9=id;this.YWb=vd;this.BEc=he;Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:6592063_GetIndexOfActiveRangeFromInitialSelection_V2")&&(this.NI=Ge);this.$Ub=Fb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SelectionAdjustMultiRangeSupport",!1);this.g7d=Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:6399793_GetBlocksOnAdjustCheck");this.olg=Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:6399805_adjustIfNoCachedBlocks");
this.g7d||(this.$Ub?this.mRb=this.selectedRanges.map(function(gf){return Ze.UAc(gf,he)}):this.vCa&&(this.mRb=[this.UAc(this.selectedRanges[0],he)]))}function D(Ec){this.divergenceOnResponse=this.adjustedDidntChangeWithDivergence=this.editBoxDivergence=this.differentSheetAdjust=this.parallel=this.errors=this.nonContinuous=this.divergenceOnViewportReady=this.adjusted=this.adjustedDidntChange=0;this.C9h=void 0===Ec?!1:Ec}function H(Ec,$c,id,vd,he){id=void 0===id?null:id;vd=void 0===vd?null:vd;he=void 0===
he?null:he;var Ge=qd.call(this)||this;Ge.IBb=null;Ge.fCd=0;Ge.documentVisibilityObserver=null;Ge.rjf=!1;Ge.va=Ec;Ge.Rtc=$c.ya.MergeSuspensionRequestThrottlingTimeInMs;var Ze=$c.ya.GetRangeContentPrefetchDelayForMergeInMs;Ge.py=function(){$c.GWf(Ze)};Ge.dh=id||Be.a.Ta;Ge.JZd=0;Ge.vO=vd;Ge.pAa=he;Ge.bfg=Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:6248201_useDoPendingMergeSuccessCallback");Ge.gVg=Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:6237816_CallDoPendingMergeRequest");$c.da.Za(291,function(gf){Ge.documentVisibilityObserver=
gf});return Ge}function F(Ec,$c){var id=vc.call(this)||this;id.sqf=Ec;id.I_=$c;return id}function J(Ec,$c,id,vd){var he=Ie.call(this)||this;he.EIa=null;he.iBb=0;he.N7a=null;he.jBb=null;he.zBf=function(Ge,Ze){he.EIa.RNg(Ze.Y5,Ze.pKg,Ze.JDj)};he.MFb=function(Ge,Ze){Ze.Zwa?he.$Fj():he.Yyc()};he.Pzf=function(){he.iBb=0};he.YXf=function(){var Ge=he.Z5.mfd();S(he.va,null!=Ge.SuspensionStartTimestamp?Ge.SuspensionStartTimestamp:0,null,function(){he.UOi(Ge)},null,null,he.va.Pb())};he.hCa=function(Ge,Ze){if(Ze){Ze.aob.MergeCount=
he.Z5.mfd();var gf=zb.g(he.$).LBi();Ge=gf.min;gf=gf.max;Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:5524817_LogOnMergeRaceCondition2")?Ze.aob.ClientRevisions=Object(rd.a)(new N,{Min:Ge,Max:gf,MaxFromBlockCache:zb.g(he.$).Ea.$vd}):Ze.aob.ClientRevisions=Object(rd.a)(new N,{Min:Ge,Max:gf})}};he.$=Ec;he.GZa=id;he.Z5=$c;he.Z5.OHg(he.zBf);he.Z5.l_b(he.MFb);he.Z5.XGg(he.Pzf);he.$.oa.Wga(he.hCa);he.va=he.$.oa.va;he.Rtc=he.$.ya.MergeSuspensionRequestThrottlingTimeInMs;he.hri=he.$.ya.KeepBlockingPendingMergesRequestIntervalMs;
he.EIa=vd;V.ULS.sendTraceTag(588276807,0,50,"RequestController initialized");return he}function S(Ec,$c,id,vd,he,Ge,Ze){Ze=Ec.Na(1,void 0===Ze?null:Ze);Ze.suspensionStartTimestamp=$c;return Le.g(Ec,"KeepBlockingPendingMerges",Ze,id,vd,he,Ge,0)}function N(){}function T(Ec){var $c=we.call(this)||this;$c.W1=null;$c.ujc=0;$c.m8=function(id,vd){var he;if(null===(he=null===vd||void 0===vd?void 0:vd.Wc)||void 0===he?0:he.MergeCount)qc.a.equals(vd.Wc.SessionId,$c.$.ea.sessionId,!1)?$c.Fya(vd.Wc.MergeCount,
T.btb):V.ULS.sendTraceTag(579737049,0,50,"Stale merge counter ("+vd.Wc.MergeCount.Current+"/"+vd.Wc.MergeCount.Pending+")")};$c.iDb=function(id,vd){(null===vd||void 0===vd?0:vd.Y5)&&$c.Fya(vd.Y5,T.N_d)};$c.Rvc=function(){$c.ETf();$c.kLf($c.W1,T.thj)};$c.N9a=function(id,vd){vd.Wqb&&$c.W1.SuspensionStartTimestamp&&V.ULS.sendTraceTag(17318084,0,50,"PendingMergeMonitor.OnEditCellEnded: committed with counter "+ia($c.W1))};$c.ETf();$c.$=Ec;$c.$.ea.Vj($c.Rvc);$c.$.ea.YL($c.Rvc);zb.g($c.$).Wb.um($c.N9a);
Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:6329027_UpdateMergeCountWhenWebMethodReturnsWithErrors")||$c.$.oa.Rq($c.m8);$c.$.da.Za(292,function(id){id.PYa($c.iDb);V.ULS.sendTraceTag(588276809,0,50,"PendingMergeMonitor initialized")});return $c}function G(Ec,$c,id){var vd=Je.call(this)||this;vd.Gya=function(he,Ge){he=vd.getState();var Ze=vd.I_;vd.I_=Ge.Y5;Ge=vd.getState();vd.Pwi(he,Ge,Ze);vd.raiseEvent(G.rwd);vd.HTe(he,Ge)};vd.POa=function(he,Ge){he=vd.getState();vd.MH=Ge.MH;Ge=vd.getState();vd.HTe(he,
Ge)};vd.hFb=function(he,Ge){vd.b7a&&4===Ge.sqf&&(V.ULS.sendTraceTag(520480203,0,50,"MergeSuspensionStateHandler.onMergeDidntOccur: Retry DoPendingMerge after bailout. Current merge counter: {0}, Response merge counter: {1}",ia(vd.I_),ia(Ge.I_)),vd.tLf(vd.getState(),!0))};vd.lzb=Fb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DoPendingMergeWhenUnsafe",!1);vd.b7a=Fb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RetryDoPendingMergeAfterBailout",!1);vd.Oha=Ec;vd.Oha.g_b(vd.POa);
vd.uma=$c;vd.uma.PYa(vd.Gya);vd.b7a&&(vd.dya=id,vd.dya.Rne(vd.hFb));vd.I_=Object(rd.a)(new md.a,{Pending:0,Current:0,SuspensionStartTimestamp:null});vd.MH=vd.F$h();return vd}function I(Ec,$c,id){Ec=xe.call(this,Ec)||this;Ec.pKg=$c;Ec.JDj=id;return Ec}function K(Ec){this.Cpe=!1;this.Cpe=Ec;return this}function L(){}function O(Ec){var $c=Cc.call(this)||this;$c.Zwa=Ec;return $c}function B(Ec,$c){var id=Jc.call(this)||this;id.statusBarManager=null;id.Sxd=!1;id.Gya=function(vd,he){vd=(he.Y5.Current===
he.Y5.Pending?"\u26ad":"\u26ae")+he.Y5.Current;qc.a.equals(id.emc,vd,!1)||(id.emc=vd,id.uz())};id.POa=function(vd,he){vd=0==he.MH;id.Sxd!==vd&&(id.Sxd=vd,id.uz())};id.mergeSuspensionManager=$c;id.mergeSuspensionManager.uma.PYa(id.Gya);id.emc="";mb.a.J9(1905775613,ic.a.wc,0,1);id.Ka=Ec.Ka;id.WNb=new Q;Ec.da.Za(29,function(vd){id.mergeSuspensionManager&&(id.statusBarManager=vd,vd.gJ(id),id.mergeSuspensionManager.Oha.g_b(id.POa))});id.Ka.K9(id.WNb);return id}function Q(){return hc.call(this)||this}function U(Ec,
$c){$c=void 0===$c?null:$c;var id=nc.call(this,1)||this;id.Jfa=!1;id.uN=function(){id.refresh()};id.gwf=function(){id.refresh()};id.$=Ec;id.a8d=$c||Ob.a(Ec).tQ(wc.a.idle);Ob.a(Ec).aVc(id.gwf);id.z5a.hq(id.uN);id.refresh();return id}function X(Ec,$c){var id=xb.call(this)||this;id.Zjf=null;id.Y7a=!1;id.hFb=function(vd,he){3===he.sqf&&id.Y7a&&V.ULS.sendTraceTag(520480204,0,15,"ClientStateMonitor.onMergeDidntOccur: Aborted merge occurred after another aborted merge.");id.Y7a=!0;id.Jab()};id.XQa=new Ia.a;
id.dya=Ec;id.uma=$c;id.lzb=Fb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DoPendingMergeWhenUnsafe",!1);id.b7a=Fb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RetryDoPendingMergeAfterBailout",!1);id.lzb&&(id.uma.PYa(id.Gya.bind(id)),id.b7a?id.dya.Rne(id.hFb):id.dya.YGg(id.Qzf.bind(id)));return id}function P(Ec){return(null===Ec||void 0===Ec?void 0:Ec.SuspensionStartTimestamp)&&Ec.Pending>Ec.Current}function ea(Ec,$c){return Ec||$c?Ec&&$c?Ec.Current===$c.Current&&Ec.Pending===
$c.Pending&&Ec.SuspensionStartTimestamp===$c.SuspensionStartTimestamp:!1:!0}function ia(Ec){return Ec?Ec.Current+" / "+Ec.Pending+" @"+Ec.SuspensionStartTimestamp:null}function da(Ec,$c){this.handler=null;this.publisher=Ec;this.MH=$c}function xa(Ec){var $c=fc.call(this,1)||this;$c.Jfa=!1;$c.cvf=function(){$c.refresh()};$c.dvf=function(){$c.refresh()};$c.gridView=zb.g(Ec);$c.gridView.Wb.Ak($c.dvf);$c.gridView.Wb.um($c.cvf);$c.refresh();return $c}function Z(Ec){var $c=Ub.call(this)||this;$c.Vkd=null;
$c.$=Ec;$c.Eb();return $c}function ha(Ec){var $c=wa.call(this)||this;$c.$=Ec;$c.Eb();return $c}function ya(Ec,$c){this.WTe=Ec;this.ICh=$c}function va(Ec){this.$=Ec}function bb(){this.fb=null}function ba(){this.Lib=this.jTb=this.Ev=null}function fa(Ec,$c,id,vd,he){this.Ev=Ec;this.Yib=$c;this.Uib=id;this.Qde=void 0===vd?null:vd;this.blb=void 0===he?null:he}function ra(){this.fb=null}function pa(Ec){this.Vb=Ec}function Za(){this.yie=0;this.EWa=Array(5);this.EWa[0]=10;this.EWa[1]=15;this.EWa[2]=50;this.EWa[3]=
100;this.EWa[4]=200}function Ua(Ec,$c,id,vd,he){this.R$b=!1;this.Gsb=null;this.La=Ec;this.nFa=$c;this.pWb=id;this.s1=vd;this.fFc=he}function Ma(){this.TOf=this.QTf=this.U8f=this.Pjc=this.instance=null}function oa(Ec,$c,id){this.La=Ec;this.Ue=$c;this.LTb=id}function ja(){this.completed=this.gaj=!1}function ta(){this.Xge=this.vbe=this.j2d=!0;this.Cfj=this.PZi=null;this.gDi=!1;this.locale=null;this.Ebg={}}function aa(){}function ma(){this.PVb=this.iTb=null}function Ea(Ec){return cb.call(this,Ec)||this}
b.r(E);var Ha=b(1360),Aa=b(0),V=b(15),La=b(4),Ra=b(120),pb=b(427),cb=pb.a;$k(Ea,cb);Ea.prototype.createElement=function(){var Ec=document.createElement("link");Ec.setAttribute("rel","stylesheet");Ec.setAttribute("type","text/css");Ec.setAttribute("href",this.jt);return Ec};Ea.prototype.M3c=function(){return null};Ea.prototype.psc=function(){this.element.setAttribute("href","");this.element.setAttribute("href",this.Gz.jt)};of.Object.defineProperties(Ea.prototype,{y4b:{configurable:!0,enumerable:!0,
get:function(){return!1}}});Object(Aa.a)(Ea,"CssResource",pb.a,[]);var Sa=b(397),Db=b(239),Ab=b(29),Wb=b(58);ma.prototype.Zti=function(){this.iTb||(V.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),this.iTb=Wb.Task.WAA(ma.dui(),ma.Wti()),this.iTb.continueWith(function(Ec){V.ULS.sendTraceTag(21030599,324,10,"{0}",Ab.a.Xdd(Ec.exception))},5));return this.iTb};ma.prototype.aui=function(){if(!this.PVb)try{V.ULS.sendTraceTag(39978390,324,50,"InProductMessagingFreemiumDependenciesLoad usage"),
this.PVb=Wb.Task.WAA(ma.j8c(Db.a.create(La.AFrameworkApplication.fa.Wa("DimeUrl"),null,null))),this.PVb.continueWith(function(Ec){V.ULS.sendTraceTag(39978391,324,10,"{0}",Ab.a.Xdd(Ec.exception))},5)}catch(Ec){V.ULS.sendTraceTag(594874951,324,10,"{0}",Ab.a.Xdd(Ec))}return this.PVb};ma.dui=function(){var Ec=ma.Kcc("inproductmessaging.js");Ec=Db.a.create(Ec,null,null);return ma.j8c(Ec)};ma.Wti=function(){var Ec=ma.Kcc("inproductmessaging.css");Ec=new Ea(Ec);return ma.j8c(Ec)};ma.Kcc=function(Ec){return Ra.a.E3b(String.format("ipm/{0}",
Ec))};ma.j8c=function(Ec){Sa.a.Bia(Ec);return Ec.o8a};Object(Aa.a)(ma,"DependencyDownloader",null,[992]);aa.bXi="inProductMessagingOverlayDiv";aa.OZi="PlayButtonImage";aa.Bfj="ReplayButtonImage";Object(Aa.a)(aa,"Constants",null,[]);ta.prototype.rtj=function(){this.Kme(aa.OZi,this.PZi);this.Kme(aa.Bfj,this.Cfj)};ta.prototype.Kme=function(Ec,$c){$c&&(this.Ebg[Ec]=$c)};of.Object.defineProperties(ta.prototype,{rOg:{configurable:!0,enumerable:!0,get:function(){return this.j2d},set:function(Ec){this.j2d=
Ec}},jCi:{configurable:!0,enumerable:!0,get:function(){return this.vbe},set:function(Ec){this.vbe=Ec}},LBj:{configurable:!0,enumerable:!0,get:function(){return this.Xge},set:function(Ec){(this.Xge=Ec)&&this.rtj()}}});Object(Aa.a)(ta,"FirstRunExperienceUISettings",null,[991]);Object(Aa.a)(ja,"FirstRunExperienceViewData",null,[990]);var ub=b(84),vb=b(181),Ka=b(107),eb=b(25);oa.prototype.Ag=function(){this.La.He(eb.a.JCh,Ka.a.frame,Object(ub.a)(this,this.HCh,"firstRunExperienceHandler"),64);this.La.Mb(eb.a.VTe,
Ka.a.frame,Object(ub.a)(this,this.F9h,"inProductMessagingTabHandler"));this.La.Mb(eb.a.UTe,Ka.a.frame,Object(ub.a)(this,this.E9h,"inProductMessagingShiftTabHandler"));this.La.Mb(eb.a.Agh,Ka.a.frame,Object(ub.a)(this,this.Bgh,"dimeLaunchHandler"));this.La.Mb(eb.a.qSf,Ka.a.frame,vb.ActionManager.fg);this.La.Mb(eb.a.Zfj,Ka.a.frame,vb.ActionManager.fg);this.La.Mb(eb.a.$fj,Ka.a.frame,vb.ActionManager.fg);this.Ue&&this.Ue.updateCommandUI()};oa.prototype.HCh=function(Ec,$c,id,vd,he){2===id&&this.LTb.xsi(he);
return 32};oa.prototype.Bgh=function(Ec,$c,id,vd,he){2===id&&this.LTb.usi(he);return 32};oa.prototype.F9h=function(Ec,$c,id){return 2===id?this.LTb.Swd():32};oa.prototype.E9h=function(Ec,$c,id){return 2===id?this.LTb.Qwd():32};Object(Aa.a)(oa,"InProductMessagingActor",null,[]);var yb=b(85);Object(Aa.a)(Ma,"DimeExperienceUISettings",null,[]);var oc=b(167),Jb=b(507);Ua.prototype.qbi=function(Ec){oc.b("getHeaderApi")?Ec.isFeatureEnabled("MsoPremiumBadge",!0).then(function($c){var id=Ec.isFreemiumUpsellEnabled();
id&&(appChrome.getHeaderApi().then(function(vd){vd.updatePremiumStatus($c,id);return null}),Ec.Lma("MsoPremiumBadge",function(vd){appChrome.getHeaderApi().then(function(he){he.updatePremiumStatus(vd.isEnabled,id);return null})}));return null}):V.ULS.sendTraceTag(593859840,324,10,"getHeaderApi not available")};Ua.prototype.xsi=function(Ec){var $c=this;this.pWb.Zti().continueWith(function(){$c.nFa.fDj(Ec)})};Ua.prototype.usi=function(Ec){function $c(){}var id="gopremium",vd=null;Ec?(Ec.experience&&
""!==Object(yb.a)(String,Ec.experience)&&(id=Object(yb.a)(String,Ec.experience)),Ec.onTaskComplete&&($c=Ec.onTaskComplete),Ec.campaignId&&""!==Object(yb.a)(String,Ec.campaignId)&&(vd=Object(yb.a)(String,Ec.campaignId))):V.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");this.rkf(id,$c,vd)};Ua.prototype.rkf=function(Ec,$c,id){var vd=this;id=void 0===id?null:id;if(this.R$b&&this.Gsb){var he={};he.experience=Ec||"gopremium";he.campaignId=id||Jb.b(this.s1,this.fFc,Object(yb.a)(String,
he.experience),!0);this.La.processAction(eb.a.qSf,2);V.ULS.sendTraceTag(51675403,324,50,"Launching Freemium Upsell dialog: "+he.experience);try{var Ge=Object.assign(new Ma,{instance:this.Gsb,Pjc:he,U8f:$c||function(){},QTf:function(Ze){V.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+Ze.status)},TOf:function(){V.ULS.sendTraceTag(51675406,324,10,"Dime launch error");vd.R$b=!1;vd.Gsb=null}});this.nFa.rBj(Ge)}catch(Ze){V.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+Ze.message),this.R$b=
!1,this.Gsb=null,Ec={},this.La.$d(eb.a.S$b,2,(Ec.experience=he.experience,Ec))}}else V.ULS.sendTraceTag(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),he={},this.La.$d(eb.a.S$b,2,(he.experience=Ec,he))};Ua.prototype.hlf=function(){var Ec=this;this.pWb.aui().continueWith(function(){try{var $c=Ab.a.cl(La.AFrameworkApplication.uiCulture),id=Jb.c(Ec.s1);if(id){$c={partnerId:id,language:$c};$c.sessionId=La.AFrameworkApplication.userSessionId;$c.authHint=La.AFrameworkApplication.fa.Wa("UserPrincipalName");
var vd=La.AFrameworkApplication.fa.Wa("Puid")||"";""!==vd&&($c.userInfo={puid:vd});Ec.Gsb=new Dime($c);Ec.R$b=!0;V.ULS.sendTraceTag(592721856,324,50,"Dime initialized")}else V.ULS.sendTraceTag(51675409,324,15,"App not supported")}catch(he){V.ULS.sendTraceTag(51675410,324,10,"FreemiumUpsellDialogDependencies failed: "+he.message)}},3)};Ua.prototype.Swd=function(){return this.nFa.Swd()};Ua.prototype.Qwd=function(){return this.nFa.Qwd()};Object(Aa.a)(Ua,"InProductMessagingUIManager",null,[989]);Za.prototype.Init=
function(Ec){this.yie=Ec};Za.prototype.SendTrace=function(Ec,$c){V.ULS.sendTraceTag(34182235,this.yie,this.EWa[Ec],"{0}",$c)};Object(Aa.a)(Za,"DefaultNetworkingManager",null,[999]);var dc=b(275),$a=b(331),Ba=b(96);pa.prototype.fDj=function(Ec){Ec&&(InProductMessaging.Networking.NetworkingMgr=new Za,InProductMessaging.Networking.NetworkingMgr.Init(387),InProductMessaging.Init(Ec.LBj,Ec.jCi,Ec.rOg,Ec.gDi,Ec.locale,Object(ub.a)(this,this.sKi,"onDismissFirstRunExperience"),Ec.Ebg),this.GRa(aa.bXi,!0))};
pa.prototype.rBj=function(Ec){var $c=this;if(Ec&&Ec.instance&&Ec.Pjc){var id=document.getElementById("wacDimeContainer");id||(id=document.createElement("div"),id.id="wacDimeContainer",document.body.appendChild(id));La.AFrameworkApplication.fa.qa("DimeFocusManagerIsEnabled")&&this.GRa("wacDimeContainer",!1);Ec.Pjc.parentElementId="wacDimeContainer";Ec.instance.launch(Ec.Pjc,Ec.U8f).then(function(vd){$c.tIb();document.body.removeChild(id);Ec.QTf(vd)}).catch(function(vd){$c.tIb();document.body.removeChild(id);
Ec.TOf(vd)})}else throw Error.argument("DimeExperienceUISettings");};pa.prototype.GRa=function(Ec,$c){if(this.Vb&&Ec&&(Ec=document.getElementById(Ec),this.hbi(Ec),Ec=this.Vb.KM("InProductMessagingFocusId"))){var id=this.Vb.ji;id&&"InProductMessagingFocusId"===id.name||this.Vb.xR("InProductMessagingFocusId",!1);$c&&this.ZMf(Ec.scope)}};pa.prototype.hbi=function(Ec){var $c=!1;$c=void 0===$c?!0:$c;var id=this.Vb.li("InProductMessagingFocusId");id.parent=dc.AFrame.OT;var vd=new $a.DOMFocusListing(function(){return Ec});
vd.kbb=$c;vd.Un(3);vd.Un(2);vd.Un(4);$c=this.Vb.usa(function(){return Ec},id,vd);$c.lIb();$c.C_=!0;$c.zHa=!0};pa.prototype.ZMf=function(Ec){Ec.ik(Ba.FocusManager.instance().i2);Ec.ik(Ba.FocusManager.instance().j2);Ec.bindAction(Ba.FocusManager.instance().i2,eb.a.VTe);Ec.bindAction(Ba.FocusManager.instance().j2,eb.a.UTe)};pa.prototype.tIb=function(){this.Vb&&(this.Vb.Uca("InProductMessagingFocusId"),this.Vb.oQa("InProductMessagingFocusId"))};pa.prototype.sKi=function(Ec,$c){this.tIb();Ec=Object.assign(new ja,
{completed:Ec,gaj:$c});La.AFrameworkApplication.ub.$d(eb.a.GCh,2,Ec)};pa.prototype.Swd=function(){var Ec=document.activeElement,$c=this.Vb.vQ();return Ec&&$c&&$c.Xe&&Ec===$c.Xe.mw?($c.Xe.ul(Ec),$c.hya()?32:8):4};pa.prototype.Qwd=function(){var Ec=document.activeElement,$c=this.Vb.vQ();return Ec&&$c&&$c.Xe&&Ec===$c.Xe.firstElement?($c.Xe.ul(Ec),$c.hOa()?32:8):4};Object(Aa.a)(pa,"InProductMessagingUIWrapper",null,[988]);var la=b(142),ka=b(258),ca=b(27);ra.prototype.Sh=function(Ec){Ec.register(ma,"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").tc().Dc(function(){return new ma});
Ec.register(pa,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").tc().Dc(function(){return new pa(Ba.FocusManager.instance())});Ec.register(Ua,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").tc().Dc(function(){return new Ua(La.AFrameworkApplication.ub,Ec.resolve("Common.IInProductMessagingUIWrapper"),Ec.resolve("Common.App.InProductMessaging.IDependencyDownloader"),La.AFrameworkApplication.ta.Qa.rj,
La.AFrameworkApplication.ta.Qa.j6)});Ec.register(oa,"Common.App.InProductMessaging.InProductMessagingActor").tc().Dc(function(){return new oa(La.AFrameworkApplication.ub,La.AFrameworkApplication.ta,Ec.resolve("Common.IInProductMessagingUIManager"))});Ec.register(ta,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").tc().Dc(function(){return new ta});Ec.register(ja,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").tc().Dc(function(){return new ja});
this.fb=Ec};ra.prototype.init=function(){var Ec=this;this.fb.resolve("Common.App.InProductMessaging.InProductMessagingActor").Ag();La.AFrameworkApplication.fa.Vu(function(){La.AFrameworkApplication.ta.Qa.isReactSharedHeaderUxEnabled&&la.a.get_instance().ak(15,function(){Ec.fb.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function($c){Ec.fb.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").qbi($c)})});La.AFrameworkApplication.fa.qa("FreemiumUpsellShowDialogIsEnabled")&&
Jb.a()&&!ca.a.Gka&&1!==La.AFrameworkApplication.ta.Qa.rj&&Ec.fb.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function($c){$c.isFeatureEnabled("MsoPremiumBadge",!0).then(function(id){!id&&$c.isFreemiumUpsellEnabled()&&Ec.fb.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").hlf();return null})})})};ra.prototype.dispose=function(){};ra.main=function(){ka.a.instance.Qi(new ra)};of.Object.defineProperties(ra.prototype,{name:{configurable:!0,enumerable:!0,
get:function(){return"Common.App.InProductMessaging"}}});Object(Aa.a)(ra,"InProductMessagingPackage",null,[10,11]);var Ia=b(192),jb=b(42);fa.prototype.n9b=function(Ec){var $c=new Sys.StringBuilder(this.Ev.MJb);$c.append("RoamingServiceHandler.ashx?action=");$c.append("getFirstRunExperienceSettings");$c.append("&");$c.append(this.Xfd(Ec));$c.append("&");$c.append(La.AFrameworkApplication.Yi);La.AFrameworkApplication.nd.Zl($c.toString(),1,null,null,!0,2,Object(ub.a)(this,this.Jja,"getRequestSuccessCallback"),
Object(ub.a)(this,this.o4,"getRequestFailureCallback"),null)};fa.prototype.F2a=function(Ec){var $c=new Sys.StringBuilder(this.Ev.MJb);$c.append("RoamingServiceHandler.ashx?action=");$c.append("saveFirstRunExperienceSettings");$c.append("&");$c.append(La.AFrameworkApplication.Yi);$c=$c.toString();Ec=jb.c(Ec);La.AFrameworkApplication.nd.Zl($c,2,Ec,null,!0,4,Object(ub.a)(this,this.n0i,"postRequestSuccessCallback"),Object(ub.a)(this,this.kW,"postRequestFailureCallback"),null)};fa.prototype.Jja=function(Ec){var $c=
!1,id=null;try{if(0<Ec.data.Rd.length){var vd=Object(yb.a)(Object,jb.a(Ec.data.Rd)),he=vd?vd[this.Ev.xWc]:null;he&&(id=Object(yb.a)(Object,jb.a(he.toString())))}$c=!0}catch(Ge){this.o4(null)}$c&&this.Yib&&this.Yib(Ec.data,id)};fa.prototype.o4=function(Ec){this.Uib&&this.Uib(Ec?Ec.data:null)};fa.prototype.n0i=function(Ec){this.Qde&&this.Qde(Ec?Ec.data:null)};fa.prototype.kW=function(Ec){this.blb&&this.blb(Ec?Ec.data:null)};fa.prototype.Xfd=function(Ec){for(var $c=new Sys.StringBuilder("requestedsettings="),
id=0;id<Ec.count;id++)$c.append(Ec.na(id)),id<Ec.count-1&&$c.append(";");return $c.toString()};Object(Aa.a)(fa,"FirstRunExperienceRequestHandler",null,[]);var nb=b(242),Na=b(83);ba.prototype.gSd=function(Ec){Ec?(this.Ev=Ec,this.Qki()&&(V.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),Ec=new Ia.a,Ec.add(this.Ev.xWc),this.jTb=new fa(this.Ev,Object(ub.a)(this,this.Jja,"getRequestSuccessCallback"),Object(ub.a)(this,this.o4,"getRequestFailureCallback"),
null,Object(ub.a)(this,this.kW,"postRequestFailureCallback")),this.jTb.n9b(Ec)),(this.Ev.w7a||La.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.hSd()):V.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")};ba.prototype.Qki=function(){try{if(this.Ev.w7a)return!0;if(!La.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||La.AFrameworkApplication.fa.qa("IsAnonymousUser"))return!1;
if(this.Ev.Khi||this.Ev.y7a||La.AFrameworkApplication.fa.qa("IsO365ConsumerHost"))return!0;var Ec=La.AFrameworkApplication.fa.Wa("FlightId");return-1!==(Ec?Ec.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch($c){V.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",$c?$c.toString():null)}return!1};ba.prototype.UVf=function(Ec){var $c={},id={};id.FREDisplayedDate=(new Date).toUTCString();id.VersionDisplayed=Ec;id.RemindMeLater=!1;$c[this.Ev.xWc]=jb.c(id);V.ULS.sendTraceTag(51675533,
306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.jTb&&this.jTb.F2a($c)};ba.prototype.Jja=function(Ec,$c){Ec=Ec?+Ec.l3-+Ec.ZE:-1;Ec>this.Ev.LUf?V.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",Ec,this.Ev.LUf):$c?this.fAj($c)?(V.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",
this.Ev.Fqf),this.hSd()):(this.G6c(!1),V.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(V.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.hSd())};ba.prototype.o4=function(Ec){this.G6c(!1);V.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",Ec?Ec.httpStatus:-1)};ba.prototype.kW=function(Ec){V.ULS.sendTraceTag(51675542,
306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",Ec?Ec.httpStatus:-1)};ba.prototype.hSd=function(){var Ec=this;this.G6c(!0);var $c=Na.a.instance.nh("Common.ISystemInitiatedFeedback");$c?this.P3f($c):(V.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),La.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&(($c=Na.a.instance.Tb("Common.ISystemInitiatedFeedback"))?
$c.execute(function(id){Ec.P3f(id)}):V.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))};ba.prototype.P3f=function(Ec){if(Ec){var $c=this.Ev.UCh;$c&&(La.AFrameworkApplication.Lxa($c),La.AFrameworkApplication.A_($c));V.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",$c);Ec.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.Lib=Object(ub.a)(this,this.qLi,"onFirstRunExperienceCampaignEvent"),
window.addEventListener("FGWebSurfaceEvent",this.Lib,!0),window.addEventListener("FRELaunchedEvent",this.Lib,!0)):(V.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.UVf(this.Ev.currentVersion))}else V.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")};ba.prototype.qLi=function(Ec){if(Ec){var $c=Ec.detail;Ec=Ec.type;var id=this.Ev&&this.Ev.campaignId?this.Ev.campaignId.split("-")[0]:null;if("FRELaunchedEvent"===Ec||id&&$c&&$c.id&&-1!==
$c.id.indexOf(id))$c.success&&(V.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.UVf(this.Ev.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.Lib,!0),window.removeEventListener("FRELaunchedEvent",this.Lib,!0))}};ba.prototype.fAj=function(Ec){if("RemindMeLater"in Ec&&"FREDisplayedDate"in Ec){if("true"===Ec.RemindMeLater.toString()&&(+new Date-+new Date(Ec.FREDisplayedDate.toString()))/36E5>this.Ev.Fqf)return!0}else if(La.AFrameworkApplication.fa.qa("WacShowVersionBasedFREToAllUsers")&&
"VersionDisplayed"in Ec&&Ec.VersionDisplayed<this.Ev.currentVersion)return V.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1};ba.prototype.G6c=function(Ec){if(La.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")){var $c={};Ec=($c.show=Ec,$c);nb.a.dispatch("FREDecisionEvent",Ec)}};Object(Aa.a)(ba,"FirstRunExperienceLauncher",null,[944]);bb.prototype.Sh=function(Ec){this.fb=
Ec;this.fb.register(944,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").tc().Dc(function(){return new ba})};bb.prototype.init=function(){};bb.prototype.dispose=function(){};bb.main=function(){ka.a.instance.Qi(new bb)};of.Object.defineProperties(bb.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.FirstRunExperienceLauncher"}}});Object(Aa.a)(bb,"FirstRunExperienceLauncherPackage",null,[10,11]);var sa=b(1490),Wa=b(1491),Hb=b(1349),Yb=b(1463),Sb=b(10),
lb=b(235);va.prototype.isEnabled=function(){if(La.AFrameworkApplication.fa?La.AFrameworkApplication.fa.qa("IsAnonymousUser"):1)return!1;var Ec=La.AFrameworkApplication.Ob?Object(yb.a)(String,La.AFrameworkApplication.Ob.AudienceGroup):"";return"Unknown"!==Ec&&"Automation"!==Ec};of.Object.defineProperties(va.prototype,{xWc:{configurable:!0,enumerable:!0,get:function(){return"Excel"}},campaignId:{configurable:!0,enumerable:!0,get:function(){return"aed9de6b-d4e7-4878-988a-9dfec66fed9e"}},version:{configurable:!0,
enumerable:!0,get:function(){return 1}},currentVersion:{configurable:!0,enumerable:!0,get:function(){return 0}},Khi:{configurable:!0,enumerable:!0,get:function(){return this.isEnabled()&&this.$.ma(337)}},y7a:{configurable:!0,enumerable:!0,get:function(){return this.isEnabled()&&this.$.ma(339)}},w7a:{configurable:!0,enumerable:!0,get:function(){return this.$.ma(338)}},UCh:{configurable:!0,enumerable:!0,get:function(){return null}},Fqf:{configurable:!0,enumerable:!0,get:function(){return 24}},LUf:{configurable:!0,
enumerable:!0,get:function(){return 4E3}},MJb:{configurable:!0,enumerable:!0,get:function(){return this.$.ya.WebServiceBase||""}}});Object(Aa.a)(va,"FirstRunExperienceLauncherSettings",null,[942]);ya.prototype.gSd=function(){this.WTe&&this.WTe.gSd(this.ICh)};Object(Aa.a)(ya,"FirstRunExperienceManager",null,[939]);var wb=b(921),wa=lb.a;$k(ha,wa);ha.prototype.create=function(){var Ec=this,$c=Object(wb.a)(this.$.da,311,function(){return Ec.L7g()});this.pb($c)};ha.prototype.L7g=function(){var Ec=new va(this.$);
Ec=new ya(Na.a.instance.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"),Ec);Ec.gSd();return Ec};ha.ka=function(Ec){Ec.da.Ga(312,new ha(Ec))};Object(Aa.a)(ha,"FirstRunExperienceManagerFactory",lb.a,[]);var Oa=b(59),Ub=lb.a;$k(Z,Ub);Z.prototype.create=function(){var Ec=this,$c=Object(wb.a)(this.$.da,361,function(){return Ec.x8g()});this.pb($c)};Z.prototype.x8g=function(){var Ec=this;this.Vkd=Na.a.instance.nh("Common.IInProductMessagingUIManager");Oa.a.pg.isReactSharedHeaderUxEnabled?
la.a.get_instance().ak(16,function(){Ec.aaf()}):this.aaf();return this.Vkd};Z.prototype.aaf=function(){var Ec=this;Na.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function($c){$c.isFeatureEnabled("MsoPremiumBadge",!0).then(function(id){!id&&$c.isFreemiumUpsellEnabled()&&Ec.Vkd.hlf();return null})})};Z.ka=function(Ec){Ec.da.Ga(362,new Z(Ec))};Object(Aa.a)(Z,"InProductMessagingManagerFactory",lb.a,[]);var hb=b(1401),Xb=b(1326),Gc=b(47),uc=b(445),Nc=b(79),Fb=
b(1),ob=b(601),zb=b(21),ib=b(648),fc=ob.a;$k(xa,fc);xa.prototype.RPd=function(Ec){this.Jfa!==Ec&&(this.Jfa=Ec,this.AHb())};xa.prototype.dispose=function(){this.gridView.Wb.vk(this.dvf);this.gridView.Wb.Nl(this.cvf);this.gridView=null;fc.prototype.dispose.call(this)};xa.prototype.AHb=function(){this.rGd(this.Jfa)};xa.prototype.refresh=function(){this.RPd(!this.gridView.isEditing)};of.Object.defineProperties(xa.prototype,{MH:{configurable:!0,enumerable:!0,get:function(){return this.wlc(this.Jfa)}},
name:{configurable:!0,enumerable:!0,get:function(){return ib.a.cellEdit}}});Object(Aa.a)(xa,"CellEditSafeStatePublisher",ob.a,[]);var Ic=b(38),Yc=b(110);Object(Aa.a)(da,"SafeStatePublisherState",null,[]);var Mc=b(716),xb=Ic.a;$k(X,xb);X.prototype.g_b=function(Ec){this.addHandler(X.WQa,Ec)};X.prototype.htc=function(Ec){this.removeHandler(X.WQa,Ec)};X.prototype.Nza=function(Ec,$c){function id(Ge,Ze){he.MH=Ze.MH;vd.Jab()}var vd=this,he=new da(Ec,$c);this.XQa.add(he);Ec.g_b(id);he.handler=id;this.Jab()};
X.prototype.eYd=function(Ec){for(var $c=null,id=ik(this.XQa),vd=id.next();!vd.done;vd=id.next())if(vd=vd.value,vd.publisher===Ec){this.Bcg(vd);$c=vd;break}$c&&(this.XQa.remove($c),this.Jab())};X.prototype.dispose=function(){for(var Ec=ik(this.XQa),$c=Ec.next();!$c.done;$c=Ec.next())this.Bcg($c.value);this.XQa.clear();this.lzb&&(this.uma.zbb(this.Gya.bind(this)),this.b7a?this.dya.ZQf(this.hFb):this.dya.ndj(this.Qzf.bind(this)));xb.prototype.dispose.call(this)};X.prototype.sac=function(){var Ec=z.sac(this.XQa.toArray().map(function($c){return $c.MH}));
return this.Y7a&&1===Ec?2:Ec};X.prototype.Bcg=function(Ec){Ec.publisher.htc(Ec.handler)};X.prototype.Jab=function(){var Ec=this.sac();Ec!==this.Zjf&&(this.raiseEvent(X.WQa,new Mc.a(Ec)),this.Zjf=Ec)};X.prototype.Qzf=function(){this.Y7a&&V.ULS.sendTraceTag(523317957,0,15,"ClientStateMonitor.onMergeWasAborted: Aborted merge occurred after another aborted merge.");this.Y7a=!0;this.Jab()};X.prototype.Gya=function(Ec,$c){Ec=$c.Y5;($c=!P(Ec))||($c=this.Ori,$c=(null===Ec||void 0===Ec?void 0:Ec.SuspensionStartTimestamp)!==
(null===$c||void 0===$c?void 0:$c.SuspensionStartTimestamp));$c&&(this.Y7a=!1);this.Ori=Ec;this.Jab()};of.Object.defineProperties(X.prototype,{iRj:{configurable:!0,enumerable:!0,get:function(){return Yc.f(Yc.c(this.XQa.toArray(),function(Ec){return 0!=Ec.MH}),function(Ec){return Ec.publisher.name})}}});X.WQa="SSC";Object(Aa.a)(X,"ClientStateMonitor",Ic.a,[]);var wc=b(6),Ob=b(68),nc=ob.a;$k(U,nc);U.prototype.RPd=function(Ec){Ec!==this.Jfa&&(this.Jfa=Ec,this.AHb())};U.prototype.dispose=function(){Ob.a(this.$).Osc(this.gwf);
this.z5a.Fq(this.uN);this.a8d=null;nc.prototype.dispose.call(this)};U.prototype.AHb=function(){this.rGd(this.Jfa)};U.prototype.refresh=function(){this.RPd(1===this.z5a.St||Ob.a(this.$).ii===this.z5a)};of.Object.defineProperties(U.prototype,{MH:{configurable:!0,enumerable:!0,get:function(){return this.wlc(this.Jfa)}},name:{configurable:!0,enumerable:!0,get:function(){return ib.a.z5a}},z5a:{configurable:!0,enumerable:!0,get:function(){return this.a8d}}});Object(Aa.a)(U,"IdleActivitySafeStatePublisher",
ob.a,[]);var mb=b(332),ic=b(3),qc=b(22),hc=Nc.a;$k(Q,hc);Q.prototype.Nc=function(){return!1};Q.prototype.executeCommand=function(){return Wb.Task.Ua(!0)};Q.prototype.Ac=function(Ec,$c){return 1905775613===$c.command};Q.prototype.Tc=function(){return!1};Object(Aa.a)(Q,"ToggleMergeSuspensionSafeState",Nc.a,[401]);var Jc=Ic.a;$k(B,Jc);B.prototype.hq=function(Ec){this.addHandler(B.xwd,Ec)};B.prototype.Fq=function(Ec){this.removeHandler(B.xwd,Ec)};B.prototype.uz=function(){this.raiseEvent(B.xwd)};B.prototype.cn=
function(Ec){return Ec===B.J3i&&!!this.mergeSuspensionManager};B.prototype.Kr=function(Ec,$c){if(!this.cn(Ec))return!1;this.mergeSuspensionManager&&($c.LabelText=this.emc,$c.On=this.Sxd);return!0};B.prototype.dispose=function(){this.WNb&&(this.Ka.nbb(this.WNb),this.WNb.dispose(),this.WNb=null);this.mergeSuspensionManager&&(this.mergeSuspensionManager.uma.zbb(this.Gya),this.mergeSuspensionManager.Oha.htc(this.POa),this.mergeSuspensionManager=null);this.statusBarManager&&(this.statusBarManager.wF(this),
this.statusBarManager=null);this.emc=null;Jc.prototype.dispose.call(this)};B.xwd="MSMSC";B.J3i="QueryMergeSuspensionStatus";Object(Aa.a)(B,"MergeSuspensionIndicatorManager",Ic.a,[455,269,6]);var rd=b(7),md=b(1096),Cc=Sys.EventArgs;$k(O,Cc);Object(Aa.a)(O,"TogglePendingMergeBlockedByClientEventArgs",Sys.EventArgs,[]);Object(Aa.a)(L,"SuspensionState",null,[]);$k(K,L);Object(Aa.a)(K,"ReadyForPendingMergeState",L,[]);var fd=new L,Cd=new L,Sc=new K(!1),Md=new K(!0),bc=b(1097),xe=bc.a;$k(I,xe);Object(Aa.a)(I,
"ReadyForPendingMergesUpdatedEventArgs",bc.a,[]);var Je=Ic.a;$k(G,Je);G.prototype.F$h=function(){return Object(uc.a)(X,this.Oha)?Object(yb.a)(X,this.Oha).sac():1};G.prototype.l_b=function(Ec){this.addHandler(G.lWd,Ec)};G.prototype.ktc=function(Ec){this.removeHandler(G.lWd,Ec)};G.prototype.OHg=function(Ec){this.addHandler(G.aHd,Ec)};G.prototype.Sdj=function(Ec){this.removeHandler(G.aHd,Ec)};G.prototype.XGg=function(Ec){this.addHandler(G.rwd,Ec)};G.prototype.mdj=function(Ec){this.removeHandler(G.rwd,
Ec)};G.prototype.v5i=function(){this.pGd(this.getState()===Cd)};G.prototype.dispose=function(){this.Oha.htc(this.POa);this.Oha=null;this.uma.zbb(this.Gya);this.uma=null;this.b7a&&(this.dya.ZQf(this.hFb),this.dya=null);Je.prototype.dispose.call(this)};G.prototype.mfd=function(){return Object(rd.a)(new md.a,{Current:this.I_.Current,Pending:this.I_.Pending,SuspensionStartTimestamp:this.I_.SuspensionStartTimestamp})};G.prototype.getState=function(){return P(this.I_)?0==this.MH?Md:this.lzb&&1==this.MH?
Sc:Cd:fd};G.prototype.HTe=function(Ec,$c){Ec!==$c&&($c===Cd?this.pGd(!0):Ec===Cd&&this.pGd(!1));this.tLf($c)};G.prototype.tLf=function(Ec,$c){Ec instanceof K&&this.raiseEvent(G.aHd,new I(this.I_,Ec.Cpe||!this.lzb,void 0===$c?!1:$c))};G.prototype.Pwi=function(Ec,$c,id){Ec===fd&&$c!==fd?(Ec=$c===Cd,$c=$c===Sc,V.ULS.sendTraceTag(252760283,0,50,"MergeSuspensionStateHandler.LogPendingMergesStatusChanged: Pending changes exist. IsBlocking: "+$c+" publisher: "+($c||Ec?this.Oha.iRj.join(","):"")+" counter: "+
ia(this.I_)+" isBlockingAllMerges: "+Ec)):Ec!==fd&&$c===fd&&V.ULS.sendTraceTag(252760284,0,50,"MergeSuspensionStateHandler.LogPendingMergesStatusChanged: No pending changes. counter: "+ia(id))};G.prototype.pGd=function(Ec){this.raiseEvent(G.lWd,new O(Ec))};G.lWd="TPMBBC";G.aHd="RFPMU";G.rwd="MCC";Object(Aa.a)(G,"MergeSuspensionStateHandler",Ic.a,[]);var we=Ic.a;$k(T,we);T.prototype.PYa=function(Ec){this.addHandler("MCU",Ec)};T.prototype.zbb=function(Ec){this.removeHandler("MCU",Ec)};T.prototype.Fya=
function(Ec,$c){$c=void 0===$c?"":$c;var id=this.W1.Current<Ec.Current||this.W1.Pending<Ec.Pending;if(Ec.SuspensionStartTimestamp&&this.ujc!==Ec.SuspensionStartTimestamp){if(this.ujc>Ec.SuspensionStartTimestamp){id&&V.ULS.sendTraceTag(553736149,0,50,"PendingMergeMonitor.OnMergeCounterReceivedFromServer: skipping a higher stale counter received via "+$c+". S: "+T.hDb(Ec)+", C: "+T.hDb(this.W1));return}id||V.ULS.sendTraceTag(553736148,0,50,"PendingMergeMonitor.OnMergeCounterReceivedFromServer: recovering from a potentially stale counter. S: "+
T.hDb(Ec)+", C: "+T.hDb(this.W1))}else if(!id)return;this.W1=Ec;this.kLf(Ec,$c)};T.prototype.dispose=function(){this.$.ea.wk(this.Rvc);this.$.ea.ER(this.Rvc);zb.g(this.$).Wb.Nl(this.N9a);Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:6329027_UpdateMergeCountWhenWebMethodReturnsWithErrors")||this.$.oa.fs(this.m8);var Ec=this.$.da.za(292);Ec&&Ec.zbb(this.iDb);we.prototype.dispose.call(this)};T.prototype.kLf=function(Ec,$c){$c=void 0===$c?"":$c;P(Ec)&&Ec.SuspensionStartTimestamp>this.ujc&&(V.ULS.sendTraceTag(537155416,
0,50,"PendingMergeMonitor.RaiseMergeCounterUpdated: Merge suspension requested. MergeCounter: "+ia(Ec)+", Origin: "+$c),this.ujc=Ec.SuspensionStartTimestamp);this.raiseEvent("MCU",new bc.a(Ec))};T.prototype.ETf=function(){V.ULS.sendTraceTag(588276808,0,50,"PendingMergeMonitor.ResetMergeCounter : Last counter was "+T.hDb(this.W1));this.W1=Object(rd.a)(new md.a,{Pending:0,Current:0,SuspensionStartTimestamp:null})};T.hDb=function(Ec){return Ec?"("+Ec.Current+"/"+Ec.Pending+" @"+Ec.SuspensionStartTimestamp+
")":"null"};of.Object.defineProperties(T.prototype,{I_:{configurable:!0,enumerable:!0,get:function(){return this.W1}}});T.N_d="PMM.RTC";T.btb="PMM.EwaResult";T.thj="PMM.resetMergeCounter";Object(Aa.a)(T,"PendingMergeMonitor",Ic.a,[]);Object(Aa.a)(N,"ClientRevisions",null,[]);var de=b(45),Le=b(62),Ie=Ic.a;$k(J,Ie);J.prototype.dispose=function(){this.$.oa.Wma(this.hCa);this.Yyc();this.Z5.Sdj(this.zBf);this.Z5.ktc(this.MFb);this.Z5.mdj(this.Pzf);this.Z5=null;Ie.prototype.dispose.call(this)};J.prototype.$Fj=
function(){this.Yyc();if(this.WHe()){var Ec=this.Z5.mfd();V.ULS.sendTraceTag(537155414,0,50,"RequestController.StartKeepBlockingPendingMergesTimer: Prevented starting StartKeepBlockingPendingMergesTimer because of repeated failure in counter "+ia(Ec)+" fail count: "+this.iBb)}else this.jBb=this.GZa.create(this.YXf,this.Rtc,de.a.jBb),this.N7a=this.GZa.pE(this.YXf,this.hri,de.a.N7a)};J.prototype.Yyc=function(){this.N7a&&(this.jBb.cancel(),this.N7a.cancel(),this.N7a=this.jBb=null)};J.prototype.UOi=function(Ec){var $c=
" fail count: "+this.iBb;this.iBb++;this.WHe()&&this.Yyc();V.ULS.sendTraceTag(542229773,0,10,"RequestController.OnKeepBlockingPendingMergesRequestFailed: request failed "+ia(Ec)+$c)};J.prototype.WHe=function(){return this.iBb>J.vAi};J.vAi=5;Object(Aa.a)(J,"RequestController",Ic.a,[]);var jf=b(162),df=b(205),Be=b(28),Sd=b(298),vc=Sys.EventArgs;$k(F,vc);Object(Aa.a)(F,"MergeDidntOccurEventArgs",Sys.EventArgs,[]);var qd=Ic.a;$k(H,qd);H.prototype.YGg=function(Ec){this.addHandler(H.ywd,Ec)};H.prototype.ndj=
function(Ec){this.removeHandler(H.ywd,Ec)};H.prototype.Rne=function(Ec){this.addHandler(H.swd,Ec)};H.prototype.ZQf=function(Ec){this.removeHandler(H.swd,Ec)};H.prototype.RNg=function(Ec,$c,id){var vd=this;this.iMb(Ec,$c,void 0===id?!1:id)?(new jf.a).setResult(!0):($c=this.VYi(Ec,$c),this.IBb=Ec,this.fCd++,$c.continueWith(function(){vd.wKi()},0,df.a.none,this.vO))};H.prototype.VYi=function(Ec,$c){this.JZd=this.dh.k8;this.rjf=$c;V.ULS.sendTraceTag(554767493,0,50,"DoPendingMergeSender.performDoPendingMergeInternal: Sending DoPendingMerge "+
Ec.Current+" / "+Ec.Pending+" @"+Ec.SuspensionStartTimestamp+". allowSelectionAdjustment: "+$c);this.isDocumentHidden||this.py();return this.$nj($c,Ec)};H.prototype.iMb=function(Ec,$c,id){id=void 0===id?!1:id;return!this.pAa||$c||this.pAa.loi()?!this.IBb||Ec.SuspensionStartTimestamp>this.IBb.SuspensionStartTimestamp?(this.OLa&&V.ULS.sendTraceTag(523551556,0,50,"DoPendingMergeSender.shouldThrottle: Allowing request for new suspension while previous is ongoing, new counter: "+Ec.Current+" / "+Ec.Pending+
" @"+Ec.SuspensionStartTimestamp),!1):this.OLa?!0:id?!1:this.bfg?(Ec=ea(Ec,this.IBb),id=this.dh.k8-this.JZd<this.Rtc,$c=this.rjf===$c,Ec&&id&&$c):ea(Ec,this.IBb)&&this.dh.k8-this.JZd<this.Rtc:(V.ULS.sendTraceTag(523317956,0,50,"DoPendingMergeSender.shouldThrottle: We can't retrieve selection and selection adjustments are disallowed."),!0)};H.prototype.$nj=function(Ec,$c){function id(){V.ULS.sendTraceTag(588276806,0,10,"DoPendingMergeSender.sendDoPendingMergeRequest: request failed "+$c.Current+" / "+
$c.Pending+" @"+$c.SuspensionStartTimestamp)}var vd=this.va.Pb();return this.pAa?this.pAa.Akj(this.hOh(Ec,id,vd)):this.awe(null,!0,void 0,id,vd)};H.prototype.hOh=function(Ec,$c,id){var vd=this;return function(he,Ge,Ze){var gf=void 0;vd.bfg&&(V.ULS.shipAssertTag(523317955,0,null!=he||Ec,"!allowSelectionAdjustment requires a non-null initialViewportState."),gf=vd.xKi.bind(vd));Ge&&(gf=Sd.b.call(null,function(Df){var mc=Df.Result,sc=null===mc||void 0===mc?void 0:mc.AdjustedViewportState;3===(null===
mc||void 0===mc?void 0:mc.MergeResultState)&&(sc=void 0);Ge(sc,Df.StateId)},gf));Ze&&($c=Sd.a.call(null,Ze,$c));return vd.awe(he,Ec,gf,$c,id)}};H.prototype.awe=function(Ec,$c,id,vd,he){if(this.gVg){var Ge=this.va;he=Ge.Na(1,void 0===he?null:he);he.viewportState=Ec;he.allowViewAdjustment=$c;Ec=Le.g(Ge,"DoPendingMerge",he,id,vd,null,null,0)}else Ge=this.va,he=Ge.Na(1,void 0===he?null:he),he.viewportState=Ec,he.allowViewAdjustment=$c,Ec=Le.g(Ge,"DoPendingMergeNew",he,id,vd,null,null,0);return Ec};H.prototype.xKi=
function(Ec){var $c=Ec.Result;void 0!=$c&&($c=$c.MergeResultState,Fb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RetryDoPendingMergeAfterBailout",!1)&&2!==$c?this.Y4i($c,Ec.Result.Y5):3===$c&&(V.ULS.sendTraceTag(523317954,0,50,"DoPendingMergeSender.onDoPendingMergeSucceeded: Aborted merge."),this.Z4i()))};H.prototype.Z4i=function(){this.raiseEvent(H.ywd,new Sys.EventArgs)};H.prototype.Y4i=function(Ec,$c){this.raiseEvent(H.swd,new F(Ec,$c))};H.prototype.wKi=function(){this.fCd--};of.Object.defineProperties(H.prototype,
{OLa:{configurable:!0,enumerable:!0,get:function(){return 0<this.fCd}},isDocumentHidden:{configurable:!0,enumerable:!0,get:function(){return!!this.documentVisibilityObserver&&this.documentVisibilityObserver.Mi}}});H.ywd="MWA";H.swd="MDO";Object(Aa.a)(H,"DoPendingMergeSender",Ic.a,[959,960]);of.Object.defineProperties(D.prototype,{reportName:{configurable:!0,enumerable:!0,get:function(){return this.C9h?"SelectionAdjustInHiddenDocument":"SelectionAdjust"}}});Object(Aa.a)(D,"SelectionAdjustSessionEndsReport",
null,[443]);var Jd=b(41),ld=b(95);w.prototype.Agg=function(Ec){var $c=this;this.g7d&&(this.$Ub?this.mRb=this.selectedRanges.map(function(Ge){return $c.UAc(Ge,$c.BEc)}):this.vCa&&(this.mRb=[this.UAc(this.selectedRanges[0],this.BEc)]));for(var id=ik(this.mRb),vd=id.next();!vd.done;vd=id.next()){vd=vd.value;if(!this.olg&&!vd)return!1;if(vd){vd=ik(vd);for(var he=vd.next();!he.done;he=vd.next())if(he=he.value,he.tk&&he.ie.Revision<Ec)return!1}}return!0};w.prototype.JLj=function(){var Ec;if(this.vCa||this.$Ub){var $c=
{SheetName:this.sheetName,ActiveCell:null===(Ec=this.activeCell)||void 0===Ec?void 0:Ec.toString(),SelectedRange:this.selectedRanges[0].toString(),TopLeft:void 0,SelectedRanges:void 0};this.$Ub&&($c.SelectedRange=void 0,$c.SelectedRanges=Jd.r(this.selectedRanges,this.ib));return $c}};w.prototype.toString=function(){var Ec,$c;return"active cell: "+(null!==($c=null===(Ec=this.activeCell)||void 0===Ec?void 0:Ec.toString())&&void 0!==$c?$c:"null")+" selection: "+Yc.f(this.selectedRanges,function(id){var vd;
return null!==(vd=null===id||void 0===id?void 0:id.toString())&&void 0!==vd?vd:"null"}).join(",")};w.prototype.equals=function(Ec){return Ec?this.activeCell.equals(Ec.activeCell)&&Jd.Q(this.selectedRanges,Ec.selectedRanges)&&this.sheetName===Ec.sheetName:!1};w.prototype.PUg=function(){for(var Ec=ik(this.selectedRanges.entries()),$c=Ec.next();!$c.done;$c=Ec.next()){var id=ik($c.value);$c=id.next().value;id=id.next().value;if(null===id||void 0===id?0:id.contains(this.activeCell))return $c}return-1};
w.prototype.UAc=function(Ec,$c){var id,vd=zb.g(this.ib).Ea.H3a(Ec,$c);vd||V.ULS.sendTraceTag(522803340,0,50,"SelectionState.tryGetBlockCacheItemsFromRange: no items found. range: "+(null!==(id=null===Ec||void 0===Ec?void 0:Ec.toString())&&void 0!==id?id:"null")+" ; activeItemNameIsDefined: "+!!$c);return vd};of.Object.defineProperties(w.prototype,{activeCell:{configurable:!0,enumerable:!0,get:function(){return this.eG}},selectedRanges:{configurable:!0,enumerable:!0,get:function(){return this.x9}},
Qr:{configurable:!0,enumerable:!0,get:function(){var Ec=!1;if(null===this.NI||void 0===this.NI)Ec=!0;else if(this.NI>=this.selectedRanges.length||!this.selectedRanges[this.NI].contains(this.activeCell))V.ULS.sendTraceTag(521200010,0,50,"SelectionState.indexOfActiveRange: the index of the adjusted active range has changed. indexOfActiveRange: "+this.NI+", selectedRangesLength: "+this.selectedRanges.length),Ec=!0;Ec&&(this.NI=this.PUg());return this.NI}},activeRange:{configurable:!0,enumerable:!0,get:function(){return 0>
this.Qr?this.activeCell:this.selectedRanges[this.Qr]}},sheetName:{configurable:!0,enumerable:!0,get:function(){return this.YWb}},activeItemName:{configurable:!0,enumerable:!0,get:function(){return this.BEc}},vCa:{configurable:!0,enumerable:!0,get:function(){return 1===this.selectedRanges.length}}});Object(Aa.a)(w,"SelectionState",null,[]);var Kd=b(212),re;(function(Ec){Ec[Ec.none=0]="none";Ec[Ec.waitingForAdjusted=1]="waitingForAdjusted";Ec[Ec.invalid=2]="invalid";Ec[Ec.nonContinuous=3]="nonContinuous";
Ec[Ec.noAdjustRequired=4]="noAdjustRequired";Ec[Ec.noAdjustRequiredWithDivergence=5]="noAdjustRequiredWithDivergence";Ec[Ec.divergenceOnResponse=6]="divergenceOnResponse";Ec[Ec.waitingForViewport=7]="waitingForViewport";Ec[Ec.adjusted=8]="adjusted";Ec[Ec.divergenceOnViewportReady=9]="divergenceOnViewportReady";Ec[Ec.differentSheetAdjust=10]="differentSheetAdjust";Ec[Ec.editBoxDivergence=11]="editBoxDivergence";Ec[Ec.exception=12]="exception"})(re||(re={}));Object(Aa.b)("SelectionAdjustState",re);
var ie=b(959);y.prototype.Akj=function(Ec){function $c(){id.fHi()}var id=this,vd=null,he=null;this.ubf()?(this.aM.parallel++,V.ULS.sendTraceTag(526390086,0,15,"SelectionAdjustManager.runRequestWithSelectionAdjust: Skipping parallel request. Current adjustedSelection is defined : "+!!this.Jy)):(vd=function(Ge,Ze){id.gHi(Ge,Ze)},he=this.wtj());return null===Ec||void 0===Ec?void 0:Ec(he,vd,$c)};y.prototype.loi=function(){return!this.ubf()&&this.Taa().vCa};y.prototype.wtj=function(){var Ec;V.ULS.shipAssertTag(525135961,
0,0===this.LC,"SelectionAdjustManager.setPreRequestState: unexpected state");this.Jy&&(this.aM.errors++,V.ULS.sendTraceTag(526960090,0,10,"SelectionAdjustManager.setPreRequestState: About to ignore a defined Adjusted selection: "+this.Jy.toString()));this.Jy=null;this.Px=this.Taa();var $c=null,id=null===(Ec=this.Px)||void 0===Ec?void 0:Ec.JLj();id&&($c={ActiveSheetName:this.Px.sheetName,SheetViewportStateChanges:[id]});this.LC=1;return $c};y.prototype.fHi=function(){V.ULS.shipAssertTag(525135960,
0,1===this.LC,"SelectionAdjustManager.onAdjustedRequestFailed: unexpected state");this.aM.errors++;this.LC=2;this.Wq()};y.prototype.gHi=function(Ec,$c){try{V.ULS.shipAssertTag(525135959,0,1===this.LC,"SelectionAdjustManager.onAdjustedSelectionReady: unexpected state"),this.$Mb=$c,$c=2,this.Px?Ec?(this.Jy=this.Ywj(Ec))?($c=7,this.yDb||this.Px.vCa)?this.Px.equals(this.Jy)?this.lSf&&!this.Px.equals(this.Taa())?(this.aM.adjustedDidntChangeWithDivergence++,$c=5):(this.aM.adjustedDidntChange++,$c=4):this.Px.sheetName!=
this.Jy.sheetName?(this.aM.differentSheetAdjust++,$c=10):this.lSf&&!this.Px.equals(this.Taa())&&(this.aM.divergenceOnResponse++,$c=6,this.kSf()):(this.aM.nonContinuous++,$c=3):this.aM.errors++:(this.aM.errors++,V.ULS.sendTraceTag(537155412,0,15,"SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted returned null, initialSelection: "+this.Px.toString())):(this.aM.errors++,V.ULS.sendTraceTag(537155413,0,10,"SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted selection results returned when not waiting for them, adjusted:  ActiveCell: "+
(null===Ec||void 0===Ec?void 0:Ec.ActiveCell)+", SelectedRange: "+(null===Ec||void 0===Ec?void 0:Ec.SelectedRange))),this.LC=$c}catch(id){this.LC=12,V.ULS.sendTraceTag(525135958,0,10,"SelectionAdjustManager.OnAdjustedSelectionReady: caught Exception "+id)}finally{7!=this.LC?this.Wq():this.AXc(!1,!0)}};y.prototype.dispose=function(){this.gridView.Ea.gv(this.yi);this.gridView.Ea.Eq(this.D9a);this.gridView.Ea.mQf(this.D9a);this.gridView.Ea.rbb(this.D9a);Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:6385622_SelectionAdjustImplementsCustomReportManager")&&
this.$.sl(this.Yc)};y.prototype.ubf=function(){return 1===this.LC||7===this.LC};y.prototype.Ywj=function(Ec){var $c=this,id,vd;if(!function(){var gf=Jd.Z(Ec.ActiveCell,$c.$.xa);id=gf.range;return gf}().returnValue)return V.ULS.sendTraceTag(537155411,0,10,"SelectionAdjustManager.sheetViewportStateToSelectionState: Unable to extract active cell "+Ec.ActiveCell),null;var he=[];if(this.yDb){var Ge=this.$.pa,Ze=!!Ge&&2===Ge.LF;if(Ec.SelectedRanges)he=Jd.g(Ec.SelectedRanges.Ranges);else if(!Ze)return V.ULS.sendTraceTag(522826913,
0,10,"SelectionAdjustManager.sheetViewportStateToSelectionState: SelectedRanges is null, active sheet exists: "+!!Ge),null}else{if(!function(){var gf=Jd.Z(Ec.SelectedRange,$c.$.xa);vd=gf.range;return gf}().returnValue)return V.ULS.sendTraceTag(537155410,0,10,"SelectionAdjustManager.sheetViewportStateToSelectionState: Unable to extract selected range "+Ec.SelectedRange),null;he.push(vd)}return new this.JXf(this.$,id,he,Ec.SheetName,this.Px.activeItemName,this.Px.Qr)};y.prototype.Taa=function(){var Ec=
this.$.pa;if((null===Ec||void 0===Ec?0:Ec.activeCell)&&Ec.selectedRanges&&Ec.sheetName)return new this.JXf(this.$,Ec.activeCell,Ec.selectedRanges,Ec.sheetName,this.$.activeItemName,Ec.Qr);V.ULS.sendTraceTag(525135957,0,10,"SelectionAdjustManager.getCurrentSelection: invalid activeItem. activeItem null: "+!Ec+", activeCell null: "+!(null===Ec||void 0===Ec?0:Ec.activeCell)+", selectedRanges null: "+!(null===Ec||void 0===Ec?0:Ec.selectedRanges)+", sheetName null: "+!(null===Ec||void 0===Ec?0:Ec.sheetName));
return null};y.prototype.TEe=function(){var Ec=this;this.$.da.Za(276,function(){var $c=Kd.a(Ec.$);$c.nY(Ec.J1d);$c.nY(Ec.K1d)})};y.prototype.AXc=function(Ec,$c){var id;if(this.Bmi(Ec))if(Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:6280340_preventRecursionOfAttemptAdjustSelection")&&8===this.LC)V.ULS.sendTraceTag(523106438,0,15,"SelectionAdjustManager.attemptAdjustSelection: skipping as was already adjusted");else{$c&&V.ULS.sendTraceTag(524039250,0,50,"SelectionAdjustManager.attemptAdjustSelection: viewport ready on response");
try{if(V.ULS.shipAssertTag(525135956,0,7===this.LC,"SelectionAdjustManager.attemptAdjustSelection: unexpected state"),this.Px.equals(this.Taa()))if(this.Rfj&&(null===(id=this.gridView)||void 0===id?0:id.isEditing))this.aM.editBoxDivergence++,this.LC=11;else{Ec=0;if(this.yDb&&(Ec=this.Jy.Qr,-1==Ec)){this.aM.errors++;V.ULS.sendTraceTag(522826912,0,10,"SelectionAdjustManager.attemptAdjustSelection: invalid indexOfActiveRange");return}this.aM.adjusted++;this.LC=8;Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:6413876_AdjustSelectionWithoutCallingGoto")?
this.gridView.ha.Jw(this.Jy.selectedRanges,Ec,this.Jy.activeCell,0,void 0,ld.a.HXf):this.gridView.jV(this.Jy.selectedRanges,Ec,this.Jy.sheetName,null,this.Jy.activeCell,null,null,0,ld.a.HXf)}else this.aM.divergenceOnViewportReady++,this.kSf(),this.LC=9}catch(vd){this.LC=12,V.ULS.sendTraceTag(525135955,0,10,"SelectionAdjustManager.attemptAdjustSelection: caught Exception "+vd)}finally{this.Wq()}}};y.prototype.Bmi=function(Ec){if(!this.Jy)return!1;if(!this.Px)return V.ULS.sendTraceTag(537155409,0,10,
"SelectionAdjustManager.attemptAdjustSelection: initialSelection is null while adjustedSelection isn't null, adjustedSelection: "+this.Jy.toString()),!1;if(this.Npe&&zb.g(this.$).Ea.$vd<this.$Mb)return!1;if(Ec||this.SJj){if(!this.Npe&&zb.g(this.$).Ea.$vd<this.$Mb)return!1;(this.yDb||this.Px.vCa)&&V.ULS.sendTraceTag(528590295,0,15,"SelectionAdjustManager.attemptAdjustSelection: got to blockCacheConsistent while pending for selection adjust")}else if(!this.Px.vCa&&!this.yDb||!this.Px.Agg(this.$Mb)||
!this.Jy.Agg(this.$Mb))return!1;return!0};y.prototype.Wq=function(){var Ec,$c,id,vd;this.vgj&&2!=this.LC&&V.ULS.sendTraceTag(526792898,0,50,"SelectionAdjustManager.clearState: initial: "+(null!==($c=null===(Ec=this.Px)||void 0===Ec?void 0:Ec.toString())&&void 0!==$c?$c:"null")+", adjusted: "+(null!==(vd=null===(id=this.Jy)||void 0===id?void 0:id.toString())&&void 0!==vd?vd:"null")+", state: "+re[this.LC]+", hidden: "+ie.a.eB(this.Hqf));this.Px=this.Jy=null;this.LC=0};y.prototype.kSf=function(){var Ec=
this.Taa();V.ULS.sendTraceTag(537155408,0,50,"SelectionAdjustManager.ReportDivergence: initial: "+this.Px.toString()+" current: "+(Ec?Ec.toString():"")+" adjusted: "+this.Jy.toString()+" sheetSameBetweenInitialAndAdjusted: "+(this.Px.sheetName===this.Jy.sheetName)+" sheetSameBetweenInitialAndCurrent: "+(this.Px.sheetName===(Ec?Ec.sheetName:null)))};of.Object.defineProperties(y.prototype,{JXf:{configurable:!0,enumerable:!0,get:function(){return w}},aM:{configurable:!0,enumerable:!0,get:function(){return ie.a.eB(this.Hqf)?
this.K1d:this.J1d}}});Object(Aa.a)(y,"SelectionAdjustManager",null,[962,6]);var ef=Nc.a;$k(z,ef);z.prototype.l_b=function(Ec){this.Qfa.l_b(Ec)};z.prototype.ktc=function(Ec){this.Qfa&&this.Qfa.ktc(Ec)};z.prototype.Nza=function(Ec,$c){this.TCa.Nza(Ec,$c)};z.prototype.eYd=function(Ec){this.TCa.eYd(Ec)};z.prototype.Fya=function(Ec,$c){this.YWa.Fya(Ec,void 0===$c?"":$c)};z.prototype.dispose=function(){this.Tec&&(this.Tec.dispose(),this.Tec=null);this.pAa&&this.pAa.dispose();this.EIa.dispose();this.OKd&&
(this.OKd.dispose(),this.OKd=null);this.Qfa&&(this.Qfa.dispose(),this.Qfa=null);this.YWa.dispose();this.YWa=null;this.TCa.dispose();this.TCa=null;this.K_a&&(this.K_a.dispose(),this.K_a=null);this.A5a&&(this.A5a.dispose(),this.A5a=null);this.$=null;ef.prototype.dispose.call(this)};z.prototype.AHb=function(){this.Qfa.v5i()};z.sac=function(Ec){var $c=0;Ec=ik(Ec);for(var id=Ec.next();!id.done;id=Ec.next()){id=id.value;if(2==id)return 2;1==id&&($c=1)}return $c};z.prototype.$$h=function(Ec,$c){this.TCa=
new X(this.EIa,this.YWa);$c?Object(uc.a)(U,$c)?this.Nza($c,Object(yb.a)(U,$c).MH):Object(uc.a)(xa,$c)?this.Nza($c,Object(yb.a)(xa,$c).MH):this.Nza($c,0):(this.K_a=new xa(Ec),this.A5a=new U(Ec),this.Nza(this.K_a,this.K_a.MH),this.Nza(this.A5a,this.A5a.MH))};of.Object.defineProperties(z.prototype,{Oha:{configurable:!0,enumerable:!0,get:function(){return this.TCa}},uma:{configurable:!0,enumerable:!0,get:function(){return this.YWa}},Z5:{configurable:!0,enumerable:!0,get:function(){return this.Qfa}}});
Object(Aa.a)(z,"MergeSuspensionManager",Nc.a,[936,6]);var Fe=lb.a;$k(A,Fe);A.prototype.create=function(){V.ULS.sendTraceTag(537155419,0,50,"MergeSuspensionFactory.Create");this.pb(this.Ec.da.za(343)||this.Ec.da.Ga(343,new z(this.Ec,Gc.a.instance)))};A.ka=function(Ec){V.ULS.sendTraceTag(537155418,0,50,"MergeSuspensionFactory.Attach");Ec.da.Ga(344,new A(Ec))};Object(Aa.a)(A,"MergeSuspensionFactory",lb.a,[]);var bf=b(50),Oe=b(37),lc=b(87),Fa=b(99),Kb=b(54),gb=b(14);u.Nti=3;u.connected=0;Object(Aa.a)(u,
"ConnectionStateConstants",null,[]);var Tb=b(111),pc=b(119),Xc=b(43);l.prototype.JZf=function(){this.durationMs=pc.a(Be.a.Ta,this.startTime)};l.prototype.lBd=function(Ec){var $c=this,id;this.JZf();Xc.a(Ec).ftc(this.Nuf);Xc.a(Ec).Tf.gtc(this.Ica);Ec.da.Za(291,function(vd){vd.tbb($c.p6)});if(null===(id=Ec.ea)||void 0===id?0:id.ef)Ec.ea.ef.VJd(this.aCd),this.wasUserActiveOnPIEnd=Ec.ea.ef.Ur};l.prototype.Pi=function(Ec){var $c=this;Xc.a(Ec).b_b(this.Nuf);this.isToastShown?this.toastRaiser="Immediate":
Xc.a(Ec).Tf.uVc(this.Ica);Ec.da.Za(291,function(id){$c.hasTabbedOut=id.Mi;id.HYa($c.p6)});this.wasUserActiveOnPIStart&&Ec.ea.ef.Eoe(this.aCd)};Object(Aa.a)(l,"PartialInteractivityData",null,[]);var pd=b(1327);$k(x,l);x.prototype.tJi=function(Ec,$c){this.swappedByOffline=$c;this.lBd(Ec)};x.prototype.qrj=function(Ec){this.errorDataDuringConnectivityIssuesMode=Ec};x.prototype.M7i=function(Ec){10>this.failedRequests.length&&(Ec=Ec+"_"+Tb.getElapsedSeconds(this.startTime,Be.a.Ta.Jb).toString(),this.failedRequests.push(Ec))};
Object(Aa.a)(x,"ConnectivityIssuesData",l,[]);var Uc=b(165),sd=b(126),Nb=b(112);m.Ljh="DuringWork";m.connectivityIssues="ConnectivityIssues";m.offline="Offline";Object(Aa.a)(m,"UnavailabilityTypes",null,[]);var Ja=b(51);v.prototype.dispose=function(){this.$&&(Xc.a(this.$).Tf.vQf(this.Xvf),this.$.tf&&this.$.tf.uQf(this.Uvf));this.data&&this.$.oa.tf.tRf(this.Kn);this.$=null};v.prototype.CUg=function(Ec){var $c=this.L$c-1;return(this.data.averageDurationBetweenFailedRequestsSec*($c-1)+Ec)/$c};Object(Aa.a)(v,
"ConnectivityIssuesTelemetryManager",null,[6]);var Lb=b(1068),ec=b(129),Zb=b(1008);f.prototype.ASj=function(){this.tU&&this.tU.JZf()};f.prototype.oDg=function(Ec){this.allOfflinePartialInteractivitiesDataInSession.push(Ec);this._count++};of.Object.defineProperties(f.prototype,{count:{configurable:!0,enumerable:!0,get:function(){return this._count}},tU:{configurable:!0,enumerable:!0,get:function(){return this.allOfflinePartialInteractivitiesDataInSession[this.allOfflinePartialInteractivitiesDataInSession.length-
1]}}});Object(Aa.a)(f,"OfflinePartialInteractivitiesDataForLog",null,[]);$k(n,l);n.prototype.Tuj=function(Ec){this.timeFromLastOffline=Ec};n.prototype.rrj=function(Ec){this._errorDataDuringOfflineMode=Ec};Object(Aa.a)(n,"OfflinePartialInteractivityData",l,[]);k.prototype.dispose=function(){this.$&&Xc.a(this.$)&&Xc.a(this.$).Tf.yJd(this.e$a);lc.a.Ia(this.wub);this.$=this.wub=null};k.prototype.yQi=function(Ec){this.tU=new n(Be.a.Ta.Jb,this.$,0!==Ec);this.tU.Tuj(-1!==this.$Ed?window.performance.now()-
this.$Ed:-1);this.rOa.oDg(this.tU);Xc.a(this.$).Tf.uVc(this.Ica);this.$2a();this.wub=Gc.a.instance.pE(this.$2a,k.rDh,de.a.$2a);Uc.a(this.$).bVc(this.TVf)};k.prototype.zQi=function(){this.tU.lBd(this.$);this.$2a();lc.a.Ia(this.wub);this.wub=null;this.$Ed=window.performance.now();Xc.a(this.$).Tf.gtc(this.Ica);Uc.a(this.$).mJd(this.TVf);this.Nfj()};k.prototype.ulj=function(Ec,$c){var id=this;this.$?this.akf=Oe.TaskExtensions.Aa(this.akf,function(){id.indexedDB.qcb(new Zb.a(Ec,$c))},this.$.la):V.ULS.sendTraceTag(537155205,
0,15,"OfflineModeTelemetryManager.SaveToIndexedDBSequential: EwaControl is null when attempting to write to IDB")};k.prototype.Ifj=function(){var Ec=this.$.la;Oe.TaskExtensions.Aa(Oe.TaskExtensions.Aa(this.indexedDB.f4a(k.cDd),this.lgj,Ec),this.Daj,Ec)};k.prototype.Nfj=function(){if(this.tU){var Ec=Sys.Serialization.JavaScriptSerializer.serialize(this.tU);Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_71qb3_Offline")?Ja.b().NKb(560791645,0,50,m.offline,this.tU.durationMs,
"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",Ec):V.ULS.sendTraceTag(560791645,0,50,"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: "+Ec)}Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:5508233_ReportNetworkDownVeto")&&this.tU&&this.tU.isToastShown&&Fa.Health.instance.recordQosError(sd.a.uWj,[Nb.a.Xjc],!0,!1,!1,!1,null)};k.eld="NetworkAvailability";k.fld="NetworkAvailabilityData";
k.cDd="partialInteractivityData";k.rDh=3E3;Object(Aa.a)(k,"OfflineModeTelemetryManager",null,[6]);h.prototype.dispose=function(){lc.a.Ia(this.Itf);lc.a.Ia(this.cEi);lc.a.Ia(this.Dla);lc.a.Ia(this.I2g);this.$=null};Object(Aa.a)(h,"NetworkConnectionTelemetryManager",null,[6]);$k(e,l);e.prototype.e$a=function(){this.wasInteruptedByOfflineMode=!0};Object(Aa.a)(e,"SilentReopenData",l,[]);d.prototype.dispose=function(){this.Tf.XQf(this.Jzf);this.Tf.sej(this.vDf);this.K7=this.Tf=this.$=null};d.prototype.sDf=
function(Ec,$c){Ec.TL?this.K7=new e(Be.a.Ta.Jb,this.$,0!==Ec.koa,$c):(5===Ec.koa&&(this.K7.wasInteruptedByOfflineMode=!0),3!==Ec.koa&&2!==Ec.koa||V.ULS.sendTraceTag(537155202,0,10,"SilentReopenPartialInteractivityTelemetryManager.OnSilentReopen: BackToWork/DuringWork partial interactivity has been swapped to DuringWork/BackToWork."),this.K7.lBd(this.$),2===$c?Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_8dtae_B2W")?Ja.b().OKb(571289604,0,50,m.offline,this.K7.durationMs,
this.K7):V.ULS.sendTraceTag(571289604,0,50,Kb.a.xc(this.K7)):Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_6w9lg_DuringWork")?Ja.b().OKb(542782150,0,50,m.Ljh,this.K7.durationMs,this.K7):V.ULS.sendTraceTag(542782150,0,50,Kb.a.xc(this.K7)),this.K7=null)};Object(Aa.a)(d,"SilentReopenPartialInteractivityTelemetryManager",null,[6]);var Oc=Ic.a;$k(c,Oc);c.prototype.dispose=function(){this.tf&&(this.nxc&&(this.tf.sdj(this.nFb),this.tf.RIb(this.sAf)),this.tf.uQf(this.Vvf),
this.tf.gcj(this.Wvf));this.sAb&&this.documentVisibilityObserver&&(this.documentVisibilityObserver.KIb(this.K9a),this.sAb=!1);this.$&&(this.jsc&&this.nBc(),this.$.ea&&(this.$.ea.nRf(this.uDf),this.$.ea.ef&&this.$.ea.ef.sQa(this.UOa)));Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&this.a1&&(this.a1.dispose(),this.a1=null);lc.a.Ia(this.Trf);this.$=null;Oc.prototype.dispose.call(this)};c.prototype.Vzi=function(){this.hRd=!0};c.prototype.eke=function(){this.Una||
(this.Una=Xc.a(this.$).Tf.lYa(3,"NetworkConnectionStateManager.ActivateDuringWorkSilentReopenPartialInteractivity"))};c.prototype.$fi=function(){if(this.hRd)return this.hRd=!1,!0;var Ec=this.U7>this.rnf||this.Xkd>this.rnf&&10>this.U7;V.ULS.sendTraceTag(537155223,0,50,"NetworkConnectionStateManager.IsBackToWorkSilentReopen: Inactivity duration: Time from last activity:"+this.U7+", Time gap between last two activities: "+this.Xkd+". return value:"+Ec);return Ec};c.prototype.xgj=function(){Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&
(this.a1=Gc.a.instance.create(function(){Fa.Health.instance.recordQosError(sd.a.tEj,[Nb.a.Xjc],!0,!0,!1,!1,null)},6E3,"ReportLongSilentReopenBackToWorkVeto",void 0,!0))};c.prototype.RAg=function(){var Ec=this;this.Una||this.N0?V.ULS.sendTraceTag(542782155,0,10,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Trying to activate during-work partial interactivity when we are already in this partial interactivity or there is a running timer that's going to do it soon."):this.N0=
Gc.a.instance.create(function(){Ec.$?Ec.Una?V.ULS.sendTraceTag(537155221,0,15,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Tried to activate SilentReopenDuringWork PI when there is already an DuringWorkSilentReopen partial interactivity object"):zb.g(Ec.$).isEditing?(Ec.gbb||(zb.g(Ec.$).$b.um(Ec.Ef),V.ULS.sendTraceTag(541893722,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Registered OnEditEnded while during-work silent reopen")),Ec.hbb=
!0,V.ULS.sendTraceTag(537155220,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Need to init during-work silent reopen partial interactivity but the user is during a cell edit. Registered to OnEditEnded event.")):Ec.eke():V.ULS.sendTraceTag(537155222,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: EwaControl is null")},this.h5f,de.a.rDj,void 0,!0)};c.prototype.Oqf=function(Ec){this.j2c=this.Hve(2,Ec,!0);this.$oe()};c.prototype.Flc=function(Ec,
$c){this.QWb=this.Hve(Ec,$c,!1);this.$oe()};c.prototype.Hve=function(Ec,$c,id){id=id?this.j2c:this.QWb;return $c?id|Ec:id&~Ec};c.prototype.kWd=function(){var Ec=!!this.sOa,$c=!!this.rSa,id=!!this.Una,vd=!!this.W3b;this.ECb&&!Ec?this.QAg():!this.ECb&&Ec&&this.mdh();!this.Hkc||$c||id?this.Hkc||($c?this.sGe():(id||this.N0&&this.N0.Mp)&&this.tGe()):this.n2f&&this.Hfa?this.OAg():!this.YLb||this.Hfa||Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:5658794_DontActivatePartialInteractivityIfTimerIsRunning")&&
this.N0||this.RAg();this.Aka&&!vd?this.w$f(!0):!this.Aka&&vd&&this.w$f(!1)};c.prototype.QAg=function(){this.$?this.sOa?V.ULS.sendTraceTag(537155215,0,15,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Tried to activate offline PI when there is already an offline partial interactivity object"):zb.g(this.$).isEditing?(this.hbb||(zb.g(this.$).$b.um(this.Ef),V.ULS.sendTraceTag(537155217,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Registered OnEditEnded during offline mode")),
this.gbb=!0,V.ULS.sendTraceTag(537155216,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Turned offline while user is editing a cell, registered to OnEditEnded event.")):this.hke():V.ULS.sendTraceTag(537155214,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: EwaControl is null")};c.prototype.hke=function(){this.sOa||(this.sOa=Xc.a(this.$).Tf.lYa(5,"NetworkConnecStateManager.ActivateOfflinePartialInteractivity"))};c.prototype.mdh=function(){this.sOa&&
(lc.a.Ia(this.sOa),this.sOa=null)};c.prototype.sGe=function(){this.rSa&&(lc.a.Ia(this.rSa),this.rSa=null);Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&this.a1&&this.a1.Mp&&this.a1.cancel();this.a1=null};c.prototype.tGe=function(){this.Una&&(lc.a.Ia(this.Una),this.Una=null);this.N0&&(lc.a.Ia(this.N0),this.N0=null);this.hbb&&!this.gbb&&zb.g(this.$).$b.Nl(this.Ef);this.hbb=!1};c.prototype.OAg=function(){this.rSa||(this.rSa=Xc.a(this.$).Tf.lYa(2,"NetworkConnectionStateManager.ActivateLongInactivitySilentReopenPartialInteractivity",
void 0,gb.a.instance.ga(2172)));this.xgj()};c.prototype.w$f=function(Ec){Ec?(this.W3b=Xc.a(this.$).Tf.lYa(4,"NetworkConnectionStateManager.ConnectivityIssues"),this.K3i()):(lc.a.Ia(this.W3b),this.W3b=null)};c.prototype.K3i=function(){if(this.$&&this.$.oa){var Ec=this.$.oa.va.Pb();Le.J(this.$.oa.va,null,null,null,Ec)}};c.prototype.nBc=function(){Ob.a(this.$).tQ(wc.a.aPa).Fq(this.CAf);this.$.sl(this.Yc);this.jsc=!1};c.prototype.$oe=function(){this.documentVisibilityObserver||V.ULS.sendTraceTag(537155211,
0,15,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: Document visibility observer is null while it shouldn't be.");this.documentVisibilityObserver&&this.documentVisibilityObserver.Mi?this.sAb||(this.documentVisibilityObserver.LZb(this.K9a),this.sAb=!0,V.ULS.sendTraceTag(541193954,0,50,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: tabbed out user, will update the partial interactivity state when the user will be back.")):this.kWd()};of.Object.defineProperties(c.prototype,
{$hi:{configurable:!0,enumerable:!0,get:function(){return this.Hfa}},ECb:{configurable:!0,enumerable:!0,get:function(){return!(this.QWb&1)}},Hkc:{configurable:!0,enumerable:!0,get:function(){return!(this.QWb&2)}},Aka:{configurable:!0,enumerable:!0,get:function(){return!!(this.j2c&2)}}});Object(Aa.a)(c,"NetworkConnectionStateManager",Ic.a,[938,6]);var td=lb.a;$k(a,td);a.prototype.create=function(){var Ec=this;Oe.TaskExtensions.Aa(bf.GetServiceTaskFactory.Ra(this.$.da,395,396,this.hb),function($c){var id=
Fb.EwaSettings.isChangeGateEnabled("OfficeVSO:6143820_MoveServiceRegistrationFromFAM_V2")?Object(wb.c)(Ec.$.da,400,function(){return new c(Ec.$,$c.result)}):Ec.$.da.za(400)||new c(Ec.$,$c.result);Ec.pb(id)},this.$.la,3)};a.ka=function(Ec){Ec.da.Ga(401,new a(Ec))};Object(Aa.a)(a,"NetworkConnectionStateManagerFactory",lb.a,[]);var Gd=b(1464),Pd=b(1369),ee=b(1426);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.InsertPicture");Type.registerNamespace("_Ewa");Object(Ha.a)();Object(sa.a)();
Object(Wa.a)();Object(Hb.a)();Object(Yb.a)();Object(hb.a)();Object(Xb.a)();Object(ee.a)();Type.registerNamespace("Common.App.InProductMessaging");ra.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");bb.main();(function(){Sb.a.Fa(function(){Sb.a.Fa(ha.ka)})})();(function(){Sb.a.Fa(function(){Sb.a.Fa(Z.ka)})})();Sb.a.Fa(A.ka);Sb.a.Fa(a.ka);Object(Gd.a)();Object(Pd.a)()}}]);

//# sourceMappingURL=EwaDS.pi.js.map