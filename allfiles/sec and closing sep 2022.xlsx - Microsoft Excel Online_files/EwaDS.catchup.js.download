(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[23],{1201:function(t,E,b){function a(h,k){h=e.call(this,h,k)||this;k!==d.a.c$&&h.LFa(k);h.Mga(a.iterateNext);h.Mga(a.rxa);h.fUc(c.a.hUa);h.fUc(c.a.iUa);return h}b.d(E,"a",function(){return a});t=b(0);var c=b(170);E=b(1452);var d=b(983),e=E.a;$k(a,e);a.iterateNext="IterateNext";a.rxa="IteratePrevious";a.XNb="ToggleShowChanges";a.setCurrentChangeCount="SetCurrentChangeCount";a.setTotalChangesCount="SetTotalChangesCount";a.WOa=
"OnVHDiffReady";Object(t.a)(a,"VersionHistoryMessenger",E.a,[])},1470:function(t,E,b){function a(K,L,O,B){var Q=this;this.authorColor=this.m2=this.j8=null;this.r7a=!1;this.f1a=-1;this.U4c=0;this.rIa=100;this.Wka=-1;this.c_d=null;this.dpb=f.a.EXj;this.BGe=f.a.FXj;this.ei=function(U){(U=z.a(U)?null:U.Result)?U.OperationWaitingForFileDownload?20>Q.U4c?(Q.rIa*=2,I.Task.delay(Q.rIa).continueWith(function(){Q.tXd()})):(Q.$Bc(),d.ULS.sendTraceTag(537150406,0,50,"VersionHistoryHighlightManager::OnWebMethodSuccess Next Operation enqueue failed")):
U.ActivityList?(Q.initialize(U.ActivityList,U.VersionAuthors),y.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")?Q.WOa():Q.Zxc(!0),Q.c_d.stop(),d.ULS.sendTraceTag(41743369,0,50,"VersionHistoryHighlightManager: Time taken For showing diffs in Ms:"+Q.c_d.qc.toString())):(Q.$Bc(),d.ULS.sendTraceTag(537150407,0,50,"VersionHistoryHighlightManager::OnWebMethodSuccess no activity list found.")):(Q.rIa*=2,I.Task.delay(Q.rIa).continueWith(function(){Q.tXd()}),d.ULS.sendTraceTag(537150408,
0,10,"VersionHistoryHighlightManager::OnWebMethodSuccess call returned null result."))};this.Tya=function(){Q.$Bc();d.ULS.sendTraceTag(537150405,0,10,"VersionHistoryHighlightManager::OnWebMethodFailure service call failed.")};this.Rrd=function(U){d.ULS.sendTraceTag(537150400,0,50,"VersionHistoryHighlightManager.IterateMessageHandler called with MessageID:"+U.MessageId);switch(U.MessageId){case N.a.iterateNext:Q.iterateNext();Q.Wka=(Q.Wka+1)%Q.hS.length;Q.HKb(N.a.setCurrentChangeCount,Q.Wka+1);break;
case N.a.rxa:Q.rxa();Q.Wka=0>Q.Wka?0:Q.Wka;Q.Wka=(Q.Wka+Q.hS.length-1)%Q.hS.length;Q.HKb(N.a.setCurrentChangeCount,Q.Wka+1);break;case N.a.XNb:Q.Zxc(U.Values.ToggleValue)}};this.G1g=function(U,X){return Q.F3b(U.sk,X.sk)};this.F1g=function(U,X){return Q.F3b(U.sk,X)};this.Rc=function(){Q.F6b()};this.ap=function(){Q.F6b()};this.Fh=function(){Q.F6b()};d.ULS.sendTraceTag(537150411,0,50,"VersionHistoryHighlightManager::Constructor.");this.$=K;this.ariaLiveNotifier=B;this.gridView=J.g(this.$);this.gridView.ha.wG(this.Rc);
this.gridView.UD(this.ap);this.gridView.Wb.Ak(this.Fh);this.wTj();L&&(this.c_d=K.Fb.sc("UserAction","VersionHistoryDiffManagerStopWatch"),this.tXd());if(this.Pr=O)K=e.a.aba(this.$.ya.VersionHistoryActionUrl)||G.a.c$,K!==G.a.c$&&this.Pr.LFa(K),this.Pr.Tn(N.a.iterateNext),this.Pr.Tn(N.a.rxa),this.Pr.Tn(N.a.XNb),this.Pr.Ml(N.a.iterateNext,this.Rrd),this.Pr.Ml(N.a.rxa,this.Rrd),this.Pr.Ml(N.a.XNb,this.Rrd)}function c(K,L,O){this.IFa=K;this.sk=L;this.ICc=O}t=b(0);var d=b(15),e=b(81),h=b(1040),k=b(85),
n=b(192),f=b(9),v=b(222),m=b(64),x=b(41),l=b(572),u=b(177),A=b(110),z=b(299),y=b(1),w=b(11),D=b(101),H=b(14),F=b(298);b(95);var J=b(21),S=b(359);Object(t.a)(c,"UserActivityLocation",null,[]);var N=b(1201),T=b(62),G=b(983),I=b(58);b.d(E,"a",function(){return a});a.prototype.dispose=function(){this.Pza();this.j8=this.m2=null;this.gridView&&(this.gridView.ha&&this.gridView.ha.zF(this.Rc),this.gridView.yF(this.ap),this.gridView.Wb&&this.gridView.Wb.vk(this.Fh),this.Pr&&(this.Pr.Foa(N.a.rxa),this.Pr.Foa(N.a.iterateNext),
this.Pr.Foa(N.a.XNb)))};a.prototype.initialize=function(K,L){K?(this.Pza(),this.f1a=-1,this.j8=[],this.r7a=!1,this.m2={},this.authorColor={},this.Jzi(L),this.C4c(K)):d.ULS.shipAssertTag(537150410,0,!1,"VersionHistoryHighlightManager.Initialize - userActivityList was Null")};a.prototype.tXd=function(){function K(O,B,Q){var U=L.$.oa.va;O=F.b(O,L.ei);B=F.a(B,L.Tya);var X=U.Na(1,null);return T.g(U,"GetVersionHistoryHighlightActivitiesData",X,O,B,Q,null,4)}var L=this;d.ULS.sendTraceTag(537150409,0,50,
"VersionHistoryHighlightManager: TryFetchUserActivityandTriggerDiff triggered: "+this.U4c.toString()+" --"+this.rIa.toString());this.U4c++;y.EwaSettings.Zb()?this.$.userOperationManager.Sb(new u.a(537,0,K,80),null):this.$.userOperationManager.Sb(new l.a(537,0,K,16),null)};a.prototype.Zxc=function(K){var L=this.m2,O;for(O in L){var B=O,Q=L[O];Q?Q.uMb(K):d.ULS.shipAssertTag(537150404,0,!1,"VersionHistoryHighlightManager.ShowOrHideAllHighlights -"+B+"view was Null")}};a.prototype.Pza=function(){var K=
this.m2,L;for(L in K){var O=L,B=K[L];B?B.EId():d.ULS.shipAssertTag(537150403,0,!1,"VersionHistoryHighlightManager.RemoveAllHighlights -"+O+"view was Null")}this.j8=this.m2=null};a.prototype.vXf=function(K){var L=this.XTh(K,this.f1a);var O=L.b$e;K=L.rfg;L.returnValue&&(d.ULS.shipAssertTag(537150402,0,!!K,"VersionHistoryHighlightManager.SelectNextOrPreviousChange - userActivityLocation is null"),this.F6b(),K.IFa.toString()in this.m2?(this.m2[K.IFa.toString()].pnj(K.sk),L=x.D(K.sk),this.ariaLiveNotifier.setEnabled(!1),
this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(String.format(H.a.instance.mb(158),O+1,this.hS.length,L.aB(!1),K.ICc.DisplayName)),this.f1a=O):d.ULS.shipAssertTag(537150401,0,!1,"VersionHistoryHighlightManager.SelectNextOrPreviousChange - "+K.IFa.toString()+" view not present in views dictionary"))};a.prototype.HKb=function(K,L){if(y.EwaSettings.ma(320))if(this.Pr){var O={};O.count=L;K=new h.a(K);K.Values=O;this.Pr.send(K)}else d.ULS.sendTraceTag(537150370,0,10,"VersionHistoryHighlightManager.SendIteratorTextUpdateMessage hostPostmessenger is null");
else d.ULS.sendTraceTag(537150371,0,50,"VersionHistoryHighlightManager.SendIteratorTextUpdateMessage VersionHistoryIterator BRS is turned off")};a.prototype.XTh=function(K,L){var O=!1;var B=null;for(var Q=0;!O&&Q<this.hS.length;){L=K?this.OTh(L):this.HVh(L);B=this.hS[L];var U=Object(k.a)(D.a,this.$.xa.getItemByName(B.sk.SheetName));if(!U)return d.ULS.shipAssertTag(537150369,0,!1,"VersionHistoryHighlightManager.GetNextorPreviousUserActivityLocationFromIndex - useractivitylocation contains sheetrange with null sheet"),
{returnValue:!1,b$e:L,rfg:B};U.visible&&(O=!0);Q++}return{returnValue:O,b$e:L,rfg:B}};a.prototype.OTh=function(K){return-1===K?this.j0e():(K+1)%this.hS.length};a.prototype.HVh=function(K){-1===K&&(K=this.j0e());return K=(K+this.hS.length-1)%this.hS.length};a.prototype.C4c=function(K){this.nbh(K);this.i4c()};a.prototype.p0h=function(K,L){var O=[];if(!K.RangeList)return d.ULS.shipAssertTag(537150368,0,!1,"VersionHistoryHighlightManager.GetUserActivityLocationFromRangeActivityLocation - ActivityLocationType.Range RangeList Null "),
O;K=ik(K.RangeList);for(var B=K.next();!B.done;B=K.next())(B=B.value)&&this.$.xa.Mj(B.SheetName)?(B=new c(0,B,L),O.push(B)):d.ULS.shipAssertTag(537150367,0,!1," Inavlid sheet name"+B.SheetName);return O};a.prototype.nbh=function(K){K=ik(K);for(var L=K.next();!L.done;L=K.next())if(L=L.value,!L||A.e(L.LocationList))d.ULS.sendTraceTag(537150366,0,50,"Empty Location list");else for(var O=ik(L.LocationList),B=O.next();!B.done;B=O.next())if(B=B.value)switch(B.Type){case 0:this.j8.push.apply(this.j8,kk(this.p0h(B,
L.Person)));break;default:d.ULS.sendTraceTag(537150364,0,50,"VersionHistoryHighlightManager.CreateViews Failed. Invalid ActivityLocationType")}else d.ULS.shipAssertTag(537150365,0,!1,"VersionHistoryHighlightManager.CreateUserActivityLocationList - LocationList contains Null")};a.prototype.i4c=function(){for(var K={},L=new n.a,O=[],B=ik(this.j8),Q=B.next();!Q.done;Q=B.next())if(Q=Q.value,L.contains(Q.ICc)||L.add(Q.ICc),0===Q.IFa){var U=new S.a(x.D(Q.sk),m.d(this.$.xa.getItemByName(Q.sk.SheetName))),
X=a.Ywc(U);X in K||O.push(U);K[X]=this.SLh(Q.ICc)}d.ULS.sendTraceTag(42541534,0,15,"VersionHistoryHighlightManager.CreateRangeHighlightView. Total activities : "+this.j8.length+", Highlightable activities: "+O.length+",Total userlist in activities : "+this.j8.length+", Total userlist from pane: "+O.length+" ");this.$Bc();0<O.length&&(K=new (b(1576).RangeVersionHistoryHighlightView)(this.$,O,K,this.dpb),this.m2["0"]=K)};a.prototype.$Bc=function(){var K=this.j8?this.hS.length:0;this.HKb(N.a.setCurrentChangeCount,
0);this.HKb(N.a.setTotalChangesCount,K)};a.prototype.WOa=function(){this.HKb(N.a.WOa,0)};a.prototype.Jzi=function(K){if(K)for(var L,O,B,Q=0;Q<K.length;++Q)if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:5140301_HandleEmptyInitialsColor")&&!K[Q].InitialsColor)d.ULS.sendTraceTag(537150362,0,15,"VersionHistoryHighlightManager.MapAuthorColorInfo: InitialsColor is null or empty for a version author");else{O=K[Q].EmailAddress;B=K[Q].UserName;L=null;if(K[Q].LoginName){var U=K[Q].LoginName.split("|");3===
U.length&&(L=U[2])}L?this.authorColor[L]=K[Q].InitialsColor:O?(d.ULS.sendTraceTag(537150361,0,15,"VersionHistoryHighlightManager Map Author Color: LoginName is null"),this.authorColor[O]=K[Q].InitialsColor):B?(d.ULS.sendTraceTag(537150360,0,15,"VersionHistoryHighlightManager Map Author Color: Email Address is null"),this.authorColor[B]=K[Q].InitialsColor):d.ULS.sendTraceTag(537150359,0,10,"VersionHistoryHighlightManager Map Author Color: User name is null")}else d.ULS.sendTraceTag(537150363,0,15,
"VersionHistoryHighlightManager.MapAuthorColorInfo: versionAuthors is null")};a.prototype.wTj=function(){if(this.$.ya.VersionHistoryHighlightsSettings)for(var K=Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(this.$.ya.VersionHistoryHighlightsSettings))?Sys.Serialization.JavaScriptSerializer.deserialize(this.$.ya.VersionHistoryHighlightsSettings):null,L=0;L<K.length;L++){var O=K[L],B=O.key?O.key:O.Key?O.Key:"";O=O.value?O.value:O.Value?O.Value:"";"DefaultColor"===B?this.BGe=O:"InitialTint"===
B?this.dpb=O:d.ULS.sendTraceTag(537150357,0,15,"VersionHistoryHighlightManager.UpdateHighlightSettings Highlight Settings are incorrect")}else d.ULS.sendTraceTag(537150358,0,15,"VersionHistoryHighlightManager.UpdateHighlightSettings Highlight Settings are null")};a.prototype.SLh=function(K){if(K.Email in this.authorColor)return this.authorColor[K.Email];if(K.DisplayName in this.authorColor)return this.authorColor[K.DisplayName];d.ULS.sendTraceTag(537150356,0,15,"VersionHistoryHighlightManager GetColorFromPerson - unable to associate corresponding author in dictionary");
return this.BGe};a.prototype.F3b=function(K,L){var O=Object(k.a)(D.a,this.$.xa.getItemByName(K.SheetName)),B=Object(k.a)(D.a,this.$.xa.getItemByName(L.SheetName));return O&&B?(O=(O=w.HelperMethods.PC(O.index,B.index))||w.HelperMethods.PC(K.FirstRow,L.FirstRow))||w.HelperMethods.PC(K.FirstColumn,L.FirstColumn):(d.ULS.sendTraceTag(537150355,0,10,"VersionHistoryHighlightManager.CompareSharedSheetRange - null sheet"),0)};a.prototype.j0e=function(){var K=x.m(this.gridView.ha.sa.activeRange,this.$.xa.pa);
if(!K)return d.ULS.sendTraceTag(537150354,0,10,"VersionHistoryHighlightManager.GetNearestLocationIndexFromCurrentSelection - SelectedSharedSheetRange is null "),0;K=w.HelperMethods.nx(new v.a(this.hS),0,this.hS.length,K,this.F1g);0>K&&(K=~K);return K%this.hS.length};a.prototype.F6b=function(){if(this.BKb){if(!(this.BKb.IFa.toString()in this.m2)){d.ULS.shipAssertTag(537150353,0,!1,"VersionHistoryHighlightManager.DeselectCurrentlySelectedView - "+this.BKb.IFa.toString()+" view not present in views dictionary");
return}this.m2[this.BKb.IFa.toString()].afh(this.BKb.sk)}this.f1a=-1};a.prototype.iterateNext=function(){this.vXf(!0)};a.prototype.rxa=function(){this.vXf(!1)};a.Ywc=function(K){return""+K.range+K.sheetId};of.Object.defineProperties(a.prototype,{Ufb:{configurable:!0,enumerable:!0,get:function(){return this.m2}},BKb:{configurable:!0,enumerable:!0,get:function(){return-1===this.f1a?null:this.hS[this.f1a]}},hS:{configurable:!0,enumerable:!0,get:function(){this.r7a||(this.j8.sort(this.G1g),this.r7a=!0);
return this.j8}}});Object(t.a)(a,"VersionHistoryHighlightManager",null,[730,6])},1576:function(t,E,b){function a(l,u,A,z){this.$ib=null;this.$=l;this.Zwg=u;this.YRa=A;this.ZRa={};this.dpb=z;this.jci()}function c(){}b.r(E);t=b(0);var d=b(15),e=b(9);c.Bth="ewa-vhr-rectinnerborder";Object(t.a)(c,"CssClassNames",null,[]);var h=b(64),k=b(41),n=b(208),f=b(95),v=b(21),m=b(359),x=b(1470);b.d(E,"RangeVersionHistoryHighlightView",function(){return a});a.prototype.uMb=function(l){l?this.qb.sn(this.RE):this.qb.fh(this.RE)};
a.prototype.EId=function(){this.uMb(!1);this.qb.Scb(new m.a(null,h.d(this.$.pa)),this.RE)};a.prototype.pnj=function(l){if(this.YRa){var u=new m.a(k.D(l),h.d(this.$.xa.getItemByName(l.SheetName))),A=x.a.Ywc(u);if(A in this.YRa)if(A in this.ZRa){u=n.a.Po(this.YRa[A]);A=this.ZRa[A];for(var z in A)A[z].style.backgroundColor="rgba("+u.r+","+u.g+","+u.b+","+e.a.GXj+")";v.g(this.$).ha.Oa.NG(null);v.g(this.$).J4e(l,60,!0,f.a.V5i)}else d.ULS.sendTraceTag(537150426,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToDivMap doesn't contain entry for "+
A);else d.ULS.sendTraceTag(537150427,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToColorMap doesn't contain entry for "+A)}else d.ULS.sendTraceTag(537150428,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToColorMap is null")};a.prototype.afh=function(l){l=new m.a(k.D(l),h.d(this.$.xa.getItemByName(l.SheetName)));var u=x.a.Ywc(l);if(u in this.ZRa)if(u in this.YRa){l=n.a.Po(this.YRa[u]);u=this.ZRa[u];for(var A in u)u[A].style.backgroundColor="rgba("+l.r+","+l.g+","+l.b+
","+this.dpb+")"}else d.ULS.sendTraceTag(537150424,0,10,"RangeVersionHistoryHighlightView.DeselectView sheetRangeToColorMap doesn't contain entry for "+u);else d.ULS.sendTraceTag(537150425,0,10,"RangeVersionHistoryHighlightView.DeSelectView sheetRangeToDivMap doesn't contain entry for "+u)};a.prototype.jci=function(){var l=this;this.qb.Iw(this.Zwg,[a.K4],!1,function(u,A){if(u&&u.range&&u.sheetId&&A){var z=new m.a(u.range,u.sheetId);z=x.a.Ywc(z);z in l.ZRa||(l.ZRa[z]={});l.ZRa[z][u.paneType.toString()]=
A;z in l.YRa?(u=l.YRa[z],z=n.a.Po(u),A.style.borderColor=u,A.style.backgroundColor="rgba("+z.r+","+z.g+","+z.b+","+l.dpb+")",u=document.createElement("div"),u.className=c.Bth,A.appendChild(u)):d.ULS.sendTraceTag(537150419,0,10,"RangeVersionHistoryHighlightView.InitializeSheetRangeList sheetRangeToColorMap doesn't contain entry for "+z)}else d.ULS.shipAssertTag(537150423,0,!!u,"RangeVersionHistoryHighlightView.AddSheetRangeList: state is null"),d.ULS.shipAssertTag(537150422,0,!u||!!u.range,"RangeVersionHistoryHighlightView.AddSheetRangeList: state.Range is null"),
d.ULS.shipAssertTag(537150421,0,!u||!!u.sheetId,"RangeVersionHistoryHighlightView.AddSheetRangeList: state.SheetId is null"),d.ULS.shipAssertTag(537150420,0,!!A,"RangeVersionHistoryHighlightView.AddSheetRangeList: div is null")})};of.Object.defineProperties(a.prototype,{RE:{configurable:!0,enumerable:!0,get:function(){return[a.K4]}},qb:{configurable:!0,enumerable:!0,get:function(){return this.$ib||(this.$ib=v.g(this.$).qb)}}});a.K4=23;Object(t.a)(a,"RangeVersionHistoryHighlightView",null,[759])},
1640:function(t,E,b){function a(Ib){var rc=zc.call(this)||this;rc.$=Ib;rc.Eb();return rc}function c(Ib,rc,Ta,Cb){var jc=this;Ta=void 0===Ta?null:Ta;Cb=void 0===Cb?null:Cb;this.aHa=null;this.H6e=!1;this.TEf=function(tc){mb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BlueDot",!1)&&!Fc.a.gh(tc.wywaActivities)&&2!==tc.wywaActivities[0].type&&(jc.I_a.Lpj(jc.x_c.qfg),jc.I_a.Zxc(!0),jc.I_a.Z7h(tc.wywaActivities[0]))};this.$=Ib;this.I_a=new F(this.$);this.h3d=new O(Na.AFrameworkApplication.ub,
mb.EwaSettings.ma(453));Ib=Tc.a.MLj(ie.a.instance.Tb("Common.App.CatchUpActivity.ICatchUpRequestHandler"));this.Pkf=Cb;this.x_c=new v(this.$,Ib,this.F6a());this.jxe=new H(this.$,Na.AFrameworkApplication.ub);this.emptyCatchUpBehaviorManager=new f(this.$);this.Tti(function(tc){jc.mIi(tc)},rc);this.Svi();rc=null;Ta||(rc=ie.a.instance.resolve("Common.App.CatchUpActivity.FloodgateEventLogger"));this.flyoutRibbonButton=Ta||new h(rc);this.flyoutFocus=new k(this.$,this.flyoutRibbonButton)}function d(){this.emptyCatchUpBehaviorManager=
this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=null}function e(){this.flyoutAnchorTarget=this.useCompactSummaryString=this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=
this.featuredActivityGroupsEnabled=null}function h(Ib){this.buttonClickedCallback=null;this.xjb=this.Azb=!1;this.FDh=new Date;this.kUe=Ib}function k(Ib,rc){this.$=Ib;this.flyoutRibbonButton=void 0===rc?null:rc;Jc.a(this.$).Nh(this);this.hasFocus=!1}function n(Ib){window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+Ib)}function f(Ib){this.$=Ib}function v(Ib,rc,Ta){Ta=void 0===Ta?!1:Ta;this.qfg=null;this.$=Ib;this.h2b=rc;this.CGb=ie.a.instance.resolve("Common.App.People.IPeopleColorUtils");
this.Xqc=ie.a.instance.resolve("Common.App.People.IUserProfilePictureUtils");this.F6a=Ta}function m(Ib,rc,Ta,Cb,jc,tc,kd){kd=Ib.Na(1,void 0===kd?null:kd);kd.getRelevantActivitiesDataRequest=rc;return Ja.g(Ib,"GetRelevantActivitiesData",kd,Ta,Cb,jc,tc,0)}function x(Ib,rc,Ta,Cb,jc,tc){tc=Ib.Na(1,void 0===tc?null:tc);return Ja.g(Ib,"GetLineageWywaAuthors",tc,rc,Ta,Cb,jc,4)}function l(){var Ib=w.call(this)||this;Ib.relationship=0;return Ib}function u(){this.color=this.imageUrl=this.email=this.givenName=
this.displayName=this.provider=this.id=null}function A(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}function z(){this.activityFeedItems=null}function y(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}function w(){this.activityFeedItemId=this.activityId=null;this.type=0;this.collectionId=this.state=this.navigationId=this.relevancy=this.displayTimestamp=
this.location=this.actors=null}function D(){}function H(Ib,rc){this.$=Ib;this.oi=rc}function F(Ib){var rc=this;this.iRa=this.q4b=this.$ea=null;this.J4={};this.tDa=null;this.Ujd=!1;this.bFb=function(Ta,Cb){switch(Cb.state){case 0:case 1:3===Cb.fFd&&(rc.o7h(),rc.iRa=null);break;case 2:break;case 3:rc.f6c();rc.iRa=Cb.activityId;rc.KAj();break;default:Wa.ULS.shipAssertTag(537168030,0,!1,"CatchUpActivityHighlightManager.OnHighlightStateChanged - Invalid CatchUpActivityHighlightState:"+Cb.state)}};this.Il=
function(){rc.Bsb()};this.Rc=function(){rc.Bsb()};this.ap=function(){rc.Bsb()};this.Fh=function(){rc.Bsb()};this.p3f=function(Ta,Cb){rc.$ea&&Cb.oH!==rc.cka&&(Cb.isSticky&&rc.$6b(!0),(Ta=rc.MOj(Cb.oH))?(rc.$ea.createActivityIndicatorTooltip(Object(zb.a)(new N,{target:Cb.oH,container:Ta,activityIds:[Cb.activityId],isSticky:Cb.isSticky,dirHint:rc.gridView.rtl?12:9})),Cb.isSticky?(rc.cka=Cb.oH,Wa.ULS.sendTraceTag(51172352,0,50,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler: Activity Indicator Raising Selected/Unselected Event.")):
(rc.oec=Cb.oH,Wa.ULS.sendTraceTag(51172353,0,50,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler: Activity Indicator Raising Hover/Unhover Event.")),rc.Lgc||(rc.gridView.view.Is(rc.xBc),rc.gridView.Au(rc.xBc),rc.Lgc=!0)):Wa.ULS.shipAssertTag(537168027,0,!1,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler FlyoutContainer is null."))};this.rIe=function(Ta,Cb){rc.$6b(Cb.ghh)};this.xBc=function(){rc.$ea?(rc.cka&&rc.$ea.updateActivityIndicatorTooltip(Object(zb.a)(new J,{target:rc.cka,
isSticky:!0})),rc.oec&&rc.$ea.updateActivityIndicatorTooltip(Object(zb.a)(new J,{target:rc.cka,isSticky:!1}))):Wa.ULS.shipAssertTag(537168024,0,!1,"CatchUpActivityHighlightManager::UpdateActivityFlyouts ActivityIndicatorTooltipManager is null.")};this.$=Ib;this.gridView=sd.g(this.$);this.ha=this.gridView.ha;this.Ya=this.gridView.Wb;this.ha.IZb(this.Il);this.ha.wG(this.Rc);this.gridView.UD(this.ap);this.Ya.Ak(this.Fh);this.cka=this.oec=null;this.Lgc=!1;this.cbd={}}function J(){this.target=null;this.isSticky=
!1}function S(){this.clearSticky=!1}function N(){this.activityIds=this.container=this.target=null;this.isSticky=!1;this.dirHint=0}function T(){this.$1c=[];this.OLb={};this.Eke={}}function G(Ib,rc,Ta,Cb,jc){Ib=I.call(this,Ib,rc,Ta,Cb)||this;Ib.ranges=jc;Ib.r7a=!1;return Ib}function I(Ib,rc,Ta,Cb){var jc=pf.call(this)||this;jc.$=Ib;jc.y1d=rc;jc.blg=Ta;jc.WB=Cb;jc.state=0;return jc}function K(Ib,rc,Ta){Ta=zf.call(this,Ib,rc,Ta)||this;Ta.gridView=sd.g(Ib);Ta.Ima=rc;return Ta}function L(Ib){var rc=this;
this.bFb=function(){switch(rc.Tu.model.state){case 1:rc.o4f(!0);break;case 0:rc.uMb(!1);break;case 2:case 3:rc.uMb(!0);break;default:Wa.ULS.shipAssertTag(537167968,0,!1,"RangeCatchUpActivityView.OnHighlightStateChanged - Invalid CatchUpActivityHighlightState:"+rc.Tu.model.state)}};this.Vqg=Ib;this.Tu.Zme(this.bFb);this.iz=[]}function O(Ib){this.oi=Ib}function B(Ib){return Qb.call(this,Ib)||this}function Q(Ib,rc){this.$=Ib;this.catchUpActivityManager=rc}function U(){this.fb=null}function X(Ib){this.xu=
Ib}function P(Ib){this.Pug=Ib}function ea(Ib){this.pga=Ib;this.Dae=new De.a}function ia(Ib,rc,Ta){this.Obe=Ib;this.FCa=rc;this.WCa=Ta}function da(Ib,rc,Ta,Cb,jc,tc){Ib=Nd.call(this,Ib,rc)||this;Ib.ItemIds=null;Ib.ActivityStatesToSet=0;Ib.ActivityStatesToReset=0;Ib.ResetUnseenCount=!1;Ib.ItemIds=Ta;Ib.ActivityStatesToSet=Cb;Ib.ActivityStatesToReset=jc;Ib.ResetUnseenCount=tc;return Ib}function xa(Ib,rc){return ge.call(this,Ib,rc)||this}function Z(Ib,rc){this.Qg=Ib;this.xu=rc}function ha(Ib){var rc=
sc.call(this)||this;rc.$=Ib;rc.Eb();return rc}function ya(Ib){var rc=mc.call(this)||this;rc.$=Ib;rc.Eb();return rc}function va(Ib,rc){var Ta=this;this.$pd=!1;this.Sf=function(){Ta.uag()};this.$=Ib;mb.EwaSettings.ma(611)&&this.$.ea.l8a&&!va.sxb&&(rc&&!rc.Ndb||this.wXj(),va.J6e?Wa.ULS.sendTraceTag(537155461,0,50,"LineageTeachingCalloutTriggerManager will not trigger WYWA waterline check as it was already checked in session"):rc&&!rc.Ndb||this.CXj());Wa.ULS.sendTraceTag(537155460,0,50,"LineageTeachingCalloutTriggerManager is initialized.")}
function bb(Ib){var rc=Df.call(this)||this;rc.gi=null;rc.Xg=null;rc.$=Ib;rc.Eb();return rc}function ba(Ib,rc,Ta){var Cb=gf.call(this,Ib)||this;Cb.de=null;Cb.Eze=null;Cb.fFb=null;Cb.xpd=!0;Cb.lu=0;Cb.lp=!1;Cb.Fc=function(jc,tc){tc.kg||Cb.c1c()};Cb.Rj=function(){Cb.c1c();return!0};Cb.$=rc;Cb.taskPaneManager=Ta;Cb.$.Bk(Cb.Fc);Jc.a(Cb.$).Nh(Cb);Kd.a.rd(Cb.$)&&(Cb.isVisible=!1);return Cb}function fa(Ib){var rc=Zb.call(this)||this;rc.lineageTaskPane=null;rc.D7=null;rc.$=Ib;rc.Eb();return rc}function ra(Ib,
rc,Ta,Cb){var jc=this;this.dub=this.hF=null;this.PD=this.std=0;this.fFb=function(){jc.D7&&(jc.D7.stop(),jc.D7=null);jc.kMb.start();jc.hF.createLineagePane(jc.ntd,jc.dub)};this.lineageOpenPaneOrChangeFilterRequest=function(tc,kd){function Rd(ve,Se,Ve){var Va=jc.$.oa.va,Rb=Wd;ve=pd.b(ve,jc.efd("LineageOpenPaneOrChangeFilter"));Se=pd.a(Se,pe);var Lc=Va.Na(1,null);Lc.clientParams=le;Lc.lineageFilter=Rb;return Ja.g(Va,"LineageOpenPaneOrChangeFilter",Lc,ve,Se,Ve,null,0)}function pe(ve){ve=Tb.a.xf(ve.data);
Wa.ULS.sendTraceTag(537155481,0,50,"LineageManager::LineageOpenPaneOrChangeFilter service call failed. Errors: ["+nc.a.Cc(ve)+"]")}jc.kMb.stop();Nb.b(jc.$).yd(lc.a.lPi,{});jc.YCj();var le=Object(zb.a)(new V,{ClientViewCapacity:tc.clientViewCapacity}),Wd=null;kd&&(Wd=Object(zb.a)(new Aa,{FilterSheetMultiRange:jc.vNj(kd.filterSheetMultiRange)}));mb.EwaSettings.Zb()?jc.$.userOperationManager.Sb(new gb.a(1010,0,Rd,80),null):jc.$.userOperationManager.Sb(new Kb.a(1010,0,Rd,16),null)};this.lineageLoadMoreRequest=
function(tc){function kd(pe,le,Wd){var ve=jc.$.oa.va;pe=pd.b(pe,jc.efd("LineageLoadMore"));le=pd.a(le,Rd);var Se=ve.Na(1,null);Se.fetchFromBelow=tc;return Ja.g(ve,"LineageLoadMore",Se,pe,le,Wd,null,0)}function Rd(pe){pe=Tb.a.xf(pe.data);Wa.ULS.sendTraceTag(537155480,0,50,"LineageManager::LineageLoadMore service call failed. Errors: ["+nc.a.Cc(pe)+"]")}Nb.b(jc.$).yd(lc.a.kPi,{});mb.EwaSettings.Zb()?jc.$.userOperationManager.Sb(new gb.a(1011,0,kd,80),null):jc.$.userOperationManager.Sb(new Kb.a(1011,
0,kd,16),null)};this.lineageRefreshViewRequest=function(){function tc(Rd,pe,le){var Wd=jc.$.oa.va;Rd=pd.b(Rd,jc.efd("LineageRefreshView"));pe=pd.a(pe,kd);var ve=Wd.Na(1,null);return Ja.g(Wd,"LineageRefreshView",ve,Rd,pe,le,null,0)}function kd(Rd){Rd=Tb.a.xf(Rd.data);Wa.ULS.sendTraceTag(537155479,0,50,"LineageManager::LineageRefreshView service call failed. Errors: ["+nc.a.Cc(Rd)+"]")}Nb.b(jc.$).yd(lc.a.mPi,{});mb.EwaSettings.Zb()?jc.$.userOperationManager.Sb(new gb.a(1012,0,tc,80),null):jc.$.userOperationManager.Sb(new Kb.a(1012,
0,tc,16),null)};this.lineageUpdateViewRequest=function(){Ha(jc.$.oa.va,function(tc){if(tc=Xc.a(tc)?null:tc.Result){var kd={};kd=(kd.CountOfUpdatedActivities=tc.LineageActivitiesResponse.ActivityList.length,kd);Nb.b(jc.$).yd(lc.a.nPi,kd);tc=Object(zb.a)(new aa,{activityList:jc.Uqc(tc.LineageActivitiesResponse.ActivityList),latestActivityId:tc.LineageActivitiesResponse.LastSearchedActivityId,oldestActivityId:tc.LineageActivitiesResponse.FirstSearchedActivityId,serverMessageCode:tc.LineageActivitiesResponse.LineageResponseCode,
lastSearchedActivityTimestamp:new Date(tc.LineageActivitiesResponse.EcmaLastSearchedDate),hasNewActivities:tc.HasNewActivities,filterSheetMultiRange:jc.lNj(tc.LineageActivitiesResponse.FilterSheetMultiRange),serverFirstActivityId:tc.LineageActivitiesResponse.ServerFirstActivityId,serverLastActivityId:tc.LineageActivitiesResponse.ServerLastActivityId,showLoadPrevious:tc.LineageActivitiesResponse.ShowLoadPrevious,eolCorrelationId:tc.LineageActivitiesResponse.EolCorrelationId,eolDateHideHistory:new Date(tc.LineageActivitiesResponse.EolDateHideHistory),
eolPersonHideHistory:jc.kwb(tc.LineageActivitiesResponse.EolPersonHideHistory)});jc.hF.onLineageActivitiesUpdateResponse(tc)}else Wa.ULS.shipAssertTag(537155475,0,!!tc,"LineageManager.LineageUpdateView returned null response.")},function(tc){tc=Tb.a.xf(tc.data);Wa.ULS.sendTraceTag(537155474,0,50,"LineageManager::LineageUpdateView service call failed. Errors: ["+nc.a.Cc(tc)+"]")},null,null)};this.onCardSelected=function(tc,kd){if(tc=tc.rangeHighlightLocation){if(kd){var Rd=Fa.Z(kd,null);var pe=Rd.range;
if(Rd.returnValue){jc.s8e(tc.sheetName,jc.swb([Fa.j(pe)]));return}Wa.ULS.shipAssertTag(537155472,0,!1,"The produced subCellLocation string "+kd+" is not valid.")}tc.rangeList.length?jc.s8e(tc.sheetName,tc.rangeList):jc.$7h(tc.sheetName)}};this.onLearnMoreLinkClicked=function(){if(mb.EwaSettings.isChangeGateEnabled("OfficeVSO:4597686_LineageLearnMoreLinkEnabled")){var tc=new Ob.a(-859308420,Oe.a.Cb,jc.$.Jc,12,null),kd={};kd=(kd[Oe.a.Wf]="HelpID=XLO_LineageTS",kd.InputMethod=Oe.a.Cb,kd[Oe.a.Mc]=Ie.a.GQ,
kd.ShouldCanvasTakeFocus=!0,kd);jc.$.Ka.Kb(tc,kd)}};this.onVersionHistoryButtonClicked=function(tc){jc.$.Ka.Kb(new Ob.a(-1112508866,tc,jc.$.Jc,12,null))};this.isFeatureEnabled=function(){return!1};this.Sf=function(){var tc=jc.$.ea.io.LineageVersion;tc!==jc.std&&(Wa.ULS.sendTraceTag(537155470,0,50,"LineageManager.OnWorkbookMetadataChanged: lineageVersion: "+tc+", this.lineageVersion: "+jc.std),jc.std=tc,jc.K8i())};this.Uc=function(tc,kd){jc.hF&&!jc.lineageTaskPane.fhc&&kd.sH&&(Wa.ULS.sendTraceTag(587220563,
0,15,"LineageManager::SessionIdChanged detected."),jc.onStaleActivitiesDetected())};this.ro=function(){jc.hF&&!jc.lineageTaskPane.fhc&&(Wa.ULS.sendTraceTag(587220562,0,15,"LineageManager::LoadOnDemandOccurred detected."),jc.onStaleActivitiesDetected())};this.VC=function(){var tc=jc.E4a();jc.hF.onFilterableSheetListChange(tc)};this.Qya=function(){var tc=jc.E4a();jc.hF.onFilterableSheetListChange(tc)};this.Ioc=function(){var tc=jc.E4a();jc.hF.onFilterableSheetListChange(tc)};this.onPaneClosed=function(){jc.hF.onPaneClosed();
Ea(jc.$.oa.va,null,function(tc){tc=Tb.a.xf(tc.data);Wa.ULS.sendTraceTag(537155469,0,50,"LineageManager::OnLineageClosePaneFailed service call failed. Errors: ["+nc.a.Cc(tc)+"]")},null,null)};this.onRangeFilterInputEnabled=function(tc){tc?jc.gridView.ha.qP(jc.Rc):jc.gridView.ha.AW(jc.Rc)};this.Rc=function(){var tc=Fa.q(jc.gridView.ha.sa.activeRange,jc.$);tc=Object(zb.a)(new Ua,{rangeList:jc.swb(tc.Ranges),sheetName:tc.SheetName});jc.hF.onSelectedRangeUpdated(tc)};this.tryParseRangeInfo=function(tc){var kd=
Fa.Z(tc,jc.$.xa);var Rd=kd.sheetName;tc=kd.range;return kd.returnValue?(Rd||(Rd=jc.$.xa.pa.sheetName),kd=[],kd.push(tc),tc=Fa.u(Rd,null,kd),Object(zb.a)(new Ua,{rangeList:jc.swb(tc.Ranges),sheetName:tc.SheetName})):null};this.xz=function(){var tc=jc.PD!==jc.$.ea.Ke;jc.hF&&jc.lineageTaskPane.isVisible&&tc&&(jc.PD=jc.$.ea.Ke,jc.hF.onRefreshRequired())};this.$=Ib;rc.Ga(366,this);rc.Ga(501,this);this.gridView=sd.g(this.$);this.lineageTaskPane=Ta;this.ntd=this.lineageTaskPane.qM();this.batchSize=50;this.D7=
Cb;this.kMb=this.$.Fb.Mg("UserAction","LineagePaneLoadingShimmerStopWatch");this.Xqc=ie.a.instance.resolve("Common.App.People.IUserProfilePictureUtils");this.Fbi();this.jCg()}function pa(){this.hasOldValue=this.hasNewValue=!1;this.cellLocation=this.oldValue=this.newValue=null}function Za(){this.activityId=0;this.displayTimestamp=this.author=this.activityGuid=null;this.activityType=0;this.rangeHighlightLocation=this.isBulkEditOverflow=this.valueChanges=this.gridLocation=this.sheetName=this.nestedActivityList=
null;this.degradedCardTypeBits=0}function Ua(){this.sheetName=this.rangeList=null}function Ma(){this.lastCol=this.firstCol=this.lastRow=this.firstRow=0}function oa(){this.logger=this.uiCulture=this.dataCulture=null;this.clientBatchSize=0;this.lineageAppCallbacks=this.filterableSheetList=null}function ja(){this.imageUrl=this.email=this.displayName=this.provider=this.id=null}function ta(){this.onLearnMoreLinkClicked=this.isFeatureEnabled=this.onRangeFilterInputEnabled=this.tryParseRangeInfo=this.onVersionHistoryButtonClicked=
this.onCardSelected=this.lineageUpdateViewRequest=this.lineageRefreshViewRequest=this.lineageLoadMoreRequest=this.lineageOpenPaneOrChangeFilterRequest=null}function aa(){var Ib=ma.call(this)||this;Ib.hasNewActivities=!1;Ib.filterSheetMultiRange=null;return Ib}function ma(){this.activityList=null;this.oldestActivityId=this.latestActivityId=0;this.lastSearchedActivityTimestamp=null;this.serverLastActivityId=this.serverFirstActivityId=this.serverMessageCode=0;this.docId=null;this.showLoadPrevious=!1;
this.eolPersonHideHistory=this.eolDateHideHistory=this.eolCorrelationId=null}function Ea(Ib,rc,Ta,Cb,jc,tc){tc=Ib.Na(1,void 0===tc?null:tc);return Ja.g(Ib,"LineageClosePane",tc,rc,Ta,Cb,jc,0)}function Ha(Ib,rc,Ta,Cb,jc,tc){tc=Ib.Na(1,void 0===tc?null:tc);return Ja.g(Ib,"LineageUpdateView",tc,rc,Ta,Cb,jc,0)}function Aa(){}function V(){}function La(Ib){var rc=Jd.call(this)||this;rc.$=Ib;rc.Eb();return rc}function Ra(Ib){this.Ndb=!0;Ra.Ubf()?Ra.bcf()?(Wa.ULS.sendTraceTag(526434368,0,50,"LineageCatchUpExperimentManager is running in hybrid mode. TUI exhausted: "+
!Ib),this.Ndb=Ib):this.Ndb=!1:this.Ndb=!0}function pb(Ib){return qd.call(this,Ib)||this}function cb(Ib,rc){this.$=Ib;this.lineageManager=rc;Ib=[new Sd.a(wb.a.ptd,1038647878,0,0,2222),new Sd.a(wb.a.idle,1038647878,0,1)];Cd.a(this.$).OHd(new vc.a(wb.a.otd,wb.a.idle,Ib),new Sa(wb.a.ptd,wb.a.idle,rc))}function Sa(Ib,rc,Ta){Ib=Be.call(this,Ib,rc)||this;Ib.lineageManager=Ta;return Ib}function Db(Ib){var rc=de.call(this)||this;rc.$=Ib;rc.Eb();return rc}function Ab(Ib){return xe.call(this,Ib)||this}function Wb(Ib){var rc=
this;this.baseVersionInfo=this.x3=this.Toa=this.jm=this.ewaAccessibilityManager=this.sOb=null;this.lId=this.msf=!1;this.OFe=!0;this.dialog=this.FB=this.aUe=this.mD=this.f_d=this.d_d=this.e_d=null;this.RBf=function(Ta){Wa.ULS.sendTraceTag(42553885,0,50,"VersionHistoryPaneActor:OnRestoreVersionSelected - Restore is triggered");if(rc.Szj()){var Cb=function(tc){Yb.c(2138207060,!1);rc.jm.setRestoreFailedAtServer(tc)};rc.mD&&rc.mD.startTimer(Wb.$9f);var jc=function(){rc.mD.endTimer(Wb.$9f);rc.dxe(rc.mD)};
rc.jm.setRestoreInProgress();ic.a(rc.$).cs(new qc.a(wb.a.Jx,5,function(){var tc=Cd.a(rc.$).dd.activityState;tc[fd.a.fq]=wb.a.Oze;tc[Cc.a.kY]=!0;tc[Cc.a.xT]=0;tc[Ia.ogg]=Ta;tc[Ia.frc]=Na.AFrameworkApplication.Yi;tc[Ia.Gud]=jc;tc[ka.G4f]=Cb}))}else Yb.c(2138207060,!1)};this.AEf=function(Ta){rc.sOb.then(function(Cb){Cb.enterFocusTrapZone();return null});Wa.ULS.sendTraceTag(537150349,0,50,"VersionHistoryPaneActor: OnVersionsReady called");rc.mD.endTimer(Wb.MVd);rc.mD.incrementCounter(Wb.h5g);Wa.ULS.sendTraceTag(537150348,
0,50,"VersionHistoryPaneActor: OnVersionsReady TimeTakenGetVersionsToOnVersionsReady Ms:"+rc.mD.getTimerDuration(Wb.MVd));rc.chj(Ta.containerDiv);Ta.versions&&0<Ta.versions.length&&(rc.aUe=Wb.OE(Ta.versions[Ta.versions.length-1]));rc.x3&&rc.Toa&&rc.tNd(rc.x3);Wa.ULS.sendTraceTag(537150346,0,50,"VersionHistoryPaneActor:OnVersionsReady Exit")};this.onVersionSelected=function(Ta){Wa.ULS.sendTraceTag(537150345,0,50,"VersionHistoryPaneActor:OnVersionSelected called. for Version:"+Wb.OE(Ta.currentVersion)+
", LastSelected:"+Wb.OE(rc.x3));rc.mD.incrementCounter(Wb.g5g);rc.x3=Ta.currentVersion;rc.baseVersionInfo=Ta.baseVersion;rc.msf=Ta.noBaseToCompareTo;rc.Toa&&rc.cXj()&&(rc.tNd(Ta.currentVersion),Wa.ULS.sendTraceTag(537150344,0,50,"VersionHistoryPaneActor:OnVersionSelected Exit"))};this.Bwf=function(Ta){Wa.ULS.sendTraceTag(537150337,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady called. for Version:"+((null===Ta||void 0===Ta?0:Ta.versionSelected)?Wb.OE(Ta.versionSelected.currentVersion):null)+" UpdatedVersionsCount"+
((null===Ta||void 0===Ta?0:Ta.updatedVersions)?Ta.updatedVersions.length:0)+", LastSelected:"+Wb.OE(rc.x3));rc.mD.incrementCounter(Wb.f5g);if(rc.baseVersionInfo){if((null===Ta||void 0===Ta?0:Ta.updatedVersions)&&2<=Ta.updatedVersions.length){var Cb=null,jc=null,tc=Wb.OE(rc.x3),kd=Wb.OE(rc.baseVersionInfo);Ta=ik(Ta.updatedVersions);for(var Rd=Ta.next();!Rd.done;Rd=Ta.next()){Rd=Rd.value;var pe=Wb.OE(Rd);tc===pe?Cb=Rd:kd===pe&&(jc=Rd);if(Cb&&jc)break}Cb&&jc?(rc.x3=Cb,rc.baseVersionInfo=jc,Wa.ULS.sendTraceTag(537150307,
0,50,"VersionHistoryPaneActor:OnDownloadTokenReady -Calling versionsViewController:OnVersionSelected RevisionID[N]: "+Wb.OE(rc.x3)+", RevisionID[N-1]: "+Wb.OE(rc.baseVersionInfo)+"."),rc.tNd(rc.x3)):Wa.ULS.sendTraceTag(537150306,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady - does not find currentVersion or baseVersion from UpdatedVersions. RevisionID[N]: "+tc+", RevisionID[N-1]: "+kd+".")}else Wa.ULS.sendTraceTag(537150305,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady - no diff call due to downloadTokenReadyObject or downloadTokenReadyObject.UpdatedVersions objects are null or not enough.");
Wa.ULS.sendTraceTag(537150304,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady")}else Wa.ULS.sendTraceTag(537150336,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady baseVersionInfo is null in OnDownloadTokenReady callback.")};this.Cvf=function(){Wa.ULS.sendTraceTag(537150303,0,50,"VersionHistoryPaneActor:OnCloseVersionHistoryDialog Called");rc.O_g();var Ta=new Ob.a(1470556788,0,rc.$.Jc,0,null);rc.$.Ka.Kb(Ta)};this.iCf=function(Ta){Wa.ULS.sendTraceTag(41739662,0,50,"VersionHistoryPaneActor:OnSaveACopy Called");
var Cb=new Ob.a(-1244760097,0,rc.$.Jc,0,null);rc.$.pe.get(51)&&(Wa.ULS.sendTraceTag(537150301,0,50,"VersionHistoryPaneActor:OnSaveACopy for ODConsumer Called"),Cb=new Ob.a(-309686558,0,rc.$.Jc,0,null));Yb.c(1604651619,!0);var jc={};rc.$.Ka.Kb(Cb,(jc.FileDownloadUrl=Ta,jc))};this.Cwf=function(Ta){Wa.ULS.sendTraceTag(537150300,0,50,"VersionHistoryPaneActor:OnDownloadVersion Called");if(!mb.EwaSettings.isChangeGateEnabled("OfficeVSO:6794681_VHDisableDownloadACopy")||rc.Rzj())Ta=new ib.QueryStringBuilder(Ta),
Ta.Ei("fn",Na.AFrameworkApplication.fileName),Wa.ULS.sendTraceTag(537150299,0,50,"VersionHistoryPaneActor:OnDownloadVersion URL Length is "+Ta.toString().length),8===rc.$.frame.f9a(Ta.toString(),!0)?(Wa.ULS.sendTraceTag(587830283,0,10,"VersionHistoryPaneActor:OnDownloadVersion failed"),Yb.c(1316171850,!1)):Yb.c(1316171850,!0)};this.huf=function(Ta){rc.jm.setFullAppErrorCode(Ta)};this.Kxf=function(Ta){switch(Ta){case 101:Ta="VHFailedToGetDownloadToken";break;case 100:Ta="VHFailedToLoadVersionList";
break;case 104:Ta="VHVersioningNotEnabled";break;case 105:Ta="VHFileNotFound";break;case 106:Ta="VHVersionTooOld";break;default:Ta="None"}rc.mD.addEvent("OnFullAppError",Ta);Wa.ULS.sendTraceTag(537150291,0,10,"FullApp Error Event: "+Ta)};this.NBd=function(Ta){rc.OFe=Ta;Wa.ULS.sendTraceTag(537150290,0,50,"VersionHistoryPaneActor:Show Changes toggled to:"+Ta.toString());var Cb={};rc.PNd(hc.a.XNb,(Cb.ToggleValue=Ta,Cb))};this.dzf=function(Ta){Wa.ULS.sendTraceTag(50405840,0,50,"VersionHistoryPaneActor:OnIteratorSelected next: "+
Ta);Yb.c(1488635506,!0);var Cb={};Ta?rc.PNd(hc.a.iterateNext,Cb):rc.PNd(hc.a.rxa,Cb)};this.PHb=function(Ta){switch(Ta.MessageId){case fc.a.hUa:Wa.ULS.sendTraceTag(537150289,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession WacAppCompleted ");mb.EwaSettings.ma(422)&&rc.jm.setVersionLoadComplete();break;case fc.a.iUa:Wa.ULS.sendTraceTag(51128035,0,10,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession WacAppFailed");break;case hc.a.setCurrentChangeCount:Ta=Ta.Values.count;Wa.ULS.sendTraceTag(537150288,
0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession SetCurrentChangeCount : "+Ta);rc.jm.setCurrentChangeCount(Ta);break;case hc.a.setTotalChangesCount:Ta=Ta.Values.count;Wa.ULS.sendTraceTag(537150287,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession SetTotalChangesCount : "+Ta);rc.jm.setTotalChangesCount(Ta);break;case hc.a.WOa:rc.NBd(rc.OFe);break;default:Wa.ULS.sendTraceTag(537150286,0,15,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession MessageID:"+Ta.MessageId)}};
this.$=Ib;this.l9b=this.$.zb+Wb.ayh;this.kId=!1;mb.EwaSettings.ma(388)&&this.rbh();this.OBb="";this.Hsd=0;this.perfTelemetryInfos=[]}function ub(){this.perfTelemetryInfos=this.appSettings=this.docId=this.latestStreamServiceBase=this.serviceBase=this.ulsLogger=null}function vb(){this.appName=0;this.wdEnableDownloadTokens=!1;this.retryCount=0;this.wdEnableIterator=this.wdEnableRestore=this.wdEnableSaveACopy=!1;this.uiLocale=this.wacCluster=this.userSessionId=null;this.disableSaveACopy=this.wdEnableShowVersionChanges=
this.wdEnableHiddenButtonsUntilVersionLoadComplete=this.viewerRootPositionRelative=this.useXhr=this.isRtl=!1;this.disabledChangeGates=null;this.wdEnableDeleteVersions=this.wdEnableSaveACopyOverFlowMenu=!1;this.wdExperimentWithIteratorLocation=this.wdEnableAppColorUpdate=null}function Ka(){this.telemetryCollector=this.baseVersionInfo=this.selectedVersionInfo=null}function eb(){this.rootDiv=this.appBootSettings=null}function yb(){this.actionUrl=this.ulsLogger=null;this.useFetch=this.hideEmbedFooter=
!1}function oc(Ib){this.vw=Ib}function Jb(Ib){this.vw=Ib}function dc(Ib){this.vw=Ib}function $a(){}function Ba(Ib,rc){this.$=Ib;this.JXj=rc}function la(Ib,rc){var Ta=Ub.call(this)||this;Ta.activityName=Ib;Ta.sM=rc;Ta.Eb();return Ta}function ka(Ib,rc){return Oa.call(this,Ib,rc)||this}function ca(Ib,rc,Ta){var Cb=wa.call(this)||this;Cb.activityName=Ib;Cb.sM=rc;Cb.IJ=Ta;Cb.Eb();return Cb}function Ia(Ib,rc,Ta,Cb,jc){var tc=lb.call(this,Ib,rc)||this;tc.ki=null;tc.retryCount=0;tc.SRi=function(kd){var Rd=
tc.OOj(kd);kd=Rd.HLd;Rd.returnValue?kd.Success?(Yb.c(2138207060,!0),Wa.ULS.sendTraceTag(42287318,0,15,"RestoreVersionActivity:onRestoreSuccessCallback Restore version is successful")):(Yb.c(2138207060,!1),Wa.ULS.sendTraceTag(42287317,0,10,"RestoreVersionActivity:onRestoreSuccessCallback Restore version failed with message "+kd.Output),tc.lh(tc.IJ)):(Yb.c(2138207060,!1),tc.lh(tc.IJ));(kd=tc.ki.activityState[Ia.Gud])&&kd();tc.$o();tc.ki.mM()};tc.RRi=function(){if(0<tc.retryCount)Wa.ULS.sendTraceTag(537150418,
0,15,"RestoreVersionActivity:onRestoreFailureCallback Retrying version restore, retry count : "+tc.retryCount),tc.retryCount--,tc.kUf();else{Wa.ULS.sendTraceTag(42287320,0,10,"RestoreVersionActivity:onRestoreFailureCallback Restore version failed");Yb.c(2138207060,!1);tc.lh(tc.IJ);var kd=tc.ki.activityState[Ia.Gud];kd&&kd();tc.$o();tc.ki.mM()}};tc.IJ=Ta;tc.f3=Cb;tc.baseUrl=jc;return tc}b.r(E);var jb=b(10),nb=b(0),Na=b(4),sa=b(235),Wa=b(15),Hb=b(115),Yb=b(188),Sb=b(42),lb=Hb.a;$k(Ia,lb);Ia.prototype.execute=
function(Ib){this.ki=Ib;this.retryCount=3;this.kUf();return 1};Ia.prototype.kUf=function(){var Ib=""+this.baseUrl+"restoreversion.ashx",rc=Sb.c({VersionId:this.ki.activityState[Ia.ogg],QuerySignature:this.ki.activityState[Ia.frc]});this.f3.Zl(Ib,2,rc,{"Content-Type":"application/json; charset=utf-8"},!1,2,this.SRi,this.RRi,null)};Ia.prototype.OOj=function(Ib){var rc=null;Ib=Ib?Ib.data?Ib.data.Rd:null:null;if(!Ib||!Ib.length)return Wa.ULS.sendTraceTag(537150417,0,10,"RestoreVersionActivity:TryGetRestoreResult data returned from restoreversion call is null or empty"),
{returnValue:!1,HLd:rc};Ib=Sb.d(Ib);rc=Ib.Ot;return Ib.returnValue?{returnValue:!0,HLd:rc}:(Wa.ULS.sendTraceTag(537150416,0,10,"RestoreVersionActivity:TryGetRestoreResult Failed in deserialization of returned data from restore version"),{returnValue:!1,HLd:rc})};Ia.ogg="RVAvi";Ia.frc="RVAqs";Ia.Gud="RVlvrt";Object(nb.a)(Ia,"RestoreVersionActivity",Hb.a,[]);var wb=b(6),wa=sa.a;$k(ca,wa);ca.prototype.create=function(){this.pb(new Ia(this.activityName,this.sM,this.IJ,Na.AFrameworkApplication.nd,Na.AFrameworkApplication.ta.Qa.TV))};
ca.ka=function(Ib){Ib.da.Ga(320,new ca(wb.a.KLd,wb.a.Oi,wb.a.LLd))};Object(nb.a)(ca,"RestoreVersionActivityFactory",sa.a,[]);var Oa=Hb.a;$k(ka,Oa);ka.prototype.execute=function(Ib){var rc=this;(0,Ib.activityState[ka.G4f])(function(){rc.$o();Ib.mM()});return 1};ka.G4f="RVEAssea";Object(nb.a)(ka,"RestoreVersionErrorActivity",Hb.a,[]);var Ub=sa.a;$k(la,Ub);la.prototype.create=function(){this.pb(new ka(this.activityName,this.sM))};la.ka=function(Ib){Ib.da.Ga(321,new la(wb.a.LLd,wb.a.Oi))};Object(nb.a)(la,
"RestoreVersionErrorActivityFactory",sa.a,[]);var hb=b(81),Xb=b(915),Gc=b(50),uc=b(37),Nc=b(187),Fb=b(395),ob=b(58);Ba.prototype.Nc=function(){return Na.AFrameworkApplication.fa.qa("IsAnonymousUser")?(Wa.ULS.sendTraceTag(537150415,0,15,"Verison History Command Handler: Anonymous user."),!0):!1};Ba.prototype.executeCommand=function(Ib,rc){Wa.ULS.sendTraceTag(537150414,0,50,"VersionHistoryCommandHandler:ExecuteCommand called.");Ib=!1;switch(rc.command){case -1112508866:Fb.a(this.$)&&this.$.da.za(423).$xc(!1),
Ib=this.JXj.iDj()}Wa.ULS.sendTraceTag(537150413,0,50,"VersionHistoryCommandHandler:ExecuteCommand response"+Ib+".");return Ib?ob.Task.Ua(Ib):Nc.a(rc.command)};Ba.prototype.Ac=function(Ib,rc){return-1112508866===rc.command&&this.$.isVersionHistoryEnabled()};Ba.prototype.Tc=function(){return!1};Object(nb.a)(Ba,"VersionHistoryCommandHandler",null,[401]);var zb=b(7),ib=b(263),fc=b(170),Ic=b(415);$a.addAppPLTEventToLog=function(Ib){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(Ib)}catch(rc){}};
$a.setIsPageLoadForFirstTime=function(Ib){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(Ib)}catch(rc){}};Object(nb.a)($a,"VersionHistoryLogConnector",null,[]);var Yc=b(27),Mc=b(1040),xb=b(1452),wc=b(160),Ob=b(91),nc=b(31),mb=b(1),ic=b(43),qc=b(261),hc=b(1201),Jc=b(274),rd=b(257),md=b(12);dc.prototype.Nh=function(){Jc.a(this.vw.$).cB(this.Yd)||Jc.a(this.vw.$).Nh(this)};dc.prototype.d8=function(){Jc.a(this.vw.$).cB(this.Yd)&&Jc.a(this.vw.$).Dz(this)};dc.prototype.ah=
function(Ib){return md.DOMElementExtensions.nf(this.hc,Ib)};dc.prototype.ej=function(){this.vw.$.frame.xe.Ij(this.vw.$.frame.xe.wE)};dc.prototype.Dj=function(){};dc.prototype.Uf=function(Ib,rc){rc||this.vw.sOb.then(function(Ta){Ta.enterHeaderFocusTrapZone();return null});return!rc};of.Object.defineProperties(dc.prototype,{Yd:{configurable:!0,enumerable:!0,get:function(){return rd.a.lgg}},hc:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[id="vhHeader"]')}},canReceiveFocus:{configurable:!0,
enumerable:!0,get:function(){return!0}}});Object(nb.a)(dc,"VersionHistoryHeader",null,[429]);Jb.prototype.Nh=function(){Jc.a(this.vw.$).cB(this.Yd)||Jc.a(this.vw.$).Nh(this)};Jb.prototype.d8=function(){Jc.a(this.vw.$).cB(this.Yd)&&Jc.a(this.vw.$).Dz(this)};Jb.prototype.ah=function(Ib){return md.DOMElementExtensions.nf(this.hc,Ib)};Jb.prototype.ej=function(){this.vw.$.frame.xe.Ij(this.vw.$.frame.xe.wE)};Jb.prototype.Dj=function(){};Jb.prototype.Uf=function(Ib,rc){rc||this.vw.sOb.then(function(Ta){Ta.enterFocusTrapZone();
return null});return!rc};of.Object.defineProperties(Jb.prototype,{Yd:{configurable:!0,enumerable:!0,get:function(){return rd.a.mgg}},hc:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[aria-describedby="versionHistoryPane"]')}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(nb.a)(Jb,"VersionHistoryPane",null,[429]);oc.prototype.Nh=function(){Jc.a(this.vw.$).cB(this.Yd)||Jc.a(this.vw.$).Nh(this)};oc.prototype.d8=function(){Jc.a(this.vw.$).cB(this.Yd)&&
Jc.a(this.vw.$).Dz(this)};oc.prototype.ah=function(Ib){return md.DOMElementExtensions.nf(this.hc,Ib)};oc.prototype.ej=function(){this.vw.$.frame.xe.Ij(this.vw.$.frame.xe.wE)};oc.prototype.Dj=function(){};oc.prototype.Uf=function(Ib,rc){rc||this.vw.sOb.then(function(Ta){Ta.enterViewerFocusTrapZone();return null});return!rc};of.Object.defineProperties(oc.prototype,{Yd:{configurable:!0,enumerable:!0,get:function(){return rd.a.ngg}},hc:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[id="vhViewer"]')}},
canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(nb.a)(oc,"VersionHistoryViewer",null,[429]);var Cc=b(147),fd=b(264),Cd=b(68),Sc=b(451),Md=b(983);Object(nb.a)(yb,"AppBootSettings",null,[]);Object(nb.a)(eb,"AppVersionControllerFactoryParameters",null,[]);Object(nb.a)(Ka,"OnVersionSelectedParams",null,[]);Object(nb.a)(vb,"AppSettings",null,[]);Object(nb.a)(ub,"ControllerFactoryParameters",null,[]);Wb.prototype.dispose=function(){this.Bye()};Wb.prototype.M_i=function(){var Ib=
this;this.$.da.Za(15,function(rc){Ib.ewaAccessibilityManager=rc;Ib.ewaAccessibilityManager.mode=2})};Wb.prototype.rbh=function(){this.e_d=new Jb(this);this.d_d=new dc(this);this.f_d=new oc(this)};Wb.prototype.iDj=function(){var Ib=this;Wa.ULS.sendTraceTag(41739649,0,15,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction called");Na.AFrameworkApplication.gN("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistoryEnableODCSaveACopy");Na.AFrameworkApplication.gN("Microsoft.Office.Excel.Server.Flighting.IDenyListVersionHistorySaveACopyOverFlowMenu");
Na.AFrameworkApplication.gN("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistoryRestoreSkipCoauthCheck");this.mD=excelVersionHistory.FactoryGlobal.getTelemetryCollector();this.perfTelemetryInfos=[];this.mD.startTimer(Wb.Z9f);if(!this.jm&&(Sc.a(function(){Ib.jm=versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Object(zb.a)(new ub,{ulsLogger:new Ic.a,docId:Na.AFrameworkApplication.Yi,appSettings:Object(zb.a)(new vb,{appName:120,userSessionId:Na.AFrameworkApplication.userSessionId,
wdEnableSaveACopy:mb.EwaSettings.ma(356),wdEnableDownloadTokens:mb.EwaSettings.ma(351),wacCluster:Na.AFrameworkApplication.nd.wS,uiLocale:Na.AFrameworkApplication.uiCulture||"en-us",wdEnableRestore:mb.EwaSettings.ma(322)&&Ib.$.isEditMode,wdEnableIterator:mb.EwaSettings.ma(319)&&mb.EwaSettings.ma(320),useXhr:!1,wdEnableHiddenButtonsUntilVersionLoadComplete:mb.EwaSettings.ma(422),disableSaveACopy:Ib.XQd(),wdEnableShowVersionChanges:mb.EwaSettings.ma(319)&&mb.EwaSettings.ma(321),disabledChangeGates:Ib.$.ya.VHSDisabledChangeGates,
wdEnableSaveACopyOverFlowMenu:mb.EwaSettings.ma(543),isRtl:Na.AFrameworkApplication.isRtl}),perfTelemetryInfos:Ib.perfTelemetryInfos}))}),!this.jm))return Wa.ULS.sendTraceTag(537150352,0,10,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction - VersionHistoryController should not be null"),Yb.c(429638140,!1),!1;this.jDj();this.mD.endTimer(Wb.Z9f);this.mD.startTimer(Wb.b$f);Wa.ULS.sendTraceTag(537150351,0,50,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction Returned Success");Yb.c(429638140,
!0);return!0};Wb.prototype.jDj=function(){this.Pi();if(!document.getElementById(this.l9b)){var Ib=document.createElement("div");Ib.id=this.l9b;Ib.style.width="100%";Ib.style.zIndex="998";Ib.style.display="block";Ib.style.position="absolute";Na.AFrameworkApplication.ta.Qa.Qf?(Ib.style.top=document.getElementById("HeaderRegion").offsetHeight+"px",Ib.style.bottom="0px"):Ib.style.height="100%";this.$.Sq.insertBefore(Ib,this.$.Sq.firstChild);this.sOb=this.jm.createVersionHistoryDialog(Ib)}document.getElementById(this.l9b).style.display=
"block";this.$Hd();this.mD.startTimer(Wb.MVd);this.jm.getVersions("")};Wb.prototype.$Hd=function(){mb.EwaSettings.ma(388)&&(this.e_d.Nh(),this.d_d.Nh(),this.f_d.Nh(),this.M_i())};Wb.prototype.cYd=function(){mb.EwaSettings.ma(388)&&(this.e_d.d8(),this.d_d.d8(),this.f_d.d8(),this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0))};Wb.prototype.Pi=function(){this.jm.getVersionsReadyEvent().addListener(this.AEf);this.jm.getVersionSelectedEvent().addListener(this.onVersionSelected);this.jm.getCloseSelectedEvent().addListener(this.Cvf);
this.jm.getFullAppErrorEvent().addListener(this.Kxf);this.jm.getIteratorSelectedEvent().addListener(this.dzf);this.jm.getShowVersionChangesToggledEvent().addListener(this.NBd);mb.EwaSettings.ma(351)&&(this.jm.getDownloadTokenReadyEvent().addListener(this.Bwf),this.kId=!0);mb.EwaSettings.ma(356)&&(this.jm.getSaveACopySelectedEvent().addListener(this.iCf),this.jm.getDownloadVersionSelectedEvent().addListener(this.Cwf));mb.EwaSettings.ma(322)&&this.$.isEditMode&&(this.jm.getRestoreVersionSelectedEvent().addListener(this.RBf),
this.lId=!0);this.Toa&&this.Toa.getAppErrorEvent().addListener(this.huf)};Wb.prototype.Tj=function(){this.jm.getVersionsReadyEvent().removeListener(this.AEf);this.jm.getVersionSelectedEvent().removeListener(this.onVersionSelected);this.jm.getCloseSelectedEvent().removeListener(this.Cvf);this.jm.getFullAppErrorEvent().removeListener(this.Kxf);this.jm.getIteratorSelectedEvent().removeListener(this.dzf);this.jm.getShowVersionChangesToggledEvent().removeListener(this.NBd);mb.EwaSettings.ma(356)&&(this.jm.getSaveACopySelectedEvent().removeListener(this.iCf),
this.jm.getDownloadVersionSelectedEvent().removeListener(this.Cwf));this.kId&&(this.jm.getDownloadTokenReadyEvent().removeListener(this.Bwf),this.kId=!1);this.lId&&(this.jm.getRestoreVersionSelectedEvent().removeListener(this.RBf),this.lId=!1);this.Toa&&this.Toa.getAppErrorEvent().removeListener(this.huf)};Wb.prototype.Oxj=function(){return this.XQd()||!Na.AFrameworkApplication.eZ};Wb.prototype.Rzj=function(){return this.Oxj()?(Wa.ULS.sendTraceTag(520180169,0,15,"VersionHistoryPaneActor:OnDownloadVersion blocked"),
Yb.c(1316171850,!1),!1):!0};Wb.prototype.Szj=function(){var Ib=!0;if(mb.EwaSettings.ma(605)&&!this.$.LQ)return Wa.ULS.sendTraceTag(537150350,0,15,"VersionHistoryPaneActor:ShouldTriggerRestore - Skipping coauth check with status "+this.$.ea.amIAlone.toString()),!0;if(!this.$.ea.amIAlone&&!mb.EwaSettings.ma(318)){this.ovi();this.jm.setCoauthRestoreError();Ib=!1;var rc=new Ob.a(-729359593,0,this.$.Jc,0,null);this.$.Ka.Kb(rc)}this.$.LQ&&(Wa.ULS.sendTraceTag(42522439,0,10,"VersionHistoryPaneActor:ShouldTriggerRestore - Restore failed, Unsaved changes present"),
Ib&&(Ib=!1,this.hDj()));return Ib};Wb.prototype.hDj=function(){var Ib=nc.a.Xc(1,0,1890,1889,0,-1603358883,"RestoreVersionUnsavedChangesError");Ib=this.dialog||new wc.ErrorDialog(this.$,Ib);Ib.initialize();Ib.qf()};Wb.prototype.cXj=function(){Wa.ULS.sendTraceTag(537150343,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters called for BaseVersion"+(this.baseVersionInfo?Wb.OE(this.baseVersionInfo):""));if(Wb.OE(this.x3)===this.aUe)return Wa.ULS.sendTraceTag(537150342,0,15,"VersionHistoryPaneActor:ValidateDiffDiffParameters for last version"),
!0;if(mb.EwaSettings.isChangeGateEnabled("OfficeVSO:4381797_XLVHSkipBaseVersionValidateForGroupingUI")&&!this.baseVersionInfo&&this.msf)return Wa.ULS.sendTraceTag(537150341,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters skipping diff last version"),!0;if(!this.baseVersionInfo)return Wa.ULS.sendTraceTag(537150340,0,10,"VersionHistoryPaneActor:ValidateDiffDiffParameters for null BaseVersion"),!1;var Ib=Wb.pOh(this.baseVersionInfo);Wa.ULS.sendTraceTag(537150339,0,50,"downloadURL length "+(Ib?
Ib.length:0));return Ib?!0:(Wa.ULS.sendTraceTag(537150338,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters downloadURL is null"),!1)};Wb.prototype.XQd=function(){return!this.$.zka};Wb.prototype.O_g=function(){document.getElementById(this.l9b).style.display="none";var Ib=new Ob.a(-1423792966,0,this.$.Jc,0,null);this.$.Ka.Kb(Ib);this.Bye()};Wb.prototype.Bye=function(){this.mD&&(this.mD.endTimer(Wb.b$f),this.dxe(this.mD),this.mD=null);this.Tj();this.cYd();this.perfTelemetryInfos&&(Wa.ULS.sendTraceTag(537150302,
0,15,this.perfTelemetryInfos.toString()),this.perfTelemetryInfos=null);this.FB&&(this.FB.Foa(fc.a.hUa),this.FB.Foa(fc.a.iUa),this.FB.Foa(hc.a.setCurrentChangeCount),this.FB.Foa(hc.a.setTotalChangesCount),mb.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.FB.Foa(hc.a.WOa),this.FB.dispose(),this.FB=null)};Wb.prototype.chj=function(Ib){var rc=this;try{this.Toa?$a.setIsPageLoadForFirstTime(!1):($a.setIsPageLoadForFirstTime(!0),Sc.a(function(){var Ta=new yb;
Ta.ulsLogger=new Ic.a;Ta.actionUrl=rc.$.ya.VersionHistoryActionUrl;Ta.hideEmbedFooter=!0;Ta.useFetch=mb.EwaSettings.ma(417)&&!Yc.a.Xu;rc.Toa=excelVersionHistory.FactoryGlobal.getAppVersionControllerInstance(Object(zb.a)(new eb,{appBootSettings:Ta,rootDiv:Ib}))}))}catch(Ta){Wa.ULS.sendTraceTag(41239239,0,10,"VersionHistoryPaneActor: ResetAppVersionController failed due to exception. "+Ta)}};Wb.prototype.tNd=function(Ib){Wa.ULS.sendTraceTag(537150298,0,50,"VersionHistoryPaneActor:SelectVersion called. for Version:"+
Wb.OE(Ib)+", LastSelected:"+this.OBb);if(Ib)if(Wb.OE(Ib).length){var rc=(new Date).getTime();if(Wb.OE(Ib)===this.OBb&&1E3>rc-this.Hsd)Wa.ULS.sendTraceTag(537150295,0,50,"VersionHistoryPaneActor:SelectVersion reattempt within 1 sec");else{Wb.OE(Ib)!==this.OBb&&(Wa.ULS.sendTraceTag(537150294,0,50,"VersionHistoryPaneActor:Reset Iterator states if user clicks on different version"),this.jm.setTotalChangesCount(-1),this.jm.setCurrentChangeCount(-1));var Ta=excelVersionHistory.FactoryGlobal.getTelemetryCollector();
Ta.addEvent("SelectVersion",Wb.OE(Ib));try{this.EZj(Ta);this.Hsd=rc;this.OBb=Wb.OE(Ib);var Cb=new Ka;Cb.selectedVersionInfo=this.x3;Cb.baseVersionInfo=this.baseVersionInfo;Cb.telemetryCollector=Ta;this.Toa.onVersionSelectedWithParams(Cb);this.jm&&mb.EwaSettings.ma(356)&&this.jm.setDisableSaveACopy(this.XQd());var jc=document.getElementById(Wb.$xh);jc&&!this.FB&&(Wa.ULS.sendTraceTag(537150293,0,50,"VersionHistoryPaneActor: SelectVersion Lazy instantiate VersionHistoryMessenger"),this.FB=new hc.a(jc.contentWindow,
hb.a.aba(this.$.ya.VersionHistoryActionUrl)||Md.a.c$),this.FB.Ml(fc.a.hUa,this.PHb),this.FB.Ml(fc.a.iUa,this.PHb),this.FB.Tn(hc.a.setCurrentChangeCount),this.FB.Tn(hc.a.setTotalChangesCount),mb.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.FB.Tn(hc.a.WOa),this.FB.Ml(hc.a.setCurrentChangeCount,this.PHb),this.FB.Ml(hc.a.setTotalChangesCount,this.PHb),mb.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.FB.Ml(hc.a.WOa,
this.PHb))}catch(tc){this.Hsd=0,this.OBb="",Ta.addEvent("Exception",tc.toString()),Wa.ULS.sendTraceTag(42016832,0,10,"VersionHistoryPaneActor: OnVersionSelected failed due to exception. "+tc)}finally{Wa.ULS.sendTraceTag(537150292,0,50,Ta?Ta.getJsonForLogging():"")}}}else Wa.ULS.sendTraceTag(537150296,0,50,"VersionHistoryPaneActor:SelectVersion selectedVersion RevisionId is null");else Wa.ULS.sendTraceTag(537150297,0,50,"VersionHistoryPaneActor:SelectVersion selectedVersion is null")};Wb.prototype.EZj=
function(Ib){for(var rc=ik(this.perfTelemetryInfos),Ta=rc.next();!Ta.done;Ta=rc.next()){var Cb=Ta.value;Ta=Cb.TelemetryEventKey?Cb.TelemetryEventKey:Cb.telemetryEventKey?Cb.telemetryEventKey:"";Cb=Cb.TelemetryEventData?Cb.TelemetryEventData:Cb.telemetryEventData?Cb.telemetryEventData:"";Ta&&Cb&&Ib.addEvent(Ta,Cb)}this.perfTelemetryInfos.length=0};Wb.prototype.dxe=function(Ib){Wa.ULS.sendTraceTag(42553886,0,15,"VersionHistoryPaneActor:CaptureSessionTelemetry - "+(Ib?Ib.getJsonForLogging():"")+" ")};
Wb.prototype.ovi=function(){for(var Ib=this.$.ea.Bm,rc={},Ta=null,Cb=ik(Ib),jc=Cb.next();!jc.done;jc=Cb.next())jc=jc.value,jc.UserEmail&&(rc[jc.UserEmail]=jc.UserEmail in rc?rc[jc.UserEmail]+1:1),jc.User.UserID===this.$.ea.clientId&&(Ta=jc.UserEmail);Wa.ULS.sendTraceTag(42522438,0,10,"VersionHistoryPaneActor:LogCoauthorsTelemetry Restore failed, TotalAuthors: "+Ib.length+", TotalAuthorsAsYourself "+(Ta?rc[Ta]:-1))};Wb.prototype.PNd=function(Ib,rc){Wa.ULS.sendTraceTag(537150285,0,50,"VersionHistoryPaneActor.SendPostMessageToTheVHSession called with MessageID:"+
Ib);if(this.FB){Ib=new Mc.a(Ib);Ib.Values[xb.a.Q4c]=this.$.ya.UserSessionId;if(rc)for(var Ta in rc)Ib.Values[Ta]=rc[Ta];this.FB.send(Ib)}else Wa.ULS.sendTraceTag(537150284,0,10,"VersionHistoryPaneActor.SendPostMessageToTheVHSession versionHistoryMessenger is null")};Wb.OE=function(Ib){return Ib?Ib.RevisionID?Ib.RevisionID:Ib.revisionID?Ib.revisionID:"":""};Wb.pOh=function(Ib){return Ib?Ib.DownloadUrl?Ib.DownloadUrl:Ib.downloadUrl?Ib.downloadUrl:"":""};Wb.ayh="_excelVersionHistoryOverlay";Wb.$xh="vhs_frame";
Wb.Z9f="TimeTakenShowVersionHistoryDialogAction";Wb.b$f="TimeTillVersionHistoryDialogWasOpenMs";Wb.MVd="TimeTakenGetVersionsToOnVersionsReady";Wb.g5g="CountOnVersionSelectedCalledinOneVHSession";Wb.h5g="CountOnVersionsReadyCalledinOneVHSession";Wb.f5g="CountOnDownloadTokenReadyCalledinOneVHSession";Wb.$9f="TimeTakenVersionRestore";Object(nb.a)(Wb,"VersionHistoryPaneActor",null,[6]);var bc=b(207),xe=Xb.a;$k(Ab,xe);Ab.prototype.zd=function(){var Ib=this,rc=this.yui(),Ta=Gc.GetServiceTaskFactory.Ra(this.$.da,
21,137,this.hb);uc.TaskExtensions.Aa(uc.TaskExtensions.Vd([rc,Ta],this.la,3),function(){var Cb=Ta.result,jc=hb.a.aba(Ib.$.ya.VersionHistoryActionUrl);jc!==Md.a.c$&&Cb.LFa(jc);Cb=new Wb(Ib.$);Ib.jd([new Ba(Ib.$,Cb)])},this.la,3)};Ab.prototype.yui=function(){var Ib=Gc.GetServiceTaskFactory.p4a(this.$.da,283,284,this.hb).then(function(rc){return rc.vn.loadScript("excelVersionHistory")},function(rc){Wa.ULS.sendTraceTag(537150412,0,10,"versionHistoryManagerFactory: Dynamic Script Loading failed due to exception. "+
rc);return Promise.reject(rc)});return bc.c(Ib)};Ab.ka=function(Ib){Xb.a.Pd(304,new Ab(Ib))};Object(nb.a)(Ab,"VersionHistoryCommandHandlerFactory",Xb.a,[]);var Je=b(1470),we=b(921),de=sa.a;$k(Db,de);Db.prototype.create=function(){var Ib=this,rc=Gc.GetServiceTaskFactory.Ra(this.$.da,211,212,this.hb),Ta=Gc.GetServiceTaskFactory.Ra(this.$.da,21,137,this.hb);uc.TaskExtensions.Aa(uc.TaskExtensions.Vd([rc,Ta],this.$.la),function(){var Cb=Object(we.a)(Ib.$.da,305,function(){return new Je.a(Ib.$,!0,Ta.result,
rc.result)});Ib.pb(Cb)},this.$.la,3)};Db.ka=function(Ib){Ib.da.Ga(306,new Db(Ib))};Object(nb.a)(Db,"VersionHistoryHighlightManagerFactory",sa.a,[]);var Le=b(567),Ie=b(5),jf=b(168),df=b(14),Be=Hb.a;$k(Sa,Be);Sa.prototype.execute=function(Ib){this.lineageManager.lineageHidePreviousHistory();return Be.prototype.execute.call(this,Ib)};Object(nb.a)(Sa,"LineageClearHistoryConfirmedActivity",Hb.a,[]);var Sd=b(16),vc=b(145);cb.prototype.Nc=function(){return!1};cb.prototype.executeCommand=function(Ib,rc,Ta){Ib=
!1;switch(rc.command){case 1834994092:9===rc.Ne&&this.CIj();this.HAj(rc,Ta);Ib=!0;break;case -409942531:this.JAj(),Ib=!0}return Ib?ob.Task.Ua(!0):Nc.a(rc.command)};cb.prototype.Ac=function(Ib,rc){return 1834994092===rc.command||-409942531===rc.command};cb.prototype.Tc=function(){return!1};cb.prototype.HAj=function(Ib,rc){Wa.ULS.sendTraceTag(537155483,0,50,"LineageActivityCommandHandler::ShowChangesCore command location: "+(rc.MenuItemId||Ib.Ne));this.lineageManager.d4f(19===Ib.Ne&&!!rc.MenuItemId,
rc.MenuItemId,Ib.Ne)};cb.prototype.CIj=function(){var Ib=Ie.a.zrc;Ib!==jf.a(this.$).Ql.xB&&jf.a(this.$).Ql.activateRibbonTab(Ib)};cb.prototype.JAj=function(){var Ib=this;ic.a(this.$).cs(new qc.a(wb.a.otd,5,function(){var rc=Cd.a(Ib.$).dd,Ta=nc.a.Xc(3,1,2219,2220,2221,1038647878,"LineageConfirmClearHistory");Ta.HelpTopicId="a1493bf9-25c3-470a-b970-60eceb0136e5";Ta.HelpDescription=df.a.instance.ga(1312);rc.Bt([Ta])}))};Object(nb.a)(cb,"LineageActivityCommandHandler",null,[401]);var qd=Xb.a;$k(pb,qd);
pb.prototype.zd=function(){var Ib=this;uc.TaskExtensions.Aa(Gc.GetServiceTaskFactory.Ra(this.$.da,366,367,this.hb),function(rc){Ib.jd([new cb(Ib.$,rc.result)])},this.la,3)};pb.ka=function(Ib){Xb.a.Pd(363,new pb(Ib))};Object(nb.a)(pb,"LineageActivityCommandHandlerFactory",Xb.a,[]);Ra.prototype.F6a=function(){return!this.Ndb};Ra.bcf=function(){return Ra.Ubf()&&mb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationTeachingUXTreatmentToControl",!1)};Ra.Ubf=function(){return mb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationSummaryStringTreatment",
!1)};Object(nb.a)(Ra,"LineageCatchUpExperimentManager",null,[746]);var Jd=sa.a;$k(La,Jd);La.prototype.create=function(){var Ib=this;Ra.bcf()?uc.TaskExtensions.Aa(Gc.GetServiceTaskFactory.Ra(this.$.da,456,457,this.hb),function(rc){uc.TaskExtensions.Aa(rc.result.fzj(),function(Ta){Ib.FDe(Ta.result)},Ib.$.la,3)},this.$.la,3):this.FDe(!0)};La.prototype.FDe=function(Ib){this.pb(this.$.da.za(458)||this.$.da.Ga(458,new Ra(Ib)))};La.ka=function(Ib){Ib.da.Ga(459,new La(Ib))};Object(nb.a)(La,"LineageCatchUpExperimentManagerFactory",
sa.a,[]);var ld=b(446),Kd=b(36),re=b(198),ie=b(83),ef=b(153),Fe=b(124);Object(nb.a)(V,"LineageClientParams",null,[]);Object(nb.a)(Aa,"LineageFilter",null,[]);var bf=b(64),Oe=b(76),lc=b(133),Fa=b(41),Kb=b(572),gb=b(177),Tb=b(121),pc=b(110),Xc=b(299),pd=b(298),Uc=b(95),sd=b(21),Nb=b(134),Ja=b(62),Lb=b(51),ec=b(360);Object(nb.a)(ma,"LineageActivitiesResponseDTO",null,[]);$k(aa,ma);Object(nb.a)(aa,"LineageActivitiesUpdateResponseDTO",ma,[]);Object(nb.a)(ta,"LineageAppCallbacks",null,[]);Object(nb.a)(ja,
"LineageAuthorDTO",null,[]);Object(nb.a)(oa,"LineageControllerFactoryParams",null,[]);Object(nb.a)(Ma,"LineageSharedRangeDTO",null,[]);Object(nb.a)(Ua,"LineageSheetMultiRangeDTO",null,[]);Object(nb.a)(Za,"LineageUserActivityDTO",null,[]);Object(nb.a)(pa,"LineageValueChangeDTO",null,[]);ra.prototype.dispose=function(){this.Laj();this.$=null;this.lineageTaskPane&&(this.lineageTaskPane.XN(this.onPaneClosed),this.lineageTaskPane.BF(this.xz),this.lineageTaskPane=null);this.kMb=this.Xqc=this.dub=this.ntd=
this.hF=null};ra.prototype.GBj=function(){return Object(re.a)(this,void 0,void 0,function rc(){var Ta=this,Cb;return Nm(rc,function(jc){Cb=Ta;return jc.return(new Promise(function(tc){function kd(le,Wd,ve){var Se=Cb.$.oa.va;le=pd.b(le,Rd);Wd=pd.a(Wd,pe);var Ve=Se.Na(1,null);return Ja.g(Se,"LineageLoadInGridBlueDots",Ve,le,Wd,ve,null,0)}function Rd(le){if(le=Xc.a(le)?null:le.Result){var Wd={};Wd=(Wd.CountOfActivities=le.ActivityList.length,Wd);Nb.b(Cb.$).yd(lc.a.Ati,Wd);le=Cb.Uqc(le.ActivityList);
tc(le)}else Wa.ULS.shipAssertTag(520717854,0,!!le,"LineageManager LineageLoadInGridBlueDots returned null response.")}function pe(le){le=Tb.a.xf(le.data);Wa.ULS.sendTraceTag(520717856,0,50,"LineageManager::LineageLoadInGridBlueDots service call failed. Errors: ["+nc.a.Cc(le)+"]")}Wa.ULS.sendTraceTag(520717857,0,50,"LineageManager::showInGridBlueDots");Nb.b(Cb.$).yd(lc.a.lineageLoadInGridBlueDots,{});mb.EwaSettings.Zb()?Cb.$.userOperationManager.Sb(new gb.a(1024,0,kd,80),null):Cb.$.userOperationManager.Sb(new Kb.a(1024,
0,kd,16),null)}))})})};ra.prototype.d4f=function(Ib,rc,Ta){if(this.lineageTaskPane.isVisible){if(9===Ta){Wa.ULS.sendTraceTag(560989858,0,50,"LineageManager::ShowLineageTaskPane open from callout was invoked with an opened pane");return}if(!Ib&&16!==Ta&&18!==Ta){this.lineageTaskPane.c1c();return}}Kd.a.rd(this.$)||(this.kMb.start(),this.D7&&(Lb.b().qA(this.kMb.id,this.D7.id,"actions","actions"),this.D7.stop(),this.D7=null));this.lineageTaskPane.fhc||Wa.ULS.sendTraceTag(537155482,0,50,"LineageManager::ShowLineageTaskPane pane reopened by user via "+
(Ib?rc:Ta));this.PD=this.$.ea.Ke;this.dub=null;Ib&&(Ib=Fa.r(this.gridView.ha.sa.selectedRanges,this.$),this.dub=Object(zb.a)(new Ua,{rangeList:rc.toString()===Ie.a.x3f?this.swb(Ib.Ranges):null,sheetName:Ib.SheetName}));Kd.a.rd(this.$)&&this.lineageTaskPane.fhc?this.lineageTaskPane.Fsj(this.fFb):this.hF.createLineagePane(this.ntd,this.dub);this.lineageTaskPane.$f(!0);this.$.Cd(-71295319,-1,0,null)};ra.prototype.lineageHidePreviousHistory=function(){function Ib(Cb,jc,tc){var kd=rc.$.oa.va,Rd=kd.Na(1,
null);return Ja.g(kd,"LineageHidePreviousHistory",Rd,Cb,jc,tc,null,0)}var rc=this,Ta={};Ta=(Ta.paneVisible=this.lineageTaskPane.isVisible,Ta);ef.a.sendTelemetryEvent(Object(zb.a)(new ec.a,{name:"Office.Excel.Online.Lineage.ClearHistoryConfirmed",dataFields:Fe.a.Gk(Ta)}));mb.EwaSettings.Zb()?this.$.userOperationManager.Sb(new gb.a(1018,0,Ib,64),null):this.$.userOperationManager.Sb(new Kb.a(1018,0,Ib,0),null);this.lineageTaskPane.isVisible||this.d4f(!1,null,4)};ra.prototype.Fbi=function(){var Ib=this,
rc=Object(zb.a)(new ta,{tryParseRangeInfo:this.tryParseRangeInfo,isFeatureEnabled:this.isFeatureEnabled,onCardSelected:this.onCardSelected,onVersionHistoryButtonClicked:this.onVersionHistoryButtonClicked,onRangeFilterInputEnabled:this.onRangeFilterInputEnabled,onLearnMoreLinkClicked:this.onLearnMoreLinkClicked,lineageOpenPaneOrChangeFilterRequest:this.lineageOpenPaneOrChangeFilterRequest,lineageLoadMoreRequest:this.lineageLoadMoreRequest,lineageRefreshViewRequest:this.lineageRefreshViewRequest,lineageUpdateViewRequest:this.lineageUpdateViewRequest});
Sc.a(function(){Ib.hF=cellLineage.LineageActivityControllerFactoryGlobal.createLineageActivityController(Object(zb.a)(new oa,{clientBatchSize:Ib.batchSize,filterableSheetList:Ib.E4a(),uiCulture:Ib.$.ya.UICultureTag,dataCulture:Ib.$.ya.DataCultureTag,logger:new Ic.a,lineageAppCallbacks:rc}))})};ra.prototype.efd=function(Ib){var rc=this;return function(Ta){if(Ta=Xc.a(Ta)?null:Ta.Result){var Cb={};Cb=(Cb.CountOfActivities=Ta.ActivityList.length,Cb);Cb.WebRequestName=Ib;Nb.b(rc.$).yd(lc.a.LMi,Cb);Ta=
Object(zb.a)(new ma,{activityList:rc.Uqc(Ta.ActivityList),latestActivityId:Ta.LastSearchedActivityId,oldestActivityId:Ta.FirstSearchedActivityId,serverMessageCode:Ta.LineageResponseCode,lastSearchedActivityTimestamp:new Date(Ta.EcmaLastSearchedDate),serverFirstActivityId:Ta.ServerFirstActivityId,serverLastActivityId:Ta.ServerLastActivityId,showLoadPrevious:Ta.ShowLoadPrevious,eolCorrelationId:Ta.EolCorrelationId,eolDateHideHistory:new Date(Ta.EolDateHideHistory),eolPersonHideHistory:rc.kwb(Ta.EolPersonHideHistory)});
rc.hF.onLineageActivitiesResponse(Ta)}else Wa.ULS.shipAssertTag(537155477,0,!!Ta,"LineageManager."+Ib+" returned null response.")}};ra.prototype.lNj=function(Ib){return pc.e(Ib.Ranges)&&!Ib.SheetName?null:Object(zb.a)(new Ua,{rangeList:this.swb(Ib.Ranges),sheetName:Ib.SheetName})};ra.prototype.swb=function(Ib){var rc=[];Ib=ik(Ib);for(var Ta=Ib.next();!Ta.done;Ta=Ib.next())Ta=Ta.value,Ta=Object(zb.a)(new Ma,{firstCol:Ta.FirstColumn,firstRow:Ta.FirstRow,lastRow:Ta.LastRow,lastCol:Ta.LastColumn}),rc.push(Ta);
return rc};ra.prototype.vNj=function(Ib){if(!Ib)return null;var rc={};rc.Ranges=this.cgd(Ib.rangeList);rc.SheetName=Ib.sheetName;return rc};ra.prototype.cgd=function(Ib){var rc=[];if(pc.e(Ib))return rc;Ib=ik(Ib);for(var Ta=Ib.next();!Ta.done;Ta=Ib.next()){Ta=Ta.value;var Cb={};Cb.FirstColumn=Ta.firstCol;Cb.FirstRow=Ta.firstRow;Cb.LastRow=Ta.lastRow;Cb.LastColumn=Ta.lastCol;rc.push(Cb)}return rc};ra.prototype.$7h=function(Ib){(Ib=this.$.xa.getItemByName(Ib))&&Ib.visible&&Ib.activate(!0)};ra.prototype.s8e=
function(Ib,rc){var Ta=[];rc=ik(rc);for(var Cb=rc.next();!Cb.done;Cb=rc.next()){Cb=Cb.value;var jc={};jc.FirstColumn=Cb.firstCol;jc.FirstRow=Cb.firstRow;jc.LastRow=Cb.lastRow;jc.LastColumn=Cb.lastCol;Ta.push(Fa.D(jc))}rc=Ta.length-1;Cb=Ta[rc].topLeft;sd.g(this.$).jV(Ta,rc,Ib,null,Cb,null,null,3,Uc.a.Bti,void 0,void 0,void 0,!0)};ra.prototype.K8i=function(){this.hF&&this.lineageTaskPane.isVisible&&(this.PD=this.$.ea.Ke,this.hF.onRefreshRequired())};ra.prototype.jCg=function(){this.lineageTaskPane.ZL(this.onPaneClosed);
this.lineageTaskPane.XD(this.xz);this.$.ea.Bu(this.Sf);this.$.ea.Vj(this.Uc);this.$.ea.YL(this.ro);var Ib=this.$.xa;Ib.pY(this.VC);Ib.Uga(this.Ioc);Ib.SFa(this.Qya);Ib.NYa(this.Ioc)};ra.prototype.Laj=function(){this.$.ea.Ew(this.Sf);this.gridView.ha.AW(this.Rc);this.$.ea.wk(this.Uc);this.$.ea.ER(this.ro);var Ib=this.$.xa;Ib.e7(this.VC);Ib.Vma(this.Ioc);Ib.qQa(this.Qya);Ib.NIb(this.Ioc)};ra.prototype.onStaleActivitiesDetected=function(){this.hF.onStaleActivitiesDetected()};ra.prototype.E4a=function(){for(var Ib=
[],rc=ik(this.$.xa.items),Ta=rc.next();!Ta.done;Ta=rc.next())Ta=Ta.value,Ta.visible&&!bf.e(Ta)&&Ib.push(Ta.sheetName);return Ib};ra.prototype.YCj=function(){if(mb.EwaSettings.ma(611)){var Ib=this.$.da.za(403);Ib&&Ib.disable();Ib=new Ob.a(-847286761,Oe.a.Cb,this.$.Jc,0,Ie.a.tW);var rc={};rc=(rc.InputMethod=Oe.a.Cb,rc);rc.CalloutName=5;this.$.Ka.Kb(Ib,rc)}};ra.prototype.Uqc=function(Ib){var rc=[];Ib=ik(Ib);for(var Ta=Ib.next();!Ta.done;Ta=Ib.next())Ta=Ta.value,Ta=Object(zb.a)(new Za,{activityId:Number.parseLocale(Ta.UserActivity.Id),
activityGuid:Ta.Uid,activityType:Ta.UserActivity.Type,author:this.kwb(Ta.UserActivity.Person),sheetName:Ta.SheetName,displayTimestamp:new Date(Ta.UserActivity.DisplayTimestamp),gridLocation:Ta.DisplayLocation,valueChanges:this.S2i(Ta.LineageValueChangeList),isBulkEditOverflow:Ta.IsBulkEditOverFlow,rangeHighlightLocation:this.H2i(Ta.UserActivity.LocationList,Ta.UserActivity.Type),nestedActivityList:this.A2i(Ta.NestedActivityList),degradedCardTypeBits:Ta.DegradedCardTypeBits}),rc.push(Ta);return rc};
ra.prototype.H2i=function(Ib,rc){if(!Ib)return Wa.ULS.sendTraceTag(537155468,0,15,"LineageManager:: RangeHighlightLocation.ActivityLocationList is null"),null;if(!Ib.length)return Wa.ULS.sendTraceTag(537155467,0,50,"LineageManager:: RangeHighlightLocation.ActivityLocationList is empty"),null;var Ta=[],Cb=[],jc="";21===rc?Cb.push(Ib[0]):Cb=Ib;Ib=ik(Cb);for(Cb=Ib.next();!Cb.done;Cb=Ib.next())switch(Cb=Cb.value,Cb.Type){case 1:break;case 2:jc=Cb.SheetName;break;case 0:if(!Cb.RangeList){Wa.ULS.sendTraceTag(537155465,
0,50,"LineageManager:: RangeHighlightLocation.RangeActivityLocation is null");break}jc=Cb.RangeList[0].SheetName;var tc=[];21===rc?tc.push(Cb.RangeList[0]):tc=Cb.RangeList;Cb=ik(tc);for(tc=Cb.next();!tc.done;tc=Cb.next())tc=tc.value,tc=Object(zb.a)(new Ma,{firstCol:tc.FirstColumn,firstRow:tc.FirstRow,lastRow:tc.LastRow,lastCol:tc.LastColumn}),Ta.push(tc);break;default:Wa.ULS.sendTraceTag(537155464,0,50,"LineageManager:: RangeHighlightLocation.ActivityLocationList is of type: ")}return Object(zb.a)(new Ua,
{sheetName:jc,rangeList:Ta})};ra.prototype.S2i=function(Ib){var rc=[];Ib=ik(Ib);for(var Ta=Ib.next();!Ta.done;Ta=Ib.next())Ta=Ta.value,Ta=Object(zb.a)(new pa,{hasNewValue:Ta.HasNewValue,hasOldValue:Ta.HasOldValue,newValue:Ta.HasNewValue?Ta.NewValue:null,oldValue:Ta.HasOldValue?Ta.OldValue:null,cellLocation:Ta.CellLocation}),rc.push(Ta);return rc};ra.prototype.A2i=function(Ib){return Ib?this.Uqc(Ib):null};ra.prototype.kwb=function(Ib){if(!Ib)return null;var rc=null;mb.EwaSettings.isChangeGateEnabled("OfficeVSO:4947893_ShowChangesUserProfilePictureSupportEnabled")&&
Na.AFrameworkApplication.fa.qa("IsUserProfilePictureResolutionEnabled")&&(rc=this.Xqc.WHa(Ib.Email,Ib.Provider,Na.AFrameworkApplication.Yi,0));return Object(zb.a)(new ja,{id:Ib.Id,provider:Ib.Provider,displayName:Ib.DisplayName,email:Ib.Email,imageUrl:rc})};Object(nb.a)(ra,"LineageManager",null,[741,742,6]);var Zb=sa.a;$k(fa,Zb);fa.prototype.fui=function(Ib){var rc=this;uc.TaskExtensions.Aa(Ib,function(){rc.pb(rc.$.da.za(366)||new ra(rc.$,rc.$.da,rc.lineageTaskPane,rc.D7))},this.$.la,3)};fa.prototype.create=
function(){var Ib=this;this.D7=this.$.Fb.sc("UserAction","LineagePaneSeenStopwatch");this.D7.start();var rc=Gc.GetServiceTaskFactory.Ra(this.$.da,365,364,this.hb),Ta=ld.a(this.$),Cb=Gc.GetServiceTaskFactory.Ra(this.$.da,283,284,this.hb);uc.TaskExtensions.Aa(uc.TaskExtensions.Vd([rc,Ta,Cb],this.$.la),function(){Ib.lineageTaskPane=rc.result;Kd.a.rd(Ib.$)||Ta.result.JQ(Ib.lineageTaskPane);Ib.fui(bc.c(Cb.result.vn.loadScript("cellLineage")))},this.$.la,3)};fa.ka=function(Ib){Ib.da.Ga(367,new fa(Ib))};
Object(nb.a)(fa,"LineageManagerFactory",sa.a,[]);var Oc=b(1011),td=b(236),Gd=b(13),Pd=b(109),ee=b(275),Ec=b(86),$c=b(248),id=b(19),vd=b(924),he=b(70),Ge=Ie.a.Qzc+"LineageActivityPaneTitle",Ze=Ie.a.teb+"LineageActivityCloseButton",gf=$c.a;$k(ba,gf);ba.prototype.pP=function(Ib){this.get_events().addHandler("LineageTaskPaneRemove",Ib)};ba.prototype.GR=function(Ib){this.get_events().removeHandler("LineageTaskPaneRemove",Ib)};ba.prototype.XD=function(Ib){this.addHandler("LineageTaskPaneVisibilityChanged",
Ib)};ba.prototype.BF=function(Ib){this.removeHandler("LineageTaskPaneVisibilityChanged",Ib)};ba.prototype.ZL=function(Ib){this.get_events().addHandler("LineageTaskPaneClose",Ib)};ba.prototype.XN=function(Ib){this.get_events().removeHandler("LineageTaskPaneClose",Ib)};ba.prototype.qH=function(){};ba.prototype.Vo=function(){return this.lp};ba.prototype.Sr=function(){return this.lp};ba.prototype.qR=function(){};ba.prototype.DQ=function(){return!1};ba.prototype.ej=function(){};ba.prototype.Dj=function(){};
ba.prototype.dispose=function(){this.$&&(this.$.Ol(this.Fc),Jc.a(this.$).Dz(this));this.de&&(td.a.instance.Ba(Gd.a.click,this.de,this.Rj),Pd.KeyInputManager.instance.sv(this.de,this.Eze));this.de=this.taskPaneManager=this.$=null;gf.prototype.dispose.call(this)};ba.prototype.Uf=function(Ib,rc){if(!rc){Ib=md.DOMElementExtensions.getElementById(this.domElement,"LineagePaneFilterButton");if(!Ib)return!1;md.DOMElementExtensions.setFocus(Ib)}return!rc};ba.prototype.ah=function(Ib){return md.DOMElementExtensions.nf(this.hc,
Ib)};ba.prototype.$f=function(Ib){this.lp=Ib;var rc=this.taskPaneManager;if(this.isVisible=Ib)this.$.frame.xe.Hj("LineagePane"),this.xpd=!1;if(Kd.a.rd(this.$))Ib?rc.I6("LineageTaskPane",this.RF):rc.hideTaskPane("LineageTaskPane");else{this.taskPaneManager.Ow();var Ta=!!this.taskPaneManager.wg&&15===this.taskPaneManager.wg.taskPane.Pg;Ib&&0<rc.Pz.length&&(!Ta||rc.isCollapsed)&&rc.GF(this,!0)}this.$.hf()};ba.prototype.qM=function(){var Ib=this.$.zb;Ib=Kd.a.rd(this.$)?this.domElement:document.getElementById(Ib+
Ie.a.rtd);var rc=this.IG();Ib.appendChild(rc);rc=vd.b("div","LineagePaneBodyId","LineageActivityBody");Ib.appendChild(rc);this.Gsj();return rc};ba.prototype.c1c=function(){this.$.frame.xe.Hj(this.$.frame.xe.wE||ee.AFrame.OT);this.xpd=!0;this.$f(!1);this.raiseEvent("LineageTaskPaneClose")};ba.prototype.Fsj=function(Ib){this.fFb=Ib};ba.prototype.Gsj=function(){this.$.frame.xe.Ij("LineagePane");var Ib=this.$.frame.xe.li("LineagePane");Ib.parent=ee.AFrame.OT;Ib.eN=!0};ba.prototype.IG=function(){var Ib=
vd.b("div","LineagePaneHeaderId","LineageActivityPaneHeader"),rc=vd.b("h1","LineagePaneTitleId",Ge);rc.innerText=this.titleText;this.de=Oc.a.lb("LineagePaneCloseButtonId",Ze,df.a.instance.ga(10),"ClosePaneGlyph_16x16x32",!1);this.de.classList.add(Na.AFrameworkApplication.isRtl?Ie.a.Jaa:Ie.a.Kaa);td.a.instance.ra(Gd.a.click,this.de,this.Rj);this.Eze=Pd.KeyInputManager.instance.ds(this.de,this.Rj,Ec.a.Qh);Ib.appendChild(rc);Ib.appendChild(this.de);return Ib};ba.ka=function(Ib,rc){var Ta=Ib.zb,Cb=document.getElementById(Ta+
Ie.a.rtd);Cb||(Cb=document.createElement("div"),Cb.id=Ib.zb+Ie.a.rtd,Cb.classList.add("LineageActivityPane"),Kd.a.rd(Ib)||document.getElementById(Ta+Ie.a.kR).appendChild(Cb));return Ib.da.za(365)||Ib.da.Ga(365,new ba(Cb,Ib,rc))};of.Object.defineProperties(ba.prototype,{isVisible:{configurable:!0,enumerable:!0,get:function(){return Object(he.a)(ba.prototype,this,"isVisible")},set:function(Ib){Object(he.a)(ba.prototype,this,"isVisible")!==Ib&&(Object(he.b)(ba.prototype,this,"isVisible",Ib),this.raiseEvent("LineageTaskPaneVisibilityChanged"))}},
fhc:{configurable:!0,enumerable:!0,get:function(){return this.xpd}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},Pg:{configurable:!0,enumerable:!0,get:function(){return 15}},Yd:{configurable:!0,enumerable:!0,get:function(){return rd.a.Cti}},Kk:{configurable:!0,enumerable:!0,get:function(){return id.a.dvh}},UM:{configurable:!0,enumerable:!0,get:function(){return df.a.instance.ga(1066)}},lo:{configurable:!0,enumerable:!0,get:function(){return 300}},isResizable:{configurable:!0,
enumerable:!0,get:function(){return!1}},hc:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},height:{configurable:!0,enumerable:!0,get:function(){return this.taskPaneManager.uO.offsetHeight}},titleText:{configurable:!0,enumerable:!0,get:function(){return df.a.instance.ga(1287)}},RF:{configurable:!0,enumerable:!0,get:function(){var Ib=this;return this.taskPaneManager.Rua(this.hc,this.titleText,this.lo,this.isResizable,function(){Ib.isVisible=!0;Ib.fFb?Ib.fFb():Wa.ULS.shipAssertTag(537155462,
0,!1,"OnLineagePaneOpened callback not set.")},function(){Ib.isVisible=!1},function(){Ib.isVisible=!0},function(){Ib.isVisible=!1},this.lo)}}});Object(nb.a)(ba,"LineageTaskPane",$c.a,[739,6,569,429]);var Df=sa.a;$k(bb,Df);bb.prototype.create=function(){var Ib=this,rc=Gc.GetServiceTaskFactory.create(this.$.da,203,this.la,this.hb),Ta=Gc.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb);uc.TaskExtensions.Aa(uc.TaskExtensions.ts(uc.TaskExtensions.Vd([rc,Ta],this.la),function(){return Ib.YC},
this.la),function(){Ib.pb(Ib.Xg)},this.la,3)};bb.prototype.dispose=function(){this.Xg=this.gi=this.$=null;Df.prototype.dispose.call(this)};bb.ka=function(Ib){Ib.da.Ga(364,new bb(Ib))};of.Object.defineProperties(bb.prototype,{YC:{configurable:!0,enumerable:!0,get:function(){var Ib=this;this.gi||(this.gi=uc.TaskExtensions.Aa(ld.a(this.$),function(rc){Ib.Xg=ba.ka(Ib.$,rc.result)},this.la,3));return this.gi}}});Object(nb.a)(bb,"LineageTaskPaneFactory",sa.a,[]);va.prototype.dispose=function(){this.LId();
this.$=null;Wa.ULS.sendTraceTag(537155459,0,50,"LineageTeachingCalloutTriggerManager is disposed.")};va.prototype.disable=function(){va.sxb||(va.sxb=!0,Wa.ULS.sendTraceTag(578557781,0,50,"LineageTeachingCalloutTriggerManager.Disable as the pane was opened."));this.LId()};va.prototype.CXj=function(){var Ib=this;mb.EwaSettings.ma(607)&&!this.$.isAnonymousUser()&&Ja.i(this.$.oa.va,function(rc){Ib.$?(rc=rc.Result,Wa.ULS.sendTraceTag(578557780,0,50,"CheckLineageWywaChanges service call succeeded, hasnewchanges = "+
rc+"."),va.J6e=!0,rc&&Ib.jag(0)):Wa.ULS.sendTraceTag(537155458,0,50,"LineageTeachingCalloutTriggerManager.VerifyWaterlineTrigger ignoring server response as class is disposed.")},function(){Wa.ULS.sendTraceTag(537155457,0,10,"CheckLineageWywaChanges service call failed.")},null,null)};va.prototype.wXj=function(){mb.EwaSettings.ma(606)&&!this.uag()&&(this.$.ea.Bu(this.Sf),this.$pd=!0)};va.prototype.uag=function(){return this.$.ea&&this.$.ea.io&&this.$.ea.io.ShouldTriggerLineageCalloutOnMerge?(Wa.ULS.sendTraceTag(578557778,
0,50,"LineageTeachingCalloutTriggerManager.TriggerLineageCalloutOnMerge"),this.jag(1),!0):!1};va.prototype.jag=function(Ib){if(va.sxb)Wa.ULS.sendTraceTag(537155456,0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout Will not trigger dialog as it was already shown in session");else if(va.sxb=!0,Wa.ULS.sendTraceTag(578557776,0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout triggering callout due to reason "+Ib+"."),this.LId(),mb.EwaSettings.ma(482)){Ib=new Ob.a(-847286761,Oe.a.Cb,this.$.Jc,
0,Ie.a.tW);var rc={};rc=(rc.CalloutName=4,rc);this.$.Ka.Kb(Ib,rc)}};va.prototype.LId=function(){this.$pd&&(this.$pd=!1,this.$.ea.Ew(this.Sf))};va.sxb=!1;va.J6e=!1;Object(nb.a)(va,"LineageTeachingCalloutTriggerManager",null,[738,6]);var mc=sa.a;$k(ya,mc);ya.prototype.create=function(){var Ib=this;uc.TaskExtensions.Aa(Gc.GetServiceTaskFactory.Ra(this.$.da,458,459,this.hb),function(rc){var Ta=rc.result;rc=Object(we.b)(Ib.$.da,403,function(){return new va(Ib.$,Ta)});Ib.pb(rc)},this.$.la,3)};ya.ka=function(Ib){Ib.da.Ga(402,
new ya(Ib))};Object(nb.a)(ya,"LineageTeachingCalloutTriggerManagerFactory",sa.a,[]);var sc=sa.a;$k(ha,sc);ha.prototype.create=function(){var Ib=this;uc.TaskExtensions.Aa(Gc.GetServiceTaskFactory.Ra(this.$.da,366,367,0),function(rc){Ib.pb(rc.result)},this.$.la,3)};ha.ka=function(Ib){Ib.da.Ga(500,new ha(Ib))};Object(nb.a)(ha,"LineageBlueDotManagerFactory",sa.a,[]);var hd=b(1094),cd=b(77);Z.prototype.ZW=function(Ib,rc,Ta,Cb){var jc=this;return this.yih(Ib,void 0===Cb?null:Cb,function(tc){return jc.Qg.unb(tc,
2,Ta,rc,void 0,void 0,void 0,void 0,void 0,"2")})};Z.prototype.yih=function(Ib,rc,Ta){var Cb=this,jc=!!rc&&""!==rc,tc=Ib;jc&&(tc=hb.a.BT(Ib,"perfTag",rc));var kd=new Date;return hd.a.then(Ta(tc),function(Rd){var pe=+new Date-+kd;if(!Rd||!Rd.Eg||!Rd.Eg.data)return Rd;jc&&Rd.Eg.data.request&&Cb.xoj(Rd.Eg.data.request.getResolvedUrl(),rc,pe);return Rd})};Z.prototype.xoj=function(Ib,rc,Ta){Ib=this.xu.iXh(Ib);if(Ib.count&&(Ib=cd.last(Ib))){var Cb={Message:"Request durations for activities calls."};Cb.PerfTag=
rc;Cb.CustomDuration=Ta;Cb.PerformanceDuration=Ib.duration;Wa.ULS.sendTraceTag(592189641,3012,50,JSON.stringify(Cb))}};Object(nb.a)(Z,"CatchUpNetworkingWrapper",null,[119]);var Ed=b(254),ge=Ed.a;$k(xa,ge);xa.prototype.Raa=function(){return 6};Object(nb.a)(xa,"GetActivityFeedRequest",Ed.a,[]);var Nd=Ed.a;$k(da,Nd);da.prototype.Raa=function(){return 7};Object(nb.a)(da,"UpdateActivityFeedStateRequest",Ed.a,[]);var Ld=b(416);ia.prototype.getActivityFeed=function(Ib){var rc=this;return hd.a.then(this.WCa.execute(new xa(this.FCa(),
null),function(Ta,Cb,jc){return rc.Obe.ZW(Ta,Cb,jc,"ActivityFeed")},Ib),function(Ta){if(!Ta)return Wa.ULS.sendTraceTag(572846937,3012,10,"GetActivityFeed: Response is null"),null;if(!Ta.Eg)return Wa.ULS.sendTraceTag(572846938,3012,10,"GetActivityFeed: Response.Args is null"),null;if(!Ta.Eg.data)return Wa.ULS.sendTraceTag(572846939,3012,10,"GetActivityFeed: Response.Args.Data is null"),null;if(!Ta.Eg.data.Rd)return Wa.ULS.sendTraceTag(572846940,3012,10,"GetActivityFeed: Response.Args.Data.ResponseData is null"),
null;Ta=Ld.a.sIa(Ta.Eg.data.Rd);return Ta?Ta:(Wa.ULS.sendTraceTag(572846941,3012,10,"GetActivityFeed: Deserialized response is null"),null)})};ia.prototype.CRj=function(Ib,rc,Ta,Cb){var jc=this;return hd.a.then(this.WCa.execute(new da(this.FCa(),null,Ib,rc,Ta,Cb),function(tc,kd,Rd){return jc.Obe.ZW(tc,kd,Rd,"UpdateActivityFeedState")},null),function(tc){try{return tc.succeeded}catch(kd){return Wa.ULS.sendTraceTag(523121054,3012,10,"UpdateActivityFeed: Exception: "+kd.message),!1}})};Object(nb.a)(ia,
"CatchUpRequestHandler",null,[118]);var De=b(526);ea.prototype.mvi=function(){this.Zvi()};ea.prototype.Zvi=function(){var Ib=this;this.pga?this.pga.execute(function(rc){window.setTimeout(function(){Ib.Dae.contains("CatchUpChangesFeedback")||(Ib.Dae.add("CatchUpChangesFeedback"),rc.logActivity("CatchUpChangesFeedback",null))},2E4)}):Wa.ULS.sendTraceTag(571586199,383,15,"FloodgateEventLogger: IFuture<ISystemInitiatedFeedback> was null")};Object(nb.a)(ea,"FloodgateEventLogger",null,[]);var ke=b(192);
of.Object.defineProperties(P.prototype,{duration:{configurable:!0,enumerable:!0,get:function(){return this.Pug.duration}}});Object(nb.a)(P,"PerformanceResourceTimingWrapper",null,[]);X.prototype.iXh=function(Ib){var rc=new ke.a;if(!this.xu)return rc;Ib=this.xu.getEntriesByName(Ib,"resource");if(!Ib)return rc;Ib=ik(Ib);for(var Ta=Ib.next();!Ta.done;Ta=Ib.next())rc.add(new P(Ta.value));return rc};Object(nb.a)(X,"PerformanceWrapper",null,[]);var db=b(258);U.prototype.Sh=function(Ib){var rc=this;this.fb=
Ib;this.fb.register(Z,"Common.App.CatchUpActivity.CatchUpNetworkingWrapper").as("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper").tc().Dc(function(){return new Z(Na.AFrameworkApplication.nd,new X(window.performance))});this.fb.register(ia,"Common.App.CatchUpActivity.CatchUpRequestHandler").as("Common.App.CatchUpActivity.ICatchUpRequestHandler").tc().Dc(function(){return new ia(rc.fb.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper"),function(){return Na.AFrameworkApplication.Yi},
new Ld.a)});this.fb.register(ea,"Common.App.CatchUpActivity.FloodgateEventLogger").tc().Dc(function(){return new ea(rc.fb.Tb("Common.ISystemInitiatedFeedback"))})};U.prototype.init=function(){this.fb.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper");this.fb.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler")};U.prototype.dispose=function(){};U.main=function(){db.a.instance.Qi(new U)};of.Object.defineProperties(U.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.CatchUpActivity"}}});
Object(nb.a)(U,"CatchUpActivityPackage",null,[10,11]);Q.prototype.Nc=function(Ib,rc){return this.catchUpActivityManager?-876699925===rc?!this.catchUpActivityManager.Tbf:!1:!0};Q.prototype.executeCommand=function(Ib,rc){Ib=!1;switch(rc.command){case -876699925:Ib=this.catchUpActivityManager.BUi()}return Ib?ob.Task.Ua(!0):Nc.a(rc.command)};Q.prototype.Ac=function(Ib,rc){return mb.EwaSettings.ma(437)&&-876699925===rc.command?!0:!1};Q.prototype.Tc=function(){return!1};Object(nb.a)(Q,"CatchUpActivityCommandHandler",
null,[401]);var Qb=Xb.a;$k(B,Qb);B.prototype.zd=function(){var Ib=this;this.$.da.Za(286,function(rc){Ib.jd([new Q(Ib.$,rc)])})};B.ka=function(Ib){Xb.a.Pd(285,new B(Ib))};Object(nb.a)(B,"CatchUpActivityCommandHandlerFactory",Xb.a,[]);var Fc=b(278),Tc=b(575),zd=b(87),Wc=b(85),dd=b(25);O.prototype.doesContentExist=function(Ib){if(!Ib)return Wa.ULS.sendTraceTag(537168066,3012,10,"Null activity: DoesContentExist. Default to false."),!1;switch(Ib.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:if(!Ib.navigationId)return Wa.ULS.sendTraceTag(537168065,
3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1;var rc={};rc.NavigationId=atob(Ib.navigationId);return 32===this.oi.$d(dd.a.HIa,2,rc);default:return!1}};Object(nb.a)(O,"CatchUpActivityContentManager",null,[747]);var oe=b(1041),Fd=b(1449);L.prototype.dispose=function(){this.Tu.oQf(this.bFb);this.iz=null};L.prototype.esj=function(Ib){this.iz.push(Ib)};L.prototype.PZg=function(){this.iz.length=0};L.prototype.o4f=function(Ib){for(var rc=ik(this.iz),Ta=rc.next();!Ta.done;Ta=
rc.next())Ta=Ta.value,Ta.className=oe.a.DWg,Ta=document.getElementById(Ta.id+"-"+Ie.a.ixe),md.DOMElementExtensions.setVisible(Ta,Ib)};L.prototype.uMb=function(Ib){for(var rc=ik(this.iz),Ta=rc.next();!Ta.done;Ta=rc.next())if(Ta=Ta.value)Ib?Ta.className=2===this.Tu.model.state?oe.a.L5i:oe.a.M5i:this.o4f(!1)};of.Object.defineProperties(L.prototype,{Tu:{configurable:!0,enumerable:!0,get:function(){return this.Vqg}}});Object(nb.a)(L,"RangeCatchUpActivityView",null,[817,6]);var We=b(22),zf=Fd.a;$k(K,zf);
K.prototype.dispose=function(){this.gridView=null;zf.prototype.dispose.call(this)};K.prototype.MEg=function(Ib){var rc=this.Ufb[0];rc?rc.esj(Ib):Wa.ULS.shipAssertTag(537168004,0,!1,"RangeCatchUpActivityHighlightController.AddViewElement - RangeCatchUpActivityView is null for activityId"+this.Ima.activityId)};K.prototype.Ohj=function(){var Ib=this.Ufb[0];Ib&&Ib.PZg()};K.prototype.WCg=function(Ib){this.Ima.addRange(Ib)};K.prototype.hMh=function(){if(3!==this.Ima.activityType)return null;Wa.ULS.shipAssertTag(537168003,
0,1===this.Ima.RMb.length,"RangeCatchUpActivityHighlightController::GetCommentActivityRange Range Information Length should be 1.");return Fa.D(this.Ima.RMb[0])};K.prototype.xKb=function(Ib){if(Ib){if(!this.Ima)return;this.rxd(this.Xij())}zf.prototype.xKb.call(this,Ib)};K.prototype.C4c=function(){var Ib=this.i4c();this.Ufb.push(Ib)};K.prototype.i4c=function(){return new L(this)};K.prototype.rxd=function(Ib){Ib?Ib.SheetName?(this.gridView.ha.Oa.NG(null),this.gridView.focus(),this.gridView.J4e(Ib,3,
!1,Uc.a.K5i)):Wa.ULS.shipAssertTag(537168E3,0,!1,"RangeCatchUpActivityHighlightController.NavigateToRange: SheetName in the range is null."):Wa.ULS.shipAssertTag(537168001,0,!1,"RangeCatchUpActivityHighlightController.NavigateToRange: Range is null. Either the location list is empty or sheet is hidden.")};K.prototype.Xij=function(){if(pc.e(this.Ima.RMb))return Wa.ULS.shipAssertTag(537167971,0,!1,"RangeCatchUpActivityHighlightController.RetrieveRangeInformationForNavigation : SortedRanges is either null or empty."),
null;var Ib=this.$.xa.pa;Wa.ULS.shipAssertTag(537167970,0,!!Ib,"RangeCatchUpActivityHighlightController.RetrieveRangeInformationForNavigation : currentSheet is null.");Ib=this.xOj(Ib.sheetName,this.Ima.RMb);if(!Ib&&(Ib=this.U0h(this.Ima.RMb),!Ib))return null;var rc={};rc.SheetName=Ib.SheetName;rc.FirstColumn=Ib.FirstColumn;rc.FirstRow=Ib.FirstRow;rc.LastColumn=Ib.FirstColumn;rc.LastRow=Ib.FirstRow;return rc};K.prototype.U0h=function(Ib){if(pc.e(Ib))return null;for(var rc=null,Ta=0;Ta<Ib.length;Ta++){var Cb=
Ib[Ta].SheetName;if(!We.a.equals(Cb,rc,!1)&&(rc=Cb,Cb=this.$.xa.getItemByName(Cb),null===Cb||void 0===Cb?0:Cb.visible))return Ib[Ta]}return null};K.prototype.xOj=function(Ib,rc){if(rc){rc=ik(rc);for(var Ta=rc.next();!Ta.done;Ta=rc.next())if(Ta=Ta.value,We.a.equals(Ta.SheetName,Ib,!1))return Ta}return null};Object(nb.a)(K,"RangeCatchUpActivityHighlightController",Fd.a,[]);var Cf=b(79),pf=Cf.a;$k(I,pf);I.prototype.dispose=function(){this.y1d=null;pf.prototype.dispose.call(this)};of.Object.defineProperties(I.prototype,
{type:{configurable:!0,enumerable:!0,get:function(){return this.WB}},activityId:{configurable:!0,enumerable:!0,get:function(){return this.y1d}},activityType:{configurable:!0,enumerable:!0,get:function(){return this.blg}}});Object(nb.a)(I,"CatchUpActivityHighlightModelBase",Cf.a,[]);$k(G,I);G.prototype.addRange=function(Ib){Ib=ik(Ib);for(var rc=Ib.next();!rc.done;rc=Ib.next())this.ranges.push(rc.value)};G.prototype.dispose=function(){this.ranges=null;I.prototype.dispose.call(this)};G.F3b=function(Ib,
rc){if(!Ib.SheetName||!rc.SheetName)return Wa.ULS.shipAssertTag(537167969,0,!1,"RangeCatchUpActivityHighlightModel.CompareSharedSheetRange : SheetName is null."),0;var Ta=Ib.SheetName.localeCompare(rc.SheetName);return Ta?Ta:Ib.FirstColumn<rc.FirstColumn||Ib.FirstColumn===rc.FirstColumn&&Ib.FirstRow<rc.FirstRow?-1:Ib.FirstColumn===rc.FirstColumn&&Ib.FirstRow===rc.FirstRow?0:1};of.Object.defineProperties(G.prototype,{RMb:{configurable:!0,enumerable:!0,get:function(){this.r7a||(this.ranges.sort(G.F3b),
this.r7a=!0);return this.ranges}}});Object(nb.a)(G,"RangeCatchUpActivityHighlightModel",I,[]);var Hf=b(359);T.prototype.dispose=function(){this.Eke=this.OLb=this.$1c=null};T.prototype.Sej=function(Ib){sd.g(Ib).qb.sn([24])};T.prototype.T6g=function(Ib,rc,Ta){var Cb={};rc=ik(rc);for(var jc=rc.next();!jc.done;jc=rc.next())if((jc=jc.value)&&!pc.e(jc.LocationList)){for(var tc=[],kd={},Rd=[],pe=ik(jc.LocationList),le=pe.next();!le.done;le=pe.next()){le=le.value;if(!le){Wa.ULS.shipAssertTag(537168013,0,
!1,"CatchUpActivityHighlightManagerHelper.CreateControllersAndHighlights - Location is Null for activityId : "+jc.Id);break}switch(le.Type){case 0:var Wd=le;"0"in kd?(le=kd["0"],le.WCg(Wd.RangeList)):(le=new K(Ib,new G(Ib,jc.Id,jc.Type,0,Wd.RangeList),Ta),tc.push(le),kd["0"]=le);Wd=ik(Wd.RangeList);for(var ve=Wd.next();!ve.done;ve=Wd.next()){ve=ve.value;ve=new Hf.a(Fa.D(ve),bf.d(Ib.xa.getItemByName(ve.SheetName)));if(this.Xwc(ve)in this.OLb)this.OLb[this.Xwc(ve)].push(le);else{var Se=[];Se.push(le);
this.OLb[this.Xwc(ve)]=Se}Rd.push(ve);this.$1c.push(ve)}break;default:Wa.ULS.sendTraceTag(537168012,0,10,"CatchUpHighlightControllersCreator.CreateControllersAndHighlights(): Failed.Invalid ActivityLocationType")}}Wa.ULS.shipAssertTag(537168011,0,!(jc.Id in Cb),"CatchUpHighlightControllersCreator.CreateAndUpdateControllers - highlightControllers already has activity: "+jc.Id);this.Eke[jc.Id]=Rd;Cb[jc.Id]=tc}this.o8g(Ib,this.$1c,this.OLb);return Cb};T.prototype.HZg=function(Ib){for(var rc in Ib)for(var Ta=
ik(Ib[rc]),Cb=Ta.next();!Cb.done;Cb=Ta.next())Cb.value.Ohj()};T.prototype.Xwc=function(Ib){return Ib.range+"-"+Ib.sheetId};T.prototype.o8g=function(Ib,rc,Ta){var Cb=this;this.HZg(Ta);sd.g(Ib).qb.Iw(rc,[24],!0,function(jc,tc){var kd=new Hf.a(jc.range,jc.sheetId);kd=Cb.Xwc(kd);var Rd=Ta[kd];if(Rd)for(kd=ik(Rd),Rd=kd.next();!Rd.done;Rd=kd.next())Rd=Rd.value,Rd.MEg(tc),jc.metadata=Rd;else Wa.ULS.shipAssertTag(537168010,0,!1,"CatchUpHighlightControllersCreator.CreateHighlightsAndUpdateControllers(), Missing Controller for SheetRangeKey "+
kd)})};Object(nb.a)(T,"CatchUpHighlightControllersCreator",null,[]);Object(nb.a)(N,"CreateIndicatorTooltipParameters",null,[]);Object(nb.a)(S,"DismissIndicatorTooltipParameters",null,[]);Object(nb.a)(J,"UpdateIndicatorTooltipParameters",null,[]);F.prototype.dispose=function(){this.ha.Nsc(this.Il);this.ha.zF(this.Rc);this.gridView.yF(this.ap);this.Ya.vk(this.Fh);this.zHe();this.cbd=this.cka=this.oec=this.iRa=this.Ya=this.ha=this.gridView=null};F.prototype.Lpj=function(Ib){this.zHe();if(!pc.e(Ib)){Wa.ULS.sendTraceTag(537168035,
0,50,"In CatchUpActivityHighlightManager:ProcessActivityPayloadHighlights().");if(this.J4=this.p4b.T6g(this.$,Ib,this)){Ib=this.J4;for(var rc in Ib)for(var Ta=ik(Ib[rc]),Cb=Ta.next();!Cb.done;Cb=Ta.next())this.jNg(Cb.value)}this.p4b.Sej(this.$)}};F.prototype.Zxc=function(Ib){if(Ib&&this.Ujd)Wa.ULS.shipAssertTag(537168034,0,!1,"CatchUpActivityHighlightManager.ShowOrHideAllHighlights - Trying to show all highlights when marked as read");else if(Ib||this.Bsb(),this.J4){var rc=this.J4,Ta;for(Ta in rc)for(var Cb=
ik(rc[Ta]),jc=Cb.next();!jc.done;jc=Cb.next())jc.value.fCj(Ib)}};F.prototype.Z7h=function(Ib){this.cka&&this.$6b(!0);this.f6c();if(Ib=this.J4[Ib.activityId]){Ib=ik(Ib);for(var rc=Ib.next();!rc.done;rc=Ib.next())rc.value.xKb(!0)}else Wa.ULS.sendTraceTag(537168032,0,50,"CatchUpActivityHighlightManager.OnSelectHighlight - Controllers not found during select")};F.prototype.zHe=function(){if(this.J4){var Ib=this.J4,rc;for(rc in Ib)for(var Ta=ik(Ib[rc]),Cb=Ta.next();!Cb.done;Cb=Ta.next())Cb=Cb.value,this.Maj(Cb),
Cb.dispose()}this.J4={};this.p4b.dispose();this.p4b=null};F.prototype.KAj=function(){if(this.excelCommentManager){var Ib=this.J4[this.iRa];Ib&&0<Ib.length&&3===Ib[0].model.activityType&&((Ib=Ib[0])?this.excelCommentManager.mBj(Ib.hMh()):Wa.ULS.shipAssertTag(537168029,0,!1,"RangeCatchUpActivityHighlightController::ShowCommentFlyoutOnSelectedActivity RangeController is Null."))}};F.prototype.o7h=function(){this.excelCommentManager&&this.excelCommentManager.vtb()};F.prototype.f6c=function(){if(this.iRa){var Ib=
this.J4[this.iRa];if(Ib){Ib=ik(Ib);for(var rc=Ib.next();!rc.done;rc=Ib.next())rc.value.xKb(!1);this.iRa=null}else Wa.ULS.sendTraceTag(537168028,0,50,"CatchUpActivityHighlightManager.DeselectCurrentlySelected - Controllers not found for deselection")}};F.prototype.Bsb=function(){this.f6c();this.$6b(!0)};F.prototype.MOj=function(Ib){if(!Ib)return Wa.ULS.shipAssertTag(537168026,0,!1,"CatchUpActivityHighlightManager::TryGetFlyoutContainer HighlightDot is null."),null;Ib=Ib.id+"-"+Ie.a.BWg;var rc=this.cbd[Ib];
if(!rc){if(!this.gridView.domElement)return Wa.ULS.shipAssertTag(537168025,0,!1,"CatchUpActivityHighlightManager::TryGetFlyoutContainer gridView.DOMElement is null."),null;rc=document.createElement("Div");rc.className=oe.a.CWg;rc.id=Ib;this.gridView.domElement.appendChild(rc);this.cbd[Ib]=rc}return rc};F.prototype.$6b=function(Ib){this.$ea&&(this.$ea.dismissActivityIndicatorTooltips(Object(zb.a)(new S,{clearSticky:Ib})),this.oec=null,Ib&&(this.cka=null),this.Lgc&&!this.cka&&(this.gridView.view.Gq(this.xBc),
this.gridView.ny(this.xBc),this.Lgc=!1))};F.prototype.jNg=function(Ib){Ib.Zme(this.bFb);Ib.oFg(this.p3f);Ib.nFg(this.rIe)};F.prototype.Maj=function(Ib){Ib.oQf(this.bFb);Ib.Tbj(this.p3f);Ib.Sbj(this.rIe)};of.Object.defineProperties(F.prototype,{aBg:{configurable:!0,enumerable:!0,get:function(){return this.$ea},set:function(Ib){this.$ea=Ib}},excelCommentManager:{configurable:!0,enumerable:!0,get:function(){this.tDa||(this.tDa=this.$.da.za(65));return this.tDa}},p4b:{configurable:!0,enumerable:!0,get:function(){this.q4b||
(this.q4b=new T);return this.q4b},set:function(Ib){this.q4b=Ib}}});Object(nb.a)(F,"CatchUpActivityHighlightManager",null,[775,6]);H.prototype.navigateToActivity=function(Ib){if(Ib.fromSummaryString){var rc=new Ob.a(1834994092,Oe.a.Cb,this.$.Jc,18,null);this.$.Ka.Kb(rc);return this.pUa(1)}Ib=Ib.activity;if(!this.sfi(Ib))return this.pUa(4);if(!this.voi(Ib))return this.pUa(7);var Ta={};try{rc=window.self.atob(Ib.navigationId);if(!rc)return this.pUa(5);Ta.NavigationId=rc}catch(Cb){return Wa.ULS.sendTraceTag(537168023,
3012,10,"Exception thrown when trying to decode activity NavigationID: "+Cb),this.pUa(5)}if(8===this.oi.$d(dd.a.HIa,2,Ta))return this.oi.processAction(dd.a.p9a,2),this.pUa(2);rc=32===this.oi.$d(dd.a.r0a,2,Ta)?1:6;return this.pUa(rc)};H.prototype.sfi=function(Ib){return Ib&&Ib.navigationId?!0:!1};H.prototype.voi=function(Ib){switch(Ib.type){case 3:case 4:case 6:case 7:case 9:case 8:return!0;default:return!1}};H.prototype.pUa=function(Ib){return Promise.resolve(Ib)};Object(nb.a)(H,"CatchUpActivityNavigationManager",
null,[748]);var Qa=b(484);Object(nb.a)(D,"GetRelevantActivitiesDataRequest",null,[]);Object(nb.a)(w,"Activity",null,[]);Object(nb.a)(y,"ActivityFeedItem",null,[]);Object(nb.a)(z,"ActivityFeedPayload",null,[]);Object(nb.a)(A,"ActivityRequestPayload",null,[]);Object(nb.a)(u,"Person",null,[]);$k(l,w);Object(nb.a)(l,"TaskActivity",w,[]);v.prototype.requestWYWAActivities=function(){var Ib=this;return this.F6a?new Promise(function(rc,Ta){x(Ib.$.oa.va,function(Cb){var jc,tc=Xc.a(Cb)?null:Cb.Result;mb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BlueDot",
!1)?(Cb=null===(jc=null===tc||void 0===tc?void 0:tc.WywaAuthors)||void 0===jc?void 0:jc.length,null!=Cb&&0<Cb&&uc.TaskExtensions.Aa(Gc.GetServiceTaskFactory.Ra(Ib.$.da,501,500,0),function(kd){kd.result.GBj().then(function(Rd){var pe=Rd.map(function(le){return{activityId:le.activityGuid,activityFeedItemId:null,type:1,actors:[{id:le.author.id,provider:le.author.provider,displayName:le.author.displayName,givenName:null,email:le.author.email,imageUrl:le.author.imageUrl,color:null}],location:null,displayTimestamp:le.displayTimestamp,
relevancy:null,navigationId:null,state:0,collectionId:null}});Rd=Rd.map(function(le){var Wd=le.rangeHighlightLocation.rangeList.map(function(ve){return{Type:0,RangeList:[{SheetName:le.sheetName,FirstRow:ve.firstRow,LastRow:ve.lastRow,FirstColumn:ve.firstCol,LastColumn:ve.lastCol}]}});return{Id:le.activityGuid,Type:null,Person:null,DisplayTimestamp:null,LocationList:Wd}});Ib.qfg=Rd;pe={activities:pe,actors:tc?Ib.gcc(tc.WywaAuthors):null,hasMore:!1,highWaterline:v.nia,lowWaterline:v.nia,wywaWaterline:v.nia};
rc(pe)},function(){})},Ib.$.la,3)):(jc=Object(zb.a)(new A,{activities:[],actors:tc?Ib.gcc(tc.WywaAuthors):null,hasMore:!1,highWaterline:v.nia,lowWaterline:v.nia,wywaWaterline:v.nia}),rc(jc))},function(){Wa.ULS.sendTraceTag(537168022,0,10,"CatchUpActivityRequestManager::GetLineageWywaAuthors service call failed.");Ta(null)},null,null)}):Promise.resolve(v.s6b)};v.prototype.requestActivities=function(){return Promise.resolve(v.s6b)};v.prototype.requestRelevantActivities=function(){var Ib=this;if(!this.$.ea.dc||
this.$.ea.i5a)return Wa.ULS.sendTraceTag(537168021,3012,15,"CatchUpActivityRequestManager.RequestRelevantActivities: RequestRelevantActivities skipped [IsSessionActive: "+this.$.ea.dc+", HasRaisedSessionEnded: "+this.$.ea.i5a+"]"),Promise.resolve(v.s6b);var rc=Object(zb.a)(new D,{SetDaysBack:Na.AFrameworkApplication.fa.kd("AppWaterlineOverrideDaysValue",0),SetTimestamp:Na.AFrameworkApplication.fa.kd("AppWaterlineOverrideTimestampValue",0)});return new Promise(function(Ta,Cb){m(Ib.$.oa.va,rc,function(jc){var tc=
v.s6b;jc?Xc.a(jc)?Wa.ULS.sendTraceTag(578353159,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call returned errors codes: "+nc.a.Cc(jc.Errors)):tc=Ib.OWh(jc.Result):Wa.ULS.sendTraceTag(537168020,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call returned Null result.");Ta(tc)},function(jc){jc=Tb.a.xf(jc.data);Wa.ULS.sendTraceTag(537168019,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call has failed - Errors: ["+nc.a.Cc(jc)+"]");Cb(null)},
null,null)})};v.prototype.requestActivityFeed=function(){var Ib=this;return bc.b(this.getActivityFeed()).then(function(rc){return Object(zb.a)(new z,{activityFeedItems:Ib.jNj(rc)})})};v.prototype.updateActivityState=function(Ib){return mb.EwaSettings.ma(453)?Promise.resolve(!0):this.h2b?bc.b(this.h2b).then(function(rc){var Ta,Cb;return bc.b(rc.CRj(Ib.itemIds,null!==(Ta=Ib.activityStatesToSet)&&void 0!==Ta?Ta:0,null!==(Cb=Ib.activityStatesToReset)&&void 0!==Cb?Cb:0,Ib.resetUnseenCount))}):Promise.resolve(!1)};
v.prototype.getActivityFeed=function(){return this.h2b?hd.a.HVd(this.h2b,function(Ib){return Ib.getActivityFeed(null)}):ob.Task.Ua([])};v.prototype.OWh=function(Ib){if(!Ib)return Wa.ULS.sendTraceTag(537168018,3012,10,"CatchUpActivityRequestManager::GetRelevantActivityRequestPayload response is null."),Object(zb.a)(new A,{activities:[]});var rc=this.dag(Ib.NewActivities,2);Ib=this.dag(Ib.OutstandingActivities,3);Ib=ik(Ib);for(var Ta=Ib.next();!Ta.done;Ta=Ib.next())rc.push(Ta.value);return Object(zb.a)(new A,
{activities:rc})};v.prototype.dag=function(Ib,rc){rc=void 0===rc?1:rc;var Ta=[];if(!Ib||!Ib.length)return Ta;Ib=ik(Ib);for(var Cb=Ib.next();!Cb.done;Cb=Ib.next())if(Cb=Cb.value){var jc=v.qNj(Cb.Type);6===jc||7===jc||9===jc||8===jc?Ta.push(Object(zb.a)(new l,{activityId:Cb.Id,type:jc,displayTimestamp:new Date(Cb.DisplayTimestamp),navigationId:Cb.NavigationId,actors:this.gcc(Cb.People),relevancy:rc,relationship:this.pNj(Cb.Relationship)})):Ta.push(Object(zb.a)(new w,{activityId:Cb.Id,type:jc,displayTimestamp:new Date(Cb.DisplayTimestamp),
navigationId:Cb.NavigationId,actors:this.gcc(Cb.People),relevancy:rc}))}else Wa.ULS.shipAssertTag(537168017,3012,!1,"CatchUpActivityRequestManager.TranslateRelevantActivitiesToActivities: relevantActivity is null");return Ta};v.prototype.pNj=function(Ib){switch(Ib){case 1:return 1;case 2:return 2;case 3:return 3}Wa.ULS.sendTraceTag(537168016,0,10,"Unexpected Relationship.");return 1};v.prototype.jNj=function(Ib){var rc=[];Ib=ik(Ib);for(var Ta=Ib.next();!Ta.done;Ta=Ib.next())Ta=Ta.value,Ta=Object(zb.a)(new y,
{id:Ta.id,type:Ta.type,collectionId:Ta.collectionId,activityState:Ta.activityState,activityFeedItemPayload:Ta.activityFeedItemPayload,timestamp:Ta.timestamp}),rc.push(Ta);return rc};v.prototype.gcc=function(Ib){var rc=[];if(!Ib||!Ib.length)return rc;Ib=ik(Ib);for(var Ta=Ib.next();!Ta.done;Ta=Ib.next())(Ta=Ta.value)&&rc.push(this.kwb(Ta));return rc};v.prototype.kwb=function(Ib){return Object(zb.a)(new u,{id:Ib.Id,provider:Ib.Provider,displayName:Ib.DisplayName,email:Ib.Email,imageUrl:this.Xqc.WHa(Ib.Email,
Ib.Provider,Na.AFrameworkApplication.Yi,0),color:this.CGb.hhd(new Qa.a(null,void 0,Ib.DisplayName),6)})};v.qNj=function(Ib){switch(Ib){case 1:return 3;case 2:return 4;case 3:return 6;case 4:return 7;case 6:return 8;case 5:return 9;case 7:return 10;default:return Wa.ULS.shipAssertTag(537168015,3012,!1,"CatchUpActivityRequestManager.TranslateRelevantActivityTypeToActivityType: unknown RelevantActivityType"),1}};v.nia="<WywaWaterline>DefaultWaterline</WywaWaterline>";v.s6b=Object(zb.a)(new A,{activities:[],
actors:[],hasMore:!1,highWaterline:v.nia,lowWaterline:v.nia,wywaWaterline:v.nia});Object(nb.a)(v,"CatchUpActivityRequestManager",null,[749]);f.prototype.shouldShowEmptyExperienceButton=function(){if(!this.$.ea.l8a)return!1;if(!mb.EwaSettings.isChangeGateEnabled("OfficeVSO:5892442_CatchupEmptyExperienceNewContract")){var Ib=this.$.da.za(365);return!Ib||!Ib.isVisible}return!0};f.prototype.onButtonClick=function(){var Ib={};Ib=(Ib.InputMethod=Oe.a.Cb,Ib);this.$.Ka.Kb(new Ob.a(1834994092,Oe.a.Cb,this.$.Jc,
16,null),Ib)};f.prototype.getExplanationText=function(){var Ib=this.$.da.za(365);return df.a.instance.Xa(Ib&&Ib.isVisible?648:647)};f.prototype.getCommandName=function(){return df.a.instance.ga(446)};Object(nb.a)(f,"CatchUpEmptyExperienceBehaviorManager",null,[750]);k.prototype.dispose=function(){Jc.a(this.$).Dz(this)};k.prototype.Uf=function(Ib,rc){if(rc)return!1;Ib=document.getElementById("flyoutItem0");if(!Ib)return Wa.ULS.sendTraceTag(537168009,3012,10,"Could not find firstItem in flyout when setting up focus"),
!1;Ib.focus();this.mhh(Ib);return!0};k.prototype.ah=function(Ib){return this.hc?md.DOMElementExtensions.nf(this.hc,Ib):!1};k.prototype.ej=function(){this.hasFocus=!0};k.prototype.Dj=function(){this.hasFocus=!1};k.prototype.mhh=function(Ib){if(Sys.Browser.agent===Sys.Browser.Firefox){var rc=document.createEvent("KeyboardEvent");rc.initKeyEvent(Gd.a.Lb,!0,!0,window.self,!1,!1,!1,!1,Ec.a.QCc,0);Ib.dispatchEvent(rc)}else rc=document.createEvent("Events"),rc.initEvent(Gd.a.Lb,!0,!0),rc.keyCode=Ec.a.QCc,
rc.which=Ec.a.QCc,Ib.dispatchEvent(rc)};of.Object.defineProperties(k.prototype,{hc:{configurable:!0,enumerable:!0,get:function(){return document.getElementById("catchUpFlyoutContainer")}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.flyoutRibbonButton.Hdf&&!this.hasFocus}},Yd:{configurable:!0,enumerable:!0,get:function(){return rd.a.y_c}}});Object(nb.a)(k,"FlyoutFocus",null,[429,6]);var Mb=b(399);h.prototype.dispose=function(){this.xjb=this.Azb=!1};h.prototype.registerButtonClickedEvent=
function(Ib){this.buttonClickedCallback&&Wa.ULS.sendTraceTag(537168008,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.buttonClickedCallback=Ib.buttonClickedCallback};h.prototype.onFlyoutInitialized=function(){this.Azb&&Wa.ULS.sendTraceTag(537168007,3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");var Ib=(new Date).getTime()-this.FDh.getTime();Wa.ULS.sendTraceTag(593601546,3012,50,"Time from retrieve activities to initialize Flyout: "+
Ib);Yb.c(dd.a.FWg,!0,Yb.e,0,0,Ib);this.Azb=!0;Mb.a.pA&&Mb.a.pA.updateCommandUI(!0)};h.prototype.logFlightTriggers=function(){};h.prototype.toggleCatchUpFlyout=function(){this.Azb?this.buttonClickedCallback?this.buttonClickedCallback():Wa.ULS.sendTraceTag(537168005,3012,10,"ToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."):Wa.ULS.sendTraceTag(537168006,3012,10,"ToggleCatchUpFlyout: User clicked the button before the flyout was initialized.")};h.prototype.onFlyoutVisibilityChanged=
function(Ib){this.xjb!==Ib.flyoutIsVisible&&(this.xjb=Ib.flyoutIsVisible,Mb.a.pA&&Mb.a.pA.updateCommandUI(!0),this.xjb||this.kUe&&this.kUe.mvi())};of.Object.defineProperties(h.prototype,{Hdf:{configurable:!0,enumerable:!0,get:function(){return this.xjb}}});Object(nb.a)(h,"FlyoutRibbonButton",null,[772]);var kc=b(579);Object(nb.a)(e,"CatchUpConfiguration",null,[]);Object(nb.a)(d,"SharedControllerFactoryParameters",null,[]);c.prototype.dispose=function(){this.aHa&&this.aHa.getWywaEvent().removeListener(this.TEf);
this.aHa=this.$=null;zd.a.Ia(this.I_a);this.flyoutRibbonButton=this.flyoutFocus=this.h3d=this.jxe=this.x_c=this.I_a=null};c.prototype.BUi=function(){this.flyoutRibbonButton.toggleCatchUpFlyout();return!0};c.prototype.Svi=function(){Wa.ULS.sendTraceTag(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");this.pbf()&&Wa.ULS.sendTraceTag(526718752,3012,50,"ActivityFeedData is enabled")};c.prototype.Tti=function(Ib,rc){n("ScriptDownload");uc.TaskExtensions.Aa(Gc.GetServiceTaskFactory.Ra(this.$.da,
283,284,rc),function(Ta){Ib(bc.c(Ta.result.vn.loadScript("catchUpActivity")))},this.$.da.la,3)};c.prototype.F6a=function(){return!!this.Pkf&&this.Pkf.F6a()&&this.$.ea.l8a};c.prototype.pbf=function(){return mb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)};c.prototype.mIi=function(Ib){var rc=this;uc.TaskExtensions.Aa(Ib,function(){Sc.a(function(){rc.aHa=catchUpActivity.FactoryGlobal.getExcelCatchUpAppInstance(Object(zb.a)(new d,{activityContentManager:Object(Wc.a)(747,
rc.h3d),activityNavigationManager:Object(Wc.a)(748,rc.jxe),activityRequestManager:Object(Wc.a)(749,rc.x_c),dataCulture:rc.$.ya.DataCultureTag,flyoutFocus:null,flyoutRibbonButton:Object(Wc.a)(h,rc.flyoutRibbonButton),uiCulture:rc.$.ya.UICultureTag,ulsLogger:new Ic.a,emptyCatchUpBehaviorManager:Object(Wc.a)(750,rc.emptyCatchUpBehaviorManager)}))});rc.I_a.aBg=rc.aHa.getActivityIndicatorTooltipManager();kc.a(rc.$);rc.aHa.getWywaEvent().addListener(rc.TEf);n("InitializeCatchUpApp");rc.aHa.initialize(Object(zb.a)(new e,
{featuredActivityGroupsEnabled:!1,summaryStringEnabled:rc.F6a(),includeRelevantAuthorsInSummaryString:!1,useCompactSummaryString:mb.EwaSettings.isChangeGateEnabled("OfficeVSO:5788078_useCompactStringOnExcel"),activityFeedDataEnabled:rc.pbf()}))},this.$.la,3)};of.Object.defineProperties(c.prototype,{Tbf:{configurable:!0,enumerable:!0,get:function(){var Ib=this.flyoutRibbonButton.Azb;Ib&&!this.H6e&&(Wa.ULS.sendTraceTag(588129368,3012,50,"Catch Up Flyout is ready and button is enabled."),this.H6e=!0);
return Ib}},Cgi:{configurable:!0,enumerable:!0,get:function(){return this.flyoutRibbonButton.Hdf}}});Object(nb.a)(c,"CatchUpActivityManager",null,[751,6]);var zc=sa.a;$k(a,zc);a.prototype.create=function(){var Ib=this;uc.TaskExtensions.Aa(Gc.GetServiceTaskFactory.Ra(this.$.da,458,459,this.hb),function(rc){var Ta=rc.result;rc=Object(we.a)(Ib.$.da,286,function(){return new c(Ib.$,Ib.hb,null,Ta)});Ib.pb(rc)},this.$.la,3)};a.ka=function(Ib){Ib.da.Ga(287,new a(Ib))};Object(nb.a)(a,"CatchUpActivityManagerFactory",
sa.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Lineage");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.VersionHistory");Type.registerNamespace("_Ewa");jb.a.Fa(Ab.ka);jb.a.Fa(Db.ka);jb.a.Fa(la.ka);jb.a.Fa(ca.ka);Le.a.ti('.LineageActivityPane{height:100%;display:flex;flex-direction:column;overflow:hidden;background-color:#edebe9}.LineageActivityPaneHeader{display:flex;flex-direction:row;position:relative;overflow:hidden;padding-right:16px;padding-left:16px;padding-top:16px;padding-bottom:11px;height:auto;background-color:#edebe9}.LineageActivityPaneTitle{max-width:240px;display:inline-flex;font-weight:bold;font-family:"Segoe UI Semi Bold","Segoe UI Web",Arial,Verdana,sans-serif;font-size:16px;line-height:16px;flex-grow:1;align-content:center;height:auto;text-overflow:ellipsis;overflow:hidden;background-color:#edebe9;margin:0}.LineageActivityCloseButton{display:inline-flex;align-self:center}.LineageActivityBody{height:100%;padding-left:16px;overflow:hidden;background-color:#edebe9}');
(function(){jb.a.Fa(function(Ib){bb.ka(Ib);fa.ka(Ib);La.ka(Ib);ya.ka(Ib);mb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BlueDot",!1)&&ha.ka(Ib);pb.ka(Ib)})})();Type.registerNamespace("Common.App.CatchUpActivity");U.main();(function(){jb.a.Fa(function(Ib){n("Begin");a.ka(Ib);B.ka(Ib)})})()}}]);

//# sourceMappingURL=EwaDS.catchup.js.map