(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[14],{1012:function(t,E,b){function a(){}b.d(E,"a",function(){return a});t=b(0);a.abs="Abs";a.rel="Rel";Object(t.a)(a,"PositionBaseType",null,[])},1026:function(t,E,b){function a(H){this.calcManager=H}function c(){return v.call(this)||this}function d(){this.secondRow=this.firstRow=null;return this}function e(){return v.call(this)||this}function h(){this.right=this.left=this.bottom=this.top=null;return this}function k(){return v.call(this)||
this}function n(){this.secondColumn=this.firstColumn=null;return this}function f(){var H=v.call(this)||this;H.Rhc=!1;return H}function v(){this.end=this.start=0;this.ev=null}function m(){this.column=this.row=null;return this}function x(){}b.r(E);t=b(0);var l=b(7),u=b(15);Object(t.a)(x,"Reference",null,[]);$k(m,x);Object(t.a)(m,"CellReference",x,[]);v.prototype.ILg=function(H,F){for(var J=0;J<this.ev.length;J++){var S=this.b0b(H,this.ev[J]);F+=S;J<this.ev.length-1&&(F+=":")}return F};Object(t.a)(v,
"IReferenceSequence",null,[]);var A=b(24),z=b(1012);$k(f,v);f.prototype.Wbc=function(){var H=b(1026).RelativeAndAbsoluteReferencesManager,F=this.ev[0];return H.gsf(F.row.kind===z.a.abs,F.column.kind===z.a.abs)};f.prototype.b0b=function(H,F){F=A.Range.Qc(F.row.index+1,F.column.index+1);return this.Rhc?F.jbc(1===H||3===H,1===H||2===H):F.z4a(1===H||3===H,1===H||2===H,!0,!0)};Object(t.a)(f,"CellReferenceSequence",v,[]);$k(n,x);Object(t.a)(n,"ColumnReference",x,[]);$k(k,v);k.prototype.Wbc=function(){var H=
this.ev[0];return b(1026).RelativeAndAbsoluteReferencesManager.Dqf(H.firstColumn,H.secondColumn).kind===z.a.abs?2:3};k.prototype.b0b=function(H,F){return A.Range.Mub(F.firstColumn.index+1,F.secondColumn.index+1).z4a(1===H||3===H,!0,1===H||3===H,!0)};Object(t.a)(k,"ColumnReferenceSequence",v,[]);$k(h,x);Object(t.a)(h,"RangeReference",x,[]);$k(e,v);e.prototype.Wbc=function(){var H=b(1026).RelativeAndAbsoluteReferencesManager,F=this.ev[0];return H.gsf(F.top.kind===z.a.abs,F.left.kind===z.a.abs)};e.prototype.b0b=
function(H,F){F=new A.Range(F.top.index+1,F.left.index+1,F.bottom.index+1,F.right.index+1,!1,!1);var J=1===H||3===H;H=1===H||2===H;return F.z4a(J,H,J,H)};Object(t.a)(e,"RangeReferenceSequence",v,[]);$k(d,x);Object(t.a)(d,"RowReference",x,[]);$k(c,v);c.prototype.Wbc=function(){var H=this.ev[0];return b(1026).RelativeAndAbsoluteReferencesManager.Dqf(H.firstRow,H.secondRow).kind===z.a.abs?0:1};c.prototype.b0b=function(H,F){return A.Range.U$b(F.firstRow.index+1,F.secondRow.index+1).z4a(!0,1===H||2===
H,!0,1===H||2===H)};Object(t.a)(c,"RowReferenceSequence",v,[]);var y=b(1197),w=b(1198),D=b(211);b.d(E,"RelativeAndAbsoluteReferencesManager",function(){return a});a.prototype.k1a=function(H,F,J){var S=F;var N=J;if(!H||!D.f(H))return{returnValue:H,Pxd:S,Oxd:N};var T=this.calcManager.ZRe(H);if(!T)return u.ULS.sendTraceTag(524039641,0,15,"RelativeAndAbsoluteReferencesManager.CycleThroughRelativeAndAbsoluteReferences: Couldn't extract references (might be invalid formula)"),{returnValue:null,Pxd:S,Oxd:N};
T=this.hYh(T,H,F,J);for(var G=0,I="",K=0,L=0;L<T.length;L++)if(this.jJe(T[L],F,J)){G=T[L].Wbc();S=T[L].start;break}for(;L<T.length&&this.jJe(T[L],F,J);L++)I+=H.substring(K,T[L].start),I=T[L].ILg(G,I),K=T[L].end;K&&(N=I.length);I+=H.substring(K,H.length);return{returnValue:I,Pxd:S,Oxd:N}};a.prototype.hYh=function(H,F,J,S){for(var N=[],T=0;T<H.length;T++){var G=H[T];if(G.kind===y.a.range)if(G=G.ref,G.type===w.a.cell){var I=G;G=Object(l.a)(new f,{start:G.span.start,end:G.span.end,ev:[Object(l.a)(new m,
{column:I.col,row:I.row})],Rhc:this.calcManager.q2b(G.span.end,F)});N.push(G)}else if(G.type===w.a.range)this.kJe(G.topLeftSpan,J,S)&&this.kJe(G.bottomRightSpan,J,S)?(I=new h,G.top.index<=G.bottom.index?(I.top=G.top,I.bottom=G.bottom):(I.bottom=G.top,I.top=G.bottom),G.left.index<=G.right.index?(I.left=G.left,I.right=G.right):(I.right=G.left,I.left=G.right),G=Object(l.a)(new e,{start:G.topLeftSpan.start,end:G.bottomRightSpan.end,ev:[I]}),N.push(G)):(I=Object(l.a)(new f,{start:G.topLeftSpan.start,end:G.topLeftSpan.end,
ev:[Object(l.a)(new m,{column:G.left,row:G.top})],Rhc:this.calcManager.q2b(G.topLeftSpan.end,F)}),G=Object(l.a)(new f,{start:G.bottomRightSpan.start,end:G.bottomRightSpan.end,ev:[Object(l.a)(new m,{column:G.right,row:G.bottom})],Rhc:this.calcManager.q2b(G.topLeftSpan.end,F)}),N.push(I),N.push(G));else if(G.type===w.a.column){I=G;for(G=Object(l.a)(new k,{start:G.span.start,end:G.span.end,ev:[Object(l.a)(new n,{firstColumn:I.startIndex,secondColumn:I.endIndex})]});G.end<F.length-1&&":"===F.charAt(G.end)&&
T<H.length-1;)if(I=H[T+1].ref,I.type===w.a.column&&I.span.start===G.end+1){var K=I;G.ev.push(Object(l.a)(new n,{firstColumn:K.startIndex,secondColumn:K.endIndex}));G.end=I.span.end;T++}else break;N.push(G)}else if(G.type===w.a.row){I=G;for(G=Object(l.a)(new c,{start:G.span.start,end:G.span.end,ev:[Object(l.a)(new d,{firstRow:I.startIndex,secondRow:I.endIndex})]});G.end<F.length-1&&":"===F.charAt(G.end)&&T<H.length-1;)if(I=H[T+1].ref,I.type===w.a.row&&I.span.start===G.end+1)K=I,G.ev.push(Object(l.a)(new d,
{firstRow:K.startIndex,secondRow:K.endIndex})),G.end=I.span.end,T++;else break;N.push(G)}}return N};a.prototype.jJe=function(H,F,J){return!(H.start>J||F>H.end)};a.prototype.kJe=function(H,F,J){return!(H.start>J||F>H.end)};a.Dqf=function(H,F){return H.index<=F.index?H:F};a.gsf=function(H,F){return F||H?F&&H?2:!F&&H?3:0:1};Object(t.a)(a,"RelativeAndAbsoluteReferencesManager",null,[617])},1156:function(t,E,b){function a(A){var z=this;this.$=A;(this.jz=this.$.da.za(268))||d.ULS.shipAssertTag(537170070,
0,!1,"CalcHelper constructor - IInstantaneousSupportInformationManager is not available");var y=m.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")?v.a.current.So(75):v.a.current.So(78);this.logger=new f.a;this.documentLoc=excelOnlineCalc.location.documentLoc("",this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.jca=new c(A,this.jz);excelOnlineCalc.config.initCalc(this.logger,this.jz?function(w){return z.jz.isFeatureEnabled(w)}:function(){return!1},y);this.Bng=
excelOnlineCalc.config.calcConfig(this.jca.localeInfo)}function c(A,z){A=b(1156).CalcHelper;z&&(z.we||d.ULS.shipAssertTag(537169942,0,!1,"LocaleHolder constructor - locale information is not available"));this.itg=A.dEe(z,A.QDe(z.oja));this.jtg=excelOnlineCalc.calc.localeInfoFromData(this.localeData)}b.r(E);t=b(0);var d=b(15),e=b(278),h;(function(A){A[A.paren=0]="paren";A[A.lead=1]="lead";A[A.intern=2]="intern";A[A.trail=3]="trail";A[A.undefined=4]="undefined"})(h||(h={}));Object(t.b)("CurrencyFormatOption",
h);var k;(function(A){A[A.none=-1]="none";A[A.mdy=0]="mdy";A[A.dmy=1]="dmy";A[A.ymd=2]="ymd";A[A.myd=3]="myd";A[A.dym=4]="dym";A[A.ydm=5]="ydm"})(k||(k={}));Object(t.b)("DateOrderOption",k);var n=b(9);c.prototype.formatNumber=function(A){return this.localeInfo.formatNumber(A)};of.Object.defineProperties(c.prototype,{localeInfo:{configurable:!0,enumerable:!0,get:function(){return this.jtg}},localeData:{configurable:!0,enumerable:!0,get:function(){return this.itg}}});Object(t.a)(c,"LocaleHolder",null,
[]);var f=b(1195),v=b(53),m=b(1),x=b(22),l=b(14),u=b(210);b.d(E,"CalcHelper",function(){return a});a.prototype.dch=function(){if(m.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")){if(!this.$.xa)return d.ULS.shipAssertTag(537170069,0,!1,"CalcHelper.CurrentSheetIndex() - this.ewaControl.Sheets is null"),0;var A=this.$.xa.pa;return A?A.index:(d.ULS.shipAssertTag(537170068,0,!1,"CalcHelper.CurrentSheetIndex() - sheet is null"),0)}return this.$.xa.pa.index};a.prototype.createParser=
function(){var A={};A.config=this.config;return excelOnlineCalc.parse.createParser(A)};a.prototype.createNumberFormatter=function(){var A=this,z=excelOnlineCalc.numfmt.createFormatGlobals(this.config,function(y,w){return excelOnlineCalc.calc.getTime(A.config,y,w,"Estimation")});return excelOnlineCalc.numfmt.createNumberFormatter(z)};a.prototype.oah=function(A,z,y,w){if(!w)return{range:{row:z,col:y},sheet:{document:this.documentLoc,index:A}};z=excelOnlineCalc.location.gridCell(z,y);A=excelOnlineCalc.location.sheetIndex(this.documentLoc,
A);return excelOnlineCalc.location.sheetGridCell(A,z)};a.prototype.xnh=function(A,z){var y=excelOnlineCalc.calc.getEvalResultKind(A);switch(y){case 4:return{returnValue:A?this.jca.localeInfo.trueName:this.jca.localeInfo.falseName,kind:y};case 1:return{returnValue:m.EwaSettings.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?this.LAc(this.jca.formatNumber(A),z):this.jca.formatNumber(A),kind:y};case 2:return{returnValue:m.EwaSettings.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?
this.LAc(A.toString(),z):A.toString(),kind:y};case 128:return{returnValue:"",kind:y};case 8:switch(A.type){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:return{returnValue:this.jca.localeInfo.errorNames[A.type],kind:y};default:return{returnValue:a.unknownError,kind:y}}case 32:return{returnValue:m.EwaSettings.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?this.LAc(this.Fah(A,z),z):"##UNSUPPORTED: ARRAY",kind:y};default:return{returnValue:l.a.instance.ga(2200),
kind:y}}};a.prototype.LAc=function(A,z){return A.length<=z?A:A.substring(0,z-3)+"..."};a.prototype.Fah=function(A,z){for(var y=this.jca.localeInfo.leftBrace,w=0;w<A.rows;++w){for(var D=0;D<A.cols;++D)y+=A.opers[w][D],D<A.cols-1&&(y+=this.jca.localeInfo.columnSeparator);w<A.rows-1&&(y+=this.jca.localeInfo.rowSeparator)}return this.LAc(y,z-1)+this.jca.localeInfo.rightBrace};a.dEe=function(A,z){z=void 0===z?null:z;var y=a.V4b(),w=A.we.TrueValueString,D=A.we.FalseValueString,H=A.we.DecimalSeparator.toString(),
F=A.we.ListSeparator.toString(),J=A.we.ColumnSeparator.toString(),S=A.we.RowSeparator.toString(),N=A.we.ThousandsDataArray,T=A.we.ThousandSeparator.toString(),G=A.we.Lcid,I=A.we.Country,K=A.we.DigitsNumber,L=A.we.ExpSeparatedBySpace,O=A.we.FractionSeparator.toString(),B=A.we.PercentSeparatedBySpace,Q=x.a.pWg(Enum.toString(h,A.we.CurrencyFormat)),U=A.we.CurrencySymbolLead,X=A.we.CurrencySeparatedBySpace,P=A.we.CurrencySymbolString,ea=A.we.DigitsCurrency,ia=-1===A.we.DateOrder?"MDY":u.e(Enum.toString(k,
A.we.DateOrder)),da=A.we.DateSeparator.toString(),xa=A.we.DateAlternativeSeparator.toString(),Z=A.we.Year4Digits,ha=A.we.Month2Digits,ya=A.we.Day2Digits,va=A.we.LongDateFormat,bb=A.we.TimeSeparator.toString(),ba=A.we.TimeAltSeparator,fa=A.we.Hour2Digits,ra=A.we.Use24HourClock,pa=A.we.AmPmSeparatedBySpace,Za=[A.we.AmString,A.we.PmString],Ua=A.we.DayNameShortArray,Ma=A.we.DayNameLongArray,oa=A.we.MonthNameShortArray,ja=A.we.MonthNameLongArray,ta=A.we.PictureSpecialArray,aa=e.a.map(("\x00"+A.we.PictureSingleString).split(""),
function(Sa){return"\x00"===Sa?null:Sa}),ma=A.we.PictureColorArray,Ea=A.we.PictureDbnumArray,Ha=A.we.RowLetter.toString(),Aa=A.we.ColumnLetter.toString(),V=A.we.LeftBrace.toString(),La=A.we.RightBrace.toString(),Ra=A.we.LeftBracket.toString(),pb=A.we.RightBracket.toString(),cb=a.bZh(A.we);return excelOnlineCalc.calc.localeData(z,y,w,D,Ha,Aa,V,La,Ra,pb,H,F,J,S,N,T,G,I,K,L,O,B,Q,U,X,P,ea,ia,da,xa,Z,ha,ya,va,bb,ba,fa,ra,pa,Za,Ua,Ma,oa,ja,ta,aa,ma,Ea,cb,A.we.SysDateFormatString,A.we.SysTimeFormatString)};
a.QDe=function(A){var z=[];if(!A)return z;A=ik(A);for(var y=A.next();!y.done;y=A.next()){y=y.value;var w=null;y.IsDynamicUdf||(w=excelOnlineCalc.calc.worksheetFunctionName(y.FunctionIndexInServer,y.NameUI));w&&z.push(w)}return z};a.V4b=function(){for(var A=[],z=Object.keys(n.a.errorNames),y=0;y<z.length;y++){var w=excelOnlineCalc.calc.errorTypeName(y+1,z[y]);w&&A.push(w)}return A};a.bZh=function(A){var z=Array(6);z[1]="#"+A.AllStructRefString;z[3]="#"+A.HeadersStructRefString;z[2]="#"+A.DataStructRefString;
z[4]="#"+A.TotalsStructRefString;z[5]="#"+A.ThisRowStructRefString;return z};of.Object.defineProperties(a.prototype,{config:{configurable:!0,enumerable:!0,get:function(){return this.Bng}}});a.unknownError="##ERR##";Object(t.a)(a,"CalcHelper",null,[])},1197:function(t,E,b){function a(){}b.d(E,"a",function(){return a});t=b(0);a.Mti="literal";a.operator="operator";a.func="function";a.namedRange="namedRange";a.range="range";a.Fkf="letName";a.all="*";a.tUd="structRefRange";Object(t.a)(a,"TraverseFormulaInterestTypes",
null,[])},1198:function(t,E,b){function a(){}b.d(E,"a",function(){return a});t=b(0);a.cell="cell";a.range="range";a.row="row";a.column="col";Object(t.a)(a,"TraverseFormulaRefTypes",null,[])},1371:function(t,E,b){function a(){oa.a.Fa(c.ka)}function c(ja){var ta=Ma.call(this)||this;ta.$=ja;ta.Eb();return ta}function d(ja){var ta=pa.call(this)||this;ta.Ls=null;ta.Ugg=!1;ta.qGb=null;ta.instantaneousSupportInformationManager=null;ta.CLd=null;ta.Hyd=new Map;ta.ece=null;ta.Snc=function(aa){z.ULS.sendTraceTag(537170005,
0,50,"CalcManager.OnLocaleInformationAvailable() called");aa.xJd(ta.Snc);aa.oja.length?ta.ync(aa,Sys.EventArgs.Empty):(z.ULS.sendTraceTag(537170004,0,50,"CalcManager.OnLocaleInformationAvailable() - waiting for functions information"),aa.zne(ta.ync))};ta.ync=function(aa){z.ULS.sendTraceTag(537170003,0,50,"CalcManager.OnFunctionsInfoReady called");aa.oJd(ta.ync);ta.WOj(aa)};ta.onContentReady=function(){ta.Ls&&(ta.instantaneousSupportInformationManager&&ta.instantaneousSupportInformationManager.amd||
va.Task.delay(0).continueWith(function(){ta.Ls.pfb(1)},0,null,bb.a.current))};ta.Muf=function(aa,ma){ta.Ls&&(ta.instantaneousSupportInformationManager&&ta.instantaneousSupportInformationManager.amd||ta.Ls.nFe(ma.ed.block))};z.ULS.sendTraceTag(537170067,0,50,"Creating CalcManager");ta.Xfc=!1;ta.ib=ja;ta.qp=U.g(ja);ta.bGc=null;ta.gridView.Au(ta.onContentReady);ta.gridView.Ea.YUc(ta.Muf);ta.$.da.Za(268,function(aa){aa.we?(z.ULS.sendTraceTag(537170066,0,50,"CalcManager.ctor: LocaleInformation already available..."),
ta.Snc(aa,Sys.EventArgs.Empty)):(z.ULS.sendTraceTag(537170065,0,50,"CalcManager.ctor: waiting for LocaleInformation..."),aa.Vne(ta.Snc))});return ta}function e(ja){var ta=ra.call(this)||this;ta.sk=ja;return ta}function h(){}function k(){}function n(){this.S4=this.T4=this.YZ=this.ZZ=this.cxa=!1}function f(ja){var ta=this;this.fHd=null;this.Mtd=this.eHd=this.wFb=!1;this.ZEd=0;this.PEd=this.REd=this.SEd=this.QEd=-1;this.trueName="TRUE";this.falseName="FALSE";this.instantaneousSupportInformationManager=
this.Nn=this.errorTypeNames=null;this.ir=this.currentStateId=-1;this.ota="";this.caa=null;this.getNameLoc=function(aa,ma){return ta.shc()?ta.Se.na(ta.currentStateId).xj[0].d6.kb(ma)?(aa=excelOnlineCalc.location.nameLoc(aa,ma),excelOnlineCalc.util.success(aa)):excelOnlineCalc.util.success(null):(aa=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(aa))};this.getContainingTable=function(aa){if(!ta.shc())return aa=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(aa);
var ma=aa.range.col,Ea=aa.range.row,Ha=ta.Se.na(ta.currentStateId).xj[0].d6,Aa=null;Ha=ik(Ha);for(var V=Ha.next();!V.done;V=Ha.next())if(V=V.value.value,2===V.type&&J.a.equals(aa.sheet.index.toString(),V.sheetId,!0)){var La=V.range;ma>=La.left-1&&ma<=La.right-1&&Ea<=La.bottom-1&&Ea>=La.top-1&&(Aa=excelOnlineCalc.location.nameScope(ta.documentLoc,V.sheetId),Aa=excelOnlineCalc.location.nameLoc(Aa,V.fullName))}return Aa?excelOnlineCalc.util.success(Aa):excelOnlineCalc.util.success(null)};this.getStructRefColumn=
function(aa,ma){if(!ta.shc()){var Ea=excelOnlineCalc.util.unavailable([2]);return excelOnlineCalc.util.failure(Ea)}Ea=aa.name;var Ha=ta.Se.na(ta.currentStateId).xj[0].d6;if(Ha.kb(Ea)){Ha=Ha.na(Ea);var Aa=Ha.range;if(2!==Ha.type)return excelOnlineCalc.util.failure(ta.T3c(5));var V=Ha.kE?Ha.kE.J$:null;if(!V)return excelOnlineCalc.util.success(null);for(var La=ik(V),Ra=La.next();!Ra.done;Ra=La.next())if(Ra=Ra.value,J.a.equals(Ra.value,ma,!0))return aa=excelOnlineCalc.location.documentLoc(aa.scope.document.path,
aa.scope.document.name),aa=excelOnlineCalc.location.sheetIndex(aa,Ha.sheetId),Aa=excelOnlineCalc.location.gridRange(Aa.top-1,Ra.key,Aa.bottom-Aa.top+1,1),Aa=excelOnlineCalc.location.sheetGridRange(aa,Aa),Ea=excelOnlineCalc.location.structRefColumnLoc(Ea,Aa,!!(Ha.attributes&16),!!(Ha.attributes&8)),excelOnlineCalc.util.success(Ea);return Aa.right-Aa.left+1!==V.count?(Ea=excelOnlineCalc.util.unavailable([17,aa,ma]),excelOnlineCalc.util.failure(Ea)):excelOnlineCalc.util.failure(ta.T3c(0))}return excelOnlineCalc.util.success(null)};
this.getStructRefSpecialRef=function(aa,ma){if(!ta.shc())return ma=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(ma);var Ea=ta.Se.na(ta.currentStateId).xj[0].d6;if(Ea.kb(aa.name)){var Ha=Ea.na(aa.name);if(2!==Ha.type)return excelOnlineCalc.util.failure(ta.T3c(5));Ea=!!(Ha.attributes&16);var Aa=!!(Ha.attributes&8),V=Ea?1:0,La=Aa?1:0;aa=excelOnlineCalc.location.documentLoc(aa.scope.document.path,aa.scope.document.name);aa=excelOnlineCalc.location.sheetIndex(aa,Ha.sheetId);Ha=Ha.range;
var Ra={};if(1===ma)Ra=excelOnlineCalc.location.gridRange(Ha.top-V-1,Ha.left-1,Ha.bottom+La-Ha.top+V+1,Ha.right-Ha.left+1);else if(2===ma)Ra=excelOnlineCalc.location.gridRange(Ha.top-1,Ha.left-1,Ha.bottom-Ha.top+1,Ha.right-Ha.left+1);else if(3===ma)if(Ea)Ra=excelOnlineCalc.location.gridRange(Ha.top-2,Ha.left-1,1,Ha.right-Ha.left+1);else return excelOnlineCalc.util.success(null);else if(4===ma)if(Aa)Ra=excelOnlineCalc.location.gridRange(Ha.bottom,Ha.left-1,1,Ha.right-Ha.left+1);else return excelOnlineCalc.util.success(null);
ma=excelOnlineCalc.location.sheetGridRange(aa,Ra);return excelOnlineCalc.util.success(ma)}return excelOnlineCalc.util.success(null)};this.getDocumentLoc=function(aa,ma){if((J.a.equals(aa,ta.documentLoc.path,!0)||!aa)&&J.a.equals(ma,ta.documentLoc.name,!0))return excelOnlineCalc.util.success(ta.documentLoc);aa=excelOnlineCalc.util.unavailable([0,excelOnlineCalc.location.documentLoc(aa,ma)]);return excelOnlineCalc.util.failure(aa)};this.getSheetIndex=function(aa,ma){if(!ta.Se.kb(ta.currentStateId)||
!ta.Se.na(ta.currentStateId).xj)return ma=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(ma);aa=ta.Se.na(ta.currentStateId).xj;for(var Ea=1;Ea<aa.length;Ea++)if(J.a.equals(aa[Ea].A7.sheetName,ma,!0))return excelOnlineCalc.util.success(aa[Ea].A7.sheetId);return excelOnlineCalc.util.success(null)};this.getSheetName=function(aa,ma){if(!ta.Se.kb(ta.currentStateId)||!ta.Se.na(ta.currentStateId).xj)return ma=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(ma);aa=ta.Se.na(ta.currentStateId).xj;
for(var Ea=1;Ea<aa.length;Ea++)if(J.a.equals(aa[Ea].A7.sheetId,ma,!0))return excelOnlineCalc.util.success(aa[Ea].A7.sheetName);return excelOnlineCalc.util.success(null)};this.getUserDefinedFuncLoc=function(){return excelOnlineCalc.util.notImplemented(["ParseGlobals.GetUserDefinedFuncLoc not implemented in main thread"])};this.getSheetRangeIndexes=function(){return excelOnlineCalc.util.notImplemented(["ParseGlobals.GetSheetRangeIndexes not implemented in main thread"])};this.zAf=function(){ta.setNumberFormats()};
this.Yc=function(){z.ULS.sendTraceTag(537170081,0,50,"CalcAsyncEngine.OnWorkbookOpened() called");ta.Se=new O.a;ta.ir=-1;ta.currentStateId=-1;ta.ota="";ta.gsb=null;ta.eHd=!1;ta.Nn&&ta.clearCache()};this.I5f=(this.Ec=ja)?ja.ya.CalcWebWorkerSmokeTestPingIntervalMS:this.I5f;this.Se=new O.a;this.gsb=null;this.documentLoc=excelOnlineCalc.location.documentLoc("",this.Ec.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.Boa();this.rod=K.a.rod()}function v(ja){this.I3d=null;this.init(ja)}function m(){}
function x(ja){this.A7=ja;this.d6=new S.a(N.a.Jk());this.Ylc=!1}function l(ja){this.mfg=ja;this.Kge=[];this.Hcg=[];this.x_a={};this.BQd=new Map}function u(ja,ta,aa,ma,Ea){this.type=ja;this.fullName=ta;this.range=aa;this.sheetId=ma;this.attributes=Ea;this.kE=null}function A(ja,ta){this.Gve=ja;this.sheetName=ta;this.Gvc=!1}t=b(0);var z=b(15),y=b(235),w=b(9),D=b(113),H=b(192),F=b(85);Object(t.a)(A,"CalcBlockInformation",null,[]);Object(t.a)(u,"CalcNamedObject",null,[]);var J=b(22);l.prototype.t0f=function(ja,
ta){this.Kge[ja]=ta;this.mfg&&ta.A7&&this.BQd.set(ta.A7.sheetName,ja)};l.prototype.getSheetIndex=function(ja){if(this.mfg){if(this.BQd.has(ja))return this.BQd.get(ja)}else for(var ta=1;ta<this.xj.length;ta++)if(J.a.equals(this.xj[ta].A7.sheetName,ja,!1))return ta;return-1};of.Object.defineProperties(l.prototype,{xj:{configurable:!0,enumerable:!0,get:function(){return this.Kge}}});Object(t.a)(l,"GridCache",null,[]);var S=b(904),N=b(625);Object(t.a)(x,"SheetInformation",null,[]);var T=b(1156),G;(function(ja){ja[ja.initialization=
0]="initialization";ja[ja.contentReady=1]="contentReady";ja[ja.cellEdit=2]="cellEdit"})(G||(G={}));Object(t.b)("UpdateDataTrigger",G);var I=b(64);m.local="Local";m.qKj="Thread";Object(t.a)(m,"RecalcServiceCreateMode",null,[]);var K=b(36),L=b(169),O=b(171);v.prototype.init=function(ja){this.I3d=new O.a;if(void 0!==ja&&null!==ja&&void 0!==ja.HeadersList&&null!==ja.HeadersList&&0<ja.HeadersList.length){ja=ik(ja.HeadersList);for(var ta=ja.next();!ta.done;ta=ja.next())ta=ta.value,this.J$.ia(ta.Index,ta.Name)}};
of.Object.defineProperties(v.prototype,{J$:{configurable:!0,enumerable:!0,get:function(){return this.I3d}}});Object(t.a)(v,"ColHeadersListData",null,[]);var B=b(1),Q=b(101),U=b(21),X=b(211);b(210);var P=b(207);f.prototype.dispose=function(){this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.xJd(this.zAf);this.Ec&&this.Ec.sl(this.Yc);this.close()};f.prototype.pfb=function(ja){if(!this.Nn)return!1;if(!this.instantaneousSupportInformationManager&&(this.instantaneousSupportInformationManager=
this.Ec.da.za(268),!this.instantaneousSupportInformationManager))return z.ULS.sendTraceTag(537170198,0,50,"CalcAsyncEngine.UpdateData Failed to get instantaneousSupportInformationManager"),!1;2!==ja&&(this.currentStateId=this.Ec.ea.Njc,this.currentStateId===w.a.Ee&&(this.currentStateId=this.Ec.ea.Ke));if(1===ja&&this.currentStateId<this.ir)return z.ULS.sendTraceTag(537170197,0,50,"CalcAsyncEngine::UpdateData() currentStateId:"+this.currentStateId+" < lastUpdatedStateId:"+this.ir+" - ignoring update"),
!1;this.Tqj();0!==ja&&this.eHd||(this.kvj(),this.rsj(),this.btj(),this.setNumberFormats(),this.instantaneousSupportInformationManager.Vne(this.zAf),this.Ec.Uk(this.Yc),this.eHd=!0);this.z7i();var ta=!1;0===ja&&(ta=this.mbi());if(0!==ja||ta)this.wuj()?(this.$uj(ja),this.Zuj(),this.ir=this.currentStateId,this.XYg()):z.ULS.sendTraceTag(537170196,0,15,"CalcAsyncEngine::UpdateData() for StateId:"+this.currentStateId+" failed - no Sheets information");2!==ja&&this.resumeRecalc();return!0};f.prototype.evalFormula=
function(ja,ta,aa,ma){if(!this.Nn)return z.ULS.sendTraceTag(537170195,0,15,"CalcAsyncEngine.EvalFormula: recalc engine is null"),Promise.resolve({});ta=excelOnlineCalc.calc.sheetCellLocation(null!==aa&&void 0!==aa?aa:I.d(this.Ec.xa.pa),ta.top-1,ta.left-1);ja=this.Nn.evalFormula(this.Ec.ea.Ke,ja,ta,ma);this.resumeRecalc();return ja};f.prototype.LUg=function(ja,ta,aa,ma){ma=void 0===ma?null:ma;if(this.Nn&&ja){var Ea=I.d(this.Ec.xa.pa),Ha=ja.cell.ZJ-1,Aa=ja.cell.YJ-1,V=Ha,La=Aa,Ra=null;ma&&(Ra=excelOnlineCalc.calc.cellLocation(Ha,
Aa),Ha=ma.top-1,Aa=ma.left-1,V=ma.bottom-1,La=ma.right-1);if(ja.cell.Tt)if(ma=ja.cell.Tt.uYc,ma===w.a.Ee)z.ULS.sendTraceTag(537170187,0,15,"CalcAsyncEngine::CalculateFormula() BlockRevision unknown for block:"+ja.cell.Tt.Ld);else if(ma<this.ir)z.ULS.sendTraceTag(537170185,0,50,"CalcAsyncEngine::CalculateFormula() Can't calc edit in cell:("+Ha+","+Aa+") - blockRevision:"+ma+" < lastUpdatedStateId:"+this.ir);else if(ma<this.currentStateId)z.ULS.sendTraceTag(537170184,0,50,"CalcAsyncEngine::CalculateFormula() Can't calc edit in cell:("+
Ha+","+Aa+") - blockRevision:"+ma+" < currentStateId:"+this.currentStateId);else if(this.wFb||(this.Nn.setOnRecalcResults(aa),this.wFb=!0),this.ucg()&&!this.pfb(2))z.ULS.sendTraceTag(537170183,0,15,"CalcAsyncEngine.CalculateFormula: UpdateData failed");else{La=f.VY("CalculateFormula.cell",Ea,Ha,Aa,V,La);aa=[];var pb=U.g(this.Ec);V=pb.Vg;U.g(this.Ec).eb.Ji&&(V=pb.Gf(1).Vg,V.yna(1,1),V.yna(3,1));pb=null;V?pb=f.VY("CalculateFormula.viewport",Ea,V.top-1,V.left-1,V.bottom-1,V.right-1):z.ULS.sendTraceTag(537170182,
0,50,"CalcAsyncEngine::CalculateFormula() viewportRange is null, calc will use entire sheet...");ta=excelOnlineCalc.calc.inferredRangeFormulaEdit(La,ta,Ra,pb);aa.push(ta);ja=V?String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",Ea,Ha,Aa,J.a.P_b(ja.cell.text),ma,V.top-1,V.left-1,V.bottom-1,V.right-1):String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",
Ea,Ha,Aa,J.a.P_b(ja.cell.text),ma,"","","","");z.ULS.sendTraceTag(537170181,0,50,ja);this.Nn.editRangeFormulas(ma,aa);this.resumeRecalc()}else z.ULS.sendTraceTag(537170186,0,15,"CalcAsyncEngine::CalculateFormula() GridBlockModelProxy is null cell:("+ja.cell.ZJ+","+ja.cell.YJ+")")}else z.ULS.sendTraceTag(537170188,0,15,"CalcAsyncEngine::CalculateFormula() recalc engine is null:"+!this.Nn+", modifiedCell is null:"+!ja)};f.prototype.JUg=function(ja,ta,aa,ma){ma=void 0===ma?null:ma;var Ea=I.d(this.Ec.xa.pa),
Ha=ja.cell.ZJ-1,Aa=ja.cell.YJ-1,V=Ha,La=Aa,Ra=null;ma&&(Ra=excelOnlineCalc.calc.cellLocation(Ha,Aa),Ha=ma.top-1,Aa=ma.left-1,V=ma.bottom-1,La=ma.right-1);aa=this.RZd(ja,aa,"SetCell");0>aa||(La=f.VY("CalculateFormula.cell",Ea,Ha,Aa,V,La),V=[],ma=this.phd(Ea),ta=excelOnlineCalc.calc.inferredRangeFormulaEdit(La,ta,Ra,ma),V.push(ta),ja=(ta=this.V3e())?String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",Ea,Ha,Aa,J.a.P_b(ja.cell.text),
aa,ta.top-1,ta.left-1,ta.bottom-1,ta.right-1):String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",Ea,Ha,Aa,J.a.P_b(ja.cell.text),aa,"","","",""),z.ULS.sendTraceTag(537170180,0,50,ja),this.Nn.editRangeFormulas(aa,V),this.resumeRecalc())};f.prototype.Etb=function(ja,ta,aa,ma){if(!this.Nn)return z.ULS.sendTraceTag(537170179,0,15,"CalcAsyncEngine::EvalFormulaRangeOnClone recalc engine is null"),Promise.reject("RecalcService is null");
if(!aa||!ta)return z.ULS.sendTraceTag(524120779,0,15,"CalcAsyncEngine::EvalFormulaRangeOnClone inputs are null. originCell null: "+!aa+", outputColumnRange null: "+!ta),Promise.reject("CalcAsyncEngine::EvalFormulaRangeOnClone: null inputs");z.ULS.shipAssertTag(537170178,0,aa.isSingle,"CalcAsyncEngine::EvalFormulaRangeOnClone originCell must be a single cell.");var Ea=I.d(this.Ec.xa.pa),Ha=this.phd(Ea),Aa=null;if(ja){Aa=[];ja=ik(ja);for(var V=ja.next();!V.done;V=ja.next())if(V=V.value,V.column!==aa.left){var La=
V.row-1;var Ra=V.column-1;La=f.VY("EvalFormulaRangeOnClone.cell",Ea,La,Ra,La,Ra);Ra=V.text;Aa.push(excelOnlineCalc.calc.rangeWrite(La,excelOnlineCalc.calc.valueCellData(Ra,Ra,V.Zk,null)))}}aa=excelOnlineCalc.calc.cellLocation(aa.top-1,aa.left-1);ta=f.VY("EvalFormulaRangeOnClone.outputColumnRange",Ea,ta.top-1,ta.left-1,ta.bottom-1,ta.right-1);ma=[excelOnlineCalc.calc.cellFormulaRangeFormulaEdit(ta,ma,aa,Ha)];Aa=this.Nn.evalOnClonedModel(Aa,ma);this.resumeRecalc();return Aa};f.prototype.nFe=function(ja){var ta=
null;try{if(ja)if(this.ota=U.g(this.Ec).Ea.Xua(ja),this.currentStateId=ja.RSa,this.currentStateId<this.ir||this.currentStateId===w.a.Ee)z.ULS.sendTraceTag(537170176,0,50,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() hash:"+this.ota+" blockRevision:"+this.currentStateId+" < lastUpdatedStateId:"+this.ir);else{if(this.rbi(),!this.OPg())if(ta=this.Ec.Fb.sc("ModelUpdate","CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() Block Hash:"+this.ota+" StateId:"+this.currentStateId),this.gsb=this.Awb(ja.pa.sheetName),
!this.gsb){var aa=!!(this.Ec.Bd&32);z.ULS.sendTraceTag(537170147,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel SheetName not found. Number of existing sheets "+(this.Se.kb(this.currentStateId)&&this.Se.na(this.currentStateId).xj?this.Se.na(this.currentStateId).xj.length:0)+", scratchPad:"+aa+", sheetNameLength:"+(ja.pa.sheetName?ja.pa.sheetName.length:-1)+" Hash:"+ja.pa.hash)}else if(U.g(this.Ec).Ea.hm.L1a(ja.Ld)){var ma=ja.lf;if(ma){var Ea=ma.getCalcBlockModel();if(!Ea)z.ULS.sendTraceTag(537170145,
0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model for block");else if(this.GPg(Ea)){this.Se.na(this.currentStateId).x_a[this.ota]=new A(Ea,ja.pa.sheetName);var Ha=ja.ke;Ha?this.$Cg(Ha.NamedObjects):z.ULS.sendTraceTag(537170144,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel GetGridBlockContentResponse is null")}}else z.ULS.sendTraceTag(537170146,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model accessor for block:"+this.ota)}}else z.ULS.shipAssertTag(537170177,
0,!1,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() blockCacheItem is null")}finally{ta&&ta.stop()}};f.prototype.G4a=function(ja){if(!this.Se.na(this.currentStateId).xj||!this.Se.na(this.currentStateId).xj[0])return null;var ta=this.Se.na(this.currentStateId).xj[0].d6;if(!ta||!ta.kb(ja.name))return null;ta=ta.na(ja.name);if(!ta||!ta.kE)return null;ja=new H.a;ta=ik(ta.kE.J$);for(var aa=ta.next();!aa.done;aa=ta.next())ja.add(aa.value.value);return ja};f.prototype.KUg=function(ja,ta,aa){var ma=
U.g(this.Ec),Ea=ma.Ub(ta);Ea=this.RZd(Ea,null,"CopyPaste");aa=this.RZd(ma.Ub(ja),aa,"CopyPaste");if(0>Ea||0>aa||Ea!==aa)z.ULS.sendTraceTag(537170143,0,15,"CalcAsyncEngine::CalculateFormulaForCopyPaste(). Revision not valid. sourceRevision:"+aa+", targetRevision:"+Ea+".");else{aa=[];ma=I.d(this.Ec.xa.pa);var Ha=this.phd(ma);ja=f.VY("CalculateFormulaForCopyPaste.srcRange",ma,ja.top-1,ja.left-1,ja.bottom-1,ja.right-1);ta=f.VY("CalculateFormulaForCopyPaste.targetRange",ma,ta.top-1,ta.left-1,ta.bottom-
1,ta.right-1);ta=excelOnlineCalc.calc.copyPasteRangePasteEdit(ta,ja,Ha);aa.push(ta);ta=Ha?String.format("CalcAsyncEngine::CalculateFormulaForCopyPaste() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",ma,Ea,Ha.row,Ha.column,Ha.lastRow,Ha.lastColumn):String.format("CalcAsyncEngine::CalculateFormulaForCopyPaste() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",ma,Ea,"","","","");z.ULS.sendTraceTag(537170142,0,50,ta);this.Nn.editRangePaste(Ea,aa);this.resumeRecalc()}};f.prototype.phd=
function(ja){var ta=this.V3e(),aa=null;ta?aa=f.VY("GetViewport.viewport",ja,ta.top-1,ta.left-1,ta.bottom-1,ta.right-1):z.ULS.sendTraceTag(537170141,0,50,"CalcAsyncEngine::GetViewport() viewportRange is null, calc will use entire sheet...");return aa};f.prototype.V3e=function(){var ja=U.g(this.Ec),ta=ja.Vg;if(U.g(this.Ec).eb.Ji){ta=ja.Gf(1).Vg;if(B.EwaSettings.isChangeGateEnabled("OfficeVSO:5497152_JSCrash_At_CalcAsyncEngine_GetViewportRange")&&!ta)return z.ULS.sendTraceTag(537170140,0,15,"CalcAsyncEngine::GetViewportRange viewportRange is null."),
null;ta.yna(1,1);ta.yna(3,1)}return ta};f.prototype.RZd=function(ja,ta,aa){if(!this.Nn||!ja)return z.ULS.sendTraceTag(537170139,0,15,"CalcAsyncEngine::ValidateCalculateFormulaInit() recalc engine is null:"+!this.Nn+", modifiedCell is null:"+!ja+", operation:"+aa),-1;var ma=ja.cell.ZJ-1,Ea=ja.cell.YJ-1;if(ja.cell.Tt){var Ha=ja.cell.Tt.uYc;if(Ha===w.a.Ee)return z.ULS.sendTraceTag(537170138,0,15,"CalcAsyncEngine::ValidateCalculateFormulaInit() BlockRevision unknown for block:"+ja.cell.Tt.Ld+", operation:"+
aa),-1}else return z.ULS.sendTraceTag(537170137,0,15,"CalcAsyncEngine::ValidateCalculateFormulaInit() GridBlockModelProxy is null cell:("+ja.cell.ZJ+","+ja.cell.YJ+"), operation:"+aa),-1;if(Ha<this.ir)return z.ULS.sendTraceTag(537170136,0,50,"CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:("+ma+","+Ea+") - blockRevision:"+Ha+" < lastUpdatedStateId:"+this.ir+", operation:"+aa),-1;if(Ha<this.currentStateId)return z.ULS.sendTraceTag(537170135,0,50,"CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:("+
ma+","+Ea+") - blockRevision:"+Ha+" < currentStateId:"+this.currentStateId+", operation:"+aa),-1;ta&&!this.wFb&&(this.Nn.setOnRecalcResults(ta),this.wFb=!0);return this.ucg()&&!this.pfb(2)?(z.ULS.sendTraceTag(537170134,0,15,"CalcAsyncEngine.ValidateCalculateFormulaInit: UpdateData failed. operation:"+aa),-1):Ha};f.prototype.getFormulaBarText=function(ja,ta,aa){return ta&&ta.startsWith("'")?ta:ja.cell.formulaBarText||aa.toString()};f.prototype.v$g=function(ja,ta,aa){var ma=null;if(this.pwe()&&this.Se.na(this.ir).x_a){var Ea=
this.Se.na(this.ir).x_a[ja];if(null===Ea||void 0===Ea?0:Ea.Gvc)ma=Ea.Gve}aa=this.hgi(ma,ta,aa);ta=this.x1g(ma,ta,aa);z.ULS.sendTraceTag(50671754,0,50,"CalcAsyncEngine::CreateRangeUpdateCommands() completed for Block Hash:"+ja+" StateId:"+this.currentStateId+" number of formulas "+ta)};f.prototype.hgi=function(ja,ta,aa){var ma=!1,Ea=f.lXe(ta);if(ja){var Ha=f.lXe(ja);J.a.equals(Ha,Ea,!1)&&(ma=!0)}ma?this.EDg(ja,this.ir,aa):this.GDg(ta,aa);return ma};f.prototype.pwe=function(){var ja=!1;this.Nn&&-1!==
this.ir&&(ja=this.Nn.stateIdAvailable(this.ir));return ja&&this.Se.kb(this.ir)&&this.ir<this.currentStateId};f.prototype.x1g=function(ja,ta,aa){var ma=0;var Ea,Ha;for(ta.reset();Ea=ta.getNextCell();)X.f(Ea.formula)&&ma++,(Ha=aa?ja.getCell(Ea.row,Ea.col):null)?this.t1g(ta,Ea,Ha):this.FDg(ta,Ea);if(aa)for(ja.reset();Ha=ja.getNextCell();)(Ea=ta.getCell(Ha.row,Ha.col))||this.hme(ja,Ha);return ma};f.prototype.btj=function(){this.Nn.setOnUpdateRequest(function(){})};f.prototype.atj=function(){var ja=this;
this.Nn.setOnUnresponsive(function(ta,aa,ma,Ea){ja.NUi(ta,aa,ma,Ea)})};f.prototype.NUi=function(ja,ta,aa,ma){z.ULS.sendTraceTag(537170126,0,15,"CalcAsyncEngine.onUnresponsive: worker thread was unresponsive. timeout:"+ja+", waitTime:"+ta+", timeoutCount:"+aa+", hasBeenClosed:"+ma+".");ma&&(this.Phj(),this.Boa())};f.prototype.Phj=function(){this.Yc(null,null);this.Mtd=this.wFb=!1;this.ZEd=0;this.PEd=this.REd=this.SEd=this.QEd=-1};f.prototype.close=function(){this.Nn.close()};f.prototype.clearCache=
function(){this.Nn.clearCache()};f.prototype.resumeRecalc=function(){this.Nn.resumeRecalc()};f.prototype.rsj=function(){this.Nn.setA1ReferenceStyle(!0)};f.prototype.z7i=function(){if(this.instantaneousSupportInformationManager){var ja=this.instantaneousSupportInformationManager.ydi,ta=this.instantaneousSupportInformationManager.Bdi,aa=this.instantaneousSupportInformationManager.Adi,ma=this.instantaneousSupportInformationManager.zdi,Ea=!1;ja!==this.QEd&&(Ea=!0,this.QEd=ja);ta!==this.SEd&&(Ea=!0,this.SEd=
ta);aa!==this.REd&&(Ea=!0,this.REd=aa);ma!==this.PEd&&(Ea=!0,this.PEd=ma);var Ha=[];B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled",!1)&&(Ea=excelOnlineCalc.calc.runExperiment("ExceLintExperiment",null),Ha.push(Ea),Ea=!0);B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnitExperiment",!1)&&(Ea=excelOnlineCalc.calc.runExperiment("UnitExperiment",null),Ha.push(Ea),Ea=!0);B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",
!1)&&(Ea=excelOnlineCalc.calc.runExperiment("AutocompleteExperiment",null),Ha.push(Ea),Ea=!0);Ea&&(ja=excelOnlineCalc.calc.recalcServiceConfig(null,ja,null,ta,null,null,null,aa,Ha,ma),this.Nn.reconfigure(ja))}};f.prototype.$uj=function(ja){var ta=this,aa=null;if(this.Se.kb(this.currentStateId))try{this.caa=[],aa=this.Ec.Fb.sc("ModelUpdate","CalcAsyncEngine::SetUpdatedRanges() StateId:"+this.currentStateId+" UpdateTriggerData:"+G[ja]),D.a.forEach(this.Se.na(this.currentStateId).x_a,function(ma,Ea){Ea.Gvc||
(ta.v$g(ma,Ea.Gve,Ea.sheetName),Ea.Gvc=!0)},null),this.Nn.updateRanges(this.currentStateId,this.caa)}finally{aa&&aa.stop()}else z.ULS.sendTraceTag(537170122,0,15,"CalcAsyncEngine::SetUpdatedRanges StateId:"+this.currentStateId+" does not exist in GridCache")};f.prototype.Zuj=function(){var ja=[],ta=this.pwe(),aa=ta&&this.Se.na(this.ir).xj&&this.Se.na(this.ir).xj[0]&&this.Se.na(this.ir).xj[0].Ylc?this.Se.na(this.ir).xj[0].d6:null;this.UAe(aa,this.Se.na(this.currentStateId).xj[0].d6,null,this.ir,ja);
this.Se.na(this.currentStateId).xj[0].Ylc=!0;for(var ma=1;ma<this.Se.na(this.currentStateId).xj.length;ma++)aa=-1,ta&&this.Se.na(this.ir).xj&&(aa=this.zgd(this.Se.na(this.currentStateId).xj[ma].A7.sheetName,this.ir)),aa=-1!==aa&&this.Se.na(this.ir).xj[aa].Ylc?this.Se.na(this.ir).xj[aa].d6:null,this.UAe(aa,this.Se.na(this.currentStateId).xj[ma].d6,this.Se.na(this.currentStateId).xj[ma].A7.sheetId,this.ir,ja),this.Se.na(this.currentStateId).xj[ma].Ylc=!0;this.Nn.updateNamedObjects(this.currentStateId,
ja)};f.prototype.UAe=function(ja,ta,aa,ma,Ea){if(void 0!==aa&&null!==aa){var Ha=excelOnlineCalc.calc.undefinedNamesWrite(aa);Ea.push(Ha)}if(ja){var Aa=!1,V=[];Ha=[];if(ta)for(var La=ik(ta),Ra=La.next();!Ra.done;Ra=La.next()){Ra=Ra.value;var pb=Ra.value;if(ja.kb(Ra.key)){var cb=ja.na(Ra.key);f.DEi(cb,pb)?Aa=!0:(cb=excelOnlineCalc.calc.namedObject(Ra.key,null),V.push(cb),f.zUc(Ra.key,pb,Ha))}else f.zUc(Ra.key,pb,Ha)}ja=ik(ja);for(Ra=ja.next();!Ra.done;Ra=ja.next())La=Ra.value,ta&&ta.kb(La.key)||(La=
excelOnlineCalc.calc.namedObject(La.key,null),V.push(La));Aa&&(ta=excelOnlineCalc.calc.namedObjectsPromote(aa,ma),Ea.push(ta));0<V.length&&(ta=excelOnlineCalc.calc.namedObjectsWrite(aa,V),Ea.push(ta));0<Ha.length&&(aa=excelOnlineCalc.calc.namedObjectsWrite(aa,Ha),Ea.push(aa))}else if(ta){Ha=[];ta=ik(ta);for(ma=ta.next();!ma.done;ma=ta.next())ma=ma.value,f.zUc(ma.key,ma.value,Ha);0<Ha.length&&(aa=excelOnlineCalc.calc.namedObjectsWrite(aa,Ha),Ea.push(aa))}};f.prototype.OPg=function(){return this.Se.na(this.currentStateId).x_a[this.ota]?
(z.ULS.sendTraceTag(537170121,0,50,"CalcAsyncEngine::BlockPreviouslyHandled Block Hash:"+this.ota+" StateId:"+this.currentStateId+" previously handled"),!0):!1};f.prototype.GPg=function(ja){return 1===ja.getColumnNumbers().length&&ja.getColumnNumbers()[0]===f.cwd+1?!1:!0};f.prototype.mbi=function(){var ja=this,ta=!1;U.g(this.Ec).Ea.vbd(function(aa){aa.state&1&&ja.Ec.ea.Ke===aa.ie.Revision&&(ja.nFe(aa),ta=!0)});return ta};f.prototype.iDe=function(ja,ta){var aa=ja.getRowNumbers(),ma=ja.getColumnNumbers();
ja=aa[0]-1;aa=aa[aa.length-1]-1;var Ea=ma[0]-1;ma=ma[ma.length-1]-1;(ta=this.Awb(ta))||z.ULS.sendTraceTag(537170120,0,15,"CalcAsyncEngine::CreateBlockRangeLocation SheetName not found. Number of existing sheets "+(this.Se.kb(this.currentStateId)&&this.Se.na(this.currentStateId).xj?this.Se.na(this.currentStateId).xj.length:0));return f.VY("CreateBlockRangeLocation",ta,ja,Ea,aa,ma)};f.prototype.EDg=function(ja,ta,aa){if(aa=this.iDe(ja,aa)){var ma=f.W4b(ja.getRowNumbers());ja=f.W4b(ja.getColumnNumbers());
ta=excelOnlineCalc.calc.rangePromote(aa,ta,ma,ja);this.caa[this.caa.length]=ta}};f.prototype.GDg=function(ja,ta){if(ta=this.iDe(ja,ta)){var aa=f.W4b(ja.getRowNumbers());ja=f.W4b(ja.getColumnNumbers());ja=excelOnlineCalc.calc.rangeWrite(ta,null,aa,ja);this.caa[this.caa.length]=ja}};f.prototype.t1g=function(ja,ta,aa){var ma=null,Ea=0,Ha=0;switch(ta.valueType){case 2:ma=this.mhd(ta);var Aa=this.mhd(aa);Aa=J.a.equals(Aa,ma,!1);break;case 1:null===ta.value&&null===aa.value?Aa=!0:(Ea=parseFloat(ta.value),
Aa=parseFloat(aa.value)===Ea);break;default:null===ta.value&&null===aa.value?Aa=!0:(Ha=parseFloat(ta.value),Aa=Ha===parseFloat(aa.value))}Aa&&ta.valueType===aa.valueType&&ta.ifmt===aa.ifmt&&ta.formulaType===aa.formulaType&&J.a.equals(aa.formula,ta.formula,!1)||(void 0!==ta.formula&&null!==ta.formula||void 0!==ta.value&&null!==ta.value||void 0!==ta.text&&null!==ta.text?this.xZb(ja,ta,ma,Ea,Ha):this.hme(ja,ta))};f.prototype.$Cg=function(ja){if(this.Ec.vb&&this.Ec.vb.items)for(var ta=0;ta<this.Ec.vb.count;ta++){var aa=
this.Ec.vb.items[ta];if(2===aa.type||3===aa.type){var ma=0,Ea=aa.name,Ha=Ea.lastIndexOf("!");if(0<Ha){ma=Ea.substr(0,Ha);"'"===ma.charAt(0)&&(ma=ma.substr(1,ma.length-2));ma=this.zgd(ma,this.currentStateId);if(-1===ma){z.ULS.sendTraceTag(595096334,0,15,"CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets "+(this.Se.kb(this.currentStateId)&&this.Se.na(this.currentStateId).xj?this.Se.na(this.currentStateId).xj.length:0));continue}Ea=Ea.substr(Ha+1)}ma=this.Se.na(this.currentStateId).xj[ma].d6;
var Aa=aa.usedRange;2===aa.type&&(Aa=L.a(aa));if(ma.kb(Ea)){if(Ha=ma.na(Ea),Ha.range=Aa,Ha.attributes=aa.attributes,2===Ha.type&&(Ea=f.tTe(aa.name,ja),aa=(ma=B.EwaSettings.isChangeGateEnabled("OfficeVSO:6053425_loadHeadersForAllTablesCalc"))?aa.sO:null===Ea||void 0===Ea?void 0:Ea.ColHeadersList,Ea||ma))if(!Ha.kE)Ha.kE=new v(aa);else if(aa)for(aa=ik(aa.HeadersList),Ea=aa.next();!Ea.done;Ea=aa.next())Ea=Ea.value,Ha.kE.J$.ia(Ea.Index,Ea.Name)}else if(Ha=this.Awb(aa.sheetName)){Ha=new u(aa.type,aa.name,
Aa,Ha,aa.attributes);if(2===Ha.type)if(B.EwaSettings.isChangeGateEnabled("OfficeVSO:6053425_loadHeadersForAllTablesCalc")&&aa.sO)Ha.kE=new v(aa.sO);else if(aa=f.tTe(aa.name,ja))Ha.kE=new v(aa.ColHeadersList);ma.ia(Ea,Ha)}else z.ULS.sendTraceTag(537170117,0,50,"CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets "+(this.Se.kb(this.currentStateId)&&this.Se.na(this.currentStateId).xj?this.Se.na(this.currentStateId).xj.length:0))}}};f.prototype.xZb=function(ja,ta,aa,
ma,Ea){var Ha=ja.getRowNumbers()[ta.row]-1;ja=ja.getColumnNumbers()[ta.col]-1;Ha=f.VY("AddRangeUpdateCommand",this.gsb,Ha,ja,Ha,ja);ja=null;var Aa=ta.formula||ta.text,V=excelOnlineCalc.calc.blankValue,La=null;void 0!==ta.text&&null!==ta.text||void 0!==ta.value&&null!==ta.value||(aa="",La="This cell contains blanks only",0===ta.formulaType&&(Aa=""));switch(ta.valueType){case 2:null!==aa&&(0===ta.formulaType&&(ja=excelOnlineCalc.calc.valueCellData(Aa,aa,ta.ifmt,La)),1===ta.formulaType&&(ja=excelOnlineCalc.calc.cellFormulaCellData(Aa,
aa,ta.ifmt,La)),2===ta.formulaType&&(ja=excelOnlineCalc.calc.valueCellData("",V,0,"This cell is a part of an array")));break;case 1:isNaN(ma)?z.ULS.sendTraceTag(537170116,0,50,"CalcAsyncEngine::AddRangeUpdateCommand Cell("+ta.row+","+ta.col+") invalid numeric value"):(0===ta.formulaType&&(ja=excelOnlineCalc.calc.valueCellData(Aa,ma,ta.ifmt,null)),1===ta.formulaType&&(ja=excelOnlineCalc.calc.cellFormulaCellData(Aa,ma,ta.ifmt,null)),2===ta.formulaType&&(ja=excelOnlineCalc.calc.valueCellData("",V,0,
"This cell is a part of an array")));break;case 3:isNaN(Ea)?z.ULS.sendTraceTag(537170115,0,15,"CalcAsyncEngine::AddRangeUpdateCommand Cell("+ta.row+","+ta.col+") invalid boolean value"):(aa=1===Ea?!0:!1,0===ta.formulaType&&(ja=excelOnlineCalc.calc.valueCellData(Aa,aa,ta.ifmt,null)),1===ta.formulaType&&(ja=excelOnlineCalc.calc.cellFormulaCellData(Aa,aa,ta.ifmt,null)),2===ta.formulaType&&(ja=excelOnlineCalc.calc.valueCellData("",V,0,"This cell is a part of an array")));break;case 4:isNaN(Ea)?z.ULS.sendTraceTag(537170114,
0,15,"CalcAsyncEngine::AddRangeUpdateCommand Cell("+ta.row+","+ta.col+") invalid error value"):(aa=excelOnlineCalc.calc.errorValue(Ea),0===ta.formulaType&&(ja=excelOnlineCalc.calc.valueCellData(Aa,aa,ta.ifmt,null)),1===ta.formulaType&&(ja=excelOnlineCalc.calc.cellFormulaCellData(Aa,aa,ta.ifmt,null)),2===ta.formulaType&&(ja=excelOnlineCalc.calc.valueCellData("",V,0,"This cell is a part of an array")));break;default:ja=excelOnlineCalc.calc.valueCellData("",V,ta.ifmt,null)}ja&&(ta=excelOnlineCalc.calc.rangeWrite(Ha,
ja,null,null),this.caa[this.caa.length]=ta)};f.prototype.FDg=function(ja,ta){switch(ta.valueType){case 2:this.xZb(ja,ta,this.mhd(ta),null,0);break;case 1:this.xZb(ja,ta,null,parseFloat(ta.value),0);break;default:this.xZb(ja,ta,null,null,parseFloat(ta.value))}};f.prototype.hme=function(ja,ta){var aa=ja.getRowNumbers()[ta.row]-1;ja=ja.getColumnNumbers()[ta.col]-1;aa=f.VY("AddRangeUpdateCommandEmptyCell",this.gsb,aa,ja,aa,ja);ta=excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,ta.ifmt,
null);ta=excelOnlineCalc.calc.rangeWrite(aa,ta,null,null);this.caa[this.caa.length]=ta};f.prototype.Awb=function(ja){ja=this.zgd(ja,this.currentStateId);return 0<ja?this.Se.na(this.currentStateId).xj[ja].A7.sheetId:null};f.prototype.zgd=function(ja,ta){if(!this.Se.kb(ta))return z.ULS.sendTraceTag(537170113,0,15,"CalcAsyncEngine.GetSheetInternalIndex StateId:"+ta+" does not exist in GridCache"),-1;var aa=this.Se.na(ta);return aa.xj?aa.getSheetIndex(ja):(z.ULS.sendTraceTag(537170112,0,15,"CalcAsyncEngine.GetSheetInternalIndex sheetsInformation == null for StateId:"+
ta),-1)};f.prototype.wuj=function(){if(!this.Se.kb(this.currentStateId)||!this.Se.na(this.currentStateId).xj.length)return z.ULS.sendTraceTag(537170083,0,15,"CalcAsyncEngine::SetSheetNamesAndUsedRanges() No sheets information for StateId:"+this.currentStateId+" or StateId does not exist in GridCache"),!1;for(var ja=[],ta=1;ta<this.Se.na(this.currentStateId).xj.length;ta++){var aa=this.Se.na(this.currentStateId).xj[ta];aa&&ja.push(aa.A7)}this.Nn.updateSheetNames(this.currentStateId,ja);this.Nn.updateUnusedCells(this.currentStateId,
this.Se.na(this.currentStateId).Hcg);return!0};f.prototype.setNumberFormats=function(){if(this.instantaneousSupportInformationManager){for(var ja=[],ta=ik(this.instantaneousSupportInformationManager.qya),aa=ta.next();!aa.done;aa=ta.next())aa=aa.value,aa=excelOnlineCalc.calc.numberFormat(aa.IfmtIndex,aa.FormatString,aa.Builtin),ja.push(aa);this.Nn.setNumberFormats(ja,!0)}};f.prototype.Tqj=function(){if(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.we){var ja=
this.pbi();if(!this.Mtd||ja)this.V4b(),this.instantaneousSupportInformationManager.we.TrueValueString&&(this.trueName=this.instantaneousSupportInformationManager.we.TrueValueString),this.instantaneousSupportInformationManager.we.FalseValueString&&(this.falseName=this.instantaneousSupportInformationManager.we.FalseValueString),ja=T.CalcHelper.dEe(this.instantaneousSupportInformationManager,ja),this.Nn.setLocale(ja),this.Mtd=!0}};f.prototype.kvj=function(){var ja=null;if(void 0!==this.Ec.workbookContext.TimeZoneInformation&&
null!==this.Ec.workbookContext.TimeZoneInformation){ja=null;this.Ec.workbookContext.TimeZoneInformation.StandardDate.Month&&(ja=excelOnlineCalc.date.dateTime(this.Ec.workbookContext.TimeZoneInformation.StandardDate.Year,this.Ec.workbookContext.TimeZoneInformation.StandardDate.Month,this.Ec.workbookContext.TimeZoneInformation.StandardDate.Day,this.Ec.workbookContext.TimeZoneInformation.StandardDate.Hour,this.Ec.workbookContext.TimeZoneInformation.StandardDate.Minute,this.Ec.workbookContext.TimeZoneInformation.StandardDate.Second,
this.Ec.workbookContext.TimeZoneInformation.StandardDate.DayOfWeek+1,this.Ec.workbookContext.TimeZoneInformation.StandardDate.Milliseconds,3));var ta=null;this.Ec.workbookContext.TimeZoneInformation.DaylightDate.Month&&(ta=excelOnlineCalc.date.dateTime(this.Ec.workbookContext.TimeZoneInformation.DaylightDate.Year,this.Ec.workbookContext.TimeZoneInformation.DaylightDate.Month,this.Ec.workbookContext.TimeZoneInformation.DaylightDate.Day,this.Ec.workbookContext.TimeZoneInformation.DaylightDate.Hour,
this.Ec.workbookContext.TimeZoneInformation.DaylightDate.Minute,this.Ec.workbookContext.TimeZoneInformation.DaylightDate.Second,this.Ec.workbookContext.TimeZoneInformation.DaylightDate.DayOfWeek+1,this.Ec.workbookContext.TimeZoneInformation.DaylightDate.Milliseconds,3));ja=excelOnlineCalc.date.tzData(this.Ec.workbookContext.TimeZoneInformation.Bias,ja,this.Ec.workbookContext.TimeZoneInformation.StandardBias,ta,this.Ec.workbookContext.TimeZoneInformation.DaylightBias)}else z.ULS.sendTraceTag(537170082,
0,15,"CalcAsyncEngine.SetWorkbookProperties: TimeZoneInformation is null");ja=excelOnlineCalc.calc.workbookProps(this.Ec.workbookContext.F1904,this.Ec.workbookContext.FDateCompatibility,ja);this.Nn.setWorkbookProps(ja)};f.prototype.Boa=function(){var ja=this;B.EwaSettings.ma(306)&&P.c(excelOnlineCalc.worker.runSmokeTest(1/0,this.I5f,!0)).continueWith(function(Ea){Ea.exception?z.ULS.sendTraceTag(537170079,0,15,"CalcAsyncEngine.TryInitialize: calc smoke test failed: "+Ea.exception.toString()):z.ULS.sendTraceTag(537170080,
0,50,"CalcAsyncEngine.TryInitialize: calc smoke test ended - a new one should start")});var ta=B.EwaSettings.ma(657)?m.local:m.qKj,aa=ik(K.a.vV()?[excelOnlineCalc.x10.PluginSchedulerSingleton.instance(),excelOnlineCalc.x10.GridImportManagerSingleton.instance()]:[void 0,void 0]),ma=aa.next().value;aa=aa.next().value;this.fHd=P.c(excelOnlineCalc.calc.createRecalcService(ta,ma,aa));this.fHd.continueWith(function(Ea){Ea.exception?z.ULS.sendTraceTag(537170075,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker failed: "+
Ea.exception.toString()):(z.ULS.sendTraceTag(537170078,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker is working as expected"),ja.Nn=ja.fHd.result,ja.Nn?ja.pfb(0)?ja.atj():z.ULS.sendTraceTag(537170077,0,15,"CalcAsyncEngine.TryInitialize: UpdateData failed to initialize"):z.ULS.sendTraceTag(537170076,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker result is null"))})};f.prototype.pbi=function(){var ja=this.instantaneousSupportInformationManager.oja;if(!ja||this.ZEd===ja.length)return null;
this.ZEd=ja.length;return T.CalcHelper.QDe(ja)};f.prototype.V4b=function(){this.errorTypeNames=T.CalcHelper.V4b()};f.prototype.rbi=function(){if(!(this.Se.kb(this.currentStateId)&&0<this.Se.na(this.currentStateId).xj.length)){this.Se.ia(this.currentStateId,new l(this.rod));this.Se.na(this.currentStateId).t0f(0,new x(null));for(var ja=this.Ec.xa,ta=0;ta<ja.count;ta++){var aa=Object(F.a)(Q.a,ja.getItem(ta));if(aa){void 0!==aa.sheetId&&null!==aa.sheetId&&void 0!==aa.name&&null!==aa.name&&aa.sheetId.length&&
aa.sheetName.length||z.ULS.sendTraceTag(537170074,0,15,"CalcAsyncEngine::InitializeGridForStateId() invalid sheet - index:"+ta+" Id:"+aa.sheetId+" Hash:"+aa.hash+" NameLength:"+(aa.name?aa.name.length:-1));var ma=excelOnlineCalc.calc.sheetName(aa.sheetId,aa.name);this.Se.na(this.currentStateId).t0f(ta+1,new x(ma));ma=aa.usedRange.pS();ma=excelOnlineCalc.calc.rangeLocation(0,0,ma.LastRow,ma.LastColumn);aa=excelOnlineCalc.calc.unusedCellsUpdate(aa.sheetId,ma);this.Se.na(this.currentStateId).Hcg.push(aa)}else z.ULS.sendTraceTag(537170073,
0,15,"CalcAsyncEngine.InitializeGridForStateId(): not sheet item for StateId:"+this.currentStateId+" sheet-index:"+ta)}}};f.prototype.XYg=function(){for(var ja=ik(this.Se),ta=ja.next();!ta.done;ta=ja.next())ta=ta.value,ta.key<this.ir&&this.Se.remove(ta.key)};f.prototype.mhd=function(ja){ja=ja.value||ja.text;if(void 0===ja||null===ja)ja="";return ja};f.prototype.ucg=function(){if(!this.Se.kb(this.currentStateId))return!1;var ja=!1;D.a.forEach(this.Se.na(this.currentStateId).x_a,function(ta,aa){aa.Gvc||
(ja=!0)},null);return ja};f.prototype.T3c=function(ja){var ta={};ta.reason=ja;ta.kind=1;return ta};f.prototype.shc=function(){return this.Se.kb(this.currentStateId)&&this.Se.na(this.currentStateId).xj&&this.Se.na(this.currentStateId).xj[0]&&this.Se.na(this.currentStateId).xj[0].d6?!0:!1};f.y6g=function(ja){var ta=[];if(null===ja||void 0===ja?0:ja.J$){ja=ik(ja.J$);for(var aa=ja.next();!aa.done;aa=ja.next())aa=aa.value,aa=excelOnlineCalc.calc.columnData(aa.key,aa.value),ta.push(aa)}return ta};f.DEi=
function(ja,ta){if(ja.type!==ta.type||ja.attributes!==ta.attributes||!J.a.equals(ja.fullName,ta.fullName,!1)||!ja.range.equals(ta.range))return!1;if(!ja.kE&&!ta.kE)return!0;if(!ja.kE||!ta.kE||ja.kE.J$.count!==ta.kE.J$.count)return!1;var aa={};ja=ik(ja.kE.J$);for(var ma=ja.next();!ma.done;aa={qgb:aa.qgb,xgb:aa.xgb},ma=ja.next())if(aa.qgb=ma.value,aa.xgb=void 0,!(aa.qgb.value&&function(Ea){return function(){var Ha=ta.kE.J$.yc(Ea.qgb.key);Ea.xgb=Ha.value;return Ha}}(aa)().returnValue&&aa.xgb&&J.a.equals(aa.qgb.value,
aa.xgb,!1)))return!1;return!0};f.zUc=function(ja,ta,aa){var ma=f.VY("NamedObject",ta.sheetId,ta.range.top-1,ta.range.left-1,ta.range.bottom-1,ta.range.right-1);if(2===ta.type){var Ea=!!(ta.attributes&16),Ha=!!(ta.attributes&8);ta=f.y6g(ta.kE);ma=excelOnlineCalc.calc.namedTableData(ma,Ea,Ha,ta);ja=excelOnlineCalc.calc.namedObject(ja,ma)}else ma=excelOnlineCalc.calc.namedRangeData(ma),ja=excelOnlineCalc.calc.namedObject(ja,ma);aa.push(ja)};f.lXe=function(ja){var ta=Sys.Serialization.JavaScriptSerializer.serialize(ja.getRowNumbers());
ja=Sys.Serialization.JavaScriptSerializer.serialize(ja.getColumnNumbers());return ta+ja};f.W4b=function(ja){var ta=null;if(1<ja.length)for(var aa=1;aa<ja.length;aa++)for(var ma=0;ja[aa-1]+1+ma<ja[aa];)ta=ta||[],ta.push(ja[aa-1]+ma),ma++;return ta};f.tTe=function(ja,ta){if(!ta)return null;for(var aa=0,ma=ta.length;aa<ma;++aa)if(J.a.equals(ja,ta[aa].Name,!1))return ta[aa];return null};f.VY=function(ja,ta,aa,ma,Ea,Ha){function Aa(V,La,Ra,pb){(0>Ra||Ra>=pb)&&z.ULS.sendTraceTag(537170072,0,15,"CalcAsyncEngine::CreateSheetRangeLocation() callerId:"+
V+" invalid "+La+":"+Ra)}void 0!==ta&&null!==ta||z.ULS.sendTraceTag(537170071,0,15,"CalcAsyncEngine::CreateSheetRangeLocation() callerId:"+ja+" sheetId is null");Aa(ja,"top",aa,f.Spf);Aa(ja,"left",ma,f.cwd);Aa(ja,"bottom",Ea,f.Spf);Aa(ja,"right",Ha,f.cwd);return excelOnlineCalc.calc.sheetRangeLocation(ta,aa,ma,Ea,Ha)};f.Spf=1048576;f.cwd=16384;Object(t.a)(f,"CalcAsyncEngine",null,[6]);Object(t.a)(n,"AbsoluteRelativeReferenceInfo",null,[]);var ea=b(1196),ia=b(24);k.$Hf="#";Object(t.a)(k,"Operators",
null,[]);var da=b(1197);h.sheet="Sheet";h.sheetRange="SheetRange";h.document="Document";h.b9h="Ident";Object(t.a)(h,"TraverseFormulaQualifierTypes",null,[]);var xa=b(1198),Z=b(1093),ha=b(1012),ya=b(41),va=b(58),bb=b(63),ba=b(450),fa=b(38),ra=Sys.EventArgs;$k(e,ra);Object(t.a)(e,"EditedCellRecalcCompleteEventArgs",Sys.EventArgs,[]);var pa=fa.a;$k(d,pa);d.prototype.TFg=function(ja){this.addHandler(d.L7c,ja)};d.prototype.vcj=function(ja){this.removeHandler(d.L7c,ja)};d.prototype.Esf=function(ja){this.raiseEvent(d.L7c,
new e(ja))};d.prototype.dispose=function(){var ja=this;z.ULS.sendTraceTag(537170064,0,50,"CalcManager.Dispose called");this.$.da.Za(268,function(ta){ta.xJd(ja.Snc);ta.oJd(ja.ync)});this.gridView&&(this.gridView.ny(this.onContentReady),this.gridView.Ea&&this.gridView.Ea.lQf(this.Muf),this.qp=null);this.bGc=null};d.prototype.MUg=function(ja,ta,aa,ma){ma=void 0===ma?null:ma;this.Ls&&(B.EwaSettings.isChangeGateEnabled("OfficeVSO:5470583_Calculate_Formula_Refactoring")?this.Ls.JUg(ja,ta,aa,ma):this.Ls.LUg(ja,
ta,aa,ma))};d.prototype.evalFormula=function(ja,ta,aa,ma){return this.Ls?this.Ls.evalFormula(ja,ta,aa,ma):Promise.reject("calc engine not initialized")};d.prototype.Etb=function(ja,ta,aa,ma){return this.Ls?this.Ls.Etb(ja,ta,aa,ma):Promise.reject("CalcEngine is null")};d.prototype.G4a=function(ja){return this.Ls?(z.ULS.shipAssertTag(537170059,0,2===ja.type,"CalcManager.GetTableHeaders() - ActiveItem is not a table"),this.Ls.G4a(ja)):null};d.prototype.eKg=function(ja,ta){if(!ta||2!==ja.type)return!1;
ja=L.a(ja);return ja.right-ja.left+1===ta.count};d.prototype.ZRe=function(ja){if(!this.qGb)return this.Ugg||z.ULS.sendTraceTag(537170057,0,15,"CalcManager.ExtractReferenceWrappers - parser not initialized"),null;var ta=this.cta(ia.Range.Qc(1,1));ta=this.qGb.parseFormula(excelOnlineCalc.parse.parseLocals(1,ta.range),ja);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(ta))return z.ULS.sendTraceTag(537170056,0,10,"CalcManager.ExtractReferenceWrappers - ParseFormula failed"),null;try{if(B.EwaSettings.isChangeGateEnabled("OfficeVSO:6518739_FlightRemovalStructuredReferencesHighlighting")){var aa=
this.gridView.ha.sa.activeCell,ma=excelOnlineCalc.location.gridCell(aa.top-1,aa.left-1),Ea=excelOnlineCalc.location.documentLoc("",this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),Ha=excelOnlineCalc.location.sheetIndex(Ea,this.$.xa.pa.sheetId),Aa=this.R$g(ma,Ha);this.CLd||(this.CLd=excelOnlineCalc.util.createResolver(this.Q$g()));var V=excelOnlineCalc.parse.parseResultHelper.extractReferences(ta,this.Dr.config.localeInfo,B.EwaSettings.ma(594),Aa,this.CLd)}else V=excelOnlineCalc.parse.parseResultHelper.extractReferences(ta,
this.Dr.config.localeInfo,B.EwaSettings.ma(594));B.EwaSettings.ma(103)&&this.wUj(V,ja);return V}catch(La){return z.ULS.sendTraceTag(537170055,0,10,"CalcManager.ExtractReferenceWrappers - exception: "+La.message),null}};d.prototype.extractLetVariables=function(ja,ta){if(!this.qGb)return this.Ugg||z.ULS.sendTraceTag(537170054,0,15,"CalcManager.ExtractLetVariables - parser not initialized"),null;var aa=this.cta(ia.Range.Qc(1,1));ja=this.qGb.parseFormula(excelOnlineCalc.parse.parseLocals(1,aa.range),
ja);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(ja))return z.ULS.sendTraceTag(537170053,0,10,"CalcManager.ExtractLetVariables - ParseFormula failed"),null;try{return excelOnlineCalc.parse.parseResultHelper.extractLetVariables(ja,ta,this.Dr.config.localeInfo)}catch(ma){return z.ULS.sendTraceTag(537170052,0,10,"CalcManager.ExtractLetVariables - exception: "+ma.message),null}};d.prototype.extractReferences=function(ja,ta,aa,ma){if(!ta)return z.ULS.sendTraceTag(537170051,0,10,"CalcManager.ExtractReferences - sheetName is null"),
null;if(!aa)return z.ULS.sendTraceTag(537170050,0,10,"CalcManager.ExtractReferences - documentName is null"),null;var Ea=this.ZRe(ja);if(!Ea)return z.ULS.sendTraceTag(537170049,0,15,"CalcManager.ExtractReferences - ExtractReferenceWrappers returned null"),null;try{return this.Q9g(Ea,ta,aa,ja,ma)}catch(Ha){return z.ULS.sendTraceTag(537170048,0,10,"CalcManager.ExtractReferences - exception: "+Ha.message),null}};d.prototype.xZh=function(ja,ta,aa,ma){if(!ja)return z.ULS.sendTraceTag(537170019,0,10,"CalcManager.GetSubExpressionSpanForContextualFormulaPreview - range is null"),
null;if(!ta||0>=ta.length)return z.ULS.sendTraceTag(537170018,0,10,"CalcManager.GetSubExpressionSpanForContextualFormulaPreview - formula is null/empty"),null;ja=this.cta(ja);if(!this.Dr||!ja)return null;var Ea=this.jvb(ja).returnValue;if(!Ea||Ea.l6a)return null;aa=excelOnline.utils.getCharIndexInTextFromPoint(aa,ma,B.EwaSettings.ma(594));return 0>aa?null:excelOnlineCalc.runtime.getSubExpressionFromFormulaCharacterIndex(this.Dr.config,aa,ta,ja)};d.prototype.zUg=function(ja,ta,aa,ma){var Ea=this;if(!ja)return z.ULS.sendTraceTag(537170017,
0,10,"CalcManager.CalcPartialResultsForFormula - range is null"),null;var Ha=null;return this.evalFormula(ta,ja,void 0,excelOnlineCalc.calc.evalFormulaFormatOrigin()).then(function(Aa){var V=Ea.Dr.xnh(Aa,aa),La=V.returnValue;8!==V.kind||La.length&&La!==T.CalcHelper.unknownError?Aa=0:(z.ULS.sendTraceTag(537170016,0,50,"EvalSession.GetPartialResultValueForFormula - EvalResultToString error"),Aa=excelOnlineCalc.calc.getEvalFailureReason(Aa),void 0!==Aa&&null!==Aa||z.ULS.shipAssertTag(537170015,0,!1,
"CalcHelper.GetEvalFailureReason() - result is not a failure, function should not be called"),Aa=1);return Ha=ma?new ea.a(La,ma.start,ma.end,Aa):new ea.a(La,-1,-1,Aa)},function(Aa){z.ULS.sendTraceTag(537170014,0,10,"EvalSession.GetPartialResultValueForFormula - exception: "+Aa);return Promise.resolve(Ha)})};d.prototype.getSubExpressionSpan=function(ja){return this.Dr&&ja?excelOnlineCalc.runtime.getSubExpressionSpan(ja):null};d.prototype.getFormulaSubExpressionObject=function(ja,ta,aa){return this.Dr&&
ja&&ta&&aa?excelOnlineCalc.runtime.getFormulaSubExpressionObject(this.Dr.config,ta,aa,this.cta(ja)):null};d.prototype.AZh=function(ja,ta,aa){return this.Dr&&ja&&ta?excelOnlineCalc.runtime.getSubstitutedSubExpressionString(this.Dr.config,ta,aa,this.cta(ja)):null};d.prototype.yZh=function(ja,ta,aa){return this.Dr&&ja&&ta?excelOnlineCalc.runtime.getSubExpressionSubspans(this.Dr.config.localeInfo,ta,aa):null};d.prototype.ESh=function(){return this.Dr?this.Dr.config.localeInfo.listSeparator:null};d.prototype.isFormulaSubExpressionVolatile=
function(ja){return this.Dr?excelOnlineCalc.runtime.isFormulaSubExpressionVolatile(this.Dr.config.localeInfo,ja):!1};d.prototype.cta=function(ja,ta){ta=void 0===ta?!0:ta;return ja&&this.Dr?this.Dr.oah(this.Dr.dch(),ja.top-1,ja.left-1,ta):null};d.prototype.jji=function(ja,ta){ja=this.$bc(ja);if(void 0===ja||null===ja)return null;ja=this.QC.createFormat(ja.FormatString,ja.Builtin);if(!excelOnlineCalc.util.isSuccess(ja))return null;ta=this.QC.parseEdit(ta,ja.value);return excelOnlineCalc.util.isSuccess(ta)?
ta.value.kind===Z.a.formula:null};d.prototype.Ybc=function(ja){if(null==this.QC)return Object(ba.a)("Number formatter is null");if(null==this.instantaneousSupportInformationManager)return Object(ba.a)("Instantaneous manager is null");if(this.Hyd.has(ja))return Object(ba.d)(this.Hyd.get(ja));if("number"===typeof ja){var ta=this.$bc(ja);if(null==ta)return Object(ba.a)("Invalid ifmt="+ja);var aa=ta.FormatString;ta=ta.Builtin}else aa=ja,ta=!1;aa=this.QC.createFormat(aa,ta);return excelOnlineCalc.util.isSuccess(aa)?
(this.Hyd.set(ja,aa.value),Object(ba.d)(aa.value)):Object(ba.a)("Could not create number format")};d.prototype.getWorksheetFuncId=function(ja){return this.localeInfo.getWorksheetFuncId(ja)};d.prototype.Q9g=function(ja,ta,aa,ma,Ea){for(var Ha={Items:[]},Aa=0;Aa<ja.length;Aa++){var V=ja[Aa],La={};La.Start=V.span.start;La.End=V.span.end;if(Ea||V.kind!==da.a.func)if(Ea||V.kind!==da.a.Mti){if(this.Oih(V,ta,aa)){var Ra=new n,pb=this.rWh(V,ta,Ra,ma);if(B.EwaSettings.ma(594)){var cb=this.vSh(V),Sa=this.uSh(V);
if(pb||Sa&&0<=cb)La={Span:La,LetNumber:cb,LetName:Sa,Range:pb},La.IsRangeRef=Ra.cxa,La.IsAbsoluteFirstRow=Ra.ZZ,La.IsAbsoluteFirstColumn=Ra.YZ,La.IsAbsoluteSecondRow=Ra.T4,La.IsAbsoluteSecondColumn=Ra.S4,La.IsStructRef=V.kind===da.a.tUd,Ha.Items.push(La)}else pb&&(La={Span:La,Range:pb},La.IsRangeRef=Ra.cxa,La.IsAbsoluteFirstRow=Ra.ZZ,La.IsAbsoluteFirstColumn=Ra.YZ,La.IsAbsoluteSecondRow=Ra.T4,La.IsAbsoluteSecondColumn=Ra.S4,La.IsStructRef=V.kind===da.a.tUd,Ha.Items.push(La))}}else V=V.ref.value.oper.kind,
Ha.Items.push({Span:La,IsString:2===V,IsBoolean:4===V,IsNumber:1===V});else La.End=V.span.start+V.ref.name.length,V={Span:La,IsFunction:!0},V.FunctionId=this.getWorksheetFuncId(ma.substring(La.Start,La.End)),Ha.Items.push(V)}Ha.Items.sort(function(Db,Ab){return Db.Span.Start-Ab.Span.Start});return Ha};d.prototype.vSh=function(ja){return ja.kind===da.a.Fkf?ja.ref.number:-1};d.prototype.uSh=function(ja){return ja.kind===da.a.Fkf?ja.ref.name:null};d.prototype.rWh=function(ja,ta,aa,ma){if(ja.kind===da.a.range)return aa.cxa=
!0,this.fCe(ja,ta,aa,ma);if(ja.kind===da.a.namedRange){aa=ja.ref;(ja=this.$.vb.getItemByName(aa.name))||(ja=this.$.vb.getItemByName(ta+"!"+aa.name));if(!(ja&&ja.sheetName&&ja.usedRange&&J.a.equals(ja.sheetName,ta,!0)))return null;ta=2===ja.type?L.a(ja):ja.usedRange;return ya.m(ta,ja)}if(ja.kind===da.a.tUd){var Ea=ja.ref,Ha;Ea.name?(Ha=this.$.vb.getItemByName(Ea.name))||(Ha=this.$.vb.getItemByName(ta+"!"+Ea.name)):Ha=this.gridView.Ab.dk(this.gridView.ha.sa.activeCell);if(!(Ha&&Ha.sheetName&&Ha.usedRange&&
J.a.equals(Ha.sheetName,ta,!0)))return null;aa.cxa=!1;return this.fCe(ja,ta,aa,ma)}return null};d.prototype.fCe=function(ja,ta,aa,ma){ja=ja.ref;if(ja.type){if(ja.type===xa.a.column){var Ea=ja.startIndex;ja=ja.endIndex;aa.YZ=Ea.kind===ha.a.abs;aa.S4=ja.kind===ha.a.abs;return this.createRange(0,Ea.index,w.a.uh,ja.index,ta)}if(ja.type===xa.a.row)return Ea=ja.endIndex,aa.ZZ=ja.startIndex.kind===ha.a.abs,aa.T4=Ea.kind===ha.a.abs,this.createRange(ja.startIndex.index,0,ja.endIndex.index,w.a.Eh,ta);if(ja.type===
xa.a.cell){Ea=ja.row;var Ha=ja.col;aa.ZZ=aa.T4=Ea.kind===ha.a.abs;aa.YZ=aa.S4=Ha.kind===ha.a.abs;return this.q2b(ja.span.end,ma)&&(aa=ia.Range.Qc(Ea.index+1,Ha.index+1),aa=this.gridView.Ab.L2e(aa))?ya.n(aa,ta):this.createRange(Ea.index,Ha.index,Ea.index,Ha.index,ta)}if(ja.type===xa.a.range){Ea=ja.top;Ha=ja.left;ma=ja.bottom;ja=ja.right;var Aa=Math.min(Ea.index,ma.index),V=Math.min(Ha.index,ja.index),La=Math.max(Ea.index,ma.index),Ra=Math.max(Ha.index,ja.index);aa.ZZ=Ea.kind===ha.a.abs;aa.T4=ma.kind===
ha.a.abs;aa.YZ=Ha.kind===ha.a.abs;aa.S4=ja.kind===ha.a.abs;return this.createRange(Aa,V,La,Ra,ta)}z.ULS.sendTraceTag(537170010,0,10,"CalcManager.CovertFormulaRefToRange: Unsupported formula ref type '"+ja.type+"'");return null}z.ULS.sendTraceTag(537170011,0,15,"CalcManager.CovertFormulaRefToRange: traverseFormulaRef.Type is null");return null};d.prototype.q2b=function(ja,ta){return ta.length>=ja&&0<ja&&ta.charAt(ja-1)===k.$Hf};d.prototype.GUg=function(ja,ta,aa){this.Ls&&this.Ls.KUg(ja,ta,aa)};d.prototype.$bc=
function(ja){return this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.qya&&this.instantaneousSupportInformationManager.qya[ja]&&this.QC?this.instantaneousSupportInformationManager.qya[ja]:null};d.prototype.toXLNumber=function(ja){if(!this.QC)return null;ja=excelOnlineCalc.numfmt.toXLNumber(this.config.mathpack,this.QC,ja);return excelOnlineCalc.util.isSuccess(ja)?ja.value:null};d.prototype.wUj=function(ja,ta){if(ja){ja=ik(ja);for(var aa=ja.next();!aa.done;aa=
ja.next())if(aa=aa.value,aa.ref.type&&aa.ref.type===xa.a.cell){var ma=aa.ref;d.o0i(ma,ta)&&(ma.span.end+=1,aa.span.end+=1)}}};d.prototype.createRange=function(ja,ta,aa,ma,Ea){var Ha={};Ha.FirstRow=ja;Ha.FirstColumn=ta;Ha.LastRow=aa;Ha.LastColumn=ma;Ha.SheetName=Ea;return Ha};d.prototype.Oih=function(ja,ta,aa){var ma=ja.ref.qualifier;if(!ma)return!0;switch(ja.ref.qualifier.type){case h.sheet:return ja=ma.document,J.a.equals(ma.sheet,ta,!0)&&(!ja||J.a.equals(ja.document,aa,!0));case h.sheetRange:return ta=
this.$.xa.getItemByName(ta),aa=this.$.xa.getItemByName(ma.sheet1),ma=this.$.xa.getItemByName(ma.sheet2),!!ta&&!!aa&&!!ma&&(aa.index<=ta.index&&ta.index<=ma.index||ma.index<=ta.index&&ta.index<=aa.index);case h.document:return J.a.equals(ma.document,aa,!0);case h.b9h:return ma=ma.name,J.a.equals(ma,ta,!0)||J.a.equals(ma,aa,!0);default:return z.ULS.sendTraceTag(537170009,0,10,"CalcManager.GetQualifierData: Unsupported formula qualifier type '"+ma.type+"'"),!1}};d.prototype.WOj=function(ja){this.instantaneousSupportInformationManager=
ja;ja.qya.length&&ja.oja.length?(this.bGc=new T.CalcHelper(this.gridView.$),this.qGb=this.Dr.createParser(),this.ece=this.Dr.createNumberFormatter(),this.Xfc=!0,z.ULS.sendTraceTag(537170007,0,50,"CalcManager.TryInitializeInternal: calc initialized"),this.Ls||(z.ULS.sendTraceTag(537170006,0,50,"CalcManager creating calc engine"),this.Ls=new f(this.$))):z.ULS.sendTraceTag(537170008,0,15,"CalcManager.TryInitializeInternal: IInstantaneousSupportInformationManager locale information missing, cannot initialize calc. number formats count = "+
ja.qya.length+", functions info count = "+ja.oja.length.toString())};d.prototype.jvb=function(ja){if(!ja)return{returnValue:null,emptyCell:!1};var ta=this.getSheetName(ja.sheet.index);if(!ta)return z.ULS.sendTraceTag(537169998,0,50,"CalcManager.GetCellFromBlockCache: No sheet index "+ja.sheet.index),{returnValue:null,emptyCell:!1};var aa=d.convertToRange(ja);ta=this.gridView.jvb(ta,aa.top,aa.left);return ta?ta.Iih?{returnValue:ta,emptyCell:!1}:(z.ULS.sendTraceTag(537169996,0,50,"CalcManager.GetCellFromBlockCache: cell "+
ja.range.row+" "+ja.range.col+" is empty"),{returnValue:null,emptyCell:!0}):(z.ULS.sendTraceTag(537169997,0,50,"CalcManager.GetCellFromBlockCache: cellProxy is null for cell "+ja.range.row+" "+ja.range.col),{returnValue:null,emptyCell:!1})};d.prototype.getSheetName=function(ja){var ta=this.gridView.$.xa.getItem(ja);return ta?ta.sheetName:(z.ULS.sendTraceTag(537169995,0,50,"CalcManager.GetSheetName - no sheet in index "+ja),null)};d.prototype.R$g=function(ja,ta){var aa={allowUnqualifiedCell:!0,wrapCellReferences:!0};
aa.config=this.Dr.config;aa.originGridCell=excelOnlineCalc.util.success(ja);aa.originSheet=excelOnlineCalc.util.success(ta);return aa};d.prototype.Q$g=function(){var ja={};ja.config=this.Dr.config;ja.getNameLoc=this.Ls.getNameLoc;ja.getContainingTable=this.Ls.getContainingTable;ja.getStructRefColumn=this.Ls.getStructRefColumn;ja.getStructRefSpecialRef=this.Ls.getStructRefSpecialRef;ja.getDocumentLoc=this.Ls.getDocumentLoc;ja.getSheetIndex=this.Ls.getSheetIndex;ja.getSheetName=this.Ls.getSheetName;
ja.getUserDefinedFuncLoc=this.Ls.getUserDefinedFuncLoc;ja.getSheetRangeIndexes=this.Ls.getSheetRangeIndexes;return ja};d.o0i=function(ja,ta){return ta.length>ja.span.end&&ta.charAt(ja.span.end)===k.$Hf};d.convertToRange=function(ja){return ia.Range.Qc(ja.range.row+1,ja.range.col+1)};of.Object.defineProperties(d.prototype,{Dr:{configurable:!0,enumerable:!0,get:function(){return this.bGc}},gridView:{configurable:!0,enumerable:!0,get:function(){return this.qp}},$:{configurable:!0,enumerable:!0,get:function(){return this.ib}},
QC:{configurable:!0,enumerable:!0,get:function(){return this.ece}},localeInfo:{configurable:!0,enumerable:!0,get:function(){return this.Dr?this.Dr.config.localeInfo:null}},config:{configurable:!0,enumerable:!0,get:function(){return this.Dr.config}}});d.L7c="ECRC";Object(t.a)(d,"CalcManager",fa.a,[851,6]);var Za=b(37),Ua=b(53),Ma=y.a;$k(c,Ma);c.prototype.create=function(){var ja=this;if(this.$){z.ULS.sendTraceTag(537169993,0,50,"CalcManagerFactory.Create: Start loading script");if(B.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")){var ta=
75;var aa="Current"}else ta=78,aa="Stable";z.ULS.sendTraceTag(537169992,0,50,"CalcManagerFactory.Create: Calc "+aa+" JS was loaded");Za.TaskExtensions.Aa(Ua.a.loadScript(ta,4,this.hb,void 0,void 0,265),function(){z.ULS.sendTraceTag(537169991,0,50,"CalcManagerFactory.Create: Raised create service event");var ma=ja.$.da.za(266,!1);ma||(z.ULS.sendTraceTag(537169990,0,50,"CalcManagerFactory.Create: CalcManager is not registered, creating new CalcManager"),ma=new d(ja.$),B.EwaSettings.isChangeGateEnabled("OfficeVSO:6143820_MoveServiceRegistrationFromFAM_V2")&&
ja.$.da.Ga(266,ma));ja.pb(ma)},this.la,3)}else z.ULS.sendTraceTag(537169994,0,50,"CalcManagerFactory.Create: ewaControl is null, cann't create the service")};c.ka=function(ja){ja&&ja.da&&ja.da.Ga(265,new c(ja))};Object(t.a)(c,"CalcManagerFactory",y.a,[]);var oa=b(10);b.d(E,"a",function(){return a})},1417:function(t,E,b){function a(){k.a.Fa(c.ka)}function c(B){var Q=O.call(this)||this;Q.$=B;Q.Eb();return Q}function d(B,Q){var U=K.call(this)||this;U.oNa=l.a.Ee;U.xZc=null;U.rjc=!1;U.Xfb=!1;U.Stf=function(X,
P){var ea;(X=G.g(U.$))&&(P=null!==(ea=null===P||void 0===P?void 0:P.cell)&&void 0!==ea?ea:X.Ub(null))&&U.ATa(P.cell.Zk,!0)};U.bMi=function(X){U.isActive()&&(J.a.Tq(X.Errors)||!X.Result?n.ULS.sendTraceTag(537155726,0,50,"GetCategoryFromServer failed, ignoring - server errors: "+(X.Errors?X.Errors.join(","):"None")):(X=X.Result,n.ULS.sendTraceTag(537155725,0,50,"Updating number format category cache, format index = "+X.Index+", category = "+X.Category),U.Xsj(X.Index,X.Category),U.raiseEvent(d.z_c,new A.a(X.Index,
X.Category),U)))};U.refresh=function(){n.ULS.sendTraceTag(537155722,0,50,"InstantaneousSupportInformationManager.Refresh: start refresh");U.c2b();U.isActive()&&U.ea.ic.allowEdits&&(U.Xfb||U.en&&!(U.ea.Njc>U.oNa)?U.oDc():(n.ULS.sendTraceTag(537155721,0,50,"InstantaneousSupportInformationManager.Refresh: getting instantaneous support information."),U.Zed=w.a(U.$.oa.va,U.en?U.en.Digest:"",U.KMi,U.JMi,null,null)),n.ULS.sendTraceTag(537155720,0,50,"InstantaneousSupportInformationManager.Refresh: getting functions info."),
U.BZe())};U.Zxf=function(X){n.ULS.sendTraceTag(537155716,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListFailed failed, status = "+X.data.status+", HTTP status = "+X.data.httpStatus+".");U.lKa=null};U.V_=function(){U.Xfb=!1;U.ea.jD(U.V_);U.cRa(U.rjc?d.NQd:d.dyd)};U.Uc=function(X,P){n.ULS.sendTraceTag(537155715,0,50,"InstantaneousSupportInformationManager.OnSessionIdChanged called");z.a(P)&&U.cRa(d.NQd)};U.Sf=function(){n.ULS.sendTraceTag(537155714,0,50,"InstantaneousSupportInformationManager.OnWorkbookMetadataChanged called");
3!==U.$.workbookContext.CalcMode&&U.qyd(0===U.$.workbookContext.CalcMode)};U.Yc=function(){n.ULS.sendTraceTag(537155713,0,50,"InstantaneousSupportInformationManager.OnWorkbookOpened called");U.cRa(d.NQd);S.EwaSettings.ma(302)&&3!==U.$.workbookContext.CalcMode&&U.qyd(0===U.$.workbookContext.CalcMode)};U.CMi=function(X,P,ea){n.ULS.sendTraceTag(537155712,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess called.");U.lKa=null;U.isActive()?X.StateId===l.a.Ee?(n.ULS.sendTraceTag(537155682,
0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: no session, waiting for session."),U.oDc()):!X.Result||U.MX&&U.MX.length?U.cRa(d.dyd):U.GBf(X,P,ea):n.ULS.sendTraceTag(537155683,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: manager is inactive, skipping.")};U.GBf=function(X){U.MX=X.Result;n.ULS.sendTraceTag(537155681,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess refreshing functions info list, returned "+(U.MX?U.MX.length:-1)+
" functions.");X=!1;if(U.MX){for(var P=ik(U.MX),ea=P.next();!ea.done;ea=P.next())if(ea=ea.value)U.vVe[ea.NameUI.toLocaleUpperCase()]=ea.FunctionIndex.toString(),ea.NameUI!==ea.NameDataStrings&&(U.vVe[ea.NameDataStrings.toLocaleUpperCase()]=ea.FunctionIndex.toString(),X=!0),U.EFh.ia(ea.FunctionIndex,ea.NameUI);U.raiseEvent(d.ccd,Sys.EventArgs.Empty,U)}X&&n.ULS.sendTraceTag(537155680,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess NameDataStrings functions names were used.")};
U.KMi=function(X){if(U.isActive())if(n.ULS.shipAssertTag(537155679,0,!!U.$,"null ewaControl"),U.rjc=!1,U.oNa=X.StateId,U.oNa===l.a.Ee)U.rjc=!0,U.oDc();else{if(X.Result){var P=U.en;U.en=X.Result;n.ULS.sendTraceTag(537155678,0,50,"InstantaneousSupportInformation updated, new result digest: "+U.en.Digest+".");X=[];if(P)X=d.jTh(P.NumberFormats,U.en.NumberFormats);else for(P=0;P<U.en.NumberFormats.length;P++)U.xmc.ia(P,U.en.NumberFormats[P].NumberFormatCategory);P=ik(X);for(var ea=P.next();!ea.done;ea=
P.next())ea=ea.value,U.xmc.ia(ea,U.en.NumberFormats[ea].NumberFormatCategory);U.raiseEvent(d.Myd,new h(X),U);S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StructuredReferencesInRangePicker",!1)&&U.raiseEvent(d.Dlf)}U.cRa(d.dyd)}};U.JMi=function(X){U.isActive()&&(10===X.data.status?n.ULS.sendTraceTag(537155677,0,50,"Instantaneous support information request cancelled."):(n.ULS.sendTraceTag(21311555,0,10,"Failed to update instantaneous support information, status = "+X.data.status+", HTTP status = "+
X.data.httpStatus+"."),U.rjc=!0,U.oDc()))};n.ULS.sendTraceTag(537155737,0,50,"InstantaneousSupportInformationManager ctor start");U.ea=B;U.$=Q;U.aIb=null;U.Zed=null;U.lKa=null;U.en=null;U.xmc=new I.a;U.ivb=new I.a;U.MX=[];U.EFh=new I.a;U.vVe={};U.ea.Vj(U.Uc);U.$.Uk(U.Yc);G.g(U.$).ha.Rga(U.Stf);S.EwaSettings.ma(302)&&U.ea.Bu(U.Sf);U.cRa(d.L9e);n.ULS.sendTraceTag(537155736,0,50,"InstantaneousSupportInformationManager ctor end");return U}function e(B){this.data=B}function h(B){var Q=D.call(this)||this;
Q.J1j=B;return Q}var k=b(10);t=b(0);var n=b(15),f=b(235),v=b(87),m=b(4),x=b(192),l=b(9),u=b(38),A=b(1092),z=b(238),y=b(62),w=b(1091),D=Sys.EventArgs;$k(h,D);Object(t.a)(h,"NumberFormatsUpdatedEventArgs",Sys.EventArgs,[]);var H=b(47),F=b(45);b(34);var J=b(31),S=b(1),N=b(719);b(22);var T=b(298),G=b(21);b(211);Object(t.a)(e,"NumberFormatDataHolder",null,[]);var I=b(171),K=u.a;$k(d,K);d.prototype.Vne=function(B){this.addHandler(d.Myd,B)};d.prototype.xJd=function(B){this.removeHandler(d.Myd,B)};d.prototype.pFg=
function(B){this.addHandler(d.z_c,B)};d.prototype.Ubj=function(B){this.removeHandler(d.z_c,B)};d.prototype.zne=function(B){this.addHandler(d.ccd,B)};d.prototype.oJd=function(B){this.removeHandler(d.ccd,B)};d.prototype.SGg=function(B){this.addHandler(d.Dlf,B)};d.prototype.ATa=function(B,Q){var U=this.xmc.yc(B,0);var X=U.value;U=U.returnValue;!U&&0<B&&this.$&&(n.ULS.sendTraceTag(537155735,0,50,"InstantaneousSupportInformationManager.TryGetNumberFormatCategory: failed to get category from numberFormatIndexToCategoryCache "+
B),this.fLh(B),Q&&(X=this.eLh(B),U=!0),N.a(B,this.$.$F)&&(X=6));return{returnValue:U,category:X}};d.prototype.fji=function(B){var Q=this.ATa(B,!0);var U=Q.category;if(Q.returnValue)return 6===U;n.ULS.sendTraceTag(537155733,0,50,"InstantaneousSupportInformationManager.IsFormatInPercentageCategory: failed to get category from format index "+B);return!1};d.prototype.cEh=function(B){n.ULS.sendTraceTag(537155730,0,50,"InstantaneousSupportInformationManager.ForceRefreshFunctionInfo: Forcing refresh of functions");
this.lKa=y.p(this.$.oa.va,{FilterType:0},T.b(this.GBf,B),this.Zxf,null,null,null)};d.prototype.NUe=function(){this.cRa(d.L9e)};d.prototype.qyd=function(B){this.xZc=B};d.prototype.fLh=function(B){if(this.ivb&&this.$){var Q=this.ivb.yc(B);var U=Q.value;if(!Q.returnValue||U.isCompleted)n.ULS.sendTraceTag(537155728,0,50,"Getting number format category for format index: "+B),(U=w.b(this.$.oa.va,B,this.bMi,null,null,null))&&this.ivb.ia(B,U)}else n.ULS.sendTraceTag(537155729,0,15,"GetCategoryFromServerAsync called on disposed InstantaneousSupportInformationManager instance, skipping")};
d.prototype.eLh=function(B){return 1<=B&&8>=B?1:9<=B&&12>=B?2:13===B||14===B?6:15===B?8:17===B|18===B?7:19===B?4:16===B||20<=B&&29>=B||31===B?11:30===B?9:32<=B&&35>=B?3:0};d.prototype.isActive=function(){var B=void 0===this.ea||null===this.ea,Q=!B&&this.ea.dc;n.ULS.sendTraceTag(537155727,0,50,"InstantaneousSupportInformationManager.IsActive: instantaneous support information manager active:"+Q+" - sessionStateManager IsNullOrUndefined: "+B);return Q};d.prototype.Xsj=function(B,Q){this.xmc.ia(B,Q)};
d.prototype.dispose=function(){v.a.Ia(this.aIb);this.aIb=null;this.c2b();for(var B=ik(this.ivb),Q=B.next();!Q.done;Q=B.next())(Q=Q.value.value)&&!Q.isCompleted&&m.AFrameworkApplication.nd.mu(Q.Gt);this.ivb=null;this.ea&&(this.ea.wk(this.Uc),this.Xfb&&this.ea.jD(this.V_),this.Xfb=!1,this.ea.Ew(this.Sf));this.ea=null;this.$&&G.g(this.$)&&G.g(this.$).ha&&(G.g(this.$).ha.Sma(this.Stf),this.$.sl(this.Yc));this.$=null;K.prototype.dispose.call(this)};d.prototype.isFeatureEnabled=function(B){try{switch(B){case "LocaleLongDateFormat":return S.EwaSettings.ma(197);
case "GetLocaleDayNames":return S.EwaSettings.ma(198);case "CalculateTextWidthIgnoreLetterSpacing":return S.EwaSettings.ma(284);case "OfficeVSO:3657744_CalcFixForDateFormat":return S.EwaSettings.isChangeGateEnabled("OfficeVSO:3657744_CalcFixForDateFormat");case "OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero":return S.EwaSettings.isChangeGateEnabled("OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero");case "CalcAutocompleteExperiment":return S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",
!1);case "CalcNewFunctions":return S.EwaSettings.ma(247);case "CalcContractChecks":return S.EwaSettings.ma(248);case "CalcSupportDynamicArrays":return S.EwaSettings.ma(249);case "CalcFormatCalculations":return S.EwaSettings.ma(250);case "CalcFormulaCacheAPIChanges":return S.EwaSettings.ma(251);case "CalcStrictFormulaChecking":return S.EwaSettings.ma(252);case "CalcSupportRowReference":return S.EwaSettings.ma(263);case "CalcParserUsesPledges":return S.EwaSettings.ma(307);case "CalcWebWorker":return!0;
case "CalcWebWorkerTest":return S.EwaSettings.ma(306);case "CalcLookupFunctions":return S.EwaSettings.ma(308);case "CalcLogStopWatch":return S.EwaSettings.ma(371);case "CalcPreventSpillingHack":return S.EwaSettings.ma(253);case "CalcDynamicArrayOperators":return S.EwaSettings.ma(103);case "CalcDotOperator":return S.EwaSettings.ma(583);case "CalcLetFunction":return S.EwaSettings.ma(702);default:return B.startsWith("OfficeVSO:")?S.EwaSettings.isChangeGateEnabled(B):!1}}catch(Q){return n.ULS.sendTraceTag(537155724,
0,15,"InstantaneousSupportInformation.IsFeatureEnabled("+B+"): feature parsing failed, returning false. Exception: "+Q.toString()+"."),!1}};d.prototype.cRa=function(B){this.isActive()&&this.ea.ic.allowEdits?(v.a.Ia(this.aIb),this.aIb=null,this.aIb=H.a.instance.create(this.refresh,B,F.a.Cdi)):n.ULS.sendTraceTag(537155723,0,50,"InstantaneousSupportInformationManager.ScheduleRefresh: won't schedule refresh. Edit permission: AllowEdits "+(void 0!==this.ea&&null!==this.ea&&void 0!==this.ea.ic&&null!==
this.ea.ic?this.ea.ic.allowEdits:!1)+", IsEditMode "+(void 0===this.ea||null===this.ea?!1:this.$.ea.isEditMode))};d.prototype.BZe=function(){n.ULS.sendTraceTag(537155719,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync called.");this.lKa?n.ULS.sendTraceTag(537155718,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync already running, skipping."):this.isActive()?this.MX&&this.MX.length||(this.lKa=y.p(this.$.oa.va,{FilterType:0},this.CMi,this.Zxf,null,null,null)):n.ULS.sendTraceTag(537155717,
0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync session is not yet active, skipping.")};d.prototype.oDc=function(){this.Xfb||(this.Xfb=!0,this.ea.VD(this.V_))};d.prototype.c2b=function(){this.mu(this.Zed);this.mu(this.lKa);this.lKa=this.Zed=null};d.prototype.mu=function(B){B&&!B.isCompleted&&this.$.oa.va.bfb(B.Gt)};d.jTh=function(B,Q){if(!B||!B.length)return[];if(!Q||!Q.length){Q=Array(B.length);for(var U=0;U<B.length;++U)Q[U]=B[U].IfmtIndex;return Q}var X=new I.a;B=ik(B);for(U=
B.next();!U.done;U=B.next())U=U.value,X.ia(U.IfmtIndex,new e(U));B=new x.a;U={};Q=ik(Q);for(var P=Q.next();!P.done;U={ogb:U.ogb,pQb:U.pQb},P=Q.next())U.ogb=P.value,U.pQb=void 0,function(ea){return function(){var ia=X.yc(ea.ogb.IfmtIndex);ea.pQb=ia.value;return ia}}(U)().returnValue&&U.pQb.data.FormatString===U.ogb.FormatString||B.add(U.ogb.IfmtIndex);return B.toArray()};of.Object.defineProperties(d.prototype,{we:{configurable:!0,enumerable:!0,get:function(){return this.en?this.en.LocaleInformation:
null}},qya:{configurable:!0,enumerable:!0,get:function(){return this.en?this.en.NumberFormats:[]}},oja:{configurable:!0,enumerable:!0,get:function(){this.MX&&this.MX.length||this.BZe();return this.MX}},ydi:{configurable:!0,enumerable:!0,get:function(){return this.en&&void 0!==this.en.InstantaneousCalcWebWorkerPrecisionSamplingRate&&null!==this.en.InstantaneousCalcWebWorkerPrecisionSamplingRate?this.en.InstantaneousCalcWebWorkerPrecisionSamplingRate:d.Mdh}},Bdi:{configurable:!0,enumerable:!0,get:function(){return this.en&&
void 0!==this.en.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate&&null!==this.en.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate?this.en.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate:d.Qdh}},Adi:{configurable:!0,enumerable:!0,get:function(){return this.en&&void 0!==this.en.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate&&null!==this.en.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate?this.en.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate:d.Pdh}},zdi:{configurable:!0,
enumerable:!0,get:function(){return this.en&&void 0!==this.en.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate&&null!==this.en.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate?this.en.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate:d.Odh}},zaf:{configurable:!0,enumerable:!0,get:function(){return this.en?this.en.InstantaneousCalcWebWorkerRenderingTimeLimitInMs:d.Ndh}},amd:{configurable:!0,enumerable:!0,get:function(){return null!==this.xZc?this.xZc:this.en?this.en.InstantaneousCalcManualMode:
!1}}});d.Myd="isim0";d.z_c="isim1";d.ccd="isim2";d.Dlf="isim3";d.L9e=100;d.NQd=1E3;d.dyd=3E5;d.Mdh=.001;d.Qdh=.1;d.Pdh=.2;d.Odh=.001;d.Ndh=50;Object(t.a)(d,"InstantaneousSupportInformationManager",u.a,[729,6]);var L=b(921),O=f.a;$k(c,O);c.prototype.create=function(){var B=this;if(this.$){n.ULS.sendTraceTag(537155672,0,50,"InstantaneousSupportInformationManagerFactory.Create: Start loading script");var Q=Object(L.a)(this.$.da,268,function(){return new d(B.$.ea,B.$)});this.pb(Q)}};c.ka=function(B){if(!B)throw Error.argumentNull("ewaControl");
B.da.Ga(246,new c(B))};Object(t.a)(c,"InstantaneousSupportInformationManagerFactory",f.a,[]);b.d(E,"a",function(){return a})},1433:function(t,E,b){function a(){L.a.Fa(c.ka)}function c(O){var B=K.call(this)||this;B.$=O;B.Eb();return B}function d(O,B){var Q=this;this.ika=this.SUd=this.mnf=!1;this.S8=null;this.AEb=function(){Q.ika=!1};this.Ec=O;this.gridView=F.g(O);this.calcManager=B;this.Fki=w.EwaSettings.isChangeGateEnabled("OfficeVSO:5041666_ImplementLogRecorderOnEwaJS");this.tbf=w.EwaSettings.ma(691);
this.c5=N.a.c5(O);this.vka=w.EwaSettings.isChangeGateEnabled("OfficeVSO:6592066_FixAutoCompleteCardFocusBug");this.gridView.Wb.um(this.AEb)}function e(O,B,Q,U){this.aKj=O;this.z9f=B;this.Thc=void 0===U?!1:U;Q?(this.cxa=Q.cxa,this.ZZ=Q.ZZ,this.YZ=Q.YZ,this.T4=Q.T4,this.S4=Q.S4):m.ULS.shipAssertTag(524039642,0,!1,"MarqueeMetadata.Ctor: rangeData is null")}function h(O){this.S4=this.T4=this.YZ=this.ZZ=!1;this.cxa=O}function k(O){if(O){var B=new h(O.IsRangeRef);B.ZZ=O.IsAbsoluteFirstRow;B.YZ=O.IsAbsoluteFirstColumn;
B.T4=O.IsAbsoluteSecondRow;B.S4=O.IsAbsoluteSecondColumn;return B}}function n(O){var B;if(O){var Q=new h(0===O.kind);O=null===(B=null===O||void 0===O?void 0:O.rangeInfo)||void 0===B?void 0:B.positionKindInfo;if(!O)return Q;Q.ZZ=0===O.firstRow;Q.YZ=0===O.firstColumn;Q.T4=0===O.secondRow;Q.S4=0===O.secondColumn;return Q}}t=b(0);var f=b(235),v=b(7),m=b(15),x=b(85),l=b(5),u=b(341);Object(t.a)(h,"MarqueeRangeData",null,[]);Object(t.a)(e,"MarqueeMetadata",null,[]);var A=b(41),z=b(144),y=b(34),w=b(1),D=
b(22),H=b(707),F=b(21),J=b(211),S=b(359),N=b(36),T=b(988),G=b(1199),I="rgba(95, 140, 237, {0});rgba(235, 94, 96, {0});rgba(141, 97, 194, {0});rgba(45, 150, 57, {0});rgba(191, 76, 145, {0});rgba(227, 130, 34, {0});rgba(55, 127, 158, {0})".split(";");d.prototype.ZF=function(O,B){this.Fki&&O.textBox.addEventLogRecord("ColoredReferencesManager.TryUpdateColoredReferences");if(this.SUd||O.wH)return!1;var Q=void 0===B||null===B?O.text:B;if(this.calcManager&&1<Q.length&&J.f(Q)){var U=this.iwb(),X=this.N0e(),
P=this.Ec.workbookContext.WorkbookFileName,ea=!1,ia=.01>Math.random()?Object(x.a)(z.a,this.Ec.Fb.sc("LoadingUIShown","ColoredReferencesManager")):null;try{var da=this.calcManager.extractReferences(Q,X,P,!this.tbf);if(!da)return m.ULS.sendTraceTag(524039689,0,50,"ColoredReferencesManager.UpdateColoredReferences: extractReferences is null (might be an invalid formula)"),!1;X=[];P=[];for(var xa=[],Z=[],ha=0,ya=0,va=new y.a(!1),bb="",ba=ik(da.Items),fa=ba.next();!fa.done;fa=ba.next()){var ra=fa.value;
ea=ra.IsStructRef||ea;if(ra.IsBoolean||ra.IsNumber||ra.IsString){var pa=ra.IsBoolean?"rgba(0, 0, 255, 1)":ra.IsNumber?"rgba(9, 134, 88, 1)":"rgba(163, 21, 21, 1)";this.oY(P,Q,ha,ra.Span.Start,null);this.oY(P,Q,ra.Span.Start,ra.Span.End,pa);ha=ra.Span.End}else if(w.EwaSettings.ma(594)){if(ra.Range||ra.LetName&&0<=ra.LetNumber){da=null;if(ra.Range){var Za=A.D(ra.Range);da=this.$Ja(Za,va,1);X.push(new S.a(Za,U))}else ra.LetName&&0<=ra.LetNumber&&(da=bb=this.RLh(ra.LetName,ra.LetNumber,va,bb),ya!==va.count&&
O.colors.add(ra.Span.Start+"-"+ra.Span.End,I[(va.count-1)%I.length]));this.oY(P,Q,ha,ra.Span.Start,null);this.oY(P,Q,ra.Span.Start,ra.Span.End,da);ha=ra.Span.End;xa.push(ra.Span);var Ua=P.length-1;Z.push(new e(Ua,P[Ua].text,k(ra)));ya=va.count}}else if(ra.Range){var Ma=A.D(ra.Range),oa=this.$Ja(Ma,va,1);this.oY(P,Q,ha,ra.Span.Start,null);this.oY(P,Q,ra.Span.Start,ra.Span.End,oa);X.push(new S.a(Ma,U));ha=ra.Span.End;xa.push(ra.Span);var ja=P.length-1;Z.push(new e(ja,P[ja].text,k(ra)))}}this.oY(P,Q,
ha,Q.length,null);this.F0f(O,P,!!B);var ta=O.textBox.text;if(!D.a.equals(ta,Q,!1)){m.ULS.shipAssertTag(38114182,0,!1,"ColoredReferencesManager.UpdateColoredReferences: The text we created is different from the original text. Setting the original text back. currentTextLength ["+ta.length+"], originalTextLength ["+Q.length+"]");var aa=O.textBox.caretPosition;O.textBox.text=Q;O.textBox.caretPosition=aa;return!0}this.SM(X,va,Z);w.EwaSettings.ma(594)&&0<X.length&&m.ULS.sendTraceTag(524039688,0,50,"ColoredReferencesManager.UpdateColoredReferences: Cell reference(s) colored");
w.EwaSettings.ma(594)&&0<O.colors.count&&m.ULS.sendTraceTag(524039687,0,50,"ColoredReferencesManager.UpdateColoredReferences: Let name(s) colored");return this.ika=!0}finally{ia&&ia.$Aa(function(){ea&&m.ULS.sendTraceTag(524039686,0,50,"ColoredReferencesManager.UpdateColoredReferences: Formula with structured reference is highlighted in "+ia.qc+" ms")})}}else return this.SM(null,null),this.ika&&(this.ika=!1,U=O.textBox.caretPosition,O.textBox.setPlainText(Q),O.textBox.caretPosition=Math.min(U,Q.length),
B)?!0:!1};d.prototype.aBc=function(O,B,Q){if(this.SUd||O.wH)return!1;var U=isNullOrUndefined(B)?O.text:B,X=[],P=new y.a(!1);if(1<U.length&&Object(T.b)(Q)){var ea=[],ia=[],da=[],xa=0,Z=this.iwb();Q=ik(Q.formulaHighlights);for(var ha=Q.next();!ha.done;ha=Q.next()){ha=ha.value;this.oY(ea,U,xa,ha.span.start,null);switch(ha.kind){case 0:case 1:case 2:xa=A.B(ha.rangeInfo.sharedRange);if(isNullOrUndefined(xa)){m.ULS.sendTraceTag(521211937,0,10,"ColoredReferencesManager.tryUpdateFormulaHighlights: Received formula highlight with undefined range, HighlightKind:"+
ha.kind.toString()+",");this.oY(ea,U,ha.span.start,ha.span.end,null);break}var ya=this.$Ja(xa,P,1);this.oY(ea,U,ha.span.start,ha.span.end,ya);X.push(new S.a(xa,Z));ia.push({Start:ha.span.start,End:ha.span.end});xa=ea.length-1;da.push(new e(xa,ea[xa].text,n(ha)));break;case 3:this.oY(ea,U,ha.span.start,ha.span.end,null,"rgba(229, 229, 229, 1)")}xa=ha.span.end}this.oY(ea,U,xa,U.length);this.F0f(O,ea,!!B);B=O.textBox.text;if(!D.a.equals(B,U,!1))return m.ULS.shipAssertTag(521211936,0,!1,"ColoredReferencesManager.UpdateFormulaHighlights: The text we created is different from the original text. Setting the original text back. currentTextLength ["+
B.length+"], originalTextLength ["+U.length+"]"),B=O.textBox.caretPosition,O.textBox.text=U,O.textBox.caretPosition=B,!0;this.SM(X,P,da);return this.ika=!0}this.SM(null,null);return this.ika&&(this.ika=!1,X=O.textBox.caretPosition,O.textBox.setPlainText(U),O.textBox.caretPosition=Math.min(X,U.length),B)?!0:!1};d.prototype.brf=function(O,B,Q){if(!O||!B||!Q)return m.ULS.shipAssertTag(524039685,0,!!O,"ColoredReferencesManager.MoveMarqueeRange: cellContentEditor is null"),m.ULS.shipAssertTag(524039684,
0,!!B,"ColoredReferencesManager.MoveMarqueeRange: highlightState is null"),m.ULS.shipAssertTag(524039683,0,!!Q,"ColoredReferencesManager.MoveMarqueeRange: newRange is null"),!1;var U=Object(x.a)(e,B.metadata);if(!U)return m.ULS.shipAssertTag(524039682,0,!1,"ColoredReferencesManager.MoveMarqueeRange: marqueeMetadata is null"),!1;var X=U.aKj,P=U.z9f,ea=this.gridView.Ab.Scf(Q)?Q.jbc(U.YZ,U.ZZ):Q.z4a(U.YZ,U.ZZ,U.S4,U.T4);if(!ea)return m.ULS.shipAssertTag(524039681,0,!1,"ColoredReferencesManager.MoveMarqueeRange: newText is null"),
!1;var ia=P.indexOf("!");-1!==ia&&(ea=P.substring(0,ia+1)+ea);if(!O.textBox.changeTextInExistingTextPart(X,P,ea))return m.ULS.shipAssertTag(38926105,0,!1,"ColoredReferencesManager.MoveMarqueeRange: failed to change the text part"),!1;U.z9f=ea;X=!0;for(P=1;4>=P;P++)(ea=F.g(this.Ec).qb.ew(3,P,B.K$))?(ea.range=Q,ea.metadata=U):(m.ULS.shipAssertTag(524039680,0,!1,"ColoredReferencesManager.MoveMarqueeRange: highlightStateInPane is null"),X=!1);this.gridView.qb.update(!1,!1);this.gridView.pj&&(this.gridView.$b.textBox.text=
O.text);this.gridView.$b.yHb(new u.a({pzb:!0}));return X};d.prototype.Jki=function(O){if(3!==O.gr)return m.ULS.shipAssertTag(524039651,0,!1,"ColoredReferencesManager.IsMarqueeHighlightDragable: not HighlightDivIndex.Marquee."),!1;O=Object(x.a)(e,O.metadata);return O?O.cxa&&!O.Thc:(m.ULS.shipAssertTag(524039650,0,!1,"ColoredReferencesManager.IsMarqueeHighlightDragable: marqueeMetadata is null."),!1)};d.prototype.oeb=function(O,B){m.ULS.sendTraceTag(524039649,0,50,"ColoredReferencesManager.SuspendResumeColoredReferences: "+
(B?"suspending":"resuming")+" colored references");B&&this.ika&&(this.ika=!1,this.SM(null,null),O.textBox.sZg());this.SUd=B};d.prototype.dispose=function(){this.gridView&&this.gridView.Wb&&this.gridView.Wb.Nl(this.AEb)};d.prototype.Rjd=function(O){var B=this.formulaAssistanceTelemetryManager;B||this.mnf||(this.mnf=!0,m.ULS.sendTraceTag(521211935,0,50,"ColoredReferencesManager.highlightPreviewRanges: Failed to log highlightPreviewRanges measurement, FormulaAssistanceTelemetryManager unavailable"));
null===B||void 0===B?void 0:B.oO(["highlightPreviewRanges"]);this.c5?this.Y7h(O):this.X7h(O);null===B||void 0===B?void 0:B.gQ(["highlightPreviewRanges"],!0)};d.prototype.Y7h=function(O){var B=this.formulaAssistanceManager.wed(O,G.a);if(isNullOrUndefined(B))this.vka&&this.SM(null,null);else{var Q=this.iwb(),U=[],X=new y.a(!1),P=[];B=ik(B.formulaHighlights);for(var ea=B.next();!ea.done;ea=B.next()){ea=ea.value;var ia=ea.kind;if(0===ia||2===ia||1===ia)ia=A.B(ea.rangeInfo.sharedRange),Object(T.b)(ia)&&
(U.push(new S.a(ia,Q)),this.$Ja(ia,X,1),P.push(new e(ea.span.start,O.substring(ea.span.start,ea.span.end),n(ea),!0)))}this.SM(U,X,P)}};d.prototype.X7h=function(O){var B=this.iwb(),Q=this.N0e(),U=this.Ec.workbookContext.WorkbookFileName,X=[],P=new y.a(!1),ea=[];if(Q=this.calcManager.extractReferences(O,Q,U,!this.tbf)){Q=ik(Q.Items);for(U=Q.next();!U.done;U=Q.next())if(U=U.value,U.Range){var ia=A.D(U.Range);X.push(new S.a(ia,B));this.$Ja(ia,P,1);ea.push(new e(U.Span.Start,O.substring(U.Span.Start,U.Span.End),
k(U),!0))}this.SM(X,P,ea)}else this.vka&&this.SM(null,null)};d.prototype.$Ja=function(O,B,Q){var U=B.getItem(O.toString());U||(U=I[B.count%I.length],B.add(O.toString(),U));return String.format(U,Q)};d.prototype.RLh=function(O,B,Q,U){O="["+O+", "+B+"]";B=Q.getItem(O);B||(B=Q.count%I.length,B=I[B],U===String.format(B,1)&&(Q.add("skip-"+O,B),B=Q.count%I.length,B=I[B]),Q.add(O,B));return String.format(B,1)};d.prototype.oY=function(O,B,Q,U,X,P){X=void 0===X?null:X;P=void 0===P?null:P;m.ULS.shipAssertTag(524039648,
0,Q<=U,"ColoredReferencesManager.AddTextPart: startIndex cannot be larger than endIndex");Q<U&&(B=B.substring(Q,U),O.push(Object(v.a)(new H.a,{text:B,color:X,backgroundColor:P})))};d.prototype.SM=function(O,B,Q){var U=this;Q=void 0===Q?null:Q;O&&O.length?(m.ULS.sendTraceTag(524039647,0,50,"ColoredReferencesManager.HighlightRanges: number of ranges to highlight: "+O.length),O.reverse(),Q.reverse(),this.gridView.qb.Iw(O,[3],!0,function(X,P){if(X&&X.range&&P){m.ULS.shipAssertTag(524039643,0,B.kb(X.range.toString()),
"ColoredReferencesManager.HighlightRanges: The range '"+X.range.toString()+"' doesn't exist in the range to color dictionary");var ea=U.$Ja(X.range,B,.1),ia=U.$Ja(X.range,B,1);U.Ec.frame&&U.Ec.frame.nH&&U.Ec.frame.nH.Fka||(P.style.background=ea);P.style.borderColor=ia;Q&&(P.setAttribute(l.a.oyb,X.K$.toString()),X.metadata=Q[X.K$])}else m.ULS.shipAssertTag(524039646,0,!!X,"ColoredReferencesManager.HighlightRanges: state is null"),m.ULS.shipAssertTag(524039645,0,!!X.range,"ColoredReferencesManager.HighlightRanges: state.Range is null"),
m.ULS.shipAssertTag(524039644,0,!!P,"ColoredReferencesManager.HighlightRanges: div is null")})):(O=this.Ec.Fb.sc("UserAction","HideRangesHighlightsStopwatch"),this.gridView.qb.fh([3]),this.gridView.qb.Scb(new S.a(null,this.iwb()),[3]),O.stop())};d.prototype.F0f=function(O,B,Q){var U=O.textBox;U.XJ=!0;var X=U.selection,P=X.index;X=P+X.length;U.setTextFromTextParts(B);B=U.text.length;U.selectRange(Math.min(P,B),Math.min(X,B));Q&&O.yHb(new u.a);U.XJ=!1};d.prototype.iwb=function(){return this.M0e().sheetId};
d.prototype.N0e=function(){return this.M0e().sheetName};d.prototype.M0e=function(){return this.gridView.ht&&this.gridView.ht.yK?this.gridView.ht.yK:this.Ec.pa};of.Object.defineProperties(d.prototype,{formulaAssistanceManager:{configurable:!0,enumerable:!0,get:function(){this.S8||(this.S8=this.Ec.da.za(464));return this.S8}},formulaAssistanceTelemetryManager:{configurable:!0,enumerable:!0,get:function(){this.DDa||(this.DDa=this.Ec.da.za(491));return this.DDa}}});Object(t.a)(d,"ColoredReferencesManager",
null,[616,6]);var K=f.a;$k(c,K);c.prototype.create=function(){var O=this;this.$.da.Za(266,function(B){B=w.EwaSettings.xl()||w.EwaSettings.isChangeGateEnabled("OfficeVSO:6143820_MoveServiceRegistrationFromFAM_V2")?O.$.da.za(281)||O.$.da.Ga(281,new d(O.$,B)):new d(O.$,B);O.pb(B)})};c.ka=function(O){O.da.Ga(282,new c(O))};Object(t.a)(c,"ColoredReferencesManagerFactory",f.a,[]);var L=b(10);b.d(E,"a",function(){return a})},1481:function(t,E,b){function a(){n.a.Fa(c.ka)}function c(f){var v=k.call(this)||
this;v.$=f;v.Eb();return v}t=b(0);var d=b(235),e=b(1026),h=b(1),k=d.a;$k(c,k);c.prototype.create=function(){var f=this;this.$.da.Za(266,function(v){v=h.EwaSettings.xl()||h.EwaSettings.isChangeGateEnabled("OfficeVSO:6143820_MoveServiceRegistrationFromFAM_V2")?f.$.da.za(294)||f.$.da.Ga(294,new e.RelativeAndAbsoluteReferencesManager(v)):new e.RelativeAndAbsoluteReferencesManager(v);f.pb(v)})};c.ka=function(f){f.da.Ga(295,new c(f))};Object(t.a)(c,"RelativeAndAbsoluteReferencesManagerFactory",d.a,[]);
var n=b(10);b.d(E,"a",function(){return a})},1606:function(t,E,b){b.r(E);t=b(1417);E=b(1371);var a=b(1433);b=b(1481);Type.registerNamespace("_Ewa");Object(t.a)();Object(E.a)();Object(a.a)();Object(b.a)()}}]);

//# sourceMappingURL=EwaDS.calc.js.map