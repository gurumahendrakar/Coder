(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1004:function(t,E,b){function a(L,O,B,Q){var U=K.call(this)||this;U.tF=null;U.gD=null;U.fW=null;U.zw=null;U.lHb=null;U.AK=null;U.hkc=null;U.oCb=null;U.nCb=!1;U.Lwa=!0;U.Qpc=null;U.ewaAccessibilityManager=null;U.lFd=null;U.kFd=null;U.oFd=null;U.Cnd=!1;U.Tyf=function(){m.ULS.sendTraceTag(537154206,0,50,"PrintPreviewPane:OnIframeContentChange API invoked with loadPdfCalled: "+U.nCb);U.nCb&&(U.O7h(),U.AK.style.visibility="visible",
U.hkc?U.hkc.stop():m.ULS.sendTraceTag(537154205,0,10,"PrintPreviewPane:OnIframeContentChange - loadPdfStopwatchForIframe is null."),U.raiseEvent(a.aEb,new f(1)),U.NOd(),U.nCb=!1)};U.$=L;U.fD=O;U.k$g();U.useMSPdfViewer=B;U.isUniversalPrintEnabled=Q;return U}function c(){this.msPdfViewerFileUrl=null;this.useMSPdfViewer=!1;this.onPdfLoad=null}function d(){this.logger=this.printSettingsTaskPaneCallbacks=this.selectedPrintSettingsValues=this.colorOptions=this.marginDetailedOptions=this.marginOptions=this.scalingOptions=
this.paperSizeOptions=this.orientationOptions=this.whatToPrintOptions=null;this.isViewMode=this.shouldDisableCurrentSelection=!1;this.dataCultureTag=this.isMetricMeasurementUnit=this.isUniversalPrintFlowEnabled=null}function e(){this.msPdfKitWasmUrl=this.msPdfKitJSUrl=this.pdfViewerWorkerUrl=null}function h(L){this.lg=L}function k(L){this.lg=L}function n(L){this.lg=L}function f(L){var O=F.call(this)||this;O.R1i=L;return O}b.r(E);t=b(0);var v=b(7),m=b(15),x=b(4);b(27);var l=b(415),u=b(38),A=b(50),
z=b(12),y=b(129),w=b(1),D=b(14),H=b(21),F=Sys.EventArgs;$k(f,F);Object(t.a)(f,"PrintPreviewPaneOperationStatusEventArgs",Sys.EventArgs,[]);var J=b(274),S=b(257);n.prototype.Nh=function(){J.a(this.lg.$).cB(this.Yd)||J.a(this.lg.$).Nh(this)};n.prototype.d8=function(){J.a(this.lg.$).cB(this.Yd)&&J.a(this.lg.$).Dz(this)};n.prototype.ah=function(L){return z.DOMElementExtensions.nf(this.hc,L)};n.prototype.ej=function(){this.lg.$.frame.xe.Ij(this.lg.$.frame.xe.wE)};n.prototype.Dj=function(){};n.prototype.Uf=
function(L,O){return O?!1:(this.lg.enterPrintPreviewHeaderFocusTrapZone(),!0)};of.Object.defineProperties(n.prototype,{Yd:{configurable:!0,enumerable:!0,get:function(){return S.a.lJf}},hc:{configurable:!0,enumerable:!0,get:function(){var L=b(1004).PrintPreviewPane;return document.getElementById(L.P1i)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(t.a)(n,"PrintPreviewHeaderKeyboardAccessibleSection",null,[429]);k.prototype.Nh=function(){J.a(this.lg.$).cB(this.Yd)||
J.a(this.lg.$).Nh(this)};k.prototype.d8=function(){J.a(this.lg.$).cB(this.Yd)&&J.a(this.lg.$).Dz(this)};k.prototype.ah=function(L){return z.DOMElementExtensions.nf(this.hc,L)};k.prototype.ej=function(){this.lg.$.frame.xe.Ij(this.lg.$.frame.xe.wE)};k.prototype.Dj=function(){};k.prototype.Uf=function(L,O){return O?!1:(this.lg.useMSPdfViewer?(L=document.getElementById(b(1004).PrintPreviewPane.gDd))&&z.DOMElementExtensions.setFocus(L,!0):z.DOMElementExtensions.setFocus(this.lg.AK),!0)};of.Object.defineProperties(k.prototype,
{Yd:{configurable:!0,enumerable:!0,get:function(){return S.a.mJf}},hc:{configurable:!0,enumerable:!0,get:function(){var L=b(1004).PrintPreviewPane;return this.lg.useMSPdfViewer?document.getElementById(b(1004).PrintPreviewPane.gDd):document.getElementById(L.FGf)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(t.a)(k,"PrintPreviewKeyboardAccessibleSection",null,[429]);h.prototype.Nh=function(){J.a(this.lg.$).cB(this.Yd)||J.a(this.lg.$).Nh(this)};h.prototype.d8=function(){J.a(this.lg.$).cB(this.Yd)&&
J.a(this.lg.$).Dz(this)};h.prototype.ah=function(L){return z.DOMElementExtensions.nf(this.hc,L)};h.prototype.ej=function(){this.lg.$.frame.xe.Ij(this.lg.$.frame.xe.wE)};h.prototype.Dj=function(){};h.prototype.Uf=function(L,O){return O?!1:(this.lg.enterPrintSettingsTaskPaneFocusTrapZone(),!0)};of.Object.defineProperties(h.prototype,{Yd:{configurable:!0,enumerable:!0,get:function(){return S.a.pJf}},hc:{configurable:!0,enumerable:!0,get:function(){var L=b(1004).PrintPreviewPane;return document.getElementById(L.nFd)}},
canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(t.a)(h,"PrintSettingsTaskPaneKeyboardAccessibleSection",null,[429]);Object(t.a)(e,"MSPdfViewerFileUrl",null,[]);Object(t.a)(d,"PrintSettingsTaskPaneProps",null,[]);Object(t.a)(c,"ViewerPaneProps",null,[]);var N=b(1291),T=b(402),G=b(5),I=b(1292);b.d(E,"PrintPreviewPane",function(){return a});var K=u.a;$k(a,K);a.prototype.fHg=function(L){this.addHandler(a.aEb,L)};a.prototype.udj=function(L){this.removeHandler(a.aEb,L)};
a.prototype.uCj=function(){this.f$g()};a.prototype.vCj=function(){var L=this.$.Fb.sc("UserAction","createSettingsPaneStopwatch"),O=document.getElementById(a.nFd);this.l$g();var B=this.m$g();this.gD.createPrintSettingsTaskPane(O,B);L.stop();this.nCb=!1;if(this.isUniversalPrintEnabled&&this.zw){L="A4";switch(B.selectedPrintSettingsValues.selectedPaperSize){case 8:L="A3";break;case 9:L="A4";break;case 11:L="A5";break;case 12:L="JIS B4";break;case 13:L="JIS B5";break;case 5:L="North America Legal";break;
case 1:L="North America Letter";break;case 6:L="North America Invoice";break;case 7:L="North America Executive";break;case 3:L="North America Ledger"}this.tF.setDocumentSettings({mediaSize:L,orientation:2===B.selectedPrintSettingsValues.selectedOrientation?"landscape":"portrait",colorMode:1===B.selectedPrintSettingsValues.selectedColor?"color":"blackAndWhite"})}this.$Hd()};a.prototype.setPageRangeSettings=function(L,O,B,Q,U){this.gD&&(this.gD.setPageRangeSettings(L,O,B,Q,U),this.V_f(String.format(D.a.instance.mb(200),
Q,U,L)))};a.prototype.E7h=function(){this.zw&&(this.zw.style.display="none")};a.prototype.Uhh=function(){this.dispose();this.cYd();this.SPj();this.tF&&this.tF.closePrintPreviewPane();this.fW=this.gD=this.tF=this.zw=null};a.prototype.kui=function(L){m.ULS.sendTraceTag(575534018,0,50,"PrintPreviewPane: LoadPdf invoked.");this.hidePreviewError();this.useMSPdfViewer?((this.oCb=this.$.Fb.sc("UserAction","pdfLoadTimeStopwatchForMsPdfViewer"))||m.ULS.sendTraceTag(537154210,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForMsPdfViewer is null."),
this.fW.renderPdf(L)):this.AK&&((this.hkc=this.$.Fb.sc("UserAction","loadPdfStopwatch"))||m.ULS.sendTraceTag(537154209,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForIframe is null."),this.nCb=!0,this.AK.src&&this.AK.src===L?this.Tyf(null):this.AK.src=L);if(this.isUniversalPrintEnabled&&this.zw){var O=T.b(this.$.workbookContext);this.tF.setFileUrl(L,O)}};a.prototype.onPdfLoad=function(){this.oCb?(m.ULS.sendTraceTag(537154208,0,50,"PrintPreviewPane:onPdfLoad - Rendering time : "+this.oCb.qc+" ms, isFirstTimeLoad: "+
this.Lwa),this.oCb.stop()):m.ULS.sendTraceTag(537154207,0,10,"PrintPreviewPane:onPdfLoad - loadPdfStopwatchForMsPdfViewer is null.");this.raiseEvent(a.aEb,new f(1));this.hideWaitCursor();this.NOd()};a.prototype.printPdf=function(){z.DOMElementExtensions.setFocus(this.AK);this.AK.contentWindow.print()};a.prototype.kDj=function(){this.showSpinner();this.showWaitCursor();this.V_f("")};a.prototype.O7h=function(){this.hideSpinner();this.hideWaitCursor()};a.prototype.Lz=function(L,O,B){this.zw&&this.fW&&
(this.Cnd=!1,this.fW.showErrorDetails(O,L,void 0===B?null:B),this.fD.j6a=!0,this.AK&&(this.AK.src=""),this.disablePrintButton(),this.hideWaitCursor(),a.Lli(O)&&(this.Cnd=!0,this.LQi()))};a.prototype.hidePreviewError=function(){this.fD.j6a=!1;this.fW.hidePreviewError();this.enablePrintButton()};a.prototype.Lhh=function(){(this.lHb=document.getElementById(a.nJf))&&this.lHb.parentNode&&this.lHb.parentNode.removeChild(this.lHb)};a.prototype.hideErrorMessageForPrintOptions=function(){this.gD&&this.gD.hideErrorMessageForPrintOptions()};
a.prototype.showErrorMessageForPrintOptions=function(L){this.gD&&this.gD.showErrorMessageForPrintOptions(L)};a.prototype.showSpinner=function(){this.fD.j6a||w.EwaSettings.isChangeGateEnabled("OfficeVSO:5547045_ShowLoadingIconOnSettingsChange")&&this.Cnd?this.hidePreviewError():this.AK&&(this.AK.style.visibility="hidden");this.fW&&this.fW.showSpinner()};a.prototype.hideSpinner=function(){this.fW&&this.fW.hideSpinner()};a.prototype.enablePrintButton=function(){this.gD&&this.gD.enablePrintButton();this.isUniversalPrintEnabled&&
this.zw&&this.tF.updatePrintButtonEnableDisableState(!0)};a.prototype.disablePrintButton=function(){this.gD&&this.gD.disablePrintButton();this.isUniversalPrintEnabled&&this.zw&&this.tF.updatePrintButtonEnableDisableState(!1)};a.prototype.showWaitCursor=function(){this.gD&&this.gD.showWaitCursor();this.isUniversalPrintEnabled&&this.zw&&this.tF.updatePrintButtonEnableDisableState(!1)};a.prototype.hideWaitCursor=function(){this.gD&&this.gD.hideWaitCursor();this.isUniversalPrintEnabled&&this.zw&&this.tF.updatePrintButtonEnableDisableState(!0)};
a.prototype.i$g=function(){if(this.zw)m.ULS.sendTraceTag(591927430,0,10,"PrintPreviewerPane:CreatePrintPreviewerContainer - printPreviewerContainer should be null");else if(this.zw=document.createElement("div"),this.zw.id=a.nJf,this.zw.classList.add(a.S1i),this.$.Sq.insertBefore(this.zw,this.$.Sq.firstChild),x.AFrameworkApplication.ta&&x.AFrameworkApplication.ta.Qa.Qf){var L=document.getElementById(G.a.sGa);L&&(this.zw.style.top=L.clientHeight+"px",this.zw.style.height="calc(100% - "+L.clientHeight+
"px)")}};a.prototype.enterPrintPreviewHeaderFocusTrapZone=function(){this.tF.enterPrintPreviewHeaderFocusTrapZone()};a.prototype.enterPrintSettingsTaskPaneFocusTrapZone=function(){this.tF.enterPrintSettingsTaskPaneFocusTrapZone()};a.prototype.D_i=function(){var L=this;this.$.da.Za(15,function(O){L.ewaAccessibilityManager=O;L.ewaAccessibilityManager.mode=3})};a.prototype.k$g=function(){this.oFd=new h(this);this.lFd=new k(this);this.kFd=new n(this)};a.prototype.$Hd=function(){this.oFd.Nh();this.lFd.Nh();
this.kFd.Nh();this.D_i()};a.prototype.cYd=function(){this.oFd.d8();this.lFd.d8();this.kFd.d8();H.g(this.$).H0();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0)};a.prototype.WN=function(){this.Qpc=y.a.instance.Td(this.AK);this.Qpc.ka("load",this.Tyf)};a.prototype.SPj=function(){this.Qpc&&this.AK&&this.Qpc.detach("load")};a.prototype.NOd=function(){this.isUniversalPrintEnabled?this.a_f(a.Q1i,a.uEi):this.a_f(a.nFd,a.hJf)};a.prototype.a_f=function(L,O){this.Lwa&&(L=document.getElementById(L))&&
(O=z.DOMElementExtensions.getElementById(L,O))&&(this.Lwa=!1,O.focus())};a.prototype.LQi=function(){this.fD.j6a=!1;this.enablePrintButton();this.NOd()};a.prototype.f$g=function(){var L=this;if(w.EwaSettings.isChangeGateEnabled("OfficeVSO:6068952_FixJSCrahInPrintPreview")){var O=A.GetServiceTaskFactory.Ra(this.$.da,283,284,0).result.vn;O.loadScript("excel-print-preview-sprite").then(function(){O.loadScript("printPreviewer").then(function(){O.loadScript("excelPrintPreviewer").then(function(){L.IEe()})},
function(){m.ULS.sendTraceTag(525358669,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load printPreviewer script required for excelPrintPreviewer.")})},function(){m.ULS.sendTraceTag(525358668,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load excelPrintPreviewSprite script required for excelPrintPreviewer.")})}else A.GetServiceTaskFactory.Ra(this.$.da,283,284,0).result.vn.loadScript("excelPrintPreviewer").then(function(){L.IEe()})};a.prototype.IEe=function(){var L=this,O=this.$.Fb.sc("UserAction",
"createEmptyPreviewerStopwatch");this.i$g();this.j$g();this.isUniversalPrintEnabled?this.tF.createEmptyPrintPreviewPaneAsync(this.zw,this.HEe()).then(function(){O.stop();L.oBe();L.tF.updatePrintButtonEnableDisableState(!1)}):(this.tF.createEmptyPrintPreviewPane(this.zw,this.HEe()),O.stop(),this.oBe())};a.prototype.oBe=function(){var L=this.$.Fb.sc("UserAction","createPdfPreviewPaneStopwatch"),O=document.getElementById(a.gDd);this.useMSPdfViewer&&(O.tabIndex=0);this.T9g();this.S9g(O);L.stop();this.raiseEvent(a.aEb,
new f(0))};a.prototype.j$g=function(){this.tF||(this.tF=printPreviewer.PrintPreviewPaneControllerFactoryGlobal.createPrintPreviewPaneController());this.tF||m.ULS.sendTraceTag(537154203,0,10,"PrintPreviewerPane:CreatePrintPreviewerController - printPreviewerController should not be null")};a.prototype.l$g=function(){this.gD||(this.gD=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintSettingsTaskPaneController());this.gD||m.ULS.sendTraceTag(537154202,0,10,"PrintPreviewerPane:CreatePrintSettingsPaneController - printSettingsPaneController should not be null")};
a.prototype.T9g=function(){this.fW||(this.fW=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintPreviewController());this.fW||m.ULS.sendTraceTag(537154201,0,10,"PrintPreviewerPane:CreatePdfPreviewPaneController - pdfPreviewerPaneController should not be null")};a.prototype.S9g=function(L){this.fW.createPrintPreviewPane(L,this.vbh());this.useMSPdfViewer||(this.AK=z.DOMElementExtensions.getElementById(this.zw,a.FGf),this.AK.title=D.a.instance.ga(1205),this.WN())};a.prototype.m$g=function(){var L=
"en-US";var O=this.$.ya.IsMetricMeasurementUnit;this.$.ya.DataCultureTag?L=this.$.ya.DataCultureTag:m.ULS.sendTraceTag(536994563,0,50,"PrintPreviewerPane:createPrintSettingsProps - DataCultureTag in ewaControl.bootstrapContext is nullable");return Object(v.a)(new d,{whatToPrintOptions:this.fD.dv.whatToPrintOptions,orientationOptions:this.fD.dv.orientationOptions,paperSizeOptions:this.fD.dv.paperSizeOptions,scalingOptions:this.fD.dv.scalingOptions,marginDetailedOptions:this.fD.VSh(),selectedPrintSettingsValues:this.fD.TVh(),
printSettingsTaskPaneCallbacks:this.fD.RVh(),logger:new l.a,shouldDisableCurrentSelection:this.fD.ixc(),isViewMode:!this.$.isEditMode,isMetricMeasurementUnit:O,dataCultureTag:L,isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled})};a.prototype.HEe=function(){return this.isUniversalPrintEnabled?this.fD.PVh():Object(v.a)(new N.a,{backActionButtonText:D.a.instance.ga(1203),printPreviewPaneCallbacks:this.fD.m1e(),logger:new l.a,disableTellMeControl:!0})};a.prototype.vbh=function(){var L=this;return this.useMSPdfViewer?
Object(v.a)(new c,{useMSPdfViewer:!0,msPdfViewerFileUrl:this.g9g(),onPdfLoad:function(){L.onPdfLoad()}}):Object(v.a)(new c,{useMSPdfViewer:!1})};a.prototype.g9g=function(){return Object(v.a)(new e,{pdfViewerWorkerUrl:this.$.ya.PrintPreviewerPdfViewerWorkerUrl,msPdfKitJSUrl:this.$.ya.PrintPreviewerMSPdfKitJsUrl,msPdfKitWasmUrl:this.$.ya.PrintPreviewerMSPdfKitWasmUrl})};a.prototype.V_f=function(L){this.zw&&this.tF.setAdditionalHeaderText(L)};a.Lli=function(L){return 3===L||2===L};a.nJf="PrintPreviewerContainer";
a.nFd="printSettingsTaskPaneId";a.gDd="previewId";a.FGf="printpreviewiframe";a.P1i="printPreviewHeaderId";a.hJf="printButton";a.Q1i="printPreviewPaneId";a.uEi="printButtonId";a.S1i=I.a.zw;a.aEb="pppnosu";Object(t.a)(a,"PrintPreviewPane",u.a,[903])},1057:function(t,E,b){function a(){}b.d(E,"a",function(){return a});t=b(0);var c=b(15),d=b(4),e=b(39),h=b(27);a.OWe=function(k,n){switch(k){case 3:return a.f1h(n);case 2:return a.OUh(n);case 1:return a.ZOh(n)}return""};a.f1h=function(k){switch(k){case 1:return d.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString();
case 2:return d.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString()}return""};a.OUh=function(k){switch(k){case 1:return d.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString();case 2:return d.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString()}return""};a.ZOh=function(k){switch(k){case 1:return d.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return d.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString()}return""};
a.openInClient=function(k,n,f){if(h.a.Ug||h.a.Uo)window.setTimeout(function(){a.GNf(f,a.Qcc())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(a.xqe(f),k,0,!1)};a.b_g=function(k,n,f,v){n&&v&&v();a.openInClient(k,n,f)};a.Qcc=function(){return h.a.Ug?1:h.a.Uo?2:h.a.J7a?3:h.a.isMac?4:0};a.b1h=function(k){switch(k){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}};a.c1h=function(k){switch(k){case 3:return"WildFireWordBizBarFlight";
case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";default:return""}};a.GNf=function(k,n){1===n?(c.ULS.sendTraceTag(17151569,306,50,"User Directed to App Store"),k=a.OWe(k,n),8<h.a.x5a?e.a.Te(k,void 0,void 0,"RedirectToAppStore"):e.a.YU(k)):document.hidden||(a.Szb?(k=d.AFrameworkApplication.fa.appSettings.WildFireUrlChinaStoreAndroid.toString())?(c.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),e.a.YU(k)):c.ULS.sendTraceTag(18088019,306,50,
"Empty Url in China Proxy Page BRS Setting"):(c.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(a.OWe(k,n),null,null)))};a.xqe=function(k){switch(k){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}};a.Ucd=function(k){switch(k){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}};a.Wod=function(k){return(k=a.RRh(k))&&""!==k?Boolean.parse(k):!1};a.HPd=
function(k){a.tsj(k)};a.RRh=function(k){try{return localStorage.getItem(k)}catch(n){return c.ULS.sendTraceTag(18416668,306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+n.message),null}};a.tsj=function(k){try{localStorage.setItem(k,"true")}catch(n){c.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+n.message)}};of.Object.defineProperties(a,{Szb:{configurable:!0,enumerable:!0,get:function(){return"zh-CN"===window.navigator.language}},
Gxc:{configurable:!0,enumerable:!0,get:function(){return(h.a.J7a||h.a.isMac)&&h.a.fo}},zzj:{configurable:!0,enumerable:!0,get:function(){return h.a.Ug||h.a.Uo}}});a.pye="ChromeExtensionBarDismiss";Object(t.a)(a,"WildFireUtilities",null,[])},1264:function(t,E,b){function a(){c.a.ti(".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb.ewa-bb-react{background-color:#f5f5f5}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:bold}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-title,.ewa-bb-entry-message,.ewa-bb-entry-button-holder,.ewa-bb-entry-link{vertical-align:middle}.ewa-root-ltr .ewa-bb-entry-close,.ewa-nov2-ltr .ewa-bb-entry-close{right:2px}.ewa-root-ltr .ewa-bb-content,.ewa-nov2-ltr .ewa-bb-content{margin-right:26px}.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-root-ltr .ewa-bb-entry-link,.ewa-nov2-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-root-rtl .ewa-bb-entry-close,.ewa-nov2-rtl .ewa-bb-entry-close{left:2px}.ewa-root-rtl .ewa-bb-content,.ewa-nov2-rtl .ewa-bb-content{margin-left:26px}.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-root-rtl .ewa-bb-entry-link,.ewa-nov2-rtl .ewa-bb-entry-link{margin-right:8px}")}
b.d(E,"a",function(){return a});var c=b(567)},1265:function(t,E,b){function a(f,v,m,x,l,u,A){A=void 0===A?null:A;var z=n.call(this)||this;z.KI=null;z.La=v;z.BX=x;z.Dga=u;z.jb=f;z.xs=l;z.Ue=m;z.Aib=z.jb.qa("SaveToHostWithExtraCharsInFileName");z.Ah=A;z.kc(1,CommonUIStrings.l_SaveButtonLabel);return z}b.d(E,"a",function(){return a});t=b(0);var c=b(15),d=b(84);E=b(150);var e=b(4),h=b(44),k=b(29),n=E.a;$k(a,n);a.prototype.kIe=function(f,v){this.$K(1,!!f&&f!==v);this.KI=document.getElementById(a.KSe);
h.a.addHandler(this.KI,"change",Object(d.a)(this,this.unc,"onFileNameChange"));h.a.addHandler(this.KI,"input",Object(d.a)(this,this.unc,"onFileNameChange"));this.KI.focus()};a.prototype.Q9b=function(f){return this.Aib?(new RegExp("["+this.z8b('\\/:*?"<>|')+"]")).test(f):(new RegExp("["+this.z8b('\\/:*?"<>|#{}%~&')+"]")).test(f)};a.prototype.z8b=function(f){return f.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")};a.prototype.aid=function(){var f=k.a.oq(e.AFrameworkApplication.cm.Pm);this.$K(1,
!!this.KI&&""!==this.KI.value&&this.KI.value!==f)};a.prototype.unc=function(){var f=this;this.KI&&window.setTimeout(function(){f.aid()},0)};a.prototype.P9b=function(f,v){if(1!==f)c.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{f=v[a.KSe];v=a.IFf in v?v[a.IFf]:!1;c.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",k.a.Prc(f),v);var m=k.a.l4(e.AFrameworkApplication.fileName);(f=f?
f.trim():null)&&""!==f&&""!==m||1===this.ta.state?this.Q9b(f)?this.xs.create().displayError(1,f,v):this.Dga.boa(f+m,v,this.Ah):this.xs.create().displayError(2,f,v)}};a.prototype.dispose=function(){this.KI&&(h.a.removeHandler(this.KI,"change",Object(d.a)(this,this.unc,"onFileNameChange")),h.a.removeHandler(this.KI,"input",Object(d.a)(this,this.unc,"onFileNameChange")),this.KI=null);n.prototype.dispose.call(this)};of.Object.defineProperties(a.prototype,{ta:{configurable:!0,enumerable:!0,get:function(){return this.Ue}}});
a.KSe="txtFileName";a.IFf="chkOverwrite";Object(t.a)(a,"FileNameDialogBase",E.a,[])},1266:function(t,E,b){function a(x,l,u,A){this.tWb=null;this.Ewg=x;this.jb=u;this.Jce=l;this.sae=new d.a;this.qh=A}b.d(E,"a",function(){return a});t=b(0);var c=b(15),d=b(162),e=b(84),h=b(4),k=b(748),n=b(1056),f=b(397),v=b(107),m=b(25);a.prototype.y7a=function(){return this.jb.qa("SaveToCloudStorageUIIsEnabled")};a.prototype.pWe=function(){return m.a.saveToCloudStorage};a.prototype.R1b=function(){f.a.SHd(Object(e.a)(this,
this.jWf,"saveToCloudActionDispatcher"));f.a.k8c([new n.a(m.a.saveToCloudStorage,v.a.frame,0)],this.Jce.n4a())};a.prototype.Ag=function(){var x=this,l=this.Jce.n4a();l?(l.T9(function(){x.sae.setResult(!0)}),this.R1b()):c.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")};a.prototype.uNf=function(){c.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")};a.prototype.jWf=function(x,l,u,A,z){var y=this;return l.contextId!==
v.a.frame||x!==this.pWe()?2:this.y7a()?1===u?k.SessionStatusManager.instance.jxb||h.AFrameworkApplication.h5?8:32:2===u?(this.uNf(),z&&z.FileDownloadUrl&&c.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.qh&&(this.tWb=this.qh.sc("DialogShown","SaveToOneDriveReponseTime")),this.sae.task.continueWith(function(){y.tWb&&(y.tWb.stop(),y.tWb=null);y.Ewg.start(z)}),32):8:8};Object(t.a)(a,"SaveToCloudStorageActor",null,[809])},1267:function(t,E,b){function a(l,u,
A,z,y){this.Q8=this.rm=this.PCa=null;this.xDa=!1;this.Ah=this.Cga=null;this.JSc=l;this.flb=u;this.xs=A;this.Ue=z;this.qh=y}b.d(E,"a",function(){return a});t=b(0);var c=b(15),d=b(84),e=b(1268),h=b(4),k=b(42),n=b(39),f=b(250),v=b(396),m=b(170),x=b(987);a.prototype.DMb=function(){this.Ue&&1===this.Ue.state||(this.rm=this.flb(),this.rm.message=CommonUIStrings.l_CommentProgressTooltip,this.rm.Rb=5,this.rm.Su=!1,this.rm.TAa(CommonUIStrings.l_DefaultDialogTitle,null,null))};a.prototype.DIa=function(){this.rm&&
(this.rm.close(),this.rm=null)};a.prototype.eS=function(){1!==h.AFrameworkApplication.ta.state&&this.xs().displayError(e.a.default)};a.prototype.cQa=function(){c.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");n.a.Te(this.Q8,n.a.sX(3),void 0,"UploadToCloudManager.RedirectToFolder")};a.prototype.bQa=function(l){var u=!1,A=!1;h.AFrameworkApplication.fa&&(u=h.AFrameworkApplication.fa.qa("SaveACopyIsEnabledForUiHost"),A=h.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures"));
c.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",l,u);if(u&&A){c.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var z={};z[v.a.XPa]="1";z[v.a.documentUrl]=l;h.AFrameworkApplication.iV().execute(function(y){y.wj(m.a.Sta,z)})}else n.a.Te(l,n.a.sX(3),void 0,"UploadToCloudManager.RedirectToEditUrl")};a.prototype.boa=function(l,u,A,z){A=void 0===A?null:A;z=void 0===z?null:z;c.ULS.sendTraceTag(7143886,
216,50,"Starting to upload file");this.qh&&(this.Cga=this.qh.sc("DialogShown","SaveToOneDriveUploadTime"));this.DMb();this.Q8=u;this.PCa=this.JSc.create(l,A,z);this.Ah=z;this.jQ()};a.prototype.jQ=function(){c.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.PCa.execute(Object(d.a)(this,this.pSi,"onSaveToCloudUploadFinished"),Object(d.a)(this,this.oSi,"onSaveToCloudUploadFailed"))};a.prototype.pSi=function(l){this.DIa();this.xDa=!1;if(l&&l.data&&l.data.Rd){var u=k.d(l.data.Rd);
var A=u.Ot;if(u.returnValue)if(A.StatusCode!==f.a.QO&&A.StatusCode!==f.a.Wrb)c.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.eS();else{c.ULS.sendTraceTag(6590603,216,50,"UploadToCloudManager upload success.");try{A.NewDocumentUrl&&""!==A.NewDocumentUrl?this.bQa(A.NewDocumentUrl):this.cQa()}catch(z){c.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",z.toString())}this.DGb()}else A={},c.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",
(A.ResponseData=x.a.afb(l.data.Rd),A)),this.eS()}else c.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.eS()};a.prototype.oSi=function(l){5!==l.data.status&&12!==l.data.status||this.xDa?(c.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",l.data.status),this.DIa(),this.eS(),this.DGb()):(c.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.xDa=!0,this.jQ())};a.prototype.DGb=function(){this.Cga&&
(this.Cga.stop(),this.Cga=null)};Object(t.a)(a,"UploadToCloudManager",null,[806])},1268:function(t,E,b){function a(){}b.d(E,"a",function(){return a});t=b(0);a.default=0;Object(t.a)(a,"SaveToCloudErrorCodes",null,[])},1269:function(t,E,b){function a(k,n,f,v,m,x){this.Ah=null;this.zxg=k;this.g2=n;this.wmb=f;this.jb=v;this.dRb=m;this.xs=x}b.d(E,"a",function(){return a});t=b(0);var c=b(15),d=b(84),e=b(1268),h=b(83);a.prototype.start=function(k){this.Ah=k;if("SharePointOnlineConsumer"===this.jb.Wa("FileSource")){var n=
h.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(n){n.start(null,k);return}}this.g2.WLa?(c.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),this.iVg()):(c.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),this.showSignInDialog())};a.prototype.showSignInDialog=function(){this.zxg.create().aQ()};a.prototype.gj=function(){this.xs().displayError(e.a.default)};a.prototype.iVg=function(){try{c.ULS.sendTraceTag(6590561,
216,50,"Initializing OneDrive API");var k={},n=(k.client_id=this.jb.appSettings.UploadToSkyDriveClientId,k.env="INT",k);if(1===this.dRb||2===this.dRb)k={},n=(k.client_id=this.jb.appSettings.UploadToSkyDriveClientId,k);k={};var f=(k.mode="save",k.lightbox="grey",k);WL.init(n);c.ULS.sendTraceTag(6590562,216,50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog(f).then(Object(d.a)(this,this.onSuccess,"onSuccess"),Object(d.a)(this,this.r6,"onFailure"))}catch(v){c.ULS.sendTraceTag(6590563,
216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",v,v.stack),this.gj()}};a.prototype.onSuccess=function(k){c.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");k&&k.data&&k.data.folders&&this.wmb.boa(k.data.folders[0].id,k.data.folders[0].urls.viewInBrowser,null,this.Ah)};a.prototype.r6=function(k){if(k&&k.error){if("user_canceled"===k.error.code){c.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}c.ULS.sendTraceTag(6590594,
216,50,"File Dialog returned with error code:{0}, and error message: {1}",k.error.code,k.error.message)}else c.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.gj()};Object(t.a)(a,"SaveToCloudManager",null,[810])},1270:function(t,E,b){function a(k,n){k=h.call(this,k,n)||this;c.ULS.sendTraceTag(537170201,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");k.title="";k.message=a.Qxa;k.Sva=!0;return k}b.d(E,"a",function(){return a});t=b(0);var c=b(15),
d=b(39),e=b(81);b=b(929);var h=b.a;$k(a,h);a.prototype.fma=function(k){h.prototype.fma.call(this,k);d.a.openWindow(4,e.a.dH(a.xof))};a.prototype.RC=function(k){h.prototype.RC.call(this,k);a.gvd&&a.gvd(null)};a.initialize=function(k,n,f,v){c.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");a.Qxa=k;a.yof=n;a.xof=f;a.gvd=v};of.Object.defineProperties(a.prototype,{linkText:{configurable:!0,enumerable:!0,get:function(){return a.yof}}});a.Qxa=null;a.yof=null;a.xof=null;
a.gvd=null;Object(t.a)(a,"WacGdprNoticeBusinessBarEntry",b.a,[])},1271:function(t,E,b){function a(){}b.d(E,"a",function(){return a});t=b(0);a.Pnh="ewa-bb";a.Rnh="ewa-bb-entry";a.Znh="ewa-bb-react";a.Snh="ewa-bb-entry-body";a.Ynh="ewa-bb-icon";a.Unh="ewa-bb-entry-icon";a.Xnh="ewa-bb-entry-title";a.Wnh="ewa-bb-entry-message";a.MMe="ewa-bb-entry-button";a.Vnh="ewa-bb-entry-link";a.Tnh="ewa-bb-entry-close";a.NMe="ewa-bb-entry-button-holder";a.Qnh="ewa-bb-content";Object(t.a)(a,"CssClassNames",null,[])},
1272:function(t,E,b){function a(d,e){d=c.call(this,d,e)||this;d.Ru=!0;d.title=a.hpa;d.message=a.fpa;return d}b.d(E,"a",function(){return a});t=b(0);b=b(929);var c=b.a;$k(a,c);a.prototype.mo=function(d){c.prototype.mo.call(this,d);(d=a.gpa)&&d(null)};a.initialize=function(d,e,h,k){a.hpa=d;a.fpa=e;a.epa=h;a.gpa=k};of.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.epa}}});a.hpa=null;a.fpa=null;a.epa=null;a.gpa=null;Object(t.a)(a,"AutomaticSensitivityLabelBusinessBarEntry",
b.a,[])},1273:function(t,E,b){function a(d,e){d=c.call(this,d,e)||this;d.Ru=!0;d.title=a.hpa;d.message=a.fpa;return d}b.d(E,"a",function(){return a});t=b(0);b=b(929);var c=b.a;$k(a,c);a.prototype.mo=function(d){c.prototype.mo.call(this,d);(d=a.gpa)&&d(null)};a.initialize=function(d,e,h,k){a.hpa=d;a.fpa=e;a.epa=h;a.gpa=k};of.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.epa}}});a.hpa=null;a.fpa=null;a.epa=null;a.gpa=null;Object(t.a)(a,"RecommendedSensitivityLabelBusinessBarEntry",
b.a,[])},1274:function(t,E,b){function a(d,e){d=c.call(this,d,e)||this;d.Ru=!0;d.title=a.hpa;d.message=a.fpa;return d}b.d(E,"a",function(){return a});t=b(0);b=b(929);var c=b.a;$k(a,c);a.prototype.mo=function(d){c.prototype.mo.call(this,d);(d=a.gpa)&&d(null)};a.initialize=function(d,e,h,k){a.hpa=d;a.fpa=e;a.epa=h;a.gpa=k};of.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.epa}}});a.hpa=null;a.fpa=null;a.epa=null;a.gpa=null;Object(t.a)(a,"MandatorySensitivityLabelBusinessBarEntry",
b.a,[])},1275:function(t,E,b){function a(d,e){d=c.call(this,d,e)||this;d.Ru=!0;d.title=a.TCb;d.message=a.Qxa;return d}b.d(E,"a",function(){return a});t=b(0);b=b(929);var c=b.a;$k(a,c);a.prototype.mo=function(d){c.prototype.mo.call(this,d);a.Sxa&&a.Sxa(null)};a.initialize=function(d,e,h,k){a.TCb=d;a.Qxa=e;a.B8a=h;a.Sxa=k};of.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.B8a}}});a.TCb=null;a.Qxa=null;a.B8a=null;a.Sxa=null;Object(t.a)(a,"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",
b.a,[])},1276:function(t,E,b){function a(d,e){d=c.call(this,d,e)||this;a.B8a&&a.Sxa&&(d.Ru=!0);d.title=a.TCb;d.message=a.Qxa;return d}b.d(E,"a",function(){return a});t=b(0);b=b(929);var c=b.a;$k(a,c);a.prototype.mo=function(d){c.prototype.mo.call(this,d);a.Sxa&&a.Sxa(null)};a.initialize=function(d,e,h,k){a.TCb=d;a.Qxa=e;a.B8a=h;a.Sxa=k};of.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.B8a}}});a.TCb=null;a.Qxa=null;a.B8a=null;a.Sxa=null;Object(t.a)(a,
"SensitivityApplicationSetLabelErrorBusinessBarEntry",b.a,[])},1277:function(t,E,b){b.d(E,"a",function(){return a});var a;"undefined"==typeof a&&(a={});window.MSOJS=a;a.Agb=function(){function c(){return f()&&(y()||3<=(u()?w("version/"):0))}function d(){return 0<=window.navigator.userAgent.indexOf("Windows")}function e(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function h(){Ka||(Ka=!0,eb=k("Windows Phone"))}function k(Ba){Ba=(new RegExp(Ba+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);
var la=-1;return null!=Ba&&2<=Ba.length&&(la=parseFloat(Ba[1]),isNaN(la)&&(la=-1)),la}function n(){return"function"==typeof navigator.msLaunchUri&&!e()&&!z()&&!v()}function f(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function v(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function m(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function x(){return m()?8==window.document.documentMode:!1}function l(){return 0<=
window.navigator.userAgent.indexOf(" Firefox/")}function u(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function A(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function z(){var Ba=window.navigator.userAgent.toLowerCase();return 0<=Ba.indexOf("android")&&0<=Ba.indexOf("chrome")}function y(){return 3<=(l()?w("firefox/"):0)}function w(Ba){var la=window.navigator.userAgent.toLowerCase(),ka=la.indexOf(Ba),ca,Ia;return 0<=ka?(ca=ka+Ba.length,Ia=la.length,parseInt(la.substring(ca,
Ia))):0}function D(Ba,la,ka,ca,Ia){if(ca&&null!=la)la();else if(n())navigator.msLaunchUri(Ba,la,ka);else if(!(A()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&f())||v())F(Ba,la,ka);else if(A()&&Ia)a:{try{window.open(Ba,"_self")}catch(jb){null!=ka&&ka();break a}null!=la&&la()}else H(Ba,la,ka)}function H(Ba,la,ka){var ca=document.getElementById("OICLinkTag"),Ia;null==ca&&(ca=document.createElement("a"),ca.id="OICLinkTag",
ca.style.visibility="hidden",ca.href="",ca.target=0==(Wb.Options&oc.SupportsTopTargetNavigation)||Wb.NoBrowserModalDialogs?"_blank":"_top",document.body.appendChild(ca),null!=ca.addEventListener&&ca.addEventListener("click",function(jb){null!=jb.stopPropagation&&jb.stopPropagation()},!1));try{"undefined"==typeof MouseEvent&&(Ia=function(jb){var nb=document.createEvent("MouseEvent");return nb.initMouseEvent(jb,!1,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),nb},Ia.prototype=Event.prototype,window.MouseEvent=
Ia),ca.href=Ba,ca.dispatchEvent(new MouseEvent("click"))}catch(jb){null!=ka&&ka();return}null!=la&&la()}function F(Ba,la,ka){var ca=document.getElementById("OICFrame");null==ca&&(ca=document.createElement("iframe"),ca.className="ObjectInDialog",ca.style.visibility="hidden",ca.src="about:blank",document.body.appendChild(ca),ca.id="OICFrame");try{ca.contentWindow.location.href=Ba}catch(Ia){null!=ka&&ka();return}null!=la&&la()}function J(Ba){return 0!=(Ba.Options&oc.SkipProtocolHandler)||x()}function S(Ba){return Ba===
yb.ReadOnly||Ba===yb.ReadWrite}function N(Ba,la,ka,ca){var Ia,jb;try{if(Ia=new ActiveXObject(bb),Ia)return jb=Ia.ViewDocument3(window.self,Ba,la,ca),jb?(xa(dc.O14ActiveX),Jb.None):Jb.Failed}catch(nb){}if(oc.O14Only===(ka&oc.O14Only))return Wb.DescriptiveUnattemptedEnums?Jb.O14AttemptFailure:Jb.Unattempted;try{if(Ia=new ActiveXObject(ba),Ia)return jb=Ia.ViewDocument3(window.self,Ba,la,ca),jb?(xa(dc.O12ActiveX),Jb.None):Jb.Failed}catch(nb){}if(oc.O12UpOnly===(ka&oc.O12UpOnly))return Wb.DescriptiveUnattemptedEnums?
Jb.O12UpOnlyFail:Jb.Unattempted;try{if(Ia=new ActiveXObject(fa),Ia)return jb=S(la)?Ia.ViewDocument2(window.self,Ba,ca):Ia.EditDocument2(window.self,Ba,ca),jb?(xa(dc.O11ActiveX),Jb.None):Jb.Failed}catch(nb){}return Wb.DescriptiveUnattemptedEnums?Jb.ActiveXUnattempted:Jb.Unattempted}function T(Ba,la,ka,ca,Ia){var jb,nb,Na;Ba==$a.Visio&&ka==yb.ReadWrite&&(ka=yb.WriteOnly);Ba=Ia;(ca=ca||e()&&!(h(),8<=eb))||(jb="",jb+=S(ka)?aa+ma:Ea,jb+=Ha,Ba+=I(jb));Ba+=I(la);Wb.NewTelemetryDataIsEnabled&&(nb=-1!==Ba.indexOf("?")?
"&":"?",nb+=Wb.SessionOrigin?"OR="+Wb.SessionOrigin+"&":"",nb+=Wb.ClickTime?"CT="+Wb.ClickTime+"&":"",nb+=Wb.CorrelationId?"CID="+Wb.CorrelationId:"",nb="?"!=nb?nb:"",nb="&"!=nb.slice(-1)?nb:nb.slice(0,-1),Ba+=I(nb),Wb.CorrelationIdForWinClient&&(Ba+=I(Wb.CorrelationIdForWinClient)));la=window.location.href;ka=V;ca=la.toLowerCase().indexOf("&"+ka+"=");var sa;ka=-1==ca?void 0:(Na=ca+(ka.length+2),sa=la.indexOf("&",Na),-1==sa)?la.substr(Na):la.substring(Na,sa);if(null!=ka&&"undefined"!=typeof ka){Na=
"";try{Na=decodeURIComponent(ka)}catch(Wa){}0<Na.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Na)&&(Ba+=Aa,Ba+=Na)}return Ba}function G(Ba,la,ka,ca,Ia,jb){var nb=ea(Ba),Na;return null==nb?(Z(Wb.DescriptiveUnattemptedEnums?Jb.ProtocolHandlerIsNull:Jb.Unattempted,Wb.Application),!1):(Na=T(Ba,la,ka,ca,nb),D(Na,K,L,Ia,jb),!0)}function I(Ba){if(f()&&A()){var la="";try{la=decodeURI(Ba)}catch(ka){}if(la==Ba)return encodeURI(Ba)}return Ba}function K(){xa(dc.ProtocolHandler)}function L(){Wb.Options|=
oc.SkipProtocolHandler;da(Wb,cb,Sa)}function O(){null!=Db&&Db(dc.RoamingProtocolHandler)}function B(){null!=Ab&&Ab(Jb.ControlNeeded)}function Q(){var Ba=document.getElementById(oa),la;if(null==Ba){if(la=ra,f()&&3<=(u()?w("version/"):0)&&U(pa,!0)&&(la=pa),!U(la,!0))if(f()&&U(Ma,!0))la=Ma;else return null;Ba=document.createElement("object");Ba.id=oa;Ba.type=la;Ba.style.width="0px";Ba.style.height="0px";Ba.style.setProperty("visibility","hidden","");document.body.appendChild(Ba);Ba=document.getElementById(oa)}return Ba}
function U(Ba,la){var ka=window.navigator.mimeTypes,ca;return null==ka?!1:(ca=ka[Ba],ca)?la&&!ca.enabledPlugin?!1:!0:!1}function X(Ba){try{if(null!=new ActiveXObject(Ba))return!0}catch(la){}return!1}function P(Ba){switch(Ba){case $a.OneNote:return ta;default:return""}}function ea(Ba){if(Ba!=$a.OneNote&&e()&&!(h(),8<=eb))return"office:";switch(Ba){case $a.Excel:return"ms-excel:";case $a.OneNote:return"onenote:";case $a.PowerPoint:return"ms-powerpoint:";case $a.Visio:return"ms-visio:";case $a.Word:return"ms-word:";
case $a.Project:return"ms-project:";case $a.Publisher:return"ms-publisher:";case $a.Infopath:return"ms-infopath:";case $a.Access:return"ms-access:";default:return""}}function ia(Ba){switch(Ba){case $a.Excel:return"root\\office15\\excel.exe";case $a.PowerPoint:return"root\\office15\\powerpnt.exe";case $a.Visio:return"root\\office15\\visio.exe";case $a.Word:return"root\\office15\\winword.exe";case $a.Project:return"root\\office15\\winproj.exe";case $a.Publisher:return"root\\office15\\mspub.exe";case $a.Infopath:return"root\\office15\\infopath.exe";
case $a.Access:return"root\\office15\\msaccess.exe";default:return null}}function da(Ba,la,ka){if(Wb=Ba,cb=la,Sa=ka,Ba.DocumentUrl){var ca=ka=la=Ba.DocumentUrl;try{ca=decodeURIComponent(Ba.DocumentUrl)}catch(Wa){}try{ka=encodeURI(Ba.DocumentUrl)}catch(Wa){}Wb.NewTelemetryDataIsEnabled||(la=la+""+Ba.CorrelationIdForWinClient,ca+=Ba.CorrelationIdForWinClient,ka+=Ba.CorrelationIdForWinClient);Ba.Mode===yb.ReadWrite&&oc.CheckoutRequired===(Ba.Options&oc.CheckoutRequired)&&(Ba.Mode=yb.ForceCheckout);oc.HostIsEditOnly===
(Ba.Options&oc.HostIsEditOnly)&&(Ba.Mode=yb.WriteOnly);if(J(Ba)?0:f()&&(Ba.Application==$a.OneNote||U(Za,!1)||U(Ua,!1))||n()||z()||!(c()||y()||"ActiveXObject"in window&&!e()||A())||15<=ha())G(Ba.Application,Ba.EncodeUrl?ka:la,Ba.Mode,Ba.Application==$a.OneNote,Ba.SilentExternalHandler,Ba.NavigateUsingWindowOpen);else{var Ia;if(Ia=x())a:{var jb=Ba.EncodeUrl?la:ca,nb=Ba.Mode,Na=P(Ba.Application);try{Ia=(new ActiveXObject(va)).ViewDocument3(window.self,jb,nb,Na);break a}catch(Wa){}Ia=!1}if(Ia)xa(dc.O15ActiveX);
else{if(c()||y()){var sa=Ba.EncodeUrl?la:ca;ca=Ba.Mode;Ia=P(Ba.Application);jb=Q();if(null==jb)sa=Wb.DescriptiveUnattemptedEnums?Jb.PluginIsNull:Jb.Unattempted;else{nb=!1;try{nb=jb.ViewDocument3(window.self,sa,ca,Ia)}catch(Wa){}if(!nb)try{nb=S(ca)?jb.ViewDocument2(window.self,sa,Ia):jb.EditDocument2(window.self,sa,Ia)}catch(Wa){}sa=nb?(xa(dc.NpapiPlugin),Jb.None):Jb.Failed}}else{try{sa=new ActiveXObject(ja),null!=sa&&sa.SaveSSOCreds()}catch(Wa){}sa=N(Ba.EncodeUrl?la:ca,Ba.Mode,Ba.Options,P(Ba.Application))}if(sa!=
Jb.None){if(ca=Ba.CouldUseRoamingApps)ub||(ub=!0,vb=k("Windows NT")),ca=6.1<=vb&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(m()||y()||A());if(ca&&Ba.Application!=$a.OneNote){if(!a.Agb.j_j()){Z(Jb.ControlNeeded,Wb.Application);return}if(Ba.RoamingAppsLauncher){"undefined"==typeof Ba.RoamingAppsLauncher||null==Ba.RoamingAppsLauncher?Z(Wb.DescriptiveUnattemptedEnums?Jb.RoamingLauncherIsNull:Jb.Unattempted,Wb.Application):"undefined"==typeof Ba.RoamingBitsUrl||null==Ba.RoamingBitsUrl?a.Agb.B_j(Ba.DocumentUrl,
Ba.RoamingAppsLauncher,Ba.Application,Ba.ApplicationParameters,cb,Sa):a.Agb.Jjg(Ba.DocumentUrl,Ba.RoamingAppsLauncher,Ba.RoamingApplicationExe,Ba.ApplicationParameters,Ba.RoamingPlatform,Ba.RoamingBitsUrl,cb,Sa);return}if(!Ba.ContinueIfLauncherIsNull){Z(Jb.LauncherNeeded,Wb.Application);return}}oc.NoProtocolHandlerFallback==(Ba.Options&oc.NoProtocolHandlerFallback)||J(Ba)||m()||f()&&!(Wb.DescriptiveUnattemptedEnums?sa>=Jb.O14Unattempted&&sa<=Jb.DocumentUrlIsNull:sa==Jb.Unattempted)?Z(sa,Wb.Application):
G(Ba.Application,Ba.EncodeUrl?ka:la,Ba.Mode,Ba.Application==$a.OneNote,Ba.SilentExternalHandler,Ba.NavigateUsingWindowOpen)}}}}else Z(Wb.DescriptiveUnattemptedEnums?Jb.DocumentUrlIsNull:Jb.Unattempted,Wb.Application)}function xa(Ba){null!=cb&&cb(Ba)}function Z(Ba,la){"undefined"==typeof la&&(la=null);null!=Sa&&Sa(Ba,la)}function ha(){var Ba=0;if(c()||y()||A()){var la=Q();try{null!=la&&(Ba=la.GetOfficeVersion())}catch(ka){}}else X(va)?Ba=15:X(bb)?Ba=14:X(ba)?Ba=12:X(fa)&&(Ba=11);return Ba}function ya(){return f()&&
(U(ra,!0)||U(pa,!0))}var va="SharePoint.OpenDocuments.5",bb="SharePoint.OpenDocuments.4",ba="SharePoint.OpenDocuments.3",fa="SharePoint.OpenDocuments.2",ra="application/x-sharepoint",pa="application/x-sharepoint-webkit",Za="application/x-sharepoint-protocolhandler",Ua="application/x-sharepoint-webkit-protocolhandler",Ma="application/officelive",oa="npSharePointPlugin",ja="IDBHO.IDBHOCtrl",ta="OneNote.Notebook",aa="ofv|",ma="ofc|",Ea="ofe|",Ha="u|",Aa="|f|",V="wdlor",La="",Ra="",pb="",cb,Sa,Db,Ab,
Wb,ub,vb,Ka,eb,yb={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},oc={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},Jb={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},
dc={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},$a={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:yb,OpenDocumentOptions:oc,OpenDocumentFailureType:Jb,OpenDocumentControl:dc,OfficeApplication:$a,EditDocumentInClient:da,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=
0;this.Application=$a.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:ha,
IsO14MacPluginInstalled:ya,OfferOfficeInDialog:function(){return d()&&11>=ha()},OfferOfficeNoIntrusive:function(){return d()&&15>ha()},OfferMacOffice:function(){return f()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!ya()},InstallRoamingControl:function(){l()?window.InstallTrigger.install({Office:{URL:Ra}}):F(pb,null,null)},CanUseRoamingControl:function(){var Ba,la,ka;if(n())return!0;if(A())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];
if(l())return Ba=document.createElement("RoamingExtensionElement"),document.documentElement.appendChild(Ba),la=document.createEvent("Events"),la.initEvent("RoamingOfficeInstalled",!0,!1),Ba.dispatchEvent(la),!!Ba.getAttribute("installed");if(m())try{return ka=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),ka.HrExists()}catch(ca){}return!1},InitUrls:function(Ba,la,ka){La=Ba;Ra=ka;pb=la},LaunchRoamingApps:function(Ba,la,ka,ca,Ia,jb){a.Agb.Jjg(Ba,la,ia(ka),ca,"x86",La,Ia,jb)},LaunchRoamingApps2:function(Ba,
la,ka,ca,Ia,jb,nb,Na){var sa="",Wa;if(null!=ca&&(sa+=" "+ca),null!=Ba&&(sa+=' "'+Ba+'"'),n()||A())Db=nb,Ab=Na,nb='office: "'+(jb+'" "')+(ka+'" "ROAMING"'),nb+=' "'+la+'"',nb+=' "'+Ia+'"',nb+=" "+sa,D(nb,O,B,!1,!1);else if(l())Ba=document.createElement("RoamingExtensionElement"),Ba.setAttribute("cabUrl",jb),Ba.setAttribute("app",ka),Ba.setAttribute("licensingEntitlements",la),Ba.setAttribute("platform",Ia),Ba.setAttribute("args",sa),document.documentElement.appendChild(Ba),la=document.createEvent("Events"),
la.initEvent("RoamingOfficeLaunch",!0,!1),Ba.dispatchEvent(la),null!=nb&&nb(dc.RoamingFFExtension);else if(m()){if(Wa=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=Wa)try{Wa.HrConfigureSingle(jb,ka,la,Ia,sa),null!=nb&&nb(dc.RoamingActiveX)}catch(Hb){}}else null!=Na&&Na(Jb.Failed)},ShouldShowDialog:function(){return!e()},NavigateToUrlUsingClickingOnATag:H,OpenDocumentWithProtocolHandler:G,OpenDocumentWithProtocolHandlerNoCallBack:function(Ba,la,ka,ca){var Ia=ea(Ba),jb;return null==
Ia?(Z(Wb.DescriptiveUnattemptedEnums?Jb.ProtocolHandlerNoCallbackIsNull:Jb.Unattempted,Wb.Application),!1):(jb=T(Ba,la,ka,ca,Ia),D(jb,null,null,!1,!1),!0)}}}();a.ClientUtils=a.Agb},1278:function(t,E,b){function a(d,e){this._url=d;this.uug=e}b.d(E,"a",function(){return a});t=b(0);var c=b(39);a.prototype.Gse=function(){};a.prototype.R6c=function(){this.uug?c.a.downloadFile(this._url):c.a.Te(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")};a.prototype.dispose=function(){};
Object(t.a)(a,"OpenUrlInTabDialogDownloadBehavior",null,[59,6])},1279:function(t,E,b){function a(){c.a.ti('.HyperlinkDialog .ewa-dlg-body-sectionlabel{margin-bottom:5px}.HyperlinkDialog .disabledInput{background-color:#ebebe4;border:solid 1px #b5b5b5}.HyperlinkDialog .ewa-dlg-body-fullLine{width:inherit;min-width:318px;padding-right:5px;padding-left:25px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-fullLine{padding-right:25px;padding-left:5px}.HyperlinkDialog input[type="text"]{width:100%;outline:none;padding-left:3px;border:solid 1px #ccc}.HyperlinkDialog .ewa-dlg-body-sectionbreak{height:50px;position:relative}.HyperlinkDialog input[type="radio"]{position:absolute;left:0}.ewa-dlg-elements-container-rtl .HyperlinkDialog input[type="radio"]{left:auto;right:0}.HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-left:24px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-right:24px;margin-left:auto}.ValidationLabel{position:relative;display:block}.ValidationLabelWarning{color:#cc4200}.ValidationLabelError{color:#d90000}.ValidationWarningGlowColor,.ValidationErrorGlowColor,.ValidationLableGlow{border-style:solid;border-width:1px;transition:all .2s ease-in-out}.HyperlinkDialog div .ValidationErrorGlowColor{box-shadow:0 0 2px #d90000;border-color:#d90000}.HyperlinkDialog div .ValidationWarningGlowColor{box-shadow:0 0 2px #cc4200;border-color:#cc4200}')}
b.d(E,"a",function(){return a});var c=b(567)},1280:function(t,E,b){function a(k,n,f,v,m,x){this.UX=k;this.VX=n;this.aKc=f;this.xD=v;this.ySb=m;this.SUa=x}b.d(E,"a",function(){return a});t=b(0);var c=b(1406),d=b(4),e=b(52),h=b(83);a.prototype.u6i=function(k){this.Ltf(k)};a.prototype.jti=function(k){this.Ltf(k)};a.prototype.Ltf=function(k){var n=10;1===k?(h.a.instance.resolve("Common.IOfficeTrialExperience").Rjc(this.SUa),n=3):2===k&&((!this.aKc||this.aKc(this.xD))&&this.VX&&c.a.instance.A9g(this.VX,
this.UX,this.xD),n=5);(0===k||1===k)&&this.UX&&this.UX(this.xD);d.AFrameworkApplication.Ctc(e.a.kFf,this.ySb,n);this.dispose()};a.prototype.dispose=function(){this.xD=this.VX=this.UX=null};of.Object.defineProperties(a.prototype,{X3f:{configurable:!0,enumerable:!0,get:function(){return!this.VX&&!this.aKc}},ptf:{configurable:!0,enumerable:!0,get:function(){return 2===this.SUa?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}},id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialogWithTrial"}},
nMe:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMessageNoOffice}},j9e:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}},Xva:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},Q7e:{configurable:!0,enumerable:!0,get:function(){return"OICFailure"}},icon:{configurable:!0,enumerable:!0,get:function(){return 3}},xYb:{configurable:!0,enumerable:!0,get:function(){return 2===this.SUa?
CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}},zl:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});Object(t.a)(a,"AOICErrorDialogWithTrial",null,[6])},1281:function(t,E,b){function a(){this.BaseDocQuerySignature=null;this.RoamingApp=0}b.d(E,"a",function(){return a});t=b(0);var c=b(1569),d=b(4),e=b(42),h=b(81);a.prototype.WNd=function(){return e.c([this.Raa(),this])};a.prototype.execute=function(k,n,f){var v=
"RoamingAppsHandler.ashx";c.a.instance.roamingAppsAreEnabled&&0<document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")&&(v=h.a.wl(v,"wdEnableRoaming","1"));d.AFrameworkApplication.nd.Zl(v,2,this.WNd(),{"Content-Type":"application/json; charset=utf-8"},!1,this.pwb(),k,n,f,void 0,void 0,void 0,void 0,"6")};Object(t.a)(a,"ARoamingAppsRequest",null,[])},1282:function(t,E,b){function a(){c.a.ti(".ewa-presentMode-overlay{pointer-events:none}.ewa-presentMode-panel-container{z-index:1054;position:absolute;bottom:32px;visibility:hidden}.ewr-presentMode-on .ewa-presentMode-panel-container{visibility:visible}.ewa-presentMode-rowHdrParent-container{position:relative;z-index:1055}.ewa-presentMode-right-frame{position:absolute;bottom:32px;top:0;right:0;width:0;opacity:0;background-color:#f5f5f5}.ewr-presentMode-on .ewa-presentMode-right-frame{width:32px;opacity:1;background-color:#323130}.ewr-presentMode-on-rtl .ewa-presentMode-right-frame{width:0;opacity:0}.ewr-presentMode-on-headers-off .ewa-presentMode-right-frame{width:12px !important;opacity:1}.ewr-namedsheetview .ewa-presentMode-right-frame{background-color:#000 !important}.ewr-presentMode-transition .ewa-presentMode-right-frame{transition:background-color .4s linear}.ewr-presentMode-on #dialogHost{z-index:1056 !important}")}
b.d(E,"a",function(){return a});var c=b(567)},1283:function(t,E,b){function a(){c.a.ti('.PrintDialogBody{height:260px;width:516px;margin-top:17px}.PrintDialogTitle{font-size:21px;margin-top:14px;margin-left:18px;font-family:"Segoe UI Light"}.ewa-dlg-elements-container-rtl .PrintDialogTitle{margin-left:auto;margin-right:18px}.PrintDialogLeftContainer{float:left;width:240px;height:100%;font-size:14px;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogLeftContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRightContainer{float:left;font-size:14px;width:240px;height:inherit;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogRightContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRadioButtonContainer{width:224px;height:32px;display:flex;align-items:center}.PrintRadioButtonElementInnerDiv{vertical-align:middle;display:table-cell}.PrintRadioButtonElementOuterDiv{position:absolute;top:0;left:64px;height:32px;width:140px;vertical-align:middle;display:table}.ewa-dlg-elements-container-rtl .PrintRadioButtonElementOuterDiv{left:auto;right:64px}.PrintDialogTitleSection{width:224px;height:19px}.PrintDialogComboBoxContainer{width:224px;height:32px;margin-top:12px}.PrintRadioButtonIcon{margin:0 16px;vertical-align:middle}.PrintButtonArea{margin-right:32px}.ewa-dlg-elements-container-rtl .PrintButtonArea{margin-right:auto;margin-left:32px}.PrintPreviewerContainer{height:100%;width:100%;z-index:998;position:absolute;background:#edebe9}.ewa-hide-print-elements-siblings{display:none}')}
b.d(E,"a",function(){return a});var c=b(567)},1284:function(t,E,b){function a(){c.a.ti(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}")}b.d(E,"a",function(){return a});var c=b(567)},1290:function(t,E,b){function a(d){this.isEnabled=Boolean.parse(d.DirectPrintIsEnabled||"false");Boolean.parse(d.DirectPrintProbeIsEnabled||"false");this.gki=Boolean.parse(d.DirectPrintEnabledForInternetExplorer||"false");this.TSa=(d.DirectPrintSupportedMimeTypes||"").split(a.w6c);
this.USa=(d.DirectPrintSupportedPlugins||"").split(a.w6c);this.z9h=(d.DirectPrintImmersivePreviewPlugins||"").split(a.w6c);this.Wcf=Boolean.parse(d.DirectPrintEnabledForEdge||"false");this.Sgi=Boolean.parse(d.ChromePrintLayoutFixIsEnabled||"false");this.LYg=parseInt(d.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.Dwd=14;this.Eqf=14394;if(d=d.DirectPrintMinimalSupportedEdgeVersion){var e=d.split(".");2===e.length?(this.Dwd=parseInt(e[0]),this.Eqf=parseInt(e[1])):c.ULS.sendTraceTag(20734112,
208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",d)}else c.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}b.d(E,"a",function(){return a});t=b(0);var c=b(15);a.w6c=",";Object(t.a)(a,"DirectPrintBrsSettings",null,[])},1291:function(t,E,b){function a(){this.printOperationCallbacks=this.universalPrintAppSettings=this.setAdditionalHeaderText=this.disableBackToSheetButton=this.disableTellMeControl=
this.logger=this.printPreviewPaneCallbacks=this.backActionButtonText=null}b.d(E,"a",function(){return a});t=b(0);Object(t.a)(a,"PrintPreviewPaneProps",null,[])},1292:function(t,E,b){function a(){}b.d(E,"a",function(){return a});t=b(0);a.M1i="PrintDialogBody";a.printDialogTitle="PrintDialogTitle";a.I8b="ewa-dlg-elements-container-rtl";a.N1i="PrintDialogLeftContainer";a.O1i="PrintDialogRightContainer";a.sab="PrintDialogRadioButtonContainer";a.oJf="PrintRadioButtonElementInnerDiv";a.U1i="PrintRadioButtonElementOuterDiv";
a.uab="PrintDialogTitleSection";a.jFd="PrintDialogComboBoxContainer";a.V1i="PrintRadioButtonIcon";a.L1i="PrintButtonArea";a.zw="PrintPreviewerContainer";Object(t.a)(a,"CssClassNames",null,[])},1352:function(t,E,b){function a(){P.a.Fa(c.ka)}function c(Ob){return wc.call(this,Ob)||this}function d(Ob,nc,mb){var ic=this;this.ignorePrintArea=!1;this.xNj=function(){var qc=pa.g(ic.$).Ea;ic.aRc=!0;qc.xyd()};this.IQi=function(){ic.nid()};this.HQi=function(qc,hc,Jc){ia.ULS.sendTraceTag(537154272,0,10,"PrintCommandHandler:OnPageLayoutCommandFailure Method : "+
Jc+" failed to execute");ic.nid()};this.$=Ob;this.ea=Ob.ea;this.qia=nc;this.NN=new I(1,this.ignorePrintArea);this.fD=nc=new e(Ob,nc,da.AFrameworkApplication.nd,mb);this.$.da.Ga(418,nc);this.gJf=new w(Ob);this.$.da.Ga(384,this);this.aRc=!1}function e(Ob,nc,mb,ic){var qc=this;this.activeCell=this.selectedRange=this.lg=this.graphServiceEndpoint=null;this.e0=0;this.Em=this.dv=null;this.pH=new y;this.qk=new y;this.cca=0;this.U7a=null;this.oNb=!1;this.q3a=this.kGb=null;this.Npd=!1;this.R6a=this.iAb=!0;
this.sma=this.Zya=this.mNa=null;this.gzb=!1;this.R7a=null;this.j6a=this.vLc=!1;this.lAd=function(hc){if(!(hc&&hc.data&&hc.data.Rd&&hc.data.responseHeaders&&hc.data.Rd.length)){var Jc=hc?hc.data?hc.data.Rd?hc.data.responseHeaders?hc.data.Rd.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs";qc.lg&&(hc=qc.YQa(ra.a.instance.ga(1204)),
qc.SAa(hc,0));ia.ULS.sendTraceTag(593266765,0,10,"PrintPreviewManager:OnFileHandlerSuccessCallback - Invalid Parameter : "+Jc);qc.AKd&&(hc=Object(ka.a)(new Sb.a,{extendedProperties:new Map}),hc.extendedProperties.set("InvalidParameterName",Jc),Ia.Health.instance.recordQosError(Wa.a.iJf,[Hb.a.jJf],!1,!0,!0,!1,hc))}else if(0<qc.cca&&hc.data.id===qc.cca){if(hc.data.responseHeaders["Content-Type"]&&(dc.a.contains(hc.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)||dc.a.contains(hc.data.responseHeaders["Content-Type"].toString(),
"text/plain",!0))){ia.ULS.sendTraceTag(593266764,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - pdf converted successfully");var rd=null;dc.a.contains(hc.data.responseHeaders["Content-Type"].toString(),"text/plain",!0)&&(rd=qc.k6g(hc));Jc={};qc.MEb(Jc,null,null,rd);hc.data.responseHeaders["Total-Pdf-PageCount"]?(rd=parseInt(hc.data.responseHeaders["Total-Pdf-PageCount"].toString(),10),qc.gzb||(qc.mFd>=rd?qc.sma=rd:qc.gzb=!0),qc.R6a&&qc.lg&&qc.lg.setPageRangeSettings(rd,qc.mFd,qc.gzb,qc.Zya,
qc.sma)):ia.ULS.sendTraceTag(537154257,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - did not receive the TotalPdfPageCount header.")}else Jc=ub.a.Wh(hc.data.Rd),Jb.a.g$(Jc.Errors)||ib.a(qc.$).dd.eJ(Jc.Errors[0].MessageId),qc.$7i(Jc.Errors),qc.lg&&(rd=qc.YQa(Jc.Errors[0].Description),-1831476778===Jc.Errors[0].MessageId?(ia.ULS.sendTraceTag(537154256,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - showing pdf print timeout error message"),qc.SAa(rd,0,ra.a.instance.ga(1207))):qc.SAa(rd,
0)),297284985===Jc.Errors[0].MessageId?ia.ULS.sendTraceTag(570716892,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - Nothing to print. Message Id: "+Jc.Errors[0].MessageId):ia.ULS.sendTraceTag(593266763,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: "+Jc.Errors[0].MessageId);hc=hc.data.state;hc.r9c(Jc,hc.userContext,hc.methodName)}};this.kAd=function(hc){if(0<qc.cca&&hc.data.id===qc.cca){var Jc=Ha.a.xf(hc.data);qc.lg&&qc.SAa(qc.YQa(Jc[0].Description),
1);ia.ULS.sendTraceTag(593266762,0,15,"PrintPreviewManager:OnFileHandlerFailureCallback has failed - Errors: ["+Jb.a.Cc(Jc)+"]");Jc=hc.data.state;Jc.Aaa(hc,Jc.userContext,Jc.methodName);qc.$.userOperationManager.$ka.operation.Ena(function(){return qc.oNb})}};this.PJi=function(hc,Jc,rd){hc.Errors&&0<hc.Errors.length&&qc.lg?(Jb.a.g$(hc.Errors)||ib.a(qc.$).dd.eJ(hc.Errors[0].MessageId),qc.SAa(qc.YQa(hc.Errors[0].Description),0),ia.ULS.sendTraceTag(537154254,0,50,"PrintPreviewManager: Failed to convert workbook. Error message Id: "+
hc.Errors[0].MessageId)):(ia.ULS.sendTraceTag(537154253,0,50,"PrintPreviewManager:OnConvertWorkbookToPdfSucceededInWebParts - Pdf conversion succeeded"),qc.MEb(hc,Jc,rd,null))};this.OJi=function(hc){hc=Ha.a.xf(hc.data);qc.lg&&qc.SAa(qc.YQa(hc[0].Description),1);ia.ULS.sendTraceTag(537154252,0,15,"PrintPreviewManager:OnConvertWorkbookToPdfFailed invoked - Errors: ["+Jb.a.Cc(hc)+"]");qc.$.userOperationManager.$ka.operation.Ena(function(){return qc.oNb})};this.wAf=function(hc,Jc){if(Jc)switch(Jc.R1i){case 1:if(qc.qk&&
qc.q3a)switch(hc=qc.q3a.qc,qc.q3a.stop(),qc.q3a=null,qc.qk.wv){case 1:qc.Y_c(hc,4800,"ActiveSheet");break;case 0:qc.Y_c(hc,6100,"CurrentSelection");break;case 2:qc.Y_c(hc,7500,"EntireWorkbook")}break;case 0:qc.kGb&&(hc=qc.kGb.qc,qc.kGb.stop(),2400<hc&&(Jc=Object(ka.a)(new Sb.a,{extendedProperties:new Map}),Jc.extendedProperties.set("PaneLoadTime",hc.toString()),Ia.Health.instance.recordQosError(Wa.a.rEj,[Hb.a.D5f],!1,!0,!0,!1,Jc)),qc.dv.Hei(function(rd){qc.tCj(rd)}))}};this.yz=function(hc,Jc){(1===
Jc.Dq&&qc.mNa===Jc.If||2===Jc.Dq)&&qc.nLd()};this.$=Ob;this.qia=nc;this.f3=mb;this.hEb=ic;this.AKd=Aa.HelperMethods.i_;this.Pa=new hb.a;this.mFd=this.$.ya.PrintPreviewerPaginationRange;this.useMSPdfViewer=this.cAj();this.ybi();this.dgi=this.VXg();this.Mpd=va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebPrintFloodgateSurvey",!1);if(this.isUniversalPrintEnabled=!!ic&&ic.Y5a()&&va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&this.$.pe.get(116))this.graphServiceEndpoint=
this.$.ya.GraphServiceEndpoint}function h(){this.appName=this.disabledChangeGates=this.isUniversalPrintFlowEnabled=this.graphServiceEndpointVersion=this.graphServiceEndpoint=null}function k(){this.onBackToSheet=null}function n(){this.onNotifyPrintJobStatus=this.onClosePreviewer=this.getGraphServiceAuthorizationToken=this.onLocalPrint=null}function f(){this.selectedColor=this.selectedMargin=this.selectedScaling=this.selectedPaperSize=this.selectedOrientation=this.selectedWhatToPrint=0;this.selectedPrintGridlines=
this.selectedIgnorePrintArea=!1;this.selectedRowAndColumnHeadings=this.selectedVerticalCenter=this.selectedHorizontalCenter=this.selectedDraft=this.selectedPageEnd=this.selectedPageStart=null}function v(){this.onDropdownSettingsFocus=this.onPrint=this.onSettingChange=null}function m(Ob,nc,mb,ic,qc,hc){var Jc=l.call(this,qc)||this;Jc.Ad=!1;Jc.w5f=!1;Jc.rBd=function(rd){Jc.fD.rBd(rd)};Jc.ABd=function(rd){Jc.fD.ABd(rd)};Jc.nSi=function(){ia.ULS.sendTraceTag(537154190,0,50,"PrintSettingsManager.OnSavePrintSettingsToFileSuccess: Saving print settings to file successful.")};
Jc.mSi=function(rd){rd=Ha.a.xf(rd.data);ia.ULS.sendTraceTag(537154189,0,10,"PrintSettingsManager.OnSavePrintSettingsToFileFailure: Save print settings to file failed. Errors: "+Jb.a.Cc(rd)+".")};Jc.yz=function(rd,md){2===md.Dq?Jc.av.clear():1===md.Dq&&Jc.av&&Jc.av.contains(md.If)&&(ia.ULS.sendTraceTag(537154188,0,50,"PrintSettingsManager.OnQueueChanged: web method "+ob.a(md.If.operation.operationName)+" returned, it took "+(md.If.dequeueUtcTime.getTime()-md.If.enqueueUtcTime.getTime())+" milliseconds to complete."),
Jc.av.remove(md.If))};Jc.fD=Ob;Jc.NN=mb;Jc.$=nc;Jc.sheetName=ic;Jc.locale=window.navigator.browserLanguage||window.navigator.language||Jc.$.ya.UICultureTag;Jc.xXi=Jc.h4g();Jc.$.userOperationManager.Br(Jc.yz);Jc.av=new uc.a;Jc.isUniversalPrintEnabled=hc;return Jc}function x(Ob,nc){this.sheetPrintOptions=this.sheetName=null;this.sheetName=Ob;this.sheetPrintOptions=nc}function l(Ob){this.QEi=[.75,.75,.7,.7,.3,.3];this.CDi=[.75,.75,.25,.25,.3,.3];this.SYj=[1,1,1,1,.5,.5];this.Tae=this.Ofe=this.ide=this.Sce=
this.yje=this.Q6=this.narrow=this.wide=this.normal=null;this.sheetPrintOptions={};this.Fm=Ob;this.Pbi();this.Wbi()}function u(){this.printSettingOptionKey=0;this.printSettingOptionText=null}function A(){this.footer=this.header=this.bottom=this.top=this.right=this.left=0}function z(){this.marginValue=this.printSettingOption=null}function y(){this.margin=this.w0=this.Lca=this.orientation=this.wv=0;this.ignorePrintArea=!1;this.sheetPrintOptions=null;this.Q1a=!1;this.NoColor=null}function w(Ob){var nc=
this;this.ribbonCommandInfo=this.ZFb=null;this.ENj=function(mb,ic,qc){ic=!!mb&&!!mb.RequestTelemetryData;pa.g(nc.$).si&&pa.g(nc.$).si.tla(nc.OKa.na(nc.ribbonCommandInfo.command),mb.StateId,ic?mb.RequestTelemetryData.EcsOperationDuration:0,ic?mb.RequestTelemetryData.EcsRequestDuration:0,ic?mb.RequestTelemetryData.WfeRequestDuration:0);Aa.HelperMethods.i_&&nc.QXg(qc)};this.$=Ob;this.OKa=new lb.a;this.Kva=new lb.a;this.Kva.add(78661008,12);this.Kva.add(275604654,13);this.Kva.add(-13332329,14);this.Kva.add(-837651977,
9);this.Kva.add(-1778266776,10);this.Kva.add(845325699,11);this.Mpd=va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebPrintFloodgateSurvey",!1)}function D(){this.LastColumn=this.LastRow=this.FirstColumn=this.FirstRow=0}function H(){this.Max=this.Min=this.Index=0}function F(){this.Col=this.Row=null}function J(Ob){this.sheetName=null;this.sheetName=Ob}function S(Ob){this.sheetName=null;this.sheetName=Ob}function N(Ob){this.sharedSheetCell=null;this.sharedSheetCell=Ob}function T(Ob){this.sharedSheetCell=
null;this.sharedSheetCell=Ob}function G(Ob,nc){this.multiRange=null;this.addToPrintArea=!1;this.multiRange=Ob;this.addToPrintArea=nc}function I(Ob,nc){this.R6=0;this.e8d=!1;this.wv=Ob;this.ignorePrintArea=nc}function K(Ob,nc,mb,ic,qc,hc,Jc,rd){var md=X.call(this,Ob,nc,mb,ic,qc,va.EwaSettings.ma(397))||this;md.$ca=null;md.saa=null;md.Hec=null;md.kTd=!1;md.wxa=null;md.dab=null;md.aza=null;md.jAa=null;md.C5a=null;md.tza=1;md.Dma=1;md.d0=0;md.R6=1;md.kHb=!1;md.$r=null;md.jKb=0;md.iKb=0;md.bza=null;md.kAa=
null;md.selectedRange=null;md.e0=0;md.E9a=function(){md.e0++;md.R6=md.zZc();md.U7c(md.saa.checked?!0:!1);md.I7&&(md.Hec.disabled=md.Vv.checked);md.COd(md.saa.checked?!0:!1);ia.ULS.sendTraceTag(595194762,0,50,"PdfPrintDialog:OnChangeWhatToPrint What to print option changed to "+md.R6.toString());return!0};md.evf=function(){md.e0++;md.kHb=md.C5a.checked;ia.ULS.sendTraceTag(537154311,0,50,"PdfPrintDialog:OnChangeIgnorePrintArea Setting Ignore print area changed to "+md.kHb.toString())};md.Ymc=function(){md.e0++;
md.tza=md.Sve();ia.ULS.sendTraceTag(595079450,0,50,"PdfPrintDialog:OnChangeOrienation orientation option changed to "+md.tza.toString());return!0};md.fvf=function(){md.e0++;var Cc=md.Dma;md.Dma=K.paperSizeOptions[md.aza.selectedIndex];ia.ULS.sendTraceTag(595079449,0,50,"PdfPrintDialog:OnChangePaperSize paperSize option changed from "+Cc.toString()+" to "+md.Dma.toString());return!0};md.gvf=function(){md.e0++;var Cc=md.d0;md.d0=K.scalingOptions[md.jAa.selectedIndex];2===md.d0?(md.jKb=1,md.iKb=0):3===
md.d0?(md.jKb=0,md.iKb=1):1===md.d0&&(md.jKb=1,md.iKb=1);ia.ULS.sendTraceTag(595079448,0,50,"PdfPrintDialog:OnChangeScaling scaling option changed from "+Cc.toString()+" to "+md.d0.toString());return!0};md.lAd=function(Cc){if(Cc&&Cc.data&&Cc.data.Rd&&Cc.data.responseHeaders&&Cc.data.Rd.length){if(Cc.data.responseHeaders["Content-Type"]&&dc.a.contains(Cc.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)){ia.ULS.sendTraceTag(51676164,0,50,"PdfPrintDialog:OnFileHandlerSuccessCallback - pdf converted successfully");
var fd={};md.MEb(fd,null,null)}else fd=ub.a.Wh(Cc.data.Rd),ia.ULS.sendTraceTag(51676165,0,15,"PdfPrintDialog:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: "+fd.Errors[0].MessageId);Cc=Cc.data.state;Cc.r9c(fd,Cc.userContext,Cc.methodName)}else ia.ULS.sendTraceTag(51676163,0,10,"PdfPrintDialog:OnFileHandlerSuccessCallback - Invalid Parameter : "+(Cc?Cc.data?Cc.data.Rd?Cc.data.responseHeaders?Cc.data.Rd.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":"requestSucceededEventArgs.Data.ResponseHeaders":
"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs"))};md.kAd=function(Cc){var fd=Ha.a.xf(Cc.data);ia.ULS.sendTraceTag(51676166,0,15,"PdfPrintDialog:OnFileHandlerFailureCallback has failed - Errors: ["+Jb.a.Cc(fd)+"]");fd=Cc.data.state;fd.Aaa(Cc,fd.userContext,fd.methodName)};md.MEb=function(Cc){Cc.Errors&&0<Cc.Errors.length?ia.ULS.sendTraceTag(51499295,0,50,"PdfPrintDialog: Failed to convert workbook. Error message Id: "+Cc.Errors[0].MessageId):
(6===md.Ed.Ne&&da.AFrameworkApplication.ta.xe.Ij(pa.g(md.$).OWf),ia.ULS.shipAssertTag(537154309,0,!!md.$.xa.pa,"PdfPrintDialog.OnConvertWorkbookToPdfSucceeded: EwaControl.Sheets.ActiveItem should not be null"),md.$.xa.pa&&md.qia.x4f(md.PHa()))};md.qia=hc;md.activeCell=md.$.pa.activeCell.toString();md.Em.SelectedRanges&&md.Em.SelectedRanges.Ranges&&0<md.Em.SelectedRanges.Ranges.length&&md.Em.SelectedRanges.Ranges[0]&&(md.selectedRange=ba.B(md.Em.SelectedRanges.Ranges[0]).toString());md.sheetName=Jc;
md.NN=rd;md.UCd={};Ob=0;for(nc=K.paperSizeOptions.length;Ob<nc;++Ob)md.UCd[K.paperSizeOptions[Ob].toString()]=Ob;md.locale=window.navigator.browserLanguage||window.navigator.language||md.$.ya.UICultureTag;md.I7=va.EwaSettings.isChangeGateEnabled("OfficeVSO:4738349_EnableIgnorePrintAreaSettingInPrintDialog");return md}function L(Ob,nc){this.printSettings=this.sheetName=null;this.sheetName=Ob;this.printSettings=nc}function O(Ob,nc,mb,ic,qc){Ob=X.call(this,Ob,nc,mb,ic,qc)||this;Ob.xtb=null;return Ob}
function B(Ob,nc,mb,ic,qc,hc,Jc,rd){rd=Ob.Na(1,void 0===rd?null:rd);rd.sheetName=nc;rd.locale=mb;return La.g(Ob,"GetPrintSettings",rd,ic,qc,hc,Jc,4)}function Q(Ob,nc,mb,ic,qc,hc,Jc){Jc=Ob.Na(1,void 0===Jc?null:Jc);Jc.ConvertInParameters=nc;return La.g(Ob,"ConvertWorkbookToPrintPdf",Jc,mb,ic,qc,hc,4)}function U(Ob,nc,mb,ic,qc,hc,Jc,rd){rd=Ob.Na(9,void 0===rd?null:rd);rd.sheetName=nc;rd.printSettings=mb;return La.g(Ob,"SetSheetPrintSettings",rd,ic,qc,hc,Jc,0)}function X(Ob,nc,mb,ic,qc,hc){Ob=ta.call(this,
Ob,nc,mb,void 0===hc?!1:hc)||this;Ob.Vv=null;Ob.Em=ic;Ob.PRb=qc;return Ob}var P=b(10),ea=b(0),ia=b(15),da=b(4),xa=b(1552),Z=b(915),ha=b(50),ya=b(37),va=b(1),bb=b(64),ba=b(41),fa=b(187),ra=b(14),pa=b(21),Za=b(395),Ua=b(646),Ma=b(27),oa=b(1089),ja=b(12),ta=oa.a;$k(X,ta);X.prototype.setFocus=function(){this.Vv.checked?ja.DOMElementExtensions.setFocus(this.Vv):ja.DOMElementExtensions.setFocus(this.getButton(0).get_element())};of.Object.defineProperties(X.prototype,{Ed:{configurable:!0,enumerable:!0,get:function(){return this.PRb}}});
X.O5b="printCurrentSelection";Object(ea.a)(X,"BasePrintDialog",oa.a,[]);var aa=b(118),ma=b(5),Ea=b(219),Ha=b(121),Aa=b(11),V=b(244),La=b(62);$k(O,X);O.prototype.initialize=function(){ia.ULS.sendTraceTag(537154316,0,50,"HtmlPrintDialog:Initialize - Preparing dialog for HTML Legacy print");this.jbi();this.qnb(1211);this.addButton(1);X.prototype.initialize.call(this)};O.prototype.xha=function(){var Ob=this;return function(nc,mb,ic){var qc=Ob.$.oa.va,hc=Ob.Em;nc=Ob.tja(nc);mb=Ob.Paa(mb);var Jc=Ob.Ed,
rd=qc.Na(1,null);rd.printOptions=hc;return La.g(qc,"ValidatePrint",rd,nc,mb,ic,Jc,0)}};O.prototype.commit=function(){this.k1g();return!0};O.prototype.ay=function(Ob,nc,mb){var ic,qc=Ob.Result;if(qc&&nc){var hc=0,Jc=0;(null===(ic=qc.SelectedRanges)||void 0===ic?0:ic.Ranges)&&0<qc.SelectedRanges.Ranges.length&&qc.SelectedRanges.Ranges[0]&&(hc=Math.min(O.L1f(qc.SelectedRanges.Ranges[0]),65535));qc.UsedRange&&(Jc=Math.min(O.L1f(ba.j(ba.D(qc.UsedRange))),65535));V.h(nc,hc);V.i(nc,Jc)}this.Em=qc;X.prototype.ay.call(this,
Ob,nc,mb)};O.prototype.setFocus=function(){this.xtb.checked?ja.DOMElementExtensions.setFocus(this.xtb):X.prototype.setFocus.call(this)};O.prototype.jbi=function(){this.Hb.innerHTML=O.Q0i(this.$.ea.isNamedObjectViewMode);this.Vv=ja.DOMElementExtensions.getElementById(this.Hb,X.O5b);this.xtb=ja.DOMElementExtensions.getElementById(this.Hb,"printEntireItem");0!==this.Em.Type&&this.Em.UseSelection?(this.Vv.checked=!0,this.xtb.disabled=!this.Em.SheetName):(this.xtb.checked=!0,this.Vv.disabled=0===this.Em.Type||
!pa.g(this.$).ha.sa.rg)};O.prototype.k1g=function(){ia.ULS.sendTraceTag(51499290,0,50,"HtmlPrintDialog:CommitWithGenerateHtml - CommitWithGenerateHtml called");var Ob=new Sys.StringBuilder;this.xHh(Ob);Aa.HelperMethods.Te(Ob.toString(),"","location=0,scrollbars=1,resizable=1,menubar=1,toolbar="+(Ma.a.Pf?0:1)+",status=0","PrintDialog.PrintViewUrl")||ia.ULS.sendTraceTag(51499291,0,10,"HtmlPrintDialog:CommitWithGenerateHtml - A browser blocked the xlprintview.aspx page!")};O.prototype.xHh=function(Ob){var nc=
this.$.ya;Ob.append(this.$.Qda+nc.LayoutsRelativeUri+"/xlprintview.aspx?");Ea.a.Rg(Ob,ma.a.r3i,this.Em.SessionId);Ea.a.Rg(Ob,ma.a.t3i,this.Vv.checked?"1":"0");if(0===this.Em.Type)Ea.a.Rg(Ob,ma.a.o3i,this.Em.ObjectId);else{if(!this.Em.UsedRangeTooBig){var mb=ba.D(this.Em.UsedRange);(mb=ba.x(mb,this.Em.SheetName))&&Ea.a.Rg(Ob,ma.a.u3i,mb)}1===this.Em.Type?Ea.a.Rg(Ob,ma.a.p3i,this.Em.ObjectId):(mb=ba.B(this.Em.SelectedRanges.Ranges[0]),mb=ba.x(mb,this.Em.SheetName),Ea.a.Rg(Ob,ma.a.q3i,mb))}Ha.a.qZa(Ob,
nc);Ea.a.Rg(Ob,ma.a.s3i,this.Em.Title)};O.Q0i=function(Ob){return String.format("<div class='"+aa.a.Dn+"'>{0}</div>\r\n\t<div class='"+aa.a.H8b+"'>\r\n\t\t<input type='radio' id='{1}' name='print' /> <label for='{1}'>{2}</label><br />\r\n\t\t<input type='radio' id='{3}' name='print' /> <label for='{3}'>{4}</label>\r\n\t</div>\r\n</div>",ra.a.instance.ga(1212),X.O5b,ra.a.instance.ga(1215),"printEntireItem",Ob?ra.a.instance.ga(1214):ra.a.instance.ga(1213))};O.L1f=function(Ob){return(Ob.LastColumn-Ob.FirstColumn+
1)*(Ob.LastRow-Ob.FirstRow+1)};of.Object.defineProperties(O.prototype,{mc:{configurable:!0,enumerable:!0,get:function(){return"HtmlPrintDialog"}}});Object(ea.a)(O,"HtmlPrintDialog",X,[]);var Ra=b(178),pb=b(626),cb=b(13),Sa=b(9),Db=b(67),Ab=b(1292),Wb=b(990),ub=b(54),vb=b(177),Ka=b(311),eb=b(1086),yb=b(221),oc=b(948),Jb=b(31),dc=b(22),$a=b(298);L.prototype.getSheetName=function(){return this.sheetName};L.prototype.getPrintSettings=function(){return this.printSettings};Object(ea.a)(L,"MacroRecorderSheetPrintSettingsSavedPayload",
null,[430]);var Ba=b(158),la=b(58);$k(K,X);K.prototype.initialize=function(){this.I7&&va.EwaSettings.isChangeGateEnabled("OfficeVSO:4879681_PrintAreaCheckboxKeyboardFocus")&&K.z8g(this.Hb);this.Ae?this.pBe(1013,null):(this.Dl(),this.qnb(1013));X.prototype.initialize.call(this)};K.prototype.dispose=function(){this.WPj();X.prototype.dispose.call(this)};K.prototype.close=function(Ob){ia.ULS.sendTraceTag(591196544,0,50,"PdfPrintDialog.Close: User changed printSettings "+this.e0+" times before exiting dialog "+
(0===Ob?"with":"without")+" printing done");this.rlj();if(this.$r){var nc=this.aNh();!this.kTd&&!this.saa.checked&&this.$.isEditMode&&this.fjd(nc)&&this.ilj(nc)}X.prototype.close.call(this,Ob)};K.prototype.xha=function(){var Ob=this;return function(nc,mb,ic){return B(Ob.$.oa.va,Ob.$.xa.pa.name,Ob.locale,Ob.tja(nc),Ob.Paa(mb),ic,null)}};K.prototype.ay=function(Ob,nc,mb){this.$r=Ob.Result;this.jKb=this.$r.ScalingWidth;this.iKb=this.$r.ScalingHeight;this.Tad();this.Rai();X.prototype.ay.call(this,Ob,
nc,mb)};K.prototype.Dl=function(){ia.ULS.sendTraceTag(537154315,0,50,"PdfPrintDialog:InitializeDialogElements - Preparing dialog for Print Pdf");this.kbi();X.prototype.Dl.call(this)};K.prototype.commit=function(){this.j1g();return!0};K.prototype.setFocus=function(){this.Ae?yb.a.$Ac(this.$ca):this.$ca.checked?ja.DOMElementExtensions.setFocus(this.$ca):X.prototype.setFocus.call(this)};K.prototype.Cci=function(){switch(this.NN.wv){case 1:this.$ca.checked=!0;break;case 0:this.Vv.disabled?this.$ca.checked=
!0:this.Vv.checked=!0;break;case 2:this.saa.checked=!0;break;default:ia.ULS.sendTraceTag(537154314,0,10,"Invalid what to print state "+this.NN.wv+". Resetting to defaults."),this.NN.wv=1,this.$ca.checked=!0}};K.prototype.rlj=function(){this.NN.wv=this.zZc();this.I7&&(this.NN.ignorePrintArea=this.C5a.checked)};K.prototype.Tad=function(){if(100!==this.$r.ScalingPercent||this.$r.FitToPage&&(1<this.$r.ScalingWidth||1<this.$r.ScalingHeight))this.kTd=!0,this.$r.ScalingWidth=K.U5c,this.$r.ScalingHeight=
K.T5c,this.$r.ScalingPercent=K.t6b,this.$r.FitToPage=K.N5c;this.$r.PaperSize.toString()in this.UCd||(this.kTd=!0,this.$r.PaperSize=this.$r.PaperSize===K.KOg?34:K.wsb)};K.prototype.Rai=function(){this.tza=this.$r.IsLandscape?2:1;this.d0=this.$r.FitToPage?1===this.$r.ScalingWidth&&1===this.$r.ScalingHeight?1:this.$r.ScalingWidth||1!==this.$r.ScalingHeight?2:3:0;this.Dma=this.$r.PaperSize;this.U7c(this.saa.checked?!0:!1);this.COd(this.saa.checked?!0:!1)};K.prototype.xbi=function(){this.Hec.disabled=
this.Vv.checked;this.kHb=this.C5a.checked=this.NN.ignorePrintArea};K.prototype.dah=function(Ob){this.kAa=document.createElement("select");this.kAa.style.width=224+Db.a.Ye;this.kAa.style.height=32+Db.a.Ye;this.kAa.setAttribute(ma.a.ZD,"scalingElementId");this.jAa=new oc.a(this.kAa,!0);for(var nc=0,mb=K.scalingOptions.length;nc<mb;++nc){var ic=ra.a.instance.ga(K.Plj[nc]);this.jAa.WL(ic,K.scalingOptions[nc].toString(),!1)}Ob.appendChild(this.kAa)};K.prototype.DEe=function(Ob){this.bza=document.createElement("select");
this.bza.style.width=224+Db.a.Ye;this.bza.style.height=32+Db.a.Ye;this.bza.setAttribute(ma.a.ZD,"paperSizeElementId");this.aza=new oc.a(this.bza,!0);for(var nc=0,mb=K.paperSizeOptions.length;nc<mb;++nc){var ic=ra.a.instance.ga(K.yXi[nc]);this.aza.WL(ic,K.paperSizeOptions[nc].toString(),!1)}Ob.appendChild(this.bza)};K.prototype.aNh=function(){var Ob={};Ob.IsLandscape=2===this.tza;Ob.PaperSize=this.Dma;Ob.ScalingWidth=this.jKb;Ob.ScalingHeight=this.iKb;Ob.ScalingPercent=100;Ob.FitToPage=0===this.d0?
!1:!0;return Ob};K.prototype.PHa=function(){var Ob=new Sys.StringBuilder;Ob.append(eb.a(this.$,"Pdf",!0));this.qia.Ixc()&&Ea.a.Rg(Ob,Sa.a.ifg,"1");Ea.a.Rg(Ob,Sa.a.bGd,""+this.R6);Ea.a.Rg(Ob,Sa.a.FKf,this.$.xa.pa.name);0===this.R6&&(Ea.a.Rg(Ob,Sa.a.EKf,this.selectedRange),Ea.a.Rg(Ob,Sa.a.yKf,this.activeCell));Ea.a.Rg(Ob,Sa.a.zKf,""+this.tza);Ea.a.Rg(Ob,Sa.a.AKf,""+this.Dma);Ea.a.Rg(Ob,Sa.a.DKf,""+this.d0);Ea.a.Rg(Ob,Sa.a.CKf,"1");Ea.a.Rg(Ob,Sa.a.xKf,this.kHb?"1":"0");Ea.a.Rg(Ob,Sa.a.BKf,"1");ia.ULS.sendTraceTag(51499296,
0,50,"PdfPrintDialog: Print Pdf Url "+Ob.toString());return Ob.toString()};K.prototype.Myb=function(){var Ob=this,nc=null;ia.ULS.sendTraceTag(537154313,0,50,"PdfPrintDialog:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");this.$.userOperationManager.Sb(new vb.a(223,0,function(mb,ic,qc){mb=new Ka.a(mb,null,ic,qc,null,!0,!1,"GetFileCopyFileHandler","");mb.correlationID=Ra.a.create().toString();nc=mb;da.AFrameworkApplication.nd.P9(Ob.PHa(),1,null,null,K.gad,!1,2,Ob.lAd,Ob.kAd,nc,void 0,
void 0,void 0,12E4);return la.Task.Ua(!0)},16),null)};K.prototype.kbi=function(){ia.ULS.sendTraceTag(537154312,0,50,"PdfPrintDialog:InitializeForPrintPdf - Preparing full print pdf dialog");this.P0i(this.Hb);this.U7c(!0);this.COd(!0);this.Vv=ja.DOMElementExtensions.getElementById(this.Hb,X.O5b);this.$ca=ja.DOMElementExtensions.getElementById(this.Hb,"printActiveSheet");this.saa=ja.DOMElementExtensions.getElementById(this.Hb,"printEntireWorkbook");this.I7&&(this.Hec=ja.DOMElementExtensions.getElementById(this.Hb,
"ignorePrintAreaCheckboxButtonId"),this.C5a=new Wb.a(this.Hec));this.ixc()&&(this.Vv.disabled=!0,this.Em.SheetName=this.sheetName);this.Cci();this.I7&&this.xbi();this.R9i()};K.prototype.ixc=function(){return!!this.Em.ObjectId||!pa.g(this.$).ha.sa.rg};K.prototype.R9i=function(){pb.a.instance.ra(cb.a.change,this.$ca,this.E9a);pb.a.instance.ra(cb.a.change,this.saa,this.E9a);pb.a.instance.ra(cb.a.change,this.Vv,this.E9a);pb.a.instance.ra(cb.a.change,this.wxa,this.Ymc);pb.a.instance.ra(cb.a.change,this.dab,
this.Ymc);pb.a.instance.ra(cb.a.change,this.bza,this.fvf);pb.a.instance.ra(cb.a.change,this.kAa,this.gvf);this.I7&&this.C5a.znb(this.evf)};K.prototype.WPj=function(){pb.a.instance.Ba(cb.a.change,this.$ca,this.E9a);pb.a.instance.Ba(cb.a.change,this.saa,this.E9a);pb.a.instance.Ba(cb.a.change,this.Vv,this.E9a);pb.a.instance.Ba(cb.a.change,this.wxa,this.Ymc);pb.a.instance.Ba(cb.a.change,this.dab,this.Ymc);pb.a.instance.Ba(cb.a.change,this.bza,this.fvf);pb.a.instance.Ba(cb.a.change,this.kAa,this.gvf);
this.I7&&this.C5a.qda(this.evf)};K.prototype.P0i=function(Ob){Ob.classList.add(Ab.a.M1i);if(!this.Ae){document.getElementById("ewaDialogTitle").classList.add(Ab.a.printDialogTitle);var nc=document.getElementById("ewaDialogCloseButtonLink");nc.style.top=32+Db.a.Ye;this.rtl?nc.style.left=32+Db.a.Ye:nc.style.right=32+Db.a.Ye}nc=K.Zy(Ab.a.N1i);Ob.appendChild(nc);var mb=K.Zy(Ab.a.uab,1219);mb.style.marginBottom=12+Db.a.Ye;mb.id="whatToPrintTitleElementId";nc.appendChild(mb);mb=K.Zy(Ab.a.sab);nc.appendChild(mb);
K.Orb(mb,this.rtl,"printActiveSheet",1223,"whatToPrintRbName","PrintWhatExcelActiveSheets_32x32x32","activeSheetRadioButtonInnerLabelElementId","whatToPrintTitleElementId");nc.appendChild(document.createElement("BR"));mb=K.Zy(Ab.a.sab);nc.appendChild(mb);K.Orb(mb,this.rtl,"printEntireWorkbook",1216,"whatToPrintRbName","PrintWhatExcelEntireWorkbook_32x32x32","entireWorkbookRadioButtonInnerLabelElementId","whatToPrintTitleElementId");nc.appendChild(document.createElement("BR"));mb=K.Zy(Ab.a.sab);nc.appendChild(mb);
K.Orb(mb,this.rtl,X.O5b,1215,"whatToPrintRbName","PrintWhatExcelSelection_32x32x32","currentSelectionRadioButtonInnerLabelElementId","whatToPrintTitleElementId");this.I7?(mb=K.Zy(Ab.a.uab,1248),mb.style.marginTop=24+Db.a.Ye,mb.id="printAreaElementId",nc.appendChild(mb),va.EwaSettings.isChangeGateEnabled("OfficeVSO:4879681_PrintAreaCheckboxKeyboardFocus")?(mb.style.marginBottom=12+Db.a.Ye,mb=K.Zy(aa.a.b9c),mb.id="ignorePrintAreaCheckboxWarpperId",ja.DOMElementExtensions.setVisible(mb,!0),nc.appendChild(mb),
nc=this.getElementById("ignorePrintAreaCheckboxButtonId"),ja.DOMElementExtensions.setVisible(nc,!0),mb.appendChild(nc),nc=this.getElementById("ignorePrintAreaCheckboxLabelId"),ja.DOMElementExtensions.setVisible(nc,!0),mb.appendChild(nc)):(mb=K.Zy(Ab.a.sab),nc.appendChild(mb),K.q6g(mb,this.rtl))):(mb=K.Zy(Ab.a.uab,1221),mb.style.marginTop=24+Db.a.Ye,mb.id="paperSizeElementId",nc.appendChild(mb),mb=K.Zy(Ab.a.jFd),this.DEe(mb),nc.appendChild(mb));nc=K.Zy(Ab.a.O1i);Ob.appendChild(nc);Ob=K.Zy(Ab.a.uab,
1220);Ob.style.marginBottom=12+Db.a.Ye;Ob.id="orientationTitleElementId";nc.appendChild(Ob);Ob=K.Zy(Ab.a.sab);nc.appendChild(Ob);K.Orb(Ob,this.rtl,"portraitRadioButtonId",1226,"orientationRbName","Portrait_32x32x32","portraitRadioButtonInnerLabelElementId","orientationTitleElementId");nc.appendChild(document.createElement("BR"));Ob=K.Zy(Ab.a.sab);nc.appendChild(Ob);K.Orb(Ob,this.rtl,"landscapeRadioButtonId",1225,"orientationRbName","Landscape_32x32x32","landscapeRadioButtonInnerLabelElementId","orientationTitleElementId");
this.I7&&(Ob=K.Zy(Ab.a.uab,1221),Ob.style.marginTop=12+Db.a.Ye,Ob.id="paperSizeElementId",nc.appendChild(Ob),Ob=K.Zy(Ab.a.jFd),this.DEe(Ob),nc.appendChild(Ob));Ob=K.Zy(Ab.a.uab,1222);Ob.style.marginTop=(this.I7?10:74)+Db.a.Ye;Ob.id="scalingElementId";nc.appendChild(Ob);Ob=K.Zy(Ab.a.jFd);this.dah(Ob);nc.appendChild(Ob);this.Ae||document.getElementById("buttonarea").classList.add(Ab.a.L1i);this.wxa=ja.DOMElementExtensions.getElementById(this.Hb,"landscapeRadioButtonId");this.dab=ja.DOMElementExtensions.getElementById(this.Hb,
"portraitRadioButtonId")};K.prototype.j1g=function(){var Ob=this;ia.ULS.sendTraceTag(51499294,0,50,"PdfPrintDialog:CommitWithConvertPdf - CommitWithConvertPdf called");this.R6=this.zZc();2!==this.R6&&(this.tza=this.Sve(),this.aza&&(this.Dma=K.paperSizeOptions[this.aza.selectedIndex]),this.jAa&&(this.d0=K.scalingOptions[this.jAa.selectedIndex]));if(this.$.Dwa&&va.EwaSettings.isChangeGateEnabled("OfficeVSO:4445349_DisablePrintLatencyImprovementForCrossDomain")){var nc=this.$.oa.va.Pb();this.$.userOperationManager.Sb(new vb.a(133,
0,function(mb,ic,qc){var hc={};hc.WhatToPrint=Ob.R6;hc.UseNamedAction=Ob.qia.Ixc();hc.SelectedSheetName=Ob.$.xa.pa.name;hc.ActiveCell=Ob.activeCell;hc.SelectedRanges=[Ob.selectedRange];hc.IsPdfDocumentRequired=!1;hc.Orientation=Ob.tza;hc.PaperSize=Ob.Dma;hc.Scaling=Ob.d0;hc.RichValuesEnabled=!0;Ob.I7&&(hc.IgnorePrintArea=Ob.kHb);return Q(Ob.$.oa.va,hc,$a.b(Ob.MEb,mb),ic,qc,nc)},16),null)}else this.Myb()};K.prototype.U7c=function(Ob){this.dab.disabled=Ob;this.wxa.disabled=Ob;this.aza.Rp.disabled=Ob;
this.jAa.Rp.disabled=Ob};K.prototype.COd=function(Ob){Ob?(this.wxa.checked=!1,this.dab.checked=!1,this.aza.selectedIndex=-1,this.jAa.selectedIndex=-1):(2===this.tza?this.wxa.checked=!0:this.dab.checked=!0,this.aza.selectedIndex=this.UCd[this.Dma.toString()],this.jAa.selectedIndex=this.d0)};K.prototype.ilj=function(Ob){var nc=this;ia.ULS.sendTraceTag(537154310,0,50,"PdfPrintDialog:SavePrintSettingsToFile - We should make a set SheetPrintSettings call here to set print Settings.");var mb=this.$.xa.pa.name,
ic=this.$.oa.va.Pb();this.$.userOperationManager.Sb(new vb.a(226,0,function(qc,hc,Jc){return U(nc.$.oa.va,mb,Ob,qc,hc,Jc,ic)},void 0,function(){return new L(mb,Ob)}),null)};K.prototype.fjd=function(Ob){return this.$r.IsLandscape!==Ob.IsLandscape||this.$r.PaperSize!==Ob.PaperSize||this.$r.FitToPage!==Ob.FitToPage||this.$r.ScalingHeight!==Ob.ScalingHeight||this.$r.ScalingWidth!==Ob.ScalingWidth?!0:!1};K.prototype.Sve=function(){return this.wxa&&this.wxa.checked?2:1};K.prototype.zZc=function(){return this.Vv.checked?
0:this.$ca.checked?1:this.saa.checked?2:1};K.Zy=function(Ob,nc){Ob=void 0===Ob?null:Ob;nc=void 0===nc?0:nc;var mb=document.createElement("div");Ob&&(mb.className=Ob);0!==nc&&(mb.innerHTML=ra.a.instance.ga(nc));return mb};K.z8g=function(Ob){var nc=document.createElement("input");nc.setAttribute("type","checkbox");nc.className=aa.a.bNe;nc.id="ignorePrintAreaCheckboxButtonId";nc.setAttribute("name","ignorePrintAreaCbName");nc.style.height=16+Db.a.Ye;nc.style.width=16+Db.a.Ye;ja.DOMElementExtensions.setVisible(nc,
!1);var mb=ra.a.instance.ga(1248),ic=ra.a.instance.ga(1249);nc.setAttribute(ma.a.Ft,mb+Db.a.space+ic);Ob.appendChild(nc);nc=document.createElement("label");nc.setAttribute("for","ignorePrintAreaCheckboxButtonId");nc.id="ignorePrintAreaCheckboxLabelId";nc.innerHTML=ic;nc.setAttribute(ma.a.uP,"true");nc.style.position="relative";nc.style.marginLeft=15+Db.a.Ye;ja.DOMElementExtensions.setVisible(nc,!1);Ob.appendChild(nc)};K.q6g=function(Ob,nc){var mb=document.createElement("input");mb.setAttribute("type",
"checkbox");mb.id="ignorePrintAreaCheckboxButtonId";mb.setAttribute("name","ignorePrintAreaCbName");mb.setAttribute(ma.a.ZD,"printAreaElementId"+Db.a.space+"ignorePrintAreaCheckboxButtonInnerLabelElementId");mb.style.height=16+Db.a.Ye;mb.style.width=16+Db.a.Ye;nc?mb.style.marginRight=0+Db.a.Ye:mb.style.marginLeft=0+Db.a.Ye;Ob.appendChild(mb);nc=document.createElement("label");nc.setAttribute("for","ignorePrintAreaCheckboxButtonId");nc.setAttribute(ma.a.uP,"true");nc.style.position="relative";nc.style.marginLeft=
15+Db.a.Ye;Ob.appendChild(nc);Ob=K.Zy(Ab.a.oJf,1249);Ob.id="ignorePrintAreaCheckboxButtonInnerLabelElementId";nc.appendChild(Ob)};K.Orb=function(Ob,nc,mb,ic,qc,hc,Jc,rd){var md=document.createElement("input");md.setAttribute("type","radio");md.id=mb;md.setAttribute("name",qc);md.setAttribute(ma.a.ZD,rd+Db.a.space+Jc);md.style.height=16+Db.a.Ye;md.style.width=16+Db.a.Ye;nc?md.style.marginRight=0+Db.a.Ye:md.style.marginLeft=0+Db.a.Ye;Ob.appendChild(md);nc=document.createElement("label");nc.setAttribute("for",
mb);nc.style.position="relative";Ob.appendChild(nc);Ob=Ba.createClusteredImage(32,32,hc,Ab.a.V1i,!0,ra.a.instance.ga(ic));ic=K.Zy(Ab.a.oJf,ic);ic.id=Jc;ic.setAttribute(ma.a.uP,"true");Jc=K.Zy(Ab.a.U1i);Jc.appendChild(ic);nc.appendChild(Jc);nc.appendChild(Ob)};of.Object.defineProperties(K.prototype,{mc:{configurable:!0,enumerable:!0,get:function(){return"PdfPrintDialog"}}});K.U5c=1;K.T5c=0;K.t6b=100;K.wsb=9;K.N5c=!0;K.KOg=13;K.paperSizeOptions=[1,5,6,7,8,9,11,12,3,20,27,28,34,37,43,14];K.yXi=[1228,
1229,1236,1230,1231,1232,1233,1234,1227,1237,1238,1239,1240,1241,1242,1243];K.scalingOptions=[0,1,2,3];K.Plj=[1244,1245,1246,1247];K.gad=["Content-Type"];Object(ea.a)(K,"PdfPrintDialog",X,[]);of.Object.defineProperties(I.prototype,{wv:{configurable:!0,enumerable:!0,get:function(){return this.R6},set:function(Ob){0<=Ob&&2>=Ob?this.R6=Ob:(ia.ULS.sendTraceTag(537154308,0,10,"Attempt to set invalid state. Setting ActiveSheets instead."),this.R6=1)}},ignorePrintArea:{configurable:!0,enumerable:!0,get:function(){return this.e8d},
set:function(Ob){Ob||!Ob?this.e8d=Ob:ia.ULS.sendTraceTag(537154307,0,10,"Attempt to set invalid ignorePrintArea")}}});Object(ea.a)(I,"PdfPrintDialogBrowserSessionState",null,[]);var ka=b(7),ca=b(135),Ia=b(99),jb=b(1607);Object(ea.a)(G,"MacroRecorderPrintAreaSetPayload",null,[430]);var nb=b(572),Na=b(394),sa=b(74);Object(ea.a)(T,"MacroRecorderPageBreakInsertedPayload",null,[430]);Object(ea.a)(N,"MacroRecorderPageBreakRemovedPayload",null,[430]);S.prototype.getSheetName=function(){return this.sheetName};
Object(ea.a)(S,"MacroRecorderPageBreaksAllResetPayload",null,[430]);J.prototype.getSheetName=function(){return this.sheetName};Object(ea.a)(J,"MacroRecorderPrintAreaClearedPayload",null,[430]);var Wa=b(126),Hb=b(112),Yb=b(51),Sb=b(193);Object(ea.a)(F,"PageBreaksInformation",null,[]);Object(ea.a)(H,"RowColBreak",null,[]);Object(ea.a)(D,"SharedRange",null,[]);var lb=b(171);w.prototype.executeCommand=function(Ob,nc,mb,ic,qc,hc,Jc){qc=void 0===qc?null:qc;hc=void 0===hc?null:hc;Jc=void 0===Jc?null:Jc;
this.gXd();this.ribbonCommandInfo=nc;this.FFj(nc.command);Ob=$a.b(qc,this.ENj);ia.ULS.sendTraceTag(543794888,0,50,"PrintCommandHandler.ExecuteCommand: "+nc.command+" command execution started");switch(nc.command){case 78661008:return this.j6e(nc,Ob,hc,Jc,!1);case 275604654:return this.j6e(nc,Ob,hc,Jc,!0);case -13332329:return this.i5e(nc,Ob,hc,Jc);case -837651977:return this.a4h(nc,Ob,hc,Jc);case -1778266776:return this.X4h(nc,Ob,hc,Jc);case 845325699:return this.e6e(nc,Ob,hc,Jc)}return fa.a(nc.command)};
w.prototype.Ac=function(Ob,nc){switch(nc.command){case 78661008:case 275604654:case -837651977:case -1778266776:return 1===Ob;case 845325699:case -13332329:return!0}return!1};w.prototype.g0f=function(Ob,nc,mb){var ic=pa.g(this.$),qc=ic.Ea,hc=ba.r(ic.ha.sa.selectedRanges,this.$);if((qc=qc.KE())&&qc.length){qc=ik(qc);for(var Jc=qc.next();!Jc.done;Jc=qc.next()){Jc=Jc.value;var rd=Jc.lf;if(rd){for(var md=ba.j(Jc.jf),Cc=[],fd=ik(hc.Ranges),Cd=fd.next();!Cd.done;Cd=fd.next()){var Sc=Cd.value;Sc.FirstRow>
md.LastRow+1||Sc.LastRow<md.FirstRow||Sc.FirstColumn>md.LastColumn+1||Sc.LastColumn<md.FirstColumn||(Cd=this.LVh(md,Sc,rd),Sc=this.KVh(md,Sc,rd),Cc.push(Object(ka.a)(new D,{FirstRow:Cd.FirstRow,FirstColumn:Sc.FirstColumn,LastRow:Cd.LastRow,LastColumn:Sc.LastColumn})))}0<Cc.length&&!mb?rd.setPrintArea(Cc):0<Cc.length&&mb?rd.addToPrintArea(Cc):!mb&&rd.hasPrintArea()&&rd.clearPrintArea();!rd.isDirty()&&rd.hasPageLayout()&&rd.setDirty("PrintAreaBreakManager::SetPrintAreaInstantaneous, hash: "+Jc.Ld,4)}}this.mOb(ic,
Ob,nc)}};w.prototype.GZg=function(Ob,nc){var mb=pa.g(this.$),ic=pa.g(this.$).Ea.KE();if(ic&&ic.length){ic=ik(ic);for(var qc=ic.next();!qc.done;qc=ic.next()){qc=qc.value;var hc=qc.lf;hc&&(hc.clearPrintArea(),!hc.isDirty()&&hc.hasPageLayout()&&hc.setDirty("PrintAreaBreakManager::ClearPrintAreaInstantaneous, hash: "+qc.Ld,4))}this.mOb(mb,Ob,nc)}};w.prototype.jdi=function(Ob,nc){var mb=pa.g(this.$),ic=mb.Ea,qc=ba.o(mb.ha.sa.activeCell,this.$);if(qc){var hc=ic.KE();if(hc&&hc.length){ic=null;for(var Jc=
ik(hc),rd=Jc.next();!rd.done;rd=Jc.next()){rd=rd.value;var md=rd.lf;if(md){var Cc=ba.j(rd.jf);if(!(qc.FirstRow>Cc.LastRow||qc.FirstRow<Cc.FirstRow||qc.FirstColumn>Cc.LastColumn||qc.FirstColumn<Cc.FirstColumn)&&(ic=this.M9g(md,Cc,qc),md.insertPageBreak(ic),!md.isDirty()&&md.hasPageLayout()&&md.setDirty("PrintAreaBreakManager::InsertPageBreakInstantaneous, hash: "+rd.Ld,4),ic))break}}if(!ic)for(hc=ik(hc),rd=hc.next();!rd.done;rd=hc.next())if(ic=rd.value,Jc=ic.lf)ic=ba.j(ic.jf),ic=this.CEe(Jc,ic,qc),
Jc.insertPageBreak(ic);this.mOb(mb,Ob,nc)}}};w.prototype.lbj=function(Ob,nc){var mb=pa.g(this.$),ic=mb.Ea,qc=ba.o(mb.ha.sa.activeCell,this.$);if(qc&&(ic=ic.KE())&&ic.length){ic=ik(ic);for(var hc=ic.next();!hc.done;hc=ic.next()){hc=hc.value;var Jc=hc.lf;if(Jc){var rd=ba.j(hc.jf);(rd=this.CEe(Jc,rd,qc))&&Jc.removePageBreak(rd);!Jc.isDirty()&&Jc.hasPageLayout()&&Jc.setDirty("PrintAreaBreakManager::RemovePageBreakInstantaneous, hash: "+hc.Ld,4)}}this.mOb(mb,Ob,nc)}};w.prototype.bhj=function(Ob,nc){var mb=
pa.g(this.$),ic=mb.Ea.KE();if(ic&&ic.length){ic=ik(ic);for(var qc=ic.next();!qc.done;qc=ic.next()){qc=qc.value;var hc=qc.lf;hc&&(hc.resetAllPageBreak(),!hc.isDirty()&&hc.hasPageLayout()&&hc.setDirty("PrintAreaBreakManager::ResetAllPageBreakInstantaneous, hash: "+qc.Ld,4))}this.mOb(mb,Ob,nc)}};w.prototype.j6e=function(Ob,nc,mb,ic,qc){if(!qc){var hc=this.$.vb.getItemByName("PRINT_AREA");if(hc&&(ia.ULS.sendTraceTag(537154306,0,15,"PrintCommandHandler.HandleSetPrintAreaCommand: Print_Area already present as NamedObject of type : "+
hc.type),2===hc.type))return this.Qei(),la.Task.Ua(!0)}hc=pa.g(this.$).ha.sa;var Jc=ba.r(hc.selectedRanges,this.$);if(1===Jc.Ranges.length&&!qc){if(hc.Rba())return this.m5h(Ob,Jc,nc,mb,ic,qc),la.Task.Ua(!0);if(ba.R(Jc.Ranges[0]))return this.$.xa.pa.hasPrintArea?this.i5e(Ob,nc,mb,ic):la.Task.Ua(!0)}this.g0f(Ob.command,ic,qc);return this.hbf(Ob,nc,mb,Jc,qc)};w.prototype.i5e=function(Ob,nc,mb,ic){this.GZg(Ob.command,ic);return this.Cei(Ob,nc,mb)};w.prototype.a4h=function(Ob,nc,mb,ic){this.jdi(Ob.command,
ic);return this.Nei(Ob,nc,mb)};w.prototype.X4h=function(Ob,nc,mb,ic){var qc=ba.r(pa.g(this.$).ha.sa.selectedRanges,this.$);if(ba.R(qc.Ranges[0]))return this.e6e(Ob,nc,mb,ic);this.lbj(Ob.command,ic);return this.Rei(Ob,nc,mb)};w.prototype.e6e=function(Ob,nc,mb,ic){this.bhj(Ob.command,ic);return this.Uei(Ob,nc,mb)};w.prototype.hbf=function(Ob,nc,mb,ic,qc){function hc(){return new G(ic,qc)}function Jc(md,Cc,fd){md=$a.b(md,nc);Cc=$a.a(Cc,mb);var Cd=rd.Na(1,null);Cd.selectedRanges=ic;Cd.addToPrintArea=
qc;return La.g(rd,"SetPrintArea",Cd,md,Cc,fd,null,0)}var rd=this.$.oa.va;return va.EwaSettings.Zb()?Na.a(this.$.userOperationManager,Jc,function(md){return new vb.a(241,0,md,64,hc)},Ob):Na.a(this.$.userOperationManager,Jc,function(md){return new nb.a(241,0,md,void 0,hc)},Ob)};w.prototype.Cei=function(Ob,nc,mb){function ic(){return new J(hc)}function qc(rd,md,Cc){rd=$a.b(rd,nc);md=$a.a(md,mb);var fd=Jc.Na(1,null);fd.sheetName=hc;return La.g(Jc,"ClearPrintArea",fd,rd,md,Cc,null,0)}var hc=this.$.xa.pa.name,
Jc=this.$.oa.va;return va.EwaSettings.Zb()?Na.a(this.$.userOperationManager,qc,function(rd){return new vb.a(243,0,rd,64,ic)},Ob):Na.a(this.$.userOperationManager,qc,function(rd){return new nb.a(243,0,rd,void 0,ic)},Ob)};w.prototype.Nei=function(Ob,nc,mb){function ic(){return new T(rd)}function qc(md,Cc,fd){var Cd=hc.$.oa.va;md=$a.b(md,nc);Cc=$a.a(Cc,mb);var Sc=Cd.Na(9,null);Sc.sheetCell=rd;return La.g(Cd,"InsertPageBreak",Sc,md,Cc,fd,null,0)}var hc=this,Jc=pa.g(this.$),rd=ba.o(Jc.ha.sa.activeCell,
this.$);return va.EwaSettings.Zb()?Na.a(this.$.userOperationManager,qc,function(md){return new vb.a(244,0,md,64,ic)},Ob):Na.a(this.$.userOperationManager,qc,function(md){return new nb.a(244,0,md,void 0,ic)},Ob)};w.prototype.Rei=function(Ob,nc,mb){function ic(){return new N(rd)}function qc(md,Cc,fd){var Cd=hc.$.oa.va;md=$a.b(md,nc);Cc=$a.a(Cc,mb);var Sc=Cd.Na(9,null);Sc.sheetCell=rd;return La.g(Cd,"RemovePageBreak",Sc,md,Cc,fd,null,0)}var hc=this,Jc=pa.g(this.$),rd=ba.o(Jc.ha.sa.activeCell,this.$);
return va.EwaSettings.Zb()?Na.a(this.$.userOperationManager,qc,function(md){return new vb.a(245,0,md,64,ic)},Ob):Na.a(this.$.userOperationManager,qc,function(md){return new nb.a(245,0,md,void 0,ic)},Ob)};w.prototype.Uei=function(Ob,nc,mb){function ic(){return new S(Jc)}function qc(rd,md,Cc){var fd=hc.$.oa.va;rd=$a.b(rd,nc);md=$a.a(md,mb);var Cd=fd.Na(9,null);Cd.sheetName=Jc;return La.g(fd,"ResetAllPageBreaks",Cd,rd,md,Cc,null,0)}var hc=this,Jc=this.$.xa.pa.name;return va.EwaSettings.Zb()?Na.a(this.$.userOperationManager,
qc,function(rd){return new vb.a(246,0,rd,64,ic)},Ob):Na.a(this.$.userOperationManager,qc,function(rd){return new nb.a(246,0,rd,void 0,ic)},Ob)};w.prototype.LVh=function(Ob,nc,mb){if(!Ob||!nc||!mb)return null;var ic=new D;ic.FirstRow=nc.FirstRow===Ob.LastRow+1?mb.getRowIndex(Ob.LastRow+1)+1:nc.FirstRow<Ob.FirstRow?0:mb.getRowIndex(nc.FirstRow+1);ic.LastRow=nc.FirstRow===Ob.LastRow+1||nc.LastRow>Ob.LastRow?mb.getRowIndex(Ob.LastRow+1)+1:mb.getRowIndex(nc.LastRow+1);return ic};w.prototype.KVh=function(Ob,
nc,mb){if(!Ob||!nc||!mb)return null;var ic=new D;ic.FirstColumn=nc.FirstColumn===Ob.LastColumn+1?mb.getColumnIndex(Ob.LastColumn+1)+1:nc.FirstColumn<Ob.FirstColumn?0:mb.getColumnIndex(nc.FirstColumn+1);ic.LastColumn=nc.FirstColumn===Ob.LastColumn+1||nc.LastColumn>Ob.LastColumn?mb.getColumnIndex(Ob.LastColumn+1)+1:mb.getColumnIndex(nc.LastColumn+1);return ic};w.prototype.M9g=function(Ob,nc,mb){if(!nc||!mb||!Ob)return null;var ic=Ob.getPrintArea();if(!ic||!ic.length)return null;var qc=Ob.getRowIndex(mb.FirstRow+
1),hc=Ob.getColumnIndex(mb.FirstColumn+1),Jc=null,rd=null;ic=ik(ic);for(var md=ic.next();!md.done;md=ic.next())if(md=md.value,qc>=md.FirstRow&&qc<=md.LastRow&&hc>=md.FirstColumn&&hc<=md.LastColumn){if(mb.FirstRow===md.FirstRow&&mb.FirstColumn===md.FirstColumn)return new F;qc>md.FirstRow&&(Jc=Object(ka.a)(new H,{Index:qc-1,Min:md.FirstColumn-1,Max:Math.min(md.LastColumn,Ob.getColumnIndex(nc.LastColumn+1))}));hc>md.FirstColumn&&(rd=Object(ka.a)(new H,{Index:hc-1,Min:md.FirstRow-1,Max:Math.min(md.LastRow,
Ob.getRowIndex(nc.LastRow+1))}));break}return Jc||rd?Object(ka.a)(new F,{Row:Jc?[Jc]:null,Col:rd?[rd]:null}):null};w.prototype.$$g=function(Ob,nc,mb){if(!nc||!mb||!Ob)return null;var ic=null;mb.FirstRow>nc.FirstRow&&mb.FirstRow<=nc.LastRow?ic=Object(ka.a)(new H,{Index:Ob.getRowIndex(mb.FirstRow+1)-1,Min:-1,Max:-1}):mb.FirstRow===nc.LastRow+1&&(ic=Object(ka.a)(new H,{Index:Ob.getRowIndex(nc.LastRow+1),Min:-1,Max:-1}));return ic};w.prototype.w6g=function(Ob,nc,mb){if(!nc||!mb||!Ob)return null;var ic=
null;mb.FirstColumn>nc.FirstColumn&&mb.FirstColumn<=nc.LastColumn?ic=Object(ka.a)(new H,{Index:Ob.getColumnIndex(mb.FirstColumn+1)-1,Min:-1,Max:-1}):mb.FirstColumn===nc.LastColumn+1&&(ic=Object(ka.a)(new H,{Index:Ob.getColumnIndex(nc.LastColumn+1),Min:-1,Max:-1}));return ic};w.prototype.CEe=function(Ob,nc,mb){if(!mb||!Ob||!nc)return null;var ic=this.$$g(Ob,nc,mb);Ob=this.w6g(Ob,nc,mb);return ic||Ob?Object(ka.a)(new F,{Row:ic?[ic]:null,Col:Ob?[Ob]:null}):null};w.prototype.Qei=function(){var Ob=new ca.StandardDialog;
Ob.Rb=0;Ob.kc(1,ra.a.instance.ga(4));Ob.rl(ra.a.instance.ga(572),ra.a.instance.ga(573),1,null)};w.prototype.FFj=function(Ob){if(this.Kva.kb(Ob)&&(Aa.HelperMethods.i_&&(this.ZFb=this.$.Fb.sc("UserAction","PrintAreaPageBreaksTimeStopwatch")),this.OKa.kb(Ob)&&this.OKa.remove(Ob),this.OKa.add(Ob,Ra.a.create().toString()),pa.g(this.$).si)){var nc=Yb.b()?Yb.b().Xh(Ob):"";pa.g(this.$).si.L7(this.Kva.na(Ob),this.OKa.na(Ob),nc)}};w.prototype.QXg=function(Ob){if(this.ZFb&&Ob){var nc=this.ZFb.qc;this.ZFb.stop();
this.ZFb=null;switch(Ob){case "SetPrintArea":this.nqb(nc,1700,Ob);break;case "ClearPrintArea":this.nqb(nc,1500,Ob);break;case "InsertPageBreak":this.nqb(nc,1500,Ob);break;case "RemovePageBreak":this.nqb(nc,1600,Ob);break;case "ResetAllPageBreaks":this.nqb(nc,1700,Ob)}}};w.prototype.nqb=function(Ob,nc,mb){Ob>nc&&(nc=Object(ka.a)(new Sb.a,{extendedProperties:new Map}),nc.extendedProperties.set("OperationName",mb),nc.extendedProperties.set("OperationExecutionTime",Ob.toString()),Ia.Health.instance.recordQosError(Wa.a.sEj,
[Hb.a.oEj],!1,!0,!0,!1,nc))};w.prototype.m5h=function(Ob,nc,mb,ic,qc,hc){var Jc=this,rd=new ca.StandardDialog,md=new jb.a(ra.a.instance.ga(570),ra.a.instance.ga(571),ra.a.instance.ga(6),ra.a.instance.ga(5));rd.Rb=1;rd.kc(1,md.confirmButton);rd.kc(0,md.cancelButton);rd.rl(md.title,md.body,3,function(Cc){1===Cc&&(Jc.g0f(Ob.command,qc,hc),Jc.hbf(Ob,mb,ic,nc,hc))})};w.prototype.mOb=function(Ob,nc,mb){mb();this.OKa.kb(nc)&&Ob.si.P0(this.OKa.na(nc),sa.BasicTelemetryCalculator.KQ)};w.prototype.gXd=function(){this.Mpd&&
this.$.Cd(-1753588160,-1,0,null)};Object(ea.a)(w,"PrintAreaBreakManager",null,[904]);var wb=b(415),wa=b(87);y.prototype.equals=function(Ob){return Ob?this.orientation===Ob.orientation&&this.Lca===Ob.Lca&&this.w0===Ob.w0&&this.margin===Ob.margin&&this.sheetPrintOptions===Ob.sheetPrintOptions&&this.Q1a===Ob.Q1a&&this.NoColor===Ob.NoColor:!1};y.zCe=function(Ob,nc){Ob&&nc&&(nc.wv=Ob.wv,nc.orientation=Ob.orientation,nc.Lca=Ob.Lca,nc.w0=Ob.w0,nc.margin=Ob.margin,nc.ignorePrintArea=Ob.ignorePrintArea,nc.sheetPrintOptions=
Ob.sheetPrintOptions,nc.Q1a=Ob.Q1a,nc.NoColor=Ob.NoColor)};Object(ea.a)(y,"PrintSettingsContainer",null,[]);var Oa=b(160),Ub=b(361),hb=b(38),Xb=b(1034),Gc=b(1004),uc=b(192),Nc=b(746),Fb=b(625);Object(ea.a)(z,"PrintSettingMarginOption",null,[]);Object(ea.a)(A,"PrintSettingMarginValue",null,[]);Object(ea.a)(u,"PrintSettingOption",null,[]);l.prototype.dispose=function(){};l.prototype.owb=function(Ob){if(!Ob)return null;var nc=new A;nc.left=Ob.Left;nc.right=Ob.Right;nc.top=Ob.Top;nc.bottom=Ob.Bottom;
nc.header=Ob.Header;nc.footer=Ob.Footer;return nc};l.prototype.f4c=function(Ob){ia.ULS.shipAssertTag(537154186,0,6===Ob.length,"PrintPreviewManager.CreatePageMargin: marginValue array passed in, doesn't contain 6 margin values");var nc={};nc.Top=Ob[0];nc.Bottom=Ob[1];nc.Left=Ob[2];nc.Right=Ob[3];nc.Header=Ob[4];nc.Footer=Ob[5];return nc};l.prototype.Wbi=function(){this.yje=[Object(ka.a)(new u,{printSettingOptionKey:1,printSettingOptionText:this.Fm.ga(1223)}),Object(ka.a)(new u,{printSettingOptionKey:2,
printSettingOptionText:this.Fm.ga(1216)}),Object(ka.a)(new u,{printSettingOptionKey:0,printSettingOptionText:this.Fm.ga(1215)})];this.Sce=[Object(ka.a)(new u,{printSettingOptionKey:1,printSettingOptionText:this.Fm.ga(1226)}),Object(ka.a)(new u,{printSettingOptionKey:2,printSettingOptionText:this.Fm.ga(1225)})];this.ide=[Object(ka.a)(new u,{printSettingOptionKey:1,printSettingOptionText:this.Fm.ga(1228)}),Object(ka.a)(new u,{printSettingOptionKey:5,printSettingOptionText:this.Fm.ga(1229)}),Object(ka.a)(new u,
{printSettingOptionKey:6,printSettingOptionText:this.Fm.ga(1236)}),Object(ka.a)(new u,{printSettingOptionKey:7,printSettingOptionText:this.Fm.ga(1230)}),Object(ka.a)(new u,{printSettingOptionKey:8,printSettingOptionText:this.Fm.ga(1231)}),Object(ka.a)(new u,{printSettingOptionKey:9,printSettingOptionText:this.Fm.ga(1232)}),Object(ka.a)(new u,{printSettingOptionKey:11,printSettingOptionText:this.Fm.ga(1233)}),Object(ka.a)(new u,{printSettingOptionKey:12,printSettingOptionText:this.Fm.ga(1234)}),Object(ka.a)(new u,
{printSettingOptionKey:13,printSettingOptionText:this.Fm.ga(1235)}),Object(ka.a)(new u,{printSettingOptionKey:3,printSettingOptionText:this.Fm.ga(1227)})];this.Ofe=[Object(ka.a)(new u,{printSettingOptionKey:0,printSettingOptionText:this.Fm.ga(1244)}),Object(ka.a)(new u,{printSettingOptionKey:1,printSettingOptionText:this.Fm.ga(1245)}),Object(ka.a)(new u,{printSettingOptionKey:2,printSettingOptionText:this.Fm.ga(1246)}),Object(ka.a)(new u,{printSettingOptionKey:3,printSettingOptionText:this.Fm.ga(1247)})];
this.Tae=[Object(ka.a)(new z,{printSettingOption:Object(ka.a)(new u,{printSettingOptionKey:0,printSettingOptionText:this.Fm.ga(1250)}),marginValue:this.owb(this.normal)}),Object(ka.a)(new z,{printSettingOption:Object(ka.a)(new u,{printSettingOptionKey:1,printSettingOptionText:this.Fm.ga(1251)}),marginValue:this.owb(this.wide)}),Object(ka.a)(new z,{printSettingOption:Object(ka.a)(new u,{printSettingOptionKey:2,printSettingOptionText:this.Fm.ga(1252)}),marginValue:this.owb(this.narrow)}),Object(ka.a)(new z,
{printSettingOption:Object(ka.a)(new u,{printSettingOptionKey:3,printSettingOptionText:this.Fm.ga(1253)}),marginValue:this.owb(this.Q6)})]};l.prototype.Pbi=function(){this.normal=this.f4c(this.QEi);this.narrow=this.f4c(this.CDi);this.wide=this.f4c(this.SYj)};of.Object.defineProperties(l.prototype,{whatToPrintOptions:{configurable:!0,enumerable:!0,get:function(){return this.yje}},orientationOptions:{configurable:!0,enumerable:!0,get:function(){return this.Sce}},paperSizeOptions:{configurable:!0,enumerable:!0,
get:function(){return this.ide}},scalingOptions:{configurable:!0,enumerable:!0,get:function(){return this.Ofe}},marginDetailedOptions:{configurable:!0,enumerable:!0,get:function(){return this.Tae}}});l.geh=1;l.Udh=1;l.wsb=9;l.Zdh=2;l.Sdh=0;l.Ldh=!1;l.Hdh=!1;l.nIa={PrintGrid:!1,HorizontalCenter:!1,VerticalCenter:!1,PrintHeaders:!1};Object(ea.a)(l,"PrintSettingsManagerBase",null,[6]);var ob=b(127),zb=b(299);x.prototype.getSheetName=function(){return this.sheetName};Object(ea.a)(x,"MacroRecorderSheetPrintOptionsSavedPayload",
null,[430]);$k(m,l);m.prototype.Hei=function(Ob){var nc=this;this.Iei(function(mb){Ob&&(mb=nc.QVh(mb),Ob(mb))})};m.prototype.HMd=function(Ob,nc){if(Ob){var mb=new I(Ob.wv,Ob.ignorePrintArea);this.hlj(mb);!nc||this.w5f?ia.ULS.sendTraceTag(593294034,0,50,"PrintSettingsManager.SavePrintSettings: Saving of print settings skipped because "+(nc?"skipSaveToFile is true":"shouldFilePersistedPrintSettingsBeSaved is false")):(nc=this.SVh(Ob.w0),nc.IsLandscape=2===Ob.orientation,nc.PaperSize=Ob.Lca,this.isUniversalPrintEnabled&&
(nc.NoColor=Ob.NoColor),nc.PageMargin=this.Vfd(Ob.margin),nc.SheetPrintOptions=l.nIa,nc.SheetPrintOptions.PrintGrid=Ob.sheetPrintOptions.PrintGrid,nc.SheetPrintOptions.HorizontalCenter=Ob.sheetPrintOptions.HorizontalCenter,nc.SheetPrintOptions.VerticalCenter=Ob.sheetPrintOptions.VerticalCenter,nc.SheetPrintOptions.PrintHeaders=Ob.sheetPrintOptions.PrintHeaders,this.glj(nc))}else ia.ULS.sendTraceTag(593294035,0,10,"PrintSettingsManager.SavePrintSettings: printSettingsContainer passed as parameter is null")};
m.prototype.Vfd=function(Ob){var nc={};0===Ob?nc=this.normal:1===Ob?nc=this.wide:2===Ob?nc=this.narrow:3===Ob&&(nc=this.Q6);return nc};m.prototype.Yei=function(Ob){var nc=this;if(Ob){ia.ULS.sendTraceTag(537154197,0,50,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: Make server call to save print options to file");var mb=function(){return new x(nc.$.xa.pa.name,Ob)},ic=this.$.oa.va,qc=this.$.oa.va.Pb(),hc=function(Jc,rd,md){var Cc=nc.$.xa.pa.name;Jc=$a.b(nc.rBd,Jc);rd=$a.a(nc.ABd,rd);var fd=ic.Na(1,
null);fd.sheetName=Cc;fd.printOptions=Ob;return La.g(ic,"SetPrintOptions",fd,Jc,rd,md,qc,0)};mb=va.EwaSettings.Zb()?new vb.a(598,0,hc,64,mb):new nb.a(598,0,hc,void 0,mb);this.$.userOperationManager.Sb(mb,null)}else ia.ULS.sendTraceTag(537154198,0,10,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: sheetPrintOptions passed as parameter is null")};m.prototype.dispose=function(){this.Ad||(this.Ad=!0,this.$.userOperationManager.to(this.yz),this.fY())};m.prototype.hlj=function(Ob){this.NN.wv=Ob.wv;
this.NN.ignorePrintArea=Ob.ignorePrintArea};m.prototype.Iei=function(Ob){function nc(rd,md,Cc){return B(qc.$.oa.va,qc.sheetName,qc.locale,$a.b(rd,ic),$a.a(md,mb),Cc,hc)}function mb(rd){rd=Ha.a.xf(rd.data);ia.ULS.sendTraceTag(537154194,0,10,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: "+Jb.a.Cc(rd)+".");Ob(null)}function ic(rd){zb.a(rd)?ia.ULS.sendTraceTag(537154196,0,15,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: "+
Jb.a.Cc(rd.Errors)+"."):(ia.ULS.sendTraceTag(537154195,0,50,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings succeeded."),Ob(rd.Result))}var qc=this,hc=this.$.oa.va.Pb();var Jc=va.EwaSettings.Zb()?new vb.a(247,0,nc,80):new nb.a(247,0,nc,16);Jc=this.$.userOperationManager.Sb(Jc,null);this.av.add(Jc)};m.prototype.glj=function(Ob){var nc=this;ia.ULS.sendTraceTag(593294031,0,50,"PrintSettingsManager.SavePrintSettingsPersistedInFile: Make server call to save print settings to file");
var mb=this.$.oa.va.Pb();this.$.userOperationManager.Sb(new vb.a(226,0,function(ic,qc,hc){return U(nc.$.oa.va,nc.sheetName,Ob,$a.b(ic,nc.nSi),$a.a(qc,nc.mSi),hc,mb)},void 0,function(){return new L(nc.sheetName,Ob)}),null)};m.prototype.bmi=function(Ob){return this.Bcf(Ob)||!this.Mff(Ob.PaperSize)};m.prototype.Tad=function(Ob){this.Bcf(Ob)&&(ia.ULS.sendTraceTag(537154192,0,50,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Custom scaling present in file."),Ob.ScalingWidth=m.U5c,Ob.ScalingHeight=
m.T5c,Ob.ScalingPercent=m.t6b,Ob.FitToPage=m.N5c);this.Mff(Ob.PaperSize)||(ia.ULS.sendTraceTag(537154191,0,15,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Paper size "+Ob.PaperSize.toString()+" present in file which is unsupported by XLO."),Ob.PaperSize=m.wsb);return Ob};m.prototype.OVh=function(Ob){if(Ob.FitToPage){if(1===Ob.ScalingWidth&&1===Ob.ScalingHeight)return 1;if(!Ob.ScalingWidth&&1===Ob.ScalingHeight)return 3}else return 0;return 2};m.prototype.NVh=function(Ob){return this.vpd(Ob,
this.normal)?0:this.vpd(Ob,this.wide)?1:this.vpd(Ob,this.narrow)?2:3};m.prototype.vpd=function(Ob,nc){return Ob.Left===nc.Left&&Ob.Right===nc.Right&&Ob.Top===nc.Top&&Ob.Bottom===nc.Bottom&&Ob.Header===nc.Header&&Ob.Footer===nc.Footer};m.prototype.SVh=function(Ob){var nc={};nc.ScalingPercent=m.t6b;nc.FitToPage=0!==Ob;2===Ob?(nc.ScalingWidth=1,nc.ScalingHeight=0):3===Ob?(nc.ScalingWidth=0,nc.ScalingHeight=1):1===Ob&&(nc.ScalingWidth=1,nc.ScalingHeight=1);return nc};m.prototype.Mff=function(Ob){return this.xXi.contains(Ob.toString())};
m.prototype.Bcf=function(Ob){return 100!==Ob.ScalingPercent||Ob.FitToPage&&(1<Ob.ScalingWidth||1<Ob.ScalingHeight)};m.prototype.h4g=function(){for(var Ob=new Nc.a(Fb.a.Jk()),nc=0;nc<this.paperSizeOptions.length;nc++)Ob.add(this.paperSizeOptions[nc].printSettingOptionKey.toString());return Ob};m.prototype.QVh=function(Ob){var nc=null;if(Ob){var mb=this.NN.wv,ic=this.NN.ignorePrintArea;this.bmi(Ob)&&(this.w5f=!0,Ob=this.Tad(Ob));nc=new y;nc.wv=mb;nc.ignorePrintArea=ic;nc.orientation=Ob.IsLandscape?
2:1;nc.Lca=Ob.PaperSize;nc.w0=this.OVh(Ob);nc.sheetPrintOptions=l.nIa;nc.sheetPrintOptions.PrintGrid=Ob.SheetPrintOptions.PrintGrid;nc.Q1a=Ob.Draft;this.isUniversalPrintEnabled&&(nc.NoColor=Ob.NoColor);nc.sheetPrintOptions.HorizontalCenter=Ob.SheetPrintOptions.HorizontalCenter;nc.sheetPrintOptions.VerticalCenter=Ob.SheetPrintOptions.VerticalCenter;nc.sheetPrintOptions.PrintHeaders=Ob.SheetPrintOptions.PrintHeaders;nc.margin=this.NVh(Ob.PageMargin);va.EwaSettings.isChangeGateEnabled("OfficeVSO:5466517_AddPageMarginLogs")&&
ia.ULS.sendTraceTag(553965398,0,50,"PageMargin received : "+nc.margin);3===nc.margin&&(this.Q6={},this.Q6.Left=Ob.PageMargin.Left,this.Q6.Right=Ob.PageMargin.Right,this.Q6.Top=Ob.PageMargin.Top,this.Q6.Bottom=Ob.PageMargin.Bottom,this.Q6.Header=Ob.PageMargin.Header,this.Q6.Footer=Ob.PageMargin.Footer)}return nc};m.prototype.fY=function(){if(this.av){for(var Ob=ik(this.av),nc=Ob.next();!nc.done;nc=Ob.next())nc=nc.value,this.$&&this.$.userOperationManager&&(nc.operation&&ia.ULS.sendTraceTag(537154187,
0,50,"PrintSettingsManager.AbortOutstandingUserOperation: Trying to abort pending operation "+ob.a(nc.operation.operationName)+"."),this.$.userOperationManager.Hta(nc)),this.av.remove(nc);this.av=null}};m.U5c=1;m.T5c=0;m.t6b=100;m.wsb=9;m.N5c=!0;Object(ea.a)(m,"PrintSettingsManager",l,[]);var ib=b(68);Object(ea.a)(v,"PrintSettingsTaskPaneCallbacks",null,[]);Object(ea.a)(f,"SelectedPrintSettings",null,[]);Object(ea.a)(n,"PrintOperationCallbacks",null,[]);Object(ea.a)(k,"PrintPreviewPaneCallbacks",
null,[]);var fc=b(1291);Object(ea.a)(h,"UniversalPrintAppSettings",null,[]);var Ic=b(399);e.prototype.NHg=function(Ob){this.Pa.addHandler("ppocek",Ob)};e.prototype.Rdj=function(Ob){this.Pa.removeHandler("ppocek",Ob)};e.prototype.sCj=function(Ob,nc){this.yhj();this.$.userOperationManager.Br(this.yz);this.Em=Ob;this.Pa.raiseEvent("ppocek");this.Em.SelectedRanges&&this.Em.SelectedRanges.Ranges&&0<this.Em.SelectedRanges.Ranges.length&&this.Em.SelectedRanges.Ranges[0]&&(this.selectedRange=ba.B(this.Em.SelectedRanges.Ranges[0]).toString());
ia.ULS.shipAssertTag(537154268,0,!this.dv,"PrintPreviewManager.ShowPrintPreviewer: printSettingsManager should be null.");this.dv=new m(this,this.$,nc,this.$.xa.pa.name,ra.a.instance,this.isUniversalPrintEnabled);ia.ULS.shipAssertTag(537154267,0,!this.lg,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should be null.");this.lg=new Gc.PrintPreviewPane(this.$,this,this.useMSPdfViewer,this.isUniversalPrintEnabled);this.lg.Lhh();this.lg.uCj();this.lg.fHg(this.wAf)};e.prototype.VSh=function(){this.dv.Q6&&
4<=this.dv.marginDetailedOptions.length&&(this.dv.marginDetailedOptions[3].marginValue=this.dv.owb(this.dv.Q6));return this.dv.marginDetailedOptions};e.prototype.ixc=function(){return!!this.Em&&!!this.Em.ObjectId||!pa.g(this.$).ha.sa.rg};e.prototype.TVh=function(){var Ob=Object(ka.a)(new f,{selectedWhatToPrint:l.geh,selectedOrientation:l.Udh,selectedPaperSize:l.wsb,selectedScaling:l.Zdh,selectedMargin:l.Sdh,selectedIgnorePrintArea:l.Ldh,selectedPrintGridlines:l.nIa.PrintGrid,selectedDraft:l.Hdh,selectedHorizontalCenter:l.nIa.HorizontalCenter,
selectedVerticalCenter:l.nIa.VerticalCenter,selectedRowAndColumnHeadings:l.nIa.PrintHeaders});this.pH?(Ob.selectedWhatToPrint=this.pH.wv,Ob.selectedOrientation=this.pH.orientation,Ob.selectedPaperSize=this.pH.Lca,Ob.selectedScaling=this.pH.w0,Ob.selectedMargin=this.pH.margin,Ob.selectedIgnorePrintArea=this.pH.ignorePrintArea,Ob.selectedPrintGridlines=this.pH.sheetPrintOptions.PrintGrid,Ob.selectedDraft=this.pH.Q1a,this.isUniversalPrintEnabled&&(Ob.selectedColor=this.pH.NoColor?0:1),Ob.selectedHorizontalCenter=
this.pH.sheetPrintOptions.HorizontalCenter,Ob.selectedVerticalCenter=this.pH.sheetPrintOptions.VerticalCenter,Ob.selectedRowAndColumnHeadings=this.pH.sheetPrintOptions.PrintHeaders):ia.ULS.sendTraceTag(593294038,0,10,"PrintPreviewManager.GetPrintSettingsSelectedOnPaneOpen: initialPrintSettings is null.");return Ob};e.prototype.m1e=function(){var Ob=this;return Object(ka.a)(new k,{onBackToSheet:function(){Ob.Ula()}})};e.prototype.PVh=function(){var Ob=this;return Object(ka.a)(new fc.a,{backActionButtonText:ra.a.instance.ga(1203),
printPreviewPaneCallbacks:this.m1e(),logger:new wb.a,disableTellMeControl:!0,printOperationCallbacks:Object(ka.a)(new n,{onClosePreviewer:function(){Ob.Ula()},getGraphServiceAuthorizationToken:this.uac(),onLocalPrint:function(){Ob.iBf()},onNotifyPrintJobStatus:this.onNotifyPrintJobStatus}),universalPrintAppSettings:Object(ka.a)(new h,{graphServiceEndpoint:this.graphServiceEndpoint,graphServiceEndpointVersion:this.kgi()?"testppebeta-print":"v1.0",isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled,
appName:"Excel"})})};e.prototype.RVh=function(){var Ob=this;return Object(ka.a)(new v,{onSettingChange:function(nc){Ob.cRi(nc)},onPrint:function(){Ob.iBf()}})};e.prototype.cRi=function(Ob){this.e0++;Ob?(this.lg&&this.lg.kDj(),this.qk.wv=Ob.selectedWhatToPrint,this.qk.w0=Ob.selectedScaling,this.qk.orientation=Ob.selectedOrientation,this.qk.Lca=Ob.selectedPaperSize,this.qk.margin=Ob.selectedMargin,this.isUniversalPrintEnabled&&(this.qk.NoColor=!Ob.selectedColor),this.qk.ignorePrintArea=Ob.selectedIgnorePrintArea,
this.gtj(Ob.selectedPageStart,Ob.selectedPageEnd),this.dv&&this.s6h(this.qk,Ob)?(this.qk.sheetPrintOptions=l.nIa,this.qk.sheetPrintOptions.PrintGrid=Ob.selectedPrintGridlines,this.qk.sheetPrintOptions.HorizontalCenter=Ob.selectedHorizontalCenter,this.qk.sheetPrintOptions.VerticalCenter=Ob.selectedVerticalCenter,this.qk.sheetPrintOptions.PrintHeaders=Ob.selectedRowAndColumnHeadings,this.dv.Yei(this.qk.sheetPrintOptions)):this.Myb()):ia.ULS.sendTraceTag(593294037,0,10,"PrintPreviewManager.OnPrintSettingsChange: changedPrintSettings passed as input is null.")};
e.prototype.Ula=function(){this.j6a&&(this.oNb=!0);ia.ULS.sendTraceTag(591196513,0,50,"PrintPreviewManager.OnCloseButtonClick: User changed printSettings "+this.e0+" times before clicking on backToWorkbook icon");this.hBf();this.zye()};e.prototype.iBf=function(){ia.ULS.sendTraceTag(591196512,0,50,"PrintPreviewManager.OnPrintButtonClick: User changed printSettings "+this.e0+" times before clicking on print button.");va.EwaSettings.isChangeGateEnabled("OfficeVSO:5466517_AddPageMarginLogs")&&ia.ULS.sendTraceTag(543024129,
0,50,"PrintPreviewManager.OnPrintButtonClick: Current margin value : "+this.qk.margin+", Initial margin value : "+this.pH.margin);if(this.useMSPdfViewer)this.kJf();else if(this.R6a)try{this.lg.printPdf(),this.d1c()}catch(Ob){ia.ULS.sendTraceTag(574482433,0,15,"PrintPreviewManager.OnPrintButtonClick: Unable to print. Opening the window."),this.kJf()}else this.qia.x4f(this.PHa(!0)),this.d1c()};e.prototype.kJf=function(){var Ob=this.PHa(!0);this.d1c();Aa.HelperMethods.Te(Ob,void 0,void 0,"PrintPreviewManager.CreateFileCopyFileHandlerURL")};
e.prototype.dispose=function(){wa.a.Ia(this.Pa)};e.prototype.Myb=function(){var Ob=this;if(this.$.Dwa)this.Eei();else{this.fY();this.tUf();var nc=null;this.nbi();ia.ULS.sendTraceTag(593266766,0,50,"PrintPreviewManager:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");var mb=function(ic,qc,hc){ic=new Ka.a(ic,null,qc,hc,null,!0,!1,"GetFileCopyFileHandler","");ic.correlationID=Ra.a.create().toString();nc=ic;Ob.cca=Ob.f3.P9(Ob.PHa(Ob.R6a?!1:!0,Ob.dgi?"Base64":"Pdf"),1,null,null,e.gad,!1,
2,Ob.lAd,Ob.kAd,nc,void 0,void 0,void 0,12E4);ic.requestId=Ob.cca;ia.ULS.sendTraceTag(537154264,0,50,"PrintPreviewManager.InvokeGetFileCopyFileHandler: Creating request with id: "+Ob.cca+".");return la.Task.Ua(!0)};this.mNa=va.EwaSettings.Zb()?this.$.userOperationManager.Sb(new vb.a(223,0,mb,80),null):this.$.userOperationManager.Sb(new nb.a(223,0,mb,16),null)}};e.prototype.d1c=function(){this.hBf();this.zye()};e.prototype.rBd=function(Ob){Jb.a.Tq(Ob.Errors)?this.lg.showErrorMessageForPrintOptions(ra.a.instance.ga(1254)):
(ia.ULS.sendTraceTag(537154263,0,50,"PrintPreviewManager.OnPrintOptionsUpdationSuccess: SetPrintOptions server call is successful."),this.Myb(),this.lg&&this.lg.hideErrorMessageForPrintOptions())};e.prototype.ABd=function(Ob){this.lg&&this.lg.showErrorMessageForPrintOptions(ra.a.instance.ga(1254));Ob=Ha.a.xf(Ob.data);ia.ULS.sendTraceTag(537154262,0,10,"PrintPreviewManager.OnSavePrintOptionsToFileFailure: Save print options to file failed. Errors: "+Jb.a.Cc(Ob)+".")};e.prototype.Eei=function(){function Ob(ic,
qc,hc){var Jc={};Jc.WhatToPrint=nc.qk.wv;Jc.UseNamedAction=nc.qia.Ixc();Jc.SelectedSheetName=nc.$.xa.pa.name;Jc.ActiveCell=nc.activeCell;Jc.SelectedRanges=[nc.selectedRange];Jc.IsPdfDocumentRequired=!1;Jc.Orientation=nc.qk.orientation;Jc.PaperSize=nc.qk.Lca;Jc.Scaling=nc.qk.w0;Jc.RichValuesEnabled=!0;Jc.IgnorePrintArea=nc.qk.ignorePrintArea;Jc.Preview=!0;nc.isUniversalPrintEnabled&&(Jc.NoColor=nc.qk.NoColor);nc.d2f()&&(Jc.PaginationStartPage=nc.Zya,Jc.PaginationEndPage=nc.sma,Jc.OutputTotalPdfPageCount=
!0);var rd=nc.dv.Vfd(nc.qk.margin);rd&&(Jc.PageMargin={},Jc.PageMargin.Top=rd.Top,Jc.PageMargin.Bottom=rd.Bottom,Jc.PageMargin.Left=rd.Left,Jc.PageMargin.Right=rd.Right,Jc.PageMargin.Header=rd.Header,Jc.PageMargin.Footer=rd.Footer);nc.U7a=Q(nc.$.oa.va,Jc,$a.b(nc.PJi,ic),$a.a(nc.OJi,qc),hc,mb);return nc.U7a}var nc=this;ia.ULS.sendTraceTag(553649883,0,50,"PrintPreviewManager:InvokeConvertWorkbookToPrintPdf - Invoking ConvertWorkbookToPrintPdf");this.fY();var mb=this.$.oa.va.Pb();va.EwaSettings.Zb()?
this.mNa=this.$.userOperationManager.Sb(new vb.a(133,0,Ob,80),null):this.mNa=this.$.userOperationManager.Sb(new nb.a(133,0,Ob,16),null)};e.prototype.zye=function(){this.$.userOperationManager.to(this.yz);this.fY();this.tUf();ia.ULS.shipAssertTag(537154261,0,!!this.lg,"PrintPreviewManager.cleanUpPrintPreviewPanes: printPreviewPane should not be null");this.lg&&(this.lg.udj(this.wAf),this.lg.Uhh(),this.lg=null);this.Em=null;this.dv&&(this.dv.dispose(),this.dv=null);this.q3a=this.kGb=null;this.vLc=!1;
this.Pa&&this.Pa.raiseEvent("ppocek")};e.prototype.eyj=function(){return this.$.isEditMode&&!!this.pH&&!!this.qk&&2!==this.qk.wv&&this.fjd()};e.prototype.HMd=function(){ia.ULS.shipAssertTag(537154260,0,!!this.dv,"PrintPreviewManager.SavePrintSettings: printSettingsManager should not be null");this.dv&&this.dv.HMd(this.qk,this.eyj())};e.prototype.PHa=function(Ob,nc){nc=void 0===nc?"Pdf":nc;var mb=new Sys.StringBuilder;mb.append(eb.a(this.$,nc,!0));Ea.a.Rg(mb,Sa.a.bGd,""+this.qk.wv);Ob&&this.qia.Ixc()&&
Ea.a.Rg(mb,Sa.a.ifg,"1");Ea.a.Rg(mb,Sa.a.FKf,this.$.xa.pa.name);0===this.qk.wv&&(Ea.a.Rg(mb,Sa.a.EKf,this.selectedRange),Ea.a.Rg(mb,Sa.a.yKf,this.activeCell));Ea.a.Rg(mb,Sa.a.zKf,""+this.qk.orientation);Ea.a.Rg(mb,Sa.a.AKf,""+this.qk.Lca);Ea.a.Rg(mb,Sa.a.DKf,""+this.qk.w0);Ea.a.Rg(mb,Sa.a.CKf,"1");Ea.a.Rg(mb,Sa.a.xKf,this.qk.ignorePrintArea?"1":"0");Ea.a.Rg(mb,Sa.a.BKf,"1");this.uLg(mb);this.isUniversalPrintEnabled&&Ea.a.Rg(mb,Sa.a.S3i,this.qk.NoColor?"1":"0");this.tLg(mb);dc.a.equals(nc,"Pdf",!0)&&
(mb.append("&#toolbar=0"),mb.append("&zoom=100"));Ob=mb.toString().replace("GetFileCopyFileHandler.aspx?","GetFileCopyFileHandler.aspx/?");ia.ULS.sendTraceTag(537154259,0,50,"PrintPreviewManager: Print Pdf Url "+Ob);return Ob};e.prototype.gtj=function(Ob,nc){Ob||nc?(this.gzb=!0,this.Zya=Ob,this.sma=nc):this.GTf()};e.prototype.uLg=function(Ob){this.d2f()&&(Ea.a.Rg(Ob,Sa.a.U3i,""+this.Zya),Ea.a.Rg(Ob,Sa.a.T3i,""+this.sma),Ea.a.Rg(Ob,Sa.a.V3i,"1"),ia.ULS.sendTraceTag(537154258,0,50,"PrintPreviewManager: AppendPaginationQueryParameter Print Pdf page range from "+
this.Zya+" to "+this.sma))};e.prototype.d2f=function(){return null!=this.Zya&&0<this.Zya&&null!=this.sma&&0<this.sma};e.prototype.tLg=function(Ob){if(this.dv&&this.qk){var nc=this.dv.Vfd(this.qk.margin);nc&&Ea.a.Rg(Ob,Sa.a.R3i,""+nc.Top+" "+nc.Bottom+" "+nc.Left+" "+nc.Right+" "+nc.Header+" "+nc.Footer)}};e.prototype.MEb=function(Ob,nc,mb,ic){this.lg&&(ia.ULS.shipAssertTag(537154255,0,!!this.$.xa.pa,"PrintPreviewManager.OnConvertWorkbookToPdfSucceeded: ewaControl.Sheets.ActiveItem should not be null"),
this.$.xa.pa&&(this.R6a?(ic||(ic=this.PHa(!1)),this.lg.kui(ic)):this.mCj()))};e.prototype.fjd=function(){return!this.pH.equals(this.qk)};e.prototype.hBf=function(){!this.oNb&&0<this.e0&&(this.Npd?this.HMd():ia.ULS.sendTraceTag(537154251,0,50,"PrintPreviewManager:OnPreviewerClose - Previewer is being closed without settings pane being loaded."));ia.ULS.shipAssertTag(537154250,0,!!this.lg,"PrintPreviewManager.OnPreviewerClose: printPreviewPane should not be null");this.lg&&this.lg.E7h();this.gXd()};
e.prototype.gj=function(){ia.ULS.sendTraceTag(593294036,0,50,"PrintPreviewManager.ShowErrorDialog: Error Dialog displayed.");if(this.lg){var Ob=this.YQa(ra.a.instance.ga(1));this.SAa(Ob,1)}else Ob=Jb.a.Xc(1,0,26,0,1,-1100324317,"GetPrintSettingsFailedError"),va.EwaSettings.oz()?new Ub.a(this.$,Ob):(new Oa.ErrorDialog(this.$,Ob)).qf()};e.prototype.tCj=function(Ob){Ob?(0===Ob.wv&&this.ixc()&&(ia.ULS.sendTraceTag(537154249,0,50,"PrintPreviewManager.ShowPrintPreviewer: Falling back to ActiveSheet because current selection is a $"+
(this.Em.ObjectId?"floatingObject":"discontinuousRange")+"."),Ob.wv=1),y.zCe(Ob,this.pH),y.zCe(Ob,this.qk),ia.ULS.shipAssertTag(537154248,0,!!this.lg,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should not be null"),this.lg&&(this.Npd=!0,this.lg.vCj(),this.Myb())):(ia.ULS.sendTraceTag(537154247,0,10,"PrintPreviewManager.ShowPrintPreviewer: printSettings fetched from server is null."),this.gj())};e.prototype.Y_c=function(Ob,nc,mb){Ob>nc&&(nc=Object(ka.a)(new Sb.a,{extendedProperties:new Map}),
nc.extendedProperties.set("WtpSelectedValue",mb),nc.extendedProperties.set("FullyRenderedPdfLoadTime",Ob.toString()),Ia.Health.instance.recordQosError(Wa.a.qEj,[Hb.a.D5f],!1,!0,!0,!1,nc))};e.prototype.fY=function(){this.mNa&&(0<this.cca||this.U7a)&&(ia.ULS.sendTraceTag(537154246,0,50,"PrintPreviewManager.AbortOutstandingUserOperation: Cancelling request with id: "+this.cca+"."),this.$.userOperationManager.Hta(this.mNa),this.U7a?Ha.a.mu(this.U7a.Gt):this.f3.mu(this.cca),this.nLd())};e.prototype.nLd=
function(){this.U7a=this.mNa=null};e.prototype.nbi=function(){this.AKd&&this.qk&&(this.q3a=this.$.Fb.sc("UserAction",(1===this.qk.wv?"ActiveSheet":0===this.qk.wv?"CurrentSelection":"EntireWorkbook")+"FullyRenderedPdfLoadTimeStopwatch"))};e.prototype.GTf=function(){this.gzb=!1;this.Zya=1;this.sma=this.mFd};e.prototype.YQa=function(Ob){if(Ob)return Ob.replace("&#39;","'");ia.ULS.sendTraceTag(537154245,0,15,"PrintPreviewManager.SanitizeErrorMessage: error message is null");return Ob};e.prototype.mCj=
function(){ia.ULS.sendTraceTag(537154244,0,50,"PrintPreviewManager.ShowPdfRenderingError invoked");if(this.iAb)ia.ULS.sendTraceTag(537154243,0,10,"PrintPreviewManager.ShowPdfRenderingError: Called when preview was supported in both host & browser");else{var Ob=this.YQa(ra.a.instance.ga(1209));this.SAa(Ob,3)}};e.prototype.SAa=function(Ob,nc,mb){this.lg.Lz(Ob,nc,void 0===mb?null:mb)};e.prototype.ybi=function(){this.R6a=this.iAb=this.nYg();ia.ULS.sendTraceTag(557061534,0,50,"PrintPreviewManager.InitializeIsPdfPreviewSupportedVars: isPdfPreviewSupportedInCurrentHost: "+
this.iAb+", isPdfPreviewSupportedInPreviewer: "+this.R6a)};e.prototype.yhj=function(){this.R7a=null;this.nLd();this.GTf();this.kGb=this.$.Fb.sc("UserAction","paneLoadTimeStopwatch");this.activeCell=this.$.pa.activeCell.toString();this.e0=0;this.Npd=this.j6a=this.oNb=!1;this.vLc=!0};e.prototype.cAj=function(){var Ob=this.Loi()||this.Zhf()&&va.EwaSettings.isChangeGateEnabled("OfficeVSO:6059097_EnablePreviewer3rdParty")?!0:!1;ia.ULS.sendTraceTag(537154242,0,50,"PrintPreviewManager.ShouldUseMSPdfViewer : "+
Ob);return Ob};e.prototype.VXg=function(){var Ob=15;Ma.a.xH&&Ma.a.ftb&&(Ob=parseFloat(Ma.a.ftb));return 14<Ob&&this.iAb};e.prototype.nYg=function(){return this.Zhf()&&!va.EwaSettings.isChangeGateEnabled("OfficeVSO:6059097_EnablePreviewer3rdParty")?!1:!0};e.prototype.Loi=function(){return Ma.a.IC||da.AFrameworkApplication.isUnifiedHostMode};e.prototype.Zhf=function(){return!this.$.pe.get(111)};e.prototype.tUf=function(){this.R7a&&(URL.revokeObjectURL(this.R7a),this.R7a=null)};e.prototype.k6g=function(Ob){var nc=
Ob.data.Rd;Ob=this.$.Fb.sc("UserAction","PrintPreviewBlobFileCreation");var mb=window.self.atob(nc);nc=new Uint8Array(nc.length);for(var ic=0;ic<mb.length;ic++)nc[ic]=mb.charCodeAt(ic)&255;mb=new Blob([nc],{type:"application/pdf"});this.R7a=URL.createObjectURL(mb);ia.ULS.sendTraceTag(537154241,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - Blob created. Total time to create : "+Ob.qc+" ms. Blob size: "+mb.size);Ob.stop();return this.R7a+"#toolbar=0&zoom=100"};e.prototype.$7i=function(Ob){if(this.AKd&&
Jb.a.$g(Ob,e.LYi)){var nc=Object(ka.a)(new Sb.a,{extendedProperties:new Map});nc.extendedProperties.set("ErrorMessageIdName",Ob[0].MessageIdName);Ia.Health.instance.recordQosError(Wa.a.iJf,[Hb.a.jJf],!1,!0,!0,!1,nc)}};e.prototype.s6h=function(Ob,nc){return Ob.sheetPrintOptions.PrintGrid!==nc.selectedPrintGridlines||Ob.sheetPrintOptions.HorizontalCenter!==nc.selectedHorizontalCenter||Ob.sheetPrintOptions.VerticalCenter!==nc.selectedVerticalCenter||Ob.sheetPrintOptions.PrintHeaders!==nc.selectedRowAndColumnHeadings};
e.prototype.gXd=function(){this.Mpd&&this.$.Cd(-1753588160,-1,0,null)};e.prototype.kgi=function(){return!!this.$.ya&&!!this.$.ya.DocumentHostInfo&&"TestHost"===this.$.ya.DocumentHostInfo.HostTier};e.prototype.getToken=function(){ia.ULS.sendTraceTag(522314589,0,50,"PrintPreviewManager:GetToken: Token requested for universal print graph service");return this.hEb.EO("Print",this.graphServiceEndpoint).then(function(Ob){return Ob?(Ob.IsSuccess?ia.ULS.sendTraceTag(522314588,0,50,"PrintPreviewManager:GetToken: successfully acquired token for universal print graph service"):
ia.ULS.sendTraceTag(537154240,0,15,"PrintPreviewManager:GetToken: failed to get token. Error code: "+Ob.ErrorCode+", Error message : "+Ob.ErrorMessage),Ob):Object(ka.a)(new Xb.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"})}).catch(function(Ob){var nc=new Xb.a;Object.getType(Ob)===Object.getType(nc)?nc=Ob:(nc.ErrorMessage=Ob.toString(),nc.ErrorCode="exception");return Promise.resolve(nc)})};e.prototype.uac=function(){var Ob=this;return function(){var nc=Promise.resolve("");
try{if(Ob.hEb&&Ob.hEb.Y5a())return Ob.getToken().then(function(mb){return mb.IsSuccess?Promise.resolve(mb.Token):nc},function(){return nc})}catch(mb){ia.ULS.sendTraceTag(537154211,0,10,"PrintPreviewManager:GetAuthTokenDelegate - Exception thrown while fetching token")}return nc}};e.prototype.onNotifyPrintJobStatus=function(Ob,nc){Ob=Ic.a.pA.notificationBar.X$(Ob,!1);"pending"==nc&&(Ob.displayTimeoutSeconds=3);if(va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactToast",!1))switch(nc){case "failure":Ob.image=
1;break;case "success":Ob.image=3;break;default:Ob.image=0}else Ob.image=0;Ic.a.pA.notificationBar.QD(Ob)};of.Object.defineProperties(e.prototype,{ami:{configurable:!0,enumerable:!0,get:function(){return this.vLc}}});e.LYi=[-953554093,1773721536,-1104435974,-1243918982,1205917367,1931972532,1294226134,1239184329,1207537900,-1053855722,-2077518688,1348242499,2030854436,-1831476778];e.gad=["Content-Type","Total-Pdf-PageCount"];Object(ea.a)(e,"PrintPreviewManager",null,[827,6,828]);d.prototype.Nc=function(){return!1};
d.prototype.executeCommand=function(Ob,nc,mb,ic){var qc=nc.command;return 1588554917===qc?(nc.qzb=!0,Za.a(this.$)&&this.$.da.za(423).$xc(!1),this.uih(nc)?la.Task.Ua(!0):fa.a(qc)):this.gJf.executeCommand(Ob,nc,mb,ic,this.IQi,this.HQi,this.xNj)};d.prototype.Ac=function(Ob,nc){return 1588554917===nc.command?(ia.ULS.shipAssertTag(537154305,0,this.$.zka,"Command execute requested for Print operation when data duplication is disallowed."),!0):this.gJf.Ac(Ob,nc)};d.prototype.Tc=function(){return!1};d.prototype.uih=
function(Ob){return this.$.ea.dc?this.vih(Ob):!1};d.prototype.vih=function(Ob){ia.ULS.sendTraceTag(21099871,0,50,"PrintCommandHandler:DoPrintHtml");var nc=this.$.Fb.sc("UserAction","DoPrintHtml"),mb=this.$,ic=this.ea.isNamedObjectViewMode?mb.vb.pa.sheetName:mb.xa.pa.name,qc=this.ea.isNamedObjectViewMode,hc=!qc;mb=this.MVh(mb,ic,hc);var Jc=!0;!va.EwaSettings.isChangeGateEnabled("OfficeVSO:5315453_MoveWebpartsSessionsToPreviewer")&&this.$.Dwa&&(Jc=!1);hc?Jc?Ua.a(this.$)?ia.ULS.sendTraceTag(537154304,
0,50,"PrintCommandHandler:DoPrintHtml - Print previewer is already opened."):(this.fD.sCj(mb,this.NN),ia.ULS.sendTraceTag(591196515,0,50,"PrintCommandHandler:DoPrintHtml Print previewer opened")):((new K(this.$,ra.a.instance.ga(1217),3,mb,Ob,this.qia,ic,this.NN)).qf(),ia.ULS.sendTraceTag(595194760,0,50,"PrintCommandHandler:DoPrintHtml Print dialog shown in pdf mode in "+nc.qc+" ms.")):((new O(this.$,ra.a.instance.ga(1217),3,mb,Ob)).qf(),ia.ULS.sendTraceTag(591196514,0,15,"PrintCommandHandler:DoPrintHtml Print dialog shown in html mode in "+
nc.qc+" ms. isNamedObjectViewMode: "+qc+"."));nc.stop();this.nid();return!0};d.prototype.MVh=function(Ob,nc,mb){var ic={};ic.SessionId=this.ea.sessionId;ic.UsedRangeTooBig=!1;var qc=pa.g(Ob),hc=qc.ha,Jc=hc.Re;if(bb.e(Ob.pa))ic.Type=0,ic.ObjectId=Ob.pa.name,ic.UseSelection=!1;else if(bb.g(Ob.pa))ic.Type=1,ic.ObjectId=Ob.pa.ALa,ic.UseSelection=!0;else if(2===Jc||4===Jc||64===Jc)qc=hc.Oa.Yb.floatingObject,ic.Type=1,ic.SheetName=nc,ic.ObjectId=qc.id,ic.UseSelection=!0;else if(mb&&Jc&470)ic.ObjectId=hc.Oa.Yb.floatingObject.id,
ic.SheetName=nc;else if(bb.i(Ob.pa)){ic.Type=2;ic.SheetName=nc;if(hc.sa.rg)if(mb=hc.sa.Vc,ic.SelectedRanges=ba.q(mb,Ob),20<mb.FG)ic.UseSelection=!0;else{nc=0;qc=qc.Xj("PrintCommandHandler.DoPrintHtml",mb);try{for(qc.$$rst();qc.$$mn()&&2>nc;)qc.$$cu().text&&nc++;ic.UseSelection=2<=nc}finally{qc&&qc.dispose()}}else ic.UseSelection=!1,ic.SelectedRanges=ba.q(hc.sa.activeRange,Ob);this.ea.isNamedObjectViewMode&&(ic.UsedRange=ba.v(Ob.pa.usedRange,Ob))}ic.Title=Ob.workbookContext.WorkbookFileName;return ic};
d.prototype.nid=function(){pa.g(this.$);if(!this.k2f){this.aRc=!0;var Ob=this.$.Fb.sc("UserAction","HandlePageLayoutRendering");this.PNj();ia.ULS.sendTraceTag(537154274,0,50,"PrintCommandHandler:HandlePageLayoutRendering rendering is done in "+Ob.qc+" ms.");Ob.stop()}};d.prototype.PNj=function(){for(var Ob=pa.g(this.$).Ea,nc=Ob.KE(),mb=!1,ic=0,qc=0;qc<nc.length;qc++){var hc=nc[qc],Jc=hc.lf;Jc&&Jc.hasPageLayout()&&(mb=!0,Jc.setDirty("PrintCommandHandler::TriggerPageLayoutRendering, hash: "+hc.Ld,4),
ic++)}mb&&(ia.ULS.sendTraceTag(537154273,0,50,"PrintCommandHandler:TriggerPageLayoutRendering number of total cached blocks is "+nc.length+", number of blocks that require re-rendering is "+ic),Ob.xyd())};of.Object.defineProperties(d.prototype,{k2f:{configurable:!0,enumerable:!0,get:function(){return this.aRc}}});Object(ea.a)(d,"PrintCommandHandler",null,[401,815]);var Yc=b(1290),Mc=b(1499),xb=b(1500),wc=Z.a;$k(c,wc);c.prototype.zd=function(){var Ob=this,nc=da.AFrameworkApplication.fa.appSettings,
mb=this.$.ya.DirectPrintSetting;nc.DirectPrintIsEnabled=mb.DirectPrintIsEnabled.toString();nc.DirectPrintProbeIsEnabled=mb.DirectPrintProbeIsEnabled.toString();nc.DirectPrintEnabledForInternetExplorer=mb.DirectPrintEnabledForInternetExplorer.toString();nc.DirectPrintSupportedMimeTypes=mb.DirectPrintSupportedMimeTypes;nc.DirectPrintSupportedPlugins=mb.DirectPrintSupportedPlugins;nc.DirectPrintImmersivePreviewPlugins=mb.DirectPrintImmersivePreviewPlugins;nc.DirectPrintMinimalSupportedEdgeVersion=mb.DirectPrintMinimalSupportedEdgeVersion;
nc.DirectPrintEnabledForEdge=mb.DirectPrintEnabledForEdge.toString();nc=new Yc.a(nc);var ic=null;mb=null;try{mb=window.navigator.mimeTypes}catch(Jc){ia.ULS.sendTraceTag(537154270,0,15,"Failed to get Window.Navigator.mimeTypes")}var qc=null;try{qc=window.navigator.plugins}catch(Jc){ia.ULS.sendTraceTag(537154269,0,15,"Failed to get Window.Navigator.plugins")}ic=new xb.a(nc,mb,qc,xb.a.Xcf,xb.a.Chf,new Mc.a(da.AFrameworkApplication.ta.jX),da.AFrameworkApplication.ta.sD,xb.a.Dhf,function(Jc,rd){return new xa.a(Jc,
!1,rd)},!1);if(va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&this.$.pe.get(116)){var hc=ha.GetServiceTaskFactory.Ra(this.$.da,349,350,this.hb);ya.TaskExtensions.Aa(hc,function(){var Jc=new d(Ob.$,ic,hc.result);Ob.jd([Jc])},this.$.la)}else this.jd([new d(this.$,ic,null)])};c.ka=function(Ob){Z.a.Pd(73,new c(Ob))};Object(ea.a)(c,"PrintCommandHandlerFactory",Z.a,[]);b.d(E,"a",function(){return a})},1357:function(t,E,b){function a(){I.a.Fa(function(wc){wc.da.Ga(57,new c(wc));
wc.da.Ga(60,new J(wc));wc.da.Ga(63,new S(wc))})}function c(wc){var Ob=xb.call(this)||this;Ob.$=wc;wc.da.Ga(56,new e(wc));Ob.Eb();return Ob}function d(wc,Ob){return Mc.call(this,wc,Ob)||this}function e(wc){var Ob=fc.call(this)||this;Ob.$=wc;Ob.Eb();e.p2g();return Ob}function h(wc,Ob,nc){var mb=k.call(this,!0)||this;mb.Pa=new Ra.a;mb.LUe=!1;mb.a7c=!1;mb.Pze=null;mb.vm=null;mb.J3b=null;mb.Uc=function(){xa.a.vg(ba.a(mb.$).dd.activityState,pa.a.$yd)||mb.Aua.reset()};mb.NKi=function(ic){mb.jSf(ic)};mb.MKi=
function(){mb.bBj()};mb.$=wc;mb.ea=wc.ea;mb.RJ=Ob;mb.businessBar=nc;mb.ea.Vj(mb.Uc);mb.Aua=G.Jse(mb.$);mb.q2g();wc.da.Ga(55,mb);mb.pga=Aa.a.instance.Tb("Common.ISystemInitiatedFeedback");return mb}function k(wc){this.Xfa=this.y5d=this.cVa=null;this.Pib=!1;this.eNc=this.tce=null;this.JRb=this.zD=this.UWb="";this.application=this.OB=0;this.sIj=this.OUd=!1;this.$Vj=wc&&ta.AFrameworkApplication.fa.qa("OICLaunchDialogIsEnabled");ta.AFrameworkApplication.ub.k4(Ha.a.KQa)||ta.AFrameworkApplication.ub.Mb(Ha.a.KQa,
Ea.a.frame,Object(ja.a)(this,this.ajj,"retryOpenInClientAction"));this.g5f=!!ta.AFrameworkApplication.fa&&ta.AFrameworkApplication.fa.qa("SilentExternalHandler")}function n(){}function f(){}function v(wc){var Ob=dc.call(this)||this;Ob.Zp=wc;Ob.ye="ProtocolLaunchingDialog";ta.AFrameworkApplication.zi.j5a&&ta.AFrameworkApplication.zi.buc();ta.AFrameworkApplication.ta.Qa.Chd&&Ob.Dle(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(ja.a)(Ob,Ob.Anc,"onGiveFeedbackClick"));v.K6e?(Ob.Rb=12,
Ob.kc(1,CommonUIStrings.l_CloseFile),Ob.kc(2,CommonUIStrings.l_OICDialogContinueHere),Ob.kc(3,CommonUIStrings.l_OICDialogLaunchAgain)):(Ob.Rb=4,Ob.kc(1,CommonUIStrings.l_OICDialogContinueHere),Ob.kc(2,CommonUIStrings.l_OICDialogLaunchAgain));Ob.kDb(CommonUIStrings.l_OICDialog2ndTitle,5===Ob.Zp.eFf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(ja.a)(Ob,Ob.RFd,"protocolLaunchingDialogResultHandler"),null);return Ob}function m(wc){var Ob=yb.call(this)||
this;Ob.efa=null;Ob.WUa=null;Ob.Rpa=!1;Ob.vpa=null;Ob.Zp=wc;Ob.Xf=x.Xf;Ob.lte=!0;Ob.Rb=5;Ob.ye="ProtocolLaunchingDialog";Ob.oHc="OICRetryDialog";ta.AFrameworkApplication.zi.j5a&&ta.AFrameworkApplication.zi.buc();ta.AFrameworkApplication.zi.Cg(new eb.a(2,1,5E3,function(){Ob.switchToBackupMode()},101));Ob.showDialog("",Object(ja.a)(Ob,Ob.RFd,"protocolLaunchingDialogResultHandler"));Ob.B_f();Ob.$W("Issues");Ob.yUe();Q.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=
" OICDialog";return Ob}function x(){}function l(wc){var Ob=Ka.call(this)||this;Ob.LCa=null;Ob.XUa=null;Ob.Rpa=!1;Ob.Zp=wc;Ob.Xf=u.Xf;Ob.lte=!0;Ob.Rb=5;Ob.ye="OICLaunchDialog";Ob.showDialog("",Object(ja.a)(Ob,Ob.OGi,"oicLaunchDialogResultHandler"));Ob.B_f();Ob.$W("ProtocolLaunchingDialogTitle");4!==ta.AFrameworkApplication.ta.Qa.editMode&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);Ob.kI(Ob.LCa);Q.ULS.sendTraceTag(22140865,211,50,
"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog";return Ob}function u(){}function A(wc,Ob,nc,mb,ic){var qc=document.createElement("img");qc.alt=wc;qc.className=Sa.getImageClassWithCluster(nc,mb);qc.src=Ob;qc.setAttribute(vb.a.Gd,vb.a.Ks);wc=document.createElement("span");wc.className="ProtocolLaunchingDialogImg32Container";wc.appendChild(qc);qc=document.createElement("span");qc.className="ProtocolLaunchingDialogIconContainer";qc.appendChild(wc);ic.appendChild(qc)}
function z(wc,Ob,nc,mb,ic,qc,hc){var Jc=document.createElement("a");Jc.className="ProtocolLaunchingDialogButtonAnchor";Jc.className+=" OICDialog";Jc.id=wc;Jc.setAttribute(vb.a.Gd,vb.a.Js);Jc.style.padding="0";Jc.style.margin="0";mb&&A(ic,Ob,nc,mb,Jc);wc=document.createElement("span");wc.className="ProtocolLaunchingDialogButtonLabel";wc.innerText=ic;Jc.appendChild(wc);Jc.tabIndex=0;qc&&Db.a.instance.ra(Ab.a.click,Jc,qc);hc&&ub.KeyInputManager.instance.ra(Ab.a.Fd,Jc,hc);return Jc}function y(wc){return wc.Ca.keyCode===
Wb.a.Qh||wc.Ca.keyCode===Wb.a.Soa?(wc.yb.click(),!0):!1}function w(wc){for(var Ob=0;Ob<wc.children.length;Ob++){var nc=wc.children[Ob];nc.style.position="relative";nc.style.top=(nc.parentNode.offsetHeight-nc.offsetHeight)/2+"px"}}function D(){}function H(wc,Ob,nc){var mb=this;this.La=wc;this.jsg=Ob;this.kFc=null;(this.aYb=ta.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&Aa.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(ic){mb.kFc=
ic});this.U1=nc}function F(wc,Ob,nc){this.La=wc;this.fsg=Ob;this.U1=nc}function J(wc){var Ob=oa.call(this)||this;Ob.$=wc;Ob.Eb();return Ob}function S(wc){var Ob=Ma.call(this)||this;Ob.$=wc;Ob.Eb();return Ob}function N(wc,Ob,nc){nc=void 0===nc?!1:nc;var mb=Ua.call(this,wc,Ob)||this;mb.LCb=null;mb.sBd=function(ic){mb.unsubscribe(function(qc){ic.remove_disposing(qc)});mb.lh(va.a.Dk);mb.$o()};mb.Qkc=nc;return mb}function T(wc,Ob){var nc=this;this.Uc=function(){xa.a.vg(ba.a(nc.$).dd.activityState,pa.a.$yd)||
nc.Aua.reset()};this.$=Ob;this.Qkc=wc;this.ea=Ob.ea;this.ea.Vj(this.Uc);this.Aua=G.Jse(this.$)}function G(wc,Ob){var nc=ra.call(this,wc)||this;nc.WVj=["id","sessionId","workbookType","workbookFileType","dataloss"];nc.command=0;nc.YEb=function(){var mb=nc.WOh();if(mb){nc.$.XH(!0);if(-2028960985!==nc.command&&1461300262!==nc.command){var ic=ba.a(nc.$).dd.activityState;ic[bb.a.uYa]=va.a.download;ic[fa.a.UTc]=nc.command}ya.a(nc.$).pr(mb.Errors)}};nc.iframe=wc;nc.$=Ob;nc.zc.ka("load",nc.YEb);return nc}
var I=b(10),K=b(0),L=b(235),O=b(50),B=b(37),Q=b(15),U=b(87),X=b(85),P=b(253),ea=b(727),ia=b(219),da=b(121),xa=b(34),Z=b(39),ha=b(248),ya=b(43),va=b(6),bb=b(35),ba=b(68),fa=b(660),ra=ha.a;$k(G,ra);G.prototype.downloadFile=function(wc,Ob){var nc={};(wc=this.mzh(wc,nc))&&Z.a.rqc("dlfr",wc,nc);this.command=Ob};G.prototype.mzh=function(wc,Ob){var nc=wc.split("?");if(2!==nc.length)return wc=null,Q.ULS.sendTraceTag(537154816,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (missing '?')"),
wc;nc=nc[1].split("&");nc=ik(nc);for(var mb=nc.next();!mb.done;mb=nc.next()){var ic=mb.value.split("=",2);if(2!==ic.length){wc=null;Q.ULS.sendTraceTag(537154787,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (key value pair has no '=' sign)");break}mb=ic[0];this.WVj.includes(mb)&&(ic=decodeURIComponent(ic[1]),Ob[mb]=ic,wc=ia.a.CIb(wc,mb))}return wc};G.prototype.reset=function(){this.iframe&&(this.iframe.src="about:blank");this.command=1461300262};G.prototype.WOh=function(){try{return this.iframe.contentWindow.ewaResult}catch(Ob){if(!this.$.ea.ic.isDivSyndicated){var wc=
window.document.referrer.match(RegExp("://(.[^/]+)/"));Q.ULS.sendTraceTag(537154785,0,50,"FileLoader.OnFrameLoad: parent domain: "+(1<wc.length?wc[1]:"")+", current domain: "+escape(window.location.host)+", iframe domain: "+escape(this.iframe.contentWindow.location.host)+". ewaControl IsCrossDomain: "+this.$.Dwa);throw Ob;}return null}};G.Jse=function(wc){var Ob=document.createElement("iframe");Ob.id="ewaFileLoader";Ob.style.cssText="height:0;width:0;display:none";Ob.src="about:blank";Ob.setAttribute("name",
"dlfr");Ob=wc.domElement.appendChild(Ob);return new G(Ob,wc)};of.Object.defineProperties(G.prototype,{e9h:{configurable:!0,enumerable:!0,get:function(){return"loading"!=this.iframe.contentDocument.readyState&&"uninitialized"!=this.iframe.contentDocument.readyState}}});Object(K.a)(G,"FileLoader",ha.a,[]);var pa=b(147),Za=b(58);T.prototype.ajh=function(){var wc=this,Ob=this.sTg(this.$),nc=this.$.userOperationManager.operationCount;0<nc&&Q.ULS.sendTraceTag(537154822,0,15,"flushing queue in downloadcopy. Queue is "+
nc);this.$.userOperationManager.f4("DownloadACopyOperation.DownloadForkedFile");this.Qkc&&Q.ULS.sendTraceTag(537154821,0,50,"DownloadACopyOperation - Dataloss scenario");this.Aua.downloadFile(Ob,-21742208);B.TaskExtensions.Aa(Za.Task.delay(1),function(){wc.w9e()},this.Aua.la,3)};T.prototype.dispose=function(){this.ea&&this.ea.wk(this.Uc);this.$=this.ea=null};T.prototype.w9e=function(wc){var Ob=this;(wc=void 0===wc?null:wc)||(wc=this.$.Fb.sc("LoadResource","DownloadACopyOperation"));!this.Aua.e9h&&
wc.qc<T.Apf?window.setTimeout(function(){Ob.w9e(wc)},T.bjh):(wc.qc>=T.Apf&&Q.ULS.sendTraceTag(537154820,0,15,"Download did not complete after 10 seconds."),ba.a(this.$).dd.mM())};T.prototype.sTg=function(wc){var Ob=new Sys.StringBuilder,nc=wc.workbookContext,mb=wc.ya;Ob.append(wc.Qda);Ob.append(mb.FileHandlerRelativeUri);Ob.append("?id=");Ob.append(encodeURIComponent(ia.a.CIb(nc.WorkbookUri,"sc")));wc.ea.dc&&(Ob.append("&sessionId="),Ob.append(encodeURIComponent(wc.ea.sessionId)));Ob.append("&workbookType=FullForkedWorkbook");
Ob.append("&dataloss=");Ob.append(this.Qkc?"true":"false");da.a.qZa(Ob,mb);return Ob.toString()};T.Apf=1E5;T.bjh=100;Object(K.a)(T,"DownloadACopyOperation",null,[6]);var Ua=P.a;$k(N,Ua);N.prototype.execute=function(wc){var Ob=Object(X.a)(2,wc.ue);if(!Ob.zka)return Q.ULS.sendTraceTag(537154818,0,50,"DownloadAForkedCopyActivity.Execute: blocking Download action as the workbook is protected"),this.qmd(wc),this.lh(va.a.idle),1;this.LCb||(this.LCb=new T(this.Qkc,Ob));this.LCb.ajh();Q.ULS.shipAssertTag(537154817,
0,3!==ba.a(Ob).ii.St,"The current activity should not be closed.");return 1};N.prototype.qmd=function(wc){var Ob=Object(X.a)(2,wc.ue),nc=new ea.a(Ob);this.subscribe(wc,this.sBd,function(mb){nc.add_disposing(mb)});Q.ULS.sendTraceTag(50954707,0,50,"DownloadAForkedCopyActivity.ProtectedFileDataLeakErrorDialog: showing alert dialog to user");nc.initialize();nc.qf()};N.prototype.dispose=function(){U.a.Ia(this.LCb);this.LCb=null;Ua.prototype.dispose.call(this)};Object(K.a)(N,"DownloadAForkedCopyActivity",
P.a,[]);var Ma=L.a;$k(S,Ma);S.prototype.create=function(){var wc=this;B.TaskExtensions.Aa(O.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb),function(){wc.pb(new N(va.a.P1a,va.a.Dk,!0))},this.la)};Object(K.a)(S,"DownloadACopyPreDatalossActivityFactory",L.a,[]);var oa=L.a;$k(J,oa);J.prototype.create=function(){var wc=this;B.TaskExtensions.Aa(O.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb),function(){wc.pb(new N(va.a.unmergeableDownloadCopy,va.a.Eoa))},this.la)};Object(K.a)(J,
"DownloadAForkedCopyActivityFactory",L.a,[]);var ja=b(84),ta=b(4),aa=b(81),ma=b(27),Ea=b(107),Ha=b(25);F.prototype.Ag=function(){this.La.Mb(Ha.a.tryMacOffice,Ea.a.frame,Object(ja.a)(this,this.JUi,"onTryMacOffice"));this.La.Mb(Ha.a.ebg,Ea.a.frame,Object(ja.a)(this,this.oEf,"onTryMacOfficeFromViewer"));this.La.Mb(Ha.a.dbg,Ea.a.frame,Object(ja.a)(this,this.oEf,"onTryMacOfficeFromViewer"))};F.prototype.JUi=function(wc,Ob,nc,mb,ic){if(1===nc)return 32;ic?(wc=ic.SourceControlId,"btnjTryMacOfficeForWordEditor"===
wc?Z.a.Te(aa.a.zZ(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===wc&&Z.a.Te(aa.a.zZ(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.vkf();return 32};F.prototype.oEf=function(wc,Ob,nc){if(1===nc)return 32;switch(wc){case Ha.a.ebg:Z.a.Te(aa.a.zZ(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case Ha.a.dbg:Z.a.Te(aa.a.zZ(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32};F.prototype.vkf=function(){var wc=
void 0===wc?null:wc;var Ob=0;wc&&(Ob=wc);Z.a.Te(2===Ob?"https://go.microsoft.com/fwlink/?LinkId=331579":F.Uyi,"_blank",void 0,"LaunchMacTrialWindow")};of.Object.defineProperties(F.prototype,{sxc:{configurable:!0,enumerable:!0,get:function(){return this.fsg&&ma.a.isMac&&!ma.a.Uli&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}},Cyj:{configurable:!0,enumerable:!0,get:function(){return this.sxc}}});of.Object.defineProperties(F,{Uyi:{configurable:!0,enumerable:!0,get:function(){return aa.a.dH("522401")}}});
Object(K.a)(F,"MacOfficeOffer",null,[205]);var Aa=b(83);H.prototype.Ag=function(){this.La.Mb(Ha.a.tryOffice,Ea.a.frame,Object(ja.a)(this,this.KUi,"onTryOffice"));this.La.Mb(Ha.a.tryOfficeThroughTellMe,Ea.a.frame,Object(ja.a)(this,this.tryOfficeThroughTellMe,"tryOfficeThroughTellMe"));this.La.Mb(Ha.a.hbg,Ea.a.frame,Object(ja.a)(this,this.ibg,"tryOfficeThroughViewer"));this.La.Mb(Ha.a.gbg,Ea.a.frame,Object(ja.a)(this,this.ibg,"tryOfficeThroughViewer"))};H.prototype.KUi=function(wc,Ob,nc,mb,ic){if(this.aYb&&
1===nc)return this.isFreemiumUpsellEnabled&&this.bMb?32:8;2===nc&&(ic?(wc=ic.SourceControlId,"btnjTryOfficeForWordEditor"===wc?Z.a.Te(aa.a.zZ(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===wc?Z.a.Te(aa.a.zZ(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.Rjc()):this.Rjc());return 32};H.prototype.tryOfficeThroughTellMe=function(wc,Ob,nc,mb,ic){if(this.aYb&&1===nc)return this.isFreemiumUpsellEnabled&&this.bMb?32:8;2===nc&&(ic?(wc=ic.SourceControlId,
Z.a.Te(aa.a.dH("862405")+this.RUh(wc),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):Z.a.Te(aa.a.dH("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32};H.prototype.ibg=function(wc,Ob,nc){if(this.aYb&&1===nc)return this.isFreemiumUpsellEnabled&&this.bMb?32:8;if(2===nc)switch(wc){case Ha.a.hbg:Z.a.Te(aa.a.zZ(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case Ha.a.gbg:Z.a.Te(aa.a.zZ(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32};H.prototype.Rjc=
function(wc){wc=void 0===wc?null:wc;var Ob=0;wc&&(Ob=wc);Z.a.Te(H.BSh(Ob),"_blank",void 0,"LaunchOfficeOffer")};H.prototype.RUh=function(wc){var Ob=0;switch(wc){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":Ob=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":Ob=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":Ob=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":Ob=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":Ob=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":Ob=
6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":Ob=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":Ob=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":Ob=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":Ob=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":Ob=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":Ob=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":Ob=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":Ob=19;
break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":Ob=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":Ob=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":Ob=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":Ob=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":Ob=29}return 0===Ob?"":String.format("&pc={0:D}",Ob)};H.BSh=function(wc){if(ma.a.Ug)switch(wc){case 1:return aa.a.dH("393806");case 2:return aa.a.dH("393810");case 3:return aa.a.dH("393809");
case 5:return aa.a.dH("393805")}else if(ma.a.Uo)switch(wc){case 1:return aa.a.dH("521979");case 3:return aa.a.dH("521980");case 5:return aa.a.dH("521978");case 2:return aa.a.dH("522490")}else{if(2===wc)return aa.a.dH("517778");if(1===wc)return aa.a.zZ(30)}return aa.a.dH("522402")};of.Object.defineProperties(H.prototype,{otf:{configurable:!0,enumerable:!0,get:function(){return this.bMb}},uGi:{configurable:!0,enumerable:!0,get:function(){return this.bMb&&MSOJS.ClientUtils.OfferOfficeInDialog()}},bMb:{configurable:!0,
enumerable:!0,get:function(){return this.jsg&&!ma.a.isMac}},isFreemiumUpsellEnabled:{configurable:!0,enumerable:!0,get:function(){var wc=!1;this.kFc&&(wc=this.kFc.isFreemiumUpsellEnabled());return wc}}});Object(K.a)(H,"OfficeTrialExperience",null,[204]);D.prototype.Sh=function(wc){wc.register(H,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").tc().Dc(function(){return new H(ta.AFrameworkApplication.ub,ta.AFrameworkApplication.dAb,ta.AFrameworkApplication.lcid)});
wc.register(F,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").tc().Dc(function(){return new F(ta.AFrameworkApplication.ub,ta.AFrameworkApplication.ihc,ta.AFrameworkApplication.lcid)})};Object(K.a)(D,"OpenInClientConfiguration",null,[11]);var V=b(624),La=b(1569),Ra=b(38),pb=b(1406),cb=b(150),Sa=b(158),Db=b(236),Ab=b(13),Wb=b(86),ub=b(109),vb=b(89);of.Object.defineProperties(u,{Xf:{configurable:!0,enumerable:!0,get:function(){return cb.a.Oo(u.rk,CommonUIStrings.l_OICLaunchDialogTitle)}}});
u.rk="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(K.a)(u,"OICLaunchDialogHtml",null,[]);var Ka=cb.a;$k(l,Ka);l.prototype.R9a=function(){this.LCa=z("BtnRichClient",this.Zp.Msb,this.Zp.hyb,this.Zp.Nkd,CommonUIStrings.l_OICLaunchRichClient,Object(ja.a)(this,this.cCf,"onRichClientButtonClick"),y);document.getElementById("OICLaunchRichClient").appendChild(this.LCa);w(this.LCa);this.XUa=z("BtnReturn",this.Zp.Msb,this.Zp.hyb,this.Zp.K9e,CommonUIStrings.l_OICReturnToOnlineClient,Object(ja.a)(this,this.$Bf,"onReturnButtonClick"),y);document.getElementById("OICReturnToApp").appendChild(this.XUa);
w(this.XUa)};l.prototype.$Bf=function(){this.hide();this.Zp.bcb();return!0};l.prototype.cCf=function(){Q.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();ta.AFrameworkApplication.ub.processAction(Ha.a.KQa,2);return!0};l.prototype.OGi=function(){this.Zp.bcb()};l.prototype.dispose=function(){this.Rpa||(this.LCa&&(Db.a.instance.Ba(Ab.a.click,this.LCa,Object(ja.a)(this,this.cCf,"onRichClientButtonClick")),ub.KeyInputManager.instance.Ba(Ab.a.Fd,this.LCa,y)),this.XUa&&(Db.a.instance.Ba(Ab.a.click,
this.XUa,Object(ja.a)(this,this.$Bf,"onReturnButtonClick")),ub.KeyInputManager.instance.Ba(Ab.a.Fd,this.XUa,y)),Ka.prototype.dispose.call(this),this.Rpa=!0)};Object(K.a)(l,"OICLaunchDialog",cb.a,[]);of.Object.defineProperties(x,{Xf:{configurable:!0,enumerable:!0,get:function(){return cb.a.Oo(x.rk,CommonUIStrings.l_OICDialogTitle)}}});x.rk="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(K.a)(x,"ProtocolLaunchingDialogV2Html",null,[]);b(447);var eb=b(108),yb=cb.a;$k(m,yb);m.prototype.R9a=function(){var wc=document.getElementById("Issues");if(wc){A("",this.Zp.Msb,this.Zp.hyb,this.Zp.Nkd,wc);var Ob=document.createElement("span");Ob.className="WACDialogSectionTitle";Ob.innerText=5===this.Zp.eFf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;wc.appendChild(Ob);w(wc);wc.style.display="none"}ta.AFrameworkApplication.ta.Qa.Chd?(this.WUa=z("GiveFeedback",
this.Zp.Msb,this.Zp.hyb,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(ja.a)(this,this.Anc,"onGiveFeedbackClick"),Object(ja.a)(this,this.iyf,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.WUa),w(this.WUa)):document.getElementById("ButtonGiveFeedback").style.display="none";0===ta.AFrameworkApplication.ta.Qa.editMode||ta.AFrameworkApplication.Lgh?document.getElementById("ButtonEdit").style.display="none":(this.efa=z("Edit",this.Zp.Msb,
this.Zp.hyb,"",2===ta.AFrameworkApplication.ta.Qa.rj?4===ta.AFrameworkApplication.ta.Qa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===ta.AFrameworkApplication.ta.Qa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(ja.a)(this,this.Rwf,"onEditClick"),Object(ja.a)(this,this.Vwf,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.efa),w(this.efa));0===ta.AFrameworkApplication.ta.Qa.editMode&&
!ta.AFrameworkApplication.dAb&&wc&&(wc.style.display="none")};m.prototype.AUe=function(){return this.vpa?(this.kI(this.vpa),!0):!1};m.prototype.yUe=function(){return this.efa?(this.kI(this.efa),!0):!1};m.prototype.Vwf=function(wc){return this.xzd(wc,0)};m.prototype.iyf=function(wc){return this.xzd(wc,2)};m.prototype.YBf=function(wc){return this.xzd(wc,1)};m.prototype.xzd=function(wc,Ob){var nc=!1;if(wc.Ca.keyCode===Wb.a.Qh||wc.Ca.keyCode===Wb.a.Soa)wc.yb.click(),nc=!0;else if(wc.Ca.keyCode===Sys.UI.Key.down||
wc.Ca.keyCode===Sys.UI.Key.up)switch(Ob){case 1:nc=this.yUe();break;case 0:nc=this.AUe()}return nc};m.prototype.Rwf=function(){this.hide();4===ta.AFrameworkApplication.ta.Qa.editMode?(Q.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.Zp.bcb()):(Q.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.Zp.Zhd());return!0};m.prototype.Anc=function(){Q.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");this.Zp.I5e();return!0};m.prototype.zoc=function(){Q.ULS.sendTraceTag(19239263,
211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";ta.AFrameworkApplication.ub.processAction(Ha.a.KQa,2);return!0};m.prototype.RFd=function(){this.Zp.bcb()};m.prototype.switchToBackupMode=function(){var wc=document.getElementById("ProtocolLaunchingDialogTitle");if(wc){wc.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(wc=document.getElementById("Issues"))wc.style.display="block";(wc=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!wc.children.length&&
(this.vpa=z("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(ja.a)(this,this.zoc,"onRetryOICClick"),Object(ja.a)(this,this.YBf,"onRetryOICKeyUp")),wc.appendChild(this.vpa),w(this.vpa),this.efa||this.AUe())}};m.prototype.dispose=function(){this.Rpa||(this.efa&&(Db.a.instance.Ba(Ab.a.click,this.efa,Object(ja.a)(this,this.Rwf,"onEditClick")),ub.KeyInputManager.instance.Ba(Ab.a.Fd,this.efa,Object(ja.a)(this,this.Vwf,"onEditKeyUp"))),this.WUa&&(Db.a.instance.Ba(Ab.a.click,this.WUa,Object(ja.a)(this,
this.Anc,"onGiveFeedbackClick")),ub.KeyInputManager.instance.Ba(Ab.a.Fd,this.WUa,Object(ja.a)(this,this.iyf,"onGiveFeedbackKeyUp"))),this.vpa&&(Db.a.instance.Ba(Ab.a.click,this.vpa,Object(ja.a)(this,this.zoc,"onRetryOICClick")),ub.KeyInputManager.instance.Ba(Ab.a.Fd,this.vpa,Object(ja.a)(this,this.YBf,"onRetryOICKeyUp"))),yb.prototype.dispose.call(this),this.Rpa=!0)};Object(K.a)(m,"ProtocolLaunchingDialog",cb.a,[]);var oc=b(135),Jb=b(464),dc=oc.StandardDialog;$k(v,dc);v.prototype.Anc=function(wc){Q.ULS.sendTraceTag(595342858,
211,50,"Open give feedback dialog");this.kxf(wc)};v.prototype.zoc=function(){Q.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");ta.AFrameworkApplication.ub.processAction(Ha.a.KQa,2)};v.prototype.RFd=function(wc){v.K6e?3===wc?this.mUf():2===wc||0===wc?this.continueEditing():1===wc&&this.A_g():2===wc?this.mUf():(1===wc||0===wc)&&this.continueEditing()};v.prototype.A_g=function(){Q.ULS.sendTraceTag(577783557,211,50,"Closing the document");ta.AFrameworkApplication.ub.$d(Ha.a.close,2,Jb.a)};v.prototype.mUf=
function(){Q.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(ja.a)(this,this.zoc,"onRetryOICClick"),0)};v.prototype.continueEditing=function(){4===ta.AFrameworkApplication.ta.Qa.editMode||ta.AFrameworkApplication.fa.qa("WordConsumptionViewToEditRedirectIsEnabled")&&1===ta.AFrameworkApplication.ta.mode?(Q.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.Zp.bcb()):(Q.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.Zp.Zhd())};
of.Object.defineProperties(v,{K6e:{configurable:!0,enumerable:!0,get:function(){return ta.AFrameworkApplication.fa.qa("OICDialogThreeActions")&&32===ta.AFrameworkApplication.ub.processAction(Ha.a.close,1)}}});Object(K.a)(v,"StandardProtocolLaunchingDialog",oc.StandardDialog,[]);var $a=b(1452);Object(K.a)(f,"EditDocumentInClientParams",null,[]);n.C7c=function(wc,Ob,nc,mb,ic,qc,hc,Jc,rd,md,Cc,fd,Cd,Sc,Md,bc){hc=void 0===hc?!1:hc;Jc=void 0===Jc?!1:Jc;rd=void 0===rd?"":rd;md=void 0===md?!1:md;Cc=void 0===
Cc?!1:Cc;fd=void 0===fd?!1:fd;Cd=void 0===Cd?"":Cd;Sc=void 0===Sc?"":Sc;Md=void 0===Md?"":Md;bc=void 0===bc?!1:bc;var xe=new f;xe.DocumentUrl=wc;xe.Mode=Ob;xe.Options=nc;xe.Application=mb;xe.SilentExternalHandler=hc;xe.EncodeUrl=Jc;xe.CorrelationIdForWinClient=rd;xe.NavigateUsingWindowOpen=md;xe.DescriptiveUnattemptedEnums=Cc;xe.NoBrowserModalDialogs=fd;xe.SessionOrigin=Cd;xe.CorrelationId=Sc;xe.ClickTime=Md;xe.NewTelemetryDataIsEnabled=bc;MSOJS.ClientUtils.EditDocumentInClient(xe,ic,qc)};Object(K.a)(n,
"ClientUtils",null,[]);var Ba=b(99),la=b(188),ka=b(528),ca=b(178),Ia=b(1040),jb=b(396),nb=b(170),Na=b(80),sa=b(193);k.prototype.Iwc=function(wc,Ob,nc){Ob=void 0===Ob?"":Ob;this.zD=(void 0===nc?"":nc)||ca.a.create().toString();this.UWb=Ob||ka.a.t0e();this.JRb=wc};k.prototype.ajj=function(wc,Ob,nc){return Ob.contextId!==Ea.a.frame?2:1===nc?32:this.KQa()};k.prototype.pIj=function(){return!(2===this.application&&ta.AFrameworkApplication.fa.qa("IsEmbeddedScenario"))};k.prototype.closeApplication=function(){this.OUd||
this.gyh()};k.prototype.bcb=function(){this.sIj||this.wyh()};k.prototype.YMf=function(wc){this.$Vj&&ma.a.Ug?new l(this):this.I3b(wc)};k.prototype.I3b=function(wc){wc=this.hsi(wc);var Ob=wc.returnValue;Q.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===Ob,wc.BBa);return Ob};k.prototype.DGa=function(wc,Ob,nc,mb,ic,qc){this.cVa=wc;this.y5d=Ob;this.Xfa=qc;this.application=nc;this.OB=mb;ta.AFrameworkApplication.downloadCopyOnOpenInClient?this.skf():ta.AFrameworkApplication.limitedEdit&&
!ta.AFrameworkApplication.hostAuthenticatesUsersDuringOpenInClient?ta.AFrameworkApplication.D4f():this.$Og(ic)};k.prototype.KQa=function(){this.NGi&&this.evi();return this.I3b(this.Pib)};k.prototype.cYf=function(){var wc=new Ia.a(nb.a.openInClient);wc.Values["ui-language"]=ta.AFrameworkApplication.lcid.toString();wc.Values[$a.a.Q4c]=ta.AFrameworkApplication.userSessionId;return this.Xfa.value.send(wc)?32:8};k.prototype.evi=function(){Ba.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",
["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new sa.a,{inStaging:!0}))};k.prototype.Foj=function(wc){var Ob=new Ia.a(nb.a.jYj);Ob.Values["ui-language"]=ta.AFrameworkApplication.lcid.toString();Ob.Values[$a.a.Q4c]=ta.AFrameworkApplication.userSessionId;Ob.Values[jb.a.iYj]=wc;this.Xfa.value.send(Ob)};k.prototype.hsi=function(wc){this.Pib=wc;this.Foj(5===this.OB?k.eWi:k.gWi);return 5===this.OB?this.gsi():this.lsi()};k.prototype.gsi=function(){this.ykf();return{returnValue:32,BBa:"HostEditUrl,"}};
k.prototype.lsi=function(){var wc,Ob=wc="";ta.AFrameworkApplication.tme&&(Ob="|f|"+ta.AFrameworkApplication.userSessionId);var nc=ta.AFrameworkApplication.fa.qa("IsAssignmentMode")&&ta.AFrameworkApplication.fa.qa("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||ta.AFrameworkApplication.isUnifiedHostMode||ma.a.mxa,mb=ta.AFrameworkApplication.fa.qa("UnattemptedEnumIsEnabled"),ic=ta.AFrameworkApplication.fa.qa("NoBrowserModalDialogs");if(ta.AFrameworkApplication.ub.gmc){var qc=ta.AFrameworkApplication.ub.IZ(3588168074);
qc&&this.Iwc(qc.epochClickTime,qc.sessionOrigin,qc.correlationId);this.Amf()}if(ta.AFrameworkApplication.gIf){wc+="NewOrder,";qc=8;this.Xfa&&this.Xfa.value&&this.Xfa.value.isEnabled()&&ta.AFrameworkApplication.wZd&&(wc+="Post,",qc=this.cYf());if(32===qc)return{returnValue:qc,BBa:wc};Q.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return ta.AFrameworkApplication.cm.u$a?(Q.ULS.shipAssertTag(5566816,211,!!ta.AFrameworkApplication.cm.u$a),wc+="HostUrl,",
{returnValue:ta.AFrameworkApplication.ta.f9a(ta.AFrameworkApplication.cm.u$a),BBa:wc}):this.cVa?(Q.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",ta.AFrameworkApplication.userSessionId),wc+="DocUrl,",n.C7c(this.cVa,this.OB,this.options,this.application,Object(ja.a)(this,this.Uwf,"onEditInClientSuccess"),Object(ja.a)(this,this.Twf,"onEditInClientFailure"),this.g5f,ta.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled"),Ob,nc,mb,ic,this.UWb,this.zD,this.JRb,ta.AFrameworkApplication.ub.gmc),
{returnValue:32,BBa:wc}):{returnValue:8,BBa:wc}}wc+="OldOrder,";if(!this.cVa&&ta.AFrameworkApplication.cm.u$a)return this.Xfa&&this.Xfa.value&&this.Xfa.value.isEnabled()&&ta.AFrameworkApplication.wZd?(wc+="Post,",Ob=this.cYf()):(Q.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),Ob=8),32!==Ob?(Q.ULS.shipAssertTag(22595484,211,!!ta.AFrameworkApplication.cm.u$a),wc+="HostUrl,",{returnValue:ta.AFrameworkApplication.ta.f9a(ta.AFrameworkApplication.cm.u$a),
BBa:wc}):{returnValue:Ob,BBa:wc};Q.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",ta.AFrameworkApplication.userSessionId);wc+="DocUrl,";n.C7c(this.cVa,this.OB,this.options,this.application,Object(ja.a)(this,this.Uwf,"onEditInClientSuccess"),Object(ja.a)(this,this.Twf,"onEditInClientFailure"),this.g5f,ta.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled"),Ob,nc,mb,ic,this.UWb,this.zD,this.JRb,ta.AFrameworkApplication.ub.gmc);return{returnValue:32,BBa:wc}};k.prototype.jSf=
function(wc){ta.AFrameworkApplication.Gm.setDw(8981,wc)};k.prototype.Uwf=function(wc){this.jSf(wc);Q.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===wc&&MSOJS.ClientUtils.ShouldShowDialog()?(this.n8f||this.ykf(),this.Amf()):this.OUd||this.closeApplication()};k.prototype.Twf=function(wc,Ob){Ob=void 0===Ob?0:Ob;Q.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",wc,Ob);if(5===wc)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);
else{var nc=!!this.y5d&&!this.Pib,mb=0;1===wc&&(mb=2);6<=wc&&13>=wc&&(mb=1,1===Ob&&(this.OUd=!0));this.dAc.uGi?(Q.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",mb),pb.a.instance.B9g(this.Pib?Object(ja.a)(this,this.Jtf,"oicErrorDialogHandlerCloseForced"):Object(ja.a)(this,this.Ktf,"oicErrorDialogHandlerNoCloseForced"),nc?Object(ja.a)(this,this.qzf,"onLaunchDownload"):null,this.ZHe(!1)?Object(ja.a)(this,this.K8h,"iHaveOfficeButtonHandler"):null,mb,Ob)):(Q.ULS.sendTraceTag(18715409,
211,50,"Open OICErrorDialog. Dialog cause: {0}",mb),pb.a.instance.z9g(this.Pib?Object(ja.a)(this,this.Jtf,"oicErrorDialogHandlerCloseForced"):Object(ja.a)(this,this.Ktf,"oicErrorDialogHandlerNoCloseForced"),nc?Object(ja.a)(this,this.qzf,"onLaunchDownload"):null,mb))}};k.prototype.Amf=function(){try{var wc=[Object.assign(new Na.a,{name:"CorrelationId",string:this.zD}),Object.assign(new Na.a,{name:"SessionOrigin",string:this.UWb}),Object.assign(new Na.a,{name:"ClickTime",string:this.JRb}),Object.assign(new Na.a,
{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];la.a("OpenInClientCompleted",!0,0,wc)}catch(Ob){Q.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+Ob.toString())}};k.prototype.ykf=function(){ta.AFrameworkApplication.ta&&ta.AFrameworkApplication.ta.Qa.Yu&&ta.AFrameworkApplication.fa.qa("StandardProtocolDialogIsEnabled")?new v(this):new m(this)};k.prototype.Jtf=function(){this.closeApplication()};k.prototype.Ktf=function(){this.bcb()};k.prototype.qzf=function(){this.skf()};
k.prototype.K8h=function(){return this.ZHe(!0)};k.prototype.ZHe=function(wc){var Ob=(ma.a.xef||ma.a.xH)&&!!ta.AFrameworkApplication.U6b;Ob&&wc&&(Z.a.Te(ta.AFrameworkApplication.U6b,"_blank",void 0,"OpenInClient"),this.closeApplication());return Ob};of.Object.defineProperties(k.prototype,{eFf:{configurable:!0,enumerable:!0,get:function(){return this.OB}},options:{configurable:!0,enumerable:!0,get:function(){var wc=0;ta.AFrameworkApplication.Zgj&&(wc|=1);ta.AFrameworkApplication.openInClientEditOnly&&
(wc|=4);this.pIj()&&(wc|=64);return wc}},Msb:{configurable:!0,enumerable:!0,get:function(){return ta.AFrameworkApplication.GC}},hyb:{configurable:!0,enumerable:!0,get:function(){return ta.AFrameworkApplication.cyb}},K9e:{configurable:!0,enumerable:!0,get:function(){return""}},Nkd:{configurable:!0,enumerable:!0,get:function(){return""}},n8f:{configurable:!0,enumerable:!0,get:function(){return ta.AFrameworkApplication.fa.qa("OneNoteMobileViewerIsEnabled")}},dAc:{configurable:!0,enumerable:!0,get:function(){return this.tce||
(this.tce=Aa.a.instance.resolve("Common.IOfficeTrialExperience"))}},NGi:{configurable:!0,enumerable:!0,get:function(){return!!ta.AFrameworkApplication.fa&&ta.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}}});k.gWi="OpenInDesktop";k.eWi="OpenInBrowser";Object(K.a)(k,"AOpenInClientOperation",null,[]);var Wa=b(5),Hb=b(214),Yb=b(76),Sb=b(59),lb=b(340),wb=b(47),wa=b(45),Oa=b(201),Ub=b(91),hb=b(31),Xb=b(1),Gc=b(11),uc=b(21),Nc=b(532),Fb=b(261),
ob=b(264),zb=b(156),ib=b(659);$k(h,k);h.prototype.I1g=function(){this.YMf(this.LUe)};h.prototype.K3g=function(){var wc=this,Ob=this.$;B.TaskExtensions.Aa(this.RJ.value,function(nc){wc.DGa(Ob.workbookContext.ClientUrl,ta.AFrameworkApplication.eZ,1,Ob.isEditMode?2:0,!0,new V.a(function(){return nc.result}))},this.la,3)};h.prototype.Zhd=function(){0!==Sb.a.pg.editMode&&(this.$.ob.pz=!1)};h.prototype.I5e=function(){var wc={};wc[Wa.a.K9b]=!1;wc[Wa.a.WU]="OpenInExcel";this.$.Cd(802602464,Yb.a.Cb,8,wc)};
h.prototype.B2c=function(){var wc=this;if(this.ea.dc){var Ob=this.$;Ob.isEditMode&&B.TaskExtensions.Aa(this.RJ.value,function(nc){wc.DGa(Ob.workbookContext.ClientUrl,ta.AFrameworkApplication.eZ,1,2,!1,new V.a(function(){return nc.result}))},this.la,3)}};h.prototype.UBe=function(){var wc=this;this.ea.dc&&B.TaskExtensions.Aa(this.RJ.value,function(Ob){wc.DGa(wc.$.workbookContext.ClientUrl,ta.AFrameworkApplication.eZ,1,wc.$.isEditMode?2:0,!1,new V.a(function(){return Ob.result}))},this.la,3)};h.prototype.Iwc=
function(wc){k.prototype.Iwc.call(this,wc)};h.prototype.openInExcelClient=function(){var wc=this;this.ea.dc&&(this.$.isEditMode||B.TaskExtensions.Aa(this.RJ.value,function(Ob){wc.DGa(wc.$.workbookContext.ClientUrl,ta.AFrameworkApplication.eZ,1,0,!1,new V.a(function(){return Ob.result}))},this.la,3))};h.prototype.openInBrowser=function(){var wc=this;this.ea.dc&&B.TaskExtensions.Aa(this.RJ.value,function(Ob){wc.DGa(wc.$.workbookContext.ClientUrl,ta.AFrameworkApplication.eZ,1,5,!1,new V.a(function(){return Ob.result}))},
this.la,3)};h.prototype.downloadFile=function(wc){var Ob=this.Zue(wc);this.Aua.downloadFile(Ob,wc);this.Gvi()};h.prototype.Gvi=function(){ta.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1)&&null!=this.pga&&this.pga.execute(function(wc){return wc.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled")})};h.prototype.aFf=function(wc,Ob){Ob=void 0===Ob?0:Ob;if(this.ea.dc){var nc=this.$;
ba.a(nc).XLa?this.bFf(wc,nc):0<Ob?this.iGj(wc,nc,Ob):this.t3f(nc)}};h.prototype.DGa=function(wc,Ob,nc,mb,ic,qc){this.$.ob.pz=!Xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5209012_KeepMenuEnableAfterOIC")||!this.$.ic.inWebPart;this.LUe=ic;this.J3b=null;this.a7c=!1;this.ePg(wc,Ob,mb,ic,qc)};h.prototype.I3b=function(wc){var Ob=this.$.ic;Q.ULS.sendTraceTag(537154775,0,50,"OpenInExcelOperation.CompleteClientLaunch: IsEmbedded:"+Ob.inEmbedView+", InWebPart:"+Ob.inWebPart+", DivSyndicated:"+Ob.isDivSyndicated+
", Mode:"+(this.$.isEditMode?Hb.a.edit:Hb.a.view));return h.lff()?(this.h3b(),n.C7c(this.cVa,this.OB,this.options,1,this.NKi,this.MKi,!1,ta.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled")),32):k.prototype.I3b.call(this,wc)};h.prototype.gyh=function(){this.oTf();var wc=this.$;if(!this.ea.ic.inWebPart&&this.ea.dc&&!wc.isEditMode){var Ob=new Ub.a(2145659238,Yb.a.Cb,this.$.Jc,0,null);this.Pze=wb.a.instance.create(function(){wc.Ka.Kb(Ob)},0,wa.a.hWi)}};h.prototype.dispose=function(){this.ea&&this.ea.wk(this.Uc);
U.a.oc([this.Pa,this.Pze,this.vm]);this.$=this.ea=null};h.prototype.wyh=function(){this.oTf()};h.prototype.skf=function(){var wc=this;wb.a.instance.create(function(){wc.$.Ka.Kb(new Ub.a(-2028960985,Yb.a.Cb,0,30,null))},0,wa.a.iWi,!0,!0)};h.prototype.$Og=function(wc){var Ob=this.$,nc=ba.a(this.$).dd.activityState;nc[Nc.a.Hke]=!0;Ob.isEditMode&&this.ea.dc?(this.h3b(),ya.a(Ob).cs(new Fb.a(va.a.Jx,5,function(){Ob.XH(!1);nc[ob.a.fq]=va.a.j3b;nc[Nc.a.cBg]=wc;nc[pa.a.Qad]=!0;Ob.isEditMode&&(nc[pa.a.xT]=
1,nc[pa.a.kY]=!0,nc[zb.a.dZb]=!0,nc[zb.a.$Tc]=!0);nc[Nc.a.Kke]=1455037301}))):this.YMf(wc)};h.prototype.g6f=function(){var wc=ta.AFrameworkApplication.eZ;if(this.$.downloadCopyOnOpenInClient){if(8===this.$.frame.f9a(wc,!0)){var Ob=this.$.ea.ic;Q.ULS.sendTraceTag(537154773,0,50,"Url:["+wc+"] IsEmbedded:["+Ob.inEmbedView+"] InWebPart:["+Ob.inWebPart+"] DivSyndicated:["+Ob.isDivSyndicated+"], Mode:["+(this.$.isEditMode?Hb.a.edit:Hb.a.view)+"]")}}else this.Aua.downloadFile(wc,-2028960985);this.a7c=!0;
this.h3b()};h.prototype.Esi=function(){this.dAc.otf&&this.dAc.Rjc(1)};h.prototype.Fsi=function(){this.dAc.otf&&Gc.HelperMethods.Te(aa.a.zZ(33),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryOffice")};h.prototype.Psi=function(){Gc.HelperMethods.Te(aa.a.zZ(31),"_blank",void 0,"OpenExcelOperation.XLSBackstageUnknownTryMacOffice")};h.prototype.Qsi=function(){Gc.HelperMethods.Te(aa.a.zZ(34),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryMacOffice")};h.prototype.Zue=function(wc){var Ob=
new Sys.StringBuilder,nc=this.$.workbookContext,mb=this.$.ya;Ob.append(this.$.Qda);Ob.append(mb.FileHandlerRelativeUri);Ob.append("?id=");Ob.append(encodeURIComponent(ia.a.CIb(nc.WorkbookUri,"sc")));this.$.ea.dc&&(Ob.append("&sessionId="),Ob.append(encodeURIComponent(this.$.ea.sessionId)));switch(wc){case -974518828:Ob.append("&workbookType=PublishedItemsSnapshot");break;case -1804063550:Ob.append("&workbookType=FullWorkbook");break;case -1059172980:Ob.append("&workbookType=FullWorkbook&workbookFileType=Odf");
break;default:Ob.clear()}da.a.qZa(Ob,mb);return Ob.toString()};h.prototype.q2g=function(){La.a.instance.yYg();var wc=this.$.ya;MSOJS.ClientUtils.InitUrls(wc.RoamingAppsX86RootUrl,wc.RoamingAppsControlInstallerUrl,wc.RoamingAppsFirefoxExtensionUrl)};h.prototype.oTf=function(){var wc=this.$;this.ea.dc||lb.a.VFd(wc,ba.a(wc).dd);this.h3b();this.J3b&&this.J3b(this,this.a7c);wc.frame.ot.am(this.$.frame.Uaa());wc.frame.jX.am(this.$.frame.Uaa());wc.ob.pz=!1;uc.g(wc).focus()};h.prototype.ePg=function(wc,Ob,
nc,mb,ic){var qc=this.$;ta.AFrameworkApplication.ta&&!h.lff()&&(qc.frame.ot.Xm(qc.frame.Uaa()),qc.frame.jX.Xm(qc.frame.Uaa()));k.prototype.DGa.call(this,wc,Ob,1,nc,mb,ic)};h.prototype.h3b=function(){var wc=this.$;ba.a(wc).ii.activityName===va.a.openInExcelClient&&ba.a(wc).dd.mM()};h.prototype.bBj=function(){var wc=hb.a.Xc(1,0,684,685,0,1341525452,"OpenInExcelActiveXError");ya.a(this.$).pr([wc])};h.prototype.iGj=function(wc,Ob,nc){var mb=this,ic=null,qc=window.setTimeout(function(){ba.a(Ob).Osc(ic);
mb.t3f(Ob)},nc);ic=function(){ba.a(Ob).XLa&&(ba.a(Ob).Osc(ic),window.clearTimeout(qc),mb.bFf(wc,Ob))};ba.a(Ob).aVc(ic)};h.prototype.t3f=function(wc){var Ob=hb.a.Xc(1,1,0,699,0,-1753121099,"ProcessingUserChangesFileDownloadIgnored");ya.a(wc).pr([Ob])};h.prototype.bFf=function(wc,Ob){var nc=this;ya.a(Ob).cs(new Fb.a(va.a.Jx,5,function(){Ob.XH(!1);var mb=ba.a(Ob).dd,ic=mb.activityState;ic[ob.a.fq]=va.a.vJe;ic[ib.a.fZb]=Ob.ea.ic.hasUnsupportedFeaturesForEdit;ic[fa.a.UTc]=wc;mb.Bt(hb.a.zaa(nc.businessBar.O7c,
[1437034227]))}))};h.lff=function(){return 1<Sb.a.getRegisteredEwaInstances().length};of.Object.defineProperties(h.prototype,{K9e:{configurable:!0,enumerable:!0,get:function(){return"EditInExcelWebApp_32x32x32"}},la:{configurable:!0,enumerable:!0,get:function(){this.vm=this.vm||new Oa.a;return this.vm.token}},Nkd:{configurable:!0,enumerable:!0,get:function(){return"excel32"}},n8f:{configurable:!0,enumerable:!0,get:function(){return this.ea.ic.inWebPart}}});Object(K.a)(h,"OpenInExcelOperation",k,[642,
6]);var fc=L.a;$k(e,fc);e.prototype.create=function(){var wc=this;if(this.$.da.za(55))this.pb(this.$.da.za(55));else{var Ob=O.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb),nc=O.GetServiceTaskFactory.Ra(this.$.da,5,4,this.hb);B.TaskExtensions.Aa(Za.Task.uL(Ob,nc),function(){wc.pb(new h(wc.$,new V.a(function(){return O.GetServiceTaskFactory.create(wc.$.da,137,wc.la,wc.hb)}),nc.result))},this.la,3)}};e.p2g=function(){e.Mtf||(e.Mtf=!0,(new D).Sh(Aa.a.instance),Aa.a.instance.resolve("Common.IOfficeTrialExperience").Ag(),
Aa.a.instance.resolve("Common.IMacOfficeOffer").Ag())};e.Mtf=!1;Object(K.a)(e,"OpenInClientFactory",L.a,[]);var Ic=b(115),Yc=b(418),Mc=Ic.a;$k(d,Mc);d.prototype.execute=function(wc){var Ob=Object(X.a)(2,wc.ue);B.TaskExtensions.Aa(O.GetServiceTaskFactory.create(Ob.da,56,Ob.la,0),function(nc){Ob.downloadCopyOnOpenInClient?(wc.activityState[Yc.a.Ike]=!0,nc.result.g6f()):nc.result.K3g()},Ob.la,3);return 1};Object(K.a)(d,"OpenInExcelClientActivity",Ic.a,[]);var xb=L.a;$k(c,xb);c.prototype.create=function(){var wc=
this;B.TaskExtensions.Aa(O.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb),function(){wc.pb(new d(va.a.openInExcelClient,va.a.idle))},this.la)};Object(K.a)(c,"OpenInExcelClientActivityFactory",L.a,[]);b.d(E,"a",function(){return a})},1362:function(t,E,b){function a(Jb,dc){var $a=oc.call(this,dc)||this;$a.XDh=I.DOMElementExtensions.dr+",div";$a.sU=Array(69);$a.om=!1;$a.XV=function(Ba){if(Ba.Ca.keyCode===F.a.Sz){var la=$a.hc.querySelectorAll($a.XDh),ka=I.DOMElementExtensions.Cl(la);la=I.DOMElementExtensions.fz(la);
return I.DOMElementExtensions.zna(Ba.Ca,ka,la)}return!1};$a.ib=Jb;$a.set_visible(!1);$a.addCssClass(L.a.Pnh);eb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)&&$a.addCssClass(L.a.Znh);J.KeyInputManager.instance.ra(S.a.Lb,$a.hc,$a.XV);B.a(Jb).Nh($a);return $a}function c(Jb,dc,$a,Ba,la,ka){var ca=D.call(this,Jb,dc,$a)||this;Ka.a.instance.create(function(){if(ca.businessBar&&ca.businessBar.mMa(dc.KGa)){var Ia=new P.a(-847286761,0,ca.businessBar.$.Jc,0,null),jb={};jb=
(jb.CalloutName=Ba,jb.Target=eb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?ca.domElement.getElementsByClassName("ms-Button")[0]:ca.BS.domElement,jb);ca.businessBar.$.Ka.Kb(Ia,jb)}},la,ka,!0,!0);return ca}function d(Jb,dc,$a,Ba){Jb=vb.call(this,Jb,dc)||this;Jb.automateCommandManager=$a.da.za(352);H.ULS.shipAssertTag(526787654,0,!!Jb.automateCommandManager);Jb.id=Db.a.create();Jb.$=$a;Jb.title=xa.a.instance.ga(2259);Jb.message="";Jb.hUd=xa.a.instance.ga(2255);Jb.XXj=
xa.a.instance.ga(2256);Jb.ugg=xa.a.instance.ga(2257);Jb.X2g=xa.a.instance.ga(2258);Jb.update(Ba);return Jb}function e(Jb,dc){Jb=Aa.call(this,Jb,dc)||this;Jb.kCa=Ha.a.o5b();Jb.Ru=!0;Jb.KZ=Jb.kCa.fWj;Jb.title=Jb.kCa.title;Jb.message=Jb.kCa.message;return Jb}function h(Jb,dc){Jb=ma.call(this,Jb,dc)||this;Jb.Ru=!0;Jb.title="";return Jb}function k(Jb,dc){dc=Ua.call(this,Jb,dc)||this;dc.policyManager=Jb.$.da.za(274);if(!dc.policyManager)return H.ULS.sendTraceTag(537170202,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered."),
dc;dc.message=dc.policyManager.iqc;dc.title=dc.policyManager.title;dc.Sva=!0;return dc}function n(Jb,dc){Jb=pa.call(this,Jb,dc)||this;Jb.Ru=!0;Jb.KZ=!0;return Jb}function f(Jb,dc,$a,Ba){Jb=ra.call(this,Jb,dc)||this;Jb.Fxb=$a;Jb.command=Ba;Jb.Sva=!0;Jb.Ru=1461300262!==Ba;return Jb}function v(Jb,dc,$a){Jb=ba.call(this,Jb,dc)||this;Jb.Fxb=$a;Jb.Sva=!0;return Jb}function m(Jb,dc,$a){Jb=bb.call(this,Jb,dc)||this;Jb.Fxb=$a;Jb.Ru=!0;return Jb}function x(Jb,dc){Jb=ya.call(this,Jb,dc)||this;Jb.Ru=!0;Jb.KZ=
!1;return Jb}function l(Jb,dc){Jb=ha.call(this,Jb,dc)||this;Jb.Ru=!0;Jb.KZ=!0;return Jb}function u(Jb,dc,$a,Ba,la,ka,ca,Ia){return A.call(this,Jb,0,dc,$a,Ba,la,ka,ca,Ia)||this}function A(Jb,dc,$a,Ba,la,ka,ca,Ia,jb){this.QI=this.s8=this.BS=0;this.Dmg=Jb;this.BLj=dc;this.eP=$a;this.brg=ca;this.bjb=G.a.Nv(jb);this.Vog=jb;this.Img=Ia;0!==Ba&&(this.BS=Ba);0!==la&&(this.s8=la);0!==ka&&(this.QI=ka)}function z(Jb,dc,$a,Ba,la){Jb=y.call(this,Jb,dc,$a,Ba)||this;Jb.command=la;Jb.KZ=!0;return Jb}function y(Jb,
dc,$a,Ba){Jb=da.call(this,Jb,dc)||this;Jb.error=$a;Jb.options=Ba;Jb.error&&Jb.options&2&&(Jb.message=Jb.error.Description);Jb.error&&Jb.options&1&&(Jb.title=Jb.error.Caption);Jb.Ru=!(Ba&4);return Jb}function w(Jb,dc,$a){return D.call(this,Jb,dc,$a)||this}function D(Jb,dc,$a){Jb=ea.call(this,Jb,dc)||this;Jb.Ru=!0;Jb.command=$a;return Jb}b.r(E);t=b(0);var H=b(15),F=b(86),J=b(109),S=b(13),N=b(87),T=b(52),G=b(29),I=b(12),K=b(248),L=b(1271),O=b(5),B=b(274),Q=b(1272),U=b(929),X=b(1471),P=b(91),ea=U.a;$k(D,
ea);D.prototype.mo=function(Jb){ea.prototype.mo.call(this,Jb);this.businessBar.$.Ka.Kb(new P.a(this.command,Jb,this.businessBar.$.Jc,10,null))};Object(t.a)(D,"CommandActionBusinessBarEntry",U.a,[]);$k(w,D);w.prototype.RC=function(Jb){D.prototype.RC.call(this,Jb)};Object(t.a)(w,"EditAttemptReadOnlyBusinessBarEntry",D,[]);var ia=b(43),da=U.a;$k(y,da);y.prototype.mo=function(Jb){da.prototype.mo.call(this,Jb);this.error.Appearance&=-33;ia.a(this.businessBar.$).pr([this.error])};Object(t.a)(y,"ErrorBusinessBarEntry",
U.a,[]);$k(z,y);z.prototype.R_=function(Jb){y.prototype.R_.call(this,Jb);this.businessBar.$.Ka.Kb(new P.a(this.command,Jb,this.businessBar.$.Jc,10,null))};Object(t.a)(z,"ErrorAndCommandBusinessBarEntry",y,[]);var xa=b(14);A.ga=function(Jb){return xa.a.instance.ga(Jb)};of.Object.defineProperties(A.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return A.ga(this.BLj)}},message:{configurable:!0,enumerable:!0,get:function(){return A.ga(this.eP)}},messageId:{configurable:!0,enumerable:!0,
get:function(){return this.eP}},KGa:{configurable:!0,enumerable:!0,get:function(){return this.Dmg}},actionButton:{configurable:!0,enumerable:!0,get:function(){return A.ga(this.BS)}},pGa:{configurable:!0,enumerable:!0,get:function(){return A.ga(this.s8)}},link:{configurable:!0,enumerable:!0,get:function(){return A.ga(this.QI)}},Kk:{configurable:!0,enumerable:!0,get:function(){return this.brg}},ATg:{configurable:!0,enumerable:!0,get:function(){return this.Img}},hash:{configurable:!0,enumerable:!0,get:function(){return this.bjb}},
alt:{configurable:!0,enumerable:!0,get:function(){var Jb=b(1362).BusinessBarControl;switch(this.Kk){case Jb.Dia:return A.ga(26);case Jb.Uz:return A.ga(25);case Jb.ui:return A.ga(24);default:return A.ga(0)}}},F8c:{configurable:!0,enumerable:!0,get:function(){return this.Vog}}});Object(t.a)(A,"EwaBusinessBarEntry",null,[]);$k(u,A);of.Object.defineProperties(u.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return""}}});Object(t.a)(u,"EwaNoTitleBusinessBarEntry",A,[]);var Z=b(69),ha=U.a;
$k(l,ha);l.prototype.mo=function(Jb){ha.prototype.mo.call(this,Jb);this.set_visible(!1);this.businessBar.$.$H();this.businessBar.$.Ka.Kb(new P.a(1038998010,Jb,this.businessBar.$.Jc,10,null))};l.prototype.R_=function(Jb){ha.prototype.R_.call(this,Jb);this.businessBar.$.Ka.Kb(new P.a(-722953877,Jb,this.businessBar.$.Jc,10,null))};l.prototype.RC=function(Jb){this.businessBar.removeEntry(54);Z.g(Jb)};Object(t.a)(l,"ExternalLinksEnableContentBusinessBarEntry",U.a,[]);var ya=U.a;$k(x,ya);x.prototype.mo=
function(Jb){ya.prototype.mo.call(this,Jb);this.businessBar.$.Ka.Kb(new P.a(-722953877,Jb,this.businessBar.$.Jc,10,null))};x.prototype.RC=function(Jb){this.businessBar.removeEntry(5);Z.g(Jb)};Object(t.a)(x,"ExternalLinksShowErrorBusinessBarEntry",U.a,[]);var va=b(11),bb=U.a;$k(m,bb);m.prototype.mo=function(Jb){bb.prototype.mo.call(this,Jb);va.HelperMethods.$V(this.businessBar.$.$F,this.Fxb,this.businessBar.$.tS)};Object(t.a)(m,"HelpButtonBusinessBarEntry",U.a,[]);var ba=U.a;$k(v,ba);v.prototype.fma=
function(Jb){ba.prototype.fma.call(this,Jb);va.HelperMethods.$V(this.businessBar.$.$F,this.Fxb,this.businessBar.$.tS)};Object(t.a)(v,"HelpTextBusinessBarEntry",U.a,[]);var fa=b(76),ra=U.a;$k(f,ra);f.prototype.mo=function(Jb){ra.prototype.mo.call(this,Jb);this.businessBar.$.Ka.Kb(new P.a(this.command,Jb,this.businessBar.$.Jc,10,null))};f.prototype.fma=function(Jb){ra.prototype.fma.call(this,Jb);var dc=new P.a(-859308420,Jb,this.businessBar.$.Jc,12,null),$a={};Jb=($a[fa.a.Wf]="HelpID="+this.Fxb,$a.InputMethod=
Jb,$a[fa.a.Mc]=O.a.GQ,$a[O.a.jea]=!0,$a);this.businessBar.$.Ka.Kb(dc,Jb)};Object(t.a)(f,"HelpTextTaskPaneAndCommandBusinessBarEntry",U.a,[]);var pa=U.a;$k(n,pa);n.prototype.mo=function(Jb){pa.prototype.mo.call(this,Jb);this.set_visible(!1);this.businessBar.$.$H();this.businessBar.$.Ka.Kb(new P.a(-1081442996,Jb,this.businessBar.$.Jc,10,null))};n.prototype.R_=function(Jb){pa.prototype.R_.call(this,Jb);this.businessBar.$.Ka.Kb(new P.a(1702917262,Jb,this.businessBar.$.Jc,10,null))};n.prototype.RC=function(Jb){this.businessBar.removeEntry(58);
Z.g(Jb)};Object(t.a)(n,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",U.a,[]);var Za=b(1274),Ua=U.a;$k(k,Ua);k.prototype.fma=function(Jb){Ua.prototype.fma.call(this,Jb);(Jb=this.policyManager.oPi)&&Jb(null)};of.Object.defineProperties(k.prototype,{linkText:{configurable:!0,enumerable:!0,get:function(){return this.policyManager.linkText}}});Object(t.a)(k,"PolicyBusinessBarEntry",U.a,[]);var Ma=b(1273),oa=b(1276),ja=b(1275);b(447);var ta=b(188),aa=b(25),ma=U.a;$k(h,ma);h.prototype.mo=function(Jb){ma.prototype.mo.call(this,
Jb);ta.c(aa.a.gEi);window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ","_blank")};Object(t.a)(h,"UnsupportedBrowserBusinessBarEntry",U.a,[]);var Ea=b(1270),Ha=b(1504),Aa=U.a;$k(e,Aa);e.prototype.mo=function(Jb){Aa.prototype.mo.call(this,Jb);this.kCa.Suf(null)};e.prototype.R_=function(Jb){Aa.prototype.R_.call(this,Jb);this.kCa.Vuf(null)};e.prototype.RC=function(Jb){Aa.prototype.RC.call(this,Jb);this.kCa.sIe(null)};of.Object.defineProperties(e.prototype,{actionButton:{configurable:!0,
enumerable:!0,get:function(){return this.kCa.nve}},pGa:{configurable:!0,enumerable:!0,get:function(){return this.kCa.pve}}});Object(t.a)(e,"WildFireMobileAppBusinessBarEntry",U.a,[]);var V=b(257),La=b(22),Ra=b(230),pb=b(165),cb=b(46),Sa=b(7),Db=b(178),Ab=b(1179),Wb=b(80),ub=b(133),vb=U.a;$k(d,vb);d.prototype.update=function(Jb){this.scriptLink=Jb.scriptLink;this.runStatus=Jb.runStatus;this.buttonText=Jb.buttonText||"";this.gvi(Jb.clickId);this.ghj();"preparing"===this.runStatus?(this.message=String.format(xa.a.instance.mb(203),
this.buttonText),this.Ru=!0,this.iYa=this.hUd,this.Gqb=this.CFa=this.l$a):"running"===this.runStatus?(this.message=String.format(xa.a.instance.mb(202),this.buttonText),this.Ru=!0,this.iYa=this.hUd,this.Gqb=this.CFa=this.l$a):"succeeded"===this.runStatus?(this.message=String.format(xa.a.instance.mb(205),this.buttonText),this.Ru=!0,this.iYa=this.ugg,this.CFa=this.CEf,this.KZ=!0,this.iWc=this.XXj,this.jWc=this.kVi):"runFailed"===this.runStatus?(this.message=String.format(xa.a.instance.mb(204),this.buttonText),
this.y5a=a.Dia,this.Ru=!0,this.iYa=this.ugg,this.CFa=this.CEf,"false"===Jb.isOwner&&(this.KZ=!0,this.iWc=this.X2g,this.jWc=this.xJi)):"fetchFailed"===this.runStatus?(this.y5a=a.Dia,this.message=String.format(xa.a.instance.mb(206),this.buttonText)):"canceled"===this.runStatus?(this.y5a=a.Uz,this.message=String.format(xa.a.instance.mb(208),this.buttonText)):"alreadyRunning"===this.runStatus?(this.y5a=a.Uz,this.message=String.format(xa.a.instance.mb(207),this.buttonText),this.Ru=!0,this.iYa=this.hUd,
this.Gqb=this.CFa=this.l$a):"initializing"===this.runStatus&&(this.y5a=a.ui,this.message=xa.a.instance.ga(2260))};d.prototype.mo=function(Jb){vb.prototype.mo.call(this,Jb);this.CFa&&this.CFa()};d.prototype.R_=function(Jb){vb.prototype.R_.call(this,Jb);this.pGa&&this.jWc()};d.prototype.RC=function(Jb){vb.prototype.RC.call(this,Jb);this.Gqb&&this.Gqb()};d.prototype.ghj=function(){this.message="";this.y5a=a.ui;this.Ru=!1;this.iYa="";this.CFa=void 0;this.KZ=!1;this.iWc="";this.jWc=void 0;this.o5a=!1;
this.Gqb=void 0};d.prototype.l$a=function(){var Jb=Db.a.create().toString();this.automateCommandManager.W2h(Jb);this.qkc(-2186799,Jb)};d.prototype.CEf=function(){var Jb=Db.a.create().toString();this.automateCommandManager.V2h(Jb);this.qkc(1036446140,Jb)};d.prototype.kVi=function(){var Jb=Db.a.create();if(this.scriptLink){var dc=new Ab.b(this.scriptLink);this.automateCommandManager.l6e(this.id.toString(),JSON.stringify(dc),Jb)}this.qkc(-585097204,Jb.toString())};d.prototype.xJi=function(){var Jb=Db.a.create().toString();
this.automateCommandManager.U2h(Jb);this.qkc(-639858579,Jb)};d.prototype.gvi=function(Jb){var dc=[];dc.push(Object(Sa.a)(new Wb.a,{name:"id",string:this.id.toString()}));dc.push(Object(Sa.a)(new Wb.a,{name:"hasScriptLink",bool:!!this.scriptLink}));dc.push(Object(Sa.a)(new Wb.a,{name:"runStatus",string:this.runStatus}));dc.push(Object(Sa.a)(new Wb.a,{name:"clickId",string:Jb}));dc.push(Object(Sa.a)(new Wb.a,{name:"hasButtonText",bool:!!this.buttonText&&""!==this.buttonText}));ta.a(ub.a.zGi,void 0,
void 0,dc)};d.prototype.qkc=function(Jb,dc){var $a=[];$a.push(Object(Sa.a)(new Wb.a,{name:"id",string:this.id.toString()}));$a.push(Object(Sa.a)(new Wb.a,{name:"hasScriptLink",bool:!!this.scriptLink}));$a.push(Object(Sa.a)(new Wb.a,{name:"runStatus",string:this.runStatus}));$a.push(Object(Sa.a)(new Wb.a,{name:"clickId",string:dc}));ta.d(Jb,void 0,void 0,void 0,void 0,void 0,$a)};of.Object.defineProperties(d.prototype,{Kk:{configurable:!0,enumerable:!0,get:function(){return this.y5a}},actionButton:{configurable:!0,
enumerable:!0,get:function(){return this.iYa}},pGa:{configurable:!0,enumerable:!0,get:function(){return this.iWc}}});Object(t.a)(d,"OfficeScriptsRunStatusBusinessBarEntry",U.a,[]);var Ka=b(47),eb=b(1);$k(c,D);Object(t.a)(c,"CalloutBusinessBarEntry",D,[]);var yb=b(19);b.d(E,"BusinessBarControl",function(){return a});var oc=K.a;$k(a,oc);a.prototype.Uf=function(Jb,dc){dc||I.DOMElementExtensions.setFocus(this.domElement.firstChild);return!dc};a.prototype.ah=function(Jb){return I.DOMElementExtensions.nf(this.hc,
Jb)};a.prototype.ej=function(){};a.prototype.Dj=function(){};a.prototype.dispose=function(){this.om||(J.KeyInputManager.instance.Ba(S.a.Lb,this.hc,this.XV),N.a.oc(this.sU),this.sU=Array(69),this.ib=null,oc.prototype.dispose.call(this),this.om=!0)};a.prototype.mMa=function(Jb){if(!this.get_visible())return!1;Jb=this.sU[Jb];return!!Jb&&Jb.isVisible};a.prototype.eC=function(Jb){return!!this.sU[Jb]};a.prototype.MOb=function(Jb,dc){if(Jb=this.sU[Jb])Jb.update(dc),Jb.YRj()};a.prototype.QD=function(Jb,dc,
$a,Ba){$a=void 0===$a?null:$a;Ba=void 0===Ba?null:Ba;var la=!1;if(this.eC(Jb))$a=this.sU[Jb].get_visible();else{this.set_visible(!0);var ka=a.h4e()[Jb];this.sU[Jb]=this.X$(Jb,dc,$a,Ba);$a=!1;la=!0;Ba="";var ca=0;dc&&(Ba=dc.MessageIdName,ca=dc.MessageId);var Ia=ka.F8c;H.ULS.sendTraceTag(537170258,0,50,"BusinessBarControl.AddEntry of type: "+Jb+", time from app interactive: "+cb.PageLoadTrackingInfo.instance.xKa(new Date));if(eb.EwaSettings.isChangeGateEnabled("OfficeVSO:6069521_TelemetryForBusinessBar")){var jb=
this.sU.filter(function(nb){return null!=nb}).length;1<jb&&H.ULS.sendTraceTag(525349006,0,50,"Total BizBars: "+jb.toString())}pb.a(this.$).tKd(ka.hash,Ba,ca,T.a.hBc,!0,1,dc,Ia)}$a||!X.a.Scc().includes(Jb)&&!la||(this.sU[Jb].set_visible(!0),this.$.$H())};a.prototype.removeEntry=function(Jb){return this.Kaj(Jb)};a.prototype.tId=function(){N.a.oc(this.sU);this.sU=Array(69);this.set_visible(!1)};a.prototype.Kaj=function(Jb){if(!this.eC(Jb))return!1;N.a.Ia(this.sU[Jb]);this.sU[Jb]=null;this.domElement.hasChildNodes()||
this.set_visible(!1);this.$.$H();return!0};a.prototype.X$=function(Jb,dc,$a,Ba){$a=void 0===$a?null:$a;Ba=void 0===Ba?null:Ba;var la=a.h4e()[Jb],ka=!!(this.$.Bd&64);switch(Jb){case 2:case 4:case 23:case 25:case 26:case 35:case 34:Jb=new U.a(this,la);break;case 12:case 29:case 30:case 31:case 32:case 56:Jb=ka?new D(this,la,-8805455):new U.a(this,la);break;case 22:Jb=new w(this,la,-8805455);break;case 45:case 44:Jb=ka?new z(this,la,dc,0,-8805455):new y(this,la,dc,0);break;case 11:case 42:case 7:case 0:case 1:case 3:case 33:Jb=
new y(this,la,dc,0);break;case 19:Jb=new U.a(this,la);break;case 46:Jb=new y(this,la,dc,0);break;case 6:case 14:Jb=new m(this,la,dc.HelpTopicId);break;case 67:case 65:Jb=new v(this,la,dc.HelpTopicId);break;case 36:Jb=new v(this,la,O.a.Mch);break;case 37:Jb=new U.a(this,la);break;case 68:Jb=new w(this,la,924877417);break;case 16:Jb=new U.a(this,la);Jb.title=G.a.yg(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);Jb.message=G.a.yg(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);
break;case 18:Jb=new D(this,la,-1762562205);Jb.o5a=!0;break;case 20:Jb=new e(this,la);break;case 21:case 55:Jb=new U.a(this,la);break;case 28:Jb=new U.a(this,la);break;case 24:Jb=new h(this,la);break;case 27:Jb=new k(this,la);break;case 38:Jb=new Ea.a(this,la);break;case 39:Jb=new Q.a(this,la);break;case 40:Jb=new Ma.a(this,la);break;case 41:Jb=new Za.a(this,la);break;case 47:Jb=new U.a(this,la);break;case 48:Jb=new U.a(this,la);break;case 49:Jb=new U.a(this,la);break;case 50:Jb=new U.a(this,la);
break;case 51:Jb=new U.a(this,la);break;case 52:Jb=new ja.a(this,la);break;case 53:Jb=new oa.a(this,la);break;case 54:Jb=new l(this,la);break;case 5:Jb=new x(this,la);break;case 57:Jb=new D(this,la,-1753056834);dc?(dc=dc.Directive,La.a.uq(dc)||"&nbsp;"===dc||(Jb.message=dc)):$a&&(Jb.message=$a);break;case 58:Jb=new n(this,la);break;case 59:Jb=new U.a(this,la);break;case 60:case 63:Jb=new v(this,la,O.a.IFi);break;case 61:Jb=new f(this,la,O.a.QOg,-8805455);break;case 66:Jb=new f(this,la,O.a.Y6i,1461300262);
break;case 62:Jb=eb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerBusinessBarTeachingCallout",!1)?new c(this,la,515196233,13,3E5,"OptimizeWorkbookManager.ShowBusinessBarTeachingCallout"):new D(this,la,515196233);break;case 64:Jb=new d(this,la,this.$,Ba);break;default:Jb=new y(this,la,dc,7)}Jb.o3c();return Jb};a.h4e=function(){var Jb=Ra.a.qMa()?263:262;return a.dve||(a.dve=[new A(0,278,279,280,0,0,a.Dia,1,"BB_UnableToRefreshLock"),new A(1,278,279,280,0,0,a.Dia,
1,"BB_UnableToRefreshLockExpected"),new A(2,270,271,0,0,0,a.Uz,5,"BB_WorkbookAlmostTooLarge"),new A(3,272,273,274,0,0,a.Dia,1,"BB_WorkbookTooLarge"),new A(4,261,Jb,0,0,0,a.Uz,5,"BB_ExternalWorkbookLinksDisabled"),new A(5,265,264,266,0,0,a.Dia,1,"BB_ExternalWorkbookLinksShowError"),new A(6,267,268,269,0,0,a.ui,0,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),new A(7,253,254,255,0,0,a.ui,0,"BB_UnsupportedFeatures"),new A(8,0,0,0,0,0,a.ui,0,"BB_CollabDataAndDataStringsLocaleMismatch"),new A(9,0,0,0,0,
0,a.ui,0,"BB_CollabDataStringsLocaleMismatch"),new A(10,0,0,0,0,0,a.ui,0,"BB_CollabDataLocaleMismatch"),new A(11,281,282,283,0,0,a.Dia,1,"BB_LastGenericStatusError"),new A(12,284,285,286,0,0,a.Uz,5,"BB_ScratchPadWarning"),new A(13,287,288,289,0,0,a.Dia,1,"BB_AuthenticationLost"),new A(14,290,291,292,0,0,a.Uz,5,"BB_OdfCompatibilityIssues"),new A(15,0,578,0,0,0,a.Uz,5,"BB_PivotChartInteractivityMissingWarning"),new A(16,0,0,0,0,0,a.ui,0,"BB_WorkbookIsIrmProtected"),new A(17,0,0,0,0,0,a.ui,0,"BB_BIFeatureNotAvailable"),
new A(18,293,294,289,0,0,a.Uz,5,"BB_AnonymousCreateMode"),new A(19,256,257,0,0,0,a.Uz,5,"BB_UnsupportedInteractiveReportEditing"),new A(20,0,0,0,0,0,a.ui,0,"BB_MobileAppCampaignBizBar"),new A(21,299,300,0,0,0,a.ui,0,"BB_TransientServerCommunicationFailures"),new A(22,1635,1646,1647,0,0,a.ui,0,"BB_EditAttemptInReadOnly"),new A(23,1635,1646,0,0,0,a.ui,0,"BB_EditAttemptInReadOnlyNoEditPermissions"),new A(24,0,va.HelperMethods.uRj(),1624,0,0,a.ui,0,"BB_UnsupportedBrowser"),new A(25,302,303,0,0,0,a.ui,
0,"BB_ReadOnlyPermissions"),new A(26,304,305,0,0,0,a.ui,0,"BB_DocumentIsIrmProtectedWarning"),new A(27,0,0,0,0,0,a.Uz,5,"BB_PolicyWarningMessage"),new A(28,1278,301,0,0,0,a.ui,0,"BB_WorkingOnIt"),new A(29,1635,1633,1634,0,0,a.ui,0,"BB_PasswordProtectedWorkbookLockedForEdit"),new A(30,1648,1649,1650,0,0,a.ui,0,"BB_WorkbookIsReadOnlyRecommended"),new A(31,1635,1651,1652,0,0,a.ui,0,"BB_WorkbookHasPasswordToModify"),new A(32,1635,1653,1656,0,0,a.ui,0,"BB_LegacySharedWorkbookEditWarning"),new A(33,1643,
1654,255,0,0,a.ui,0,"BB_LegacyConnectionsWarning"),new A(34,1644,1645,0,0,0,a.ui,0,"BB_GroupedSlicers"),new A(35,315,316,0,0,0,a.Uz,5,"BB_ThirdPartyAddinDisabled"),new A(36,1776,1777,0,0,1778,a.ui,0,"BB_FinanceLinkedEntityDisclaimerBar"),new A(37,1805,1806,0,0,0,a.Uz,5,"BB_WolframDeprecationAlertBar"),new A(38,0,0,0,0,0,a.ui,0,"BB_WacGdprNotice"),new A(39,0,0,0,0,0,a.ui,0,"BB_AutomaticSensitivityLabel"),new A(40,0,0,0,0,0,a.ui,0,"BB_RecommendedSensitivityLabel"),new A(41,0,0,0,0,0,a.ui,0,"BB_MandatorySensitivityLabel"),
new A(42,317,318,319,0,0,a.ui,0,"BB_LocalStorageDisabled"),new A(43,635,636,0,0,0,a.ui,0,"BB_AutoRefreshDisabled"),new A(44,1006,1004,1008,1307,0,a.ui,0,"BB_CorruptedFileRepaired"),new A(45,1007,1005,1008,1307,0,a.ui,0,"CorruptedOdsFileRepaired"),new A(46,275,276,277,0,0,a.Uz,5,"BB_MinorVersionLimitReached"),new A(47,306,307,0,0,0,a.Uz,5,"BB_SensitivityApplicationGenericError"),new A(48,308,310,0,0,0,a.Uz,5,"BB_SensitivityApplicationTooLargeFileError"),new A(49,309,310,0,0,0,a.Uz,5,"BB_SensitivityApplicationLabelNotSupportedError"),
new A(50,311,312,0,0,0,a.Uz,5,"BB_SensitivityApplicationLabelDisabledError"),new A(51,313,314,0,0,0,a.Uz,5,"BB_SensitivityApplicationMandatoryConflictError"),new A(52,0,0,0,0,0,a.Uz,5,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new A(53,0,0,0,0,0,a.Uz,5,"BB_SensitivityApplicationSetLabelError"),new A(54,2101,2102,2103,2106,0,a.ui,0,"BB_ExternalWorkbookLinksPromptEnableContent"),new A(55,299,300,0,0,0,a.ui,0,"BB_NetworkDown"),new A(56,320,321,322,0,0,a.ui,0,"BB_DefaultToViewDueToCogs"),
new A(57,1802,1803,1804,0,0,a.ui,0,"BB_RefreshLinkedEntityErrorBar"),new A(58,1779,1780,1781,1782,0,a.ui,0,"BB_LinkedEntitiesUntrustedImagesDisabled"),new u(59,252,0,0,0,a.ui,0,"BB_CanvasHealth"),new A(60,323,324,0,0,325,a.ui,0,"BB_NovModeDepreciation"),new A(61,1009,1010,1307,0,1011,a.ui,0,"BB_MismatchedFileFormatConverted"),new A(62,2216,2217,2218,0,0,a.ui,0,"BB_OptimizeWorkbook"),new A(63,326,327,0,0,328,a.ui,0,"BB_NovModePostDepreciation"),new A(64,0,0,0,0,0,a.ui,0,"BB_OfficeScriptsRunning"),
new A(65,2194,2195,0,0,2197,a.ui,0,"BB_PowerQueryRefreshDataSourceNotSupported"),new A(66,329,330,0,0,331,a.ui,0,"BB_ReadOnlyPivotTable"),new A(67,2194,2196,0,0,2197,a.ui,0,"BB_PowerQueryRefreshHostNotSupported"),new A(68,1047,1048,1046,0,0,a.ui,4,"BB_RefreshPageAfterEnablingTheExtension")])};of.Object.defineProperties(a.prototype,{Yd:{configurable:!0,enumerable:!0,get:function(){return V.a.aZc}},hc:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},canReceiveFocus:{configurable:!0,
enumerable:!0,get:function(){return this.get_visible()}},$:{configurable:!0,enumerable:!0,get:function(){return this.ib}}});a.Dia=yb.a.grh;a.Uz=yb.a.irh;a.ui=yb.a.hrh;a.dve=null;Object(t.a)(a,"BusinessBarControl",K.a,[429])},1364:function(t,E,b){function a(){Type.registerNamespace("Common.App.SaveToSharePoint");c.main()}function c(){this.qra=this.HNc=this.CNc=this.fb=null}function d(V,La,Ra,pb,cb){this.rm=this.PCa=null;this.VEc=!1;this.uQc=this.Q8=null;this.JSc=La;this.flb=Ra;this.xs=pb;this.Ue=cb;
this.La=V}function e(V){this.yFa=V.appSettings.SaveAsToHostWebServiceBase;this.fA=V.appSettings.FileName;this.Cfa=V.Wa("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}function h(V,La,Ra,pb,cb,Sa,Db,Ab){this.xFa=V;this.fA=La;this.NVa=pb;this.qPc=Sa;this.Q8=Ra;this.Gxg=cb;this.Cfa=Db;this.Ah=Ab}function k(V,La,Ra,pb){this.Ah=this.Qbe=null;this.qFa=V;this.xs=La;this.oOc=Ra;this.Ue=pb}function n(V,La,Ra,pb,cb,Sa,Db){this.jb=V;this.zIc=Ra;this.La=La;this.Glb=pb;this.Gib=cb;this.oOc=Sa;this.Umg=
Db}function f(){return ha.call(this)||this}function v(V,La,Ra,pb){var cb=this;this.zo=this.Ikb=null;this.Gib=V;this.Ue=Ra;this.Sug=pb;this.HDa=new w.a(function(){return new P.a(La.value,Object(S.a)(cb,cb.$vb,"getMoreInfoEventReceived"))})}function m(V,La,Ra,pb,cb,Sa,Db,Ab,Wb,ub){this.La=La;this.jb=V;this.BX=pb;this.Dga=Sa;this.xs=cb;this.Ue=Ra;this.Lfe=Db;this.$sg=void 0===Ab?null:Ab;this.qFa=void 0===Wb?null:Wb;this.GXa=void 0===ub?null:ub}function x(V,La,Ra,pb,cb,Sa,Db,Ab,Wb){this.GMc=null;this.fA=
"";this.Glb=V;this.xs=La;this.Ah=Wb;this.Dga=Ra;this.Ue=cb;this.Av=pb;this.qFa=Db;this.GXa=Ab;Sa&&(this.GMc=new w.a(function(){return new P.a(Sa.value,null)}))}function l(){this.properties=this.friendlyPath=this.folderName=null}function u(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}function A(V,La,Ra,pb,cb,Sa,Db,Ab){V=B.call(this,V,La,Ra,pb,cb,Sa,Ab)||this;V.Fy=null;V.yQc=null;V.jqa=null;V.LTg=CommonUIStrings.l_SaveToAnotherFolder;V.Xf=z.Xf;
V.ye="FileNameDialog-SaveToSharePoint";V.Glb=Db;V.wug=Ab;return V}function z(){}function y(){var V=J.call(this)||this;V.Rb=0;V.kc(1,CommonUIStrings.l_DialogClose);return V}t=b(0);var w=b(624),D=b(15),H=b(135),F=b(52),J=H.StandardDialog;$k(y,J);y.prototype.displayError=function(V,La){this.DIe(V,La,F.a.Wkj)};y.prototype.DIe=function(V,La,Ra){D.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",Ra);this.Lz(Ra,V,La,null)};y.prototype.K6c=function(V,La){D.ULS.sendTraceTag(25235986,
216,15,"Show warning dialog of Picker related issue.");this.Lz(F.a.Ykj,V,La,null,!0)};Object(t.a)(y,"ErrorDialog",H.StandardDialog,[372]);var S=b(84);H=b(1265);var N=b(150);of.Object.defineProperties(z,{Xf:{configurable:!0,enumerable:!0,get:function(){return N.a.Oo(z.rk,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}});z.rk="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(t.a)(z,"FileNameDialogHtml",null,[]);var T=b(4),G=b(13),I=b(44),K=b(86),L=b(89),O=b(29),B=H.a;$k(A,B);A.prototype.aQ=function(V){var La=O.a.oq(T.AFrameworkApplication.cm.Pm),Ra=T.AFrameworkApplication.breadcrumbFolderName,pb=T.AFrameworkApplication.breadcrumbBrandName,cb={};cb=(cb.txtFileName=V||La,cb);var Sa=CommonUIStrings.L_SaveAs;2===T.AFrameworkApplication.ta.Qa.rj&&(Sa=CommonUIStrings.L_SaveACopy);this.initializeAndShow(Sa,Object(S.a)(this,this.P9b,"fileNameDialogHandler"),cb);this.kIe(V,
La);this.vIa.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");T.AFrameworkApplication.fa.qa("HideSaveToAnotherFolderButtonforUIHost")||(this.Fy=document.getElementById("anotherFolder"),V=document.getElementById("folderLocation"),this.yQc=L.a.Gqe(V,this.Fy,"anotherFolderDescribedBy"),this.Fy.className="WACButton WACDialogButtonNormal",V=!1,Ra&&Ra.length?(this.ile(this.Fy,this.yQc,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,
pb,Ra)),V=this.CBg(pb,Ra)):this.ile(this.Fy,this.yQc,CommonUIStrings.l_CurrentOnlineFolder),this.CCg(this.Fy),this.FBg(this.Fy),V?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.Fy,"SaveToAnotherLocationTwo"),D.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.Fy,"SaveToAnotherLocationOne"),I.a.addHandler(this.Fy,G.a.click,Object(S.a)(this,this.BBd,"onSaveToAnotherLocationClick")),
I.a.addHandler(this.Fy,G.a.Lb,Object(S.a)(this,this.kCf,"onSaveToAnotherLocationKeyDown")))};A.prototype.CBg=function(V,La){var Ra=!1;var pb=document.getElementById("currentLocation");pb.innerText="";var cb=this.b0e(pb,V),Sa=this.b0e(pb,La),Db=255,Ab=255;255<cb+Sa&&(Db=Math.max(238,408-cb),Ab=Math.max(170,408-Sa),Ra=!0);this.bEg(pb,V,Ab,La,Db);return Ra};A.prototype.b0e=function(V,La){var Ra=document.createElement("div");Ra.innerText=La;Ra.style.visibility="hidden";V.appendChild(Ra);La=Ra.clientWidth;
V.removeChild(Ra);return La};A.prototype.bEg=function(V,La,Ra,pb,cb){La&&(this.gle(V,La,Ra),this.UDg(V));pb&&this.gle(V,pb,cb)};A.prototype.gle=function(V,La,Ra){var pb=document.createElement("div");pb.innerText=La;pb.title=La;pb.className="SaveToAnotherFolderBreadcrumb";pb.style.maxWidth=Ra.toString()+"px";V.appendChild(pb)};A.prototype.UDg=function(V){var La=document.createElement("span");La.id="FolderSeparator";var Ra=document.createElementNS("http://www.w3.org/2000/svg","svg");Ra.setAttribute("class",
"SeparatorCaret");var pb=document.createElementNS("http://www.w3.org/2000/svg","polygon");pb.setAttribute("points","1 4 1 11 5 7.5");Ra.appendChild(pb);La.appendChild(Ra);V.appendChild(La)};A.prototype.ile=function(V,La,Ra){Ra=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,Ra);La&&(La.innerText=Ra);V.tabIndex=0;V.setAttribute(L.a.Gd,L.a.Js)};A.prototype.FBg=function(V){var La=document.createElement("span");La.id="anotherFolderText";La.innerText=this.LTg;La.className="AnotherFolderTextSpan";
V.appendChild(La)};A.prototype.CCg=function(V){var La=document.createElement("span");La.className="cui-img-cont-float cui-img-16by16 ";this.jqa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.jqa.setAttribute("class","FolderIconSVG");var Ra=document.createElementNS("http://www.w3.org/2000/svg","path");Ra.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.jqa.appendChild(Ra);La.appendChild(this.jqa);
V.appendChild(La)};A.prototype.kCf=function(V){!V||V.keyCode!==K.a.Qh&&V.keyCode!==K.a.l1||this.BBd(V)};A.prototype.BBd=function(){if(this.KI){var V=O.a.l4(T.AFrameworkApplication.fileName),La=this.KI.value;this.hide();La&&""!==La&&""!==V||1===this.ta.state?(""!==V&&(La+=V),this.Q9b(La)?this.xs.create().displayError(1,La,!1):this.Glb.start(La,this.wug)):this.xs.create().displayError(2,La,!1)}};A.prototype.uXg=function(V){this.Fy&&this.jqa&&(V?(this.Fy.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.Fy,
"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.jqa,"DisabledFolderIconSVG")):(this.Fy.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.Fy,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.jqa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.Fy,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.jqa,"DisabledFolderIconSVG"))))};A.prototype.aid=function(){B.prototype.aid.call(this);this.uXg(!!this.KI&&""!==this.KI.value)};A.prototype.dispose=function(){this.Fy&&
(I.a.removeHandler(this.Fy,G.a.click,Object(S.a)(this,this.BBd,"onSaveToAnotherLocationClick")),I.a.removeHandler(this.Fy,G.a.Lb,Object(S.a)(this,this.kCf,"onSaveToAnotherLocationKeyDown")),this.Fy=null);B.prototype.dispose.call(this)};Object(t.a)(A,"FileNameDialog",H.a,[377]);var Q=b(904),U=b(625),X=b(192),P=b(1029),ea=b(1124),ia=b(99),da=b(136);Object(t.a)(u,"SaveAsDialogInput",null,[]);Object(t.a)(l,"SaveLocation",null,[]);var xa=b(396),Z=b(193);x.prototype.$Mh=function(){var V=new Q.a(U.a.Jk());
V.ia("type","currentHost");return Object.assign(new l,{folderName:this.Av.breadcrumbFolderName,friendlyPath:this.Av.breadcrumbBrandName,properties:V})};x.prototype.Rni=function(V){return!!V&&"ClassicMru"===V.type&&!!V.service_info&&!!V.service_info.service_id&&-1!==V.service_info.service_id.indexOf("SHAREPOINT")};x.prototype.AYh=function(){if(!this.GMc||!this.qFa)return null;var V=this.GMc.value.HZ("SaveAsToSharePointDialog",!1);if(!V||3!==V.state||!V.grf)return null;V=V.grf;for(var La=new X.a,Ra=
0,pb=0,cb=0;cb<V.length;cb++){var Sa=V[cb];if(this.Rni(Sa)&&(Ra++,Sa.sharepoint_info)){var Db=Sa.url,Ab=Sa.sharepoint_info.site_url,Wb=Sa.title;Sa=ea.b(Sa,T.AFrameworkApplication.isRtl);if(Db&&Ab&&Wb&&Sa){pb++;var ub=new Q.a(U.a.Jk());ub.ia("type","SharePoint");ub.ia("siteUrl",Ab);ub.ia("folderUrl",Db);pb++;La.add(Object.assign(new l,{folderName:Wb,friendlyPath:Sa,properties:ub}))}}}cb=new Map;cb.set("NumPlaces",V.length.toString());cb.set("NumSharepointPlaces",Ra.toString());cb.set("placesWithMetadata",
pb.toString());ia.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",cb);0<Ra&&(pb?.5>1*pb/Ra&&ia.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):ia.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return La};x.prototype.RNh=function(){var V=new X.a;V.add(this.$Mh());var La=this.AYh();La&&V.addRange(La);return Object.assign(new u,{enableMoreLocations:!T.AFrameworkApplication.fa.qa("HideSaveToAnotherFolderButtonforUIHost"),
fileName:this.fA,extension:O.a.l4(this.Av.Pm),saveLocations:V.toArray(),scenario:"SaveToSharePoint"})};x.prototype.ebc=function(){return{inputPropsCallback:Object(S.a)(this,this.RNh,"getDialogInput")}};x.prototype.aQ=function(V){this.fA=V;this.fA||(this.fA=String.format(CommonUIStrings.l_SaveACopy_Filename,O.a.oq(this.Av.Pm)));V={};V=(V.id="SaveAsDialog",V.bodyControls=this.ebc(),V);var La=CommonUIStrings.L_SaveAs;2===this.Ue.Qa.rj&&(La=CommonUIStrings.L_SaveACopy);var Ra=new N.a(!1,!1,!0);Ra.Rb=
1;Ra.ye="SaveAsDialog";Ra.kc(1,CommonUIStrings.l_SaveButtonLabel);Ra.initializeAndShow(La,Object(S.a)(this,this.Skj,"saveAsDialogHandler"),V)};x.prototype.VBj=function(V,La){V&&""!==V&&""!==La||1===this.Ue.state?this.Qni()?this.uui(V,La):(""!==La&&(V+=La),this.Glb.start(V,this.Ah)):(D.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.xs.create().displayError(2,V,!1))};x.prototype.uui=function(V,La){var Ra=this;ia.Health.instance.recordKpiUsage("SaveACopySFP",
0,"smartfio",null);var pb=this.GXa.ODe(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,null,"SaveACopy",2);this.GXa.fed(pb).then(function(cb){if(cb&&0<cb.length){var Sa=cb[0][xa.a.lZi];cb=cb[0][xa.a.ZGf];if(""!==Sa&&""!==cb)Ra.qFa.boa(cb,V+La,Sa,Ra.Ah),ia.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{Ra.xs.create().displayError(0,V,!1);var Db=da.a.Er();Db&&(Db.set("SiteUrlAvailable",""===Sa?"false":"true"),Db.set("FolderUrlAvailable",""===cb?"false":
"true"));ia.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new Z.a,{extendedProperties:Db}))}}else Ra.xs.create().displayError(0,V,!1),ia.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(function(cb){"Canceled"===cb?((cb=da.a.Er())&&cb.set("IsCanceled","true"),ia.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new Z.a,{extendedProperties:cb}))):ia.Health.instance.recordKpiFailure("SaveACopySFP",
cb,!1,!1,null)})};x.prototype.Qni=function(){return this.GXa?this.GXa.Fqd():(D.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)};x.prototype.Skj=function(V,La){if(La&&1===V){V=La.fileName;var Ra=O.a.l4(this.Av.Pm);La.moreLocationsSelected&&this.VBj(V,Ra);if(La.locationCallback){var pb=La.locationCallback();pb?pb.properties&&"currentHost"===pb.properties.na("type")?this.Dga.boa(V+Ra,!1,this.Ah):pb.properties&&"SharePoint"===pb.properties.na("type")?(La=pb.properties.na("siteUrl"),
pb=pb.properties.na("folderUrl"),this.qFa.boa(pb,V+Ra,La,this.Ah)):D.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):D.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else D.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}};Object(t.a)(x,"ReactSaveAsDialog",null,[377]);m.prototype.create=function(V){return this.Ue&&this.Ue.Qa.Yu?new x(this.Lfe,this.xs,this.Dga,T.AFrameworkApplication.cm,this.Ue,this.$sg,this.qFa,this.GXa,V):new A(this.jb,this.La,
this.Ue,this.BX,this.xs,this.Dga,this.Lfe,V)};Object(t.a)(m,"FileNameDialogFactory",null,[371]);v.prototype.start=function(V){var La=this;if(!this.VEf)if(T.AFrameworkApplication.breadcrumbFolderUrl&&T.AFrameworkApplication.breadcrumbFolderUrl.length)this.Ikb=T.AFrameworkApplication.breadcrumbFolderUrl;else return D.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.zo),!1;
var Ra=this.Sug();Ra.oCj();var pb=Ra.$Uh();if(!pb)return D.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.Gib.start(function(cb,Sa){Ra.hide();V(cb,Sa)},function(){La.yOa(Ra)},pb,this.Ikb);return!0};v.prototype.yOa=function(V){V.hide();D.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")};v.prototype.sUh=function(V){V=V.toLowerCase();V.endsWith("/")||(V+="/");var La=V.indexOf("/documents/");return-1!==La?V.substring(0,La+1)+"_layouts/15/onedrive.aspx":
""};v.prototype.$vb=function(V){this.zo||3!==V.state||(this.zo=V)};of.Object.defineProperties(v.prototype,{VEf:{configurable:!0,enumerable:!0,get:function(){this.Ikb||(this.HDa.value.HZ("Save As",!0),this.zo&&this.zo.tR&&this.zo.tR.length&&(this.Ikb=this.sUh(this.zo.tR)));return this.Ikb}}});Object(t.a)(v,"OneDriveFilePickerHelper",null,[309]);var ha=N.a;$k(f,ha);f.prototype.oCj=function(){this.oHc="FilePickerDialog";this.Xf="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.ye="PickerDialog-MsoSp";
this.showDialog("",null)};f.prototype.$Uh=function(){return document.getElementById("FilePickerDiv")};f.prototype.lO=function(){};f.prototype.QPa=function(){};Object(t.a)(f,"PickerDialog",N.a,[370]);var ya=b(748),va=b(1056),bb=b(397),ba=b(27),fa=b(107),ra=b(25);n.prototype.Ag=function(){var V=this,La=this.Gib.n4a();La?ba.a.Gka||this.jb.qa("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.La.He(ra.a.saveToSharePoint,fa.a.frame,Object(S.a)(this,this.lWf,"saveToSharePointActionDispatcher"),64):(La.o8a.continueWith(function(Ra){Ra.Of&&
V.Gib.QAd(Ra)}),this.R1b()):D.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")};n.prototype.R1b=function(){bb.a.SHd(Object(S.a)(this,this.lWf,"saveToSharePointActionDispatcher"));bb.a.k8c([new va.a(ra.a.saveToSharePoint,fa.a.frame,0)],this.Gib.n4a())};n.prototype.lWf=function(V,La,Ra,pb,cb){return La.contextId!==fa.a.frame||V!==ra.a.saveToSharePoint?2:this.y7a&&(this.oOc.VEf||this.ywe)?1===Ra?ya.SessionStatusManager.instance.jxb||T.AFrameworkApplication.h5?
8:this.Umg()?32:8:2===Ra?(D.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(cb&&cb.SaveEntryPoint&&"VersionHistory"===cb.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.ywe?(D.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.zIc.create(cb).aQ(null)):(D.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),this.Glb.start(null,cb)),32):8:8};of.Object.defineProperties(n.prototype,
{y7a:{configurable:!0,enumerable:!0,get:function(){return this.jb.qa("SaveToAnotherFolderBrsIsEnabled")}},ywe:{configurable:!0,enumerable:!0,get:function(){return this.jb.qa("UserCanWriteRelative")}}});Object(t.a)(n,"SaveToSharePointActor",null,[]);k.prototype.start=function(V,La){var Ra=this;D.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.Qbe=V;this.Ah=La;this.oOc.start(function(pb,cb){Ra.J2i(pb,cb)})||this.uSd()};k.prototype.J2i=function(V,La){if(V)this.onSuccess(La);else this.r6(La)};
k.prototype.uSd=function(){1!==this.Ue.state&&this.xs().K6c(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)};k.prototype.onSuccess=function(V){D.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(V&&V.data&&V.data.value&&V.data.value.length&&V.data.value[0].sharePoint){var La=V.data.value[0].sharePoint.url;V=V.data.value[0].sharePoint.listUrl;var Ra=null;if(La&&(Ra=V?this.VYh(V):this.UYh(La))){this.qFa.boa(La,
this.Qbe,Ra,this.Ah);return}D.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!La,!Ra)}D.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.uSd()};k.prototype.UYh=function(V){V.endsWith("/")||(V+="/");for(var La=0,Ra=0;Ra<V.length;Ra++)if("/"===V.charAt(Ra)&&5===++La)return V.substr(0,Ra);return null};k.prototype.VYh=function(V){V.endsWith("/")&&(V=V.substring(0,V.length-1));var La=V.lastIndexOf("/");
return-1!==La?V.substring(0,La):null};k.prototype.r6=function(V){D.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");V&&V.error?D.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",V.error.errorCode,V.error.message):D.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.uSd()};Object(t.a)(k,"SaveToSharePointManager",null,[704]);var pa=b(81);h.prototype.execute=function(V,La){if(!T.AFrameworkApplication.zg&&T.AFrameworkApplication.nd){var Ra=
this.xFa+this.Cfa;Ra=pa.a.wl(Ra,"fu",O.a.$e(this.Q8));Ra=pa.a.wl(Ra,"su",O.a.$e(this.Gxg));Ra=pa.a.wl(Ra,"fn",O.a.$e(this.fA));Ra=pa.a.wl(Ra,"n",O.a.$e((new Date).getTime().toString()));this.Ah&&this.Ah.FileDownloadUrl&&(Ra=pa.a.wl(Ra,"furl",O.a.$e(this.Ah.FileDownloadUrl)));Ra=Ra+"&"+this.qPc;this.NVa&&this.NVa.length?Ra=pa.a.wl(Ra,"fnn",O.a.$e(this.NVa)):D.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");D.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");
T.AFrameworkApplication.nd.Zl(Ra,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,V,La,null,void 0,void 0,void 0,void 0,"9")}};Object(t.a)(h,"SharePointSaveAsCaller",null,[722]);e.prototype.create=function(V,La,Ra,pb){return new h(this.yFa,this.fA,V,La,Ra,T.AFrameworkApplication.Yi,this.Cfa,pb)};Object(t.a)(e,"SharePointUploadCallerFactory",null,[703]);var Za=b(42),Ua=b(39),Ma=b(250),oa=b(907),ja=b(170),ta=b(749),aa=b(987);d.prototype.boa=function(V,La,Ra,pb){this.VEc=!1;D.ULS.sendTraceTag(23881921,
216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.DMb();this.Q8=V;pb&&pb.SaveEntryPoint&&(this.uQc=pb.SaveEntryPoint);this.PCa=this.JSc.create(V,La,Ra,pb);pb&&"true"===pb.SkipSaveToHost?this.jQ():this.eEh()};d.prototype.eEh=function(){function V(){D.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");La.jQ()}var La=this;32!==this.La.$d(ra.a.aRa,2,[function(){D.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");
La.jQ()},V])&&V()};d.prototype.jQ=function(){D.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.PCa.execute(Object(S.a)(this,this.rSi,"onSaveToSharePointUploadFinished"),Object(S.a)(this,this.qSi,"onSaveToSharePointUploadFailed"))};d.prototype.rSi=function(V){if(V&&V.data&&V.data.Rd){var La=Za.d(V.data.Rd);var Ra=La.Ot;if(La.returnValue)if(Ra.StatusCode!==Ma.a.QO&&Ra.StatusCode!==Ma.a.Wrb)D.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",
V.data.status,Ra.StatusCode),Ra.StatusCode!==Ma.a.aTf&&this.aJe(V.data.status)||(this.yda(Ra.StatusCode.toString()),this.$Aj(Ra.StatusCode));else{D.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.IKd();try{Ra.NewDocumentUrl?this.bQa(Ra.NewDocumentUrl):this.cQa()}catch(pb){D.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",pb.toString())}}else Ra={},D.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",(Ra.ResponseData=aa.a.afb(V.data.Rd),
Ra)),this.w7b()||(this.yda("Failed to deserialize response"),this.BMb())}else D.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.w7b()||(this.yda("Unknown"),this.BMb())};d.prototype.qSi=function(V){V&&V.data?this.aJe(V.data.status)||(D.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.yda(oa.a[V.data.status]),this.BMb()):(D.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.w7b()||(this.yda("Unknown"),this.BMb()))};d.prototype.w7b=function(){if(!this.VEc)return D.ULS.sendTraceTag(23881930,
216,10,"Upload fail. Retrying."),this.VEc=!0,this.jQ(),!0;D.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1};d.prototype.aJe=function(V){D.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",V);return this.w7b()};d.prototype.cQa=function(){D.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");Ua.a.Te(this.Q8,Ua.a.sX(3),void 0,"UploadToSharePointManager.RedirectToFolder")};d.prototype.bQa=function(V){var La=!1,Ra=!1;T.AFrameworkApplication.fa&&
(La=T.AFrameworkApplication.fa.qa("SaveACopyIsEnabledForUiHost"),Ra=T.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures"));D.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",V,La);if(La&&Ra){D.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var pb={};pb[xa.a.XPa]="1";pb[xa.a.documentUrl]=V;pb[xa.a.reason]=ta.a.saveAs;T.AFrameworkApplication.iV().execute(function(cb){cb.wj(ja.a.Sta,
pb)})}else Ua.a.Te(V,Ua.a.sX(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")};d.prototype.DMb=function(){this.Ue&&1===this.Ue.state||(this.rm=this.flb(),this.rm.message=CommonUIStrings.l_CommentProgressTooltip,this.rm.Rb=5,this.rm.Su=!1,this.rm.TAa(CommonUIStrings.l_DefaultDialogTitle,null,null))};d.prototype.DIa=function(){this.rm&&(this.rm.close(),this.rm=null)};d.prototype.BMb=function(){this.gj(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)};d.prototype.ZBj=
function(){this.gj(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)};d.prototype.gBj=function(){var V=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.gj(CommonUIStrings.l_SaveAsFileTooLargeTitle,V,F.a.Tkj)};d.prototype.gj=function(V,La,Ra){Ra=void 0===Ra?F.a.Xkj:Ra;D.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",V,La);this.DIa();1!==this.Ue.state&&this.xs().DIe(V,La,Ra)};d.prototype.$Aj=function(V){D.ULS.sendTraceTag(25180166,
216,50,"Upload fail with status code: {0}.",V);switch(V){case Ma.a.Kbg:this.ZBj();break;case Ma.a.aTf:this.gBj();break;default:this.BMb()}};d.prototype.IKd=function(){"VersionHistory"===this.uQc&&this.La.processAction(ra.a.Ktc,2)};d.prototype.yda=function(V){if("VersionHistory"===this.uQc){var La={};this.La.$d(ra.a.KKd,2,(La.FailureReason=V,La))}};Object(t.a)(d,"UploadToSharePointManager",null,[702]);var ma=b(258),Ea=b(1005),Ha=b(575),Aa=b(58);c.prototype.init=function(){};c.prototype.dispose=function(){};
c.prototype.Sh=function(V){var La=this;this.fb=V;this.CNc=Ha.a.Kq(V.Tb("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.HNc=Ha.a.Kq(V.Tb("Common.IEventEmitter<Common.IMruResult>"));this.qra=Ha.a.Kq(V.Tb("Common.App.SharedFilePicker.ISharedFilePicker"));Aa.Task.WAA.call(null,this.CNc,this.HNc,this.qra).continueWith(function(){La.Q8i()})};c.prototype.Q8i=function(){var V=this;this.fb.register(e,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Dc(function(){return new e(T.AFrameworkApplication.fa)}).tc();
this.fb.register(d,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Dc(function(){return new d(T.AFrameworkApplication.ub,V.fb.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),function(){return(new Ea.a).create()},function(){return new y},T.AFrameworkApplication.ta)}).tc();this.fb.register(k,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Dc(function(){return new k(V.fb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),
function(){return new y},V.fb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),T.AFrameworkApplication.ta)}).tc();this.fb.register(v,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Dc(function(){return new v(V.fb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new w.a(function(){return V.CNc.result}),T.AFrameworkApplication.ta,function(){return new f})}).tc();this.fb.register(m,"Common.App.SaveToSharePoint.FileNameDialogFactory").Dc(function(){return new m(T.AFrameworkApplication.fa,
T.AFrameworkApplication.ub,T.AFrameworkApplication.ta,T.AFrameworkApplication.ta.Qa,V.fb.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),V.fb.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),V.fb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new w.a(function(){return V.HNc.result}),V.fb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),V.qra?V.qra.result:null)}).tc();this.fb.register(n,"Common.App.SaveToSharePoint.SaveToSharePointActor").Dc(function(){return new n(T.AFrameworkApplication.fa,
T.AFrameworkApplication.ub,V.fb.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),V.fb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),V.fb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),V.fb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),function(){return T.AFrameworkApplication.ta.MVg})}).tc();T.AFrameworkApplication.fa.qa("SaveToAnotherFolderBrsIsEnabled")&&this.fb.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Ag()};
c.main=function(){ma.a.instance.Qi(new c)};of.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveToSharePoint"}}});Object(t.a)(c,"PackageManager",null,[10,11]);b.d(E,"a",function(){return a})},1365:function(t,E,b){function a(){N.a.Fa(function(la){e.ka(la);c.ka(la)})}function c(la){var ka=Ba.call(this)||this;ka.$=la;ka.Eb();return ka}function d(la){la.da.Ga(446,this)}function e(la){return $a.call(this,la)||this}function h(la,ka){var ca=this;
this.sortOptions=this.ySa=this.selectedRange=null;this.rcf=!1;this.activeCell=this.De=this.rb=this.rc=null;this.onContentReady=function(){ca.nOf(!1);var Ia=ca.ha();Ia.sa.rg&&Ia.sa.Vc.equals(ca.ySa)&&(bb.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")?Ia.updateSelection(ca.selectedRange,ea.C(ca.activeCell),0,void 0,void 0,void 0,!0):Ia.updateSelection(ca.selectedRange,Ia.sa.activeCell,0,void 0,void 0,void 0,!0))};this.fNi=function(Ia,jb){Ia&&!ya.a.Dg(Ia.Errors)&&
ca.rc&&(ca.rc.Go=Ia.Result,ca.cLb(),ca.applyPivotSort(jb))};this.eNi=function(){};this.DUi=function(Ia,jb){jb&&jb.ULj&&bb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&(Ia=dc.d(ca.$.xa.pa),ca.VLj(new Jb.a(ea.B(jb),Ia)))};this.$=la;this.fkf="";this.namedSheetViewPublic=ka;this.gridView=pa.g(this.$);this.$.Fb.Mg("LoadResource","LoadDialogControlsStopwatch")}function k(la,ka,ca,Ia,jb,nb,Na){Na=la.Na(41,void 0===Na?null:Na);Na.filterRange=
ka;return Ab.g(la,"ReapplyAutoFilter",Na,ca,Ia,jb,nb,0)}function n(la,ka,ca,Ia,jb,nb,Na){Na=la.Na(41,void 0===Na?null:Na);Na.options=ka;return Ab.g(la,"Sort",Na,ca,Ia,jb,nb,0)}function f(la){this.filterRange=null;this.filterRange=la}function v(la){this.selection=null;this.selection=la}function m(la,ka,ca,Ia){var jb=Sa.call(this,la)||this;jb.uRd=!1;jb.ugc=!1;jb.L6=[];jb.Kei=function(nb,Na){var sa=jb.$7g(nb);jb.LLa(214,function(Wa,Hb,Yb){return Z.o(jb.$.oa.va,sa,jb.N_a(Wa,jb.BGh(Na)),jb.fU(Hb),Yb,null)},
16,!0)};jb.Jei=function(nb,Na,sa){nb=Z.n(jb.$.oa.va,Na,jb.mHh(Na,sa),jb.xNi,null,nb);jb.L6.push(nb)};jb.xNi=function(){K.ULS.sendTraceTag(529105632,0,10,"CustomSortDialog.OnGetSortConditionColorsOrIconsRequestFailure: GetSortConditionColorsOrIcons request failed.");jb.e7b(m.Erb())};jb.r6c=function(nb,Na){if(1===nb){nb=Na.sortRangeType;var sa={};sa.SortOptions=Na.sortOptions;sa.ShouldRestoreSelection=jb.uRd;sa.SelectedRange=jb.selectedRange;sa.OriginalActiveCell=jb.ipc;sa.TopCellAddress=jb.pTa;sa.ShouldPromptNamedSheetViewTeachingDialog=
bb.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures")?0===nb||3===nb:!1;if(!bb.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures")&&jb.Lyj(nb)){var Wa=jb.$;jb.namedSheetViewPublic.RAa().continueWith(function(Hb){Hb.result&&m.qLf(Wa,sa)})}else m.qLf(jb.$,sa)}else jb.uRd&&jb.Moa(jb.selectedRange,jb.ipc)};jb.a8h=function(nb,Na){jb.uRd=!0;jb.Moa(nb,Na)};jb.getColorName=function(nb){return Ua.a.sKa(oa.a.WG(nb))};K.ULS.shipAssertTag(529105669,
0,!!ka.ActiveCell);K.ULS.shipAssertTag(529105668,0,!!ka.SelectedRange);K.ULS.shipAssertTag(529105667,0,ea.D(ka.SelectedRange).contains(ea.C(ka.ActiveCell)));K.ULS.shipAssertTag(529105666,0,fa.a.equals(ka.SelectedRange.SheetName,ka.ActiveCell.SheetName,!0));bb.EwaSettings.isChangeGateEnabled("OfficeVSO:5963270_DialogMergeSuspension")&&(jb.ocb=new cb.a(la,pb.a.mch,function(){return jb.ugc},1));jb.selectedRange=ka.SelectedRange;jb.ipc=ka.ActiveCell;jb.rVg=ka.ExpandSelection;jb.namedSheetViewPublic=ca;
jb.pTa=Ia;jb.initializeAndShow(ja.a.instance.ga(183),jb.r6c,jb.ita(ka));return jb}function x(la,ka){la=La.call(this,la,ka)||this;la.jDb=la.tcd();la.qr();return la}function l(la,ka){var ca=la.SortRange;la=la.SortTopToBottom?ca.LastColumn-ca.FirstColumn:ca.LastRow-ca.FirstRow;return 0<=ka&&ka<=la}function u(la,ka){if(!la.SortColumnInfoItems)return K.ULS.sendTraceTag(537151618,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: SortColumnInfoItems is null"),!1;for(var ca=new aa.a,Ia=ik(la.SortColumnInfoItems),
jb=Ia.next();!jb.done;jb=Ia.next()){jb=jb.value;if(!l(la,jb.ColumnOffset))return K.ULS.sendTraceTag(537151617,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: offset ["+jb.ColumnOffset+"] is out of bounds. sort range: "+la.SortRange),!1;if(!jb.Name)return K.ULS.sendTraceTag(537151616,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: invalid column name for offset ["+jb.ColumnOffset+"]"),!1;if(jb.CellColors&&!jb.CellColors.length)return K.ULS.sendTraceTag(537151587,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: cell colors are not null but length = ["+
jb.CellColors.length+"]"),!1;if(jb.TextColors&&!jb.TextColors.length)return K.ULS.sendTraceTag(537151586,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: text colors are not null but length = ["+jb.TextColors.length+"]"),!1;if(jb.Icons&&!jb.Icons.length)return K.ULS.sendTraceTag(537151585,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: icons are not null but length = ["+jb.Icons.length+"]"),!1;ca.add(jb.ColumnOffset)}if(la.SortConditions)for(Ia=ik(la.SortConditions),jb=Ia.next();!jb.done;jb=
Ia.next())if(jb=jb.value,!ca.contains(jb.RowColOffset))return K.ULS.shipAssertTag(537151584,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: missing column info item for sort condition ["+jb.RowColOffset+"]"),!1;if(la.HeaderColumnInfoItems){if(la.HeaderColumnInfoItems.length!==la.SortColumnInfoItems.length)return K.ULS.shipAssertTag(537151583,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo length doesn't match sort column info length"),!1;for(ca=0;ca<la.HeaderColumnInfoItems.length;++ca){Ia=
la.HeaderColumnInfoItems[ca];if(ka&&Ia.ColumnOffset!==la.SortColumnInfoItems[ca].ColumnOffset)return K.ULS.shipAssertTag(537151582,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo item offset doesn't match sort columnInfo item offset."),!1;if(Ia.CellColors&&1<Ia.CellColors.length)return K.ULS.sendTraceTag(537151581,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.CellColors is not null and has more than 1 background color"),!1;if(Ia.TextColors&&1<Ia.TextColors.length)return K.ULS.sendTraceTag(537151580,
0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.TextColors is not null and has more than 1 font color"),!1;if(Ia.Icons&&1<Ia.Icons.length)return K.ULS.sendTraceTag(537151579,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.Icons is not null and has more than 1 icon"),!1}}return!0}function A(la){if(!la.SortConditions)return!0;for(var ka=ik(la.SortConditions),ca=ka.next();!ca.done;ca=ka.next()){ca=ca.value;if(!l(la,ca.RowColOffset))return K.ULS.sendTraceTag(537151620,
0,10,"SharedSortInfoResultExtension.VerifySortConditions: offset ["+ca.RowColOffset+"] is out of bounds. sort range: "+la.SortRange),!1;if(1===ca.SortConditionType&&ca.FillGradient&&!y.isValid(ca.FillGradient))return K.ULS.sendTraceTag(537151619,0,10,"SharedSortInfoResultExtension.VerifySortConditions: sortCondition contains invalid fillGradient"),!1}return!0}function z(la){return la.SortRange?4===la.SortRangeType?(K.ULS.sendTraceTag(537151622,0,10,"SharedSortInfoResultExtension.VerifySortRange: Unsupported sort range type: "+
la.SortRangeType),!1):2===la.SortRangeType&&la.SortTopToBottom&&(null==la.HeaderRowSize||0>la.HeaderRowSize)?(K.ULS.sendTraceTag(537151621,0,10,"SharedSortInfoResultExtension.VerifySortRange: header row size must be equal or greater than 1, when range is sheetrange"),!1):!0:(K.ULS.sendTraceTag(537151623,0,10,"SharedSortInfoResultExtension.VerifySortRange: sort range is null"),!1)}function y(){}function w(la,ka,ca,Ia){new Sys.UI.Point(la,ka);new Sys.UI.Point(ca,Ia)}function D(){}function H(la,ka,ca,
Ia){la=la.HeaderColumnInfo;return Ia||la?2===ka&&ca?la.CellColors&&1!==la.CellColors.length?(K.ULS.sendTraceTag(537151626,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.CellColors should be null or have exactly 1 color."),!1):la.TextColors&&1!==la.TextColors.length?(K.ULS.sendTraceTag(537151625,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.TextColors should be null or have exactly 1 color"),!1):la.Icons&&
1!==la.Icons.length?(K.ULS.sendTraceTag(537151624,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.Icons should be null or have exactly 1 icon"),!1):!0:la?(K.ULS.sendTraceTag(537151627,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo should be null when range type is not SheetRange, or when headerRowSize"+ca+" == 0."),!1):!0:!0}function F(la,ka){la=la.ColumnInfo;switch(ka){case 1:return la.CellColors&&la.CellColors.length?
!0:(K.ULS.sendTraceTag(537151631,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on cell color result cell colors is null or there are no colors (must have at least 1)."),!1);case 2:return la.TextColors&&la.TextColors.length?!0:(K.ULS.sendTraceTag(537151630,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on font color result text colors is nullor there are no colors (must have at least 1)."),!1);case 3:return la.Icons&&la.Icons.length?!0:(K.ULS.sendTraceTag(537151629,
0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on icon result icons is nullor there are no icons (must have at least 1)."),!1);default:return K.ULS.sendTraceTag(537151628,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: illeagl sort condition type."),!1}}function J(la){var ka=this;this.Xv=function(ca){switch(ca){case 0:ka.NNa("Cancel");break;case 1:ka.NNa("Expand and sort");ka.CRe(!0);break;case 2:ka.NNa("Just sort"),ka.CRe(!1)}};this.CRe=la}function S(la){this.options=
null;this.options=la}var N=b(10);t=b(0);var T=b(915),G=b(50),I=b(37),K=b(15),L=b(1285),O=b(154),B=b(24),Q=b(76),U=b(54);Object(t.a)(S,"MacroRecorderRangeCustomSortedPayload",null,[430]);var X=b(1174),P=b(1175),ea=b(41),ia=b(572),da=b(394),xa=b(177),Z=b(259),ha=b(151),ya=b(31),va=b(299),bb=b(1),ba=b(187),fa=b(22),ra=b(298),pa=b(21),Za=b(1021),Ua=b(972),Ma=b(276),oa=b(220),ja=b(14),ta=b(135);J.prototype.show=function(){var la=new ta.StandardDialog;la.Rb=11;la.kc(1,ja.a.instance.ga(2108));la.kc(2,ja.a.instance.ga(2109));
la.z4f(ja.a.instance.ga(2107),ja.a.instance.Xa(649),this.Xv)};J.prototype.NNa=function(la){K.ULS.sendTraceTag(594125219,0,50,"ExpandSortSelectionDialog: user operation: "+la)};Object(t.a)(J,"ExpandSortSelectionDialog",null,[]);var aa=b(192);D.isValid=function(la){return D.Nyh.includes(la.Position)?!0:(K.ULS.shipAssertTag(537159826,0,!1,"FillGradientStopExtension.IsValid: unexpected position value ["+la.Position+"]"),!1)};D.Nyh=[0,.5,1];Object(t.a)(D,"FillGradientStopExtension",null,[]);Object(t.a)(w,
"GradientLine",null,[]);y.isValid=function(la){if(!(la.Degree.toString()in y.Lyh))return K.ULS.shipAssertTag(537159829,0,!1,"FillGradientExtension.IsValid: unexpected degree value ["+la.Degree+"]"),!1;if(!la.GradientStops)return K.ULS.shipAssertTag(537159828,0,!1,"FillGradientExtension.IsValid: no gradient stops"),!1;if(la.GradientStops.length<y.IBi||la.GradientStops.length>y.sAi)return K.ULS.shipAssertTag(537159827,0,!1,"FillGradientExtension.IsValid: unexpected number of gradient stops ["+la.GradientStops.length+
"]"),!1;la=ik(la.GradientStops);for(var ka=la.next();!ka.done;ka=la.next())if(!D.isValid(ka.value))return!1;return!0};y.IBi=2;y.sAi=3;var ma={};y.Lyh=(ma["0"]=new w(0,0,1,0),ma["180"]=new w(1,0,0,0),ma["90"]=new w(0,0,0,1),ma["270"]=new w(0,1,0,0),ma["45"]=new w(0,0,1,1),ma["225"]=new w(1,1,0,0),ma["135"]=new w(1,0,0,1),ma["315"]=new w(0,1,1,0),ma);Object(t.a)(y,"FillGradientExtension",null,[]);ma=b(404);var Ea=b(133),Ha=b(98),Aa=b(95),V=b(134),La=ma.a;$k(x,La);x.prototype.nO=function(la,ka){if(1===
la){var ca=ea.v(this.jDb,this.$);pa.g(this.$).hg(ca,null,null,null,0,Aa.a.IEj)}ca={};ca=(ca.DialogButton=la,ca.Location="dialog",ca);V.b(this.$).yd(Ea.a.KEj,ca,null,!0);La.prototype.nO.call(this,la,ka)};x.prototype.qr=function(){La.prototype.qr.call(this);var la=this.GEj();this.Rb=1;this.kc(1,ja.a.instance.ga(2223));this.rl(ja.a.instance.ga(2224),Ha.a.rh(la),1,this.Q0)};x.prototype.GEj=function(){return String.format(ja.a.instance.mb(170),this.jDb.toString())};x.prototype.tcd=function(){var la=this.error.Description.split("_");
return new B.Range(Number.parseInvariant(la[1])+1,Number.parseInvariant(la[2])+1,Number.parseInvariant(la[3])+1,Number.parseInvariant(la[4])+1,!0,!1)};of.Object.defineProperties(x.prototype,{mc:{configurable:!0,enumerable:!0,get:function(){return"SortMergedCellsErrorDialog"}}});Object(t.a)(x,"SortMergedCellsErrorDialog",ma.a,[]);var Ra=b(68),pb=b(648),cb=b(715),Sa=Za.a;$k(m,Sa);m.prototype.dispose=function(){this.ugc||(this.ugc=!0,this.c2b(),this.L6=null,bb.EwaSettings.isChangeGateEnabled("OfficeVSO:5963270_DialogMergeSuspension")&&
(this.ocb.dispose(),this.ocb=null));Sa.prototype.dispose.call(this)};m.prototype.BGh=function(la){var ka=this;return function(ca){if(va.b(ca,-901005882))Ra.a(ka.$).dd.eJ(-901005882),ka.OFd();else if(va.b(ca,-569193796))Ra.a(ka.$).dd.eJ(-569193796),ka.hide(),new x(ka.$,ca.Errors[0]);else if(va.a(ca))K.ULS.sendTraceTag(529105665,0,10,"CustomSortDialog.GenerateGetSortInfoSuccessCallback: GetSortInfo result contains non-status messages"),ka.hide();else{ca=ca.Result;ka.$.Oj(ca.SortRange);var Ia=bb.EwaSettings.isChangeGateEnabled("OfficeVSO:4545720_FixingSharedSortInfoResultExtension");
ca&&z(ca)&&A(ca)&&u(ca,Ia)?la(ca):ka.e7b(m.Erb())}}};m.prototype.mHh=function(la,ka){var ca=this;return function(Ia,jb){if(ca.ugc)K.ULS.sendTraceTag(529105635,0,50,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: response was received after dialog is disposed");else if(!Ia||va.a(Ia))K.ULS.sendTraceTag(529105634,0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: Unexpected error: "+ya.a.Cc(Ia.Errors)),ca.$.ea.fp(Ia.Errors),ca.hide();else{Ia=Ia.Result;
var nb=la.RangeType,Na=la.HeaderRowSize,sa=la.SortTopToBottom;Ia&&F(Ia,la.ConditionType)&&H(Ia,nb,Na,sa)?(Ia.ColumnInfo.ColumnOffset=jb,void 0!==Ia.HeaderColumnInfo&&null!==Ia.HeaderColumnInfo&&(Ia.HeaderColumnInfo.ColumnOffset=jb),ka(Ia,la.ConditionType,la.SortTopToBottom)):(K.ULS.sendTraceTag(529105633,0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: sortConditionColorsOrIconsResult is not valid"),ca.e7b(m.Erb()))}}};m.prototype.Lyj=function(la){return!!this.namedSheetViewPublic&&
(0===la||3===la)};m.prototype.$7g=function(la){var ka={};ka.SelectedRange=this.selectedRange;ka.ActiveCell=this.ipc;ka.SortInfoMode=la;ka.ExpandSortSelection=this.rVg;ka.ExpandSortSelectionSupported=!0;return ka};m.prototype.ita=function(la){var ka={};ka[Ma.a.Hu]=this.mc;ka.fromAutoFilter=la.FromAutoFilter;ka.gridRTL=pa.g(this.$).rtl;ka.activeCell=la.ActiveCell;ka.selectedRange=la.SelectedRange;ka.invokeGetSortInfo=this.Kei;ka.invokeGetSortConditionColorsOrIcons=this.Jei;ka.highlightSortRange=this.a8h;
ka.getColorName=this.getColorName;return ka};m.prototype.Moa=function(la,ka){la=ea.D(la);this.ha.sa.Vc.equals(la)||this.ha.updateSelection(la,ea.C(ka),0,void 0,void 0,void 0,!0)};m.prototype.OFd=function(){var la=this;(new J(function(ka){var ca={};ca.ActiveCell=la.ipc;ca.SelectedRange=la.selectedRange;ca.ExpandSelection=ka;ca.FromAutoFilter=!1;ka={};la.$.Cd(-207540907,Q.a.Cb,8,(ka.SortCommandData=ca,ka))})).show()};m.prototype.c2b=function(){if(void 0!==this.L6&&null!==this.L6)for(var la=ik(this.L6),
ka=la.next();!ka.done;ka=la.next())this.$.oa.va.bfb(ka.value.Gt)};m.qLf=function(la,ka){var ca={};la.Cd(1659552324,Q.a.Cb,8,(ca.CustomSortCommandData=ka,ca))};m.Erb=function(){return ya.a.Xc(1,0,26,0,1,-1517197771,"CustomSortValidationError")};of.Object.defineProperties(m.prototype,{mc:{configurable:!0,enumerable:!0,get:function(){return"CustomSortDialog"}},ha:{configurable:!0,enumerable:!0,get:function(){return pa.g(this.$).ha}}});Object(t.a)(m,"CustomSortDialog",Za.a,[]);var Db=b(1286);v.prototype.getSelection=
function(){return this.selection};Object(t.a)(v,"MacroRecorderRangeAutoFilterClearedPayload",null,[430]);Object(t.a)(f,"MacroRecorderRangeFilterReappliedPayload",null,[430]);var Ab=b(62),Wb=b(993),ub=b(994),vb=b(112),Ka=b(58),eb=b(1287),yb=b(208),oc=b(36),Jb=b(359),dc=b(64);h.prototype.Nc=function(la,ka){return!this.kqd(la,ka)};h.prototype.executeCommand=function(la,ka,ca){var Ia=null;la=ka.command;switch(la){case -864298118:Ia=this.lih(ka,ca);break;case -1010737776:Ia=this.W6c(!0,ka,ca);break;case 2123420468:Ia=
this.W6c(!1,ka,ca);break;case -1089513346:ca=this.uYe(ca);if(!this.KAb([ea.D(ca.SortOptions.SelectedRange)]))return I.TaskExtensions.kk();Ia=this.XIe(ka,ca);break;case -1032691499:case -764711886:case -2016161444:Ia=this.n3i(ka,ca);break;case -207540907:case -1677817820:Ia=this.gridView.Ab.n5(this.ha().sa.activeCell)?this.d3i():this.a3i(ka,ca);break;case 1659552324:Ia=this.XIe(ka,this.uYe(ca));break;case 368460465:Ia=this.Bih(ka,ca);break;case 529856798:Ia=this.gih(ka);break;case 644342024:Ia=this.wih(ka)}return Ia||
ba.a(la)};h.prototype.Ac=function(la,ka){if(la=1===la)switch(ka.command){case -864298118:case -1010737776:case 2123420468:case -1089513346:case -207540907:case -1677817820:case 1659552324:case 368460465:case 529856798:case 644342024:break;case -1032691499:case -764711886:case -2016161444:la=bb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PutSelectedItemOnTop",!1);break;default:la=!1}return la};h.prototype.Tc=function(){return!1};h.prototype.ha=function(){return this.$&&this.gridView?
this.gridView.ha:null};h.prototype.nOf=function(la){la?this.gridView.Au(this.onContentReady):this.gridView.ny(this.onContentReady);this.rcf=la};h.prototype.Ozj=function(la){return!!this.sortOptions&&fa.a.equals(this.fkf,la.lia,!0)};h.prototype.kqd=function(la,ka){var ca=pa.g(this.$).ha.sa.selectedRanges;return(new ha.a(this.$.xa)).zm(la,ka,ca,this.gridView)};h.prototype.W6c=function(la,ka,ca){var Ia=new L.a;bb.EwaSettings.isChangeGateEnabled("OfficeVSO:6496842_createDefaultSortOptions")?this.I$e(Ia,
ca,la):(Ia.OperationType=0,Ia.IsAscending=la,Ia.HasHeader=!0,Ia.GuessHeader=!0,Ia.SortTopToBottom=!0,Ia.ExpandSortSelectionSupported=!0,ca&&void 0!==ca[h.$na]&&null!==ca[h.$na]?(ca=ca[h.$na],Ia.ActiveCell=ca.ActiveCell,Ia.SelectedRange=ca.SelectedRange,Ia.ExpandSortSelection=ca.ExpandSelection):(Ia.ActiveCell=ea.o(this.sa.activeCell,this.$),Ia.SelectedRange=ea.v(this.sa.Vc,this.$),Ia.ExpandSortSelection=null));return this.KAb([ea.D(Ia.SelectedRange)])?this.gridView.Ab.n5(ea.D(Ia.SelectedRange))?this.tih(la):
this.rmd(Ia,ka):I.TaskExtensions.kk()};h.prototype.lih=function(la,ka){K.ULS.shipAssertTag(520901652,0,!1,"SortCommandHandler.doDefaultSort: using default sort");var ca=null,Ia=this.ha();Ia&&(this.Ozj(Ia)?this.KAb(Ia.sa.selectedRanges)&&(this.sortOptions.IsAscending=!this.sortOptions.IsAscending,ca=this.rmd(this.sortOptions,la)):ca=this.W6c(!0,la,ka));return ca};h.prototype.KAb=function(la){return bb.EwaSettings.isChangeGateEnabled("OfficeVSO:6516289_SheetProtectionSettings")&&(bb.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")||
this.$.isEditMode)?this.$.isEditMode?this.$.iq(la,!0,1):this.$.VWc(la,!0,1):!0};h.prototype.tih=function(la){this.fVh(la);return Ka.Task.Ua(!0)};h.prototype.bSg=function(la){if(bb.EwaSettings.isChangeGateEnabled("OfficeVSO:4112173_MacroRecorderTableSortOnRange")){var ka=this.gridView.Ab.dk(this.sa.Vc,!1);if(ka)return new P.a(ka.name,this.sa.activeCell.left-ka.usedRange.left,la.IsAscending)}return new X.a(la)};h.prototype.rmd=function(la,ka){function ca(){return Ia.bSg(la)}var Ia=this;this.gridView.ig.HG(!1);
return this.l8c(function(jb,nb,Na){return n(Ia.$.oa.va,la,ra.b(jb,Ia.nHh(ka)),nb,Na,la)},function(jb){return new xa.a(141,0,jb,void 0,ca)},ka,this.Kyj(la))};h.prototype.Kyj=function(la){if(!this.namedSheetViewPublic)return!1;var ka=this.sa.Vc,ca=ea.v(this.sa.Vc,this.$),Ia=this.gridView.Ab.CMa(ka,!0),jb=this.sa.Rba()&&this.gridView.Ab.igf(ca),nb=this.gridView.Ab.lmi(ca);la=(ka.x5||ka.l_)&&!ka.isSingle&&(null==la.ExpandSortSelection?!1:la.ExpandSortSelection)&&this.gridView.Ab.igf(ca);return Ia||jb||
nb||la};h.prototype.d3i=function(){return this.$.Cd(-1556797033,Q.a.Cb,8,null)};h.prototype.a3i=function(la,ka){la=8===la.Ne&&ka&&void 0!==ka[h.$na]&&null!==ka[h.$na]?ka[h.$na]:19===la.Ne&&ka&&void 0!==ka[Q.a.Wf]&&null!==ka[Q.a.Wf]?U.a.Wh(ka[Q.a.Wf]):this.c7g();if(!this.KAb([ea.D(la.SelectedRange)]))return I.TaskExtensions.kk();pa.g(this.$).ig.HG(!1);var ca=null;(ka=ka.TopCellAddress)&&(ca=ea.o(ka,this.$));new m(this.$,la,this.namedSheetViewPublic,ca);return Ka.Task.Ua(!0)};h.prototype.uYe=function(la){return la[h.lch]};
h.prototype.XIe=function(la,ka){function ca(Wa){return new xa.a(187,0,Wa,void 0,Ia)}function Ia(){return new S(ka.SortOptions)}function jb(Wa,Hb,Yb){return n(sa.$.oa.va,ka.SortOptions,ra.b(Wa,Na),ra.a(Hb,nb),Yb,sa.sortOptions)}function nb(){ka.ShouldRestoreSelection&&sa.Moa(ka.SelectedRange,ka.OriginalActiveCell);K.ULS.sendTraceTag(537151575,0,10,"SortCommandHandler.DoCustomSort.onSortFailedCallback: Custom Sort failed. Called from: "+la.Ne)}function Na(Wa){bb.EwaSettings.isChangeGateEnabled("OfficeVSO:5899794_MergedCellsErrorFix")&&
sa.f7e(Wa)?sa.S5e(Wa.Errors[0]):(ka.ShouldRestoreSelection&&sa.Moa(ka.SelectedRange,ka.OriginalActiveCell),K.ULS.sendTraceTag(537151576,0,50,"SortCommandHandler.DoCustomSort.onSortSuccessCallback: Custom Sort succeeded. Called from: "+la.Ne),sa.RNj(ka))}var sa=this;return bb.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures")?this.l8c(jb,ca,null,ka.ShouldPromptNamedSheetViewTeachingDialog):da.a(this.$.userOperationManager,jb,ca,null)};h.prototype.Moa=function(la,
ka){la=ea.D(la);pa.g(this.$).ha.sa.Vc.equals(la)||pa.g(this.$).ha.updateSelection(la,ea.C(ka),0,void 0,void 0,void 0,!0)};h.prototype.c7g=function(){var la={};la.ActiveCell=ea.o(this.sa.activeCell,this.$);la.SelectedRange=ea.v(this.sa.Vc,this.$);la.FromAutoFilter=!1;la.ExpandSelection=null;return la};h.prototype.Bih=function(la,ka){function ca(){return new Db.a(jb)}var Ia=this,jb=this.Taa();if(!jb)return Ka.Task.Ua(!1);var nb=this.$.oa.va.Pb();return bb.EwaSettings.Zb()?da.a(this.$.userOperationManager,
function(Na,sa,Wa){return Z.A(Ia.$.oa.va,jb,ra.b(Wb.a.Bva(vb.a.QZa,ub.a.toggleAutoFilter,Na),Ia.DUi),sa,Wa,{selection:jb,ULj:ka.On},nb)},function(Na){return new xa.a(516,0,Na,64,ca)},la):da.a(this.$.userOperationManager,function(Na,sa,Wa){return Z.A(Ia.$.oa.va,jb,Wb.a.Bva(vb.a.QZa,ub.a.toggleAutoFilter,Na),sa,Wa,null,nb)},function(Na){return new ia.a(516,0,Na,void 0,ca)},la)};h.prototype.gih=function(la){function ka(){return new v(Ia)}var ca=this,Ia=this.Taa();if(!Ia)return Ka.Task.Ua(!1);var jb=
this.gridView.Ab.dk(this.sa.Vc,!0);jb&&K.ULS.sendTraceTag(537151574,0,50,"DoClearAutoFilter for namedObject: Type : "+jb.type.toString());var nb=this.$.oa.va.Pb();jb=bb.EwaSettings.Zb()?function(Na){return new xa.a(517,0,Na,64,ka)}:function(Na){return new ia.a(517,0,Na,void 0,ka)};return this.l8c(function(Na,sa,Wa){var Hb=ca.$.oa.va;Na=Wb.a.Bva(vb.a.ksa,ub.a.clearAutoFilter,Na);var Yb=Hb.Na(41,void 0===nb?null:nb);Yb.selectedRange=Ia;return Ab.g(Hb,"ClearAutoFilter",Yb,Na,sa,Wa,null,0)},jb,la)};h.prototype.l8c=
function(la,ka,ca,Ia){var jb=this;return this.namedSheetViewPublic&&(void 0===Ia||Ia)?this.namedSheetViewPublic.RAa().continueWith(function(nb){nb.result&&da.a(jb.$.userOperationManager,la,ka,ca)}):da.a(this.$.userOperationManager,la,ka,ca)};h.prototype.wih=function(la){function ka(){return new f(Ia)}var ca=this,Ia=this.Taa();if(!Ia)return Ka.Task.Ua(!1);var jb=this.$.oa.va.Pb();return bb.EwaSettings.Zb()?da.a(this.$.userOperationManager,function(nb,Na,sa){return k(ca.$.oa.va,Ia,Wb.a.Bva(vb.a.ksa,
ub.a.RLf,nb),Na,sa,null,jb)},function(nb){return new xa.a(518,0,nb,64,ka)},la):da.a(this.$.userOperationManager,function(nb,Na,sa){return k(ca.$.oa.va,Ia,Wb.a.Bva(vb.a.ksa,ub.a.RLf,nb),Na,sa,null,jb)},function(nb){return new ia.a(518,0,nb,void 0,ka)},la)};h.prototype.nHh=function(la){var ka=this;return function(ca,Ia){var jb;va.b(ca,-901005882)?(Ra.a(ka.$).dd.eJ(-901005882),ka.OFd(Ia,la.command)):ka.f7e(ca)?ka.S5e(ca.Errors[0]):!va.a(ca)&&ca.Result&&(ka.sortOptions=Ia,ka.ySa=ea.D(ca.Result.ActualSortRange),
ka.fkf=ka.ha().lia,ka.rcf||(ka.selectedRange=ka.sa.Vc,ka.selectedRange.equals(ka.ySa)||(bb.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")&&(ka.activeCell=ea.o(ka.sa.activeCell,ka.$)),ka.UCj())),(null===(jb=ka.sortOptions)||void 0===jb?0:jb.ActiveCell)&&(!bb.EwaSettings.isChangeGateEnabled("OfficeVSO:6611537_shouldTriggerPivotTableHandRaise")||ka.l3f(ka.sortOptions))&&(ca=ka.sortOptions.ActiveCell,ca=new B.Range(ca.FirstRow+1,ca.FirstColumn+1,ca.FirstRow+
1,ca.FirstColumn+1,!0,!1),ka.nL(ca),ka.hXd(ca)))}};h.prototype.f7e=function(la){return va.b(la,-569193796)};h.prototype.S5e=function(la){Ra.a(this.$).dd.eJ(-569193796);new x(this.$,la)};h.prototype.OFd=function(la,ka){var ca=this;(new J(function(Ia){var jb={};jb.ActiveCell=la.ActiveCell;jb.SelectedRange=la.SelectedRange;jb.ExpandSelection=Ia;Ia={};ca.$.Cd(ka,Q.a.Cb,8,(Ia[h.$na]=jb,Ia))})).show()};h.prototype.UCj=function(){var la=this.ha();if(bb.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")){var ka=
ea.C(this.activeCell);this.ySa.ze(ka)||(ka=this.ySa.topLeft);la.updateSelection(this.ySa,ka,0,void 0,void 0,void 0,!0)}else la.updateSelection(this.ySa,la.sa.activeCell,0,void 0,void 0,void 0,!0);this.nOf(!0)};h.prototype.Taa=function(){var la=this.ha();if(!la)return K.ULS.shipAssertTag(537151573,0,!!la,"SelectionManger is null"),null;this.gridView.ig.HG(!1);return ea.v(la.sa.Vc,this.$)};h.prototype.cLb=function(){this.rc&&this.rc.Go&&(this.De=this.rc.Go,this.rb=this.rc.abc())};h.prototype.fVh=function(la){var ka=
this;if(this.$.isEditMode&&(this.rc=this.gridView.Ab.Ro(this.sa.activeCell))){this.activeCell=ea.o(this.sa.activeCell,this.$);if(this.rc&&this.rc.Go){var ca=this.rc.Go.CurrentCol;if(this.rc.Go.CurrentRow===this.activeCell.FirstRow&&ca===this.activeCell.FirstColumn){this.cLb();this.applyPivotSort(la);return}}this.$.oa.va.Pb();ca=new xa.a(228,0,function(Ia,jb,nb){return Z.k(ka.$.oa.va,ka.activeCell,ra.b(Ia,ka.fNi),ra.a(jb,ka.eNi),nb,la)},16);this.$.userOperationManager.Sb(ca,null)}};h.prototype.applyPivotSort=
function(la){var ka=this;if(this.rc&&this.rb&&this.activeCell&&this.De){var ca=8===this.De.CellArea,Ia=1===this.De.CellArea||2===this.De.CellArea;(ca||Ia)&&8!==this.De.CellType&&4!==this.De.CellType&&(ca?da.a(this.$.userOperationManager,function(jb,nb,Na){return Z.b(ka.$.oa.va,ka.activeCell,la?1:2,ka.rb.Caption,jb,nb,Na,null)},function(jb){return new xa.a(1015,0,jb,void 0,null)},null):(ca=1===this.De.CellArea?1:2,this.$.ma(696)?O.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,
this.rc.externalSourceIndex,this.rb.Index.toString(),this.rb.Caption,this.rc.isOlap?"":this.rb.Caption,ca,la):O.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.rc.externalSourceIndex,this.rb.Index.toString(),la)))}};h.prototype.RNj=function(la){this.l3f(la.SortOptions)&&(la.TopCellAddress?la=ea.C(la.TopCellAddress):(la=la.OriginalActiveCell,la=new B.Range(la.FirstRow+1,la.FirstColumn+1,la.FirstRow+1,la.FirstColumn+1,!0,!1)),this.nL(la))};h.prototype.nL=function(la){oc.a.Oba(this.$)&&
I.TaskExtensions.Aa(G.GetServiceTaskFactory.Ra(this.$.da,430,431,1),function(ka){ka.result.vea(la);K.ULS.sendTraceTag(537151571,306,50,"SortCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.la,3)};h.prototype.hXd=function(la){bb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",!1)&&I.TaskExtensions.Aa(G.GetServiceTaskFactory.Ra(this.$.da,476,475,0),function(ka){ka.result.hXd(la,0);K.ULS.sendTraceTag(537151570,0,50,"SortCommandHandler:TriggerProactiveSuggestion Trigger proactive suggestion from sort.")},
this.$.la,3)};h.prototype.n3i=function(la,ka){if(!this.KAb(this.sa.selectedRanges))return I.TaskExtensions.kk();var ca=new L.a;this.I$e(ca,ka);ca.SortConditions=[this.r$g(la)];ca.OperationType=2;return this.rmd(ca,la)};h.prototype.r$g=function(la){var ka=this.gridView.Ub(this.sa.activeCell),ca=new eb.a;ca.IsAscending=!0;switch(la.command){case -1032691499:ka.exb?(la=yb.a.Po(ka.backgroundColor),ca.SortColor=la.oS(!0)):ca.SortColor=h.NoColor;ca.SortConditionType=1;break;case -764711886:ca.SortColor=
ka.q1c===h.NoColor?h.NoColor:yb.a.Ite(ka.q1c);ca.SortConditionType=2;break;case -2016161444:ka.mxb?(ca.SortIcon=ka.cell.gjc,ca.SortIconSet=ka.hjc):(ca.SortIcon=h.T0d,ca.SortIconSet=h.T0d);ca.SortConditionType=3;break;default:K.ULS.debugAssertTag(522723787,0,!1,"SortCommandHandler.createSortConditionsFromSelectedCell: ribbon command didn't match any of the case statements")}return ca};h.prototype.VLj=function(la){I.TaskExtensions.Aa(G.GetServiceTaskFactory.Ra(this.$.da,426,427,1),function(ka){ka.result.dXd(la,
"Filter")},this.$.la,3)};h.prototype.I$e=function(la,ka,ca){la.OperationType=0;la.IsAscending=void 0===ca?!0:ca;la.HasHeader=!0;la.GuessHeader=!0;la.SortTopToBottom=!0;la.ExpandSortSelectionSupported=!0;ka&&ka[h.$na]?(ka=ka[h.$na],la.ActiveCell=ka.ActiveCell,la.SelectedRange=ka.SelectedRange,la.ExpandSortSelection=ka.ExpandSelection):(la.ActiveCell=ea.o(this.sa.activeCell,this.$),la.SelectedRange=ea.v(this.sa.Vc,this.$),la.ExpandSortSelection=null)};h.prototype.l3f=function(la){return!la.SortConditions||
la.SortConditions.some(function(ka){return 0===ka.SortConditionType})};of.Object.defineProperties(h.prototype,{sa:{configurable:!0,enumerable:!0,get:function(){return this.ha().sa}}});h.lch="CustomSortCommandData";h.$na="SortCommandData";h.T0d=-1;h.NoColor=0;Object(t.a)(h,"SortCommandHandler",null,[401]);var $a=T.a;$k(e,$a);e.prototype.zd=function(){var la=this;I.TaskExtensions.Aa(G.GetServiceTaskFactory.Ra(this.$.da,309,310,this.hb),function(ka){la.jd([new h(la.$,ka.result)])},this.$.la,3)};e.ka=
function(la){T.a.Pd(160,new e(la))};Object(t.a)(e,"SortCommandHandlerFactory",T.a,[]);Za=b(235);d.prototype.Aah=function(la,ka){new x(la,ka)};Object(t.a)(d,"SortUtil",null,[516]);var Ba=Za.a;$k(c,Ba);c.prototype.create=function(){var la=this.$.da.za(446);la||(la=new d(this.$),this.$.da.Ga(446,la));this.pb(la)};c.ka=function(la){la.da.Ga(447,new c(la))};Object(t.a)(c,"SortUtilFactory",Za.a,[]);b.d(E,"a",function(){return a})},1375:function(t,E,b){function a(){A.a.Fa(function(Ea){c.ka(Ea);l.ka(Ea)})}
function c(Ea){var Ha=ma.call(this)||this;Ha.$=Ea;Ha.Eb();return Ha}function d(Ea){var Ha=this;this.zoa=this.qVe=this.$Gb=this.x2a=this.Eqc=this.Xca=this.FPa=null;this.yqd=this.OOb=this.WLd=!1;this.hMb=!0;this.Agc=!1;this.ySd=!0;this.NOb=this.c1a=this.KBe=0;this.svc={};this.upc={};this.tpc={};this.HIf=0;this.m7a=this.O9d=!1;this.ybj=function(){ia.DOMElementExtensions.toggleCssClass(Ha.$.Sq,"ewr-presentMode-transition",!1);$removeHandler(Ha.x2a,"transitionend",Ha.zoa)};this.Ni=function(){parseInt(Ha.$.Rv.style.right,
10)!==Ha.KBe&&window.requestAnimationFrame(function(){Ha.MBc(0);Ha.$.zza(B.a.BZ("PresentModeManager.OnContentAreaResized"))})};this.Pya=function(){var Aa=Object(I.a)(xa.a,Ha.$.pa);if(Aa&&Ha.nz){Ha.gridView.vod=!1;Aa=Aa.headersVisible;var V=ha.g(Ha.$).rtl;ia.DOMElementExtensions.toggleCssClass(Ha.$.Sq,"ewr-presentMode-on-headers-off",!Aa);ia.DOMElementExtensions.toggleCssClass(Ha.$.Sq,"ewr-presentMode-on-rtl",V);(12!==Ha.c1a&&!Aa||32!==Ha.c1a&&Aa&&!V||0!==Ha.c1a&&Aa&&V)&&window.requestAnimationFrame(function(){Ha.MBc(2)})}};
this.Yc=function(){Ha.fbf();Ha.Ng("OnWorkbookOpened");S.ULS.sendTraceTag(537154323,0,50,"PresentModeManager.OnWorkbookOpened: Silent reload happened during present mode")};this.ep=function(){Ha.yqd=!0;Ha.Cea("OnSelectionStarted")};this.tg=function(){Ha.yqd=!1;Ha.Cea("OnSelectionEnded");Ha.dWf()};this.Fh=function(){Ha.Cea("OnEditStarted")};this.Ef=function(){Ha.Cea("OnEditEnded")};this.tw=function(){if(!Ha.Agc){var Aa=D.EwaSettings.isChangeGateEnabled("OfficeVSO:5411756_FlickerFixForPresentModeOverlay");
Ha.Cea("OnVisibleAreaChanged",!0,Aa)}};this.wEb=function(){Ha.Agc=!0};this.ap=function(){Ha.Cea("OnCurrentSelectionModeChanged");Ha.dWf();Ha.Ng("OnCurrentSelectionModeChanged")};this.Dm=function(){Ha.Cea("OnBlockCacheItemEvicted")};this.ff=function(){Ha.Cea("OnBlockCacheItemChanged")};this.nF=function(){Ha.Agc||Ha.Cea("OnActiveItemPanesChanged")};this.wh=function(){Ha.Agc=!1;Ha.Xca.Ng("ActiveSheetChanged");Ha.Pya()};this.DFb=function(Aa,V){if(Aa=Object(I.a)(xa.a,V.item))Aa.jqb(16,!0),Aa.Onb(Ha.Pya)};
this.PLi=function(){e.pji||(Ha.Eqc&&Ha.Eqc.vq&&Ha.Eqc.hide(),ha.g(Ha.$).isEditing&&ha.g(Ha.$).xo(!0),Ha.$xc(!1),S.ULS.sendTraceTag(537154321,0,50,"PresentModeManager.OnFullScreenChangeEventHandler: Esc pressed to exit present mode"))};this.QLi=function(){S.ULS.sendTraceTag(537154320,0,10,"PresentModeManager.OnFullScreenErrorEventHandler: Error handling full screen mode")};this.$=Ea;this.gridView=ha.g(this.$);this.$lj=Ea.ya.PresentModeRenderUpdateTimeout;this.initialize(Ea)}function e(){}function h(Ea,
Ha){var Aa=ta.call(this,Ea)||this;Aa.r1i=function(){Aa.Xca.tSd(!0)};Aa.Xca=Ha;Aa.domElement.classList.add("ewr-presentMode-on");Ea={};Ea=(Ea[h.Hu]=Aa.mc,Ea);Aa.Rb=0;Aa.initializeAndShow("",Aa.r1i,Ea);return Aa}function k(Ea){this.u_a=this.FEd=null;this.$=Ea;this.gridView=ha.g(this.$)}function n(){this.overlayCavityInfos=this.overlayContainerInfo=this.containerId=null}function f(){this.height=this.width=0}function v(){this.angle=this.translateY=this.translateX=this.height=this.width=this.top=this.left=
0}function m(Ea){var Ha=this;this.Bse=this.DPa=this.DEd=this.EEd=this.Wca=this.ewaAccessibilityManager=null;this.isInitialized=!1;this.mqc={};this.lqc={};this.zPa=null;this.uHf=0;this.onKeyDown=function(Aa){Aa=Aa.Ca;if(9===Aa.keyCode){var V=Ha.Wca.querySelectorAll(ia.DOMElementExtensions.dr),La=ia.DOMElementExtensions.Cl(V);V=ia.DOMElementExtensions.fz(V);ia.DOMElementExtensions.zna(Aa,La,V);return!0}return!1};this.Kl=function(){Ha.$.da.Za(337,function(Aa){Ha.DPa.getPresentModeFloatieControlsMap().then(function(V){for(var La=
{},Ra=0;Ra<V.length;Ra++)La[V[Ra].controlId]=V[Ra].modelType;V=Aa.a7.H4a(La);0<V.length&&appChrome.api.dispatch(V);Ha.qlj()})})};this.$=Ea}function x(){}function l(Ea){return F.call(this,Ea)||this}function u(Ea,Ha){this.$=Ea;this.presentModeManager=Ha}var A=b(10);t=b(0);var z=b(915),y=b(50),w=b(37),D=b(1),H=b(187);u.prototype.Nc=function(){return!1};u.prototype.Ac=function(Ea,Ha){if(!D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PresentMode",!1))return!1;switch(Ha.command){case 642419866:return!0;
case 588342182:return this.presentModeManager.nz;default:return!1}};u.prototype.executeCommand=function(Ea,Ha){Ea=w.TaskExtensions.kk();Ha=Ha.command;switch(Ha){case 642419866:this.presentModeManager.$xc(!this.presentModeManager.nz);this.presentModeManager.Ng("TogglePresentMode");break;case 588342182:this.presentModeManager.m7a=!this.presentModeManager.m7a;this.presentModeManager.q4f(this.presentModeManager.m7a,"TogglePresentModeOverlay");this.presentModeManager.Ng("TogglePresentModeOverlay");break;
default:Ea=H.a(Ha)}return Ea};u.prototype.Tc=function(){return!1};Object(t.a)(u,"PresentModeCommandHandler",null,[401]);var F=z.a;$k(l,F);l.prototype.zd=function(){var Ea=this;w.TaskExtensions.Aa(y.GetServiceTaskFactory.Ra(this.$.da,423,424,this.hb),function(Ha){Ea.jd([new u(Ea.$,Ha.result)])},this.la,3)};l.ka=function(Ea){z.a.Pd(420,new l(Ea))};Object(t.a)(l,"PresentModeCommandHandlerFactory",z.a,[]);var J=b(235),S=b(15),N=b(130),T=b(4),G=b(113),I=b(85);x.Wrh="ewa-presentMode-overlay";x.Xrh="ewa-presentMode-panel-container";
x.Yrh="ewa-presentMode-rowHdrParent-container";Object(t.a)(x,"CssClassNames",null,[]);var K=b(19),L=b(5),O=b(155),B=b(310),Q=b(133),U=b(394),X=b(177);b(59);var P=b(114),ea=b(475),ia=b(12),da=b(11),xa=b(101),Z=b(363),ha=b(21),ya=b(134),va=b(449),bb=b(109),ba=b(13),fa=b(274),ra=b(257),pa=b(179),Za=b(45);m.prototype.dispose=function(){this.$=this.DEd=this.EEd=this.Wca=this.DPa=null};m.prototype.cbi=function(){var Ea=this;window.requestAnimationFrame(function(){Ea.Wca=document.createElement("div");Ea.$.Rv.insertBefore(Ea.Wca,
Ea.$.Rv.lastChild);Ea.Wca.id=Ea.$.zb+L.a.w$b;Ea.Wca.classList.add(x.Xrh);Ea.EEd=document.getElementById(Ea.$.zb+L.a.y5c);Ea.DEd=[Ea.$.jE];Ea.isInitialized=!0});this.DPa=presentMode.PresentModeControllerFactoryGlobal.createPresentModeFloatieController();this.DPa.initializePresentModeFloatie()};m.prototype.YZh=function(){var Ea={};Ea.PollingCountPerCaller=G.a.toJSON(this.lqc);Ea.PollingDurationPerCaller=G.a.toJSON(this.mqc);return Ea};m.prototype.tSd=function(Ea){this.isInitialized?Ea?(this.DPa.showPresentModeFloatie(this.Wca,
this.EEd,this.DEd),this.Ng("ShowOrHideFloatiePanel"),this.U9i()):(this.DPa.hidePresentModeFloatie(),this.QQj()):S.ULS.sendTraceTag(537154326,0,15,"PresentModeFloatieManager.ShowOrHideFloatiePanel called before initialization complete")};m.prototype.Ng=function(Ea){this.uHf=da.HelperMethods.Qb();this.zPa=Ea;this.Bse=pa.AsyncMethodContext.Zq(this.Kl,100,Za.a.q1i+Ea,this.Bse)};m.prototype.Uf=function(Ea,Ha){if(Ha)return!1;Ea=ia.DOMElementExtensions.Cl(this.Wca.querySelectorAll(ia.DOMElementExtensions.dr));
if(!Ea)return S.ULS.sendTraceTag(537154325,0,10,"PresentModeFloatieManager.SetFocusOnSection: Could not find first focusable item in present mode toolbar"),!1;Ea.focus();return!0};m.prototype.ah=function(Ea){return ia.DOMElementExtensions.nf(this.hc,Ea)};m.prototype.ej=function(){};m.prototype.Dj=function(){};m.prototype.U9i=function(){var Ea=this;fa.a(this.$).Nh(this);this.$.da.Za(15,function(Ha){Ea.ewaAccessibilityManager=Ha;Ea.ewaAccessibilityManager.mode=5});bb.KeyInputManager.instance.ra(ba.a.Lb,
this.hc,this.onKeyDown)};m.prototype.QQj=function(){fa.a(this.$).Dz(this);ha.g(this.$).H0();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0);bb.KeyInputManager.instance.Ba(ba.a.Lb,this.hc,this.onKeyDown)};m.prototype.qlj=function(){var Ea=da.HelperMethods.Qb()-this.uHf,Ha=this.mqc[this.zPa]?this.mqc[this.zPa]:0;this.mqc[this.zPa]=Ha>Ea?Ha:Ea;this.lqc[this.zPa]=this.lqc[this.zPa]?this.lqc[this.zPa]+1:1};of.Object.defineProperties(m.prototype,{hc:{configurable:!0,enumerable:!0,get:function(){return this.Wca}},
canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){this.DPa.updatePresentModeFloatieShyState(2);return!!this.Wca}},Yd:{configurable:!0,enumerable:!0,get:function(){return ra.a.IIf}}});Object(t.a)(m,"PresentModeFloatieManager",null,[526,429,6]);var Ua=b(7),Ma=b(60);Object(t.a)(v,"OverlayCavityInfo",null,[]);Object(t.a)(f,"OverlayContainerInfo",null,[]);Object(t.a)(n,"PresentModeOverlayProps",null,[]);k.prototype.Obi=function(){var Ea=this;this.FEd=presentMode.PresentModeControllerFactoryGlobal.createPresentModeOverlayController();
window.requestAnimationFrame(function(){Ea.u_a=Array(5);for(var Ha,Aa,V=1;4>=V;V++)Ha=document.createElement("div"),ia.DOMElementExtensions.setVisible(Ha,!1),Ha.id="PresentModeOverlay-"+V,ia.DOMElementExtensions.toggleCssClass(Ha,x.Wrh,!0),Aa=Ea.gridView.Gf(V).domElement,Aa.insertBefore(Ha,Aa.firstChild),Ea.u_a[V]=Ha})};k.prototype.p4f=function(Ea){Ea&&this.iUj();for(var Ha=1;4>=Ha;Ha++)this.Lff(Ha)&&ia.DOMElementExtensions.setVisible(this.u_a[Ha],Ea);ia.DOMElementExtensions.toggleCssClass(this.$.Sq,
"ewr-presentMode-overlay",Ea)};k.prototype.iUj=function(){for(var Ea=this.VUg(),Ha,Aa=1;4>=Aa;Aa++)Ha=Aa,Ea[Ha]&&this.FEd.showOverlayWithCavity(this.u_a[Ha],Ea[Ha])};k.prototype.dispose=function(){this.FEd=this.u_a=this.gridView=this.$=null};k.prototype.VUg=function(){for(var Ea,Ha,Aa=ha.g(this.$).rtl,V,La=Array(5),Ra=1;4>=Ra;Ra++)Ha=Ra,this.Lff(Ra)&&(Ea=this.gridView.Gf(Ra),V=this.gridView.ha.Oa.e_?this.QPh(Ra,Ea,Aa):this.IQh(Ra,Ea,Aa),Ea=this.L9g(Ea),La[Ha]=this.e$g(this.u_a[Ha].id,Ea,V));return La};
k.prototype.Lff=function(Ea){return this.gridView.eb.FQ(Ea)};k.prototype.L9g=function(Ea){return Object(Ua.a)(new f,{width:Ea.jn.width,height:Ea.jn.height})};k.prototype.e$g=function(Ea,Ha,Aa){return Object(Ua.a)(new n,{containerId:Ea,overlayContainerInfo:Ha,overlayCavityInfos:Aa?[Aa]:null})};k.prototype.QPh=function(Ea,Ha,Aa){var V=ha.g(this.$).ha.Oa.Yb;if(!V)return S.ULS.sendTraceTag(537154317,0,10,"PresentModeOverlayRenderer.GetFloatingObjectOverlayCavityInfo: Selected Floating Object is null."),
null;var La=V.extension.TPh(Ea);Ea=La.dCa;V=La.rotation;var Ra=La.translateX;var pb=La.translateY;return La.returnValue?(La=Ea.x-Ha.jn.x,Object(Ua.a)(new v,{left:(Aa?Ha.jn.width-(La+Ea.width):La)-3+1,top:Ea.y-Ha.jn.y-3+1,width:Ea.width+5,height:Ea.height+5,angle:V,translateX:Ra,translateY:pb})):null};k.prototype.IQh=function(Ea,Ha,Aa){Ea=this.gridView.qb.hvb(this.gridView.ha.sa.activeRange,Ea)||Ma.a.W3;if(!Ea.ze(Ha.jn))return null;var V=Ea.x-Ha.jn.x;return Object(Ua.a)(new v,{left:Aa?Ha.jn.width-
(V+Ea.width)-2:V-3,top:Ea.y-Ha.jn.y-3,width:Ea.width+5,height:Ea.height+5})};Object(t.a)(k,"PresentModeOverlayRenderer",null,[525,6]);var oa=b(62),ja=b(300),ta=ja.a;$k(h,ta);h.prototype.hide=function(){ta.prototype.hide.call(this);N.a.Kw(L.a.v4f,"false",this.$.ya.ShowPresentModeWelcomeDialogCookieExpirationDays)};of.Object.defineProperties(h.prototype,{mc:{configurable:!0,enumerable:!0,get:function(){return"PresentModeWelcomeDialog"}}});Object(t.a)(h,"PresentModeWelcomeDialog",ja.a,[]);e.requestFullscreen=
function(Ea){Ea.webkitRequestFullscreen?Ea.webkitRequestFullscreen():Ea.msRequestFullscreen?Ea.msRequestFullscreen():Ea.mozRequestFullScreen?Ea.mozRequestFullScreen():Ea.requestFullscreen?Ea.requestFullscreen():S.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")};e.exitFullscreen=function(){document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():
document.exitFullscreen?document.exitFullscreen():S.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")};of.Object.defineProperties(e,{rFh:{configurable:!0,enumerable:!0,get:function(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":document.mozFullScreenEnabled?"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}},sFh:{configurable:!0,enumerable:!0,get:function(){return"undefined"!==
typeof document.webkitFullscreenEnabled?"webkitfullscreenerror":"undefined"!==typeof document.msFullscreenEnabled?"MSFullscreenError":"undefined"!==typeof document.mozFullScreenEnabled?"mozfullscreenerror":"undefined"!==typeof document.fullscreenEnabled?"fullscreenerror":null}},pji:{configurable:!0,enumerable:!0,get:function(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}});Object(t.a)(e,"FullscreenUtils",
null,[]);d.prototype.$xc=function(Ea){var Ha=this;this.nz!==Ea&&(this.O9d=Ea,this.m7a=this.nz,this.fbf(),this.hMb=this.e3f(),window.requestAnimationFrame(function(){ia.DOMElementExtensions.toggleCssClass(Ha.$.Sq,"ewr-presentMode-transition",!0);$addHandler(Ha.x2a,"transitionend",Ha.zoa);Ha.eCj(!Ea);Ha.hXi();ia.DOMElementExtensions.toggleCssClass(Ha.$.Sq,"ewr-presentMode-on",Ea);Ha.dCj(Ea);O.b(Ha.$).n4f(Ha.nz);O.c(Ha.$).n4f(Ha.nz);Ha.$.$za();Ha.FPa.p4f(Ha.hMb);if(Ha.nz){Ha.IZa();N.a.get(L.a.v4f)?Ha.Xca.tSd(Ha.nz):
Ha.Eqc=new h(Ha.$,Ha.Xca);var Aa=va.b(Ha.$);Aa&&(Ha.WLd=Aa.V7c(!1));Ha.HIf=da.HelperMethods.Qb()}else Ha.Xca.tSd(Ea),Ha.WLd&&(Aa=va.b(Ha.$))&&(Aa.V7c(!0),Ha.WLd=!1),Ha.I6b(),Ha.Wwi()}))};d.prototype.q4f=function(Ea,Ha){this.ySd=Ea;this.Cea(Ha)};d.prototype.Ng=function(Ea){this.Xca.Ng(Ea)};d.prototype.dispose=function(){this.I6b();this.FPa&&(this.FPa.dispose(),this.FPa=null);this.gridView=this.$=null};d.prototype.eCj=function(Ea){var Ha=this.$.da.za(25);void 0===Ha||null===Ha?S.ULS.sendTraceTag(537154324,
0,10,"PresentModeManager.ShowOrHideGridPresence: presenceView is null"):Ea?Ha.Uxc():Ha.eec()};d.prototype.hXi=function(){var Ea=this;ia.DOMElementExtensions.toggleCssClass(document.getElementById(T.AFrameworkApplication.H2a),K.a.Hp,this.nz);ia.DOMElementExtensions.toggleCssClass(this.$.Sq,"ewr-presentMode-on",this.nz);this.hCj(this.nz);this.gridView.vod=!this.nz;this.zUj();this.$.da.Za(32,function(Ha){Ha.XUj(Ea.nz)});P.b(this.$,function(Ha){Ha.Edg(Ea.nz)})};d.prototype.hCj=function(Ea){if(this.$Gb)if(Ea){if(Ea=
Object(I.a)(xa.a,this.$.pa))ia.DOMElementExtensions.toggleCssClass(this.$.Sq,"ewr-presentMode-on-headers-off",!Ea.headersVisible),ia.DOMElementExtensions.toggleCssClass(this.$.Sq,"ewr-presentMode-on-rtl",ha.g(this.$).rtl);this.MBc(0)}else this.$.Sq.classList.remove("ewr-presentMode-on-headers-off"),this.$.Sq.classList.remove("ewr-presentMode-on-rtl"),this.MBc(1)};d.prototype.MBc=function(Ea){var Ha=Object(I.a)(xa.a,this.$.pa);if(Ha){var Aa=parseInt(this.$.Rv.style.right,10);if(1===Ea||2===Ea){if(isNaN(Aa)||
Aa<this.c1a)return;Aa-=this.c1a}if(0===Ea||2===Ea)Ea=Ha.headersVisible,Ha=ha.g(this.$).rtl,Ea=Ea?Ha?0:32:12,Aa=isNaN(Aa)?Ea:Aa+Ea,this.c1a=Ea;this.$.Rv.style.right=da.HelperMethods.nc(Aa);this.KBe=Aa}};d.prototype.zUj=function(){var Ea=document.getElementById(this.$.zb+L.a.i6b).parentNode;ia.DOMElementExtensions.toggleCssClass(Ea,x.Yrh,this.nz)};d.prototype.initialize=function(Ea){this.FPa=new k(Ea);this.FPa.Obi();this.Xca=new m(Ea);this.Xca.cbi();this.x2a=document.getElementById("MainApp");this.qVe=
this.PLi;$addHandler(this.x2a,e.rFh,this.qVe);$addHandler(this.x2a,e.sFh,this.QLi);this.$Gb||(this.$Gb=document.createElement("div"),this.$Gb.className="ewa-presentMode-right-frame",this.$.jE.appendChild(this.$Gb));this.zoa=this.ybj};d.prototype.IZa=function(){this.gridView.ha.G2(this.ep);this.gridView.ha.qY(this.tg);this.gridView.$b.Ak(this.Fh);this.gridView.$b.um(this.Ef);this.gridView.UD(this.ap);this.gridView.view.Is(this.tw);this.gridView.WUc(this.wEb);this.gridView.Ea.vG(this.Dm);this.gridView.Ea.Hs(this.ff);
this.$.xa.Mf(this.wh);this.$.xa.Pra(this.nF);this.$.xa.Uga(this.DFb);this.$.rA(this.Ni);this.$.Uk(this.Yc);var Ea=Object(I.a)(Z.a,this.$.xa);Ea=ik(Ea.items);for(var Ha=Ea.next();!Ha.done;Ha=Ea.next())Ha.value.Onb(this.Pya)};d.prototype.I6b=function(){this.gridView&&(this.gridView.ha.f7(this.ep),this.gridView.ha.zW(this.tg),this.gridView.$b.vk(this.Fh),this.gridView.$b.Nl(this.Ef),this.gridView.yF(this.ap),this.gridView.view.Gq(this.tw),this.gridView.dJd(this.wEb),this.gridView.Ea.YH(this.Dm),this.gridView.Ea.Eq(this.ff));
if(this.$){this.$.xa.ug(this.wh);this.$.xa.Qza(this.nF);this.$.xa.Vma(this.DFb);this.$.iD(this.Ni);this.$.sl(this.Yc);var Ea=Object(I.a)(Z.a,this.$.xa);Ea=ik(Ea.items);for(var Ha=Ea.next();!Ha.done;Ha=Ea.next())Ha.value.OJd(this.Pya)}};d.prototype.e3f=function(){if(!this.nz||!this.m7a)return!1;if(1===this.gridView.ha.Re){var Ea=this.$.pa.activeRange.isSingle,Ha=1===this.$.pa.selectedRanges.length&&!Ea,Aa=this.gridView.isEditing,V=this.yqd;Ha||S.ULS.sendTraceTag(537154322,0,50,"PresentModeManager.ShouldShowPresentModeOverlay: Not showing present mode overlay, single cell selection : "+
Ea);return this.ySd&&Ha&&!Aa&&!V}return this.ySd};d.prototype.dCj=function(Ea){Ea?e.requestFullscreen(this.x2a):e.exitFullscreen()};d.prototype.Cea=function(Ea,Ha,Aa){var V=this;Aa=void 0===Aa?!1:Aa;void 0!==Ha&&Ha||(this.hMb=this.e3f());S.ULS.sendTraceTag(555356484,0,100,"PresentModeManager.UpdateLayout: UpdateLayout triggered by "+Ea+", visibility: "+this.hMb+", immediateUpdate: "+Aa);if(this.OOb&&Aa)S.ULS.sendTraceTag(543023559,0,50,"PresentModeManager.UpdateLayout: Cancel update layout for "+
this.NOb),window.cancelAnimationFrame(this.NOb),this.NOb=0;else if(this.OOb){S.ULS.sendTraceTag(543023558,0,50,"PresentModeManager.UpdateLayout: Skipping update layout for "+Ea);return}Aa?this.LYd(da.HelperMethods.Qb(),Ea):(this.NOb=window.requestAnimationFrame(function(La){V.LYd(La,Ea)}),this.OOb=!0)};d.prototype.LYd=function(Ea,Ha){var Aa=this,V=da.HelperMethods.Qb();if(V-Ea>this.$lj)this.NOb=window.requestAnimationFrame(function(Ra){Aa.LYd(Ra,Ha)}),this.OOb=!1,S.ULS.sendTraceTag(537154319,0,50,
"PresentModeManager.UpdateLayoutCallback: Scheduling update for next frame,  ElapsedTime = "+(V-Ea)+"ms.");else{this.FPa.p4f(this.hMb);this.OOb=!1;var La=da.HelperMethods.Qb();Ea=da.HelperMethods.Qb()-Ea;V=La-V;this.dlj(Ea,Ha);S.ULS.sendTraceTag(537154318,0,50,"PresentModeManager.UpdateLayoutCallback: UpdateLayoutTotalDuration = "+V+"ms. rafTotalDuration = "+Ea+"ms")}};d.prototype.fbf=function(){var Ea=this;U.a(this.$.userOperationManager,function(Ha,Aa,V){var La=Ea.$.oa.va,Ra=Ea.nz,pb=La.Na(41,null);
pb.shouldEnablePresentMode=Ra;return oa.g(La,"SetPresentMode",pb,Ha,Aa,V,null,0)},function(Ha){return new X.a(252,0,Ha)},null)};d.prototype.dWf=function(){var Ea=ea.a(this.gridView.Re);1!==this.gridView.Re||this.$.pa.activeRange.isSingle||(Ea="Range");this.svc[Ea]=this.svc[Ea]?this.svc[Ea]+1:1};d.prototype.dlj=function(Ea,Ha){var Aa=this.upc[Ha]?this.upc[Ha]:0;this.upc[Ha]=Aa>Ea?Aa:Ea;this.tpc[Ha]=this.tpc[Ha]?this.tpc[Ha]+1:1};d.prototype.Wwi=function(){var Ea={},Ha=da.HelperMethods.Qb()-this.HIf;
Ea.PresentModeDuration=Ha;Ea.SelectionCountPerObject=G.a.toJSON(this.svc);Ea.OverlayCountPerCaller=G.a.toJSON(this.tpc);Ea.OverlayDurationPerCaller=G.a.toJSON(this.upc);Ha=this.Xca.YZh();for(var Aa in Ha)Ea[Aa]=Ha[Aa];ya.b(this.$).yd(Q.a.p1i,Ea,void 0,!0)};of.Object.defineProperties(d.prototype,{nz:{configurable:!0,enumerable:!0,get:function(){return this.O9d}}});Object(t.a)(d,"PresentModeManager",null,[499,6]);var aa=b(207),ma=J.a;$k(c,ma);c.prototype.create=function(){var Ea=this,Ha=y.GetServiceTaskFactory.Ra(this.$.da,
283,284,1);w.TaskExtensions.Aa(Ha,function(){w.TaskExtensions.Aa(aa.c(Ha.result.vn.loadScript("presentMode")),function(){var Aa=Ea.$.da.za(423);Aa||(Aa=new d(Ea.$),Ea.$.da.Ga(423,Aa));Ea.pb(Aa)},Ea.$.la,3)},this.$.la,3)};c.ka=function(Ea){Ea.da.Ga(424,new c(Ea))};Object(t.a)(c,"PresentModeManagerFactory",J.a,[]);b.d(E,"a",function(){return a})},1379:function(t,E,b){function a(){u.a.Fa(c.ka)}function c(Na){return nb.call(this,Na)||this}function d(Na,sa,Wa,Hb){var Yb=Ia.call(this)||this;Yb.$=Na;Yb.businessBar=
Hb;Yb.openInExcelOperation=sa;Yb.RJ=Wa;return Yb}function e(){}function h(Na){var sa=Ea.call(this,Na)||this;sa.sessionId=Na.ya.UserSessionId;sa.mSg=Na.ya.BuildVersion;return sa}function k(Na){var sa=this;this.L8h="itms-apps://";this.M8h="apps.apple.com/app/apple-store/id586683407?mt=8&pt=80423&ct=miniWAC";this.Xjg=function(Wa){1==Wa&&sa.fEc()};this.$=Na;this.tx=F.AFrameworkApplication.ta.Qa.tx;this.Qla="ms-excel:ofe|u|"+this.tx;this.im=F.AFrameworkApplication.fa.Wa("AppUrl");I.a.Gba||I.a.Ug?this.im=
this.L8h+this.M8h:I.a.Uo&&(F.AFrameworkApplication.fa.qa("UseAppAndroidMarketURL")?(D.ULS.sendTraceTag(523534414,306,100,"OpenInAppDialogReact: Using app android market url"),this.im=F.AFrameworkApplication.fa.Wa("WildFireMarketUrlExcelAndroid")):I.a.Szb?this.im=F.AFrameworkApplication.fa.Wa("WildFireUrlChinaStoreAndroid"):4<I.a.oWc.K8a&&(this.im=F.AFrameworkApplication.fa.Wa("WildFireUrlExcelAndroid")))}function n(Na){var sa=ta.call(this,Na)||this;sa.GH=null;sa.FEb=function(){D.ULS.sendTraceTag(574993313,
306,50,"MouseClick: Open with redirection timer");if(sa.$.ya.IsMeetingLiveSession)return sa.fEc(),!0;I.a.Uo?(D.ULS.sendTraceTag(574993312,306,50,"Android intent scheme is being used to open android app from browser"),sa.tx&&sa.tx.length||D.ULS.sendTraceTag(537162595,306,15,"ClientUrl is null"),sa.openUrl("intent:"+sa.tx+"#Intent;scheme=ms-excel;action=android.intent.action.VIEW;S.browser_fallback_url="+sa.im+";end","_top")):9<=I.a.ukd?(D.ULS.sendTraceTag(537162594,306,50,"OpenInAppDialog.onClickHandler: Open in app directly if installed for iOS version 9 or above"),
sa.openUrl(sa.Qla,"_top"),window.setTimeout(function(){sa.openUrl(sa.im,"_blank")},9E3)):(D.ULS.sendTraceTag(537162593,306,50,"OpenInAppDialog.onClickHandler: Open in app if installed, else redirection to appstore for iOS version below 9."),sa.openUrl(sa.Qla,"_top"),window.setTimeout(function(){sa.openUrl(sa.im,"_blank")},500));return!0};sa.JOa=function(Wa){return Wa.Ca.keyCode===ra.a.Qh||Wa.Ca.keyCode===ra.a.Soa?(D.ULS.sendTraceTag(537162592,306,50,"KeyPress: Open with redirection timer"),Wa.yb.click(),
!0):!1};if(1!==F.AFrameworkApplication.ta.Qa.rj)return sa;sa.tx=sa.$.workbookContext.ClientUrl;sa.Qla="ms-excel:ofe|u|"+sa.tx;sa.im=F.AFrameworkApplication.fa.Wa("AppUrl");I.a.Gba?sa.im="itms-apps://"+F.AFrameworkApplication.fa.Wa("WildFireUrlExceliOS")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac":I.a.Uo&&(oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseAppAndroidMarketURL",!1)&&sa.$.ya.IsMeetingLiveSession?(D.ULS.sendTraceTag(529397969,306,100,"Using app android market url"),
sa.im=F.AFrameworkApplication.fa.Wa("WildFireMarketUrlExcelAndroid")):I.a.Szb?sa.im=F.AFrameworkApplication.fa.Wa("WildFireUrlChinaStoreAndroid"):4<I.a.oWc.K8a&&(sa.im=F.AFrameworkApplication.fa.Wa("WildFireUrlExcelAndroid")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac"));return sa}function f(){}function v(Na){this.calculateType=0;this.calculateType=Na}function m(Na){this.calculationMode=0;this.calculationMode=Na}function x(Na,sa){var Wa=this;this.dialog=null;this.Awf=function(){Wa.dialog&&
Wa.dialog.hide()};this.PGi=Na;this.ob=sa;this.ob.Cnb(this.Awf)}function l(Na,sa){return fa.call(this,Na,void 0,void 0,sa)||this}var u=b(10);t=b(0);var A=b(624),z=b(915),y=b(50),w=b(37),D=b(15),H=b(1452),F=b(4),J=b(170),S=b(974),N=b(99),T=b(278),G=b(749),I=b(27),K=b(162),L=b(182),O=b(308),B=b(5),Q=b(154),U=b(103),X=b(76),P=b(78),ea=b(394),ia=b(177),da=b(59),xa=b(62),Z=b(340),ha=b(658),ya=b(1547),va=b(447),bb=b(334),ba=b(14),fa=ya.a;$k(l,fa);l.prototype.Zlf=function(){D.ULS.sendTraceTag(537162658,0,
50,"DownloadACopyAsOdsDialog.LogDialogDisplayed - ODS download dialog displayed")};l.prototype.amf=function(){D.ULS.sendTraceTag(537162657,0,50,"DownloadACopyAsOdsDialog.LogDownloadLinkClicked - ODS download dialog link clicked")};l.prototype.Tjc=function(){va.Redirect.showHelp(bb.a.sGi);return!0};of.Object.defineProperties(l.prototype,{cOa:{configurable:!0,enumerable:!0,get:function(){return ba.a.instance.Xa(412)}},$jc:{configurable:!0,enumerable:!0,get:function(){return ba.a.instance.Xa(413)}},
Zjc:{configurable:!0,enumerable:!0,get:function(){return"DownloadOdsLink"}},ZBb:{configurable:!0,enumerable:!0,get:function(){return"#"}},j8a:{configurable:!0,enumerable:!0,get:function(){return ba.a.instance.Xa(414)}},vqf:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(t.a)(l,"DownloadACopyAsOdsDialog",ya.a,[]);x.prototype.Gse=function(Na){this.dialog=Na};x.prototype.R6c=function(){this.PGi.aFf(-1059172980)};x.prototype.dispose=function(){this.ob.JIb(this.Awf)};Object(t.a)(x,"DownloadACopyAsOdsDialogDownloadBehavior",
null,[59,6]);Object(t.a)(m,"MacroRecorderWorkbookCalculationModeSetPayload",null,[430]);Object(t.a)(v,"MacroRecorderWorkbookRecalculatedPayload",null,[430]);var ra=b(86),pa=b(150),Za=b(199),Ua=b(13),Ma=b(109),oa=b(1);ya=b(276);of.Object.defineProperties(f,{aWi:{configurable:!0,enumerable:!0,get:function(){return f.$Vi}}});f.$Vi="<div class='\"\"' id='OpenInAppDialog'> <div class='PrivacyDialogTitle UIFontDialogTitle' id='OpenInAppTitle'> <label id='OpenInAppTitle' class='\"\"' style='font-size:16pt' >{0}</label> </div> <div class='WACDialogRow' id='InfoMessageArea'> <label id='InfoMessageAreaLine1' class='\"\"' style='font-size:12pt' >{1}</label> <br/> </div> <br/> <div class='AppInstallButton' id='LinkToInstall' role='button' tabIndex='0'> <div class='clip32x32' id='BottomInfoIconClip' unselectable='on' style='display: inline-block; pointer-events:none;' role='img'> <img id='BottomIconInfo' class='{3}' role='presentation' src={2} /> </div> <div class='\"\"' id='AppstoreLink' style='display:inline-block; padding-top:4px; vertical-align:top;'> <label id='AppstoreLinkTitle' class='PrivacyDialogTitle' unselectable='on' style='font-size: 14pt; margin-left:8px' >{4}</label> </div> </div>";
Object(t.a)(f,"OpenInAppDialogCopyHtml",null,[]);var ja=b(158),ta=ya.a;$k(n,ta);n.prototype.openUrl=function(Na,sa){var Wa=document.getElementById("link");Wa||(Wa=document.createElement("a"),Wa.id="link",Wa.style.visibility="hidden",Wa.href="",document.body.appendChild(Wa));Wa.target=sa;Wa.href=Na;Wa.click()};n.prototype.fEc=function(){var Na=this;D.ULS.sendTraceTag(529397968,306,50,"OpenInAppForLiveFiles API invoked");w.TaskExtensions.Aa(y.GetServiceTaskFactory.Ra(this.$.da,21,137,1),function(sa){var Wa=
{};Wa.OpenInAppUrl=Na.Qla;Wa.StoreUrl=Na.im;sa.result.wj("UI_OpenInMobileApp",Wa)},this.$.la)};n.prototype.bWi=function(){D.ULS.sendTraceTag(529397967,306,100,"OpenInAppDialogHandler invoked")};n.prototype.qg=function(){this.Xf=pa.a.Oo(f.aWi,ba.a.instance.ga(665),ba.a.instance.ga(666),F.AFrameworkApplication.GC,ja.getImageClass(F.AFrameworkApplication.fa.Wa("AppIcon")),ba.a.instance.ga(667));this.ye="OpenInAppDialog";this.Rb=5;this.initializeAndShow("",this.bWi.bind(this),null);this.kI(this.GH)};
n.prototype.lv=function(Na){ta.prototype.lv.call(this,Na);document.getElementById("WACDialogBodyPanel").style.padding="0 4px 0 24px";this.GH=document.getElementById("LinkToInstall");Za.a.instance.ra(Ua.a.click,this.GH,this.FEb);Ma.KeyInputManager.instance.ra(Ua.a.Fd,this.GH,this.JOa)};n.prototype.dispose=function(){this.GH&&(Za.a.instance.Ba(Ua.a.click,this.GH,this.FEb),Ma.KeyInputManager.instance.Ba(Ua.a.Fd,this.GH,this.JOa),this.GH=null);ta.prototype.dispose.call(this)};of.Object.defineProperties(n.prototype,
{mc:{configurable:!0,enumerable:!0,get:function(){return"OpenInAppDialogCopy"}}});Object(t.a)(n,"OpenInAppDialogCopy",ya.a,[]);var aa=b(135),ma=b(396);k.prototype.fEc=function(){var Na=this;D.ULS.sendTraceTag(523534413,306,50,"OpenInAppDialogReact: OpenInAppForLiveFiles API invoked");w.TaskExtensions.Aa(y.GetServiceTaskFactory.Ra(this.$.da,21,137,1),function(sa){var Wa={};Wa[ma.a.gFf]=Na.Qla;Wa[ma.a.im]=Na.im;sa.result.wj("UI_OpenInMobileApp",Wa)},this.$.la)};k.prototype.qg=function(){D.ULS.sendTraceTag(523534412,
0,50,"initializeAndShowDialog: React Edit in app dialog opened.");var Na=new aa.StandardDialog;Na.Rb=0;Na.kc(1,ba.a.instance.ga(671));Na.rl(ba.a.instance.ga(669),ba.a.instance.ga(670),0,this.Xjg)};Object(t.a)(k,"OpenInAppDialogReact",null,[]);ya=b(300);var Ea=ya.a;$k(h,Ea);h.prototype.JM=function(){var Na={};return Na[h.ypj]=ba.a.instance.ga(672),Na[h.zpj]=this.sessionId,Na[h.id]="WACSessionIdDialog",Na[h.VYc]=ba.a.instance.ga(673),Na[h.buildVersion]=this.mSg,Na};h.prototype.qg=function(){var Na=
this.JM();this.Rb=5;this.initializeAndShow(ba.a.instance.ga(1018),this.tYj.bind(this),Na)};h.prototype.tYj=function(){D.ULS.sendTraceTag(521434688,306,100,"Show WACSessionIdDialogHandler invoked")};of.Object.defineProperties(h.prototype,{mc:{configurable:!0,enumerable:!0,get:function(){return"WACSessionIdDialog"}}});h.id="id";h.ypj="sessionIdLabel";h.zpj="sessionIdValue";h.VYc="buildLabel";h.buildVersion="buildVersion";Object(t.a)(h,"WACSessionIdDialog",ya.a,[]);var Ha=b(28),Aa=b(31),V=b(377),La=
b(11),Ra=b(187),pb=b(298),cb=b(21),Sa=b(43),Db=b(261),Ab=b(501),Wb=b(401),ub=b(51),vb=b(6),Ka=b(147),eb=b(1186),yb=b(82),oc=b(35),Jb=b(383),dc=b(264);e.prototype.wQ=function(Na,sa){Na=Aa.a.Xc(12,1,674,0,0,0,"Blank");Na.Description=String.format(ba.a.instance.ga(675),sa);return Na};e.prototype.kac=function(Na){switch(Na){case 1:case 2:return 0;default:return 2}};Object(t.a)(e,"ReloadCloseConfirmation",null,[700]);var $a=b(156),Ba=b(659),la=b(68),ka=b(58),ca=b(189),Ia=L.a;$k(d,Ia);d.prototype.Nc=function(){return!1};
d.prototype.executeCommand=function(Na,sa,Wa,Hb){var Yb=this,Sb=this.y7b,lb=this.$,wb=sa.command,wa=this.openInExcelOperation,Oa=this.$.zb,Ub=Wa.SourceControlId;lb.Ok.ime(wb);wa.Iwc(sa.startTime.getTime().toString());Na=null;switch(wb){case 1455037301:this.$.q5?wa.UBe():wa.B2c();break;case -2044628748:case 2004484710:this.$.q5?wa.UBe():wa.openInExcelClient();break;case 213236505:"ContextMenu.ShowOpenInAppDialogOnMobile"===Ub?(this.ACb("CellLongPress"),D.ULS.sendTraceTag(576495705,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from cell long press")):
(this.ACb("PencilIcon"),D.ULS.sendTraceTag(576495704,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from pencil icon in toolbar"));this.showOpenInAppDialog();break;case 924877417:D.ULS.sendTraceTag(520372316,0,50,"User clicked the reload button");var hb=la.a(this.$).dd.activityState;Sa.a(lb).cs(new Db.a(vb.a.Jx,5,function(){hb[dc.a.fq]=vb.a.Oi}));break;case 480922297:oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowWacSessionIdDialogOnMobile",!1)&&(new h(this.$)).qg();
break;case -2028960985:wa.g6f();break;case -1059172980:new l(wa.Zue(wb),new x(wa,lb.ob));break;case -1285148982:this.clientWorkflow.dd.activityState[oc.a.WTc]=!0;this.PAc(!1);break;case -75280711:this.PAc(!1);break;case -455164169:this.PAc(!0);break;case -1388494670:this.$.da.Za(400,function(zb){zb.Vzi();Yb.PAc(!1)});break;case 810888577:F.AFrameworkApplication.nk=(new Date).getTime();D.ULS.sendTraceTag(537162656,0,50,"FileOperationsCommandHandler.ExecuteCommand: Set AccessTokenTtl to "+F.AFrameworkApplication.nk);
break;case -1804063550:case -974518828:sa=0;B.a.iCd in Wa&&(sa=Wa[B.a.iCd]);wa.aFf(wb,sa);break;case -1339961039:sa=!1;Wa&&B.a.HJb in Wa&&(sa=Wa[B.a.HJb]);this.reloadWorkbook(!1,sa);break;case -8805455:var Xb=this.workbookContext;lb.isEditMode||(d.zze(lb),Na=w.TaskExtensions.Aa(this.RJ.value,function(zb){zb=zb.result;var ib=zb.isEnabled();ib&&ha.a(zb,J.a.copyAndEdit,da.a.pg.gYe(),Yb.$.ea.Tg.get(2))?D.ULS.sendTraceTag(537162655,0,50,"FileOperationsCommandHandler.ExecuteCommand: ReloadInEditMode ribbon command was procesed through SendMessageIfOptionSet()"):
ib&&F.AFrameworkApplication.cfg?(ib={},ib[H.a.eFd]=F.AFrameworkApplication.userSessionId,ib[F.AFrameworkApplication.fCi]=Ha.a.Ta.Jb.getTime().toString(),D.ULS.sendTraceTag(537162654,0,50,"FileOperationsCommandHandler.ExecuteCommand: processing ReloadInEditMode ribbon command whike UseEditModePostMessage flag is ON"),zb.wj(J.a.editMode,ib)):Sb.CopyAndEditUrl?Yb.K4g():(Yb.ic.supportsEditing||Xb.EditUrl)&&Yb.reloadWorkbookInEditMode()},this.la,3));break;case -723527778:lb.isEditMode&&(d.zze(lb),this.reloadWorkbookInViewMode());
break;case 1783960667:case -1355155015:var Gc=lb.oa.va.Pb(),uc=-1355155015===wb?1:0,Nc=function(){return new v(uc)};Na=ea.a(this.$.userOperationManager,function(zb,ib,fc){return xa.z(lb.oa.va,uc,null,zb,ib,fc,null,Gc)},function(zb){return new ia.a(128,0,zb,void 0,Nc)},sa);cb.g(lb).ig.HG(!1);break;case -1158102843:Na=cb.g(lb).ig.recalcSheet(sa);cb.g(lb).ig.HG(!1);break;case -988468372:if(oa.EwaSettings.ma(302))if(Hb=parseInt(Wa[X.a.Mc],10),0<=Hb&&3>Hb)this.setCalculationMode(sa,Hb);else return D.ULS.sendTraceTag(537162652,
0,10,"SetCalculationMode , unexpected menuItemId: "+Wa[X.a.Mc]),Ra.a(wb);break;case 257398710:Q.a.ntw(Sb.ReportAbuseUrl,lb);break;case 1800405051:this.Zkj();break;case -48469327:this.saveACopy();break;case 214430355:sa=!1;Wa&&B.a.x7c in Wa&&(sa=Wa[B.a.x7c]);if(!this.Jyj(sa,Wa))break;F.AFrameworkApplication.h5?this.businessBar.Lf(41,null):this.businessBar.Lf(sa?22:23,null);break;case 1389557314:Na=w.TaskExtensions.Aa(this.RJ.value,function(zb){ha.a(zb.result,J.a.HAh,null,Yb.$.ea.Tg.get(6))||Q.a.ntw(Sb.FileVersionUrl,
lb)},this.la,3);break;case 2145659238:this.closeWorkbook();break;case 1773624819:Ub===Oa+B.a.Yif?wa.Fsi():wa.Esi();break;case 512141517:Ub===Oa+B.a.Xif?wa.Qsi():wa.Psi();break;case -1224038235:var Fb=S.a.On in Wa?!Wa[S.a.On]:U.j(lb.ea.workbookContext.Options);Wa[S.a.Description]=Fb?ba.a.instance.ga(574):ba.a.instance.ga(575);Na=ea.a(this.$.userOperationManager,function(zb,ib,fc){var Ic=Yb.$.oa.va,Yc=Ic.Na(9,null);Yc.isReadOnlyRecommended=!Fb;return xa.g(Ic,"SetReadOnlyRecommended",Yc,zb,ib,fc,null,
0)},function(zb){return new ia.a(129,0,zb)},sa);break;case 1118926154:if(this.$.isEditMode){var ob=new K.a;this.$.da.Za(53,function(zb){zb?(zb.Ql.ysi(Yb.$.zb+B.a.Xrd),ob.setResult(!0)):D.ULS.sendTraceTag(537162649,0,50,"Ignoring RibbonCommand.LaunchFileMenuShortcut, the ribbonManager is null.")});Na=ob.task}break;case -1698025133:wa.openInBrowser();break;case 520859864:Na=w.TaskExtensions.Aa(y.GetServiceTaskFactory.Ra(this.$.da,393,394,Hb.Kja()),function(zb){zb.result||D.ULS.sendTraceTag(537162648,
0,10,"FileMenuCommandHandler::ExecuteCommand Failed to create SaveToHostManager")},this.$.la,3);break;default:Na=Ra.a(wb)}return Na||ka.Task.Ua(!0)};d.prototype.ACb=function(Na){if(oa.EwaSettings.isChangeGateEnabled("OfficeVSO:4859963_LogUsageKpiForOpenInAppDialog"))if(La.HelperMethods.i_){var sa=new Map;sa.set("EntryPoint",Na);N.Health.instance.recordKpiUsage(Wb.a.ZVi,0,Ab.a.QBi,sa)}else D.ULS.sendTraceTag(537162647,0,15,"FileOperationsCommandHandler.LogUsageKpiOpenInAppDialog: KPI Usage not supported")};
d.prototype.showOpenInAppDialog=function(){F.AFrameworkApplication.isMobileMode&&(this.$.ya.IsMeetingLiveSession&&oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OpenInAppExcelReactDialog",!1)?(D.ULS.sendTraceTag(522859990,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app React dialog used"),(new k(this.$)).qg()):oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseOpenInAppDialogCopyMobile",!1)?(D.ULS.sendTraceTag(574993315,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app dialog used"),
(new n(this.$)).qg()):(D.ULS.sendTraceTag(574993314,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: Git-side open-in-app dialog used"),F.AFrameworkApplication.showOpenInAppDialog()))};d.prototype.Jyj=function(Na,sa){var Wa=this;return F.AFrameworkApplication.isMobileMode&&!P.a(this.$.ya,30)?(this.showOpenInAppDialog(),D.ULS.sendTraceTag(577300448,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: Open-in-app dialog invoked from cell double tap"),this.ACb("CellDoubleTap"),D.ULS.sendTraceTag(537162646,
0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view in mobile browser "),!1):F.AFrameworkApplication.vhc&&(Na&&V.c(this.workbookContext.WorkbookFileName)||!this.workbookContext.FullDocumentInfo.HostEditUrl)?(D.ULS.sendTraceTag(537162645,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view a non-editable format ."+(V.d(this.workbookContext.WorkbookFileName)?"xls":"csv")+", HostEditUrl "+(this.workbookContext.FullDocumentInfo.HostEditUrl?
"not ":"")+"empty. Skipped prompt to edit"),!1):T.a.any([25,26,30,31,56,32],function(Hb){return Wa.businessBar.mMa(Hb)})?(D.ULS.sendTraceTag(537162644,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view after opening in Edit by default"),!1):sa&&B.a.b3i in sa&&!Na?!1:!0};d.prototype.Ac=function(Na,sa){Na=!1;switch(sa.command){case 1455037301:case -2044628748:case 2004484710:case -2028960985:case -974518828:case -1339961039:case -8805455:case -723527778:case 1783960667:case -1158102843:case -1355155015:case 257398710:case 214430355:case 1389557314:case 2145659238:case 1773624819:case 512141517:case 1118926154:case -1698025133:case 213236505:Na=
!0;break;case 480922297:case 520859864:Na=oa.EwaSettings.isChangeGateEnabled("OfficeVSO:3773098_SaveDeferredActionDispatcherEnabled")?!0:!1;break;case 924877417:Na=ca.a.Jod?!0:!1;break;case -1285148982:case -75280711:case -455164169:Na=oa.EwaSettings.ma(109);break;case -1388494670:Na=oa.EwaSettings.ma(109);break;case 810888577:Na=oa.EwaSettings.ma(271);break;case -1224038235:Na=this.$.ea.amIAlone;break;case -988468372:Na=oa.EwaSettings.ma(302);break;case -1804063550:case -1059172980:case 1800405051:case -48469327:Na=
!0,D.ULS.shipAssertTag(537162642,0,this.$.zka,"Command execute requested for SaveAs or Copy operation when data duplication is disallowed.")}return Na};d.prototype.Tc=function(){return!1};d.prototype.Zkj=function(){var Na=this;if(this.dc){var sa=this.$;Sa.a(sa).cs(new Db.a(vb.a.Jx,5,function(){sa.XH(!1,!0);var Wa=Na.clientWorkflow.dd.activityState;Wa[dc.a.fq]=vb.a.Hda;Wa[Ka.a.xT]=2;Wa[oc.a.Es]=sa.isEditMode;Wa[Ka.a.Jga]=!1}))}};d.prototype.saveACopy=function(){var Na=this;if(this.dc){var sa=this.$;
Sa.a(sa).cs(new Db.a(vb.a.Jx,5,function(){sa.XH(!1,!1);var Wa=Na.clientWorkflow.dd,Hb=Wa.activityState;Hb[dc.a.fq]=vb.a.HVf;Hb[Ba.a.fZb]=Na.ic.hasUnsupportedFeaturesForEdit;Hb[Ka.a.Jga]=!1;Wa.Bt(Aa.a.zaa(Na.businessBar.O7c,[-502303485]))}))}};d.prototype.PAc=function(Na){var sa=this;Sa.a(this.$).cs(new Db.a(vb.a.vna,2,function(){sa.$.XH(!0,!0);var Wa=la.a(sa.$).dd,Hb=sa.$.isEditMode;Hb=Aa.a.Xc(1,1,0,0,0,Hb?-315732528:-2087635043,Hb?"DeploymentInvalidEditSession":"InvalidOrTimedOutSession");Hb.ForceVersionUpgrade=
Na;Wa.Bt([Hb]);Wa=la.a(sa.$).dd.activityState;Wa[dc.a.fq]=vb.a.vna;Wa[oc.a.Es]=sa.$.isEditMode;Wa[Ka.a.Jga]=!1}))};d.prototype.closeWorkbook=function(){var Na=this;if(this.dc){var sa=this.$;da.a.pg.fxc("2145659238")?w.TaskExtensions.Aa(this.RJ.value,function(Wa){Wa.result.wj(J.a.FSe,{})},this.la,3):Sa.a(sa).cs(new Db.a(vb.a.Jx,5,function(){sa.XH(!0,!1);var Wa=Na.clientWorkflow.dd.activityState;Wa[Ka.a.kY]=!1;Wa[Ka.a.Jga]=!1;Na.ic.inViewerFromWebPart?(Z.a.VFd(sa,Na.clientWorkflow.dd),sa.Ok.Hy("InViewerFromWebPart"),
Wa[dc.a.fq]=vb.a.N_):(Wa[dc.a.fq]=vb.a.Dk,sa.Bd&32?Wa[Ka.a.xT]=0:(Wa[Ka.a.xT]=1,Wa[Ka.a.VYb]=new eb.a),Wa[$a.a.Gke]=!0)}))}};d.prototype.K4g=function(){var Na=this,sa=this.ic.vbaRemovedDuringConversion;D.ULS.sendTraceTag(537162636,0,50,"FileOperationsCommandHandler.CopyAndEditWorkbook: vbaRemovedDuringConversion = "+sa);var Wa=this.$;sa?Sa.a(Wa).cs(new Db.a(vb.a.Jx,5,function(){var Hb=Aa.a.Xc(3,0,0,1258,0,1069271157,"XLSMacroFailure");Na.clientWorkflow.dd.Bt([Hb]);Na.clientWorkflow.dd.activityState[dc.a.fq]=
vb.a.Veb})):F.AFrameworkApplication.hideHeader?La.HelperMethods.Te(this.y7b.CopyAndEditUrl,"_blank",void 0,"FileOperationCommandHandler.CopyAndEditUrl"):Q.a.ntw(this.y7b.CopyAndEditUrl,Wa)};d.prototype.reloadWorkbookInEditMode=function(){var Na=this;if(this.dc)if(oa.EwaSettings.isChangeGateEnabled("OfficeVSO:4585988_RefreshRibbonCookieOnModeRefresh")&&da.a.pg.AV&&da.a.pg.JHd(),F.AFrameworkApplication.vhc&&!F.AFrameworkApplication.Tba)La.HelperMethods.Te(this.$.zpb(!0),O.a.blank,void 0,"FileOperationCommandHandler.BuildHostUrl");
else{var sa=this.$,Wa=!1,Hb=this.ic.hasUnsupportedFeaturesForEdit,Yb=this.workbookContext.FileWasRepaired;V.d(this.workbookContext.WorkbookFileName)?(Wa=!0,D.ULS.sendTraceTag(537162634,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an XLS file, unsupported features = "+Hb)):V.a(this.workbookContext.WorkbookFileName)&&(Wa=!0,D.ULS.sendTraceTag(537162633,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an CSV file"));var Sb=sa.pe.get(59);Sb=!(sa.ea.ic.supportsEditing&&
Sb);if(Wa&&!Hb||Sb&&(Wa||Hb)){var lb=Sb?Hb?-2066104278:816071846:oa.EwaSettings.isChangeGateEnabled("OfficeVSO:4035916_RemoveConvertInTeams")&&P.a(this.$.ya,25)&&!this.$.CAb?765011943:-213064907;Wa=function(){var wb=Aa.a.k_a([lb]);Na.clientWorkflow.dd.Bt(wb);Na.clientWorkflow.dd.activityState[dc.a.fq]=vb.a.Veb}}else Wa=function(){sa.XH(!0,!1);var wb=Na.clientWorkflow.dd,wa=wb.activityState;wa[Ka.a.xT]=1;wa[Jb.a.$Yb]=G.a.Dlc;wa[oc.a.Es]=!0;wa[Ba.a.fZb]=Na.ic.hasUnsupportedFeaturesForEdit;wa[Ka.a.Jga]=
!!Na.workbookContext.EditUrl;wa[yb.a.t2]=Na.workbookContext.EditUrl;if(!Na.y7b.CopyAndEditUrl){var Oa=[oa.EwaSettings.isChangeGateEnabled("OfficeVSO:4035912_RemoveEditACopyInTeams")&&P.a(Na.$.ya,25)&&!Na.$.CAb?-943219229:1821390342];wb.Bt(Aa.a.zaa(Na.businessBar.O7c,Oa))}Yb&&!Hb?(V.b(Na.workbookContext.WorkbookFileName)&&oa.EwaSettings.isChangeGateEnabled("OfficeVSO:5693008_CGForFlightODFRepairEnabled")?(wb=Aa.a.k_a([-425642652]),D.ULS.sendTraceTag(537162631,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an .ods file")):
wb=Aa.a.k_a([108482388]),Na.clientWorkflow.dd.Bt(wb),wa[dc.a.fq]=vb.a.VVf):Na.$.ea.h7e?(D.ULS.sendTraceTag(546111811,0,50,"Password-To-Modify Workbook: User trying to switch to edit-mode."),ub.b().VTd("DialogShown","Password-To-Modify Workbook: Logging StopWatch duration after user tries to switch to exclusive edit-session","PasswordToModifyDialogShown"),wa[dc.a.fq]=vb.a.tGb):wa[dc.a.fq]=Na.$.ea.ehc?vb.a.cCb:vb.a.Veb};Sa.a(sa).cs(new Db.a(vb.a.Jx,5,Wa))}};d.prototype.reloadWorkbookInViewMode=function(){var Na=
this;if(this.dc){oa.EwaSettings.isChangeGateEnabled("OfficeVSO:4585988_RefreshRibbonCookieOnModeRefresh")&&da.a.pg.AV&&da.a.pg.JHd();var sa=this.$;I.a.Ug&&cb.g(sa).Wb.textBox.blur();Sa.a(sa).cs(new Db.a(vb.a.Jx,5,function(){sa.XH(!sa.ea.isNamedObjectViewMode,!1);var Wa=Na.clientWorkflow.dd.activityState;Wa[dc.a.fq]=vb.a.Rha;Wa[Ka.a.xT]=1;Wa[Ka.a.kY]=!0;Wa[oc.a.Es]=!1;Wa[oc.a.$mb]=!0;Wa[Jb.a.$Yb]=G.a.Dlc}))}};d.prototype.reloadWorkbook=function(Na,sa){var Wa=this;if(this.dc){var Hb=this.$;Hb.pQ&65536&&
Sa.a(Hb).cs(new Db.a(vb.a.Jx,5,function(){Hb.XH(Na,!0);var Yb=Wa.clientWorkflow.dd.activityState;Yb[dc.a.fq]=vb.a.Ek;Yb[oc.a.ZTc]=Wa.workbookContext.NovMode;sa||(Yb[Ka.a.xT]=1,Yb[Ka.a.VYb]=new e)}))}};d.prototype.setCalculationMode=function(Na,sa){function Wa(){return new m(sa)}var Hb=this;D.ULS.sendTraceTag(537162629,0,50,"SetCalculationMode ,calculation mode chosen : "+sa+" ");var Yb=this.$.ea.workbookContext.CalcMode;this.$.ea.workbookContext.CalcMode=sa;return ea.a(this.$.userOperationManager,
function(Sb,lb,wb){var wa=Hb.$.oa.va;Sb=pb.b(Sb,d.SSi(Hb.$,Yb));lb=pb.a(lb,d.RSi(Hb.$,Yb));var Oa=wa.Na(9,null);Oa.calc_type=sa;return xa.g(wa,"SetCalculationOptions",Oa,Sb,lb,wb,null,0)},function(Sb){return new ia.a(197,0,Sb,void 0,Wa)},Na)};d.zze=function(Na){Na.ob&&0<Na.ob.rR&&Na.ob.l$c(function(sa){sa.Lt()})};d.SSi=function(Na,sa){return function(Wa){Aa.a.Dg(Wa.Errors)&&(Na.ea.workbookContext.CalcMode=sa,D.ULS.sendTraceTag(537162628,0,50,"OnSetCalcModeSucess: successCallback was called with errors for SetCalculationMode. reverting calc mode to "+
sa+".  Error id names: "+Aa.a.Cc(Wa.Errors)))}};d.RSi=function(Na,sa){return function(){Na.ea.workbookContext.CalcMode=sa;D.ULS.sendTraceTag(537162627,0,50,"OnSetCalcModeFailure: failedCallback was called for SetCalculationMode. reverting calc mode to "+sa+")")}};of.Object.defineProperties(d.prototype,{dc:{configurable:!0,enumerable:!0,get:function(){return this.$.ea.dc}},workbookContext:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext}},y7b:{configurable:!0,enumerable:!0,
get:function(){return this.$.workbookContext.FullDocumentInfo}},clientWorkflow:{configurable:!0,enumerable:!0,get:function(){return la.a(this.$)}},ic:{configurable:!0,enumerable:!0,get:function(){return this.$.ic}}});Object(t.a)(d,"FileOperationsCommandHandler",L.a,[401]);var jb=b(159),nb=z.a;$k(c,nb);c.prototype.zd=function(){var Na=this,sa=this.$,Wa=[],Hb=y.GetServiceTaskFactory.create(sa.da,56,this.la,this.hb);Wa.push(Hb);var Yb=y.GetServiceTaskFactory.Ra(sa.da,5,4,this.hb);Wa.push(Yb);w.TaskExtensions.Aa(ka.Task.uL.apply(ka.Task,
kk(Wa)),function(){jb.b(Hb)&&Na.jd([new d(sa,Hb.result,new A.a(function(){return y.GetServiceTaskFactory.create(sa.da,137,Na.la,Na.hb)}),Yb.result)])},this.la,0)};c.ka=function(Na){z.a.Pd(94,new c(Na))};Object(t.a)(c,"FileOperationsCommandHandlerFactory",z.a,[]);b.d(E,"a",function(){return a})},1380:function(t,E,b){function a(){l.a.Fa(function(ub){n.ka(ub);c.ka(ub)})}function c(ub){return Wb.call(this,ub)||this}function d(ub,vb){var Ka=this;this.NRi=function(eb,yb){if(!Ea.a(eb)&&yb){var oc=!!eb&&
!!eb.RequestTelemetryData;V.g(Ka.$).si.tla(yb,eb.StateId,oc?eb.RequestTelemetryData.EcsOperationDuration:0,oc?eb.RequestTelemetryData.EcsRequestDuration:0,oc?eb.RequestTelemetryData.WfeRequestDuration:0)}};this.hJi=function(eb,yb){yb&&yb.M0b&&yb.M0b.SheetName&&yb.M0b.Ranges.length&&yb.dhi&&xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&(eb=Ab.d(Ka.$.xa.pa),Ka.k0g(new Sa.a(X.B(yb.M0b.Ranges[0]),eb)))};this.$=ub;this.Hg=vb}function e(ub,
vb){var Ka=pb.call(this,ub)||this;Ka.Rvb=function(eb){eb=Ka.Xed(eb);return Ka.ocd(eb)};Ka.Vhj=function(eb,yb){var oc=Ka.IAb=yb[e.Phi];1===eb?(eb=yb[e.xDj],oc=Ka.K3e(eb,oc),A.ULS.shipAssertTag(537153996,0,oc!==e.zba,"ResizeHeadersDialogHandler - invalid size input, size = "+eb),eb=oc!==Ka.vld,A.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",Ka.isRow,Ka.IAb,oc,eb),eb&&Ka.K5g(oc)):A.ULS.sendTraceTag(537153994,
0,50,"ResizeHeadersDialog Cancel button pressed, isRow = "+Ka.isRow+".")};Ka.isRow=2040891415===vb.command;Ka.gridView=V.g(Ka.$);Ka.Xtc=new v(Ka.$.workbookContext.DxDigitNormal);Ka.vld=Ka.QUg();ub=Ka.t4g(Ka.vld);vb=Ka.v4g(Ka.vld);Ka.zl=ha.a.instance.ga(Ka.isRow?480:481);ub=Ka.JM(ub,vb);Ka.initializeAndShow(Ka.zl,Ka.Vhj,ub);A.ULS.sendTraceTag(537153997,0,50,"ResizeHeaders React Dialog opened, isRow = "+Ka.isRow+".");return Ka}function h(ub){this.resizeParameters=null;this.resizeParameters=ub}function k(ub,
vb){this.isRow=!1;this.autoFitRange=null;this.isRow=ub;this.autoFitRange=vb}function n(){var ub=pa.call(this)||this;ub.Eb();return ub}function f(ub,vb){var Ka=ra.call(this,vb.domElement)||this;Ka.PTf=!1;Ka.QX=!1;Ka.KSa=null;Ka.T7a=null;Ka.mj=null;Ka.YKd=!0;Ka.gic=!1;Ka.offset=0;Ka.Vk=0;Ka.hKb=0;Ka.U0=null;Ka.KW=null;Ka.QM=null;Ka.W6h="headerResizeTooltip";Ka.vud=null;Ka.YF=null;Ka.bAa=!1;Ka.b9=!1;Ka.MXc=!1;Ka.A$a=T.a.twa;Ka.yFf=T.a.twa;Ka.Ibf=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6649809_AutoFitHiddenRowCol");
Ka.qDc=!1;Ka.wN=function(eb){if(Ka.grid.ek)return!1;eb=fa.a(Ka.grid.$).Sd(eb);if(3===eb.nb&&!Ka.dif(eb.Ca)||!Ka.tIf(eb,!1))return!1;A.ULS.sendTraceTag(537154058,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");var yb=Ka.dyc();Ka.vcd(eb.clientPoint,yb,!0);Ka.bAa||(z.a.instance.ra(y.a.sj,Ka.domElement.ownerDocument.body,Ka.J9a),w.a.instance.ra(y.a.Vf,Ka.domElement.ownerDocument.body,Ka.J9a),Ka.bAa=!0);Ka.Xdf()&&Ka.QX&&Ka.C9e(eb);return!1};Ka.NEb=function(eb){eb=fa.a(Ka.grid.$).Sd(eb);
Ka.Xdf()&&Ka.MXc&&Ka.C9e(eb);if(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6093232_ResizeRowColUsingTouch")){if(!eb.Ca.type.includes("touch")&&eb.Ca.button!==Sys.UI.MouseButton.leftButton||!Ka.$6a)return!1}else if(eb.Ca.button!==Sys.UI.MouseButton.leftButton||!Ka.$6a)return!1;da.g(eb.Ca);Ka.rLe();eb=Ka.grid.ek?Ka.A$a:T.a.twa;if(Ka.grid.ek&&Ka.mj)var yb=eb!==Ka.Vk||!Ka.Ibf&&Ka.b9;else Ka.mj&&(eb=Ka.b9?Ka.Sdd():Ka.mj.m4()),yb=eb!==Ka.Vk;if(Ka.KSa&&yb&&eb!==T.a.twa){eb=Ka.grid;yb=Ka.hgd(eb);var oc=
{};oc.SheetMultiRange=X.r(yb,eb.$);f.rPd(oc,Ka.isRow,Ka.Vk);Ka.imh(oc);eb.KIj=!0}else Ka.tg(null,null),Ka.wIb();Ka.b9=!1;return Ka.qDc=!1};Ka.Bca=function(eb){if(Ka.grid.ek)return!1;eb=D.a.create(eb.eventName,eb.yb,eb.Ca,eb.nb);eb=fa.a(Ka.grid.$).Sd(eb);if(!Ka.tIf(eb,!0))return!1;eb=Ka.grid;var yb=Ka.hgd(eb);yb=X.r(yb,eb.$);eb.qb.fh([Ka.isRow?13:14]);eb.qb.mSa();Ka.wIb();var oc={};eb.$.Cd(Ka.isRow?146338636:1391094586,Q.a.Cb,30,(oc.autoFitRanges=yb,oc));return!1};Ka.wyf=function(eb){Ka.QX?(Ka.b9&&
!Ka.qDc&&Ka.yCg(),Ka.gic||Ka.U$e(),eb=new Sys.UI.DomEvent(eb),eb=D.a.create(y.a.wha,Ka.domElement,eb,2),eb=fa.a(Ka.grid.$).Sd(eb),Ka.xyf(eb.clientPoint,void 0)):A.ULS.sendTraceTag(521480320,2,50,"HeaderResizeBehavior.onHeaderResizeChanged: Reached during no resize mode. cellAbsoluteIndex = "+(Ka.mj?Ka.mj.Rje:-1)+", isRow = "+Ka.isRow)};Ka.yyf=function(eb){eb=new Sys.UI.DomEvent(eb);eb=D.a.create(y.a.wha,Ka.domElement,eb,2);Ka.NEb(eb)};Ka.WNi=function(eb){Ka.Dya(eb,Ka.mj,!1)};Ka.J9a=function(eb){eb=
fa.a(Ka.grid.$).Sd(eb);xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6195348_StopBubblingOnDocumentMouseMoveInnerEvent")&&da.g(eb.Ca);return Ka.xyf(eb.clientPoint,eb.Ca)};Ka.UH=function(eb){if(Ka.grid.ek)return!1;eb=fa.a(Ka.grid.$).Sd(eb);var yb;if(!Ka.Bgf||-1!==Ka.grid.ha.selectionType)return ba.a(Ka.grid.$).Lp()&&(yb=Ka.Hed(eb))&&(yb.Uva.style.cursor=""),!1;if(Ka.QX)return Ka.U$e(),!1;yb=Ka.Hed(eb);if(!yb)return!1;yb.Uva.style.cursor=!Ka.grid.isEditing&&Ka.Hrd(yb)?Ka.isRow?"row-resize":"col-resize":
"";da.g(eb.Ca);return!0};Ka.ep=function(){Ka.wIb()};Ka.tg=function(){if((3===Q.a.Cb||H.a.Wo)&&Ka.grid.ha.sa.rg){var eb=Ka.grid.ha.sa.Vc;if(!(!eb.isRow&&!eb.We||!Ka.domElement||eb.isRow&&Ka.isRow&&!Ka.Fe.Gn.includes(eb.top)||eb.We&&!Ka.isRow&&!Ka.Fe.Gn.includes(eb.left))){var yb=Ka.grid.gg(eb,Ka.Fe.lj.paneType);if(yb){if(Ka.grid.ek){var oc=Ka.isRow?eb.bottom:eb.right;Ka.mj=Ka.Fe.Mr(B.Range.Qc(eb.bottom,eb.right));if(!Ka.mj){A.ULS.sendTraceTag(522826880,2,50,"HeaderResizeBehavior.onSelectionEnded: Cell being resized is undefined. Couldn't create touch resizer. Absolute index "+
oc+", is row "+Ka.isRow);return}}Ka.YF||Ka.fbh();eb.isRow&&Ka.isRow?(ia.DOMElementExtensions.setVisible(Ka.YF,!0),Ka.YF.style.top=yb.bottomRight.y-Ka.YF.offsetHeight/2+"px"):eb.isRow||Ka.isRow||(ia.DOMElementExtensions.setVisible(Ka.YF,!0),ya.c(Ka.YF.style,Ka.grid.rtl,yb.bottomRight.x-Ka.YF.offsetWidth/2+"px"))}}}};Ka.pF=function(eb,yb){xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6385697_HeaderResize_LogOnPartialInteractivityStatusChanged")&&A.ULS.sendTraceTag(521787422,2,50,"HeaderResizeBehavior.onPartialInteractivityStatusChanged: was called. isActivated "+
yb.TL);yb.TL&&Ka.aqb()};Ka.Fe=vb;Ka.isRow=vb.isRow;Ka.rtl=vb.lj.rtl;Ka.grid=ub;Ka.Bpf=Ka.isRow?T.a.awd:T.a.hlc;Ka.S6h=ha.a.instance.ga(439);Ka.a7h=ha.a.instance.ga(438);Ka.V6h=ha.a.instance.ga(440);va.a(Ka.grid.$,function(eb){Ka.vud=eb.SP(U.a.cij,!1)});Ka.t9i();Ka.grid.ha.qP(Ka.tg);Ka.grid.ha.G2(Ka.ep);Ka.grid.Au(Ka.tg);ba.a(Ka.grid.$).Tf.U9(Ka.pF);return Ka}function v(ub){this.p7c=ub}function m(ub,vb,Ka,eb,yb,oc,Jb){this.Uva=ub;this.sDb=vb;this.tOa=Ka;this.pjd=eb;this.Zbb=yb;this.cif=oc;this.Z5h=
Jb}function x(){}var l=b(10);t=b(0);var u=b(235),A=b(15),z=b(249),y=b(13),w=b(161),D=b(737),H=b(27),F=b(236),J=b(4),S=b(278),N=b(94),T=b(9),G=b(30);x.ysh="ewa-resizehdr-row-hidden";x.xsh="ewa-resizehdr-col-hidden";Object(t.a)(x,"CssClassNames",null,[]);var I=b(19),K=b(65),L=b(60),O=b(5),B=b(24),Q=b(76),U=b(133),X=b(41),P=b(151),ea=b(53),ia=b(12),da=b(69),xa=b(1),Z=b(11),ha=b(14),ya=b(262),va=b(134),bb=b(395),ba=b(43);Object(t.a)(m,"HeaderEventCachedInfo",null,[]);v.prototype.kCe=function(ub){ub=Z.HelperMethods.IDd(ub);
return Math.max(0,Math.min(v.Rpf,ub))};v.prototype.bCe=function(ub){return this.KZi(ub)};v.prototype.l0g=function(ub){return Math.round(this.p7c*ub+2*this.MYe()+1)};v.prototype.KZi=function(ub){return Math.max(0,Math.min(v.ypf,(Math.max(0,Math.min(T.a.hlc,ub))-2*this.MYe()-1)/this.p7c))};v.prototype.MYe=function(){return Math.floor(Math.max((this.p7c+3)/4,2))};v.prototype.Rbc=function(ub,vb){return vb?ub?v.Rpf:T.a.awd:ub?v.ypf:T.a.hlc};v.Rpf=409;v.ypf=255;Object(t.a)(v,"ResizeHeadersConverter",null,
[]);var fa=b(33),ra=N.a;$k(f,ra);f.prototype.Dya=function(ub,vb,Ka){ub=new Sys.UI.DomEvent(ub);ub=D.a.create(y.a.wha,this.domElement,ub,2);ub=fa.a(this.grid.$).Sd(ub);this.sIf(vb,ub.clientPoint.x,ub.clientPoint.y,!1,Ka);vb=this.dyc();this.vcd(this.KSa,vb,!0);this.bAa||(vb=this.domElement.ownerDocument.body,vb.addEventListener(y.a.wha,this.wyf),vb.addEventListener(y.a.JGa,this.yyf),this.bAa=!0)};f.prototype.UNi=function(ub,vb,Ka){this.sIf(vb,ub.clientX,ub.clientY,!0,this.Ibf?Ka:!1);ub=this.grid;vb=
this.hgd(ub);vb=X.r(vb,ub.$);ub.qb.fh([this.isRow?13:14]);ub.qb.mSa();this.wIb();Ka={};ub.$.Cd(this.isRow?146338636:1391094586,Q.a.Cb,30,(Ka.autoFitRanges=vb,Ka))};f.prototype.dispose=function(){this.D0c();this.grid.ha&&(this.grid.ha.AW(this.tg),this.grid.ha.f7(this.ep));this.grid.ny(this.tg);ba.a(this.grid.$)&&ba.a(this.grid.$).Tf.tda(this.pF);F.a.instance.Ba(y.a.$j,this.domElement,this.Bca);z.a.instance.Ba(y.a.Hf,this.domElement.ownerDocument.body,this.NEb);w.a.instance.Ba(y.a.oe,this.domElement.ownerDocument.body,
this.NEb);H.a.Wo||(z.a.instance.Ba(y.a.pointerDown,this.domElement,this.wN),z.a.instance.Ba(y.a.sj,this.domElement,this.UH));this.bAa&&(z.a.instance.Ba(y.a.sj,this.domElement.ownerDocument.body,this.J9a),w.a.instance.Ba(y.a.Vf,this.domElement.ownerDocument.body,this.J9a),this.bAa=!1);this.YF&&(z.a.instance.Ba(y.a.pointerDown,this.YF,this.wN),F.a.instance.Ba(y.a.$j,this.YF,this.Bca),this.D0c(),this.YF=null);this.PTf&&(ia.DOMElementExtensions.gf(f.$bb),f.$bb=null);this.Fe=null;ra.prototype.dispose.call(this)};
f.prototype.t9i=function(){F.a.instance.ra(y.a.$j,this.domElement,this.Bca);z.a.instance.ra(y.a.Hf,this.domElement.ownerDocument.body,this.NEb);w.a.instance.ra(y.a.oe,this.domElement.ownerDocument.body,this.NEb);H.a.Wo||(z.a.instance.ra(y.a.pointerDown,this.domElement,this.wN),z.a.instance.ra(y.a.sj,this.domElement,this.UH))};f.prototype.Qmh=function(){if(!f.$bb){document.getElementById(f.OTf);this.PTf=!0;var ub=f.$bb=document.createElement("div");this.grid.$.frame.Uaa().appendChild(ub);ub.id=f.OTf;
ub.className=G.a.zsh;ia.DOMElementExtensions.setVisible(ub,!1)}};f.prototype.rLe=function(){if(this.bAa){var ub=this.domElement.ownerDocument.body;this.grid.ek?(ub.removeEventListener(y.a.wha,this.wyf),ub.removeEventListener(y.a.JGa,this.yyf)):(z.a.instance.Ba(y.a.sj,ub,this.J9a),w.a.instance.Ba(y.a.Vf,ub,this.J9a));this.bAa=!1}this.QX=!1;xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")?this.QPf():(this.qUf(),this.VId());bb.c(this.grid.$,!0,"HeaderResizeBehavior:PrepareResizeOperation")};
f.prototype.qUf=function(){this.grid.qb.fh([this.isRow?13:14]);this.grid.qb.mSa()};f.prototype.yCg=function(){this.Fe.addRowColToModel(this.mj.Rje-1,this.mj.Z$i);this.qDc=!0};f.prototype.xyf=function(ub,vb){if(!this.QX)return!1;this.grid.ek||xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6195348_StopBubblingOnDocumentMouseMoveInnerEvent")||da.g(vb);vb=this.isRow;if(!this.grid.ek&&!this.U0){this.U0=document.createElement("div");this.U0.style.cssText="position: relative; width: inherit; height: inherit;"+
(vb?"top: 0px; ":this.rtl?"right: 0px:":"left: 0px:");for(var Ka=this.mj.QJ();Ka.nextSibling;)this.U0.appendChild(Ka.nextSibling);Ka.parentNode.appendChild(this.U0)}Ka=vb?ub.y-this.T7a.y:(this.rtl?-1:1)*(ub.x-this.T7a.x);var eb=vb?ub.y-this.KSa.y:(this.rtl?-1:1)*(ub.x-this.KSa.x),yb=this.grid.ek?this.A$a:this.mj.m4();if(yb===T.a.twa)return!1;Ka&&(0<this.Vk||0<yb+eb)&&yb+eb<=this.Bpf&&(this.Vk=this.dyc(eb),this.vcd(ub,this.Vk,!1),this.grid.ek?this.Vk>=f.D7e?(this.YKd=!0,this.mj.setCellExtent(this.Vk)):
this.YKd&&(this.YKd=!1,this.mj.setCellExtent(f.D7e)):(ia.DOMElementExtensions.Koa(this.mj.QJ(),!vb,Math.max(this.hKb+eb,0)),this.U0.style[vb?"top":this.rtl?"right":"left"]=Math.max(eb,-this.hKb)+"px"),Ka=(this.grid.ek?this.yFf:vb?this.mj.Fe.$D:this.mj.Fe.aE)+Math.max(eb,this.grid.ek?-this.A$a+f.hdc:-this.hKb),ia.DOMElementExtensions.Koa(this.mj.Fe.domElement,!vb,Ka),this.grid.ek&&this.mj.Fe.fqj(Ka),this.T7a=new Sys.UI.Point(ub.x,ub.y),ia.DOMElementExtensions.setVisible(this.YF,!1));return!0};f.prototype.m4=
function(){return this.mj?this.b9?f.i7h:this.mj.m4():T.a.twa};f.prototype.vcd=function(ub,vb,Ka){this.QM&&Ka&&(A.ULS.sendTraceTag(537154051,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),this.VId());this.QM||Ka||A.ULS.sendTraceTag(537154050,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead");this.vud&&this.vud(function(){var eb={};return eb.Location="canvas",
eb});this.QM?this.iWe(vb):(this.QM=document.createElement("div"),this.QM.id=this.W6h,this.iWe(vb),this.QM.className=G.a.Uqh,vb=document.getElementById(this.grid.$.zb+O.a.prf),vb.insertBefore(this.QM,vb.firstChild),ub=fa.a(this.grid.$).Ija(ub),this.QM.style.left=(this.rtl?Math.max(ub.x-this.QM.offsetWidth,0):ub.x-Math.max(ub.x+this.QM.offsetWidth-vb.offsetWidth,0)).toString()+"px",vb=document.getElementById(O.a.sGa),this.QM.style.top=(ub.y-(J.AFrameworkApplication.ta&&J.AFrameworkApplication.ta.Qa.Qf?
0:vb.offsetHeight)-this.QM.offsetHeight).toString()+"px")};f.prototype.VId=function(){ia.DOMElementExtensions.gf(this.QM);this.QM=null};f.prototype.iWe=function(ub){var vb=new v(this.grid.$.workbookContext.DxDigitNormal);vb=this.isRow?vb.kCe(ub).toFixed(2):vb.bCe(ub).toFixed(2);this.QM.innerText=(this.isRow?this.S6h:this.a7h)+" "+vb+" ("+ub.toString()+" "+this.V6h+")"};f.prototype.tIf=function(ub,vb){var Ka;if(-1!==this.grid.ha.selectionType||2===ub.nb&&ub.Ca.button!==Sys.UI.MouseButton.leftButton||
!this.Hrd(Ka=this.Hed(ub))||!this.Bgf)return!1;da.g(ub.Ca);this.KSa=this.T7a=new Sys.UI.Point(ub.clientPoint.x,ub.clientPoint.y);this.pUg(Ka,vb);if(!this.mj)return!1;this.QX=!0;this.Tmi(this.mj,Ka)&&this.X$h();this.hKb=this.Sdd();return this.uIf(vb)};f.prototype.sIf=function(ub,vb,Ka,eb,yb){this.QX=!0;this.b9=yb;this.mj=ub;this.gic=!1;this.KSa=this.T7a=new Sys.UI.Point(vb,Ka);ub=this.mj.getRange();this.KW=yb?this.dpe(ub):ub;this.A$a=this.m4();this.yFf=this.isRow?this.mj.Fe.$D:this.mj.Fe.aE;this.uIf(eb)};
f.prototype.uIf=function(ub){var vb={};va.b(this.grid.$).yd(U.a.Uhj,(vb.IsResizingHiddenHeader=this.b9,vb.IsAutoFitting=ub,vb.NumberOfSelectedRanges=this.grid.ha.sa.uK,vb.Location="canvas",vb));this.offset=this.mj.dba();this.Vk=this.grid.ek?this.A$a:this.mj.m4();if(this.Vk===T.a.twa)return!1;bb.c(this.grid.$,!1,"HeaderResizeBehavior:prepareResizeOperationInternal");return!0};f.prototype.Tmi=function(ub,vb){var Ka=this.mj.QJ();if(!Ka)return A.ULS.shipAssertTag(537154049,2,!1,"cell being resized element received is null"),
!1;Ka=Ka.nextSibling;if(!Ka)return!1;ub=ub.getRange();Ka=this.Fe.$ua(Ka).getRange();if(!ub||!Ka)return A.ULS.shipAssertTag(537154048,2,!1,"IsResizingHidden: range is null"),!1;var eb=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6101474_EnableUnhideRowByMouseDrag");ub=eb&&this.isRow?ub.bottom:ub.right;Ka=eb&&this.isRow?Ka.bottom:Ka.right;return ub+1!==Ka&&ub!==Ka&&this.Hrd(vb,!0)};f.prototype.X$h=function(){var ub=this.mj.QJ(),vb=this.Fe.$ua(ub.nextSibling);f.Umi(vb,this.isRow)?(this.mj=vb,this.KW=
this.mj.getRange()):(this.zCg(ub),this.mj=vb,ub=this.mj.getRange(),this.KW=this.dpe(ub),this.b9=!0)};f.prototype.dpe=function(ub){return this.isRow?new B.Range(ub.top-1,ub.left,ub.top-1,ub.right,!1,!0):new B.Range(ub.top,ub.left-1,ub.bottom,ub.left-1,!1,!0)};f.prototype.zCg=function(ub){var vb=this.Fe.$ua(ub.nextSibling),Ka=f.j8g(vb,this.isRow,this.rtl);Ka&&ub.parentNode.insertBefore(Ka,vb.QJ())};f.prototype.hgd=function(ub){var vb=this.KW,Ka=ub.ha.sa.selectedRanges;if(ub.ha.sa.Rsb(vb))if(this.isRow){if(S.a.all(Ka,
function(eb){return eb.isRow}))return Ka}else if(S.a.all(Ka,function(eb){return eb.We}))return Ka;return[vb]};f.prototype.getCellExtent=function(){return this.mj.getCellExtent()};f.prototype.Sdd=function(){var ub=this.mj.QJ().style;return Math.max(0,Math.min(this.Bpf,0|parseInt(this.isRow?ub.height:ub.width,10)))};f.prototype.dyc=function(ub){ub=void 0===ub?0:ub;var vb=this.grid,Ka=this.Fe.lj.paneType;Ka=this.isRow?3===Ka?[3,2]:[1,4]:4===Ka?[2,4]:[1,3];var eb=vb.view.visibleArea.bottomRight,yb=Math.max(this.grid.ek?
this.A$a:this.mj.m4(),0);ub=this.b9&&!this.grid.ek?Math.max(this.Sdd(),0):Math.max(yb+ub,0);eb=this.isRow?new L.a(0,this.offset,eb.x,ub):new L.a(this.offset,0,ub,eb.y);yb=[this.isRow?13:14];vb.qb.Ti(B.Range.Qc(1,1),yb,!1);vb.qb.sn(yb,eb,Ka);return ub};f.prototype.D0c=function(){this.KW=this.KSa=this.T7a=null;if(this.U0){var ub=this.U0.parentNode;if(ub)for(ub.removeChild(this.U0);this.U0.firstChild;)ub.appendChild(this.U0.firstChild);this.U0=null}this.mj=null;this.QX=!1;xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")||
this.QPf()};f.prototype.QPf=function(){this.gic=!1;this.VId();ia.DOMElementExtensions.setVisible(f.$bb,!1);ia.DOMElementExtensions.setVisible(this.YF,!1);xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")&&this.qUf()};f.prototype.Hed=function(ub){if(ia.DOMElementExtensions.lz(ub.yb,"a"))return null;var vb=this.dif(ub.Ca);if(vb&&this.grid.ha.sa.rg){var Ka=this.grid.ha.sa.Vc;Ka=this.Fe.Mr(B.Range.Qc(Ka.bottom,Ka.right))}else Ka=this.Fe.$ua(ub.yb);if(!Ka)return null;var eb=
Ka.QJ(),yb=new Sys.UI.Bounds(eb.offsetLeft,eb.offsetTop,eb.offsetWidth,eb.offsetHeight),oc=ia.DOMElementExtensions.getBoundingClientRect(ub.yb);oc=new Sys.UI.Point(ub.clientPoint.x-oc.x,ub.clientPoint.y-oc.y);this.isRow&&!vb&&(oc.y+=Z.HelperMethods.AC(ub.yb,eb,this.rtl).y);return new m(eb,oc,yb,Ka.getRange(),Math.max(f.NBi,Math.min(f.JAi,(this.isRow?yb.height:yb.width)*f.dij)),vb,!this.isRow&&0<eb.getElementsByTagName("input").length)};f.prototype.Hrd=function(ub,vb){vb=void 0===vb?!1:vb;if(!ub||
this.grid.isEditing)return!1;if(ub.cif)return!0;var Ka=ub.tOa,eb=ub.Zbb,yb=this.Fe.lj.paneType,oc=this.grid.Gf(yb).Vg,Jb=!!oc&&oc.top===ub.pjd.top,dc=!!oc&&oc.left===ub.pjd.left;yb=!!oc&&oc.bottom===ub.pjd.bottom&&(3===yb||2===yb);this.isRow?(dc=ub.sDb.y,ub=dc<=eb&&!Jb,Ka=dc>=Ka.height-eb-(yb?f.kFh:0),vb=vb?ub:Ka||ub):(yb=ub.Z5h,Jb=this.rtl,oc=ub.sDb.x,ub=oc<=eb&&(!dc||Jb)&&(!yb||!Jb),Ka=oc>=Ka.width-eb&&(!Jb||!dc)&&(!yb||Jb),vb=vb?Jb?Ka:ub:ub||Ka);return vb};f.prototype.pUg=function(ub,vb){var Ka=
this.isRow;if(ub.cif)this.mj=this.Fe.$ua(ub.Uva);else if(Ka&&ub.sDb.y<=ub.Zbb&&ub.tOa.height>ub.Zbb||!Ka&&ub.tOa.width>ub.Zbb&&(!this.rtl&&ub.sDb.x<=ub.Zbb||this.rtl&&ub.sDb.x>=ub.tOa.width-ub.Zbb)){if(this.mj=ub.Uva.previousSibling?this.Fe.$ua(ub.Uva.previousSibling):this.iSh(),vb&&ub.Uva.classList.contains(Ka?G.a.ZQe:G.a.YQe)&&(ub=this.Fe.$ua(ub.Uva)))ub=ub.getRange(),this.KW=Ka?new B.Range(ub.top-1,ub.left,ub.top-1,ub.right,!1,!0):new B.Range(ub.top,ub.left-1,ub.bottom,ub.left-1,!1,!0)}else this.mj=
this.Fe.$ua(ub.Uva);!this.KW&&this.mj&&(this.KW=this.mj.getRange())};f.prototype.iSh=function(){var ub=this.isRow?1:0;return(ub=this.Fe.lj.cG(this.Fe.lj.Ea.Ig(this.grid.$.pa,K.a.pM(this.Fe.position.X+ub-1,this.Fe.position.Y-ub,this.Fe.position.PaneType))))?ub.hSh():null};f.prototype.U$e=function(){this.gic=!0;var ub=this.eij;ia.DOMElementExtensions.setVisible(ub,!0);ub.style.cursor=this.isRow?G.a.hOe:G.a.TMe;this.dyc()};f.prototype.imh=function(ub){var vb={};this.grid.$.Cd(this.isRow?745189930:-445963340,
Q.a.Cb,30,(vb.resizeRowColumnParameters=ub,vb))};f.prototype.fbh=function(){var ub=document.createElement("div");ub.className=G.a.yth;var vb=document.createElement("div");vb.className=I.a.HA;ub.appendChild(vb);var Ka=document.createElement("img");Ka.src=ea.a.df(0);Ka.className=this.isRow?I.a.wsh:I.a.rsh;vb.appendChild(Ka);this.Fe.vA.domElement.parentNode.insertBefore(ub,this.Fe.vA.domElement);this.grid.ek?ub.addEventListener(y.a.vha,this.WNi):(z.a.instance.ra(y.a.pointerDown,ub,this.wN),F.a.instance.ra(y.a.$j,
ub,this.Bca));ia.DOMElementExtensions.setVisible(ub,!1);this.YF=ub};f.prototype.wIb=function(){this.D0c();this.YF&&(this.Fe.vA.domElement.parentNode.removeChild(this.YF),this.YF=null)};f.prototype.dif=function(ub){return ia.DOMElementExtensions.nf(this.YF,ub.target)};f.prototype.aqb=function(){this.QX&&(this.rLe(),ia.DOMElementExtensions.Koa(this.mj.QJ(),!this.isRow,this.hKb),this.wIb(),this.qDc=this.b9=!1)};f.prototype.Xdf=function(){return xa.EwaSettings.ma(680)};f.prototype.C9e=function(ub){(ub=
ub.Ca.rawEvent)&&ub.detail===f.Omj&&(ub.type===y.a.Pp?(this.QX=!1,this.MXc=!0):ub.type===y.a.NH&&(this.QX=!0,this.MXc=!1))};f.f8g=function(ub,vb){return new f(ub,vb)};f.rPd=function(ub,vb,Ka){if(vb)for(ub.ColumnWidth=-1,ub.RowHeight=Ka,ub=ik(ub.SheetMultiRange.Ranges),vb=ub.next();!vb.done;vb=ub.next())vb=vb.value,vb.FirstColumn=0,vb.LastColumn=0;else for(ub.RowHeight=-1,ub.ColumnWidth=Ka,ub=ik(ub.SheetMultiRange.Ranges),vb=ub.next();!vb.done;vb=ub.next())vb=vb.value,vb.FirstRow=0,vb.LastRow=0};f.Umi=
function(ub,vb){if(!ub||!ub.QJ())return A.ULS.shipAssertTag(537154014,2,!1,"header after hidden headers is null"),!1;var Ka=ub.getRange();ub=ub.QJ().style;if(!Ka||!ub)return A.ULS.shipAssertTag(537154013,2,!1,"header range or style is null"),!1;ub=vb?ub.height:ub.width;return(vb?Ka.top:Ka.left)===(vb?T.a.uh:T.a.Eh)&&ub===f.Ihg};f.j8g=function(ub,vb,Ka){if(!ub)return A.ULS.shipAssertTag(537154012,2,!1,"header after hidden is null"),null;var eb=ub.QJ();if(!eb||!eb.style)return A.ULS.shipAssertTag(537154011,
2,!1,"header after hidden element or style is null"),null;ub=document.createElement("div");var yb=eb.style;ub.style.top=vb?yb.top:f.Ihg;vb||(Ka?ub.style.right=yb.right:ub.style.left=yb.left);ub.classList.add(vb?x.ysh:x.xsh);ub.classList.add(vb?G.a.Stb:G.a.Rtb);Ka=document.createElement("div");Ka.classList.add(vb?G.a.LQe:G.a.Y9c);eb=vb?Number.parseInvariant(eb.innerText):B.Range.l0a(eb.innerText);Ka.innerText=vb?(eb-1).toString():B.Range.KP(eb-1);ub.appendChild(Ka);return ub};of.Object.defineProperties(f.prototype,
{$6a:{configurable:!0,enumerable:!0,get:function(){return this.QX}},Bgf:{configurable:!0,enumerable:!0,get:function(){var ub=(new P.a(this.grid.$.xa)).Ud(this.isRow?16:8),vb=this.grid.$.ob.pz,Ka=this.grid.vi,eb=ba.a(this.grid.$).Lp();return ub&&!vb&&!Ka&&!eb}},eij:{configurable:!0,enumerable:!0,get:function(){this.Qmh();return f.$bb}}});f.NBi=0;f.JAi=5;f.hdc=1;f.D7e=1;f.i7h=0;f.kFh=3;f.dij=.1;f.OTf="ewa-rszrbg";f.Ihg="0px";f.Omj=2;f.$bb=null;Object(t.a)(f,"HeaderResizeBehavior",N.a,[492]);var pa=
u.a;$k(n,pa);n.prototype.create=function(){this.pb(f.f8g)};n.ka=function(ub){ub.da.Ga(136,new n)};Object(t.a)(n,"HeaderResizeBehaviorFactory",u.a,[]);var Za=b(915),Ua=b(50),Ma=b(37),oa=b(178),ja=b(452),ta=b(572),aa=b(394),ma=b(177),Ea=b(299),Ha=b(298),Aa=b(74),V=b(21);Object(t.a)(k,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[430]);Object(t.a)(h,"MacroRecorderSheetRowsColumnsResizedPayload",null,[430]);var La=b(85);u=b(300);var Ra=b(22),pb=u.a;$k(e,pb);e.prototype.JM=function(ub,vb){var Ka=
{};return Ka[e.O4]=this.mc,Ka[e.gni]=this.isRow,Ka[e.tai]=ub,Ka[e.sai]=vb,Ka[e.Yji]=this.IAb,Ka[e.Wed]=this.Rvb,Ka};e.prototype.QUg=function(){var ub=this.wIh();try{return this.cNh(ub)}finally{ub&&ub.dispose()}};e.prototype.K5g=function(ub){var vb={};vb.SheetMultiRange=X.r(this.gridView.ha.sa.selectedRanges,this.$);e.rPd(vb,this.isRow,ub);ub={};this.$.Cd(this.isRow?745189930:-445963340,Q.a.Cb,8,(ub.resizeRowColumnParameters=vb,ub))};e.prototype.K3e=function(ub,vb){return Ra.a.l5(ub)?vb?this.s4g(ub):
this.u4g(ub):e.zba};e.prototype.u4g=function(ub){return Math.floor(parseFloat(ub))};e.prototype.s4g=function(ub){ub=parseFloat(ub);return 0>ub?e.zba:ub?this.isRow?Z.HelperMethods.SZi(ub):this.Xtc.l0g(ub):0};e.prototype.v4g=function(ub){return ub===e.zba?"":this.isRow?this.Xtc.kCe(ub).toString():this.Xtc.bCe(ub).toFixed(2)};e.prototype.t4g=function(ub){return ub===e.zba?"":ub.toString()};e.prototype.cNh=function(ub){if(!ub||!ub.$$mn()||!ub.zn)return e.zba;var vb=Object(La.a)(459,ub.zn);if(!vb)return e.zba;
for(vb=this.isRow?vb.vyb:vb.tld;ub.$$mn();){var Ka=Object(La.a)(459,ub.zn);if(Ka&&(this.isRow?Ka.vyb:Ka.tld)!==vb)return e.zba}return vb};e.prototype.wIh=function(){for(var ub=[],vb=ik(this.gridView.ha.sa.selectedRanges),Ka=vb.next();!Ka.done;Ka=vb.next()){Ka=Ka.value.clone();var eb=this.gridView.Gf(this.gridView.eb.dj(Ka));eb=Ka.ze(eb.Vg);if(!eb)return null;this.isRow?Ka.right=Ka.left=eb.left:Ka.top=Ka.bottom=eb.top;ub.push(Ka)}return ub.length?this.gridView.Y$("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",
ub):null};e.prototype.Xed=function(ub){if(!Ra.a.l5(ub))return 1;ub=this.K3e(ub,this.IAb);return!ub&&this.Smi()?3:this.Rpi(ub)?0:2};e.prototype.Smi=function(){var ub=this.gridView.ha.sa.selectedRanges;return this.isRow&&X.P(ub)||!this.isRow&&X.O(ub)};e.prototype.ocd=function(ub){var vb="";switch(ub){case 0:vb="";break;case 1:vb=ha.a.instance.ga(770);break;case 2:vb=String.format(ha.a.instance.mb(99),0,this.Rbc(this.IAb));break;case 3:vb=ha.a.instance.ga(771)}return vb};e.prototype.Rpi=function(ub){return 0<=
ub&&ub<=this.Rbc(!1)};e.prototype.Rbc=function(ub){return this.Xtc.Rbc(ub,this.isRow)};e.rPd=function(ub,vb,Ka){if(vb)for(ub.ColumnWidth=e.zba,ub.RowHeight=Ka,ub=ik(ub.SheetMultiRange.Ranges),vb=ub.next();!vb.done;vb=ub.next())vb=vb.value,vb.FirstColumn=0,vb.LastColumn=0;else for(ub.RowHeight=e.zba,ub.ColumnWidth=Ka,ub=ik(ub.SheetMultiRange.Ranges),vb=ub.next();!vb.done;vb=ub.next())vb=vb.value,vb.FirstRow=0,vb.LastRow=0};of.Object.defineProperties(e.prototype,{mc:{configurable:!0,enumerable:!0,get:function(){return"ResizeHeadersDialog"}},
IAb:{configurable:!0,enumerable:!0,get:function(){return e.a$d},set:function(ub){e.a$d=ub}}});e.O4="id";e.gni="isRow";e.tai="initialSizeInPx";e.sai="initialSizeInDefaultUnits";e.Yji="isInitialUnitsDefaultUnits";e.Wed="getInputErrorIfInvalid";e.xDj="size";e.Phi="isDefaultUnits";e.zba=-1;e.a$d=!0;Object(t.a)(e,"ResizeHeadersDialog",u.a,[]);var cb=b(62),Sa=b(359),Db=b(450),Ab=b(64);d.prototype.Nc=function(ub,vb){ub=!0;switch(vb){case -445963340:case 1391094586:ub=this.Ud(8);break;case 745189930:case 146338636:ub=
this.Ud(16)}return!ub};d.prototype.executeCommand=function(ub,vb,Ka){var eb=Ma.TaskExtensions.kk();var yb=V.g(this.$);ub=oa.a.create().toString();var oc=vb.command;switch(oc){case 1391094586:case 146338636:var Jb=1391094586===oc;(ub=Ka.autoFitRanges)&&ub.Ranges&&ub.Ranges.length||(ub=X.r(yb.ha.sa.selectedRanges,this.$));eb=this.fih(Jb?1:0,ub,vb);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:Jb=-445963340===oc||-706918724===oc||369708605===oc;if(-445963340===
oc||745189930===oc)Jb=ja.a(vb.command),yb.si.L7(16,ub,Jb),eb=Ka.resizeRowColumnParameters;else{Ka=yb.ha.sa.selectedRanges;if(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6476251_ReduceLongOpsTel")){var dc=0,$a=ik(Ka);for(yb=$a.next();!yb.done;yb=$a.next())if(yb=yb.value,-706918724===oc||369708605===oc)yb=yb.right-yb.left+1,dc+=0<yb?yb:-1*yb;else if(1542466017===oc||1051390410===oc)dc+=yb.bottom-yb.top+1;369708605===oc||1542466017===oc?A.ULS.sendTraceTag(520938758,0,50,"ResizeCommandHandler.doResize: Unhide Rows/Columns NumberOfRanges="+
dc):(-706918724===oc||1051390410===oc)&&A.ULS.sendTraceTag(520938757,0,50,"ResizeCommandHandler.doResize: hide Rows/Columns NumberOfRanges="+dc)}if(-706918724===oc&&6===vb.Ne&&X.O(Ka)){A.ULS.sendTraceTag(537154007,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideColumn' was ignored because entire row is selected");break}if(1051390410===oc&&6===vb.Ne&&X.P(Ka)){A.ULS.sendTraceTag(537154006,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideRow' was ignored because entire column is selected");
break}oc=369708605===oc||1542466017===oc?-2:0;eb={};eb.SheetMultiRange=X.r(Ka,this.$);if(Jb)for(Ka=ik(eb.SheetMultiRange.Ranges),yb=Ka.next();!yb.done;yb=Ka.next())yb=yb.value,yb.FirstRow=0,yb.LastRow=0;else for(Ka=ik(eb.SheetMultiRange.Ranges),yb=Ka.next();!yb.done;yb=Ka.next())yb=yb.value,yb.FirstColumn=0,yb.LastColumn=0;eb.RowHeight=Jb?-1:oc;eb.ColumnWidth=Jb?oc:-1}eb=this.zih(eb,vb,ub);break;case 957527587:case 2040891415:new e(this.$,vb)}return eb};d.prototype.k0g=function(ub){xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",
!1)&&Ma.TaskExtensions.Aa(Ua.GetServiceTaskFactory.Ra(this.$.da,426,427,1),function(vb){vb.result.dXd(ub,"ColumnAutoFit")},this.$.la,3)};d.prototype.Ac=function(ub,vb,Ka,eb){if(ub=!!Ka&&!!eb&&1===eb.Ry)switch(vb.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;default:ub=!1}return ub};d.prototype.Tc=function(){return!1};d.prototype.owi=function(ub){A.ULS.sendTraceTag(537154004,
0,50,"ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: "+ub.success+". Reason: "+(Object(Db.c)(ub)?void 0:ub.reason)+".")};d.prototype.Ud=function(ub){return(new P.a(this.$.xa)).Ud(ub)};d.prototype.fih=function(ub,vb,Ka){function eb(){return new k(Jb,vb)}var yb=this,oc=this.$.oa.va.Pb(),Jb=0===ub;return aa.a(this.$.userOperationManager,function(dc,$a,Ba){var la=yb.$.oa.va;dc=Ha.b(dc,yb.hJi);var ka={dhi:!Jb,M0b:vb},ca=la.Na(41,oc);ca.isRow=Jb;ca.autoFitRanges=vb;return cb.g(la,
"AutoFit",ca,dc,$a,Ba,ka,0)},function(dc){return new ma.a(135,0,dc,void 0,eb)},Ka)};d.prototype.zih=function(ub,vb,Ka){function eb(){return new h(ub)}function yb(la,ka,ca){oc.$.py();X.i(Jb,",",oc.$,!1);var Ia=oc.$.oa.va;la=Ha.b(la,oc.NRi);var jb=Ia.Na(41,void 0===Ba?null:Ba);jb.resizeRowColumnParameters=ub;return cb.g(Ia,"ResizeRowsColumns",jb,la,ka,ca,Ka,0)}var oc=this,Jb=X.g(ub.SheetMultiRange.Ranges),dc=vb.command;if(745189930===dc||-445963340===dc){A.ULS.shipAssertTag(537154002,0,this.$.activeItemName===
ub.SheetMultiRange.SheetName,"ResizeCommandHandler.DoResize: should do CSE for active sheet only!");var $a=V.g(this.$);dc=745189930===dc;$a=this.Hg.KBj($a,Jb,dc?ub.RowHeight:ub.ColumnWidth,dc);this.owi($a);Object(Db.c)($a)&&V.g(this.$).si.P0(Ka,Aa.BasicTelemetryCalculator.KQ)}var Ba=this.$.oa.va.Pb({D_:!0,SZ:3});return $a&&Object(Db.c)($a)?xa.EwaSettings.Zb()?aa.a(this.$.userOperationManager,yb,function(la){return new ma.a(136,0,la,64,eb)},vb):aa.a(this.$.userOperationManager,yb,function(la){return new ta.a(136,
0,la,void 0,eb)},vb):aa.a(this.$.userOperationManager,yb,function(la){return new ma.a(136,0,la,void 0,eb)},vb)};Object(t.a)(d,"ResizeCommandHandler",null,[401]);var Wb=Za.a;$k(c,Wb);c.prototype.zd=function(){var ub=this,vb=Ua.GetServiceTaskFactory.create(this.$.da,18,this.la,this.hb);Ma.TaskExtensions.Aa(vb,function(){ub.jd([new d(ub.$,vb.result)])},this.la,3)};c.ka=function(ub){Za.a.Pd(113,new c(ub))};Object(t.a)(c,"ResizeCommandHandlerFactory",Za.a,[]);b.d(E,"a",function(){return a})},1382:function(t,
E,b){function a(){Type.registerNamespace("Common.App.OneDriveFilePickerApi");c.main()}function c(){this.fb=null}function d(T){this.Xl=null;this.Qg=T;this.TPc=3}function e(T,G,I,K){G=k.call(this,T,G,I,K)||this;G.options.advanced.filter=T.Wa("OneDriveApiV72Filter")||"folder,photo";G.options.advanced.linkType="download";G.options.multiSelect=F.AFrameworkApplication.vqe;T.qa("OneDriveApiV72CommandModeEnabled")&&(G.options.commandMode=T.Wa("OneDriveApiV72CommandMode")||"none");T.qa("OneDriveApiV72QosExtraDataEnabled")&&
(G.options.qosExtradata=new h(F.AFrameworkApplication.userSessionId));return G}function h(T){this.olsSessionId=this.value=this.key=null;this.olsSessionId=T}function k(T,G,I,K){G=v.call(this,T,G,I,K)||this;G.Hlg=T;G.options={};G.options.advanced={};G.options.action="query";G.options.clientId=G.fa.Wa("OneDriveApiV72ClientId");G.options.advanced.trapFocus=!0;return G}function n(T,G,I,K,L){T=v.call(this,T,G,I,K)||this;T.Ice=null;T.zTb=null;T.Sog=L;T.options={};T.options.clientId=T.fa.Wa("OneDriveApiV7ClientId");
T.options.cancel=Object(y.a)(T,T.uAc,"toggleHostDivVisibility");return T}function f(T,G,I,K,L,O){G=v.call(this,G,I,K,O)||this;G.Ah=null;G.g2=T;G.txg=L;return G}function v(T,G,I,K){this.yEa=this.s6=null;this.QQc=this.SQc=!1;this.VWa=null;this.jb=T;this.dRb=G;this.dEa=I;this.xs=K}function m(){}function x(){var T=u.call(this)||this;T.Rb=0;T.kc(1,CommonUIStrings.l_DialogClose);return T}t=b(0);var l=b(135),u=l.StandardDialog;$k(x,u);x.prototype.displayError=function(T){this.Lz(T,CommonUIStrings.l_DefaultDialogTitle,
CommonUIStrings.l_OneDriveContactError,null)};x.prototype.K6c=function(T){this.Lz(T,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)};Object(t.a)(x,"ErrorDialog",l.StandardDialog,[556]);var A=b(15),z=b(162);m.prototype.KWe=function(){A.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");var T=new z.a;T.setResult("api.onedrive.com");return T.task};Object(t.a)(m,"OneDriveConsumerEndpointHelper",null,[505]);var y=b(84),w=b(52),D=b(397),H=b(239);v.prototype.n4a=
function(){this.VWa||(this.VWa=this.t$a?H.a.create(this.t$a,null,null,null,!1):null);return this.VWa};v.prototype.setup=function(T){var G=this;this.yEa=T;this.SQc||this.QQc?this.SQc&&this.yEa&&this.yEa(!0):(T=this.n4a())?(this.QQc=!0,T.o8a.continueWith(function(I){G.CQi(I)}),D.a.Bia(T)):(A.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.yEa(!1))};v.prototype.QAd=function(T){A.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",
T.exception?T.exception.toString():"No error detail.")};v.prototype.CQi=function(T){this.QQc=!1;if(T.Of)this.QAd(T),this.yEa(!1);else try{this.SQc=!0,A.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.zld(),A.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.yEa(!0)}catch(G){A.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",G.toString()),this.yEa(!1)}};v.prototype.startPicker=function(T){this.s6=T;this.dEa?A.ULS.sendTraceTag(23881878,216,
50,"In limited edit mode, will not show Picker."):(A.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(y.a)(this,this.lzd,"onApiReady")))};v.prototype.lzd=function(T){T?this.Qjc():this.gj()};v.prototype.gj=function(){this.xs().displayError(w.a.NVi)};v.prototype.onSuccess=function(T){A.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.s6&&this.s6(!0,T)};v.prototype.dispose=function(){this.VWa&&this.VWa.dispose()};
of.Object.defineProperties(v.prototype,{nqe:{configurable:!0,enumerable:!0,get:function(){return this.dRb}},fa:{configurable:!0,enumerable:!0,get:function(){return this.jb}}});Object(t.a)(v,"AOneDriveFilePickerApiManager",null,[346,6]);$k(f,v);f.prototype.start=function(T,G){this.Ah=T;this.startPicker(G)};f.prototype.zld=function(){var T={},G={};T=1===this.nqe||2===this.nqe?(T.client_id=this.fa.appSettings.UploadToSkyDriveClientId,T):(G.client_id=this.fa.appSettings.UploadToSkyDriveClientId,G.env=
"INT",G);WL.init(T)};f.prototype.startPicker=function(T){this.s6=T;!this.dEa&&this.g2.WLa?(A.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(y.a)(this,this.lzd,"onApiReady"))):(A.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.txg())};f.prototype.Qjc=function(){try{A.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),WL.fileDialog(this.Ah).then(Object(y.a)(this,this.onSuccess,"onSuccess"),Object(y.a)(this,
this.r6,"onFailure"))}catch(T){A.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",T,T.stack),this.gj()}};f.prototype.r6=function(T){if(T&&T.error){if("user_canceled"===T.error.code){A.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}A.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",T.error.code,T.error.message)}else A.ULS.sendTraceTag(17909060,352,50,"File Dialog returned with no response");this.s6&&this.s6(!1,
T);this.gj()};of.Object.defineProperties(f.prototype,{t$a:{configurable:!0,enumerable:!0,get:function(){return this.fa.Wa("OneDriveApiUrl")}}});Object(t.a)(f,"OneDriveFilePickerApiManagerV5",v,[]);$k(n,v);n.prototype.start=function(T,G){var I=this;this.zTb=G;var K=this.Sog.KWe();K.continueWith(function(){A.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");I.Ice=K.result;I.startPicker(function(L,O){I.uAc();T(L,O)})},3);K.continueWith(function(){A.ULS.sendTraceTag(24134242,
352,15,K.exception.message);I.uAc()},5)};n.prototype.zld=function(){var T=this;this.options.success=function(G){var I={};I.data=G;T.onSuccess(I)};this.options.error=function(G){var I={};I.error=G;T.r6(I)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.Ice;this.options.advanced.iframeParentDiv=this.zTb};n.prototype.Qjc=function(){try{A.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.uAc(),OneDrive.open(this.options)}catch(T){A.ULS.sendTraceTag(22090008,
352,10,"Opening OneDrive file picker threw an exception: {0}",T.message),this.gj()}};n.prototype.r6=function(T){this.s6&&this.s6(!1,T);this.gj()};n.prototype.uAc=function(){this.zTb.style.visibility="hidden"===this.zTb.style.visibility?"":"hidden"};of.Object.defineProperties(n.prototype,{t$a:{configurable:!0,enumerable:!0,get:function(){return this.fa.Wa("OneDriveApiV72Url")}}});Object(t.a)(n,"OneDriveFilePickerApiManagerV7",v,[]);$k(k,v);k.prototype.start=function(T,G,I,K){this.options.advanced.iframeParentDiv=
I;this.options.advanced.endpointHint=K;this.options.cancel=G;this.Hlg.qa("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.startPicker(T)};k.prototype.startPicker=function(T){this.s6=T;this.dEa?A.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(A.ULS.sendTraceTag(24391837,
216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(y.a)(this,this.lzd,"onApiReady")))};k.prototype.zld=function(){var T=this;this.options.success=function(G){var I={};I.data=G;T.onSuccess(I)};this.options.error=function(G){var I={};I.error=G;T.r6(I)}};k.prototype.Qjc=function(){try{A.ULS.sendTraceTag(23881879,216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(T){A.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",
T.message,T.stack),this.gj()}};k.prototype.QAd=function(T){A.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",T.exception?T.exception.toString():"No error detail.");D.a.rbj(this.t$a);this.VWa=null};k.prototype.gj=function(){this.xs().K6c(w.a.Vkj)};k.prototype.r6=function(T){this.s6&&this.s6(!1,T)};of.Object.defineProperties(k.prototype,{t$a:{configurable:!0,enumerable:!0,get:function(){return this.fa.Wa("OneDriveApiV72Url")}}});Object(t.a)(k,"OneDriveFilePickerApiManagerV72",
v,[]);Object(t.a)(h,"IExtraData",null,[]);var F=b(4);$k(e,k);e.prototype.Qjc=function(){try{A.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",F.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(T){A.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",
T.message,T.stack),this.gj()}};of.Object.defineProperties(e.prototype,{t$a:{configurable:!0,enumerable:!0,get:function(){return this.fa.Wa("OneDriveApiV72Url")}}});Object(t.a)(e,"OneDriveFilePickerApiOpenManagerV72",k,[]);var J=b(250);d.prototype.KWe=function(){this.Xl=new z.a;A.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.KNd();return this.Xl.task};d.prototype.KNd=function(T){T=void 0===T?null:T;var G=String.format("GetMoreInfoHandler.ashx?{0}",
F.AFrameworkApplication.ZHa);this.Qg.P9(G,1,null,T,["PersonalFileStorageUrl","X-NewKey"],!1,2,Object(y.a)(this,this.rTh,"getMoreInfoSucceeded"),Object(y.a)(this,this.pTh,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,"21")};d.prototype.pTh=function(T){if(T.data.httpStatus===J.a.WGb&&"X-NewKey"in T.data.responseHeaders){A.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");var G={};G["X-Key"]=T.data.responseHeaders["X-NewKey"];
this.KNd(G)}else 0<this.TPc?(A.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.TPc),this.TPc--,this.KNd()):(A.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.Xl.setException(Error.create("GetMoreInfo request failed and no more retries remain")))};d.prototype.rTh=function(T){"PersonalFileStorageUrl"in T.data.responseHeaders&&""!==T.data.responseHeaders.PersonalFileStorageUrl?
(A.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.Xl.setResult(T.data.responseHeaders.PersonalFileStorageUrl)):(A.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.Xl.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))};Object(t.a)(d,"OneDriveForBusinessEndpointHelper",null,[505]);var S=b(258),N=b(632);c.prototype.init=function(){};c.prototype.dispose=function(){};c.prototype.Sh=
function(T){var G=this;this.fb=T;this.fb.register(f,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").tc().Dc(function(){return new f(N.a.instance,F.AFrameworkApplication.fa,F.AFrameworkApplication.n2a,F.AFrameworkApplication.limitedEdit,F.AFrameworkApplication.D4f,function(){return new x})});F.AFrameworkApplication.rhf?this.fb.register(505,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").tc().Dc(function(){return new m}):
this.fb.register(505,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").tc().Dc(function(){return new d(F.AFrameworkApplication.nd)});this.fb.register(n,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").tc().Dc(function(){return new n(F.AFrameworkApplication.fa,F.AFrameworkApplication.n2a,F.AFrameworkApplication.limitedEdit,function(){return new x},G.fb.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper"))});this.fb.register(k,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").tc().Dc(function(){return new k(F.AFrameworkApplication.fa,
F.AFrameworkApplication.n2a,F.AFrameworkApplication.limitedEdit,function(){return new x})});this.fb.register(e,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").tc().Dc(function(){return new e(F.AFrameworkApplication.fa,F.AFrameworkApplication.n2a,F.AFrameworkApplication.limitedEdit,function(){return new x})})};c.main=function(){S.a.instance.Qi(new c)};of.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.OneDriveFilePickerApi"}}});
Object(t.a)(c,"PackageManager",null,[10,11]);b.d(E,"a",function(){return a})},1388:function(t,E,b){function a(){Type.registerNamespace("Common.App.SaveAsToHost");c.main()}function c(){this.fb=null}function d(U,X,P,ea,ia,da,xa,Z){this.rm=null;this.WWa=this.xDa=!1;this.Cga=this.Ah=this.fA=null;this.jb=X;this.xFa=this.jb.appSettings.SaveAsToHostWebServiceBase;this.Q8d=ea;this.flb=ia;this.Qg=P;this.xs=da;this.qh=Z;this.Ue=xa;this.La=U;this.Cfa=X.Wa("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}
function e(U,X,P){this.Dga=P;this.zIc=X;this.jb=U}function h(U,X,P,ea,ia,da){this.La=X;this.jb=U;this.BX=ea;this.Dga=da;this.xs=ia;this.Ue=P}function k(U,X,P,ea,ia,da){U=H.call(this,U,X,P,ea,ia,da)||this;U.Xf=n.Xf;U.ye="FileNameDialog-SaveAsToHost";return U}function n(){}function f(U,X){this.jb=U;this.La=X;this.Aib=this.jb.qa("SaveToHostWithExtraCharsInFileName")}function v(U,X){var P=z.call(this)||this;P.WWa=!1;P.fA=null;P.La=U;P.Aib=X;P.nSa=!1;return P}t=b(0);var m=b(84),x=b(15),l=b(135),u=b(52),
A=b(25),z=l.StandardDialog;$k(v,z);v.prototype.displayError=function(U,X,P){this.fA=X;this.WWa=P;x.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",U,P);U=this.b0c(U);0===U?(this.Rb=6,this.kc(0,CommonUIStrings.l_DialogClose)):(this.Rb=0,this.kc(1,CommonUIStrings.l_DialogClose));0===U&&x.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.Lz(u.a.Ukj,this.Kdd(U),this.SNh(U,X),Object(m.a)(this,this.TLd,"retryDialogHandler"),!0)};v.prototype.TLd=function(U){1===
U?(x.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.fA?this.La.$d(A.a.bKb,2,[this.fA,this.WWa]):this.La.processAction(A.a.bKb,2)):x.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")};v.prototype.b0c=function(U){return 0>U||6<U?(x.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",U),0):U};v.prototype.SNh=function(U,X){U=this.b0c(U);return this.Aib?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,
CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,X),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][U]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,X),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][U]};v.prototype.Kdd=
function(U){U=this.b0c(U);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][U]};Object(t.a)(v,"ErrorRetryDialog",l.StandardDialog,[830]);f.prototype.create=function(){return new v(this.La,this.Aib)};Object(t.a)(f,"ErrorRetryDialogFactory",null,[813]);l=b(1265);var y=b(150);of.Object.defineProperties(n,
{Xf:{configurable:!0,enumerable:!0,get:function(){return y.a.Oo(n.rk,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}});n.rk="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(t.a)(n,"FileNameDialogHtml",null,[]);var w=b(4),D=b(29),H=l.a;$k(k,H);k.prototype.aQ=function(U,X){var P=D.a.oq(w.AFrameworkApplication.cm.Pm),ea={};X=(ea.txtFileName=U||P,ea.lblFolderName=CommonUIStrings.l_ToCurrentFolder,ea.chkOverwrite=X,ea);this.initializeAndShow(CommonUIStrings.L_SaveAs,Object(m.a)(this,this.P9b,"fileNameDialogHandler"),X);this.kIe(U,P)};Object(t.a)(k,"FileNameDialog",l.a,[829]);h.prototype.create=function(){return new k(this.jb,this.La,this.Ue,this.BX,this.xs,this.Dga)};
Object(t.a)(h,"FileNameDialogFactory",null,[814]);var F=b(748),J=b(107);e.prototype.Ag=function(){2===w.AFrameworkApplication.ta.Qa.rj?w.AFrameworkApplication.ub.He(A.a.bKb,J.a.frame,Object(m.a)(this,this.QVf,"saveAsToHostActionDispatcher"),4):w.AFrameworkApplication.ub.Mb(A.a.bKb,J.a.frame,Object(m.a)(this,this.QVf,"saveAsToHostActionDispatcher"))};e.prototype.QVf=function(U,X,P,ea,ia){return X.contextId!==J.a.frame||U!==A.a.bKb?2:this.jb.qa("SaveAsToHostBrsIsEnabled")?1===P?F.SessionStatusManager.instance.jxb||
w.AFrameworkApplication.h5?8:32:2===P?(x.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),U=this.zIc.create(),ia&&Object.getType(ia)===Array&&2===ia.length?U.aQ(ia[0],!!ia[1]):U.aQ(null,!1),32):8:8};Object(t.a)(e,"SaveAsToHostActor",null,[]);var S=b(42),N=b(81),T=b(39),G=b(250),I=b(396),K=b(170),L=b(749),O=b(987);d.prototype.DMb=function(){1!==this.Ue.state&&(this.rm=this.flb(),this.rm.message=CommonUIStrings.l_CommentProgressTooltip,this.rm.Rb=5,this.rm.Su=
!1,this.rm.TAa(CommonUIStrings.l_DefaultDialogTitle,null,null))};d.prototype.eS=function(U){U=void 0===U?0:U;1!==this.Ue.state&&this.xs.create().displayError(U,D.a.oq(this.fA),this.WWa)};d.prototype.cQa=function(){var U=this.jb.appSettings.BreadcrumbFolderUrl;x.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");T.a.Te(U,T.a.sX(3),void 0,"UploadToHostManager.RedirectToFolder")};d.prototype.bQa=function(U){var X=!1,P=!1;this.jb&&(X=this.jb.qa("SaveACopyIsEnabledForUiHost"),
P=this.jb.qa("UiHostSupportsDocRebootFeatures"));x.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",U,X,P);if(X&&P){x.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var ea={};ea[I.a.XPa]="1";ea[I.a.documentUrl]=U;ea[I.a.reason]=L.a.saveAs;w.AFrameworkApplication.iV().execute(function(ia){ia.wj(K.a.Sta,ea)})}else X&&!P&&w.AFrameworkApplication.Kba?T.a.Te(U,T.a.sX(4),void 0,
"UploadToHostManager.RedirectToEditUrl"):T.a.Te(U,T.a.sX(3),void 0,"UploadToHostManager.RedirectToEditUrl")};d.prototype.boa=function(U,X,P){P=void 0===P?null:P;x.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.Q8d&&!this.Q8d()&&this.Qg&&(this.qh&&(this.Cga=this.qh.sc("DialogShown","SaveAsToHostUploadTime")),this.DMb(),this.WWa=X,this.fA=U,(this.Ah=P)&&"true"===this.Ah.SkipSaveToHost?this.m9b():this.jQ())};d.prototype.jQ=function(){var U=this;32!==this.La.processAction(A.a.aRa,1)?
(x.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.m9b()):this.La.$d(A.a.aRa,2,[function(){x.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");U.m9b()},function(X,P){x.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");U.eS(P)}])};d.prototype.$Ui=function(U){this.DIa();this.xDa=!1;if(U&&U.data&&U.data.Rd){var X=S.d(U.data.Rd);var P=
X.Ot;if(X.returnValue)if(P.StatusCode!==G.a.QO&&P.StatusCode!==G.a.Wrb)x.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON."),U={},U.FailureReason=P.StatusCode.toString(),U.ExtraInfo=P.ExtraInfo,this.yda(U),this.eS(parseInt(P.ExtraInfo));else{x.ULS.sendTraceTag(8194050,216,50,"UploadToHost execute success.");this.IKd();try{P.NewDocumentUrl&&""!==P.NewDocumentUrl?this.bQa(P.NewDocumentUrl):this.cQa()}catch(ea){x.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",
ea.toString())}this.DGb()}else P={},x.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",(P.ResponseData=O.a.afb(U.data.Rd),P)),U={},this.yda((U.FailureReason="Failed to deserialize response",U)),this.eS()}else x.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),U={},this.yda((U.FailureReason="null response",U)),this.eS()};d.prototype.ZUi=function(U){if(5!==U.data.status&&12!==U.data.status||this.xDa){var X={};x.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",
(X.Status=U.data.status,X.HttpStatus=U.data.httpStatus,X));X={};this.yda((X.FailureReason=U.data.httpStatus.toString(),X));this.DIa();this.eS();this.DGb()}else x.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.xDa=!0,this.Ah&&"true"===this.Ah.SkipSaveToHost?this.m9b():this.jQ()};d.prototype.DIa=function(){this.rm&&(this.rm.close(),this.rm=null)};d.prototype.DGb=function(){this.Cga&&(this.Cga.stop(),this.Cga=null)};d.prototype.IKd=function(){this.Ah&&"VersionHistory"===
this.Ah.SaveEntryPoint&&this.La.processAction(A.a.Ktc,2)};d.prototype.yda=function(U){this.Ah&&"VersionHistory"===this.Ah.SaveEntryPoint&&this.La.$d(A.a.KKd,2,U)};d.prototype.m9b=function(){var U=this.xFa+this.Cfa;U=N.a.wl(U,"qs",D.a.$e(w.AFrameworkApplication.Yi));U=N.a.wl(U,"n",D.a.$e((new Date).getTime().toString()));U=N.a.wl(U,"ov",D.a.$e(this.WWa.toString()));U=N.a.wl(U,"fn",D.a.$e(this.fA));this.Ah&&this.Ah.FileDownloadUrl&&(U=N.a.wl(U,"furl",D.a.$e(this.Ah.FileDownloadUrl)));this.Qg.Zl(U,1,
"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(m.a)(this,this.$Ui,"onUploadFinished"),Object(m.a)(this,this.ZUi,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")};Object(t.a)(d,"UploadToHostManager",null,[705]);var B=b(258),Q=b(1005);c.prototype.init=function(){w.AFrameworkApplication.fa.Vu(Object(m.a)(this,this.pB,"onFullAppSettingsReady"))};c.prototype.pB=function(){w.AFrameworkApplication.fa.qa("SaveAsToHostBrsIsEnabled")&&this.fb.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Ag()};
c.prototype.Sh=function(U){this.fb=U;this.fb.register(f,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Dc(function(){return new f(w.AFrameworkApplication.fa,w.AFrameworkApplication.ub)}).tc();this.fb.register(d,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Dc(function(){return new d(w.AFrameworkApplication.ub,w.AFrameworkApplication.fa,w.AFrameworkApplication.nd,function(){return w.AFrameworkApplication.zg},
function(){return(new Q.a).create()},U.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),w.AFrameworkApplication.ta,w.AFrameworkApplication.ta.sD)}).tc();this.fb.register(h,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Dc(function(){return new h(w.AFrameworkApplication.fa,w.AFrameworkApplication.ub,w.AFrameworkApplication.ta,w.AFrameworkApplication.ta.Qa,U.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),U.resolve("Common.App.SaveAsToHost.UploadToHostManager"))}).tc();
this.fb.register(e,"Common.App.SaveAsToHost.SaveAsToHostActor").Dc(function(){return new e(w.AFrameworkApplication.fa,U.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),U.resolve("Common.App.SaveAsToHost.UploadToHostManager"))}).tc()};c.prototype.dispose=function(){};c.main=function(){B.a.instance.Qi(new c)};of.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveAsToHost"}}});Object(t.a)(c,"SaveAsToHostPackage",null,[10,11]);b.d(E,
"a",function(){return a})},1389:function(t,E,b){function a(){Type.registerNamespace("Common.App.SaveACopy");c.main()}function c(){this.fb=null}function d(O,B,Q,U,X,P){B=G.call(this,B,Q,U,X,P)||this;B.La=O;return B}function e(O,B,Q,U,X,P,ea){B=N.call(this,B,Q,U,X,P,ea)||this;B.tpg=O;return B}function h(O,B,Q,U){O=S.call(this,O,B,Q,U)||this;O.pug=B;return O}function k(O){var B=D.call(this)||this;B.Rb=1;B.kc(1,CommonUIStrings.l_RetryButtonLabel);B.kc(0,CommonUIStrings.l_DialogClose);B.La=O;return B}
function n(O,B,Q){this.La=O;this.BX=B;this.wmb=Q}function f(O,B,Q,U){var X=z.call(this)||this;X.Q8=null;X.mTb=null;X.La=O;X.BX=B;X.wmb=Q;X.kc(1,CommonUIStrings.l_SaveButtonLabel);X.Xf=v.Xf;X.ye="FileNameDialog-SaveACopy";X.Ah=U;return X}function v(){}t=b(0);var m=b(84),x=b(15),l=b(150);of.Object.defineProperties(v,{Xf:{configurable:!0,enumerable:!0,get:function(){return l.a.Oo(v.rk,CommonUIStrings.l_SaveACopyFileName)}}});v.rk="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(t.a)(v,"FileNameDialogHtml",null,[]);var u=b(4),A=b(29),z=l.a;$k(f,z);f.prototype.aQ=function(O,B,Q){this.mTb=O;this.Q8=Q;O={};B=(O.txtFileName=A.a.oq(u.AFrameworkApplication.cm.Pm),O.lblFolderName=String.format(CommonUIStrings.l_DestinationFolder,B),O);this.initializeAndShow(CommonUIStrings.l_SaveToOneDrive,Object(m.a)(this,this.P9b,"fileNameDialogHandler"),B);x.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()};
f.prototype.P9b=function(O,B){1!==O?x.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(O=B.txtFileName.trim(),x.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),B=A.a.l4(u.AFrameworkApplication.fileName),O&&""!==O&&""!==B&&(O+=B),this.wmb.boa(this.mTb,this.Q8,O,this.Ah))};Object(t.a)(f,"FileNameDialog",l.a,[826]);n.prototype.create=function(O){return new f(this.La,this.BX,this.wmb,O)};Object(t.a)(n,"FileNameDialogFactory",
null,[812]);var y=b(135),w=b(25),D=y.StandardDialog;$k(k,D);k.prototype.displayError=function(O){x.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",O);this.Lz(O,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(m.a)(this,this.TLd,"retryDialogHandler"))};k.prototype.TLd=function(O){1===O?(x.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.La.processAction(w.a.saveACopy,2)):x.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")};
Object(t.a)(k,"RetryDialog",y.StandardDialog,[811]);y=b(1266);var H=b(1056),F=b(397),J=b(107),S=y.a;$k(h,S);h.prototype.y7a=function(){return this.jb.qa("SaveACopyBrsIsEnabled")};h.prototype.pWe=function(){return w.a.saveACopy};h.prototype.R1b=function(){F.a.SHd(Object(m.a)(this,this.jWf,"saveToCloudActionDispatcher"));F.a.k8c([new H.a(w.a.saveACopy,J.a.frame,0)],this.pug.n4a())};h.prototype.uNf=function(){x.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")};Object(t.a)(h,
"SaveACopyActor",y.a,[]);y=b(1269);var N=y.a;$k(e,N);e.prototype.onSuccess=function(O){O&&O.data&&O.data.folders?(x.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.tpg.create(this.Ah).aQ(O.data.folders[0].id,O.data.folders[0].name,O.data.folders[0].urls.viewInBrowser)):(x.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.gj())};e.prototype.r6=function(O){O&&O.error&&"user_canceled"===O.error.code&&x.ULS.sendTraceTag(7205457,216,50,
"User cancelled upload to their OneDrive in Save A Copy.");N.prototype.r6.call(this,O)};e.prototype.gj=function(){x.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");N.prototype.gj.call(this)};Object(t.a)(e,"SaveACopyManager",y.a,[]);var T=b(1267),G=T.a;$k(d,G);d.prototype.pqd=function(){return!!this.Ah&&!!this.Ah.SaveEntryPoint&&"VersionHistory"===this.Ah.SaveEntryPoint.toString()};d.prototype.eS=function(){x.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");
if(this.pqd()){var O={};this.La.$d(w.a.KKd,2,(O.FailureReason="Unknown",O))}G.prototype.eS.call(this)};d.prototype.cQa=function(){x.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.pqd()&&this.La.processAction(w.a.Ktc,2);G.prototype.cQa.call(this)};d.prototype.bQa=function(O){x.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",O);this.pqd()&&this.La.processAction(w.a.Ktc,2);G.prototype.bQa.call(this,O)};d.prototype.jQ=function(){var O=
this;this.Ah&&"true"===this.Ah.SkipSaveToHost?G.prototype.jQ.call(this):32!==this.La.processAction(w.a.aRa,1)?(x.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),G.prototype.jQ.call(this)):this.La.$d(w.a.aRa,2,[function(){x.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");T.a.prototype.jQ.call(O)},function(){x.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");
O.eS()}])};Object(t.a)(d,"SaveACopyUploadToCloudManager",T.a,[]);var I=b(258),K=b(632),L=b(1005);c.prototype.init=function(){u.AFrameworkApplication.fa.Vu(Object(m.a)(this,this.pB,"onFullAppSettingsReady"))};c.prototype.pB=function(){u.AFrameworkApplication.fa.qa("SaveACopyBrsIsEnabled")&&this.fb.resolve("Common.App.SaveACopy.SaveACopyActor").Ag()};c.prototype.dispose=function(){};c.prototype.Sh=function(O){this.fb=O;this.fb.register(d,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Dc(function(){return new d(u.AFrameworkApplication.ub,
O.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),function(){return(new L.a).create()},function(){return new k(u.AFrameworkApplication.ub)},u.AFrameworkApplication.ta,u.AFrameworkApplication.ta.sD)}).tc();this.fb.register(n,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Dc(function(){return new n(u.AFrameworkApplication.ub,u.AFrameworkApplication.ta.Qa,O.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))}).tc();this.fb.register(h,
"Common.App.SaveACopy.SaveACopyActor").Dc(function(){return new h(O.resolve("Common.App.SaveACopy.SaveACopyManager"),O.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),u.AFrameworkApplication.fa,u.AFrameworkApplication.ta.sD)}).tc();this.fb.register(e,"Common.App.SaveACopy.SaveACopyManager").Dc(function(){return new e(O.resolve("Common.App.SaveACopy.FileNameDialogFactory"),O.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),K.a.instance,O.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),
u.AFrameworkApplication.fa,u.AFrameworkApplication.n2a,function(){return new k(u.AFrameworkApplication.ub)})}).tc()};c.main=function(){I.a.instance.Qi(new c)};of.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveACopy"}}});Object(t.a)(c,"PackageManager",null,[10,11]);b.d(E,"a",function(){return a})},1395:function(t,E,b){function a(){m.a.Fa(c.ka);m.a.Fa(h.ka)}function c(B,Q,U,X){var P=O.call(this)||this;P.activityName=B;P.sM=Q;P.IJ=U;P.$=
X;P.Eb();return P}function d(B,Q,U){return v.call(this,B,Q,U)||this}function e(B,Q){B=f.call(this,B)||this;B.password=null;B.Aif=Q;B.qg();return B}function h(B,Q,U,X){var P=K.call(this)||this;P.activityName=B;P.sM=Q;P.IJ=U;P.$=X;P.Eb();return P}function k(B,Q,U){return v.call(this,B,Q,U)||this}function n(B){var Q=f.call(this,B)||this;Q.OLd=5;Q.L9d=!1;Q.passwordToModify=null;Q.uGf=function(){Q.$.isEditMode&&Q.Ehc&&(G.b().h8c("PasswordToModifyPasswordVerifiedTillInteractive"),Q.$.sl(Q.uGf))};Q.qg();
Q.$.Uk(Q.uGf);return Q}function f(B){var Q=J.call(this,B)||this;Q.Ppa=0;Q.F6i=function(U,X){Q.Qab(U,X)};Q.a_d=function(U,X){Q.aUa(U,X)};return Q}function v(B,Q,U){var X=w.call(this,B,Q)||this;X.ki=null;X.eDd=null;X.wYi=function(P,ea){X.uGb(P,ea)};X.IJ=U;return X}var m=b(10);t=b(0);var x=b(235),l=b(15),u=b(29),A=b(85),z=b(253),y=b(35),w=z.a;$k(v,w);v.prototype.initialize=function(B){w.prototype.initialize.call(this,B)};v.prototype.execute=function(B){this.ki=B;B=Object(A.a)(2,this.ki.ue);this.Lrb(B);
return 1};v.prototype.uI=function(B){w.prototype.uI.call(this,B)};v.prototype.Lrb=function(){var B=this;this.subscribe(this.ki,this.wYi,function(Q){B.eDd.add_disposing(Q)})};v.prototype.uGb=function(B){this.unsubscribe(function(Q){B.remove_disposing(Q)});this.ki.activityState[y.a.u2]=0};Object(t.a)(v,"PasswordProtectedFileActivity",z.a,[]);var D=b(300),H=b(276),F=b(14),J=D.a;$k(f,J);f.prototype.Qab=function(B){this.Ppa=B};f.prototype.q3=function(){var B={};B[D.a.description]=F.a.instance.ga(1965);
B[D.a.xma]=F.a.instance.ga(1961);B[D.a.tGf]=F.a.instance.ga(1983);B[D.a.rGf]=F.a.instance.ga(1984);B[D.a.sGf]=F.a.instance.ga(1962);B[D.a.ald]=F.a.instance.ga(1968);B[D.a.Tse]=F.a.instance.ga(1658);B[D.a.yXj]=F.a.instance.Xa(25);B[D.a.ggg]=this.a_d;return B};f.prototype.ita=function(){var B={};B[H.a.Hu]=this.mc;B[D.a.a_a]=this.q3();return B};f.prototype.qg=function(){this.Rb=1;this.initializeAndShow(this.zl,this.F6i,this.ita())};of.Object.defineProperties(f.prototype,{mc:{configurable:!0,enumerable:!0,
get:function(){return"PasswordDialog"}},Esb:{configurable:!0,enumerable:!0,get:function(){return this.Ppa}},zl:{configurable:!0,enumerable:!0,get:function(){return F.a.instance.ga(1964)}}});Object(t.a)(f,"PasswordProtectedFilePasswordInputDialog",D.a,[]);var S=b(62),N=b(31),T=b(299),G=b(51);$k(n,f);n.prototype.Qab=function(B,Q){f.prototype.Qab.call(this,B,Q);l.ULS.sendTraceTag(537154755,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFileModifyPasswordInputDialogDisposing: user response: "+
B)};n.prototype.aUa=function(B,Q){this.passwordToModify=B;var U={};U.FileModifyPassword=u.a.$e(B);S.N(this.$.oa.va,U,this.eVi(Q),this.dVi(Q),null,null)};n.prototype.q3=function(){var B=f.prototype.q3.call(this);B[D.a.ald]=F.a.instance.ga(1969);B[D.a.description]=F.a.instance.Xa(24);return B};n.prototype.qg=function(){G.b().h8c("PasswordToModifyDialogShown");l.ULS.sendTraceTag(557446529,0,50,"PasswordProtectedFileModifyPasswordInputDialog.InitializeAndShowDialog: Initializing dialog.");f.prototype.qg.call(this)};
n.prototype.eVi=function(B){var Q=this;return function(U){N.a.$g(U.Errors,[-2019873242])&&Q.e7b(Q.Erb());if(!U||T.a(U))if(0<Q.OLd)Q.VLf(B);else{l.ULS.sendTraceTag(537154754,0,10,"VerifyPasswordToModifyOperation.GenerateOnVerifyPasswordToModifyRequestSuccess: Unexpected error: "+N.a.Cc(U.Errors));Q.$.ea.fp(U.Errors);Q.hide();return}Q.L9d=U.Result;Q.Ehc&&(G.b().VTd("UserAction","Password-To-Modify Workbook: Logging StopWatch duration after user enters corect password","PasswordToModifyPasswordVerifiedTillInteractive"),
l.ULS.sendTraceTag(555758470,0,50,"PasswordProtectedFileModifyPasswordInputDialog.OnVerifyPasswordToModifyRequestSuccess: User entered the correct password."));B(Q.Ehc?0:1)}};n.prototype.dVi=function(B){var Q=this;return function(){0<Q.OLd?Q.VLf(B):(l.ULS.sendTraceTag(537154753,0,10,"PasswordProtectedFileModifyInputDialog.OnVerifyPasswordToModifyRequestFailure: VerifyPasswordToModify request failed."),B(3))}};n.prototype.VLf=function(B){--this.OLd;this.aUa(this.passwordToModify,B)};n.prototype.Erb=
function(){return N.a.Xc(1,0,1657,1658,1,-2019873242,"TooManyWrongPasswordAttemptFileModifyError")};of.Object.defineProperties(n.prototype,{Ehc:{configurable:!0,enumerable:!0,get:function(){return this.L9d}},zl:{configurable:!0,enumerable:!0,get:function(){return F.a.instance.ga(1966)}}});Object(t.a)(n,"PasswordProtectedFileModifyPasswordInputDialog",f,[]);var I=b(6);$k(k,v);k.prototype.Lrb=function(B){this.eDd=new n(B);v.prototype.Lrb.call(this,B)};k.prototype.uGb=function(B,Q){var U=B.Esb,X=B.Ehc,
P=B.passwordToModify;v.prototype.uGb.call(this,B,Q);this.ki.aya([2001366804]);switch(U){case 1:X?(Q=Object(A.a)(2,this.ki.ue),this.ki.activityState[y.a.Yke]=u.a.$e(P),this.ki.activityState[y.a.tYa]=!0,B.passwordToModify="",this.lh(Q.isEditMode?I.a.Gj:this.sM)):l.ULS.sendTraceTag(537154757,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFilePasswordInputDialogDisposing: Unexpected State , Dialog disposed but password not verified.");this.$o();break;case 0:this.ki.activityState[y.a.Es]=!1;
this.lh(this.IJ);this.$o();break;default:l.ULS.sendTraceTag(537154756,0,50,"PasswordToModifyFileModifyActivity.OnPasswordInputCommited: unhandled user response '"+U+"'")}};Object(t.a)(k,"PasswordProtectedFileModifyActivity",v,[]);var K=x.a;$k(h,K);h.prototype.create=function(){this.pb(new k(this.activityName,this.sM,this.IJ))};h.ka=function(B){B.da.Ga(434,new h(I.a.tGb,I.a.Veb,I.a.iHa,B))};Object(t.a)(h,"PasswordProtectedFileModifyActivityFactory",x.a,[]);var L=b(43);$k(e,f);e.prototype.aUa=function(B,
Q){this.password=B;Q(0)};e.prototype.q3=function(){var B=f.prototype.q3.call(this);this.Aif&&(B[D.a.gnh]=1);return B};e.prototype.qg=function(){l.ULS.sendTraceTag(537154722,0,50,"PasswordProtectedFileOpenPasswordInputDialog.InitializeAndShowDialog: Initializing dialog. isWrongPassword="+this.Aif);f.prototype.qg.call(this);L.a(this.$).gpe()};Object(t.a)(e,"PasswordProtectedFileOpenPasswordInputDialog",f,[]);$k(d,v);d.prototype.Lrb=function(B){var Q=N.a.$g(this.ki.errors,[1217361942]);this.eDd=new e(B,
Q);B.Lfc||B.SHe();v.prototype.Lrb.call(this,B)};d.prototype.uGb=function(B,Q){var U=B.password;B.password="";var X=B.Esb;v.prototype.uGb.call(this,B,Q);this.ki.activityState[y.a.dUc]=u.a.$e(U);this.ki.activityState[y.a.tYa]=!0;this.ki.aya([110414285,1217361942]);l.ULS.sendTraceTag(537154752,0,50,"PasswordProtectedFileOpenActivity.PasswordProtectedFileOpenPasswordInputDialogDisposing: user response: "+X);switch(X){case 1:this.lh(this.sM);this.$o();break;case 0:this.lh(this.IJ),this.$o()}};Object(t.a)(d,
"PasswordProtectedFileOpenActivity",v,[]);var O=x.a;$k(c,O);c.prototype.create=function(){this.pb(new d(this.activityName,this.sM,this.IJ))};c.ka=function(B){B.da.Ga(386,new c(I.a.Lpc,I.a.Gj,I.a.Dk,B))};Object(t.a)(c,"PasswordProtectedFileOpenActivityFactory",x.a,[]);b.d(E,"a",function(){return a})},1398:function(t,E,b){function a(){Type.registerNamespace("Common.App.SaveToCloudStorage");c.main()}function c(){this.fb=null}function d(G){this.jb=G;this.yFa=G.appSettings.SkyDriveUploadWebServiceBase;
this.fA=G.appSettings.FileName;this.Cfa=G.Wa("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}function e(G,I,K,L,O,B,Q){this.xFa=G;this.fA=I;this.NVa=K;this.mTb=L;this.qPc=O;this.Cfa=B;this.Ah=Q}function h(G,I,K){this.La=G;this.g2=I;this.BX=K}function k(G,I,K){var L=D.call(this)||this;L.La=G;L.g2=I;L.BX=K;L.Bv=!1;L.Rb=1;L.G0(1);L.kc(1,CommonUIStrings.l_SignIn);L.kc(0,CommonUIStrings.l_SignInToSaveDialogCancelButton);return L}function n(){var G=v.call(this)||this;G.Rb=0;G.kc(1,CommonUIStrings.l_DialogClose);
return G}t=b(0);var f=b(135),v=f.StandardDialog;$k(n,v);n.prototype.displayError=function(G){this.Lz(G,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,null)};Object(t.a)(n,"ErrorDialog",f.StandardDialog,[811]);var m=b(1269),x=b(1266),l=b(15),u=b(84),A=b(4),z=b(263),y=b(39),w=b(25),D=f.StandardDialog;$k(k,D);k.prototype.aQ=function(){this.g2.EYa(Object(u.a)(this,this.pDf,"onSignIn"));this.rl(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,
0,Object(u.a)(this,this.Sci,"inputHandler"))};k.prototype.Sci=function(G){0===G?(l.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide()):this.N6()};k.prototype.UXg=function(){var G="2";if(this.BX)switch(this.BX.rj){case 3:G="0";break;case 2:G="3";break;case 1:G="1"}return G};k.prototype.hide=function(){this.g2.EIb(Object(u.a)(this,this.pDf,"onSignIn"));D.prototype.hide.call(this)};k.prototype.N6=function(){var G=new z.QueryStringBuilder("Signin.aspx");G.Ei("prompt","1");G.Ei("cbcxt",
this.UXg());A.AFrameworkApplication.wYa(G);y.a.Te(G.toString(),"LoginWindow",void 0,"SignInDialog")};k.prototype.pDf=function(){this.vq&&this.hide();l.ULS.sendTraceTag(7143885,216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.La.processAction(w.a.saveToCloudStorage,2)};Object(t.a)(k,"SignInDialog",f.StandardDialog,[825]);h.prototype.create=function(){return new k(this.La,this.g2,this.BX)};Object(t.a)(h,"SignInDialogFactory",null,[808]);var H=b(81),F=b(29);e.prototype.execute=
function(G,I){if(!A.AFrameworkApplication.zg&&A.AFrameworkApplication.nd){var K=this.xFa+this.Cfa;K=H.a.wl(K,"fo",F.a.$e(this.mTb));K=H.a.wl(K,"fn",F.a.$e(this.fA));K=H.a.wl(K,"qs",F.a.$e(this.qPc));K=H.a.wl(K,"n",F.a.$e((new Date).getTime().toString()));this.Ah&&this.Ah.FileDownloadUrl&&(K=H.a.wl(K,"furl",F.a.$e(this.Ah.FileDownloadUrl)));this.NVa&&(K=H.a.wl(K,"fnn",F.a.$e(this.NVa)));A.AFrameworkApplication.nd.Zl(K,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,G,I,null)}};Object(t.a)(e,
"SkyDriveUploadCaller",null,[824]);d.prototype.create=function(G,I,K){return new e(this.yFa,this.fA,I,G,A.AFrameworkApplication.Yi,this.Cfa,K)};Object(t.a)(d,"SkydriveUploadCallerFactory",null,[807]);var J=b(1267),S=b(258),N=b(632),T=b(1005);c.prototype.init=function(){A.AFrameworkApplication.fa.qa("SaveToCloudStorageUIIsEnabled")&&this.fb.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Ag()};c.prototype.dispose=function(){};c.prototype.Sh=function(G){this.fb=G;this.fb.register(h,
"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Dc(function(){return new h(A.AFrameworkApplication.ub,N.a.instance,A.AFrameworkApplication.ta.Qa)}).tc();this.fb.register(d,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Dc(function(){return new d(A.AFrameworkApplication.fa)}).tc();this.fb.register(x.a,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Dc(function(){return new x.a(G.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),
G.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),A.AFrameworkApplication.fa,A.AFrameworkApplication.ta.sD)}).tc();this.fb.register(J.a,"Common.App.SaveToCloudStorage.UploadToCloudManager").Dc(function(){return new J.a(G.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),function(){return(new T.a).create()},function(){return new n},A.AFrameworkApplication.ta,A.AFrameworkApplication.ta.sD)}).tc();this.fb.register(m.a,"Common.App.SaveToCloudStorage.SaveToCloudManager").Dc(function(){return new m.a(G.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),
N.a.instance,G.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),A.AFrameworkApplication.fa,A.AFrameworkApplication.n2a,function(){return new n})}).tc()};c.main=function(){S.a.instance.Qi(new c)};of.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveToCloudStorage"}}});Object(t.a)(c,"PackageManager",null,[10,11]);b.d(E,"a",function(){return a})},1406:function(t,E,b){function a(){this.Bjb=!!m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Qa.Yu}
function c(w,D,H){var F=h.call(this,w,D,H)||this;w={};w=(w.errorMessage=F.oMe,w.errorFileDownloadOffer=F.Btb,w);D={};w.helpLink=(D.type="AppLinkProps",D.id="helpLink",D.text=F.Xva,D.onExecute=function(J){F.uOa(J)},D);D=new y.a(!1,!1,!0);D.Rb=1;D.kc(1,F.Ctb);D.ye=F.id;H={};w=(H.id=F.id,H.dialogIcon=F.icon,H.bodyControls=w,H);D.initializeAndShow(F.zl,Object(f.a)(F,F.KGd,"reactOICErrorDialogHandler"),w);return F}function d(w,D,H,F){var J=n.call(this,w,D,H,F)||this;w={};w=(w.errorMessage=J.errorMessage,
w);D={};w.helpLink=(D.type="AppLinkProps",D.id="helpLink",D.text=J.Xva,D.onExecute=function(S){J.uOa(S)},D);J.sxc?(w.macOfficePreLinkText=J.Xof,D={},w.macOfficeLink=(D.type="AppLinkProps",D.id="macOfficeLink",D.text=J.Uof,D.onExecute=function(S){J.azd(S)},D),w.macOfficePostText=J.Wof):J.b4b&&(w.errorFileDownloadOffer=J.Btb);D=new y.a(!1,!1,!0);J.b4b?(D.Rb=1,D.kc(1,J.Ctb)):D.Rb=0;D.ye=J.id;H={};w=(H.id=J.id,H.dialogIcon=J.icon,H.bodyControls=w,H);D.initializeAndShow(J.zl,Object(f.a)(J,J.KGd,"reactOICErrorDialogHandler"),
w);return J}function e(w,D,H){w=h.call(this,w,D,H)||this;w.Vl=null;D=document.createElement("span");D.id="errorMessageText";D.innerText=w.oMe;D.appendChild(document.createElement("br"));D.appendChild(document.createElement("br"));w.Vl=document.createElement("a");w.Vl.href="#";w.Vl.innerText=w.Xva;D.appendChild(w.Vl);A.a.addHandler(w.Vl,"click",Object(f.a)(w,w.uOa,"oicErrorHelpLinkHandler"));D.appendChild(document.createElement("br"));D.appendChild(document.createElement("br"));H=document.createElement("span");
H.innerText=w.Btb;D.appendChild(H);H=new z.StandardDialog;H.ye=w.id;H.Rb=1;H.kc(1,w.Ctb);H.rl(w.zl,null,w.icon,Object(f.a)(w,w.itd,"legacyOICErrorDialogHandler"),D);H.$W("errorMessageText");return w}function h(w,D,H){this.UX=D;this.VX=w;this.xD=H}function k(w,D,H,F){w=n.call(this,w,D,H,F)||this;w.Vl=null;w.Fqa=null;D=document.createElement("span");D.id="errorMessageText";D.innerText=w.errorMessage;D.appendChild(document.createElement("br"));D.appendChild(document.createElement("br"));w.Vl=document.createElement("a");
w.Vl.href="#";w.Vl.innerText=w.Xva;D.appendChild(w.Vl);A.a.addHandler(w.Vl,"click",Object(f.a)(w,w.uOa,"oicErrorHelpLinkHandler"));H=new z.StandardDialog;H.ye=w.id;if(w.sxc){F=document.createElement("span");var J=document.createElement("span");F.innerText=w.Xof;J.innerText=w.Wof;w.Fqa=document.createElement("a");w.Fqa.href="#";w.Fqa.innerText=w.Uof;D.appendChild(document.createElement("br"));D.appendChild(F);D.appendChild(w.Fqa);D.appendChild(J);A.a.addHandler(w.Fqa,"click",Object(f.a)(w,w.azd,"oicErrorMacOfferLinkHandler"))}else w.b4b&&
(D.appendChild(document.createElement("br")),D.appendChild(document.createElement("br")),F=document.createElement("span"),F.innerText=w.Btb,D.appendChild(F));w.b4b?(H.Rb=1,H.kc(1,w.Ctb)):H.Rb=0;H.rl(w.zl,null,w.icon,Object(f.a)(w,w.itd,"legacyOICErrorDialogHandler"),D);H.$W("errorMessageText");return w}function n(w,D,H,F){this.eNc=null;this.ySb=F;this.UX=w;this.VX=D;this.xD=H;this.Pge=this.Vof.Cyj;w=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.xtg=w[0];this.wtg=w[1]}t=b(0);var f=b(84),
v=b(15),m=b(4),x=b(52),l=b(447),u=b(83);n.prototype.KGd=function(w){this.oEb(w)};n.prototype.itd=function(w){this.oEb(w)};n.prototype.oEb=function(w){var D=10;this.VX&&1===w&&(this.VX(this.xD),D=1);this.UX&&this.UX(this.xD);this.DF(D)};n.prototype.uOa=function(){l.Redirect.showHelp("OICFailure");this.DF(2)};n.prototype.azd=function(){this.Vof.vkf();this.DF(4)};n.prototype.DF=function(w){v.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",this.ySb,w);m.AFrameworkApplication.Ctc(x.a.iFf,
this.ySb,w)};n.prototype.dispose=function(){this.xD=this.UX=this.VX=null};of.Object.defineProperties(n.prototype,{Vof:{configurable:!0,enumerable:!0,get:function(){return this.eNc||(this.eNc=u.a.instance.resolve("Common.IMacOfficeOffer"))}},id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialog"}},errorMessage:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMessage}},Xva:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},
sxc:{configurable:!0,enumerable:!0,get:function(){return this.Pge}},Xof:{configurable:!0,enumerable:!0,get:function(){return this.xtg}},Wof:{configurable:!0,enumerable:!0,get:function(){return this.wtg}},Uof:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMacOFficeLink}},icon:{configurable:!0,enumerable:!0,get:function(){return this.Pge?3:2}},Btb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorFileDownloadOffer}},b4b:{configurable:!0,enumerable:!0,
get:function(){return!!this.VX}},Ctb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}},zl:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});Object(t.a)(n,"AOICErrorDialog",null,[6]);var A=b(44),z=b(135);$k(k,n);k.prototype.dispose=function(){this.Vl&&(A.a.removeHandler(this.Vl,"click",Object(f.a)(this,this.uOa,"oicErrorHelpLinkHandler")),this.Vl=null);this.Fqa&&(A.a.removeHandler(this.Fqa,"click",Object(f.a)(this,
this.azd,"oicErrorMacOfferLinkHandler")),this.Fqa=null);n.prototype.dispose.call(this)};Object(t.a)(k,"OICErrorDialog",n,[]);h.prototype.KGd=function(w){this.oEb(w)};h.prototype.itd=function(w){this.oEb(w)};h.prototype.oEb=function(w){var D=10;1===w&&(this.VX(this.xD),D=1);this.UX&&this.UX(this.xD);this.DF(D)};h.prototype.uOa=function(){l.Redirect.showHelp("OICFailure");this.DF(2)};h.prototype.DF=function(w){m.AFrameworkApplication.Ctc(x.a.jFf,3,w)};h.prototype.dispose=function(){this.xD=this.VX=
this.UX=null};of.Object.defineProperties(h.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialogWithDownload"}},oMe:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDetected}},Xva:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},Btb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorFileDownloadOffer}},Ctb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}},
icon:{configurable:!0,enumerable:!0,get:function(){return 2}},zl:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});Object(t.a)(h,"AOICErrorDialogWithDownload",null,[6]);$k(e,h);e.prototype.dispose=function(){this.Vl&&(A.a.removeHandler(this.Vl,"click",Object(f.a)(this,this.uOa,"oicErrorHelpLinkHandler")),this.Vl=null);h.prototype.dispose.call(this)};Object(t.a)(e,"OICErrorDialogWithDownload",h,[]);var y=b(150);$k(d,n);Object(t.a)(d,"ReactOICErrorDialog",
n,[]);$k(c,h);Object(t.a)(c,"ReactOICErrorDialogWithDownload",h,[]);b.d(E,"a",function(){return a});a.prototype.z9g=function(w,D,H){this.Bjb?new d(w,D,null,H):new k(w,D,null,H)};a.prototype.A9g=function(w,D,H){this.Bjb?new c(w,D,H):new e(w,D,H)};a.prototype.B9g=function(w,D,H,F,J){var S=b(1548).ReactOICErrorDialogWithTrial,N=b(1549).OICErrorDialogWithTrial;this.Bjb?new S(w,D,H,null,F,J):new N(w,D,H,null,F,J)};of.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){return a.Ma||
(a.Ma=new a)}}});a.Ma=null;Object(t.a)(a,"OICErrorDialogFactory",null,[218])},1421:function(t,E,b){function a(){h.a.Fa(c.ka)}function c(S){return J.call(this,S)||this}function d(S,N){this.$=S;this.gridView=N}function e(S,N,T){var G=H.call(this,S)||this;G.Wmb=0;G.rzb=!1;G.I1a=null;G.dIe=!1;G.rrb=!0;G.MTc=null;G.zl=null;G.Kxd=0;G.Lxd=null;G.Jxd=null;G.removeHyperLink=!1;G.cellValue=null;G.location=null;G.G8h=function(I,K){1===I||2===I?(m.ULS.sendTraceTag(555755670,0,50,"HyperLink "+(1===I?"OK":"Remove")+
" pressed"),G.Lxd=K[e.Eti],G.Kxd=K[e.qnj],G.Jxd=K[e.Bhh],2===I&&(G.removeHyperLink=!0),G.commit()):m.ULS.sendTraceTag(537157644,0,50,"HyperLink Cancel pressed")};G.fXj=function(I,K){return 0!==K&&I.length?1===K?G.XYe(f.y(I,G.ea.xa)||G.pDi(I),763):G.XYe(x.a.Qnd(I),765):null};G.selectedRange=N;G.UL=T;G.ea=S.ea;G.sheetName=N.SheetName;G.HLa();G.rn();G.Rb=G.rzb?9:1;G.kc(1,D.a.instance.ga(4));G.rzb&&G.kc(2,D.a.instance.ga(766));S={};S=(S[e.Kgh]=G.dIe,S[e.Chh]=G.I1a,S[e.UAg]=G.Wmb,S[e.VAg]=G.MTc,S[e.R4g]=
G.rrb,S);N={};S=(N[e.Hu]=G.mc,N[e.gXj]=G.fXj,N[e.XPg]=S,N);G.initializeAndShow(G.zl,G.G8h,S);return G}var h=b(10);t=b(0);var k=b(915),n=b(21),f=b(41),v=b(1),m=b(15),x=b(29),l;(function(S){S[S.url=0]="url";S[S.ref=1]="ref";S[S.mailto=2]="mailto"})(l||(l={}));Object(t.b)("HyperlinkSelectionState",l);var u=b(992),A=b(9),z=b(655),y=b(62),w=b(98),D=b(14),H=u.a;$k(e,H);e.prototype.F_e=function(S,N){switch(N){case 2:return S.startsWith("mailto:")?S:"mailto:"+S;case 1:return""+A.a.aIf+this.ASh(S);default:return S}};
e.prototype.Ny=function(){var S=this,N=this.$;this.location=this.F_e(this.Lxd,this.Kxd);try{this.location=w.a.rh(this.location)}catch(I){m.ULS.sendTraceTag(537157643,0,15,"Decoding link text failed")}m.ULS.sendTraceTag(555755667,0,50,"Committing "+l[this.Kxd]+" link");this.cellValue=this.Jxd.length?this.Jxd:this.Lxd;N.py();var T=N.oa.va.Pb(),G=f.s(this.selectedRange);return function(I,K,L){return y.b(N.oa.va,G,S.cellValue,S.location,S.removeHyperLink,!1,123,I,K,L,S.UL.range,T)}};e.prototype.Zi=function(){var S=
this,N=f.s(this.selectedRange);return function(){return new z.a(N,S.cellValue,S.location)}};e.prototype.lzh=function(){var S=this.UL.cell.w5a;this.UL.cell.kxb?S&&S.startsWith("mailto:")?(this.Wmb=2,S=S.substr(7)):this.Wmb=0:this.Wmb=1;return S};e.prototype.HLa=function(){v.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?this.rzb=this.UL.kba:this.rzb=!!this.UL.pKa(64)||!!this.UL.pKa(128)};e.prototype.rn=function(){if(this.rzb){this.I1a=this.UL.text;var S=this.lzh();S&&(this.MTc=
S);this.zl=D.a.instance.ga(826);this.rrb=this.MTc===this.I1a}else this.UL.text?(this.I1a=this.UL.text,this.rrb=!1):(this.I1a="",this.rrb=!0),this.Wmb=0,this.zl=D.a.instance.ga(825);this.UL.PE&&(this.rrb=!1,this.dIe=!0,v.EwaSettings.isChangeGateEnabled("OfficeVSO:5533269_formulaTextFixInHyperLink")&&(this.I1a=this.UL.formulaBarText))};e.prototype.pDi=function(S){return this.ea.vb.Mj(S)};e.prototype.XYe=function(S,N){return S?null:D.a.instance.ga(N)};e.prototype.ASh=function(S){var N=f.Z(S,this.ea.xa);
var T=N.sheetName;var G=N.range;N.returnValue&&G&&(S=f.x(G,T||this.sheetName,!1));return S};of.Object.defineProperties(e.prototype,{mc:{configurable:!0,enumerable:!0,get:function(){return"HyperLinkDialog"}},vv:{configurable:!0,enumerable:!0,get:function(){return 526}}});e.gXj="validateLinkValues";e.XPg="bodyProps";e.Kgh="disableDisplayText";e.Chh="displayTextValue";e.UAg="activeLinkOption";e.VAg="activeLinkValue";e.R4g="copyLinkValueToDisplay";e.Eti="linkValue";e.qnj="selectedLink";e.Bhh="displayText";
Object(t.a)(e,"HyperlinkDialog",u.a,[]);var F=b(58);d.prototype.Nc=function(){return!1};d.prototype.Ac=function(S,N){return 1===S&&-1583422759===N.command};d.prototype.Tc=function(){return!1};d.prototype.executeCommand=function(){this.EBj();return F.Task.Ua(!0)};d.prototype.EBj=function(){var S=f.v(this.gridView.ha.sa.Vc,this.$),N=n.e(this.gridView);(!v.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.iq([this.gridView.ha.sa.Vc],!0))&&
N&&new e(this.$,S,N)};Object(t.a)(d,"ShowHyperlinkCommandHandler",null,[401]);var J=k.a;$k(c,J);c.prototype.zd=function(){this.jd([new d(this.$,n.g(this.$))])};c.ka=function(S){k.a.Pd(105,new c(S))};Object(t.a)(c,"ShowHyperlinkCommandHandlerFactory",k.a,[]);b.d(E,"a",function(){return a})},1422:function(t,E,b){function a(){k.a.Fa(e.ka);k.a.Fa(c.ka)}function c(F){var J=H.call(this)||this;J.$=F;J.Eb();return J}function d(F,J){this.$=F;this.oi=J;this.$.da.Ga(393,this)}function e(F){var J=w.call(this,
F)||this;J.dEh=function(S,N,T,G,I){return 1===T?32:S===z.a.aRa&&2===T?(S=J.$.oa.va.Pb(),m.D(J.$.oa.va,I[0],I[1],null,null,S),32):8};return J}function h(F,J){this.$=F;this.oi=J}var k=b(10);t=b(0);var n=b(4),f=b(107),v=b(915),m=b(62),x=b(50),l=b(37),u=b(15),A=b(187),z=b(25),y=b(58);h.prototype.Nc=function(){return!1};h.prototype.executeCommand=function(F,J,S){F=2;switch(J.command){case -309686558:F=this.oi.$d(z.a.saveACopy,2,S);break;case 617689800:F=this.oi.$d(z.a.saveToCloudStorage,2,S);break;case -1244760097:F=
this.oi.$d(z.a.saveToSharePoint,2,S)}return 2===F&&J?A.a(J.command):y.Task.Ua(!0)};h.prototype.Ac=function(F,J){F=!1;switch(J.command){case -1244760097:case -309686558:case 617689800:F=!0,u.ULS.shipAssertTag(537153984,0,this.$.zka,"Command execute requested for SaveAs operation when data duplication is disallowed.")}return F};h.prototype.Tc=function(){return!1};Object(t.a)(h,"SaveToHostCommandHandler",null,[401]);var w=v.a;$k(e,w);e.prototype.zd=function(){var F=this;l.TaskExtensions.Aa(x.GetServiceTaskFactory.create(this.$.da,
155,this.la,this.hb),function(){F.jd([new h(F.$,n.AFrameworkApplication.ub)])},this.la,3);n.AFrameworkApplication.ub.Mb(z.a.aRa,f.a.frame,this.dEh)};e.ka=function(F){v.a.Pd(267,new e(F))};Object(t.a)(e,"SaveToHostCommandHandlerFactory",v.a,[]);var D=b(235);d.prototype.Nc=function(F){switch(F){case -309686558:return 8===this.oi.processAction(z.a.saveACopy,1,null);case 617689800:return 8===this.oi.$d(z.a.saveToCloudStorage,1,null);case -1244760097:return 8===this.oi.$d(z.a.saveToSharePoint,1,null)}return!1};
d.prototype.dispose=function(){this.$=null};Object(t.a)(d,"SaveToHostManager",null,[684,6]);var H=D.a;$k(c,H);c.prototype.create=function(){this.pb(this.$.da.za(393)||new d(this.$,n.AFrameworkApplication.ub))};c.ka=function(F){F.da.Ga(394,new c(F))};Object(t.a)(c,"SaveToHostManagerFactory",D.a,[]);b.d(E,"a",function(){return a})},1423:function(t,E,b){function a(){k.a.Fa(function(L){e.ka(L);c.ka(L)})}function c(L,O){var B=K.call(this)||this;B.activityName=L;B.sM=O;B.Eb();return B}function d(L,O,B,
Q,U){L=I.call(this,L,O)||this;d.zvd=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];d.yvd=[-1468309555,-315732528,-399065540,810218235,1531005923,1593924569,1112506702,1220851643];d.Pof=[-1468309555,611268539,-1750576502,61029505];d.Oof=[-1468309555,-315732528,1112506702,-238814601,-1750576502,61029505,-1337545025];L.kyc=B;L.qDj=Q;L.BMj=U;return L}function e(){var L=z.call(this)||this;L.Eb();return L}function h(L,O){return u.call(this,L,O)||this}var k=b(10);t=b(0);var n=b(235),
f=b(15),v=b(85),m=b(115),x=b(31),l=b(35),u=m.a;$k(h,u);h.prototype.execute=function(L){var O=Object(v.a)(2,L.ue);f.ULS.shipAssertTag(537153921,0,x.a.uob(L.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");O.XH(!0,!0);L.activityState[l.a.ZYb]=O.ea.sessionId;L.activityState[l.a.Zmb]=!0;L.activityState[l.a.eZb]=!0;f.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3};Object(t.a)(h,"SessionReloadActivity",
m.a,[]);var A=b(6),z=n.a;$k(e,z);e.prototype.create=function(){this.pb(new h(A.a.Gcb,A.a.Ek))};e.ka=function(L){L.da.Ga(142,new e)};Object(t.a)(e,"SessionReloadActivityFactory",n.a,[]);var y=b(54),w=b(282),D=b(110),H=b(47),F=b(45),J=b(34),S=b(1),N=b(46),T=b(256),G=b(116),I=m.a;$k(d,I);d.prototype.execute=function(L){var O=Object(v.a)(2,L.ue);L.activityState[l.a.Ira]=!0;var B=d.SYh(L);if(d.vxj(L,B))return d.Xzi(L),B=50,0<L.errors.length&&(B=15),f.ULS.sendTraceTag(537153891,0,B,"SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : "+
x.a.Cc(L.errors)),L.activityState[l.a.Ira]=!1,this.lh(A.a.idle),3;switch(B){case 1:case 3:this.Jci(L,B);break;case 2:this.Ici(L);break;case 0:L.activityState[l.a.uYa]=null}f.ULS.sendTraceTag(21837003,0,50,"SessionReloadSilentActivity.Execute: silentReloadType:"+B+". activityName:"+this.activityName+". NextActivityName:"+this.P_+". TimeFromLastStatefulResponse:"+O.ea.$0+".");var Q=J.a.vg(L.activityState,G.a.Yeb);f.ULS.shipAssertTag(40502925,0,!Q||Q&&(1===B||3===B),"triggerSilentReloadAfterTokenRefresh: "+
Q+", silentReloadType: "+B);O=O.Ok.reloadCount;return 0!==B&&0<O?(Q=w.a.yva(O,200),f.ULS.sendTraceTag(537153890,0,50,"SessionReloadSilentActivity.Execute: schedule Silent-Type ["+B+"] retryNum ["+O+"] delayInMs ["+Q+"] activityName ["+this.activityName+"]"),H.a.instance.create(function(){d.mM(L)},Q,F.a.Bpj),1):3};d.prototype.Jci=function(L,O){f.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");var B=Object(v.a)(2,L.ue);L.activityState[l.a.Zmb]=
!0;B.Lfc||N.PageLoadTrackingInfo.instance.kj("ReopenOnLoad");!d.isEditMode(L)&&x.a.uob(L.errors)&&(f.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),L.activityState[l.a.ZYb]=B.ea.sessionId,L.activityState[l.a.eZb]=!0);L.Pvd();3===O?(B.ea.kg()||B.ea.zFi(),B.XH(!0,!0),this.lh(this.BMj),L.activityState[l.a.Oke]=B.workbookContext.CalcMode):(S.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&
1===O&&B.XH(!0,!0),L.activityState[l.a.WTc]=!1,this.lh(this.kyc))};d.prototype.Ici=function(L){f.ULS.sendTraceTag(537153888,0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");L.activityState[l.a.uYa]=null;L.Pvd();this.lh(this.qDj);L=Object(v.a)(2,L.ue);L.Lfc||(N.PageLoadTrackingInfo.instance.kj("RefreshOnLoad"),L.kJb())};d.mM=function(L){L.mM()};d.SYh=function(L){var O=Object(v.a)(2,L.ue),B=O.ea,Q=d.isEditMode(L),U=x.a.$g(L.errors,Q?d.yvd:d.zvd),X=x.a.$g(L.errors,
Q?d.Oof:d.Pof),P=O.LQ,ea=O.Ok.reloadCount,ia=O.ya.MaxConsecutiveSilentReloadAllowed,da=O.Ok.e7e(),xa=x.a.Cc(L.errors),Z=x.a.Cc(L.uza),ha=0<x.a.xM(function(bb){return!bb.triggerSilentReopenOnly},L.errors).length,ya=U,va=J.a.vg(L.activityState,G.a.Yeb);va&&(ya=!0);U={name:"SessionReloadSilentActivity.GetSilentReloadType",editMode:Q,isSilentReopenError:U,isSilentRefreshError:X};U.reloadSequenceCount=O.Ok.jQa;U.reloadCount=ea;U.maxReloads=ia;U.stopSilentReloads=da;U.errorNames=xa;U.processedErrorNames=
Z;U.isClientDirty=P;U.errorsForSilentReopenOnly=ha;U.triggerSilentReloadAfterTokenRefresh=va;U.IsReopenDisabled=O.GMa;P=y.a.xc(U);f.ULS.sendTraceTag(21837004,0,50,P);if(!da){if(ya&&(Q?d.mxj(L):d.oxj(L)))return T.a.f2f(L,O)?3:O.GMa?2:1;if(X&&(Q||!B.Wab))return 2}return 0};d.vxj=function(L,O){for(var B=ik(L.errors),Q=B.next();!Q.done;Q=B.next())if(Q=Q.value,-1337545025===Q.MessageId||-238814601===Q.MessageId)return!1;return x.a.xM(function(U){return!U.triggerSilentReopenOnly},L.errors).length?3!==O:
!1};d.Xzi=function(L){var O=x.a.xM(function(Q){return!Q.triggerSilentReopenOnly},L.errors);O=ik(O);for(var B=O.next();!B.done;B=O.next())L.rla(B.value)};d.isEditMode=function(L){var O=Object(v.a)(2,L.ue);return O.ea.dc?O.Wu&&!!(O.Bd&64):J.a.vg(L.activityState,l.a.Es)};d.oxj=function(L){var O=Object(v.a)(2,L.ue),B=x.a.zaa(L.errors,d.zvd);if(D.b(B,function(Q){return Q.ForceVersionUpgrade}))return!1;L=x.a.uob(L.errors);return!O.ea.Wab||L?!0:!1};d.mxj=function(L){L=x.a.zaa(L.errors,d.yvd);return!D.b(L,
function(O){return O.ForceVersionUpgrade})};d.zvd=null;d.yvd=null;d.Pof=null;d.Oof=null;Object(t.a)(d,"SessionReloadSilentActivity",m.a,[]);var K=n.a;$k(c,K);c.prototype.create=function(){this.pb(new d(this.activityName,this.sM,A.a.Ek,A.a.Oi,A.a.fOb))};c.ka=function(L){L.da.Ga(143,new c(A.a.vna,A.a.Q0b));L.da.Ga(144,new c(A.a.Svc,A.a.aPa));L.da.Ga(145,new c(A.a.Tvc,A.a.kCd));L.da.Ga(154,new c(A.a.Hcb,A.a.IO))};Object(t.a)(c,"SessionReloadSilentActivityFactory",n.a,[]);b.d(E,"a",function(){return a})},
1437:function(t,E,b){function a(){h.a.Fa(c.ka)}function c(F,J,S,N){var T=H.call(this)||this;T.activityName=F;T.sM=J;T.IJ=S;T.$=N;T.Eb();return T}function d(F,J,S){var N=D.call(this,F,J)||this;N.ki=null;N.nti=function(T){var G=N.vs.dd,I=Object(f.a)(2,G.ue);var K=T.Esb;N.unsubscribe(function(B){T.remove_disposing(B)});for(var L=0,O=G.errors.length;L<O;L++)-573864504===G.errors[L].MessageId&&G.rla(G.errors[L]);switch(K){case 1:I.ea.bBc=!0;n.ULS.sendTraceTag(537155485,0,50,"LegacySharedWorkbookActivity.LegacySharedDialogDisposing: User has selected to turn off the Legacy Shared Workbook setting ");
N.lh(I.isEditMode?y.a.fOb:N.Tdh);N.$o();break;case 2:N.lh(y.a.openInExcelClient);N.$o();break;case 0:G.activityState[w.a.Es]=!1,N.lh(N.IJ),N.$o()}};N.Tdh=J;N.IJ=S;return N}function e(F,J){F=z.call(this,F,J)||this;F.Ppa=0;F.qr();return F}var h=b(10);t=b(0);var k=b(235),n=b(15),f=b(85),v=b(253),m=b(334),x=b(31),l=b(14),u=b(404),A=b(98),z=u.a;$k(e,z);e.prototype.nO=function(F,J){this.Ppa=F;z.prototype.nO.call(this,F,J)};e.prototype.qr=function(){z.prototype.qr.call(this);this.Rb=9;var F=this.sSh();this.kc(1,
l.a.instance.ga(1656));this.kc(2,l.a.instance.ga(986));this.rl(l.a.instance.ga(705),A.a.rh(F),this.icon,this.Q0)};e.prototype.sSh=function(){return String.format(l.a.instance.ga(706))};of.Object.defineProperties(e.prototype,{mc:{configurable:!0,enumerable:!0,get:function(){return"SharedWorkbookDialog"}},Esb:{configurable:!0,enumerable:!0,get:function(){return this.Ppa}}});Object(t.a)(e,"LegacySharedWorkbookDialog",u.a,[]);var y=b(6),w=b(35),D=v.a;$k(d,D);d.prototype.initialize=function(F){D.prototype.initialize.call(this,
F)};d.prototype.execute=function(F){this.ki=F;this.g7g();return 1};d.prototype.uI=function(F){D.prototype.uI.call(this,F)};d.prototype.g7g=function(){var F=Object(f.a)(2,this.ki.ue),J=x.a.k_a([-573864504]);J[0].HelpDescription=l.a.instance.ga(708);J[0].HelpTopicId=m.a.oti;var S=new e(F,J[0]);this.subscribe(this.ki,this.nti,function(N){S.add_disposing(N)})};Object(t.a)(d,"LegacySharedWorkbookActivity",v.a,[]);var H=k.a;$k(c,H);c.prototype.create=function(){this.pb(new d(this.activityName,this.sM,this.IJ))};
c.ka=function(F){F.da.Ga(460,new c(y.a.cCb,y.a.Veb,y.a.iHa,F))};Object(t.a)(c,"LegacySharedWorkbookActivityFactory",k.a,[]);b.d(E,"a",function(){return a})},1438:function(t,E,b){function a(){Type.registerNamespace("Common.App.DirectPrint");k.a.instance.Qi(new c)}function c(){this.j5d=this.fb=null}t=b(0);var d=b(1499),e=b(1500),h=b(4);c.prototype.Sh=function(n){var f=this;this.fb=n;n.register(d.a,"Common.App.DirectPrint.DirectPrintDialogFactory").tc().Dc(function(){return new d.a(h.AFrameworkApplication.ta.jX)});
n.register(695,"Common.App.DirectPrint.IDirectPrintManager").tc().Dc(function(){return e.a.create(f.fb)})};c.prototype.init=function(){this.j5d=this.fb.resolve("Common.App.DirectPrint.IDirectPrintManager");this.j5d.start()};c.prototype.dispose=function(){};of.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.DirectPrint"}}});Object(t.a)(c,"PackageManager",null,[10,11]);var k=b(258);b.d(E,"a",function(){return a})},1471:function(t,E,b){function a(B,
Q){var U=O.call(this)||this;U.Pa=new n.a;U.aU=null;U.ZHc=[];U.Rmc=function(){U.$.oa.WLa?U.removeEntry(13):U.Lf(13,null)};U.Iya=function(){T.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&d.ULS.sendTraceTag(537170243,0,50,"BusinessBar.OnNetworkResumed: removing TransientServerCommunicationFailures BB");U.removeEntry(21);U.eC(55)&&(d.ULS.sendTraceTag(537170242,0,15,"BusinessBar.OnNetworkResumed: removing NetworkDown BB"),U.removeEntry(55));U.fSf("OnNetworkResumed")};U.ei=
function(P,ea){P=0;for(var ia=a.Scc().length;P<ia;P++){var da=a.Scc()[P];U.removeEntry(da)}ea.context&&0<ea.context.communicationErrorRetryCount&&(d.ULS.sendTraceTag(537170240,0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),U.removeEntry(21));U.fSf("OnWebMethodSuccess")};U.Kn=function(P,ea){var ia;P=U.aBh(ea.errors);for(var da=[],xa=0,Z=P.length;xa<Z;++xa){var ha=P[xa];if(1===ha.Type&&ha.Appearance&
32)da=U.j5h(ha,da);else if(ea.mpj){d.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");var ya=(null===(ia=ea.context)||void 0===ia?0:ia.stopwatch)?ea.context.stopwatch.qc:-1;5E3>ya?d.ULS.sendTraceTag(537170208,0,50,"OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = "+ya+"ms)."):e.AFrameworkApplication.whf()||U.IEg(ha,
ea.context.methodName)}ya=[].concat(kk(a.Scc()));for(var va=0,bb=da.length;va<bb;++va){var ba=da[va];U.Lf(ba,ha);Array.remove(ya,ba)}ha=0;for(va=ya.length;ha<va;++ha)U.removeEntry(ya[ha])}};U.nFb=function(P,ea){P=0;for(var ia=ea.errors.length;P<ia;++P){var da=ea.errors[P];e.AFrameworkApplication.whf()||(T.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&d.ULS.sendTraceTag(537170207,0,15,"BusinessBar.OnNetworkDownEvent: adding NetworkDown BB"),U.Lf(55,da))}};U.Uc=function(P,
ea){U.Fc(P,ea)};U.Fc=function(){var P=U.$.ea;P.dc||P.kg()||(U.tId(),U.ZHc.length=0)};U.Yc=function(P,ea){U.$.ea.kg()&&!ea.EV||U.h$e(ea.EV)};U.TFb=function(){var P=U.$.userOperationManager.Fcc();P&&P.operation.flags&1&&U.W3f()};U.oyf=function(){U.W3f()};U.Sf=function(){U.Txe();U.e4f()};U.vN=function(){if(U.$.q5&&U.$.ea.kg()&&U.$.ea.dc)if(U.$.ea.isEditMode)U.removeEntry(44),U.removeEntry(12),U.removeEntry(29),U.removeEntry(30),U.removeEntry(31),U.removeEntry(32),U.removeEntry(22),U.removeEntry(56);
else{var P=U.$.da.za(331);P&&P.nJa||U.removeEntry(54);U.removeEntry(5)}};U.$=B;U.hZa=Q;U.cNg();e.AFrameworkApplication.nd&&e.AFrameworkApplication.nd.AUc(U);U.qYa=Array(69);for(var X=0;69>X;X++)U.qYa[X]=null;U.dh=S.EcmaDateClock.instance;U.qjf=U.dh.Jb.getTime();Q&&(Q=B.oa,X=Q.tf,Q.Iy(U.Kn),Q.Rq(U.ei),Q.xnb(U.Rmc),Q.EYa(U.Rmc),T.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled")||(X.eHg(U.nFb),X.Gnb(U.Iya)),B.ea.Vj(U.Uc),B.ea.Bu(U.Sf),B.Uk(U.Yc),B.Bk(U.Fc),B.ea.B2(U.vN),B.userOperationManager.Br(U.TFb),
T.EwaSettings.ma(170)&&B.ea.Tg.get(45)&&e.AFrameworkApplication.fa.qa("SupportsPolicies")||U.W5e(),U.h$e(I.c(B)));B.da.Ga(5,U);return U}function c(B,Q,U){U=void 0===U?null:U;var X=l.call(this)||this;X.KGa=B;X.L6c=Q;X.data=U;return X}t=b(0);var d=b(15),e=b(4),h=b(87),k=b(27),n=b(38),f=b(79),v;(function(B){B[B.unableToRefreshLock=0]="unableToRefreshLock";B[B.unableToRefreshLockExpected=1]="unableToRefreshLockExpected";B[B.workbookAlmostTooLarge=2]="workbookAlmostTooLarge";B[B.workbookTooLarge=3]="workbookTooLarge";
B[B.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";B[B.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";B[B.editAndRefreshDisabledOnBIAHostedFiles=6]="editAndRefreshDisabledOnBIAHostedFiles";B[B.unsupportedFeatures=7]="unsupportedFeatures";B[B.collabDataAndDataStringsLocaleMismatch=8]="collabDataAndDataStringsLocaleMismatch";B[B.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";B[B.collabDataLocaleMismatch=10]="collabDataLocaleMismatch";B[B.lastGenericStatusError=
11]="lastGenericStatusError";B[B.scratchPadWarning=12]="scratchPadWarning";B[B.authenticationLost=13]="authenticationLost";B[B.odfCompatibilityIssues=14]="odfCompatibilityIssues";B[B.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";B[B.workbookIsIrmProtected=16]="workbookIsIrmProtected";B[B.biFeatureNotAvailable=17]="biFeatureNotAvailable";B[B.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";B[B.unsupportedInteractiveReportEditing=19]="unsupportedInteractiveReportEditing";
B[B.mobileAppCampaignBizBar=20]="mobileAppCampaignBizBar";B[B.transientServerCommunicationFailures=21]="transientServerCommunicationFailures";B[B.editAttemptInReadOnly=22]="editAttemptInReadOnly";B[B.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";B[B.unsupportedBrowser=24]="unsupportedBrowser";B[B.readOnlyPermissions=25]="readOnlyPermissions";B[B.documentIsIrmProtectedWarning=26]="documentIsIrmProtectedWarning";B[B.policyWarningMessage=27]="policyWarningMessage";
B[B.workingOnIt=28]="workingOnIt";B[B.passwordProtectedWorkbookLockedForEdit=29]="passwordProtectedWorkbookLockedForEdit";B[B.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";B[B.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";B[B.legacySharedWorkbookEditWarningBB=32]="legacySharedWorkbookEditWarningBB";B[B.legacyConnectionsBB=33]="legacyConnectionsBB";B[B.groupedSlicersBB=34]="groupedSlicersBB";B[B.thirdPartyAddinDisabled=35]="thirdPartyAddinDisabled";B[B.financeLinkedEntityDisclaimerBar=
36]="financeLinkedEntityDisclaimerBar";B[B.wolframDeprecationAlertBar=37]="wolframDeprecationAlertBar";B[B.wacGdprNotice=38]="wacGdprNotice";B[B.automaticSensitivityLabel=39]="automaticSensitivityLabel";B[B.recommendedSensitivityLabel=40]="recommendedSensitivityLabel";B[B.mandatorySensitivityLabel=41]="mandatorySensitivityLabel";B[B.localStorageDisabled=42]="localStorageDisabled";B[B.autoRefreshDisabled=43]="autoRefreshDisabled";B[B.corruptedFileRepaired=44]="corruptedFileRepaired";B[B.corruptedOdsFileRepaired=
45]="corruptedOdsFileRepaired";B[B.minorVersionLimitReached=46]="minorVersionLimitReached";B[B.sensitivityApplicationGenericError=47]="sensitivityApplicationGenericError";B[B.sensitivityApplicationTooLargeFileError=48]="sensitivityApplicationTooLargeFileError";B[B.sensitivityApplicationLabelNotSupportedError=49]="sensitivityApplicationLabelNotSupportedError";B[B.sensitivityApplicationLabelDisabledError=50]="sensitivityApplicationLabelDisabledError";B[B.sensitivityApplicationMandatoryConflictError=
51]="sensitivityApplicationMandatoryConflictError";B[B.sensitivityApplicationMinorVersionLimitReachedError=52]="sensitivityApplicationMinorVersionLimitReachedError";B[B.sensitivityApplicationSetLabelError=53]="sensitivityApplicationSetLabelError";B[B.promptEnableExternalLinks=54]="promptEnableExternalLinks";B[B.networkDown=55]="networkDown";B[B.defaultToViewDueToCogs=56]="defaultToViewDueToCogs";B[B.refreshLinkedEntityErrorBar=57]="refreshLinkedEntityErrorBar";B[B.promptEnableLinkedEntitiesUntrustedImages=
58]="promptEnableLinkedEntitiesUntrustedImages";B[B.canvasHealth=59]="canvasHealth";B[B.novModeDepreciation=60]="novModeDepreciation";B[B.mismatchedFileFormatConverted=61]="mismatchedFileFormatConverted";B[B.optimizeWorkbook=62]="optimizeWorkbook";B[B.novModePostDepreciation=63]="novModePostDepreciation";B[B.officeScriptsRunning=64]="officeScriptsRunning";B[B.powerQueryRefreshDataSourceNotSupported=65]="powerQueryRefreshDataSourceNotSupported";B[B.readOnlyPivotTable=66]="readOnlyPivotTable";B[B.powerQueryRefreshHostNotSupported=
67]="powerQueryRefreshHostNotSupported";B[B.refreshPageAfterEnablingTheExtension=68]="refreshPageAfterEnablingTheExtension";B[B.count=69]="count"})(v||(v={}));Object(t.b)("EwaBusinessBarEntryType",v);var m=b(5),x=b(1272),l=Sys.EventArgs;$k(c,l);Object(t.a)(c,"BusinessBarEntryDisplayChangedEventArgs",Sys.EventArgs,[]);var u=b(1274),A=b(1273),z=b(1276),y=b(1275),w=b(1270),D=b(531),H=b(50),F=b(599),J=b(37),S=b(751),N=b(31),T=b(1),G=b(21),I=b(57),K=b(68),L=b(1057);b.d(E,"a",function(){return a});var O=
f.a;$k(a,O);a.prototype.W5e=function(){N.a.Tq(this.$.ea.rF)&&this.Kn(this,new D.a(this.$.ea.rF,null,!1,-1,-1,-1,-1,"",-1,"",-1))};a.prototype.jFg=function(B){this.Pa.addHandler("bBarAttachedOrDetached",B)};a.prototype.dispose=function(){if(this.$){var B=this.$,Q=B.oa,U=Q.tf;Q.Ez(this.Kn);Q.fs(this.ei);Q.Msc(this.Rmc);Q.EIb(this.Rmc);U.RIb(this.Iya);U.tdj(this.nFb);B.ea.wk(this.Uc);B.ea.Ew(this.Sf);B.sl(this.Yc);B.Ol(this.Fc);B.ea.q0(this.vN);B.userOperationManager.to(this.TFb);G.g(B).Wb.vk(this.oyf)}h.a.Ia(this.aU);
this.$=this.aU=null;O.prototype.dispose.call(this)};a.prototype.sgi=function(B){switch(B){case 4:case 5:case 11:case 54:case 7:case 36:case 37:return!0;case 58:return T.EwaSettings.ma(655);default:return!1}};a.prototype.Lf=function(B,Q,U,X,P){U=void 0===U?null:U;X=void 0===X?null:X;P=void 0===P?null:P;if(!this.$.isMobileMode||this.sgi(B))this.hZa&&!this.eC(B)&&(T.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&d.ULS.sendTraceTag(537170254,0,50,"Adding entry to BB: "+Enum.toString(v,
B)),this.qYa[B]=this.dh.k8,this.aU.QD(B,Q,X,P),this.Pa.raiseEvent("bBarAttachedOrDetached",new c(B,!0,U))),Q&&32===Q.Appearance&&K.a(this.$).dd.rla(Q)};a.prototype.sBj=function(B,Q,U,X){d.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");w.a.initialize(B,Q,U,X);this.Lf(38,null)};a.prototype.tAj=function(B,Q,U,X){x.a.initialize(B,Q,U,X);this.Lf(39,null)};a.prototype.DCj=function(B,Q,U,X){A.a.initialize(B,Q,U,X);this.Lf(40,null)};a.prototype.SBj=function(B,Q,U,X){u.a.initialize(B,
Q,U,X);this.Lf(41,null)};a.prototype.MCj=function(B,Q,U,X){y.a.initialize(B,Q,U,X);this.Lf(52,null)};a.prototype.LCj=function(B,Q,U,X){z.a.initialize(B,Q,U,X);this.Lf(53,null)};a.prototype.removeEntry=function(B){this.hZa&&(T.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&d.ULS.sendTraceTag(537170251,0,50,"Removing entry from BB: "+Enum.toString(v,B)),this.qYa[B]=null,this.aU.removeEntry(B)&&this.Pa.raiseEvent("bBarAttachedOrDetached",new c(B,!1)))};a.prototype.mMa=function(B){return this.hZa?
this.aU.mMa(B):!1};a.prototype.eC=function(B){return this.hZa?this.aU.eC(B):!1};a.prototype.LDb=function(){d.ULS.sendTraceTag(537170248,0,50,"Network disconnect notification received from the app")};a.prototype.cmc=function(){d.ULS.sendTraceTag(537170247,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");this.removeEntry(21)};a.prototype.cNg=function(){var B=b(1362).BusinessBarControl;if(this.hZa&&!this.aU){G.g(this.$).Wb.Ak(this.oyf);
var Q=document.getElementById(this.$.zb+m.a.fve);this.aU=new B(this.$,Q)}};a.prototype.tId=function(){this.hZa&&this.aU.tId()};a.prototype.fSf=function(B){if(T.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){var Q=this.dh.k8;if(3E5<=Q-this.qjf){this.qjf=Q;for(var U=0;69>U;U++){var X=this.qYa[U];X&&(X=Q-X,3E5<=X&&d.ULS.sendTraceTag(537170241,0,50,"{0}: entry [{1}] was activated but not turned off for {2} Millis"+B+": entry ["+Enum.toString(v,U)+"] was activated but not turned off for "+
X+" Millis"))}}}};a.prototype.aBh=function(B){for(var Q=[],U=ik(B),X=U.next();!X.done;X=U.next())switch(X.value.MessageId){case -113742550:X=[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941],(this.$.ea.isNamedObjectViewMode||N.a.$g(B,X))&&Q.push(-113742550)}return N.a.xF(B,Q)};a.prototype.j5h=function(B,Q){switch(B.MessageId){case 2113407564:for(var U=N.a.k_a([1821390342,-943219229,-502303485,1437034227]),X=0;X<U.length;X++)U[X].HelpTopicId=B.HelpTopicId,U[X].HelpDescription=
B.HelpDescription,this.ZHc.push(U[X])}switch(B.MessageId){case -395951567:this.Lf(6,B);break;case 1643490758:this.Lf(4,B);break;case -907264831:this.Lf(5,B);break;case 757111532:case 2113407564:this.Lf(7,B);break;case 2010656511:this.Lf(15,B);break;case 1321660996:this.$.m5c=!0;this.Lf(8,B);break;case 526339737:this.$.m5c=!0;this.Lf(9,B);break;case -407088521:this.Lf(10,B);break;case 1756116017:this.Lf(14,B);break;case -1703455218:this.Lf(17,B);break;case 1393475740:this.Lf(25,B);break;case -949523941:this.Lf(26,
B);break;case 1779381952:this.Lf(43,B);break;case 1421575100:this.Lf(44,B);break;case 613676060:this.Lf(45,B);break;case 1233668252:this.Lf(61,B);break;case 1911608588:B=!!(this.$.Bd&64);!this.$.ea.kg()&&B&&Q.push(29);break;case 1544494907:break;case -655555355:Q.push(this.ird()?1:0);break;case -1221382671:Q.push(2);break;case 1662282929:Q.push(3);break;case 104919273:this.$.ea.kg()||Q.push(30);break;case -689453604:B=!!(this.$.Bd&64);this.$.ea.h7e=!0;!this.$.ea.kg()&&B&&Q.push(31);break;case 157762400:this.$.ea.ehc=
!0;!this.$.ea.kg()&&this.$.Bd&64&&!this.$.isEditMode&&Q.push(32);break;case -73730134:T.EwaSettings.isChangeGateEnabled("OfficeVSO:6079602_EnableEditingOfFilesWithLegacyConnections")&&!this.$.ea.kg()&&this.$.Bd&64&&Q.push(33);break;case -293349236:Q.push(65);break;case 1580811823:Q.push(67);break;case -37299333:break;case 136737622:Q.push(46);break;case -1780327030:this.Lf(54,B);break;case -113742550:this.Lf(56,B);break;case -260312420:this.$.ea.kg()||Q.push(66);break;default:this.Lf(11,B)}return Q};
a.prototype.oai=function(){var B=this;if(e.AFrameworkApplication.fa.qa("WildFireExcelBizBar")&&!L.a.Wod(L.a.Ucd(1))&&(k.a.Uo||k.a.Ug)){var Q=H.GetServiceTaskFactory.create(this.$.da,155,this.$.la,1);J.TaskExtensions.Aa(Q,function(){B.Lf(20,null)},this.la,3)}};a.prototype.J$h=function(B){!B&&F.b(this.$)&&this.Lf(60,null)};a.prototype.K$h=function(B){!B&&F.c(this.$)&&this.Lf(63,null)};a.prototype.h$e=function(B){(!B&&!this.$.printingEnabled||this.$.pe.get(1))&&this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription&&
(d.ULS.sendTraceTag(537170205,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),this.Lf(16,null));this.oai();this.Txe();this.e4f();this.J$h(B);this.K$h(B)};a.prototype.Txe=function(){this.$.workbookContext.Options&32768&&this.iBj()};a.prototype.iBj=function(){this.qYa[36]||this.Lf(36,null)};a.prototype.mDj=function(){this.qYa[37]||this.Lf(37,null)};a.prototype.e4f=function(){T.EwaSettings.ma(655)&&this.$.workbookContext.Options&524288&&this.Lf(58,null)};a.prototype.B4f=function(B,
Q){this.Lf(57,B,null,Q)};a.prototype.$le=function(B,Q){var U=null,X=null;U=void 0===U?null:U;X=void 0===X?null:X;Q=void 0===Q?null:Q;this.aU.eC(B)?this.aU.MOb(B,Q):this.Lf(B,null,U,X,Q)};a.prototype.W3f=function(){this.$.Bd&8&&this.Lf(12,null)};a.prototype.ird=function(){var B=this.$.da.za(38);return B?B.tokenExpired:!1};a.prototype.IEg=function(B,Q){if(!this.eC(21)&&-1387426400!==B.MessageId){d.ULS.sendTraceTag(537170204,0,50,"BusinessBar: raising the transient communication failures notification.");
var U={};U.FailedMethod=Q;this.Lf(21,B,U)}};a.Scc=function(){return a.upe||(a.upe=[0,1,2,3])};of.Object.defineProperties(a.prototype,{O7c:{configurable:!0,enumerable:!0,get:function(){return this.ZHc}},domElement:{configurable:!0,enumerable:!0,get:function(){return this.aU?this.aU.domElement:null}}});a.upe=null;Object(t.a)(a,"BusinessBarManager",f.a,[868,6,68])},1488:function(t,E,b){function a(){k.a.Fa(c.ka)}function c(n){var f=h.call(this)||this;f.$=n;f.Eb();return f}t=b(0);var d=b(235),e=b(1471),
h=d.a;$k(c,h);c.prototype.create=function(){this.pb(this.$.da.za(5)||new e.a(this.$,!this.$.qba))};c.ka=function(n){n.da.Ga(4,new c(n))};Object(t.a)(c,"BusinessBarManagerFactory",d.a,[]);var k=b(10);b.d(E,"a",function(){return a})},1499:function(t,E,b){function a(w){this.fP=w}function c(w,D,H,F){F=void 0===F?null:F;var J=y.call(this)||this;J.bqa=null;J.Wl=null;J.jP=null;J.Nm=[];J.BVb=D;J.fP=w;J.Oqg=H;J.NWb=F;J.$lb=new z.a("LoadResource","LoadPrintablePdf");return J}t=b(0);var d=b(15),e=b(84),h=b(135),
k=b(4),n=b(13),f=b(96),v=b(44),m=b(184),x=b(1289),l=b(89),u=b(56),A=b(81),z=b(1157),y=h.StandardDialog;$k(c,y);c.prototype.aQ=function(){this.Rb=5;this.width=40;var w=document.createElement("span");w.id=this.di("DirectPrintHeaderContent");var D=document.createElement("span");D.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(D,"DirectPrintHeader");this.jP=document.createElement("iframe");this.jP.name="pdfObjectFrame";this.jP.title=CommonUIStrings.l_DirectPrintDialogIFrame;
this.jP.onload=Object(e.a)(this,this.W1i,"printablePdfLoaded");if(this.NWb&&0<this.NWb.count){var H=A.a.Mfd(this.BVb,this.NWb),F=A.a.RId(this.BVb,this.NWb);this.Wl=document.createElement("form");this.Wl.id="printPreviewPostForm";this.Wl.method="POST";this.Wl.target=this.jP.name;this.Wl.action=F;H=ik(H);for(F=H.next();!F.done;F=H.next()){F=F.value;var J=document.createElement("input");J.type="hidden";J.name=F.key;J.value=F.value;this.Wl.appendChild(J)}}else this.jP.setAttribute("src",this.BVb);Sys.UI.DomElement.addCssClass(this.jP,
m.a.nce);this.Oqg?(Sys.UI.DomElement.addCssClass(this.jP,"DirectPrintPdfObjectHidden"),D.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,l.a.kh(this.jP,l.a.ZB,l.a.Wj)):(Sys.UI.DomElement.addCssClass(this.jP,"DirectPrintPdfObject"),this.Nm.push(this.jP));w.appendChild(D);w.appendChild(document.createElement("br"));w.appendChild(this.jP);this.Wl&&w.appendChild(this.Wl);w.appendChild(document.createElement("br"));w.appendChild(this.N2g(this.Wl?"#":this.BVb));this.$lb.start();this.kDb(CommonUIStrings.l_AppTitle,
null,null,null,null,w);this.$W(this.di("DirectPrintHeaderContent"));this.Wl&&this.Wl.submit();this.P7g();d.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")};c.prototype.N2g=function(w){var D=document.createElement("span"),H=document.createElement("span");H.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;D.appendChild(H);k.AFrameworkApplication.fa&&(2===k.AFrameworkApplication.ta.Qa.rj&&k.AFrameworkApplication.fa.qa("PPTDisableDirectPrintDialogDownloadPDFLink")||1===
k.AFrameworkApplication.ta.Qa.rj&&k.AFrameworkApplication.fa.qa("XLODisableDirectPrintDialogOpenPDFLink"))?(w=document.createElement("span"),2===k.AFrameworkApplication.ta.Qa.rj?w.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===k.AFrameworkApplication.ta.Qa.rj&&(w.innerText=CommonUIStrings.l_InternalError_Directive,d.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.bqa=w,D.appendChild(document.createElement("br")),D.appendChild(w)):(H=document.createElement("a"),
H.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,H.href=w,H.target="_blank",H.id="PrintPDFLink",H.className="AllowBrowserClick",this.bqa=H,D.appendChild(document.createElement("br")),D.appendChild(H),this.Wl&&v.a.addHandler(H,"click",Object(e.a)(this,this.Moc,"onSubmit")),this.fP.ra(n.a.click,this.bqa,Object(e.a)(this,this.yJe,"downloadPDFLinkClicked"),null));this.Nm.push(this.bqa);return D};c.prototype.Moc=function(w){this.Wl&&(this.Wl.target="_blank",this.Wl.submit());w.preventDefault()};
c.prototype.P7g=function(){if(0<this.Nm.length){var w=new x.a(this.Nm),D=f.FocusManager.instance().vQ();D&&(this.bqa.focus(),D.Xe=w,D.C_=!0)}};c.prototype.yJe=function(){d.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1};c.prototype.Wtd=function(){d.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")};c.prototype.W1i=function(){d.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.$lb&&this.$lb.stop()};
c.prototype.dispose=function(){this.bqa&&(this.fP.Ba(n.a.click,this.bqa,Object(e.a)(this,this.yJe,"downloadPDFLinkClicked")),this.bqa=null);u.a.p0(this.jP);this.jP=null;y.prototype.dispose.call(this)};Object(t.a)(c,"DirectPrintDialog",h.StandardDialog,[767]);b.d(E,"a",function(){return a});a.prototype.YNh=function(w,D,H){return new c(this.fP,w,D,void 0===H?null:H)};Object(t.a)(a,"DirectPrintDialogFactory",null,[735])},1500:function(t,E,b){function a(l,u,A,z,y,w,D,H,F,J){this.dYb=null;this.yog=l;this.zkb=
u;this.SNc=A;this.Xrg=z;this.Csg=y;this.jPc=new e.a(Object(h.a)(this,this.WVh,"getProbeResults"));this.wVa=w;this.jae=F;this.Vxg=D;this.Dsg=H;this.Ksg=J}function c(l,u){this.e8f=l;this.USa=u}t=b(0);var d=b(15),e=b(624),h=b(84),k=b(1552),n=b(1290);Object(t.a)(c,"DirectPrintProbeResults",null,[]);var f=b(4),v=b(278),m=b(27),x=b(113);b.d(E,"a",function(){return a});a.prototype.start=function(){};a.prototype.Y3i=function(){var l=Array(this.rC.TSa.length);if(void 0!==this.zkb&&null!==this.zkb)for(var u=
0;u<this.rC.TSa.length;u++)l[u]=this.rC.TSa[u]in this.zkb&&this.Xrg(this.zkb[this.rC.TSa[u]]);return l};a.prototype.Z3i=function(){for(var l=Array(this.rC.USa.length),u=!(void 0===this.SNc||null===this.SNc),A=0;A<this.rC.USa.length;A++){var z=this.rC.USa[A];l[A]=u&&z in this.SNc?!0:this.Csg(z)}return l};a.prototype.KZh=function(){for(var l=this.Y3i(),u=Array(l.length),A=0;A<l.length;A++)u[A]=l[A]?this.ozh(this.zkb[this.rC.TSa[A]]):null;return u};a.prototype.ozh=function(l){if(void 0===l||null===l)return null;
l=l.enabledPlugin;return void 0===l||null===l?null:l.name};a.prototype.WVh=function(){for(var l=this.KZh(),u=this.Z3i(),A={},z={},y=0;y<this.rC.TSa.length;y++)A[this.rC.TSa[y]]=l[y];for(l=0;l<this.rC.USa.length;l++)z[this.rC.USa[l]]=u[l];return new c(A,z)};a.prototype.$zj=function(){return this.Ksg||!this.rC.isEnabled||f.AFrameworkApplication.isUnifiedHostMode?!1:this.dIj()};a.prototype.Ixc=function(){if(null!=this.dYb)return this.dYb;var l=a.Vcf(this.rC);return this.dYb=this.rC.Wcf&&l||this.Qgi()};
a.prototype.Qgi=function(){return m.a.fo&&this.rC.Sgi&&m.a.rye>=this.rC.LYg?!0:!1};a.prototype.dIj=function(){if(!this.Dsg(this.rC))return!1;var l=x.a.nhd(this.jPc.value.e8f);l=ik(l);for(var u=l.next();!u.done;u=l.next())if(u=u.value,void 0!==u&&null!==u)return!0;l=x.a.nhd(this.jPc.value.USa);l=ik(l);for(u=l.next();!u.done;u=l.next())if(u.value)return!0;return!1};a.prototype.i6h=function(){var l=x.a.nhd(this.jPc.value.e8f);l=ik(l);for(var u=l.next();!u.done;u=l.next())if(v.a.contains(this.rC.z9h,
u.value))return!0;return!1};a.prototype.x4f=function(l){var u=void 0===u?!1:u;var A=void 0===A?null:A;f.AFrameworkApplication.ta&&f.AFrameworkApplication.fa.qa("DirectPrintDialogAsStandardDialogIsEnabled")?this.jae(l,A):this.$zj()?this.shh(l,this.i6h()&&!u,A):this.jae(l,A)};a.prototype.shh=function(l,u,A){A=void 0===A?null:A;var z=this.Vxg.sc("UserAction","OpenDirectPrintDialog");this.wVa.YNh(l,u,A).aQ();z.stop()};a.Chf=function(l){try{return new ActiveXObject(l),!0}catch(u){d.ULS.sendTraceTag(4535642,
328,100,"Failed to instantiate {0} as an ActiveX control.",l)}return!1};a.Xcf=function(l){return void 0===l||null===l?!1:!(void 0===l.enabledPlugin||null===l.enabledPlugin)};a.create=function(l){var u=new n.a(f.AFrameworkApplication.fa.appSettings),A=null;try{A=window.navigator.mimeTypes}catch(J){d.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}var z=null;try{z=window.navigator.plugins}catch(J){d.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}var y=
a.Xcf,w=a.Chf;l=l.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");var D=f.AFrameworkApplication.ta.sD,H=a.Dhf,F=!!f.AFrameworkApplication.ta&&f.AFrameworkApplication.ta.Qa.Yu&&!f.AFrameworkApplication.fa.qa("PrintDialogFallbackLinkEnabled");return new a(u,A,z,y,w,l,D,H,function(J,S){return new k.a(J,!1,S,!0,F)},f.AFrameworkApplication.lMa)};a.Dhf=function(l){return m.a.fo||m.a.$t&&l.gki||l.Wcf&&a.Vcf(l)?!0:!1};a.Vcf=function(l){var u=m.a.ftb;if(u){var A=u.split(".");if(2===A.length)return u=
parseInt(A[0]),A=parseInt(A[1]),u>l.Dwd||u===l.Dwd&&A>=l.Eqf}return!1};of.Object.defineProperties(a.prototype,{rC:{configurable:!0,enumerable:!0,get:function(){return this.yog}}});Object(t.a)(a,"DirectPrintManager",null,[695])},1504:function(t,E,b){function a(x,l,u,A,z,y){this.qOc=null;this._id=x;this.YOc=l;this.uqg=void 0===z?null:z;this.vjb=A;this.Dlb=void 0===y?null:y;this.ppa=null;this.$Xa=u;this.amb=c.instance.vZh(l,x)}function c(){this.cFc=new n.a;this.aFc=new n.a;this.$Ec=new n.a;this.ZQg(this.cFc);
this.YQg(this.aFc);this.XQg(this.$Ec);this.dKc=new n.a;this.cKc=new n.a;this.bKc=new n.a;this.vTg(this.dKc);this.uTg(this.cKc);this.tTg(this.bKc);this.rGc=new n.a;this.rRg(this.rGc);this.NFa(this.rGc);this.NFa(this.$Ec);this.NFa(this.aFc);this.NFa(this.cFc);this.NFa(this.cKc);this.NFa(this.dKc);this.NFa(this.bKc)}t=b(0);var d=b(15),e=b(84),h=b(1072),k=b(1057),n=b(1416);c.prototype.vZh=function(x,l){switch(x){case 1:return this.O1h(l);case 2:return this.lJh(l)}return k.a.Gxc?this.rGc:null};c.prototype.ZQg=
function(x){x.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);x.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);x.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)};c.prototype.YQg=function(x){x.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);x.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);x.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)};c.prototype.XQg=function(x){x.add("Headline",
CommonUIStrings.l_WildFireExcelBizBarHeadline);x.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);x.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)};c.prototype.vTg=function(x){x.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);x.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);x.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);x.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);
x.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);x.add("OverlayBig","Get the Word app");x.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");x.add("OverlaySmallSplit1","Discover Word");x.add("OverlaySmallSplit2","designed for the iPad.");x.add("SkipButton","Skip for now")};c.prototype.rRg=function(x){x.add("Headline","Get the Office Online extension for Chrome");x.add("UseAppButton","Get the extension");x.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")};
c.prototype.uTg=function(x){x.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);x.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);x.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);x.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);x.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);x.add("OverlayBig","Get the PowerPoint app");x.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");
x.add("OverlaySmallSplit1","Discover PowerPoint");x.add("OverlaySmallSplit2","designed for the iPad.");x.add("SkipButton","Skip for now")};c.prototype.tTg=function(x){x.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);x.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);x.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);x.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);x.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)};
c.prototype.NFa=function(x){x.add("Corporation","Microsoft Corporation")};c.prototype.O1h=function(x){switch(x){case 3:return this.dKc;case 2:return this.cKc;case 1:return this.bKc}return null};c.prototype.lJh=function(x){switch(x){case 3:return this.cFc;case 2:return this.aFc;case 1:return this.$Ec}return null};of.Object.defineProperties(c,{instance:{configurable:!0,enumerable:!0,get:function(){c.Ma||(c.Ma=new c);return c.Ma}}});c.Ma=null;Object(t.a)(c,"WildFireStringFactory",null,[]);var f=b(4),
v=b(39),m=b(27);b.d(E,"a",function(){return a});a.prototype.o3c=function(){this.ppa=new h.a(this.title,this.message,null);this.ppa.addButton(this.nve,Object(e.a)(this,this.Suf,"onButtonOneClick"),"");this.$Xa&&this.ppa.SDg(this.pve,Object(e.a)(this,this.Vuf,"onButtonTwoClick"));this.ppa.I$=Object(e.a)(this,this.sIe,"dismissBar");this.ppa.image=3;this.ppa.id=16;this.ppa.closeable=!0};a.prototype.Suf=function(){this.$Xa?this.udi():this.XVj()};a.prototype.Vuf=function(){this.$Xa&&this.SVi()};a.prototype.udi=
function(){d.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.vjb&&this.Dlb&&this.Dlb();k.a.GNf(this._id,this.YOc)};a.prototype.SVi=function(){this.openUrl&&(d.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.vjb&&this.Dlb&&this.Dlb(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(k.a.xqe(this._id),this.openUrl,0,!1))};a.prototype.XVj=function(){k.a.Gxc?this.CTg():(d.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),
k.a.HPd("BizBarClicked"),1!==this.YOc&&2!==this.YOc||k.a.b_g(this.openUrl,this.vjb,this._id,this.Dlb))};a.prototype.CTg=function(){this.vjb?d.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):d.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");v.a.YU(f.AFrameworkApplication.fa.appSettings.WildFireChromeExtensionUrl.toString())};a.prototype.$gh=function(){this.vjb?d.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):d.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");
k.a.HPd(k.a.pye)};a.prototype.sIe=function(){k.a.Gxc?this.$gh():(k.a.HPd(k.a.Ucd(this._id)),d.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))};a.o5b=function(){var x=f.AFrameworkApplication.ta.Qa,l=new a(x.rj,k.a.Qcc(),8<m.a.x5a,1===x.j6,function(){return x.tx},x.JVf());d.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return l};of.Object.defineProperties(a.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return this.amb.na("Headline")}},message:{configurable:!0,
enumerable:!0,get:function(){return this.amb.na("CallToAction")}},fWj:{configurable:!0,enumerable:!0,get:function(){return this.$Xa}},nve:{configurable:!0,enumerable:!0,get:function(){return this.$Xa?this.amb.na("InstallButton"):this.amb.na("UseAppButton")}},pve:{configurable:!0,enumerable:!0,get:function(){return this.$Xa?this.amb.na("OpenAppButton"):""}},yTg:{configurable:!0,enumerable:!0,get:function(){return this.ppa}},openUrl:{configurable:!0,enumerable:!0,get:function(){this.qOc||(this.qOc=
this.uqg());return this.qOc}}});Object(t.a)(a,"WildFireBusinessBar",null,[])},1547:function(t,E,b){function a(m,x,l,u,A,z){x=void 0===x?!0:x;l=void 0===l?!1:l;u=void 0===u?null:u;A=void 0===A?null:A;z=void 0===z?!1:z;var y=v.call(this)||this;y.RX=null;y.Wl=null;y.SVa=null;y.TVa=null;var w=y.aWd?y.aWd:CommonUIStrings.l_DefaultDialogTitle;a.Lxb=z;y.FSb=u||new d.a(m,!0);y.FSb.Gse(y);var D=[],H=[];a.ou&&(y.RVc&&y.RVc.forEach(function(N){Array.add(D,N)}),y.Poe&&y.Poe.forEach(function(N){Array.add(H,N)}));
x?l?y.ghf?(y.Rb=12,y.kc(1,y.buttonText),y.kc(2,CommonUIStrings.l_ShareLink),y.kc(3,CommonUIStrings.l_DialogClose)):(y.Rb=4,y.kc(1,y.buttonText),y.kc(2,CommonUIStrings.l_DialogClose)):(y.Rb=6,y.kc(0,CommonUIStrings.l_DialogClose)):y.Rb=5;z=document.createElement("span");y.G4c&&(z.className=y.G4c);u=document.createElement("a");u.innerText=y.$jc;u.href=m;u.target="_blank";u.id=y.Zjc;u.className=e.AFrame.wpe;var F=!f.a.IC&&!!A&&0<A.count;if(F){var J=n.a.Mfd(m,A);A=n.a.RId(m,A);u.href="#";u.target="_self";
y.Wl=document.createElement("form");y.Wl.id="printPreviewPostForm1";y.Wl.method="post";y.Wl.target="_blank";y.Wl.action=A;A=ik(J);for(J=A.next();!J.done;J=A.next()){J=J.value;var S=document.createElement("input");S.type="hidden";S.name=J.key;S.value=J.value;y.Wl.appendChild(S)}}else y.Wl=null;y.Wl||a.Lxb?a.Lxb||(m={},Array.add(H,(m.type="AppLinkProps",m.id=y.Zjc,m.text=y.$jc,m.onExecute=function(){y.bMf()},m))):(A={},J={},Array.add(H,(J.type="AppLinkProps",J.id=y.Zjc,J.text=y.$jc,J.handler=(A.href=
F?"#":m,A.target=F?"_self":"_blank",A),J)));y.cOa&&(Array.add(D,y.cOa),y.ghf&&Array.add(D,CommonUIStrings.l_AdditionalText));l?(m=document.createElement("span"),m.innerText=y.cOa.replace("{0}",""),z.appendChild(m)):y.vqf?(m=document.createElement("span"),m.id=y.di("message"),F=document.createElement("span"),A=document.createElement("span"),J=y.cOa.split("{0}"),F.innerText=J[0],A.innerText=J[1],m.appendChild(F),m.appendChild(u),m.appendChild(A),z.appendChild(m)):(m=document.createElement("span"),m.innerText=
y.cOa,z.appendChild(m),z.appendChild(document.createElement("br")),z.appendChild(document.createElement("br")),z.appendChild(u),a.Lxb||Array.add(D,"{0}"));y.Wl&&z.appendChild(y.Wl);a.ou&&(y.j8a&&(y.ZBb?y.Ble(y.j8a,y.ZBb):(Array.add(D,"{0}"),m={},Array.add(H,(m.type="AppLinkProps",m.id="LearnMoreLinkId",m.text=y.j8a,m.onExecute=function(){y.Tjc()},m)))),y.Jra(D,H));y.kDb(w,null,y.q9e,null,Object(c.a)(y,y.Xv,"dialogHandler"),a.ou?null:z);y.$W(y.di("message"));!a.ou&&y.ZBb&&y.j8a&&(w=document.createElement("div"),
w.className="WACDialogLearnMoreLinkContainer",y.RX=document.createElement("a"),y.RX.innerText=y.j8a,y.RX.href=y.ZBb,y.RX.target="_blank",y.RX.id=y.di("LearnMoreLinkId"),y.RX.className=e.AFrame.wpe,w.appendChild(y.RX),x?y.Db.insertBefore(w,y.Db.lastChild):y.Db.appendChild(w),y.$W(String.format("{0} {1}",y.di("message"),y.di("LearnMoreLinkId"))));y.jib=u;l?y.kI(y.IB):y.kI(y.jib);y.Zlf();h.AFrameworkApplication.ta.jX.ra(k.a.click,y.jib,Object(c.a)(y,y.wJe,"downloadLinkClicked"),null);y.RX&&h.AFrameworkApplication.ta.jX.ra(k.a.click,
y.RX,Object(c.a)(y,y.Tjc,"learnMoreLinkClicked"),null);y.ESb=!1;return y}b.d(E,"a",function(){return a});t=b(0);var c=b(84);E=b(135);var d=b(1278),e=b(275),h=b(4),k=b(13),n=b(81),f=b(27),v=E.StandardDialog;$k(a,v);a.prototype.sXc=function(){this.Wl&&(this.SVa||(this.SVa=Object(c.a)(this,this.YGi,"onActionButtonClicked"),this.Ay.ra(k.a.click,this.IB,this.SVa)),this.TVa||(this.TVa=Object(c.a)(this,this.ZGi,"onActionButtonKeyUp"),this.Xd.ra(k.a.Fd,this.IB,this.TVa)));v.prototype.sXc.call(this)};a.prototype.YGi=
function(m){this.sRe(m);return!0};a.prototype.ZGi=function(m){return this.hjf(m,Object(c.a)(this,this.sRe,"executeDismissActionButtonFromArgs"))};a.prototype.sRe=function(m){this.Wl&&this.Wl.submit();this.vua(m.yb)};a.prototype.Wtd=function(){};a.prototype.wJe=function(){this.amf();this.Wl?this.Wl.submit():this.FSb.R6c();return!0};a.prototype.Tjc=function(){return!1};a.prototype.dispose=function(){this.FSb.dispose();this.jib&&(h.AFrameworkApplication.ta.jX.Ba(k.a.click,this.jib,Object(c.a)(this,this.wJe,
"downloadLinkClicked")),this.jib=null);this.RX&&(h.AFrameworkApplication.ta.jX.Ba(k.a.click,this.RX,Object(c.a)(this,this.Tjc,"learnMoreLinkClicked")),this.RX=null);this.Ay&&this.SVa&&(this.Ay.Ba(k.a.click,this.IB,this.SVa),this.SVa=null);this.Xd&&this.TVa&&(this.Xd.Ba(k.a.Fd,this.IB,this.TVa),this.TVa=null);v.prototype.dispose.call(this)};a.prototype.bMf=function(){this.Wl&&(document.body.appendChild(this.Wl),this.Wl.submit(),document.body.removeChild(this.Wl))};a.prototype.Xv=function(m){1===m&&
(this.Wtd(),this.Wl?a.ou&&this.bMf():this.FSb.R6c());this.dispose()};of.Object.defineProperties(a.prototype,{q9e:{configurable:!0,enumerable:!0,get:function(){return null}},aWd:{configurable:!0,enumerable:!0,get:function(){return null}},cOa:{configurable:!0,enumerable:!0,get:function(){return null}},ZBb:{configurable:!0,enumerable:!0,get:function(){return null}},j8a:{configurable:!0,enumerable:!0,get:function(){return null}},vqf:{configurable:!0,enumerable:!0,get:function(){return!1}},buttonText:{configurable:!0,
enumerable:!0,get:function(){return CommonUIStrings.l_Open}},G4c:{configurable:!0,enumerable:!0,get:function(){return null}},RVc:{configurable:!0,enumerable:!0,get:function(){return null}},Poe:{configurable:!0,enumerable:!0,get:function(){return null}},ghf:{configurable:!0,enumerable:!0,get:function(){return!1}}});of.Object.defineProperties(a,{ou:{configurable:!0,enumerable:!0,get:function(){return h.AFrameworkApplication.ta.Qa.Yu&&h.AFrameworkApplication.ta.Qa.lgf}},Lxb:{configurable:!0,enumerable:!0,
get:function(){return a.M7d},set:function(m){a.M7d=m}}});a.M7d=!1;Object(t.a)(a,"ADialogWithLinkToResource",E.StandardDialog,[])},1548:function(t,E,b){function a(k,n,f,v,m,x){var l=h.call(this,k,n,f,v,m,x)||this;k={};n=(k.errorMessage=l.nMe,k.offerString=l.ptf,k);k=new e.a(!1,!1,!0);l.X3f?(k.Rb=1,f={},n.helpLink=(f.type="AppLinkProps",f.id="helpLink",f.text=l.Xva,f.onExecute=function(){d.Redirect.showHelp(l.Q7e)},f)):(k.Rb=4,k.kc(2,l.j9e));k.kc(1,l.xYb);k.ye=l.id;f={};n=(f.id=l.id,f.dialogIcon=l.icon,
f.bodyControls=n,f);k.initializeAndShow(l.zl,Object(c.a)(l,l.u6i,"reactOICErrorDialogWithTrialHandler"),n);return l}b.r(E);b.d(E,"ReactOICErrorDialogWithTrial",function(){return a});t=b(0);var c=b(84);E=b(1280);var d=b(447),e=b(150),h=E.a;$k(a,h);Object(t.a)(a,"ReactOICErrorDialogWithTrial",E.a,[])},1549:function(t,E,b){function a(h,k,n,f,v,m){h=e.call(this,h,k,n,f,v,m)||this;k=document.createElement("span");k.innerText=h.nMe;k.appendChild(document.createElement("br"));k.appendChild(document.createElement("br"));
n=document.createElement("span");n.innerText=h.ptf;k.appendChild(n);n=new d.StandardDialog;h.X3f?(n.Rb=1,n.Kle(h.Xva,h.Q7e)):(n.Rb=4,n.kc(2,h.j9e));n.kc(1,h.xYb);n.ye=h.id;n.rl(h.zl,null,h.icon,Object(c.a)(h,h.jti,"legacyOICErrorDialogWithTrialHandler"),k);return h}b.r(E);b.d(E,"OICErrorDialogWithTrial",function(){return a});t=b(0);var c=b(84);E=b(1280);var d=b(135),e=E.a;$k(a,e);Object(t.a)(a,"OICErrorDialogWithTrial",E.a,[])},1550:function(t,E,b){function a(){return c.call(this)||this}b.r(E);b.d(E,
"CheckRoamingRightsRequest",function(){return a});t=b(0);b=b(1281);var c=b.a;$k(a,c);a.prototype.pwb=function(){return 2};a.prototype.Raa=function(){return 1};Object(t.a)(a,"CheckRoamingRightsRequest",b.a,[])},1551:function(t,E,b){function a(){return c.call(this)||this}b.r(E);b.d(E,"GetRoamingLauncherRequest",function(){return a});t=b(0);b=b(1281);var c=b.a;$k(a,c);a.prototype.pwb=function(){return 0};a.prototype.Raa=function(){return 2};Object(t.a)(a,"GetRoamingLauncherRequest",b.a,[])},1552:function(t,
E,b){function a(m,x,l,u,A){l=void 0===l?null:l;u=void 0===u?!0:u;A=void 0===A?!1:A;x=v.call(this,m,!0,!(a.STa&&u),new e.a(m,x),l,A)||this;a.STa=a.STa&&u;if(a.STa){u=document.createElement("iframe");A=null;var z=x.ngh;u.name="pdfObjectFrame";u.id="pdfObjectIFrame";if(l&&0<l.count){var y=n.a.Mfd(m,l);m=n.a.RId(m,l);A=document.createElement("form");A.id="printPreviewPostForm";A.method="POST";A.target=u.name;A.action=m;m=ik(y);for(l=m.next();!l.done;l=m.next())l=l.value,y=document.createElement("input"),
y.type="hidden",y.name=l.key,y.value=l.value,A.appendChild(y)}else u.src=m;z.appendChild(u);A&&(z.appendChild(A),A.submit());Sys.UI.DomElement.addCssClass(u,"DirectPrintPdfObjectHidden");k.a.kh(u,k.a.ZB,k.a.Wj)}return x}b.d(E,"a",function(){return a});t=b(0);var c=b(15),d=b(1547),e=b(1278),h=b(4),k=b(89),n=b(81),f=b(27),v=d.a;$k(a,v);a.prototype.Zlf=function(){c.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")};a.prototype.amf=function(){h.AFrameworkApplication.Gm.nyb(9540);c.ULS.sendTraceTag(7690391,
324,50,"Legacy print dialog clicked")};a.prototype.Wtd=function(){c.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")};of.Object.defineProperties(a.prototype,{q9e:{configurable:!0,enumerable:!0,get:function(){return"Print_32x32x32"}},aWd:{configurable:!0,enumerable:!0,get:function(){return a.STa?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}},cOa:{configurable:!0,enumerable:!0,get:function(){return a.STa?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}},RVc:{configurable:!0,
enumerable:!0,get:function(){var m=[];Array.add(m,CommonUIStrings.l_PrintDialogCanCloseDocument);if(d.a.Lxb){var x=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==h.AFrameworkApplication.ta.Qa.SFe&&(x=h.AFrameworkApplication.ta.Qa.SFe);Array.add(m,x)}return a.STa?m:null}},$jc:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}},Zjc:{configurable:!0,enumerable:!0,get:function(){return"PrintPDFLink"}},buttonText:{configurable:!0,enumerable:!0,
get:function(){return CommonUIStrings.l_PrintDialogOpenPDF}},G4c:{configurable:!0,enumerable:!0,get:function(){return h.AFrameworkApplication.KHe?"UIFontDialogTextLarge":null}}});of.Object.defineProperties(a,{STa:{configurable:!0,enumerable:!0,get:function(){return!!h.AFrameworkApplication.ta&&h.AFrameworkApplication.ta.Qa.Yu&&h.AFrameworkApplication.fa.qa("DirectPrintDialogAsStandardDialogIsEnabled")&&!(f.a.IC||f.a.$t||f.a.Pf||f.a.JMa)&&!h.AFrameworkApplication.isUnifiedHostMode&&h.AFrameworkApplication.fa.qa("ShouldHostDefaultToNativeBrowserPrintExperience")},
set:function(){}}});Object(t.a)(a,"PrintDialogWithLinkToPdf",d.a,[])},1569:function(t,E,b){function a(f){this.pGc=!1;this.qXa=a.bfc;this.bQc=this.dOc=0;this.platform=null;this.rwg=f;this.aje=this.cQc=!1}function c(){this.state=this.callback=null;this.god=!1}function d(){this.classId=0}t=b(0);var e=b(84),h=b(42);d.sIa=function(f){try{return h.a(f)}catch(v){}return null};Object(t.a)(d,"ARoamingAppsResponse",null,[]);Object(t.a)(c,"GetRoamingAppsLauncherContext",null,[]);var k=b(4),n=b(108);b.d(E,"a",
function(){return a});a.prototype.yYg=function(){k.AFrameworkApplication.Ahc&&this.roamingAppsAreEnabled&&!this.cQc&&!this.pGc&&(this.bQc=1,this.pGc=!0,this.Chj(),this.pRe())};a.prototype.Chj=function(){this.qXa=a.bfc;this.dOc=0};a.prototype.getRoamingAppsLauncher=function(f,v,m){this.qWj?(f=new c,f.callback=v,f.state=m,f.god=!0,this.uRe(f)):v(!1,"",m)};a.prototype.pRe=function(){var f=new (b(1550).CheckRoamingRightsRequest);f.RoamingApp=this.bQc;f.BaseDocQuerySignature=k.AFrameworkApplication.Yi;
f.execute(Object(e.a)(this,this.AYg,"checkUserRoamingRightsSucceeded"),Object(e.a)(this,this.zYg,"checkUserRoamingRightsFailed"),null)};a.prototype.AYg=function(f){k.AFrameworkApplication.zg||((f=d.sIa(f.data.Rd))?this.JPd(f.HasRights):this.JPd(!1))};a.prototype.zYg=function(){if(!k.AFrameworkApplication.zg)if(this.dOc>=a.CAi)this.JPd(!1);else{var f=new n.a(2,1,this.qXa,Object(e.a)(this,this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);k.AFrameworkApplication.zi.Cg(f);this.dOc++;
this.qXa*=a.Yij;this.qXa>a.Ppf&&(this.qXa=a.Ppf)}};a.prototype.JPd=function(f){this.aje=f;this.cQc=!0;this.pGc=!1};a.prototype.retryCheckUserRoamingRights=function(){this.pRe()};a.prototype.uRe=function(f){var v=new (b(1551).GetRoamingLauncherRequest);v.RoamingApp=this.bQc;v.BaseDocQuerySignature=k.AFrameworkApplication.Yi;v.execute(Object(e.a)(this,this.zXh,"getRoamingAppsLauncherSucceeded"),Object(e.a)(this,this.yXh,"getRoamingAppsLauncherFailed"),f)};a.prototype.zXh=function(f){if(!k.AFrameworkApplication.zg){var v=
d.sIa(f.data.Rd);f=f.data.state;v?(this.platform=v.Platform,f.callback(!0,v.Launcher,f.state)):f.callback(!1,"",f.state)}};a.prototype.yXh=function(f){if(!k.AFrameworkApplication.zg){var v=f.data.state;5===f.data.status&&v.god?(v.god=!1,this.uRe(v)):v.callback(!1,"",v.state)}};of.Object.defineProperties(a.prototype,{roamingAppsAreEnabled:{configurable:!0,enumerable:!0,get:function(){return this.rwg}},qWj:{configurable:!0,enumerable:!0,get:function(){return this.roamingAppsAreEnabled&&this.cQc?this.aje:
!1}}});of.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){return a.UB||(a.UB=new a(k.AFrameworkApplication.wMg))}}});a.bfc=1E3;a.Yij=5;a.Ppf=12E5;a.CAi=5;a.UB=null;Object(t.a)(a,"RoamingAppsManager",null,[])},1642:function(t,E,b){function a(Qa){var Mb=Cf.call(this)||this;Mb.$=Qa;Mb.Eb();return Mb}function c(Qa){this.stopwatch=this.R_b=this.Vzc=this.sVd=null;this.d9f=0;this.$=Qa;(this.TWc=qd.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC"))||Qa.da.Ga(322,
this)}function d(Qa){this.eie=0;this.e9f=Qa}function e(Qa,Mb,kc,zc,Ib,rc,Ta){this.title=Qa;this.body=Mb;this.J1i=kc;this.primaryButtonAction=zc;this.secondaryButtonAction=rc;this.pXf=Ib;this.targetObject=Ta}function h(Qa){var Mb=zd.call(this)||this;Mb.$=Qa;Mb.Eb();return Mb}function k(Qa){this.$=Qa;Qa.da.Ga(309,this)}function n(Qa){var Mb=Fc.call(this,Qa)||this;Mb.Lo=null;Mb.stopwatch=null;Mb.xDi=function(kc){if(1===kc)Mb.$.Ka.Kb(new vc.a(-2050946363,Nd.a.Cb,2,8,null)).continueWith(function(Ib){Mb.Lo.setResult(!Ld.a(Ib)&&
Ib.result)}),kc="Yes";else{var zc=2===kc;Mb.Lo.setResult(zc);kc=2===kc?"No":"Close";zc&&Mb.y1i()}Mb.Fwi(kc);Mb.hide()};return Mb}function f(){}function v(Qa){return Ed.call(this,Qa)||this}function m(Qa){this.oi=Qa}function x(Qa){return hd.call(this,Qa)||this}function l(Qa,Mb,kc){var zc=sc.call(this)||this;zc.jwe=!1;zc.iwe=!1;zc.gIi=function(){zc.jwe=!0;zc.C3f()};zc.$=Qa;zc.Va=Mb;zc.RJ=kc;id.a(zc.$).OHd(new he.a(ee.a.Fcg,ee.a.idle,l.nXg),new Pd.a(ee.a.Dze,ee.a.N_,null,ee.a.IO,ee.a.idle));return zc}
function u(Qa){var Mb=Gd.call(this,Qa,Fe.a.instance.ga(1264))||this;Mb.textBox=null;Mb.hRa=null;Mb.FTa=null;Mb.sEf=function(){var kc=Mb.$;Mb.Lt();var zc=new A(kc,1267,1268,1269,function(Ib,rc,Ta){var Cb=kc.oa.va.Pb(),jc=kc.oa.va;Cb=jc.Na(1,Cb);return Mc.g(jc,"UnshareForm",Cb,Ib,rc,Ta,null,0)},16);zc.initialize();zc.qf()};return Mb}function A(Qa,Mb,kc,zc,Ib,rc){rc=void 0===rc?0:rc;Qa=td.call(this,Qa,Fe.a.instance.ga(Mb),!1)||this;Qa.message=kc;Qa.QGi=zc;Qa.G_d=Ib;Qa.operationFlags=rc;return Qa}function z(Qa,
Mb,kc){var zc=H.call(this,Qa,new Sys.UI.Point(z.heh,z.Kdh),Fe.a.instance.ga(Mb?1262:1261))||this;zc.W0a=null;zc.nLc=!1;zc.Uoc=function(Ib){function rc(tc,kd,Rd){return gb.m(Ta.oa.va,zb.b(tc,zc.QSi),kd,Rd,Cb)}var Ta=zc.$,Cb=new y;Cb.kH=Ib.Values[w.kH];var jc=!1;switch(Ib.MessageId){case w.w1f:zc.Lt();jc=!0;Cb.fEd=1334518759;break;case w.view:zc.vBa=Fe.a.instance.ga(1262);zc.Eeg(!0);break;case w.vze:zc.Lt(),jc=!0}qd.EwaSettings.Zb()?(Ib=new Nc.a(140,0,rc),Ib.flags=jc?16:80):(Ib=jc?new Nc.a(140,0,rc):
new Kb.a(140,0,rc),Ib.flags=16);Ta.userOperationManager.Sb(Ib,zc.Ed)};zc.OKi=function(){var Ib=zc.$;Ib.ya.SurveyRedirectUrl?(zc.Lt(),Ib.Cd(1305810481,0,8,null)):(zc.vBa=Fe.a.instance.ga(1261),zc.Eeg(!1))};zc.dTi=function(){var Ib=zc.$;zc.Lt();Ib.Cd(1334518759,0,8,null)};zc.dnc=function(Ib){var rc=zc.$;zc.Lt();Ib.MessageId===w.Fze&&rc.ea.Cbd()};zc.vRi=function(){zc.nLc=!0;zc.raiseEvent(z.jtd)};zc.QSi=function(Ib,rc){if(!pc.a(Ib)){Ib=zc.$;if(rc.kH){var Ta=Ib.ea.xa;if(Ta.contains(rc.kH.SheetName))zc.Mnc(rc);
else{var Cb=null;Cb=function(){Ta.Vma(Cb);zc.Mnc(rc)};Ta.Uga(Cb)}}1461300262!==rc.fEd&&Ib.Cd(rc.fEd,0,8,null)}};zc.P9d=Mb;zc.Ed=kc;return zc}function y(){this.kH=null;this.fEd=1461300262}function w(){}function D(Qa){Qa=H.call(this,Qa,new Sys.UI.Point(960,680),Fe.a.instance.ga(1257))||this;Qa.name=ie.a.RKe;return Qa}function H(Qa,Mb,kc,zc){var Ib=re.call(this,Qa,kc,2,void 0===zc?null:zc)||this;Ib.ZJc=null;Ib.onResize=function(){var rc=Ib.mRh();Ib.uLa.setAttribute("width",rc.x.toString());Ib.uLa.setAttribute("height",
rc.y.toString());Ib.FSj(rc);Ib.FAd()};Ib.TGe=Mb;Ib.$.rA(Ib.onResize);Ib.cec();return Ib}function F(Qa){return we.call(this,Qa)||this}function J(Qa){this.$=Qa}function S(Qa,Mb,kc,zc,Ib,rc,Ta,Cb){Cb=Qa.Na(9,void 0===Cb?null:Cb);Cb.sheetName=Mb;Cb.directionRtl=kc;return Mc.g(Qa,"ChangeSheetDirection",Cb,zc,Ib,rc,Ta,0)}function N(Qa,Mb,kc,zc,Ib,rc,Ta,Cb){Cb=Qa.Na(9,void 0===Cb?null:Cb);Cb.sheetName=Mb;Cb.show=kc;return Mc.g(Qa,"ShowHeadings",Cb,zc,Ib,rc,Ta,0)}function T(Qa,Mb,kc,zc,Ib,rc,Ta,Cb){Cb=Qa.Na(9,
void 0===Cb?null:Cb);Cb.sheetName=Mb;Cb.show=kc;return Mc.g(Qa,"ShowGridlines",Cb,zc,Ib,rc,Ta,0)}function G(Qa,Mb){this.sheetName=null;this.value=!1;this.sheetName=Qa;this.value=Mb}function I(Qa){return nc.call(this,Qa)||this}function K(Qa,Mb){this.oi=Mb;this.$=Qa}function L(Qa){var Mb=Ob.call(this)||this;Mb.$=Qa;Mb.Eb();return Mb}function O(Qa){return xb.call(this,Qa)||this}function B(Qa){this.ao="Excel";this.$=Qa;this.ZU=ib.a.current}function Q(Qa,Mb,kc,zc,Ib,rc,Ta){Ta=Qa.Na(9,void 0===Ta?null:
Ta);Ta.sheetName=Mb;Ta.confirmationChoice=!0;return Mc.g(Qa,"DeleteSheet",Ta,kc,zc,Ib,rc,0)}function U(){}function X(Qa){var Mb=Yc.call(this)||this;Mb.o0d=null;Mb.q0d=0;Mb.jRb=null;Mb._state=0;Mb.moveNext=function(){try{for(Mb._state=1;1===Mb._state;)Mb.TWa=Mb.TWa()}catch(kc){Mb.dispose(),Mb.DAa(kc),Mb._state=3}};Mb.tt=Qa;Mb.TWa=Mb.MDc;Mb.moveNext();return Mb}function P(){}function ea(Qa){return Oa.call(this,Qa)||this}function ia(Qa){this.oi=Qa}function da(){}function xa(){this.fb=null}function Z(Qa){this.rLa=
this.yab=null;this._initialized=!1;this.fkd=Qa}function ha(){}function ya(Qa,Mb,kc,zc){this.Fib=Qa;this.Mqa=Mb;this.Z1=kc;this.iqg=zc}function va(Qa,Mb,kc,zc,Ib,rc,Ta){var Cb=this;this.zo=null;this.Wfe=!1;this.dqa=this.T2d=0;this.Vtg=Qa;this.SWa=Mb;this.bVb=kc;this.Fib=zc;this.Mqa=Ib;this.Z1=rc;this.HDa=new ja.a(function(){return new ma.a(Ta.value,Object(aa.a)(Cb,Cb.$vb,"getMoreInfoEventReceived"))})}function bb(Qa,Mb,kc,zc,Ib,rc,Ta,Cb){var jc=this;this.YFc=null;this.$Sc=!0;this.uRb="";this.Uyg=0;
this.BWa=null;this.qMc=3;this.jb=Cb;this.Z1=Qa;this.Xi=Mb;this.upg=kc;this.wmg=zc;this.vmg=Ib;this.HDa=new ja.a(function(){return new ma.a(rc.value,null)});this.jqg=new ja.a(function(){return new ma.a(Ta.value,Object(aa.a)(jc,jc.XCi,"mruEventResultReceived"))});this.jb.qa("WacInTabOpenMRUIsEnabledForUiHost");this.jb.qa("UiHostSupportsDocRebootFeatures")}function ba(){return Ka.call(this)||this}function fa(Qa,Mb,kc,zc,Ib,rc){var Ta=this;this.cSc=this.zo=this.vRb=null;this.kXb=this.nRc=!1;this.fbe=
0;this.bRc=this.wLc=!1;this.Z1=Qa;this.Fib=Mb;this.HDa=new ja.a(function(){return new ma.a(kc.value,Object(aa.a)(Ta,Ta.$vb,"getMoreInfoEventReceived"))});this.Otg=zc;this.Mqa=Ib;this.kxg=rc;this.Rlb=this.Dxc;2===this.tK.uca&&(this.bRc=!0)}function ra(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}function pa(){}function Za(){}b.r(E);var Ua=b(1264),Ma=b(0),oa=b(258);Za.prototype.Sh=function(){};Za.prototype.init=function(){};Za.prototype.dispose=function(){};Za.main=function(){oa.a.instance.Qi(new Za)};
of.Object.defineProperties(Za.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.DialogWithLinkToResource"}}});Object(Ma.a)(Za,"CommonAppDialogWithLinkToResourcePackage",null,[10,11]);var ja=b(624),ta=b(15),aa=b(84),ma=b(1029),Ea=b(29),Ha=b(132);pa.Mlh=function(Qa){return pa.$ue("New",Qa)};pa.Nlh=function(Qa){return pa.$ue("Open",Qa)};pa.Lue=function(Qa,Mb){return pa.zha("LoadingMenuSection",pa.Eui,Qa,pa.Apb("lblLoading",Mb))};pa.Bpb=function(Qa,Mb,kc,zc){return pa.zha("MessageMenuSection",
pa.frf,Mb,pa.Apb("lblMessage",Qa,void 0===kc?null:kc,void 0===zc?null:zc))};pa.kSg=function(Qa){return pa.Lue(Qa,CommonUIStrings.l_VoicedLoadingText)};pa.lSg=function(Qa,Mb){return pa.Bpb(CommonUIStrings.l_NewCreationLocationMessage,Qa.mi,Mb.tR,Mb.foa)};pa.jSg=function(Qa,Mb){return pa.Bpb(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,Mb.foa,"\n\n"),Qa.mi)};pa.Nue=function(Qa){return pa.Bpb(CommonUIStrings.l_NewGenericErrorMessage,Qa.mi)};pa.hSg=function(Qa,Mb,kc){return pa.zha("menuNewBlank",
pa.P6h,kc?Qa.mi:null,pa.wpb(Qa.A7e,Qa.B7e,Qa.C7e,null,Qa.eka,Qa.ayb,Mb,"blank"))};pa.gTg=function(){return pa.Apb("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)};pa.Xue=function(){return pa.Apb("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)};pa.hTg=function(Qa,Mb){return pa.zha("menuNewTemplates",Qa,null,Mb)};pa.fSg=function(Qa,Mb){return pa.zha("menuNewMoreTemplates",pa.KUe,null,pa.wpb("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,
null,null,null,Qa,Mb))};pa.jRg=function(Qa,Mb,kc){var zc="";kc&&Mb&&(zc=pa.zha("BrowseMoreMenuSection",pa.KUe,null,pa.wpb("btnBrowseMore",Mb,Mb,null,null,null,Qa||"1959943459",kc)));return zc};pa.Apb=function(Qa,Mb,kc,zc){kc=void 0===kc?null:kc;var Ib=zc=void 0===zc?null:zc;Mb&&0<Mb.length&&(Ib=pa.asf.Xpc(Mb).trimEnd(),Ib=0<=Ib.indexOf("{0}")?String.format(Ib,zc):String.format("{0} {1}",Ib,zc));kc=kc&&zc?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',
Ea.a.af(kc),Ea.a.af(zc),Ea.a.af(Ib)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',Ea.a.af(Qa||""),pa.asf.Xpc(Ea.a.af(Mb||"")),kc)};pa.wpb=function(Qa,Mb,kc,zc,Ib,rc,Ta,Cb){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',Ea.a.af(Qa||""),
Ea.a.af(Mb||""),Ea.a.af(kc||""),zc||"32by32",Ea.a.af(Ib||""),Ea.a.af(rc||""),Ta,Ea.a.af(Cb||""))};pa.$ue=function(Qa,Mb){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',Qa,Mb)};pa.zha=function(Qa,Mb,kc,zc){kc=kc?String.format('Title="{0}"',Ea.a.af(kc)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',
Ea.a.af(Qa||""),Ea.a.af(Mb||""),kc,zc)};pa.frf="MenuMru";pa.Eui="MenuLoading";pa.P6h="MenuHeader";pa.KUe="MenuFooter";pa.asf=Ha.a.xx("\n","&#10;");Object(Ma.a)(pa,"NewAndOpenXmlUtilities",null,[]);var Aa=b(4),V=b(99),La=b(167);Object(Ma.a)(ra,"HostInformation",null,[]);var Ra=b(108),pb=b(39),cb=b(396),Sa=b(170),Db=b(749),Ab=b(649),Wb=b(107),ub=b(25);fa.prototype.Ag=function(){var Qa=this.tK.i9a;Qa.Mb(ub.a.newDocument,Wb.a.frame,Object(aa.a)(this,this.newDocument,"newDocument"));Qa.He(ub.a.pqc,Wb.a.frame,
Object(aa.a)(this,this.pqc,"populateNewMenu"),96)};fa.prototype.newDocument=function(Qa,Mb,kc,zc,Ib){return 1===kc?32:2===kc&&Ib&&Ib.MenuItemId&&Ib.SourceControlId?this.O0a(Ib.MenuItemId,Ib.SourceControlId):8};fa.prototype.O0a=function(Qa,Mb){var kc=this.fmc.a4c;if(null===kc)return 8;var zc=Aa.AFrameworkApplication.fa.qa("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(Aa.AFrameworkApplication.Tba&&zc){ta.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");
var Ib={};Ib[cb.a.s9f]=Qa;Ib[cb.a.sP]=this.sP;Ib[cb.a.lcid]=Aa.AFrameworkApplication.lcid.toString();Ib[cb.a.reason]=Db.a.createNew;Aa.AFrameworkApplication.iV().execute(function(rc){rc.wj(Sa.a.O0a,Ib)})}else zc=(new Date).getTime(),Mb=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",kc,Ea.a.$e(this.Fla),Ea.a.$e(Qa),Ea.a.$e(this.sP),Ea.a.$e(Aa.AFrameworkApplication.lcid.toString()),Ea.a.$e(zc.toString()),Ea.a.$e(Mb),Ea.a.$e(Aa.AFrameworkApplication.canary),
Aa.AFrameworkApplication.Yi),(kc=Aa.AFrameworkApplication.fa.Wa("ScenarioId"))&&""!==kc&&(Mb+="&wdscenarioid="+Ea.a.$e(kc)),Mb+="&"+Aa.AFrameworkApplication.tcc(),Aa.AFrameworkApplication.Twa&&(Mb+="&"+Aa.AFrameworkApplication.Mbc()),(kc=this.zo?this.zo.tR:null)&&(Mb+="&DestinationUrl="+Ea.a.$e(kc)),pb.a.Te(Mb,"_blank",void 0,"CreateNewDocument");2===this.tK.uca&&(Mb={},ta.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",(Mb.AppType=Ab.a[this.tK.uca],Mb.Template=Qa,Mb)));return 32};
fa.prototype.Kxi=function(Qa){var Mb=Number.MAX_VALUE,kc=Number.MIN_VALUE,zc=window.performance;if(zc&&"undefined"!==typeof zc.getEntriesByName){for(var Ib=0;Ib<Qa.length;Ib++){var rc=zc.getEntriesByName(Qa[Ib]);rc&&0<rc.length&&(rc=rc[0],Mb=Math.min(parseInt(String(rc.fetchStart)),Mb),kc=Math.max(parseInt(String(rc.responseEnd)),kc))}kc>Mb&&(Qa={},ta.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",(Qa.TotalElapsedMs=kc-Mb,Qa.MinFetchStart=Mb,Qa.MaxResponseEnd=kc,
Qa)))}};fa.prototype.pqc=function(Qa,Mb,kc,zc,Ib){if(1===kc)return this.bRc&&(Aa.AFrameworkApplication.gN("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.bRc=!1),32;2!==kc||this.wLc||(this.fbe=(new Date).getTime(),Qa={},ta.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",(Qa.ShouldShowTemplates=this.Dxc,Qa.CachedNewMenuXmlExists=!!this.vRb,Qa.ShouldCallGetMoreInfo=this.tK.supportsGetMoreInfoForPersonalStorage,Qa)));return this.z_i(Ib)};fa.prototype.z_i=
function(Qa){Qa&&(this.vRb?Qa.PopulationXML=this.vRb:(this.tK.supportsGetMoreInfoForPersonalStorage&&!this.zo&&this.qEi.HZ("Opened New menu",!0),Qa.PopulationXML=this.cIh(this.getTemplateListJson())));return 32};fa.prototype.qgf=function(){return!this.tK.supportsGetMoreInfoForPersonalStorage||!!this.zo&&3===this.zo.state&&!!this.zo.foa&&!!this.zo.tR};fa.prototype.Cmi=function(){return Aa.AFrameworkApplication.ta&&Aa.AFrameworkApplication.ta.Qa.k_?!0:this.qgf()};fa.prototype.getTemplateListJson=function(){var Qa=
this;if(!this.Dxc||!this.Cmi())return null;if(this.Rlb&&!this.kXb){var Mb="9",kc=Aa.AFrameworkApplication.fa.appSettings;"NumberOfTemplatesInBackstage"in kc&&(Mb=kc.NumberOfTemplatesInBackstage);var zc=this.sP;"TemplateCollectionId"in kc&&(zc=kc.TemplateCollectionId);Mb=String.format(this.tK.TV+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",Ea.a.$e(Aa.AFrameworkApplication.lcid.toString()),Ea.a.$e(zc),Mb);Boolean.parse(kc.AppendOriginQueryParam||"false")&&(Mb+="&org=backstage");Mb+="&"+Aa.AFrameworkApplication.tcc();
Aa.AFrameworkApplication.Twa&&(Mb+="&"+Aa.AFrameworkApplication.Mbc());this.tK.MDb.Zl(Mb,1,null,null,!1,2,function(Ib){Qa.tK.lca("CreateNewActor.GetTemplateListJson",Ib.data);Qa.MJj(Ib.data.Rd)},function(Ib){Qa.tK.lca("CreateNewActor.GetTemplateListJson",Ib.data);Qa.LJj()},null,void 0,void 0,void 0,void 0,"5");this.Rlb=!1}return this.cSc};fa.prototype.MJj=function(Qa){this.cSc=Qa;this.Rlb=!1;this.$Hb();if(Aa.AFrameworkApplication.ta&&Aa.AFrameworkApplication.ta.Qa.k_&&La.c()){Qa=Aa.AFrameworkApplication.fa.qa("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");
var Mb=Aa.AFrameworkApplication.Tba;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.cSc,!0,Qa&&Mb))}};fa.prototype.LJj=function(){this.kXb=this.Rlb=!0;this.$Hb();Aa.AFrameworkApplication.ta&&Aa.AFrameworkApplication.ta.Qa.k_&&La.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1));V.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)};fa.prototype.s_h=function(Qa){for(var Mb=0,kc=0;kc<Qa.length;kc++)if("ST"===
Qa[kc].ImageType){Mb=kc;break}var zc=Qa.length?Qa[Mb]:null;Qa=zc?zc.Url||"":"";var Ib,rc=kc=Mb=!1;if(zc&&(Ib=zc.AspectRatio))Ib=parseFloat(Ib),1>Ib?Mb=!0:1.5<Ib?kc=!0:1===Ib&&(rc=!0);else switch(Ib={},ta.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",(Ib.Url=Qa,Ib)),this.tK.uca){case 3:Mb=!0;break;case 2:kc=!0;break;case 5:rc=!0}return{returnValue:Qa,t9h:Mb?"95by123":kc?"123by69":rc?"100by100":"123by95"}};fa.prototype.cIh=function(Qa){var Mb=this.iSg(Qa,this.fmc,this.fmc.LGa||
"1056925771");Qa=Mb.returnValue;if(Mb.dxc){this.vRb=Qa;Mb=(new Date).getTime()-this.fbe;var kc={};ta.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",(kc.ElapsedMsSinceMenuOpened=Mb,kc))}return Qa};fa.prototype.$vb=function(Qa,Mb){ta.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.zo||3!==Qa.state?2===Qa.state&&(ta.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.nRc=!0,this.$Hb()):(this.zo=Qa,Mb||this.$Hb(),
Aa.AFrameworkApplication.ta&&Aa.AFrameworkApplication.ta.Qa.k_&&La.c()&&La.d("setFileMenuHostInformation")&&(Qa=Object.assign(new ra,{hostUrl:this.zo.tR,hostName:this.zo.foa,folderUrl:Aa.AFrameworkApplication.breadcrumbFolderUrl,folderName:Aa.AFrameworkApplication.breadcrumbFolderName}),ta.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(Qa))))};fa.prototype.iSg=function(Qa,Mb,kc){var zc=!1;var Ib=this.qgf(),
rc="";if(this.tK.supportsGetMoreInfoForPersonalStorage)if(this.nRc)rc=pa.Nue(Mb),this.nRc=!1,ta.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure");else if(this.zo)if(Ib)rc=pa.lSg(Mb,this.zo);else if(this.zo.Fdi)zc=!0,this.Rlb=!1,rc=pa.jSg(Mb,this.zo),ta.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message");else{zc=!0;rc=pa.Nue(Mb);var Ta={};ta.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",
(Ta.PersonalFileStorageUrlIsSet=!!this.zo.tR,Ta.StorageServiceDisplayNameIsSet=!!this.zo.foa,Ta))}else rc=pa.kSg(Mb.mi),ta.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner");Ib&&(Ib=rc,Mb=pa.hSg(Mb,kc,!rc),Qa=this.fTg(Qa,kc),zc=Qa.dxc,rc=Ib+(Mb+Qa.returnValue));return{returnValue:pa.Mlh(rc),dxc:zc}};fa.prototype.fTg=function(Qa,Mb){var kc=!1;if(!this.Dxc)return kc=!0,ta.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",
dxc:kc};var zc="",Ib="",rc="MenuTemplate";if(this.kXb)zc=pa.Xue(),this.kXb=!1,ta.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(Qa){try{var Ta=Sys.Serialization.JavaScriptSerializer.deserialize(Qa,!0);zc=this.eTg(Ta,Mb);ta.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");Aa.AFrameworkApplication.bsf&&"OneDrive"===this.Fla&&(Ib=pa.fSg(this.rEi,Aa.AFrameworkApplication.bsf))}catch(Cb){Mb={},ta.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",
(Mb.JsonToConvert=Qa,Mb)),zc=pa.Xue()}kc=!0}else rc="MenuLoading",zc=pa.gTg(),ta.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:pa.hTg(rc,zc)+Ib,dxc:kc}};fa.prototype.eTg=function(Qa,Mb){for(var kc=this,zc="",Ib=[],rc=0;rc<Qa.length;rc++){var Ta=Qa[rc],Cb="";if(Ta){var jc=Ta.Title,tc=Ta.AssetId,kd=Ta.Thumbnails;tc&&jc&&kd&&(Ta=void 0,Cb=this.s_h(kd),Ta=Cb.t9h,Cb=Cb.returnValue,zc+=pa.wpb("jbtnNewTemplate"+rc,jc,null,Ta,null,Cb,Mb,tc))}Ib[rc]=
Cb}Qa=new Ra.a(4,1,5E3,function(){kc.Kxi(Ib)},106);this.tK.dmc.Cg(Qa);return zc};fa.prototype.$Hb=function(){this.wLc=!0;this.tK.Urf.Pw(this.fmc.yub);this.wLc=!1};of.Object.defineProperties(fa.prototype,{sP:{configurable:!0,enumerable:!0,get:function(){switch(this.tK.uca){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}},tK:{configurable:!0,enumerable:!0,get:function(){return this.Z1.value}},fmc:{configurable:!0,enumerable:!0,get:function(){return this.Fib.value}},
qEi:{configurable:!0,enumerable:!0,get:function(){return this.HDa.value}},rEi:{configurable:!0,enumerable:!0,get:function(){return this.Otg.value}},Fla:{configurable:!0,enumerable:!0,get:function(){return this.Mqa.value}},Dxc:{configurable:!0,enumerable:!0,get:function(){return this.kxg.value}}});Object(Ma.a)(fa,"CreateNewActor",null,[]);var vb=b(1546),Ka=vb.a;$k(ba,Ka);ba.prototype.xme=function(){this.DT(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.DT(1,CommonUIStrings.l_OpenMenuServerErrorMessage);
this.DT(2,CommonUIStrings.l_Open);this.DT(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.DT(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.DT(5,CommonUIStrings.l_VoicedLoadingText)};ba.nWi=function(Qa){return ba.instance.ga(Qa)};of.Object.defineProperties(ba,{instance:{configurable:!0,enumerable:!0,get:function(){return ba.Ma||(ba.Ma=new ba)}}});ba.Ma=null;Object(Ma.a)(ba,"MruActorIntlHelper",vb.a,[]);var eb;(function(Qa){Qa[Qa.success=0]="success";Qa[Qa.failure=1]="failure";Qa[Qa.spinner=2]="spinner";
Qa[Qa.none=3]="none"})(eb||(eb={}));Object(Ma.b)("DisplayState",eb);var yb=b(42);bb.prototype.XCi=function(Qa,Mb){this.BWa=Qa;Mb||this.YNf()};bb.prototype.r$i=function(){this.uw.i9a.He(ub.a.oqc,Wb.a.frame,Object(aa.a)(this,this.oqc,"populateMruMenu"),96)};bb.prototype.oqc=function(Qa,Mb,kc,zc,Ib){return 1!==kc&&Ib?this.w_i(Ib):32};bb.prototype.w_i=function(Qa){this.rmh();this.qmh();Qa.PopulationXML=pa.Nlh(this.uRb+this.YFc);return 32};bb.prototype.rmh=function(){var Qa=3,Mb=!1;if(this.uRb&&this.Uyg===
this.BWa.xLj)Qa={},ta.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",(Qa.CacheRefresh="Not Dirty",Qa)),Qa=this.qMc;else{var kc={};ta.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",(kc.CacheRefresh="Starting",kc));kc=this.uw.dw();this.BWa=this.WCi.HZ("File Open opened",!0);if(this.uRb&&2!==this.qMc&&3!==this.BWa.state)Mb=!0;else{Qa=this.iYh(this.BWa);Aa.AFrameworkApplication.ta&&Aa.AFrameworkApplication.ta.Qa.k_&&La.c()&&
Qa&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(Qa,!0));var zc=this.dIh(this.BWa);Qa=zc.iEi;this.uRb=zc.returnValue}kc=this.uw.dw()-kc;zc={};ta.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",(zc.CacheRefresh="Complete",zc.ElapsedMs=kc,zc))}2!==Qa&&(kc={},kc=(kc.DisplayState=eb[Qa],kc),1!==Qa&&(kc.IsStale=Mb),ta.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",kc));this.qMc=Qa};bb.prototype.iYh=function(Qa){try{var Mb=yb.c(Qa.Ywd)}catch(kc){Mb=
null,ta.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",kc)}return Mb};bb.prototype.qmh=function(){if(this.$Sc){ta.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary.");var Qa=this.dzi();this.$Sc=Qa.BYj;this.YFc=Qa.returnValue}else ta.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");Qa={};ta.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",(Qa.WaitingOnLinkInfo=
this.$Sc,Qa.NotDisplayingLink=!this.YFc,Qa))};bb.prototype.dIh=function(Qa){if(1===Qa.state||0===Qa.state){Qa={};ta.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",(Qa.Display="Spinner",Qa));Qa=2;var Mb=pa.Lue(this.Oja(2),this.Oja(5))}else 3===Qa.state&&Qa.Ywd?(Mb=this.gSg(Qa.Ywd),Qa=0):(Qa={},ta.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",(Qa.Display="Server Error",Qa)),Mb=pa.Bpb(this.Oja(1),this.Oja(2)),Qa=1);return{returnValue:Mb,iEi:Qa}};bb.prototype.gSg=function(Qa){var Mb=
this.gDb.LGa||"2155708348";if(Qa.length){var kc=pa.Apb("lblRecentDocuments",this.Oja(3));for(var zc=0,Ib=0;Ib<Qa.length;Ib++){var rc=Qa[Ib];"FileName"in rc&&"DocumentUrl"in rc&&"Path"in rc&&(kc+=pa.wpb("MruButton"+Ib,rc.FileName.toString(),rc.Path.toString(),null,this.gDb.eka,this.gDb.ayb,Mb,rc.DocumentUrl.toString()),rc.IsPinned&&zc++)}kc=pa.zha("RecentDocumentsMenuSection",pa.frf,this.Oja(2),kc);Mb={};ta.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",(Mb.Display="MRU List",Mb.TotalDocuments=
Qa.length,Mb.NumPinnedDocuments=zc,Mb))}else kc=pa.Bpb(this.Oja(0),this.Oja(2)),Qa={},ta.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",(Qa.Display="Empty MRU",Qa));return kc};bb.prototype.dzi=function(){var Qa=!0;var Mb=this.CQg,kc=this.BQg;if(Mb&&kc||!this.uw.supportsGetMoreInfoForPersonalStorage)Qa=!1;else{var zc=this.Tbc.HZ("File Open",!1);3===zc.state&&(Mb=zc.tR,kc=zc.foa,Qa=!1)}kc=kc?String.format(this.Oja(4),kc):null;return{returnValue:pa.jRg(this.gDb.LGa,kc,Mb),BYj:Qa}};bb.prototype.YNf=
function(){this.uw.Urf.Pw(this.gDb.yub)};of.Object.defineProperties(bb.prototype,{uw:{configurable:!0,enumerable:!0,get:function(){return this.Z1.value}},Oja:{configurable:!0,enumerable:!0,get:function(){return this.Xi.value}},gDb:{configurable:!0,enumerable:!0,get:function(){return this.upg.value}},CQg:{configurable:!0,enumerable:!0,get:function(){return this.wmg.value}},BQg:{configurable:!0,enumerable:!0,get:function(){return this.vmg.value}},Tbc:{configurable:!0,enumerable:!0,get:function(){return this.HDa.value}},
WCi:{configurable:!0,enumerable:!0,get:function(){return this.jqg.value}}});Object(Ma.a)(bb,"MruRenderer",null,[]);var oc=b(250),Jb=b(987);va.prototype.O0a=function(){!this.zo&&this.Hxd.supportsGetMoreInfoForPersonalStorage?this.Tbc.HZ("NewDocumentFromStream",!0):this.createNewDocumentFromStream()};va.prototype.$vb=function(Qa){if(!this.zo&&3===Qa.state)this.zo=Qa;else if(2===Qa.state){this.Wfe?ta.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.Tbc.HZ("NewDocumentFromStream",
!0),this.Wfe=!0);return}this.createNewDocumentFromStream()};va.prototype.createNewDocumentFromStream=function(){this.T2d=(new Date).getTime();var Qa=this.uAh.a4c;if(null===Qa)this.SWa(null);else{var Mb=this.bVb.menuItemId,kc=this.bVb.NF,zc=this.bVb.vHj,Ib=this.bVb.zAh;this.dqa="streamBase64"===zc?Ib.length/1024:0;ta.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.sP,this.dqa);var rc=(new Date).getTime();Qa=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",
Qa,Ea.a.$e(this.Fla),Ea.a.$e(Mb),Ea.a.$e(this.sP),Ea.a.$e(Aa.AFrameworkApplication.lcid.toString()),Ea.a.$e(rc.toString()),Ea.a.$e(kc),Ea.a.$e(Aa.AFrameworkApplication.canary),Aa.AFrameworkApplication.Yi,Ea.a.$e(zc));Qa+="&"+Aa.AFrameworkApplication.tcc();Aa.AFrameworkApplication.Twa&&(Qa+="&"+Aa.AFrameworkApplication.Mbc());(Mb=this.zo?this.zo.tR:null)&&(Qa+="&DestinationUrl="+Ea.a.$e(Mb));this.Hxd.MDb.Zl(Qa,2,Ib,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(aa.a)(this,this.lEi,
"newDocumentFromStreamSuccessHandler"),Object(aa.a)(this,this.kEi,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}};va.prototype.lEi=function(Qa){if(Qa&&Qa.data&&Qa.data.Rd){var Mb=yb.d(Qa.data.Rd);var kc=Mb.Ot;Mb.returnValue?kc.StatusCode!==oc.a.QO&&kc.StatusCode!==oc.a.Wrb?(ta.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.sP,this.dqa,kc.StatusCode),this.SWa(null)):kc.NewDocumentUrl&&""!==kc.NewDocumentUrl?
(Qa=(new Date).getTime()-this.T2d,ta.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.sP,this.dqa,Qa),this.Vtg(kc.NewDocumentUrl)):(ta.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.sP,this.dqa),this.SWa(null)):(kc={},ta.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.sP,this.dqa,
(kc.ResponseData=Jb.a.afb(Qa.data.Rd),kc)),this.SWa(null))}else ta.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.sP,this.dqa),this.SWa(null)};va.prototype.kEi=function(Qa){Qa&&Qa.data&&ta.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.sP,this.dqa,Qa.data.status);this.SWa(null)};of.Object.defineProperties(va.prototype,{sP:{configurable:!0,enumerable:!0,
get:function(){switch(this.Hxd.uca){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}},uAh:{configurable:!0,enumerable:!0,get:function(){return this.Fib.value}},Fla:{configurable:!0,enumerable:!0,get:function(){return this.Mqa.value}},Hxd:{configurable:!0,enumerable:!0,get:function(){return this.Z1.value}},Tbc:{configurable:!0,enumerable:!0,get:function(){return this.HDa.value}}});Object(Ma.a)(va,"NewDocumentFromStreamOperation",null,
[]);ya.prototype.create=function(Qa,Mb,kc){return new va(Qa,Mb,kc,this.Fib,this.Mqa,this.Z1,this.iqg)};Object(Ma.a)(ya,"NewDocumentFromStreamOperationFactory",null,[882]);var dc=b(83),$a=b(575),Ba=b(58);ha.prototype.Sh=function(Qa){Qa.register(ya,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").tc().Dc(function(){return new ya(new ja.a(function(){return Aa.AFrameworkApplication.ta.Qa.ded()}),new ja.a(function(){return Aa.AFrameworkApplication.Fla}),
new ja.a(function(){return Qa.nh("Common.INewAndOpenCommonHelpers")}),new ja.a(function(){return Qa.nh("Common.IEventEmitter<Common.IGetMoreInfoResult>")}))})};ha.prototype.init=function(){var Qa=this;Aa.AFrameworkApplication.fa.Vu(function(){Qa.ryb()})};ha.prototype.ryb=function(){var Qa=$a.a.Kq(dc.a.instance.Tb("Common.INewAndOpenCommonHelpers")),Mb=$a.a.Kq(dc.a.instance.Tb("Common.IEventEmitter<Common.IGetMoreInfoResult>"));Aa.AFrameworkApplication.Fla&&Ba.Task.WAA.call(null,Qa,Mb).continueWith(function(){var zc=
new fa(new ja.a(function(){return Qa.result}),new ja.a(function(){return Aa.AFrameworkApplication.ta.Qa.ded()}),new ja.a(function(){return Mb.result}),new ja.a(function(){return Aa.AFrameworkApplication.ta.Qa.eed().LGa||"1959943459"}),new ja.a(function(){return Aa.AFrameworkApplication.Fla}),new ja.a(function(){return Aa.AFrameworkApplication.jli}));zc.Ag();zc.$Hb()});if(Aa.AFrameworkApplication.xMf){var kc=$a.a.Kq(dc.a.instance.Tb("Common.IEventEmitter<Common.IMruResult>"));Ba.Task.WAA.call(null,
Qa,Mb,kc).continueWith(function(){var zc=new bb(new ja.a(function(){return Qa.result}),new ja.a(function(){return ba.nWi}),new ja.a(function(){return Aa.AFrameworkApplication.ta.Qa.eed()}),new ja.a(function(){return Aa.AFrameworkApplication.mWi}),new ja.a(function(){return Aa.AFrameworkApplication.lWi}),new ja.a(function(){return Mb.result}),new ja.a(function(){return kc.result}),Aa.AFrameworkApplication.fa);zc.r$i();zc.YNf()})}};ha.prototype.dispose=function(){};of.Object.defineProperties(ha.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.NewAndOpen.UX"}}});Object(Ma.a)(ha,"UXPackageManager",null,[10,11,6]);var la=b(1382),ka=b(1388),ca=b(1364),Ia=b(1398),jb=b(1389),nb;(function(Qa){Qa[Qa.myFiles=0]="myFiles";Qa[Qa.recent=1]="recent";Qa[Qa.currentFolder=2]="currentFolder";Qa[Qa.yourPhone=3]="yourPhone"})(nb||(nb={}));Object(Ma.b)("SharedFilePickerLandingLocation",nb);Z.prototype.j2a=function(Qa){this._initialized||(Qa.Tn(Sa.a.cNf),Qa.Ml(Sa.a.cNf,Object(aa.a)(this,
this.zRi,"onReceivedPickerResponse")),this._initialized=!0)};Z.prototype.fed=function(Qa){var Mb=this;return this.rLa=new Promise(function(kc,zc){var Ib={};Ib[cb.a.kZi]=Qa;Mb.yab=function(rc,Ta){""===Ta?(ta.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),kc(rc)):("Canceled"===Ta?ta.ULS.sendTraceTag(572548164,306,50,Ta):ta.ULS.sendTraceTag(556901065,306,10,Ta),zc(Ta))};Mb.fkd.execute(function(rc){Mb.j2a(rc);rc.wj(Sa.a.rWi,Ib)})})};Z.prototype.zRi=function(Qa){this.yab(Qa.Values[cb.a.snj],
void 0===Qa.Values[cb.a.CDd]||null===Qa.Values[cb.a.CDd]?"":Qa.Values[cb.a.CDd])};Z.prototype.Fqd=function(){return Aa.AFrameworkApplication.fa.qa("UiHostCommonFilePicker")};Z.prototype.ODe=function(Qa,Mb,kc,zc,Ib,rc,Ta){var Cb=void 0===Cb?null:Cb;var jc={};jc[cb.a.enj]=Qa;jc[cb.a.titleText]=Mb;jc[cb.a.lKg]=kc;jc[cb.a.mKg]=zc;jc[cb.a.nKg]=!1;jc[cb.a.rhh]=!0;jc[cb.a.GAh]=Ib;jc[cb.a.oZi]=rc;jc[cb.a.nZi]=nb[Ta];La.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(jc[cb.a.pZi]="Dark");
Cb&&(null!=Cb.hWc&&(jc[cb.a.hWc]=Cb.hWc),null!=Cb.Zkd&&(jc[cb.a.Zkd]=Cb.Zkd));return jc};Object(Ma.a)(Z,"SharedFilePickerManager",null,[663]);xa.prototype.Sh=function(Qa){this.fb=Qa;Qa.register(Z,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").tc().Dc(function(){return new Z(Qa.Tb("Postmessage.IHostPostmessenger"))})};xa.prototype.init=function(){var Qa=this;Aa.AFrameworkApplication.fa.Vu(function(){Qa.ryb()})};xa.prototype.ryb=function(){this.fb.resolve("Common.App.SharedFilePicker.ISharedFilePicker")};
xa.prototype.dispose=function(){};xa.main=function(){oa.a.instance.Qi(new xa)};of.Object.defineProperties(xa.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SharedFilePicker"}}});Object(Ma.a)(xa,"SharedFilePickerPackage",null,[10,11]);var Na=b(1504),sa=b(1057),Wa=b(27);da.prototype.hle=function(Qa){var Mb=!1;Qa&&(Qa.o3c(),Qa.yTg&&(Mb=!1));return Mb};da.prototype.s6g=function(){var Qa=Aa.AFrameworkApplication.ta.Qa;Qa=new Na.a(Qa.rj,sa.a.Qcc(),!1,1===Qa.j6);this.hle(Qa)&&
ta.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")};da.prototype.o5b=function(Qa,Mb,kc,zc,Ib,rc){Qa=new Na.a(Qa,kc,zc,Mb,Ib,rc);this.hle(Qa)&&ta.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")};da.prototype.ybh=function(){var Qa=Aa.AFrameworkApplication.ta.Qa,Mb=Aa.AFrameworkApplication.fa,kc=Qa.rj,zc=1===Qa.j6;if(Mb.qa(sa.a.b1h(kc))){var Ib=sa.a.Qcc(),rc=8<Wa.a.x5a;if(2!==kc||2!==Ib||!zc){Mb=Mb.qa(sa.a.c1h(kc));var Ta=Qa.JVf(),Cb=function(){return Qa.tx};Mb&&!sa.a.Wod(sa.a.Ucd(kc))&&
this.o5b(kc,zc,Ib,rc,Cb,Ta)}}};da.prototype.init=function(){var Qa=Aa.AFrameworkApplication.fa,Mb=Qa.qa("WildFireChromeExtensionEnabled");Qa=Qa.qa("WildFireChromeExtensionBar")&&Mb;sa.a.Gxc&&Qa&&!sa.a.Wod(sa.a.pye)?this.s6g():(document.body&&sa.a.zzj&&this.ybh(),Aa.AFrameworkApplication.ub.Mb(ub.a.atd,Wb.a.frame,Object(aa.a)(this,this.atd,"launchWildFireBusinessBar")))};da.prototype.atd=function(Qa,Mb,kc,zc,Ib){if(1===kc)return 32;if(!Ib)return 8;this.o5b(Ib.app,Ib.mode,Ib.platform,Ib.useTwoButton,
null,null);return 32};da.prototype.dispose=function(){};da.prototype.Sh=function(){};da.main=function(){oa.a.instance.Qi(new da)};of.Object.defineProperties(da.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.WildFire"}}});Object(Ma.a)(da,"PackageManager",null,[10,11]);var Hb=b(1488);b(1277);var Yb=b(10),Sb=b(915),lb=b(50),wb=b(37),wa=b(187);ia.prototype.Nc=function(){return!1};ia.prototype.executeCommand=function(Qa,Mb,kc){return 2!==this.oi.$d(ub.a.newDocument,2,kc)?
Ba.Task.Ua(!0):wa.a(Mb.command)};ia.prototype.Ac=function(Qa,Mb){return 1056925771===Mb.command};ia.prototype.Tc=function(Qa,Mb,kc){Qa=!0;switch(Mb){case "PopulateNewMenu":this.oi&&this.oi.$d(ub.a.pqc,2,kc);break;default:Qa=!1}return Qa};Object(Ma.a)(ia,"CreateNewCommandHandler",null,[401]);var Oa=Sb.a;$k(ea,Oa);ea.prototype.zd=function(){var Qa=this,Mb=lb.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb),kc=lb.GetServiceTaskFactory.create(this.$.da,165,this.la,this.hb);wb.TaskExtensions.Aa(wb.TaskExtensions.Vd([Mb,
kc],this.la),function(){Qa.jd([new ia(Aa.AFrameworkApplication.ub)])},this.la,3)};ea.ka=function(Qa){Sb.a.Pd(87,new ea(Qa))};Object(Ma.a)(ea,"CreateNewCommandHandlerFactory",Sb.a,[]);var Ub=b(1379),hb=b(1279),Xb=b(1421),Gc=b(567),uc=b(103),Nc=b(177),Fb=b(11),ob=b(22),zb=b(298),ib=b(1210);P.create="Create";P.activate="Activate";P.close="Close";P.remove="Delete";P.duplicate="Duplicate";Object(Ma.a)(P,"Actions",null,[]);var fc=b(31),Ic=b(43),Yc=Ba.Task;$k(X,Yc);X.prototype.MDc=function(){this.o0d=fc.a.Xc(3,
2,0,1659,0,-1244327602,"MsFormDeleteConfirmation");this.jRb=Ic.a(this.tt.$).gj(this.o0d).G();this.jRb.isCompleted||(this._state=2,this.jRb.G9a(this.moveNext));return this.$hg};X.prototype.$hg=function(){this.q0d=this.jRb.HZ();0===this.q0d&&(this.tt.$.workbookContext.Options=Fb.HelperMethods.hO(!1,this.tt.$.workbookContext.Options,2048),this.tt.deleteMsFormMetaDataSheet());this._state=3;this.$Kb(!0)};X.prototype.dispose=function(){};Object(Ma.a)(X,"$$sm_Microsoft$Office$Excel$WebUI$Client$MsForm$MsFormCommandHandler$DeleteMsForm",
Ba.Task,[6]);U.action="Action";U.SCh="FlexPane";U.L$b="formId";U.id="id";U.title="Title";U.TPb="XlWorkbookId";U.REh="Fragment";U.host="Host";U.zMj="TopView";U.q2="auth_pvr";Object(Ma.a)(U,"Parameters",null,[]);var Mc=b(62);B.prototype.Nc=function(Qa,Mb){switch(Mb){case -105284469:return!uc.i(this.$.mg)||this.hasMsForm;case -1219864912:case 1674421386:case -1128532220:case 2023601781:return!this.hasMsForm}return!1};B.prototype.executeCommand=function(Qa,Mb){Qa=wb.TaskExtensions.kk();Mb=Mb.command;
switch(Mb){case -105284469:this.insertMsForm();break;case -1219864912:this.previewMsForm();break;case -1128532220:this.editMsForm();break;case 1674421386:this.sendMsForm();break;case 2023601781:Qa=this.deleteMsForm();break;default:Qa=wa.a(Mb)}return Qa};B.prototype.Ac=function(Qa,Mb){if(!this.$.ea.Tg.get(61))return!1;Qa=!1;switch(Mb.command){case -105284469:Qa=uc.i(this.$.mg)&&!this.hasMsForm;break;case -1219864912:case 1674421386:case -1128532220:case 2023601781:Qa=this.hasMsForm}return Qa};B.prototype.Tc=
function(){return!1};B.prototype.insertMsForm=function(){var Qa=Ea.a.oq(this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),Mb={},kc={};Mb[U.action]=P.create;Mb[U.q2]=this.q2;kc[U.action]=P.create;kc[U.TPb]=encodeURIComponent(this.OPb);kc[U.host]=this.ao;kc[U.title]=encodeURIComponent(Qa);this.XCb(Mb,kc);this.$.workbookContext.Options=Fb.HelperMethods.hO(!1,this.$.workbookContext.Options,2048)};B.prototype.editMsForm=function(){var Qa={},Mb={};Qa[U.q2]=this.q2;Mb[U.L$b]=this.Slc;Mb[U.TPb]=
encodeURIComponent(this.OPb);Mb[U.host]=this.ao;this.XCb(Qa,Mb)};B.prototype.previewMsForm=function(){var Qa={},Mb={};Qa[U.q2]=this.q2;Mb[U.L$b]=this.Slc;Mb[U.TPb]=encodeURIComponent(this.OPb);Mb[U.host]=this.ao;Mb[U.zMj]="Preview";this.XCb(Qa,Mb)};B.prototype.sendMsForm=function(){var Qa={},Mb={};Qa[U.q2]=this.q2;Mb[U.L$b]=this.Slc;Mb[U.SCh]="SendForm";Mb[U.TPb]=encodeURIComponent(this.OPb);Mb[U.host]=this.ao;this.XCb(Qa,Mb)};B.prototype.deleteMsForm=function(){return new X(this)};B.prototype.deleteMsFormMetaDataSheet=
function(){var Qa=this;this.$.userOperationManager.Rt(new Nc.a(158,0,function(Mb,kc,zc){return Q(Qa.$.oa.rw,Qa.ZU.Eub,zb.b(Mb,function(){Qa.Ieh()}),kc,zc,null)}))};B.prototype.Ieh=function(){var Qa={},Mb={};Qa[U.action]=P.remove;Qa[U.q2]=this.q2;Mb[U.action]=P.remove;Mb[U.host]=this.ao;Mb[U.L$b]=encodeURIComponent(this.Slc);Mb[U.TPb]=encodeURIComponent(this.OPb);this.XCb(Qa,Mb)};B.prototype.XCb=function(Qa,Mb){var kc=this.$.ya.MsFormBaseUrl+"/Pages/DesignPage.aspx",zc="",Ib="";if(Mb){for(var rc in Mb){var Ta=
rc,Cb=Mb[rc];Ib+=Ib.length?"&":"";Ib+=Ta+"="+Cb}Qa||(Qa={});Qa[U.REh]=encodeURIComponent(Ib)}if(Qa)for(var jc in Qa)Mb=jc,Ib=Qa[jc],zc+=zc.length?"&":"?",zc+=Mb+"="+Ib;window.open(kc+zc,"_blank")};of.Object.defineProperties(B.prototype,{hasMsForm:{configurable:!0,enumerable:!0,get:function(){return uc.c(this.$.mg)}},Slc:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.MsFormId}},OPb:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.MsFormDocUrl}},
q2:{configurable:!0,enumerable:!0,get:function(){return ob.a.contains(this.$.Lv.DocumentHostInfo.FileSource,"onedrive",!0)?"MSA":"OrgId"}}});Object(Ma.a)(B,"MsFormCommandHandler",null,[401]);var xb=Sb.a;$k(O,xb);O.prototype.zd=function(){var Qa=this,Mb=lb.GetServiceTaskFactory.create(this.$.da,203,this.la,this.hb);wb.TaskExtensions.Aa(wb.TaskExtensions.Vd([Mb],this.la),function(){Qa.jd([new B(Qa.$)])},this.la,3)};O.ka=function(Qa){Qa.ea.Tg.get(61)&&Sb.a.Pd(215,new O(Qa))};Object(Ma.a)(O,"MsFormCommandHandlerFactory",
Sb.a,[]);var wc=b(235),Ob=wc.a;$k(L,Ob);L.prototype.create=function(){var Qa=this;wb.TaskExtensions.Aa(lb.GetServiceTaskFactory.create(this.$.da,164,this.la,this.hb),function(){Qa.pb(new ha)},this.la,3)};Object(Ma.a)(L,"NewAndOpenUXFactory",wc.a,[]);K.prototype.executeCommand=function(Qa,Mb,kc){Qa=2;switch(Mb.command){case ub.a.openUrlInNewTab:Qa=this.oi.$d(ub.a.openUrlInNewTab,2,kc);break;case ub.a.$Oa:Qa=this.oi.$d(ub.a.$Oa,2,kc)}return 2!==Qa?Ba.Task.Ua(!0):wa.a(Mb.command)};K.prototype.Ac=function(Qa,
Mb){return Mb.command===ub.a.openUrlInNewTab||Mb.command===ub.a.$Oa};K.prototype.Tc=function(Qa,Mb,kc){return"PopulateMruMenu"===Mb?(this.oi.$d(ub.a.oqc,2,kc),!0):!1};K.prototype.Nc=function(){return!1};Object(Ma.a)(K,"OpenFromMruCommandHandler",null,[401]);var nc=Sb.a;$k(I,nc);I.prototype.zd=function(){var Qa=this,Mb=lb.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb),kc=lb.GetServiceTaskFactory.create(this.$.da,165,this.la,this.hb);wb.TaskExtensions.Aa(wb.TaskExtensions.Vd([Mb,kc],this.la),
function(){Qa.jd([new K(Qa.$,Aa.AFrameworkApplication.ub)])},this.la,3)};I.ka=function(Qa){Sb.a.Pd(88,new I(Qa))};Object(Ma.a)(I,"OpenFromMruCommandHandlerFactory",Sb.a,[]);var mb=b(1357),ic=b(1395),qc=b(1437),hc=b(1282),Jc=b(1375),rd=b(1283),md=b(1284),Cc=b(1380),fd=b(1422),Cd=b(1423),Sc=b(85),Md=b(394),bc=b(101),xe=b(21),Je=b(395);G.prototype.getSheetName=function(){return this.sheetName};G.prototype.Gva=function(){return this.value};Object(Ma.a)(G,"MacroRecorderSheetOptionToggledPayload",null,
[430]);J.prototype.Nc=function(){return!1};J.prototype.executeCommand=function(Qa,Mb){function kc(){return new G(zc.SheetName,tc)}var zc={};this.$.Oj(zc);Qa=Mb.command;var Ib=Object(Sc.a)(bc.a,this.$.xa.getItemByName(zc.SheetName));if(!Ib)return wa.a(Qa);switch(Qa){case 705559150:case -1411193626:var rc=16;var Ta=!Ib.hideGridLines;var Cb=T;var jc=183;var tc=Ib.hideGridLines;break;case -2052321504:case 515737500:rc=4;Ta=!Ib.headersVisible;Cb=N;jc=184;tc=!Ib.headersVisible;break;case -1478455630:rc=
2;Ta=!Ib.displayRtl;Cb=S;jc=185;tc=!Ib.displayRtl;xe.g(this.$).Ea.TRj(Ta);break;default:return wa.a(Qa)}Ib.jqb(rc,Ta);var kd=this.$.oa.va;return Md.a(this.$.userOperationManager,function(Rd,pe,le){return Cb(kd,zc.SheetName,tc,zb.b(Rd,function(Wd){J.IFb(Wd,Ib,rc,Ta)}),zb.a(pe,function(){J.TEb(Ib,rc,Ta)}),le,null)},function(Rd){return new Nc.a(jc,0,Rd,void 0,kc)},Mb)};J.prototype.Ac=function(Qa,Mb){Qa=!1;switch(Mb.command){case -1411193626:case 515737500:case -1478455630:Qa=!0;break;case 705559150:case -2052321504:Qa=
Je.a(this.$)}return Qa};J.prototype.Tc=function(){return!1};J.IFb=function(Qa,Mb,kc,zc){fc.a.Tq(Qa.Errors)&&Mb.jqb(kc,!zc)};J.TEb=function(Qa,Mb,kc){Qa.jqb(Mb,!kc)};Object(Ma.a)(J,"SheetOptionsToggleCommandHandler",null,[401]);var we=Sb.a;$k(F,we);F.prototype.zd=function(){this.jd([new J(this.$)])};F.ka=function(Qa){Sb.a.Pd(100,new F(Qa))};Object(Ma.a)(F,"SheetOptionsToggleCommandHandlerFactory",Sb.a,[]);var de=b(178),Le=b(182),Ie=b(154),jf=b(64),df=b(59),Be=b(219),Sd=b(658),vc=b(91),qd=b(1),Jd=b(261),
ld=b(221),Kd=b(12),re=ld.a;$k(H,re);H.prototype.initialize=function(){var Qa=this.$.zb+"iframeDialog_frame",Mb=this.$.zb+"iframeDialog";var kc=String.format('<iframe id="{0}" frameborder="0" scrolling="auto" src="{1}">\r\n</iframe>',Qa,this.AZe(Mb));this.Hb.style.margin=Fb.HelperMethods.nc(0);this.Hb.style.marginBottom=Fb.HelperMethods.nc(-2);this.Hb.innerHTML=kc;this.ZJc=document.getElementById(Qa);this.domElement.id=Mb;this.onResize(null,Sys.EventArgs.Empty);re.prototype.initialize.call(this)};
H.prototype.dispose=function(){this.$&&this.$.iD(this.onResize);re.prototype.dispose.call(this)};H.prototype.setFocus=function(){Kd.DOMElementExtensions.setFocus(this.uLa)};H.prototype.onHide=function(){this.uLa.contentWindow.close();Kd.DOMElementExtensions.gf(this.uLa);this.ZJc=null;re.prototype.onHide.call(this)};H.prototype.FSj=function(Qa){var Mb=this.domElement.style;Mb.width=Fb.HelperMethods.nc(Qa.x);Mb.marginLeft=Fb.HelperMethods.nc(-Qa.x/2)};H.prototype.mRh=function(){var Qa=Kd.DOMElementExtensions.getBounds(document.body);
return new Sys.UI.Point(Math.min(Math.floor(.9*Qa.width),this.TGe.x),Math.min(Math.floor(.9*Qa.height),this.TGe.y))};of.Object.defineProperties(H.prototype,{uLa:{configurable:!0,enumerable:!0,get:function(){return this.ZJc}}});Object(Ma.a)(H,"IFrameDialog",ld.a,[]);var ie=b(5),ef=b(78),Fe=b(14);$k(D,H);D.prototype.AZe=function(Qa){var Mb=new Sys.StringBuilder(this.$.ya.EmbedConfiguratorUrl);Be.a.Rg(Mb,ie.a.Doh,Qa);ef.a(this.$.ya,34)&&Be.a.Rg(Mb,ie.a.UMe,"1");ef.a(this.$.ya,35)&&Be.a.Rg(Mb,ie.a.VMe,
"1");return Mb.toString()};D.prototype.onShow=function(){ta.ULS.sendTraceTag(537151690,0,50,"EmbeddingDialog.OnShow: the dialog is being shown");H.prototype.onShow.call(this)};of.Object.defineProperties(D.prototype,{mc:{configurable:!0,enumerable:!0,get:function(){return"EmbeddingDialog"}}});Object(Ma.a)(D,"EmbeddingDialog",H,[]);var bf=b(1452),Oe=b(87),lc=b(81),Fa=b(1040);w.w1f="FrameDialog_ShareFromEdit";w.view="FrameDialog_View";w.vze="FrameDialog_CloseAndRefresh";w.twj="FrameDialog_ShareFromView";
w.edit="FrameDialog_Edit";w.E8i="FrameDialog_RefreshGrid";w.E_g="FrameDialog_CloseMe";w.Fze="FrameDialog_CloseMeError";w.ready="FrameDialog_Ready";w.RZi="FrameDialog_PleaseClose";w.kH="GotoRange";Object(Ma.a)(w,"PostMessageConstants",null,[]);var Kb=b(572),gb=b(259),Tb=b(121),pc=b(299),Xc=b(95);Object(Ma.a)(y,"SessionUpdateContext",null,[]);$k(z,H);z.prototype.PGg=function(Qa){this.addHandler(z.jtd,Qa)};z.prototype.gdj=function(Qa){this.removeHandler(z.jtd,Qa)};z.prototype.dispose=function(){Oe.a.Ia(this.W0a);
this.W0a=null;H.prototype.dispose.call(this)};z.prototype.initialize=function(){H.prototype.initialize.call(this);var Qa=lc.a.aba(this.$.ya.FormLightBoxUrl),Mb=this.W0a=new bf.a(this.uLa.contentWindow,Qa);Mb.isEnabled()&&Mb.LFa(Qa)&&(this.Mma(w.w1f,this.Uoc),this.Mma(w.view,this.Uoc),this.Mma(w.vze,this.Uoc),this.Mma(w.twj,this.dTi),this.Mma(w.edit,this.OKi),this.Mma(w.E8i,this.Uoc),this.Mma(w.ready,this.vRi),this.Mma(w.E_g,this.dnc),this.Mma(w.Fze,this.dnc))};z.prototype.close=function(Qa){Qa===
this.closeAction&&this.Lef&&this.W0a.send(new Fa.a(w.RZi))||H.prototype.close.call(this,Qa)};z.prototype.AZe=function(){return this.MDe(this.Thc)};z.prototype.MDe=function(Qa){var Mb=this.$.ya,kc=new Sys.StringBuilder(Mb.FormLightBoxUrl);Be.a.Rg(kc,ie.a.zEh,this.$.ea.sessionId);Be.a.Rg(kc,ie.a.xEh,Qa?ie.a.yEh:ie.a.wEh);Tb.a.qZa(kc,Mb);return kc.toString()};z.prototype.Eeg=function(Qa){this.nLc=!1;this.uLa.src=this.MDe(Qa);this.P9d=Qa};z.prototype.Mma=function(Qa,Mb){this.W0a.Tn(Qa);this.W0a.Ml(Qa,
Mb)};z.prototype.Mnc=function(Qa){var Mb=this.$.ea.xa.getItemByName(Qa.kH.SheetName);Mb&&0===Mb.uy&&xe.g(this.$).hg(Qa.kH,null,null,null,20,Xc.a.hEh)};of.Object.defineProperties(z.prototype,{mc:{configurable:!0,enumerable:!0,get:function(){return"FormDialog"}},Lef:{configurable:!0,enumerable:!0,get:function(){return this.nLc}},Thc:{configurable:!0,enumerable:!0,get:function(){return this.P9d}}});z.heh=900;z.Kdh=1200;z.jtd="lightBoxReady";Object(Ma.a)(z,"FormDialog",H,[474]);var pd;(function(Qa){Qa[Qa.comment=
10]="comment";Qa[Qa.range=12]="range";Qa[Qa.table=13]="table";Qa[Qa.chart=14]="chart"})(pd||(pd={}));Object(Ma.b)("NavigationType",pd);var Uc=b(1089),sd=b(118),Nb=b(19),Ja=b(630),Lb=b(1162),ec=b(301),Zb=b(949),Oc=b(53),td=Zb.a;$k(A,td);A.prototype.initialize=function(){var Qa="<div class='"+sd.a.Dn+"'>\r\n\t<div class='"+sd.a.jNe+"'>\r\n\t\t<div class='"+Nb.a.mze+"'>\r\n\t\t\t<img src='{0}' class='"+Nb.a.cQe+"' alt='{1}' />\r\n\t\t</div>\r\n\t</div>\r\n\t<div class='"+sd.a.nNe+"'>\r\n\t\t<p>{2}</p>\r\n\t</div>\r\n</div>";
Qa=String.format(Qa,Oc.a.df(13),Fe.a.instance.ga(25),Fe.a.instance.ga(this.message));this.Hb.innerHTML=Qa;this.addButton(0,this.QGi);this.addButton(1);td.prototype.initialize.call(this)};A.prototype.Ny=function(){return this.G_d};of.Object.defineProperties(A.prototype,{mc:{configurable:!0,enumerable:!0,get:function(){return"WebMethodConfirmationDialog"}},vv:{configurable:!0,enumerable:!0,get:function(){return 1005}},Rsa:{configurable:!0,enumerable:!0,get:function(){return this.operationFlags}}});
Object(Ma.a)(A,"WebMethodConfirmationDialog",Zb.a,[]);var Gd=Uc.a;$k(u,Gd);u.prototype.dispose=function(){this.FTa&&this.FTa.rda(this.sEf);Oe.a.oc([this.textBox,this.hRa,this.FTa]);this.FTa=this.hRa=this.textBox=null;Gd.prototype.dispose.call(this)};u.prototype.initialize=function(){var Qa="<div class='"+sd.a.Dn+"'>\r\n\t<span>{0}</span>\r\n</div>\r\n<div class='"+sd.a.v2a+"'>\r\n\t<input type='text' id='{1}' class='"+sd.a.xC+"' aria-live='polite' aria-atomic='true'/>\r\n\t<br />\r\n\t<a href='#' id='{2}' class='{3}'>{4}</a>\r\n</div>";
Qa=String.format(Qa,Fe.a.instance.ga(1265),"sfd_input","sfd_unshare",Nb.a.Hp,Fe.a.instance.ga(1266));this.Hb.innerHTML=Qa;this.textBox=new ec.a(this.getElementById("sfd_input"));this.hRa=new Lb.a(this.textBox.domElement);this.FTa=Ja.a.create(this.getElementById("sfd_unshare"));this.FTa.C2(this.sEf);this.textBox.text=Fe.a.instance.ga(739);this.textBox.enabled=!1;this.textBox.readOnly=!Wa.a.Ug;this.addButton(1,10);Gd.prototype.initialize.call(this)};u.prototype.xha=function(){var Qa=this;return function(Mb,
kc,zc){var Ib=Qa.$.oa.va.Pb(),rc=Qa.$.oa.va;Mb=Qa.tja(Mb);kc=Qa.Paa(kc);Ib=rc.Na(1,Ib);return Mc.g(rc,"ShareForm",Ib,Mb,kc,zc,null,0)}};u.prototype.ay=function(Qa,Mb,kc){this.textBox.text=Qa.Result;this.textBox.enabled=!0;Kd.DOMElementExtensions.setVisible(this.FTa.domElement,!0);Gd.prototype.ay.call(this,Qa,Mb,kc)};u.prototype.setFocus=function(){if(this.textBox&&this.textBox.enabled)try{this.textBox.focus();return}catch(Qa){}Gd.prototype.setFocus.call(this)};of.Object.defineProperties(u.prototype,
{mc:{configurable:!0,enumerable:!0,get:function(){return"ShareFormDialog"}}});Object(Ma.a)(u,"ShareFormDialog",Uc.a,[]);var Pd=b(256),ee=b(6),Ec=b(82),$c=b(264),id=b(68),vd=b(728),he=b(145),Ge=b(464),Ze=b(188),gf=b(269),Df=b(16),mc=b(263),sc=Le.a;$k(l,sc);l.prototype.Nc=function(Qa,Mb){Qa=this.$.workbookContext.FullDocumentInfo;switch(Mb){case 353606613:case -1099009678:case 192430811:return!qd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.ea.isNamedObjectViewMode||
this.$.isMobileMode;case 869186573:return Mb=gf.a()&&this.$.ea.Tg.get(5),!Qa.FileSharingUrl&&!Mb;case -1570751769:case 1986648902:return 131072!==(this.$.pQ&131072);case 330035228:return!(this.j3a(!0)&&this.BDc);case -509039657:return!(this.j3a()&&this.BDc);case 1334518759:return!(this.j3a()&&this.BDc&&this.twe())}return!1};l.prototype.executeCommand=function(Qa,Mb,kc){Qa=this.$.workbookContext.FullDocumentInfo;var zc=ub.a.workflow,Ib=wb.TaskExtensions.kk(),rc=Mb.command;if(rc===zc||-266099===rc)return this.L5h(Mb,
zc,Qa);switch(rc){case 1986648902:this.L0f();break;case -1570751769:this.s3h(Mb);break;case 869186573:Mb=ub.a.swj;Ib=Aa.AFrameworkApplication.fa.qa("ShareMenuIsEnabled");zc=null;(qd.EwaSettings.ma(556)||Ib)&&kc&&"CopyLink"===kc.SourceControlId?(zc={},zc[cb.a.KLb]="copy",Mb=ub.a.v1f):Ib&&kc&&"ManageAccess"===kc.SourceControlId?(zc={},zc[cb.a.KLb]="manageAccess",Mb=ub.a.uwj):kc&&"LinkToComment"===kc.SourceControlId&&(zc={},zc[cb.a.KLb]="copy",zc[cb.a.dQd]=kc.navId,Mb=ub.a.v1f);Ib=this.I4f(Qa,zc);Ze.c(Mb);
break;case -1099009678:Ib=this.cQd(12,Qa);break;case 192430811:Ib=this.cQd(13,Qa);break;case 353606613:Ib=this.cQd(14,Qa);break;case -59906385:case 1197060601:this.Z4h(Mb,Qa);break;case 1305810481:this.E5e(!1,Mb);break;case 330035228:this.E5e(!0,Mb);break;case -509039657:this.deleteForm();break;case 1334518759:Mb.qzb=!0;this.shareForm();break;case 710925581:df.a.pg.fxc("710925581")&&(Ib=wb.TaskExtensions.Aa(this.RJ.value,function(Ta){Ta.result.wj(Sa.a.conversation,{})},this.la,3));break;case 327119921:this.g3h();
break;default:Ib=wa.a(rc)}return Ib};l.prototype.Ac=function(Qa,Mb){Qa=!1;Mb=Mb.command;if(Mb===ub.a.workflow)return!0;switch(Mb){case 1986648902:case -1570751769:case 869186573:case -59906385:case 1197060601:case 1305810481:case 330035228:case -509039657:case 1334518759:case -266099:case 710925581:case 327119921:Qa=!0;break;case 353606613:case -1099009678:case 192430811:Qa=qd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&!this.$.ea.isNamedObjectViewMode}return Qa};
l.prototype.Tc=function(Qa,Mb,kc){if("PopulateFormMenu"===Mb){Mb=this.BDc?this.twe()?l.Cyh:l.Dyh:l.pEi;Qa=this.Va.Bc();for(var zc=0;zc<Mb.length;zc++)Qa.buttons.push(this.Va.lb(Mb[zc]));Mb=this.Va.kq("Forms.Flyout");Mb.pc.push(Qa);kc.MenuItems=Mb.bE();return!0}return!1};l.prototype.L5h=function(Qa,Mb,kc){return this.FMd&&Qa.command===Mb?(this.DMd(Qa,-266099),wb.TaskExtensions.eba()):wb.TaskExtensions.Aa(this.RJ.value,function(zc){Sd.a(zc.result,Sa.a.workflow,null,kc.WorkflowPostMessage)||Fb.HelperMethods.Te(kc.WorkflowUrl,
"_blank",void 0,"SocialSharingCommandHandler.WorkflowUrl")},this.la,3)};l.prototype.twe=function(){return!!this.$.workbookContext.FullDocumentInfo.ShareFormCommandUrl||this.$.ea.Tg.get(26)};l.prototype.g3h=function(){var Qa=de.a.create().toString();ta.ULS.sendTraceTag(528581128,306,50,"Calling share to teams deeplink with ID: "+Qa);var Mb=this.$.frame,kc=Mb.f9a,zc=this.$,Ib=new mc.QueryStringBuilder(Aa.AFrameworkApplication.fa.Wa("TeamsMeetingShareEndpoint"));Ib.Ei("deeplinkId",Qa);Ib.Ei("lm","deeplink");
Qa=Ib.Ei;var rc={};var Ta=new mc.QueryStringBuilder(Aa.AFrameworkApplication.fa.Wa("TeamsAppSharingUrl"));Ta.Ei("auth","2");Ta.Ei("flight","officeunihost");Ta.Ei("source","TEAMS-ELECTRON.meetingStage.deeplink");var Cb={};Cb.fileType=Ea.a.l4(zc.workbookContext.FullDocumentInfo.WorkbookPath).substring(1);Cb.objectUrl=zc.workbookContext.FullDocumentInfo.WorkbookPath;Cb.baseUrl=zc.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl;zc=zc.workbookContext.WorkbookFileVersionId;for(var jc=decodeURIComponent(zc);zc!=
jc;)zc=jc,jc=decodeURIComponent(zc);0>zc.indexOf("{")||0>zc.indexOf("}")?(ta.ULS.sendTraceTag(528250338,306,15,"Decoded fileId does not match expected format. Decoded id: "+zc),zc=""):zc=zc.substring(zc.indexOf("{")+1,zc.indexOf("}")).toLowerCase();Cb.fileId=zc;Cb=yb.c(yb.c(Cb));Ta.Ei("subEntityId",Cb.substring(1,Cb.length-1));rc.appSharingUrl=Ta.toString();rc.appId=Aa.AFrameworkApplication.fa.Wa("TeamsAppId");rc=JSON.stringify(rc);Qa.call(Ib,"appContext",rc);kc.call(Mb,Ib.toString(),!0)};l.prototype.s3h=
function(Qa){this.FMd?this.DMd(Qa,1986648902):this.L0f()};l.prototype.E5e=function(Qa,Mb){!Qa&&this.$.ya.SurveyRedirectUrl?this.c3i():(Qa=new z(this.$,Qa,Mb),Qa.initialize(),Qa.qf())};l.prototype.Z4h=function(Qa,Mb){var kc=this;this.FMd&&1197060601===Qa.command?this.DMd(Qa,-59906385):wb.TaskExtensions.Aa(this.RJ.value,function(zc){zc=zc.result;zc&&Sd.a(zc,Sa.a.replyWithChanges,null,kc.$.ea.Tg.get(8))||(zc=new Sys.StringBuilder(Mb.ReplyWithChangesUrl),Be.a.Rg(zc,Ge.e,Ge.d),Ie.a.ntw(zc.toString(),kc.$))},
this.la,3)};l.prototype.DMd=function(Qa,Mb){var kc=this,zc=id.a(this.$).dd.activityState,Ib=new vc.a(Mb,Qa.method,Qa.mode,Qa.Ne,Qa.tabName);Ic.a(this.$).cs(new Jd.a(ee.a.Jx,5,function(){zc[$c.a.fq]=ee.a.KVf;zc[vd.a.STc]=Ib;kc.$.Ok.Hy("SocialSharingSaveBeforeCommand");kc.$.Ok.ime(Ib.command)}))};l.prototype.L0f=function(){var Qa=this,Mb=this.$.ya.DocumentHostInfo;Mb.HostEmbeddedViewUrl||this.jwe?this.C3f():this.$.pe.get(53)&&wb.TaskExtensions.Aa(this.RJ.value,function(kc){Qa.wPj(kc.result)||Ie.a.ntw(Mb.FileEmbedCommandUrl,
Qa.$)},this.la,3)};l.prototype.wPj=function(Qa){return Qa.isEnabled()&&(this.iwe||(this.iwe=Qa.Ml(Sa.a.hwe,this.gIi)))?Qa.wj(Sa.a.jAh,null):!1};l.prototype.C3f=function(){if(Wa.a.Wo)Ie.a.ntw(this.$.ya.EmbedConfiguratorUrl,this.$);else{var Qa=new D(this.$);Qa.initialize();Qa.qf()}};l.prototype.deleteForm=function(){var Qa=this.$,Mb=new A(Qa,1270,1271,1263,function(kc,zc,Ib){var rc=Qa.oa.va.Pb(),Ta=Qa.oa.va;rc=Ta.Na(9,rc);rc.surveyId=null;return Mc.g(Ta,"DeleteSurvey",rc,kc,zc,Ib,null,0)});Mb.initialize();
Mb.qf()};l.prototype.shareForm=function(){var Qa=this,Mb=this.$.workbookContext.FullDocumentInfo;if(this.$.ea.Tg.get(26)){var kc=new u(this.$);kc.initialize();kc.qf()}else wb.TaskExtensions.Aa(this.RJ.value,function(zc){var Ib={};Sd.a(zc.result,Sa.a.shareForm,(Ib[cb.a.vIj]=Qa.$.workbookContext.SurveyTitle,Ib),Qa.$.ea.Tg.get(10))||Ie.a.ntw(Mb.ShareFormCommandUrl,Qa.$)},this.la,3)};l.prototype.c3i=function(){var Qa=this.$;Qa.ya.SurveyRedirectUrl.replace(RegExp("&startupdialog=[formedit|formpreview]",
"gi"),"");var Mb=new Sys.StringBuilder(Qa.ya.SurveyRedirectUrl);Be.a.Rg(Mb,"startupDialog","FormEdit");var kc=id.a(this.$),zc=kc.dd.activityState;zc[Ec.a.t2]=Mb.toString();zc[Ec.a.VL]=Ec.a.sxd;this.$.Ok.Hy("SocialSharingEnvironmentChange");Ic.a(Qa).cs(new Jd.a(ee.a.Jx,5,function(){var Ib=fc.a.Xc(3,2,1315,1316,1317,554412057,"FossEnvironmentUnsupported");kc.dd.Bt([Ib]);zc[$c.a.fq]=ee.a.Fcg}))};l.prototype.j3a=function(Qa){return(this.$.ea.isEditMode||(void 0===Qa?!1:Qa))&&this.$.ea.Tg.get(25)&&gf.a()};
l.prototype.BYh=function(Qa){var Mb=void 0===Mb?null:Mb;var kc=xe.g(this.$).ha;var zc=this.$.xa.pa?jf.d(this.$.xa.pa):null;if(!zc)return ta.ULS.sendTraceTag(537151649,0,10,"SocialSharingCommandHandler.GetSharingDetail: Unable to find current sheet id for navType: "+pd[Qa]+"."),null;14===Qa?Mb=this.$Xh(kc):12===Qa?(Mb=kc.lia,Mb=ob.a.contains(Mb,"!",!0)?Mb.split("!")[1]:Mb):13===Qa&&(kc=kc.sa.selectedRanges,kc[0]&&(kc=xe.g(this.$).Ab.dk(kc[0])))&&(Mb=kc.ij);if(!Mb)return ta.ULS.sendTraceTag(537151648,
0,10,"SocialSharingCommandHandler.GetSharingDetail: Unable to find the selected range reference or object id for navType: "+pd[Qa]),null;kc={};kc[cb.a.KLb]="copy";kc[cb.a.dQd]=this.LOh(Qa,Mb,zc);ta.ULS.sendTraceTag(537151647,0,50,"SocialSharingCommandHandler.GetSharingDetail: Send Section_Sharing post message with navType: "+pd[Qa]+" and sectionNameOrId: "+Mb+" and SheetId: "+zc);return kc};l.prototype.$Xh=function(Qa){if(Qa.Oa.e_&&(Qa=Qa.Oa.Yb.floatingObject)&&0===Qa.type){var Mb=Qa.id.split(".");
if(1<Mb.length)return Mb[1];ta.ULS.sendTraceTag(537151646,0,10,"SocialSharingCommandHandler.GetSelectedFloatingObjectXluid: Invalid floating object id =  "+Qa.id)}return null};l.prototype.LOh=function(Qa,Mb,kc){Qa=btoa(Qa+"_"+Mb+"_"+kc);Qa=Qa.replace(RegExp("\\+","g"),"-");Qa=Qa.replace(RegExp("\\/","g"),"_");return Qa=Qa.replace(RegExp("\\=+$","g"),"")};l.prototype.I4f=function(Qa,Mb){var kc=this;return wb.TaskExtensions.Aa(this.RJ.value,function(zc){Sd.a(zc.result,Sa.a.sharing,Mb,kc.$.ea.Tg.get(5))?
ta.ULS.sendTraceTag(537151644,0,50,"SocialSharingCommandHandler.ShowShareDialog: Send UI_Sharing post message with mode: "+(Mb?Mb[cb.a.KLb]:"")):Fb.HelperMethods.Te(Qa.FileSharingUrl,"_blank",void 0,"SocialSharingCommandHandler.FileSharingUrl")},this.la,3)};l.prototype.cQd=function(Qa,Mb){if(!qd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.isMobileMode)return null;var kc=this.BYh(Qa);if(kc)return ta.ULS.sendTraceTag(520737606,0,50,"SocialSharingCommandHandler.ShareExcelSection: Calling share dialog with nav id="+
kc[cb.a.dQd]),this.I4f(Mb,kc);ta.ULS.sendTraceTag(537151643,0,10,"SocialSharingCommandHandler.ShareExcelSection: Unable to get the sharing details for navType: "+pd[Qa]);return null};of.Object.defineProperties(l.prototype,{BDc:{configurable:!0,enumerable:!0,get:function(){return uc.b(this.$.mg)}},FMd:{configurable:!0,enumerable:!0,get:function(){return this.$.isEditMode&&(this.$.ea.bkh||this.$.LQ)}}});l.pEi=[103];l.Cyh=[107,104,105,106];l.Dyh=[104,105];l.nXg=[new Df.a(ee.a.Dze,554412057,0,0,1318),
new Df.a(ee.a.idle,554412057,0,1)];Object(Ma.a)(l,"SocialSharingCommandHandler",Le.a,[401]);var hd=Sb.a;$k(x,hd);x.prototype.zd=function(){var Qa=this,Mb=new ja.a(function(){return lb.GetServiceTaskFactory.create(Qa.$.da,137,Qa.la,Qa.hb)});wb.TaskExtensions.Aa(lb.GetServiceTaskFactory.create(this.$.da,102,this.la,this.hb),function(kc){Qa.jd([new l(Qa.$,kc.result,Mb)])},this.la,3)};x.ka=function(Qa){Sb.a.Pd(114,new x(Qa))};Object(Ma.a)(x,"SocialSharingCommandHandlerFactory",Sb.a,[]);var cd=b(1365);
m.prototype.executeCommand=function(Qa,Mb,kc){return 2!==this.oi.$d(ub.a.tryOfficeThroughTellMe,2,kc)?Ba.Task.Ua(!0):wa.a(Mb.command)};m.prototype.Ac=function(Qa,Mb){return 215809929===Mb.command};m.prototype.Tc=function(){return!1};m.prototype.Nc=function(){return!1};Object(Ma.a)(m,"TryOfficeThroughTellMeCommandHandler",null,[401]);var Ed=Sb.a;$k(v,Ed);v.prototype.zd=function(){this.jd([new m(Aa.AFrameworkApplication.ub)])};v.ka=function(Qa){Sb.a.Pd(207,new v(Qa))};Object(Ma.a)(v,"TryOfficeThroughTellMeCommandHandlerFactory",
Sb.a,[]);var ge=b(162),Nd=b(76),Ld=b(159),De=b(276),ke=b(150),db=b(180);f.FM=function(){return ke.a.Oo(f.rk,db.a.Xa(435))};f.rk="<div class='namedsheetview_teaching_dialog_control' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_description_label' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_textarea' id='TextArea'> <label id='TeachingDescriptionId' class='WACDialogLabel' >{0}</label> </div> </div> </div>";Object(Ma.a)(f,"NamedSheetViewTeachingDialogHtml",
null,[]);var Qb=b(51),Fc=De.a;$k(n,Fc);n.prototype.qg=function(){this.Rb=4;this.stopwatch=this.$.Fb.sc("UserAction",this.mc);var Qa=Fe.a.instance.ga(1900);this.Xf=f.FM();this.Lo=new ge.a;this.initializeAndShow(Qa,this.xDi,{});return this.Lo.task};n.prototype.lv=function(Qa){Fc.prototype.lv.call(this,Qa);this.kc(1,Fe.a.instance.ga(1902));this.kc(2,Fe.a.instance.Xa(448))};n.prototype.y1i=function(){this.$.ea.Zlc=!1};n.prototype.Fwi=function(Qa){var Mb={};Mb.a=this.$.ya.UserSessionId;Mb.b="NamedSheetViewTeachingDialogClose";
Mb.c=Qa;Mb.e=!0;this.stopwatch&&(this.stopwatch.stop(),Mb.d=this.stopwatch.qc);Qb.b().Ce(53,Mb,!0)};of.Object.defineProperties(n.prototype,{mc:{configurable:!0,enumerable:!0,get:function(){return"ShowNamedSheetViewTeachingDialog"}}});Object(Ma.a)(n,"NamedSheetViewTeachingDialog",De.a,[]);var Tc=b(163);k.prototype.RAa=function(){if(this.jzj()){if(qd.EwaSettings.ma(580)){this.$.xa.pa.Kd.xRd=!0;var Qa=new ge.a;this.$.Ka.Kb(new vc.a(-2050946363,Nd.a.Cb,2,0,null)).continueWith(function(Mb){Qa.setResult(!Ld.a(Mb)&&
Mb.result)});return Qa.task}return(new n(this.$)).qg()}return Ba.Task.Ua(!0)};k.prototype.jzj=function(){var Qa=this.$.xa.pa;return this.$.ea.q9a&&this.$.ea.Zlc&&!Qa.Kd.Ux&&this.$.ea.vM&&!Tc.f(this.$)};Object(Ma.a)(k,"NamedSheetViewPublic",null,[752]);var zd=wc.a;$k(h,zd);h.prototype.create=function(){this.pb(this.$.da.za(309)||new k(this.$))};h.ka=function(Qa){Qa.da.Ga(310,new h(Qa))};Object(Ma.a)(h,"NamedSheetViewPublicFactory",wc.a,[]);var Wc=b(7),dd=b(192),oe=b(1545),Fd=b(1080),We=b(637);Object(Ma.a)(e,
"NamedSheetViewTeachingCalloutContent",null,[]);of.Object.defineProperties(d.prototype,{b9f:{configurable:!0,enumerable:!0,get:function(){return this.eie}},l3i:{configurable:!0,enumerable:!0,get:function(){return this.b9f<this.e9f.count?this.e9f.na(this.eie++):null}}});Object(Ma.a)(d,"NamedSheetViewTeachingCalloutList",null,[]);var zf=b(1288);c.prototype.hai=function(Qa){var Mb=this;this.d9f=Qa;var kc=Object(Wc.a)(new dd.a,{});c.Pii(Qa)?(kc.add(new e(Fe.a.instance.Xa(437),Fe.a.instance.Xa(438),Fe.a.instance.ga(1930),
function(){Mb.HH(2,"Continue");Mb.BJ(!0)},Fe.a.instance.ga(1931),function(){Mb.BJ();Mb.HH(1,"ExitGuide")},zf.a())),1===Qa&&kc.add(new e(Fe.a.instance.ga(1932),Fe.a.instance.Xa(440),Fe.a.instance.ga(1930),function(){Mb.HH(2,"FirstEnterTempViewContinueSecond");Mb.BJ(!0)},Fe.a.instance.ga(1931),function(){Mb.BJ();Mb.HH(1,"FirstEnterTempViewExitGuideSecond")},zf.a())),kc.add(new e(Fe.a.instance.Xa(441),Fe.a.instance.Xa(442),Fe.a.instance.ga(1930),function(){Mb.HH(2,"FirstEnterExitCalloutContinue");Mb.BJ(!0)},
Fe.a.instance.ga(1931),function(){Mb.BJ();Mb.HH(1,"FirstEnterExitCalloutGuide")},c.g0e())),kc.add(new e(Fe.a.instance.ga(1933),Fe.a.instance.Xa(439),Fe.a.instance.ga(1934),function(){Mb.i4f();Mb.BJ();Mb.HH(1,"LearnMore")},Fe.a.instance.ga(1935),function(){Mb.BJ();Mb.HH(1,"Done")},c.f0e()))):2===Qa?kc.add(new e(Fe.a.instance.ga(1932),Fe.a.instance.Xa(440),Fe.a.instance.ga(1929),function(){Mb.BJ();Mb.HH(1,"EnterTempViewAfterPersistedView")},null,null,zf.a())):3===Qa&&(kc.add(new e(Fe.a.instance.Xa(437),
Fe.a.instance.ga(1941),Fe.a.instance.ga(1930),function(){Mb.HH(2,"AutoOptInExitCalloutContinue");Mb.BJ(!0)},Fe.a.instance.ga(1931),function(){Mb.BJ();Mb.HH(1,"AutoOptInExitGuide")},c.g0e())),kc.add(new e(Fe.a.instance.ga(1932),Fe.a.instance.Xa(440),Fe.a.instance.ga(1930),function(){Mb.HH(2,"Continue");Mb.BJ(!0)},Fe.a.instance.ga(1931),function(){Mb.BJ();Mb.HH(1,"ExitGuide")},zf.a())),kc.add(new e(Fe.a.instance.ga(1933),Fe.a.instance.Xa(439),Fe.a.instance.ga(1934),function(){Mb.i4f();Mb.BJ();Mb.HH(1,
"LearnMore")},Fe.a.instance.ga(1935),function(){Mb.BJ();Mb.HH(1,"Done")},c.f0e())));this.sVd=new d(kc)};c.prototype.i4f=function(){var Qa=new vc.a(-859308420,Nd.a.Cb,this.$.Jc,9,null),Mb={};Mb=(Mb[Nd.a.Wf]="HelpID=SheetViews",Mb.InputMethod=Nd.a.Cb,Mb[Nd.a.Mc]=ie.a.GQ,Mb.ShouldCanvasTakeFocus=!0,Mb);this.$.Ka.Kb(Qa,Mb)};c.prototype.show=function(Qa){this.hai(Qa);this.Hdb()};c.prototype.Vsj=function(Qa){this.R_b=Qa};c.prototype.Hdb=function(){var Qa=this,Mb=this.sVd.l3i;if(Mb){var kc=Object(Wc.a)(new oe.a,
{label:Mb.J1i,onExecute:Mb.primaryButtonAction}),zc=null;Mb.pXf&&(zc=Object(Wc.a)(new oe.a,{label:Mb.pXf,onExecute:Mb.secondaryButtonAction}));Mb=Object(Wc.a)(new Fd.a,{target:Mb.targetObject,content:Mb.body,title:Mb.title,showCloseIcon:!0,primaryButtonProps:kc,secondaryButtonProps:zc,useTeachingStyles:!0});Mb=this.R_b.callout(Mb);kc=Object(Wc.a)(new We.a,{onShow:function(){Qa.HH(0)}});this.Vzc=this.R_b.addNotification(Mb,kc);this.TWc||(this.$.Jqd=!0)}};c.prototype.dismiss=function(){this.BJ();this.HH(1,
"DismissedByOthers")};c.prototype.BJ=function(Qa){Qa=void 0===Qa?!1:Qa;this.Vzc&&(this.TWc||(this.$.Jqd=!1),this.R_b.removeNotification(this.Vzc),this.Vzc=null);Qa&&this.Hdb()};c.prototype.HH=function(Qa,Mb){var kc={};kc.a=this.$.ya.UserSessionId;kc.b=this.d9f;kc.c=this.sVd.b9f;kc.d=Qa;kc.e=void 0===Mb?null:Mb;0===Qa?this.stopwatch=this.$.Fb.sc("UserAction","ShowNamedSheetViewTeachingCallout"):(this.stopwatch&&(this.stopwatch.stop(),kc.f=this.stopwatch.qc,this.stopwatch=null),2===Qa&&(this.stopwatch=
this.$.Fb.sc("UserAction","ShowNamedSheetViewTeachingCalloutNext")));Qb.b().Ce(52,kc,!0)};c.f0e=function(){return document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv")};c.g0e=function(){return document.querySelector("[data-unique-id=Ribbon-NamedSheetViewExit]")};c.Pii=function(Qa){return 0===Qa||1===Qa};Object(Ma.a)(c,"NamedSheetViewTeachingCallout",null,[728]);var Cf=wc.a;$k(a,Cf);a.prototype.create=function(){var Qa=this.$.da.za(322);Qa||(Qa=new c(this.$),qd.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC")&&
this.$.da.Ga(322,Qa));this.pb(Qa)};a.ka=function(Qa){Qa.da.Ga(323,new a(Qa))};Object(Ma.a)(a,"NamedSheetViewTeachingCalloutFactory",wc.a,[]);var pf=b(1438),Hf=b(1352);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.BusinessBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.HyperLink");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.MsForm");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PresentMode");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Print");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Resize");Type.registerNamespace("_Ewa");Object(Ua.a)();Type.registerNamespace("CADWLTR");Za.main();Type.registerNamespace("Common.App.NewAndOpen.UX");oa.a.instance.Qi(new ha);Object(la.a)();Type.registerNamespace("Common");Type.registerNamespace("Common.App.OpenInClient");Object(ka.a)();Object(ca.a)();Object(Ia.a)();Object(jb.a)();Type.registerNamespace("Common.App.SharedFilePicker");xa.main();Type.registerNamespace("Common.App.WildFire");
da.main();Object(Hb.a)();Yb.a.Fa(ea.ka);Object(Ub.a)();Object(hb.a)();Object(Xb.a)();Gc.a.ti(".MsformCalloutContent{color:#fff;font-size:13pt;line-height:1;padding-right:5px;margin-bottom:12px;margin-top:-6px;padding-left:10px;width:90%}.MsFormCalloutOuter{background-color:#107c41;z-index:1030}");(function(){Yb.a.Fa(function(Qa){O.ka(Qa)})})();(function(){Yb.a.Fa(function(Qa){Qa.da.Ga(165,new L(Qa))})})();Yb.a.Fa(I.ka);Object(mb.a)();Object(ic.a)();Object(qc.a)();Object(hc.a)();Object(Jc.a)();Object(rd.a)();
Object(md.a)();Object(Cc.a)();Object(fd.a)();Object(Cd.a)();Yb.a.Fa(F.ka);Yb.a.Fa(x.ka);Object(cd.a)();Yb.a.Fa(v.ka);(function(){Yb.a.Fa(function(Qa){h.ka(Qa);a.ka(Qa)})})();Object(pf.a)();Object(Hf.a)()},929:function(t,E,b){function a(N,T){var G=S.call(this,document.createElement("div"))||this;G.Ty=null;G.BS=null;G.s8=null;G.gca=null;G.g3b=null;G.$je=null;G.Jpe=null;G.Rkf=null;G.o5a=!1;G.Ru=!1;G.KZ=!1;G.Sva=!1;G.ZIi=function(I){G.RC(I)};G.eJi=function(I){13===I.keyCode&&G.RC(I)};G.dzd=function(I){G.mo(I.nb);
return!0};G.kzd=function(I){G.R_(I.nb);return!0};G.Qnc=function(I){G.fma(I.nb?I.nb:0);return!0};G.$Ii=function(I){G.RC(I.Ca);return!0};G.akg=function(I){I=void 0===I?null:I;G.mo(I.inputMethod?I.inputMethod:0);return!0};G.bkg=function(I){I=void 0===I?null:I;G.R_(I.inputMethod?I.inputMethod:0);return!0};G.u1=N;G.wC=T;G.OXc=T.KGa.toString();G.title=T.title;G.message=T.message;G.set_visibilityMode(1);return G}b.d(E,"a",function(){return a});t=b(0);var c=b(7),d=b(15),e=b(87),h=b(236),k=b(13),n=b(109),
f=b(209),v=b(86);E=b(248);var m=b(1271),x=b(19),l=b(5),u=b(338),A=b(53),z=b(12),y=b(69),w=b(14),D=b(21),H=b(98),F=b(1118),J=b(1),S=E.a;$k(a,S);a.prototype.dispose=function(){e.a.oc([this.g3b,this.BS,this.s8]);this.Ru&&this.BS&&(h.a.instance.Ba(k.a.click,this.BS.domElement,this.dzd),n.KeyInputManager.instance.sv(this.domElement,this.$je));this.KZ&&this.s8&&(h.a.instance.Ba(k.a.click,this.s8.domElement,this.kzd),n.KeyInputManager.instance.sv(this.domElement,this.Jpe));this.Sva&&this.gca&&(h.a.instance.Ba(k.a.click,
this.gca,this.Qnc),n.KeyInputManager.instance.sv(this.domElement,this.Rkf));this.gca=this.Ty=this.u1=this.s8=this.BS=null;S.prototype.dispose.call(this)};a.prototype.update=function(){};a.prototype.YRj=function(){this.zEe(!0)};a.prototype.o3c=function(){this.zEe(!1)};a.prototype.x$g=function(){var N=this;this.message=H.a.rh(this.message);this.title=H.a.rh(this.title);f.UISurfaces.nfd().then(function(T){T.initializeMessageBarInStore();var G=Object(c.a)(new F.a,{messageTitle:N.title,message:N.message,
isMultiline:!1,messageBarType:N.wC.ATg,closeable:!N.o5a,dismissButtonAriaLabel:w.a.instance.ga(10),onDismiss:N.$Ii});if(N.Sva){var I={};G.linkProps=(I.type="AppLinkProps",I.text=N.linkText,I.onExecute=N.Qnc,I)}N.Ru&&(I={},G.firstActionButtonProps=(I.type="AppButtonProps",I.label=N.actionButton,I.onExecute=N.akg,I));N.KZ&&(I={},G.secondActionButtonProps=(I.type="AppButtonProps",I.label=N.pGa,I.onExecute=N.bkg,I));T.createNewMessageBar(N.domElement,G);return null},function(){d.ULS.sendTraceTag(524075914,
0,10,"Business Bar could not be initialized");return null});this.domElement.tabIndex=0;this.businessBar.domElement.appendChild(this.domElement)};a.prototype.AEe=function(N){var T="<div class='"+m.a.Snh+"' id='{0}'><div class='"+m.a.Qnh+"'><a class='"+m.a.Ynh+"' title='{1}'><span class='"+x.a.e3b+" "+m.a.Unh+"' id='{2}'>";this.Kk.length&&(T+="<img class='{3}' src='{4}'/>");T+="</span></a><span class='"+m.a.Xnh+"' id='{5}'>{6}</span><span class='"+m.a.Wnh+"' id='message'>{7}</span><a id='link' href='#' class='"+
m.a.Vnh+"'>{8}</a><span class='"+m.a.NMe+"'><button type='button' id='action' class='"+m.a.MMe+"'>{9}</button></span><span class='"+m.a.NMe+"'><button type='button' id='altAction' class='"+m.a.MMe+"'>{10}</button></span></div><a class='"+m.a.Tnh+"' tabindex='0' role='button'><span id='close' class='"+x.a.HA+"'><img class='"+x.a.K9c+"' src='{11}' alt='{12}' title='{12}' role='button'/></span></a></div>";N||(this.domElement.tabIndex=0,this.businessBar.domElement.appendChild(this.domElement));var G=
this.businessBar.$.zb;N=G+"ewaBusinessBarEntryBody"+this.OXc;var I=G+"ewaBusinessBarEntryTitle"+this.OXc;G=G+"ewaBusinessBarEntryIcon"+this.OXc;this.domElement.className=m.a.Rnh;this.domElement.innerHTML=String.format(T,N,this.alt,G,this.Kk,A.a.df(0),I,this.title,this.message,this.linkText,this.actionButton,this.pGa,A.a.df(13),w.a.instance.ga(792));z.DOMElementExtensions.iu(this.domElement,l.a.csa,I,N);this.gca=$get("link",this.domElement);z.DOMElementExtensions.setVisible(this.gca,this.Sva);this.Sva&&
(h.a.instance.ra(k.a.click,this.gca,this.Qnc),this.Rkf=n.KeyInputManager.instance.ds(this.gca,this.Qnc,v.a.Qh,v.a.l1));this.BS=new u.a(z.DOMElementExtensions.getElementById(this.domElement,"action"));this.BS.isVisible=this.Ru;this.s8=new u.a(z.DOMElementExtensions.getElementById(this.domElement,"altAction"));this.s8.isVisible=this.KZ;this.Ru&&(h.a.instance.ra(k.a.click,this.BS.domElement,this.dzd),this.$je=n.KeyInputManager.instance.ds(this.BS.domElement,this.dzd,v.a.Qh,v.a.l1),this.KZ&&(h.a.instance.ra(k.a.click,
this.s8.domElement,this.kzd),this.Jpe=n.KeyInputManager.instance.ds(this.BS.domElement,this.kzd,v.a.Qh,v.a.l1)));this.Ty=$get("close",this.domElement);this.g3b=this.je.Td(this.Ty);this.g3b.ka("click",this.ZIi);this.g3b.ka("keydown",this.eJi);z.DOMElementExtensions.setVisible(this.Ty,!this.o5a)};a.prototype.zEe=function(N){64==this.wC.KGa?this.AEe(N):J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.x$g():this.AEe(N)};a.prototype.mo=function(){d.ULS.sendTraceTag(21517968,
0,50,"BusinessBar ["+this.wC.hash+"]: BusinessBarEntry.OnActionClick() for EntryName "+this.wC.F8c);D.g(this.businessBar.$).xo(!0)};a.prototype.R_=function(){d.ULS.sendTraceTag(537170257,0,50,"BusinessBar ["+this.wC.hash+"]: BusinessBarEntry.OnAltActionClick()");D.g(this.businessBar.$).xo(!0)};a.prototype.fma=function(){d.ULS.sendTraceTag(537170256,0,50,"BusinessBar ["+this.wC.hash+"]: BusinessBarEntry.OnLinkClick()");D.g(this.businessBar.$).xo(!0)};a.prototype.RC=function(N){d.ULS.sendTraceTag(21517971,
0,50,"BusinessBar ["+this.wC.hash+"]: BusinessBarEntry.OnCloseClick() for EntryName "+this.wC.F8c);this.set_visible(!1);this.businessBar.removeEntry(this.BTg);y.g(N)};of.Object.defineProperties(a.prototype,{BTg:{configurable:!0,enumerable:!0,get:function(){return this.wC.KGa}},businessBar:{configurable:!0,enumerable:!0,get:function(){return this.u1}},actionButton:{configurable:!0,enumerable:!0,get:function(){return this.wC?this.wC.actionButton:""}},pGa:{configurable:!0,enumerable:!0,get:function(){return this.wC?
this.wC.pGa:""}},linkText:{configurable:!0,enumerable:!0,get:function(){return this.wC?this.wC.link:""}},Kk:{configurable:!0,enumerable:!0,get:function(){return this.wC?this.wC.Kk:""}},alt:{configurable:!0,enumerable:!0,get:function(){return this.wC?this.wC.alt:""}}});Object(t.a)(a,"BusinessBarEntry",E.a,[])}}]);

//# sourceMappingURL=EwaDS.kmhv.js.map