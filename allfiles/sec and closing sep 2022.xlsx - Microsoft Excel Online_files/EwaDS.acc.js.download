(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[25],{1333:function(t,E,b){function a(){c.a.ti(".ewr-selection-draghandle,.ewr-selection-draghandle-grab{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-grab{cursor:grab}.ewr-selection-draghandle-top-ie,.ewr-selection-draghandle-top-ie-enhanced{top:-2px;left:-2px;right:-2px;height:5px}.ewr-selection-draghandle-top-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-top,.ewr-selection-draghandle-top-enhanced{top:-2px;left:-2px;right:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-top-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom-ie,.ewr-selection-draghandle-bottom-ie-enhanced{right:0;left:-2px;bottom:-2px;height:5px}.ewr-selection-draghandle-bottom-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom,.ewr-selection-draghandle-bottom-enhanced{right:0;left:-2px;bottom:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-left-ie,.ewr-selection-draghandle-left-ie-enhanced{top:0;left:-2px;bottom:0;width:5px}.ewr-selection-draghandle-left-ie-enhanced{border-top:1.5px solid transparent}.ewr-selection-draghandle-left,.ewr-selection-draghandle-left-enhanced{top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-enhanced{border-left:1.5px solid transparent}.ewr-selection-draghandle-right-ie,.ewr-selection-draghandle-right-ie-enhanced{top:0;right:-2px;bottom:0;width:5px}.ewr-selection-draghandle-right-ie-enhanced{border-right:1.5px solid transparent}.ewr-selection-draghandle-right,.ewr-selection-draghandle-right-enhanced{top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-enhanced{border-right:1.5px solid transparent}.ewr-selection-dragtooltip{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:18px;font-size:12px;padding-left:2px;padding-right:2px}.ewr-selection-dragtooltip-updated{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:fit-content;width:max-content;font-size:10px;padding-left:2px;padding-right:2px}.ewr_selection_rearrangeleft{border-left:3px solid #217346;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #217346;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #217346;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #217346;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:unset}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#217346;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}")}
b.d(E,"a",function(){return a});var c=b(567)},1334:function(t,E,b){function a(){c.a.ti('.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}a.ewa-stb-navbutton.cui-disabled:focus{outline:auto 1px}.ewa-stb-navareaextra a.ewa-stb-navbutton:focus-visible{outline-offset:-1px}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0%;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media(prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.tab-anchor-text:focus-visible{outline-offset:-1px}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:rgba(0,0,0,0);border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width 400ms cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-tabs .tab-text,.ewa-stb-tabs .tab-content-container{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px !important;height:14px}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0 !important;margin-right:4px !important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar *::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px !important;height:13px !important;width:12px !important}.ewa-stb-tabs .ewa-stb-locked-sheet-svg-16px{margin-right:4px}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0 !important;margin-left:4px !important}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .tab-hover,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39 !important;border:1px solid #e5e5e5 !important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}')}
b.d(E,"a",function(){return a});var c=b(567)},1335:function(t,E,b){function a(){c.a.ti(".ewa-svg-icon{height:100%;width:100%}")}b.d(E,"a",function(){return a});var c=b(567)},1336:function(t,E,b){function a(f,v){this.ID=f;this.type=v}function c(f,v){this.value=f;this.contextId=v}function d(f,v,m,x,l,u,A,z){this.type=f;this.startTime=null==m||void 0==m.value?new c(m,null):m;this.endTime=null==x||void 0==x.value?new c(x,null):x;null!=l&&void 0!=l.value||new c(l,null);null!=u&&void 0!=u.value||new c(u,
null);this.operationType=z}function e(f){this.ID=f}function h(){this.Ce=[];this.hob=[];this.qWc=0;this.duration=this.startTime=null;this.Y7b={};this.bwd=this.Fwd=this.PXc=-1}function k(f){var v;return(null!=document.body.style.msTransform?v=f.style.msTransform:null!=document.body.style.webkitTransform?v=f.style.webkitTransform:null!=document.body.style.mozTransform?v=f.style.K1j:null!=document.body.style.oTransform?v=f.style.S1j:null!=document.body.style.transform&&(v=f.style.transform),v)?(v=v.replace("rotate(",
""),v=v.replace("deg)",""),parseFloat(v)):0}b.d(E,"a",function(){return k});new a(0,0,0,0,0,0);new a(1,1,0,0,0,0);new a(2,2,0,0,0,0);new a(3,3,0,0,0,1);new a(4,3,1,0,1,1);new a(5,3,0,0,.42,1);new a(6,3,.83,0,1,1);new a(7,3,0,0,.58,1);new a(8,3,.42,0,.58,1);new a(9,3,.1,.25,.75,.9);new a(10,3,.1,.9,.2,1);new a(11,3,.1,.9,.2,1);new a(12,3,.9,.1,.2,1);new a(13,3,.4,0,0,1);new a(14,3,.13,.21,.1,.7);new a(15,3,.02,.33,.38,.77);new a(16,3,.57,.17,.95,.75);new a(17,3,0,.19,.07,.72);new a(18,3,0,0,.95,.37);
new a(19,3,.66,0,.34,1);new a(20,3,.8,0,.2,1);new a(21,3,.8,0,.2,1);d.prototype={type:0,startTime:new c(0,null),endTime:new c(0,null),x2j:new c(0,null),X0j:new c(0,null),operationType:0};t=Array(1);t[0]=new c(0,0);new e(0,[new d(5,0,0,0,null,1,1,0)]);new e(1,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,50,null,1,1,0)]);new e(2,[new d(1,3,0,167,null,0,1,1),new d(2,3,0,167,null,0,1,1)]);new e(3,[new d(3,3,0,167,null,0,1,1),new d(4,3,0,167,null,0,1,1)]);new e(4,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,167,null,
1,1,0)]);new e(5,[new d(5,2,0,167,null,0,1,0)]);new e(6,[new d(1,3,0,100,null,0,1,1),new d(2,3,0,100,null,0,1,1)]);new e(7,[new d(3,3,0,100,null,0,1,1),new d(4,3,0,100,null,0,1,1)]);new e(8,[new d(5,2,0,100,null,1,1,0)]);new e(9,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,100,null,1,1,0)]);new e(10,[new d(5,2,0,100,null,0,1,0)]);new e(11,[new d(1,3,0,267,null,0,1,1),new d(2,3,0,267,null,0,1,1)]);new e(12,[new d(3,3,0,267,null,0,1,1),new d(4,3,0,267,null,0,1,1)]);new e(13,[new d(5,2,0,267,null,1,1,0)]);
new e(14,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,267,null,1,1,0)]);new e(15,[new d(5,2,0,267,null,0,1,0)]);new e(16,[new d(6,3,0,267,null,0,1,1),new d(7,3,0,267,null,0,1,1)]);new e(17,[new d(1,3,0,750,null,0,1,1),new d(2,3,0,750,null,0,1,1)]);new e(18,[new d(3,3,0,750,null,0,1,1),new d(4,3,0,750,null,0,1,1)]);new e(19,[new d(5,2,0,750,null,1,1,0)]);new e(20,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,750,null,1,1,0)]);new e(21,[new d(6,3,0,1E3,null,0,1,1),new d(7,3,0,1E3,null,0,1,1)]);new e(22,[new d(1,
3,0,367,null,0,1,1),new d(2,3,0,367,null,0,1,1)]);new e(23,[new d(3,3,0,367,null,0,1,1),new d(4,3,0,367,null,0,1,1)]);new e(24,[new d(5,2,0,367,null,1,1,0)]);new e(25,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,367,null,1,1,0)]);new e(26,[new d(5,2,0,367,null,0,1,0)]);new e(27,[new d(6,2,0,t[0],null,0,1,1),new d(7,2,0,t[0],null,0,1,1)]);new e(28,[new d(5,2,0,0,null,1,1,0),new d(5,2,0,50,null,0,1,0)]);new e(29,[new d(1,3,0,433,null,0,1,1),new d(2,3,0,433,null,0,1,1)]);new e(30,[new d(5,2,0,0,null,0,2,0),
new d(5,2,0,50,null,1,1,0),new d(2,3,0,0,null,40,1,1),new d(2,3,0,100,null,0,1,1)]);new e(31,[new d(2,0,0,0,null,32,1,1),new d(2,0,0,100,null,32,1,1),new d(2,3,101,350,null,0,1,1),new d(3,0,0,0,null,0,2,1),new d(3,0,0,100,null,0,2,1),new d(3,3,101,350,null,0,1,1),new d(5,0,0,0,null,0,2,0),new d(5,0,0,100,null,1,1,0)]);new e(32,[new d(2,3,0,267,null,32,1,1),new d(3,3,0,267,null,0,2,1),new d(5,2,0,0,null,1,0,0),new d(5,2,0,267,null,0,2,0)]);new e(33,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,100,null,0,
2,0),new d(5,2,101,267,null,1,1,0)]);new e(34,[new d(1,10,0,300,null,0,1,1),new d(2,10,0,300,null,0,1,1)]);new e(35,[new d(3,10,0,300,null,0,1,1),new d(4,10,0,300,null,0,1,1)]);new e(36,[new d(1,8,0,750,null,0,1,1),new d(2,8,0,750,null,0,1,1)]);new e(37,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,200,null,0,2,0),new d(5,3,201,500,null,1,1,0)]);new e(38,[new d(1,2,0,0,null,0,2,1),new d(2,2,0,0,null,0,2,1),new d(1,2,0,200,null,0,2,1),new d(2,2,0,200,null,0,2,1),new d(1,3,201,267,null,0,1,1),new d(2,3,201,
267,null,0,1,1)]);new e(39,[new d(1,3,0,267,null,0,1,1),new d(2,3,0,267,null,0,1,1)]);new e(40,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,267,null,1,1,0)]);new e(41,[new d(5,2,0,267,null,0,1,0)]);window.location.search.indexOf("AnimationLogging=1");window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(f){window.setTimeout(f,16)}}();h.prototype=
{Ce:null,LKg:5,hob:null,qWc:0,startTime:null,duration:null,Y7b:null,PXc:-1,Fwd:-1,bwd:-1};h.prototype.Start=function(){this.startTime=new Date;this.Y7b={}};h.prototype.GetRecentAnimationStats=function(){var f,v=[],m=0;for(f=n.qWc;f<n.LKg;f++)null!=n.hob[f]&&(v[m]=n.hob[f],m++);for(f=0;f<n.qWc;f++)null!=n.hob[f]&&(v[m]=n.hob[f],m++);return v};h.prototype.GetAnimationSqmStats=function(){var f=[];return f[0]=0>n.PXc?0:n.PXc,f[1]=0>n.Fwd?0:n.Fwd,f[2]=0>n.bwd?0:n.bwd,f};var n=new h},1337:function(t,E,
b){function a(v){var m=f.call(this)||this;m.hT=[];m.ff=function(y,w){var D,H=w.ed.block;y=!1;if(H.tk&&H.state&1&&(D=m.view.Gf(w.ed.block.ie.BlockCachePosition.PaneType).cG(w.ed.hash))){H=m.wGd(H.ke);if(D=D.jf)for(var F=m.hT.length-1;0<=F;F--)D.contains(m.hT[F].bottomRight)&&(m.hT.splice(F,1),y=!0);if(H)for(D=0,F=H.length;D<F;D++)m.rangeList.push(e.a.sQ(H[D])),y=!0;y&&(w=(n.EwaSettings.isChangeGateEnabled("OfficeVSO:6336710_ApplyHeaderSnappingOnVerticalFreezePane")?m.view.ypc(w.ed.block.ie.BlockCachePosition.PaneType):
m.view.NY).cG(w.ed.hash),m.raiseEvent(a.xGd,new k.a(w)))}};m.Dm=function(){m.nIb()};m.oo=function(){m.hT=[]};m.oje=v;var x=v.Ea;x.Hs(m.ff);x.Sga(m.ff);x.FZb(m.ff);x.vG(m.Dm);v.$.xa.iJ(m.oo);v.$.vb.iJ(m.oo);x=ik(v.hn);for(var l=x.next();!l.done;l=x.next()){l=ik(l.value);for(var u=l.next();!u.done;u=l.next()){u=ik(u.value);for(var A=u.next();!A.done;A=u.next()){A=A.value;var z=v.Ea.ml(A.hashCode);m.ff(m,new d.a(new c.a(z,A.hashCode),null))}}}return m}b.d(E,"a",function(){return a});t=b(0);E=b(38);var c=
b(229),d=b(382),e=b(191),h=b(41),k=b(714),n=b(1),f=E.a;$k(a,f);a.prototype.dispose=function(){this.view&&(this.view.Ea.Eq(this.ff),this.view.Ea.YH(this.Dm),this.view.Ea.rbb(this.ff),this.view.Ea.FIb(this.ff),this.view.$.xa.JK(this.oo),this.view.$.vb.JK(this.oo));this.hT=this.oje=null;f.prototype.dispose.call(this)};a.prototype.yZb=function(v){v=this.wGd(v);var m=n.EwaSettings.isChangeGateEnabled("OfficeVSO:6336710_ApplyHeaderSnappingOnVerticalFreezePane")?this.view.YG:this.view.Vg;if(v&&0<v.length&&
m)for(var x=0,l=v.length;x<l;x++)m.contains(this.hT[x])||this.hT.push(e.a.sQ(v[x]))};a.prototype.nIb=function(){var v=n.EwaSettings.isChangeGateEnabled("OfficeVSO:6336710_ApplyHeaderSnappingOnVerticalFreezePane")?this.view.YG:this.view.Vg;if(this.hT.length&&v)for(var m=this.hT.length-1;0<=m;m--)v.contains(this.hT[m])||this.hT.splice(m,1)};a.prototype.w1e=function(v){return this.S0e(v)};a.prototype.S0e=function(v){v=h.I(v,this.hT,!0);return 0<v.length?v[0]:null};of.Object.defineProperties(a.prototype,
{rangeList:{configurable:!0,enumerable:!0,get:function(){return this.hT}},view:{configurable:!0,enumerable:!0,get:function(){return this.oje}}});a.xGd="lrc";Object(t.a)(a,"LoadedRangeCollection",E.a,[])},1338:function(t,E,b){function a(){c.a.ti(".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}")}
b.d(E,"a",function(){return a});var c=b(567)},1351:function(t,E,b){function a(){ea.a.Fa(c.ka);ea.a.Fa(X.ka)}function c(ib){var fc=zb.call(this)||this;fc.$=ib;fc.Eb();return fc}function d(ib,fc){var Ic=ob.call(this)||this;Ic.Pob=function(Yc,Mc){Yc=Mc.K4;var xb=Ic.gridView;Mc=Mc.b8h;var wc=Mc.mf,Ob=Mc.n$;bb.a.Ug&&Ob.push(new z(wc,xb));switch(Yc){case 24:Mc.n$.push(new u(wc,Mc));break;case 0:Mc.n$.push(new y(wc,xb));bb.a.Wo||(vb.EwaSettings.isChangeGateEnabled("OfficeVSO:6170982_UseDragSelectionClickBehaviorTableRange")?
(Ob.push(new D(wc,Ic.gridView.$,Mc.paneType,Ic.tableManager,Ic.Wn)),vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)&&Ob.push(new w(wc,Ic.gridView.$,Mc.paneType,Ic.tableManager,Ic.Wn))):Ob.push(new F(wc,Ic.gridView.$,Mc.paneType,Ic.tableManager,Ic.Wn)));Ob.push(new e(Mc,wc,xb,Mc.paneType));break;case 3:Ob.push(new I(wc));bb.a.Wo||(Ob.push(new N(wc,Ic.gridView.$,Mc.paneType,Ic.jF,Ic.Wn,Mc)),Ob.push(new v(wc,Ic.gridView,Ic.jF,Ic.Wn,Mc)),Ob.push(new f(wc,
Ic.gridView,Ic.jF,Ic.Wn,Mc)));break;case 4:case 5:Ob.push(new n(wc));break;case 30:Ob.push(new k(wc));break;case 16:Ob.push(new h(wc));Ob.push(new l(Mc,wc,xb,Mc.paneType));break;case 11:case 12:Ob.push(new x(wc,11===Yc));break;case 17:Ob.push(new I(wc));break;case 19:Ob.push(new I(wc)),Ob.push(new K(Mc,wc,xb,Mc.paneType))}Mc.X0b=!0};Ic.$=ib;Ic.gridView=Jb.g(ib);Ic.tableManager=fc;Ic.jF=new A(Ic.gridView);Ic.Wn=new Q(Ic.gridView);Ic.gridView.qb&&(Ic.gridView.qb.tGg(Ic.Pob),Ic.gridView.qb.update(!1));
ib.da.Ga(64,Ic);return Ic}function e(ib,fc,Ic,Yc){return L.call(this,ib,fc,Ic,Yc)||this}function h(ib){var fc=B.call(this,ib)||this;h.Qrb(ib,V.a.Vwh+" "+ub.a.tua);h.Qrb(ib,V.a.Uwh+" "+ub.a.tua);h.Qrb(ib,V.a.Rwh+" "+ub.a.tua);h.Qrb(ib,V.a.Twh+" "+ub.a.tua);h.Qrb(ib,ub.a.Swh);return fc}function k(ib){var fc=B.call(this,ib)||this;appChrome.renderSpinner(ib);return fc}function n(ib){var fc=B.call(this,ib)||this;n.Brb(ib,V.a.uwh+" "+ub.a.tua);n.Brb(ib,V.a.twh+" "+ub.a.tua);n.Brb(ib,V.a.qwh+" "+ub.a.tua);
n.Brb(ib,V.a.swh+" "+ub.a.tua);n.Brb(ib,ub.a.rwh);return fc}function f(ib,fc,Ic,Yc,Mc){var xb=m.call(this,ib,fc,Ic,Yc,Mc)||this;xb.dFb=function(){var wc=3===Ra.a.Cb;xb.xsd&&!wc?xb.Wn.vLb(xb.oba,xb.RK,!1):!xb.xsd&&wc&&xb.Wn.vLb(xb.oba,xb.RK,!0);xb.xsd=wc};xb.QRi=function(wc,Ob){Ob.oyb===xb.oba.K$&&xb.Wn.vLb(xb.oba,xb.RK,!Ob.start&&xb.zRd())};Ra.a.Mne(xb.dFb);xb.xsd=3===Ra.a.Cb;xb.Wn.WGg(xb.QRi);return xb}function v(ib,fc,Ic,Yc,Mc){return m.call(this,ib,fc,Ic,Yc,Mc)||this}function m(ib,fc,Ic,Yc,Mc){var xb=
B.call(this,ib)||this;xb.XK=null;xb.Ya=null;xb.t3=0;xb.sourceRange=null;xb.gb=null;xb.JSa=!1;xb.onPointerDown=function(wc){wc=Ka.a(xb.$).Sd(wc);if(xb.s2f(wc)&&!xb.JSa){xb.Wmf();xb.Ya=xb.Wn.Fcd();xb.XK=xb.Wn.h2e(wc);if(!xb.Ya||!xb.XK||!xb.XK.range)return fa.ULS.shipAssertTag(537159361,0,!!xb.Ya,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),fa.ULS.shipAssertTag(537159360,0,!!xb.XK,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),fa.ULS.shipAssertTag(537159331,
0,!!xb.XK.range,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),!1;xb.gb=xb.XK.range.clone();xb.sourceRange=xb.gb.clone();xb.t3=xb.mZe(wc);if(4===xb.t3)return fa.ULS.shipAssertTag(537159330,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;var Ob=xb.Y_e(wc,!0);if(!Ob)return fa.ULS.shipAssertTag(537159329,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),!1;if(!xb.mEe(Ob))return fa.ULS.shipAssertTag(537159328,
0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;xb.gridView.DLa=!0;xb.Ya.dE(!1);xb.jF.HJe(wc.yb);xb.Wn.jLf(!0,xb.oba.K$);xb.Ya.textBox.removeSelection();xb.Ya.TZb(xb.P5e);xb.BOf();xb.JSa=!0;oc.b(xb.$,!0)}return!0};xb.xh=function(wc){wc=Ka.a(xb.$).Sd(wc);wc=xb.Y_e(wc,!1);if(!wc)return!0;wc=xb.mEe(wc);if(!wc)return fa.ULS.shipAssertTag(537159327,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),xb.h$b(!0),!1;if(xb.gb.equals(wc))return!0;xb.gb=
wc;wc=xb.yy();wc||(fa.ULS.shipAssertTag(537159326,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),xb.h$b(!0));return wc};xb.Ff=function(wc){Ka.a(xb.$).Sd(wc);wc=xb.cL();fa.ULS.shipAssertTag(537159325,0,wc,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed");xb.h$b(!wc);return wc};xb.P5e=function(){xb.h$b(!0)};xb.gridView=fc;xb.$=fc.$;xb.RK=[];xb.ha=xb.gridView.ha;xb.jF=Ic;xb.Wn=Yc;xb.oba=Mc;xb.coloredReferencesManager=xb.$.da.za(281);fa.ULS.shipAssertTag(537159362,
0,!!xb.coloredReferencesManager,"ResizeMarqueeBehaviorBase Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");fc=ik(xb.LTf());for(Ic=fc.next();!Ic.done;Ic=fc.next())Ic=xb.Wn.zDe(ib,Ic.value,xb.Ooe(),xb.onPointerDown),xb.RK.push(Ic);ib=ik(xb.RK);for(fc=ib.next();!fc.done;fc=ib.next())fc=fc.value,ra.a.instance.ra(pa.a.iW,fc,xb.jF.b9e),ra.a.instance.ra(pa.a.jy,fc,xb.jF.c9e);xb.ZYa(Mc);return xb}function x(ib,fc){var Ic=B.call(this,ib)||this;var Yc=document.createElement("div"),
Mc=document.createElement("div");Yc.className=fc?G.Xwh:G.Zwh;Mc.className=fc?G.Ywh:G.Wwh;ib.appendChild(Yc);ib.appendChild(Mc);return Ic}function l(ib,fc,Ic,Yc){return L.call(this,ib,fc,Ic,Yc)||this}function u(ib,fc){var Ic=B.call(this,ib)||this;Ic.$Af=function(){if(!Ic.Tu)return fa.ULS.shipAssertTag(537159364,0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),!1;Ic.Tu.BLf(Ic.oH,!1);Ic.Tu.xLe(Ic.oH,!1);if(3===Ic.Tu.model.state)return!0;Ic.Tu.Y8e(!0);return!0};
Ic.Fca=function(){if(!Ic.Tu)return!1;Ic.Tu.B4i();Ic.Tu.lLd(Ic.oH,!1);if(3===Ic.Tu.model.state)return!0;Ic.Tu.Y8e(!1);return!0};Ic.onPointerDown=function(Yc){return Ic.Tu?2===Yc.nb&&Yc.Jn===Sys.UI.MouseButton.leftButton?!0:!1:!1};Ic.iFb=function(){if(!Ic.Tu)return!1;Ic.Tu.lLd(Ic.oH,!0);Ic.Tu.BLf(Ic.oH,!0);Ic.Tu.xLe(Ic.oH,!0);Ic.Tu.xKb(!0);return!0};Ic.onDoubleClick=function(Yc){if(Yc.Ca)return Yc.Ca.stopPropagation(),!0;fa.ULS.sendTraceTag(537159363,0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill.");
return!0};Ic.Tu=Object(Gc.a)(Nc.a,fc.metadata);Ic.WJ=document.createElement("div");Ic.WJ.id=ib.id+"-"+Ua.a.ixe;Ic.WJ.className=uc.a.EWg;Ic.oH=document.createElement("div");Ic.oH.id=ib.id+"-"+Ua.a.v_c;Ic.oH.className=uc.a.v_c;Ic.WJ.appendChild(Ic.oH);ib.appendChild(Ic.WJ);fa.ULS.sendTraceTag(537159365,0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created.");ra.a.instance.ra(pa.a.iW,Ic.WJ,Ic.$Af);ra.a.instance.ra(pa.a.jy,Ic.WJ,Ic.Fca);
ra.a.instance.ra(pa.a.pointerDown,Ic.WJ,Ic.onPointerDown);Xb.a.instance.ra(pa.a.click,Ic.WJ,Ic.iFb);Xb.a.instance.ra(pa.a.$j,Ic.WJ,Ic.onDoubleClick);return Ic}function A(ib){var fc=this;this.b9e=function(Ic){fc.PBc(Ic.yb,1);return!0};this.c9e=function(Ic){fc.PBc(Ic.yb,-1);return!0};this.tg=function(){fc.Iod=!1};this.ep=function(){fc.Iod=!0};this.gridView=ib;this.u5a=0;this.Iod=this.Xgc=!1;this.I5=Number.NaN;this.gridView.ha.G2(this.ep);this.gridView.ha.qY(this.tg);this.gridView.ha.i_b(this.tg)}function z(ib,
fc){var Ic=B.call(this,ib)||this;Ic.KSi=function(Yc){var Mc=pb.HelperMethods.Fn(Yc),xb=Ic.Jva.l_d(Yc.clientPoint);if(!xb)return!1;var wc=xb.Fe,Ob=Ic.Jva.Ea.Kvb(wc.hashCode).ava(xb.xI);if(!Ob)return!1;Yc=wc.lj.domElement;xb=pb.HelperMethods.fme(pb.HelperMethods.fwb(wc.domElement,Yc),xb.xI);wc=0;Ob=Ic.Jva.Ub(Ob.getRange());for(var nc=0,mb=z.sxe.length;nc<mb;++nc){var ic=z.sxe[nc];if(128!==ic&&64!==ic||!Ic.Jva.$.isEditMode){var qc=Ob.pKa(ic);if(qc&&qc.Q5a&&"none"!==qc.Q5a.style.display){qc=qc.Q5a;var hc=
pb.HelperMethods.fwb(qc,Yc);qc=new Sys.UI.Bounds(hc.x,hc.y,qc.offsetWidth,qc.offsetHeight);if(Ea.a.ZM(qc,xb)){wc=ic;break}}}}return 0!==wc?(Ob.invoke(wc,Mc),!0):!1};Ic.Bqg=fc;Sa.a.instance.ra(pa.a.click,ib,Ic.KSi);return Ic}function y(ib,fc){var Ic=I.call(this,ib)||this;Ic.tg=function(){Ic.domElement.classList.remove(G.selecting);Ub.c(Ic.gridView.$,!0,"FillHandleClickBehavior:OnSelectionEnded")};Ic.ep=function(){Ic.domElement.classList.add(G.selecting)};Ic.onPointerDown=function(Yc){2===Yc.nb&&Yc.Jn===
Sys.UI.MouseButton.leftButton&&(Ic.gridView.ha.selectionType=4,Ic.gridView.ha.sourceRange=Ic.gridView.ha.sa.Vc,Ub.c(Ic.gridView.$,!1,"FillHandleClickBehavior:OnSelectionStarted"));return!1};Ic.Bca=function(){Ic.gridView.$.Cd(1983983164,2,30,null);return!0};Ic.Yc=function(){oa.DOMElementExtensions.setVisible(Ic.Eaa,Ic.gridView.$.isEditMode)};Ic.G6=function(){oa.DOMElementExtensions.setVisible(Ic.Eaa,!1)};Ic.E6=function(){oa.DOMElementExtensions.setVisible(Ic.Eaa,!0)};Ic.nyf=function(){oa.DOMElementExtensions.setVisible(Ic.Eaa,
!1)};Ic.myf=function(){oa.DOMElementExtensions.setVisible(Ic.Eaa,!0)};Ic.KEb=function(Yc,Mc){oa.DOMElementExtensions.setVisible(Ic.Eaa,!Mc.zke)};Ic.gridView=fc;fc=document.createElement("div");fc.className=ub.a.Pwh;Ic.Eaa=fc;Ic.Yc(null,null);ib.appendChild(fc);ra.a.instance.ra(pa.a.pointerDown,Ic.Eaa,Ic.onPointerDown);Sa.a.instance.ra(pa.a.$j,Ic.Eaa,Ic.Bca);Ic.gridView.ha.G2(Ic.ep);Ic.gridView.ha.qY(Ic.tg);Ic.gridView.$.Uk(Ic.Yc);Ic.gridView.$.ob.q_b(Ic.G6);Ic.gridView.$.ob.p_b(Ic.E6);Ic.gridView.dne(Ic.KEb);
Ic.gridView.$b.Ak(Ic.nyf);Ic.gridView.$b.um(Ic.myf);return Ic}function w(ib,fc,Ic,Yc,Mc){var xb=H.call(this,ib,fc,Ic,Mc)||this;xb.QOa=function(){xb.Kp&&xb.C$(!0);5==xb.Uh&&xb.GA(!0)};xb.CN=function(wc){Ka.a(xb.$).Sd(wc);xb.Kp=!1;xb.qb.fh(xb.Bh);xb.ha.sourceRange=xb.sourceRange.clone();xb.z2i();xb.C$(!0);return!0};xb.AN=function(wc){wc=Ka.a(xb.$).Sd(wc);var Ob=wc.clientPoint;xb.ww=wc;var nc=xb.ha.Ln(Ob,wc.yb,5,void 0,void 0,!0);if(nc){if(!xb.Vpd(nc))return xb.o3h(wc),!0;xb.Xdg(nc,xb.isRow,Ob);if(xb.isRow||
xb.We)xb.gb=xb.W2(nc);xb.ha.sourceRange=xb.gb;xb.qb.Ti(xb.gb,xb.Bh);xb.qb.sn(xb.Bh);xb.qb.fh(xb.ZA());xb.vy()}return!0};xb.gAf=function(wc){wc.Errors&&0<wc.Errors.length?(fa.ULS.sendTraceTag(521410185,0,10,"DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsSuccess: Errors: ["+Yb.a.Cc(wc.Errors)+"]"),xb.gb.left=xb.sourceRange.left,xb.gb.right=xb.sourceRange.right,xb.gb.top=xb.sourceRange.top,xb.gb.bottom=xb.sourceRange.bottom):xb.isRow?xb.sourceRange.top<=xb.gb.top&&xb.sourceRange.bottom>=xb.gb.top-
1?(xb.gb.top=xb.sourceRange.top,xb.gb.bottom=xb.sourceRange.bottom):(xb.sourceRange.top>xb.gb.top||(xb.gb.top-=xb.sourceRange.height),xb.gb.bottom=xb.gb.top+xb.sourceRange.height-1):xb.sourceRange.left<=xb.gb.left&&xb.sourceRange.right>=xb.gb.left-1?(xb.gb.left=xb.sourceRange.left,xb.gb.right=xb.sourceRange.right):(xb.sourceRange.left>xb.gb.left||(xb.gb.left-=xb.sourceRange.width),xb.gb.right=xb.gb.left+xb.sourceRange.width-1);xb.cL();xb.Uh=-1};xb.fAf=function(wc){wc=Hb.a.xf(wc.data);fa.ULS.sendTraceTag(521410184,
0,10,"DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsFail: Errors: ["+Yb.a.Cc(wc)+"]")};xb.tableManager=Yc;xb.ha.i_b(xb.QOa);return xb}function D(ib,fc,Ic,Yc,Mc){var xb=H.call(this,ib,fc,Ic,Mc)||this;xb.Mz=null;xb.xq=!1;xb.wq=!1;xb.mBb=0;xb.tM=null;xb.jO=null;xb.An=0;xb.tia=ka.a.instance.ga(2246);xb.Xsb=ka.a.instance.ga(2247);xb.Nna=ka.a.instance.ga(2248);xb.RLb=ka.a.instance.ga(2249);xb.Ytd=vb.EwaSettings.isChangeGateEnabled("OfficeVSO:6287205_LogDragDropActivity");xb.onKeyDown=function(wc){if(xb.Kh){if(xb.yka(wc)||
wc.Ca.keyCode===dc.a.Iea)return xb.vMa||($a.KeyInputManager.instance.ra(pa.a.Fd,xb.domElement.ownerDocument.body,xb.onKeyUp),xb.vMa=!0),!xb.Xt&&xb.yka(wc)&&(Jb.g(xb.$).ig.wo(D.prb),xb.Xt=!0),xb.Yt||wc.Ca.keyCode!==dc.a.Iea||(Jb.g(xb.$).ig.wo(T.U1a),xb.Yt=!0,2===xb.An?(xb.GA(!1),xb.lE=0,xb.Bh=xb.wq?[11]:[12],xb.xq=xb.wq,xb.eQa(),xb.wI()):3===xb.An?(xb.e3(!1),xb.lE=xb.isRow?1:2,xb.VN(),xb.yy()):1===xb.An&&(xb.C$(!1),xb.VN(),xb.yy())),!0}else if(!xb.Xt&&(wc.Ca.keyCode===dc.a.l8||bb.a.isMac&&wc.Ca.keyCode===
dc.a.Poa))return $a.KeyInputManager.instance.ra(pa.a.Fd,xb.domElement.ownerDocument.body,xb.onKeyUp),Jb.g(xb.$).ig.wo(D.prb),xb.Xt=!0;return!1};xb.onKeyUp=function(wc){if(xb.Kh){if(xb.yka(wc)||wc.Ca.keyCode===dc.a.Iea)return xb.mBb=xb.yka(wc)?0:1,xb.Kp&&Jb.g(xb.$).ig.wo(T.U1a),wc.Ca.keyCode===dc.a.Iea&&(2===xb.An?(xb.e3(!1),xb.lE=0,xb.VN(!0),xb.yy(!0)):3===xb.An?(xb.GA(!1),xb.lE=xb.isRow?1:2,xb.Bh=xb.isRow?[11]:[12],xb.eQa(!0),xb.wI(!0)):1===xb.An&&(xb.GA(!1),xb.Bh=xb.wq?[11]:[12],xb.Mza(!0),xb.wI(!0))),
xb.Goa(xb.mBb),!0}else if(wc.Ca.keyCode===dc.a.l8||bb.a.isMac&&wc.Ca.keyCode===dc.a.Poa)return xb.Goa(),xb.Kp&&Jb.g(xb.$).ig.wo(T.c7c),!0;return!1};xb.CN=function(wc){wc=Ka.a(xb.$).Sd(wc);5===xb.Uh?xb.pBd(wc):(xb.Kp=!1,xb.qb.fh(xb.Bh),!xb.$.iq([xb.gb],!1)||xb.dHd()||xb.aAb()||(xb.ha.sourceRange=xb.sourceRange.clone(),xb.Kh?xb.DFd():xb.Utb(),xb.Vx()?xb.gb.top>xb.sourceRange.top&&(wc=xb.gb.height,xb.gb.top-=wc,xb.gb.bottom-=wc):xb.gb.left>xb.sourceRange.left&&(wc=xb.gb.width,xb.gb.left-=wc,xb.gb.right-=
wc),xb.cL()),xb.Ytd&&xb.Xtd());xb.Kt(xb.AN,xb.CN);xb.tableRange=null;xb.Uh=-1;xb.Kh&&(xb.Mz=null,xb.An=0);return!0};xb.z6=function(){xb.Kp=!1;xb.An=0;xb.qb.fh(xb.Bh);if(!xb.$.iq([xb.gb],!1))return xb.Kt(xb.y6,xb.z6),xb.Uh=-1,!0;if(!(xb.ha.sa.Vc.equals(xb.gb)||xb.ska(xb.gb)||xb.ska(xb.sourceRange)||xb.aAb())){xb.cL();xb.ha.sourceRange=xb.sourceRange.clone();var wc=xb.ha.sourceRange,Ob=xb.ha.sa.Vc,nc={};xb.$.Cd(-694765314,2,30,(nc[Ua.a.Xta]=xb.Xt,nc[Ua.a.H7b]=!0,nc[Ua.a.I7b]=xb.xq,nc[Ua.a.N3]=wc,nc[Ua.a.L3]=
Ob,nc[Ua.a.Vsb]=xb.Yt,nc));xb.Xt||(xb.gb.top>xb.sourceRange.top&&(xb.isRow||xb.gb.left===xb.sourceRange.left&&xb.xq)?(wc=xb.gb.height,xb.gb.top-=wc,xb.gb.bottom-=wc):xb.gb.left>xb.sourceRange.left&&(xb.We||xb.gb.top===xb.sourceRange.top&&!xb.xq)&&(wc=xb.gb.width,xb.gb.left-=wc,xb.gb.right-=wc),xb.cL())}xb.Kt(xb.y6,xb.z6);xb.tableRange=null;xb.Mz=null;xb.Uh=-1;xb.xq=!1;xb.Ytd&&xb.Xtd();return!0};xb.AN=function(wc){var Ob=vb.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");
Ob&&(wc=Ka.a(xb.$).Sd(wc));var nc=wc.clientPoint;Ob||(wc=Ka.a(xb.$).Sd(wc));xb.Kh&&(xb.ww=wc);if(wc=xb.ha.Ln(nc,wc.yb,5,void 0,void 0,!0)){if(xb.tableRange.contains(wc.topLeft)){if(xb.Xdg(wc,xb.Vx(),nc),xb.gb=xb.W2(wc),xb.ha.sourceRange=xb.gb,xb.qb.Ti(xb.gb,xb.Bh),xb.qb.sn(xb.Bh),xb.qb.fh(xb.ZA()),6!==xb.Uh){for(nc=1;4>=nc;nc++)wc=xb.Gh[nc.toString()],wc.parentNode.removeChild(wc),xb.qb.ew(xb.Vx()?11:12,nc).mf.appendChild(wc);xb.Uh=6}}else if(xb.gb=xb.Hha(wc),xb.Kh)xb.Twb(!1);else if(xb.qb.Ti(xb.gb,
xb.ZA()),xb.qb.sn(xb.ZA()),xb.qb.fh(xb.Bh),5!==xb.Uh){for(nc=1;4>=nc;nc++)wc=xb.Gh[nc.toString()],wc.parentNode.removeChild(wc),xb.qb.ew(xb.Vaa(),nc).mf.appendChild(wc);xb.Uh=5}xb.vy()}return!0};xb.y6=function(wc){var Ob=vb.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Ob&&(wc=Ka.a(xb.$).Sd(wc));var nc=wc.clientPoint;Ob||(wc=Ka.a(xb.$).Sd(wc));xb.ww=wc;if(Ob=xb.ha.Ln(nc,wc.yb,5,void 0,void 0,!0)){if(xb.ixb(Ob))return xb.gb=xb.Hha(Ob),xb.Swb(!1),!0;var mb=Jb.g(xb.$),
ic=mb.gg(Ob),qc=mb.Gf(xb.paneType);nc=Wa.a.ns(qc.view.Hh,xb.domElement.parentNode,nc,mb.rtl);qc=!1;var hc=2;xb.xq=!1;if(xb.isRow||xb.We){xb.isRow&&nc.y-ic.topLeft.y>ic.height/2?(qc=!0,hc=1):xb.We&&nc.x-ic.topLeft.x>ic.width/2&&(qc=!0);if(qc){wc=mb.Xj("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",mb.YG,hc);try{wc.Xr(Ob),wc.$$mn(),Ob=wc.$$cu().range}finally{wc&&wc.dispose()}}xb.gb=xb.Hha(Ob)}else{nc.x-ic.topLeft.x===ic.width?(xb.xq=!1,qc=!0):nc.y-ic.topLeft.y>ic.height/2&&(qc=
!0,xb.xq=!0,hc=1);xb.Mz&&(xb.xq=xb.wq);if(qc){mb=mb.Xj("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",mb.YG,hc);try{mb.Xr(Ob),mb.$$mn(),Ob=mb.$$cu().range}finally{mb&&mb.dispose()}}xb.qb.fh(xb.Bh);xb.Bh=xb.xq?[11]:[12];for(mb=1;4>=mb;mb++)(ic=xb.Gh[mb.toString()])&&ic.parentNode.removeChild(ic),xb.Gh[mb.toString()]=null;xb.Jz(wc.clientPoint,wc.yb,xb.xq?11:12,!0);xb.gb=xb.W2(Ob)}xb.ha.sourceRange=xb.gb;xb.qb.Ti(xb.gb,xb.Bh);xb.qb.sn(xb.Bh);xb.qb.fh(xb.ZA());if(6!==xb.Uh){for(wc=
1;4>=wc;wc++)Ob=xb.Gh[wc.toString()],Ob.parentNode.removeChild(Ob),xb.qb.ew(xb.isRow||xb.xq?11:12,wc).mf.appendChild(Ob);xb.Uh=6}xb.vy()}return!0};xb.QOa=function(){xb.Kh?xb.Kp&&5<=xb.Uh&&(xb.tableRange?xb.Yt?xb.GA(!0):xb.C$(!0):xb.Yt?xb.isRow||xb.We?xb.GA(!0):xb.e3(!0):xb.isRow||xb.We?xb.e3(!0):xb.GA(!0)):xb.Kp&&5<=xb.Uh&&(xb.tableRange?(xb.qb.fh(xb.Bh),xb.Kt(xb.AN,xb.CN)):(xb.qb.fh(xb.ZA()),xb.Kt(xb.xh,xb.Ff)))};xb.tableManager=Yc;xb.tableRange=null;xb.Yt=!1;xb.Xt=!1;xb.vMa=!1;xb.ha.i_b(xb.QOa);
return xb}function H(ib,fc,Ic,Yc){var Mc=T.call(this,ib,fc,Ic,Yc)||this;Mc.Bh=null;Mc.isRow=!1;Mc.We=!1;Mc.tg=function(){Mc.domElement.classList.remove(G.selecting)};Mc.ep=function(){Mc.domElement.classList.add(G.selecting)};Mc.Rc=function(){if(Mc.$.isEditMode){var xb=Mc.Bxc();Mc.iwc(xb)}};Mc.Gh={};Mc.Kp=!1;Mc.ha.G2(Mc.ep);Mc.ha.qY(Mc.tg);Mc.ha.WD(Mc.Rc);return Mc}function F(ib,fc,Ic,Yc,Mc){var xb=T.call(this,ib,fc,Ic,Mc)||this;xb.tia=ka.a.instance.ga(2246);xb.Xsb=ka.a.instance.ga(2247);xb.Nna=ka.a.instance.ga(2248);
xb.RLb=ka.a.instance.ga(2249);xb.Bh=null;xb.Mz=null;xb.xq=!1;xb.isRow=!1;xb.We=!1;xb.wq=!1;xb.tM=null;xb.jO=null;xb.mBb=0;xb.An=0;xb.onKeyDown=function(wc){if(xb.Kh){if(xb.yka(wc)||wc.Ca.keyCode===dc.a.Iea)return xb.vMa||($a.KeyInputManager.instance.ra(pa.a.Fd,xb.domElement.ownerDocument.body,xb.onKeyUp),xb.vMa=!0),!xb.Xt&&xb.yka(wc)&&(Jb.g(xb.$).ig.wo(F.prb),xb.Xt=!0),xb.Yt||wc.Ca.keyCode!==dc.a.Iea||(Jb.g(xb.$).ig.wo(T.U1a),xb.Yt=!0,2===xb.An?(xb.GA(!1),xb.lE=0,xb.Bh=xb.wq?[11]:[12],xb.xq=xb.wq,
xb.eQa(),xb.wI()):3===xb.An?(xb.e3(!1),xb.lE=xb.isRow?1:2,xb.VN(),xb.yy()):1===xb.An&&(xb.C$(!1),xb.VN(),xb.yy())),!0}else if(!xb.Xt&&(wc.Ca.keyCode===dc.a.l8||bb.a.isMac&&wc.Ca.keyCode===dc.a.Poa))return $a.KeyInputManager.instance.ra(pa.a.Fd,xb.domElement.ownerDocument.body,xb.onKeyUp),Jb.g(xb.$).ig.wo(F.prb),xb.Xt=!0;return!1};xb.onKeyUp=function(wc){if(xb.Kh){if(xb.yka(wc)||wc.Ca.keyCode===dc.a.Iea)return xb.mBb=xb.yka(wc)?0:1,xb.Kp&&Jb.g(xb.$).ig.wo(T.U1a),wc.Ca.keyCode===dc.a.Iea&&(2===xb.An?
(xb.e3(!1),xb.lE=0,xb.VN(!0),xb.yy(!0)):3===xb.An?(xb.GA(!1),xb.lE=xb.isRow?1:2,xb.Bh=xb.isRow?[11]:[12],xb.eQa(!0),xb.wI(!0)):1===xb.An&&(xb.GA(!1),xb.Bh=xb.wq?[11]:[12],xb.Mza(!0),xb.wI(!0))),xb.Goa(xb.mBb),!0}else if(wc.Ca.keyCode===dc.a.l8||bb.a.isMac&&wc.Ca.keyCode===dc.a.Poa)return xb.Goa(),xb.Kp&&Jb.g(xb.$).ig.wo(T.c7c),!0;return!1};xb.CN=function(wc){wc=Ka.a(xb.$).Sd(wc);5===xb.Uh?xb.pBd(wc):(xb.Kp=!1,xb.qb.fh(xb.Bh),!xb.$.iq([xb.gb],!1)||xb.dHd()||xb.aAb()||(xb.ha.sourceRange=xb.sourceRange.clone(),
xb.Kh?xb.DFd():xb.Utb(),xb.Vx()?xb.gb.top>xb.sourceRange.top&&(wc=xb.gb.height,xb.gb.top-=wc,xb.gb.bottom-=wc):xb.gb.left>xb.sourceRange.left&&(wc=xb.gb.width,xb.gb.left-=wc,xb.gb.right-=wc),xb.cL()));xb.Kt(xb.AN,xb.CN);xb.tableRange=null;xb.Uh=-1;xb.Kh&&(xb.Mz=null,xb.An=0);return!0};xb.z6=function(){xb.Kp=!1;xb.An=0;xb.qb.fh(xb.Bh);if(!xb.$.iq([xb.gb],!1))return xb.Kt(xb.y6,xb.z6),xb.Uh=-1,!0;if(!(xb.ha.sa.Vc.equals(xb.gb)||xb.ska(xb.gb)||xb.ska(xb.sourceRange)||xb.aAb())){xb.cL();xb.ha.sourceRange=
xb.sourceRange.clone();var wc=xb.ha.sourceRange,Ob=xb.ha.sa.Vc,nc={};xb.$.Cd(-694765314,2,30,(nc[Ua.a.Xta]=xb.Xt,nc[Ua.a.H7b]=!0,nc[Ua.a.I7b]=xb.xq,nc[Ua.a.N3]=wc,nc[Ua.a.L3]=Ob,nc[Ua.a.Vsb]=xb.Yt,nc));xb.Xt||(xb.gb.top>xb.sourceRange.top&&(xb.isRow||xb.gb.left===xb.sourceRange.left&&xb.xq)?(wc=xb.gb.height,xb.gb.top-=wc,xb.gb.bottom-=wc):xb.gb.left>xb.sourceRange.left&&(xb.We||xb.gb.top===xb.sourceRange.top&&!xb.xq)&&(wc=xb.gb.width,xb.gb.left-=wc,xb.gb.right-=wc),xb.cL())}xb.Kt(xb.y6,xb.z6);xb.tableRange=
null;xb.Mz=null;xb.Uh=-1;xb.xq=!1;return!0};xb.AN=function(wc){var Ob=vb.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Ob&&(wc=Ka.a(xb.$).Sd(wc));var nc=wc.clientPoint;Ob||(wc=Ka.a(xb.$).Sd(wc));xb.Kh&&(xb.ww=wc);if(wc=xb.ha.Ln(nc,wc.yb,5,void 0,void 0,!0)){if(xb.tableRange.contains(wc.topLeft)){Ob=Jb.g(xb.$);var mb=Ob.gg(wc),ic=Ob.Gf(xb.paneType);nc=Wa.a.ns(ic.view.Hh,xb.domElement.parentNode,nc,Ob.rtl);ic=!1;var qc=2;xb.Vx()&&nc.y-mb.topLeft.y>mb.height/2?(ic=
!0,qc=1):!xb.Vx()&&nc.x-mb.topLeft.x>mb.width/2&&(ic=!0);if(ic){Ob=Ob.Xj("DragSelectionClickBehavior.OnPointerMoveRearrange",Ob.YG,qc);try{Ob.Xr(wc),Ob.$$mn(),wc=Ob.$$cu().range}finally{Ob&&Ob.dispose()}}xb.gb=xb.W2(wc);xb.ha.sourceRange=xb.gb;xb.qb.Ti(xb.gb,xb.Bh);xb.qb.sn(xb.Bh);xb.qb.fh(xb.ZA());if(6!==xb.Uh){for(wc=1;4>=wc;wc++)Ob=xb.Gh[wc.toString()],Ob.parentNode.removeChild(Ob),xb.qb.ew(xb.Vx()?11:12,wc).mf.appendChild(Ob);xb.Uh=6}}else if(xb.gb=xb.Hha(wc),xb.Kh)xb.Twb(!1);else if(xb.qb.Ti(xb.gb,
xb.ZA()),xb.qb.sn(xb.ZA()),xb.qb.fh(xb.Bh),5!==xb.Uh){for(wc=1;4>=wc;wc++)Ob=xb.Gh[wc.toString()],Ob.parentNode.removeChild(Ob),xb.qb.ew(xb.Vaa(),wc).mf.appendChild(Ob);xb.Uh=5}xb.vy()}return!0};xb.y6=function(wc){var Ob=vb.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Ob&&(wc=Ka.a(xb.$).Sd(wc));var nc=wc.clientPoint;Ob||(wc=Ka.a(xb.$).Sd(wc));xb.ww=wc;if(Ob=xb.ha.Ln(nc,wc.yb,5,void 0,void 0,!0)){if(xb.ixb(Ob))return xb.gb=xb.Hha(Ob),xb.Swb(!1),!0;var mb=Jb.g(xb.$),
ic=mb.gg(Ob),qc=mb.Gf(xb.paneType);nc=Wa.a.ns(qc.view.Hh,xb.domElement.parentNode,nc,mb.rtl);qc=!1;var hc=2;xb.xq=!1;if(xb.isRow||xb.We){xb.isRow&&nc.y-ic.topLeft.y>ic.height/2?(qc=!0,hc=1):xb.We&&nc.x-ic.topLeft.x>ic.width/2&&(qc=!0);if(qc){wc=mb.Xj("DragSelectionClickBehavior.OnPointerMoveDragInsert",mb.YG,hc);try{wc.Xr(Ob),wc.$$mn(),Ob=wc.$$cu().range}finally{wc&&wc.dispose()}}xb.gb=xb.Hha(Ob)}else{nc.x-ic.topLeft.x===ic.width?(xb.xq=!1,qc=!0):nc.y-ic.topLeft.y>ic.height/2&&(qc=!0,xb.xq=!0,hc=
1);xb.Mz&&(xb.xq=xb.wq);if(qc){mb=mb.Xj("DragSelectionClickBehavior.OnPointerMoveDragInsert",mb.YG,hc);try{mb.Xr(Ob),mb.$$mn(),Ob=mb.$$cu().range}finally{mb&&mb.dispose()}}xb.qb.fh(xb.Bh);xb.Bh=xb.xq?[11]:[12];for(mb=1;4>=mb;mb++)(ic=xb.Gh[mb.toString()])&&ic.parentNode.removeChild(ic),xb.Gh[mb.toString()]=null;xb.Jz(wc.clientPoint,wc.yb,xb.xq?11:12,!0);xb.gb=xb.W2(Ob)}xb.ha.sourceRange=xb.gb;xb.qb.Ti(xb.gb,xb.Bh);xb.qb.sn(xb.Bh);xb.qb.fh(xb.ZA());if(6!==xb.Uh){for(wc=1;4>=wc;wc++)Ob=xb.Gh[wc.toString()],
Ob.parentNode.removeChild(Ob),xb.qb.ew(xb.isRow||xb.xq?11:12,wc).mf.appendChild(Ob);xb.Uh=6}xb.vy()}return!0};xb.tg=function(){xb.domElement.classList.remove(G.selecting)};xb.ep=function(){xb.domElement.classList.add(G.selecting)};xb.Rc=function(){if(xb.$.isEditMode){var wc=xb.Bxc();xb.iwc(wc)}};xb.QOa=function(){xb.Kh?xb.Kp&&5<=xb.Uh&&(xb.tableRange?xb.Yt?xb.GA(!0):xb.C$(!0):xb.Yt?xb.isRow||xb.We?xb.GA(!0):xb.e3(!0):xb.isRow||xb.We?xb.e3(!0):xb.GA(!0)):xb.Kp&&5<=xb.Uh&&(xb.tableRange?(xb.qb.fh(xb.Bh),
xb.Kt(xb.AN,xb.CN)):(xb.qb.fh(xb.ZA()),xb.Kt(xb.xh,xb.Ff)))};xb.tableManager=Yc;xb.tableRange=null;xb.Gh={};xb.Kp=!1;xb.Xt=!1;xb.Yt=!1;xb.vMa=!1;xb.ha.G2(xb.ep);xb.ha.qY(xb.tg);xb.ha.i_b(xb.QOa);xb.ha.WD(xb.Rc);return xb}function J(ib,fc){this.destinationRange=this.sourceRange=null;this.sourceRange=ib;this.destinationRange=fc}function S(ib,fc,Ic,Yc,Mc,xb,wc,Ob){Ob=ib.Na(41,void 0===Ob?null:Ob);Ob.sourceRange=fc;Ob.destinationRange=Ic;return lb.g(ib,"RearrangeRowColumn",Ob,Yc,Mc,xb,wc,0)}function N(ib,
fc,Ic,Yc,Mc,xb){var wc=T.call(this,ib,fc,Ic,Mc)||this;wc.XK=null;wc.Ya=null;wc.O5e=function(){wc.Ztb(!0)};wc.gridView=Jb.g(wc.$);wc.jF=Yc;wc.coloredReferencesManager=wc.$.da.za(281);fa.ULS.shipAssertTag(537159391,0,!!wc.coloredReferencesManager,"DragMarqueeClickBehavior Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");ib=ik(wc.Ir);for(fc=ib.next();!fc.done;fc=ib.next())fc=fc.value,ra.a.instance.ra(pa.a.iW,fc,wc.jF.b9e),ra.a.instance.ra(pa.a.jy,fc,
wc.jF.c9e);wc.ZYa(xb);return wc}function T(ib,fc,Ic,Yc){var Mc=I.call(this,ib)||this;Mc.JSa=!1;Mc.wke=null;Mc.vke=null;Mc.Gra=0;Mc.Kh=vb.EwaSettings.getBooleanFeatureGate(yb.a.G7b,!1);Mc.Yhi=vb.EwaSettings.getBooleanFeatureGate(yb.a.fjh,!1);Mc.lE=0;Mc.tec=0;Mc.ZCc=0;Mc.Cma=null;Mc.sourceRange=null;Mc.gb=null;Mc.ww=null;Mc.Ff=function(xb){xb=Ka.a(Mc.$).Sd(xb);return Mc.pBd(xb)};Mc.onPointerDown=function(xb){xb=Ka.a(Mc.$).Sd(xb);if(2===xb.nb&&xb.Jn===Sys.UI.MouseButton.leftButton&&!Mc.JSa){var wc=Mc.scc(xb);
if(!wc)return fa.ULS.shipAssertTag(537159379,0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;Mc.gb=wc.clone();Mc.sourceRange=Mc.gb.clone();Mc.Cma=Mc.gb;if(wc=Mc.sTh(xb))Mc.Uh=5,Mc.ZCc=wc.top-Mc.sourceRange.top,Mc.tec=wc.left-Mc.sourceRange.left,Jb.g(Mc.$).ig.wo(Mc.Kh?T.U1a:T.c7c),Mc.ooc(xb),Mc.JSa=!0,oc.b(Mc.$,!0)}return!1};Mc.xh=function(xb){xb=Ka.a(Mc.$).Sd(xb);if(Mc.Kh&&Mc.qoc(xb))return!0;if(xb=Mc.ha.Ln(xb.clientPoint,xb.yb,5,void 0,void 0,!0)){xb=Mc.Hha(xb);if(Mc.gb.equals(xb))return!0;
Mc.gb=xb;if(!Mc.yy())return fa.ULS.shipAssertTag(537159378,0,!1,"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),Mc.Ztb(!0),!1}return!0};Mc.Yc=function(xb,wc){wc.bN||Mc.iwc(Mc.$.isEditMode)};Mc.Ir=[];Mc.$=fc;Mc.ha=Jb.g(Mc.$).ha;Mc.paneType=Ic;Mc.Wn=Yc;fc=vb.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");fc=ik(Mc.Yhi?fc?[G.Kwh,G.xwh,G.Cwh,G.Gwh]:[G.Mwh,G.zwh,G.Ewh,G.Iwh]:fc?[G.Jwh,G.wwh,G.Bwh,G.Fwh]:[G.Lwh,G.ywh,G.Dwh,G.Hwh]);for(Ic=fc.next();!Ic.done;Ic=
fc.next())Ic=Mc.Wn.zDe(ib,Ic.value,Mc.Kh?[G.Awh]:[G.vwh],Mc.onPointerDown),Mc.Ir.push(Ic);Mc.$.Uk(Mc.Yc);Mc.iwc(Mc.$.isEditMode);return Mc}function G(){}function I(ib){var fc=B.call(this,ib)||this;var Ic=document.createElement("div");Ic.className=ub.a.Qwh;ib.appendChild(Ic);return fc}function K(ib,fc,Ic,Yc){return L.call(this,ib,fc,Ic,Yc)||this}function L(ib,fc,Ic,Yc){var Mc=B.call(this,fc)||this;Mc.tob=!1;Mc.RWc=!1;Mc.nrd=!1;Mc.Qpb=null;Mc.jrd=!1;Mc.Hba=!1;Mc.tw=function(){Mc.tob&&Mc.jrd?Mc.Tna():
Mc.H4()};Mc.syf=function(wc){3===wc.nb&&(Mc.jrd=!0,Mc.Tna());return!1};Mc.tyf=function(wc){if(3===wc.nb){if(!wc.yb||Mc.Bii(wc))return!1;Mc.jrd=!1;Mc.H4()}return!1};Mc.tg=function(){Mc.Hba&&Mc.fYd();Mc.Tna();Mc.nrd=!1};Mc.ep=function(){Mc.H4();Mc.nrd=!0};Mc.Mya=function(wc,Ob){Ob.K4===Mc.K4&&(Ob.visible?Mc.nrd||Mc.Tna():Mc.H4())};Mc.iEf=function(){Mc.uyf(Mc.DO.domElement,!1)};Mc.Puf=function(){Mc.uyf(Mc.dM.domElement,!0)};Mc.Dnc=function(wc,Ob){Mc.ha.Aza(Ob)};Mc.Enc=function(wc,Ob){Mc.ha.Aza(La.b(Ob))};
Mc.dFb=function(){3===Ra.a.Cb?Mc.Tna():Mc.H4();Mc.Hba&&1===Ra.a.Cb&&Mc.fYd()};Mc.jEf=function(){Mc.$pj()};Mc.dKe=function(){Mc.H4()};Mc.ap=function(){Mc.ha.Oa.Yb&&Mc.H4()};Mc.Duf=function(){Mc.H4()};Mc.lyf=function(wc,Ob){Mc.fYd();3===Ob.nb?Mc.Tna():Mc.H4()};Mc.wrc=function(){Mc.tob&&(Mc.H4(),Mc.Tna())};var xb=Ic.$;Mc.qp=Ic;Mc.ha=Ic.ha;Mc.oba=ib;Mc.ynj=fc;Mc.paneType=Yc;ib=Mc.domElement.currentStyle;fc="#000000";ib&&(fc=ib.borderTopColor);Mc.DO=new O(Mc.Aad(),fc,xb);Mc.dM=new O(Mc.Aad(),fc,xb);Mc.wff=
xb.ea.isNamedObjectViewMode&&1===xb.workbookContext.NovMode;Mc.DO.Cne(Mc.iEf);Mc.DO.Bne(Mc.Dnc);Mc.DO.Dne(Mc.Enc);Mc.dM.Cne(Mc.Puf);Mc.dM.Bne(Mc.Dnc);Mc.dM.Dne(Mc.Enc);ib=ik(Mc.gridView.hn);for(fc=ib.next();!fc.done;fc=ib.next())fc=fc.value,Za.a.instance.ra(pa.a.sf,fc.domElement,Mc.tyf),Za.a.instance.ra(pa.a.oe,fc.domElement,Mc.syf);Ic.view.Is(Mc.tw);Ic.Wb.Ak(Mc.dKe);Ic.qb.Mnb(Mc.Mya);Ic.WUc(Mc.Duf);xb.rA(Mc.wrc);Ic.Au(Mc.wrc);Mc.ha.qY(Mc.tg);Mc.ha.G2(Mc.ep);Ic.UD(Mc.ap);Mc.ha.IZb(Mc.lyf);Ra.a.Mne(Mc.dFb);
va.TaskExtensions.Aa(ya.GetServiceTaskFactory.Ra(xb.da,376,377,0),function(wc){wc.result.wIg(Mc.jEf)},xb.la,3);return Mc}function O(ib,fc,Ic){var Yc=eb.call(this,document.createElement("div"))||this;Yc.M5b=null;Yc.GPb=!1;Yc.onPointerDown=function(Mc){Mc=Ka.a(Yc.$)?Ka.a(Yc.$).Sd(Mc):Mc;Yc.GPb=!1;if(3===(Ra.a.Cb=Mc.nb)){var xb=Mc.Ca.rawEvent,wc=xb.srcElement||xb.target;oa.DOMElementExtensions.nf(Yc.domElement,wc)&&oa.DOMElementExtensions.nf(xb.currentTarget,wc)&&(Yc.GPb=!0,Yc.M5b=Mc.clientPoint)}return!1};
Yc.Ff=function(Mc){Mc=Ka.a(Yc.$)?Ka.a(Yc.$).Sd(Mc):Mc;Yc.raiseEvent("GrPointerUp",Mc);return Yc.GPb=!1};Yc.xh=function(Mc){Mc=Ka.a(Yc.$)?Ka.a(Yc.$).Sd(Mc):Mc;3===Mc.nb&&Yc.GPb&&Yc.q6h(Mc.clientPoint)&&(Yc.raiseEvent("GrDrag"),Yc.GPb=!1);return!1};Yc.Zc=function(Mc){Ka.a(Yc.$)&&Ka.a(Yc.$).Sd(Mc);return!0};Yc.$=Ic;Ic=!vb.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");Yc.domElement.classList.add(Ic?ub.a.FQe:ub.a.EQe);Yc.domElement.classList.add(ub.a.g9b);ib.appendChild(Yc.domElement);
oa.DOMElementExtensions.setVisible(Yc.domElement,!1);Yc.SKa=document.createElement("div");Yc.SKa.classList.add(ub.a.f9b);Yc.SKa.style.borderColor=fc;Yc.domElement.appendChild(Yc.SKa);ra.a.instance.ra(pa.a.pointerDown,Yc.domElement,Yc.onPointerDown);ra.a.instance.ra(pa.a.Hf,Yc.domElement,Yc.Ff);Za.a.instance.ra(pa.a.oe,Yc.domElement,Yc.Ff);ra.a.instance.ra(pa.a.sj,Yc.domElement,Yc.xh);Za.a.instance.ra(pa.a.Vf,Yc.domElement,Yc.xh);Sa.a.instance.ra(pa.a.click,Yc.domElement,Yc.Zc);return Yc}function B(ib,
fc){return Aa.call(this,ib,void 0===fc?null:fc)||this}function Q(ib){var fc=aa.call(this)||this;fc.ppf=[3];fc.gridView=ib;fc.MXd=ta.a.c5(fc.gridView.$);return fc}function U(ib,fc){var Ic=ja.call(this)||this;Ic.start=ib;Ic.oyb=fc;return Ic}function X(ib){var fc=ha.call(this)||this;fc.$=ib;fc.Eb();return fc}function P(ib){var fc=Z.call(this)||this;ib.da.Ga(376,fc);return fc}var ea=b(10),ia=b(0),da=b(235),xa=b(38),Z=xa.a;$k(P,Z);P.prototype.wIg=function(ib){this.addHandler("TAF",ib)};P.prototype.xej=
function(ib){this.removeHandler("TAF",ib)};P.prototype.H4i=function(){this.raiseEvent("TAF")};Object(ia.a)(P,"GridHighlightBehaviorEventManager",xa.a,[610,6]);var ha=da.a;$k(X,ha);X.prototype.create=function(){this.pb(this.$.da.za(376)||new P(this.$))};X.ka=function(ib){ib.da.Ga(377,new X(ib))};Object(ia.a)(X,"GridHighlightBehaviorEventManagerFactory",da.a,[]);var ya=b(50),va=b(37),bb=b(27),ba=b(79),fa=b(15),ra=b(249),pa=b(13),Za=b(161),Ua=b(5),Ma=b(114),oa=b(12),ja=Sys.EventArgs;$k(U,ja);Object(ia.a)(U,
"MarqueeResizeStartedOrEndedEventArgs",Sys.EventArgs,[]);var ta=b(36),aa=xa.a;$k(Q,aa);Q.prototype.WGg=function(ib){this.addHandler("mrek",ib)};Q.prototype.Dw=function(ib,fc,Ic){for(var Yc=ik(this.gridView.hn),Mc=Yc.next();!Mc.done;Mc=Yc.next())ra.a.instance.ra(pa.a.sj,Mc.value.domElement,ib);ra.a.instance.ra(pa.a.Hf,document.documentElement,fc);this.gridView.$b.e8b(!0);Ic&&ra.a.instance.ra(pa.a.jy,this.gridView.Aj,fc)};Q.prototype.bYd=function(ib,fc,Ic){for(var Yc=ik(this.gridView.hn),Mc=Yc.next();!Mc.done;Mc=
Yc.next())ra.a.instance.Ba(pa.a.sj,Mc.value.domElement,ib);ra.a.instance.Ba(pa.a.Hf,document.documentElement,fc);this.gridView.$b.e8b(!1);Ic&&ra.a.instance.Ba(pa.a.jy,this.gridView.Aj,fc)};Q.prototype.J9i=function(ib,fc){for(var Ic=ik(this.gridView.hn),Yc=Ic.next();!Yc.done;Yc=Ic.next())Za.a.instance.ra(pa.a.Vf,Yc.value.domElement,ib);Za.a.instance.ra(pa.a.oe,document.documentElement,fc)};Q.prototype.OQj=function(ib,fc){for(var Ic=ik(this.gridView.hn),Yc=Ic.next();!Yc.done;Yc=Ic.next())Za.a.instance.Ba(pa.a.Vf,
Yc.value.domElement,ib);Za.a.instance.Ba(pa.a.oe,document.documentElement,fc)};Q.prototype.zDe=function(ib,fc,Ic,Yc){var Mc=document.createElement("div");Mc.className=fc;fc=ik(Ic);for(Ic=fc.next();!Ic.done;Ic=fc.next())Mc.classList.add(Ic.value);ib.appendChild(Mc);ra.a.instance.ra(pa.a.pointerDown,Mc,Yc);return Mc};Q.prototype.h2e=function(ib){ib=ib.yb.parentNode;if(!ib)return fa.ULS.shipAssertTag(537159394,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),
null;ib=parseInt(ib.getAttribute(Ua.a.oyb),10);return isNaN(ib)?(fa.ULS.shipAssertTag(537159393,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),null):this.gridView.qb.ew(3,1,ib)};Q.prototype.vLb=function(ib,fc,Ic){ib=(void 0===Ic?!0:Ic)&&!!this.coloredReferencesManager&&this.coloredReferencesManager.Jki(ib);fc=ik(fc);for(Ic=fc.next();!Ic.done;Ic=fc.next())oa.DOMElementExtensions.setVisible(Ic.value,ib)};Q.prototype.Fcd=function(){return this.gridView.pj?
Ma.a(this.gridView.$):this.gridView.Wb};Q.prototype.aNf=function(){var ib=this.Fcd();ib&&this.coloredReferencesManager?this.MXd?ib.ZF(null):this.coloredReferencesManager.ZF(ib,null):(fa.ULS.sendTraceTag(537159392,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.qb.fh(this.ppf),this.gridView.qb.Ti(null,this.ppf))};Q.prototype.jLf=function(ib,fc){this.raiseEvent("mrek",new U(ib,fc))};of.Object.defineProperties(Q.prototype,
{coloredReferencesManager:{configurable:!0,enumerable:!0,get:function(){var ib=this.gridView.$.da.za(281);ib||fa.ULS.sendTraceTag(537159395,0,50,"BehaviorHelperMethods.ColoredReferencesManager: coloredReferencesManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");return ib}}});Object(ia.a)(Q,"BehaviorHelperMethods",xa.a,[]);var ma=b(87),Ea=b(39),Ha=b(94),Aa=Ha.a;$k(B,Aa);B.prototype.ZYa=function(){};Object(ia.a)(B,
"HighlightFlyweightBehavior",Ha.a,[]);var V=b(19),La=b(502),Ra=b(76),pb=b(11),cb=b(117),Sa=b(236),Db=b(44),Ab=b(248),Wb=b(9),ub=b(71),vb=b(1),Ka=b(33),eb=Ab.a;$k(O,eb);O.prototype.Cne=function(ib){this.addHandler("GrDrag",ib)};O.prototype.LQf=function(ib){this.removeHandler("GrDrag",ib)};O.prototype.Bne=function(ib){this.addHandler("GrContxt",ib)};O.prototype.KQf=function(ib){this.removeHandler("GrContxt",ib)};O.prototype.Dne=function(ib){this.addHandler("GrPointerUp",ib)};O.prototype.MQf=function(ib){this.removeHandler("GrPointerUp",
ib)};O.prototype.dispose=function(){Db.a.Oma(this.domElement);eb.prototype.dispose.call(this)};O.prototype.deg=function(ib){this.domElement.parentNode.removeChild(this.domElement);ib.appendChild(this.domElement)};O.prototype.QYf=function(){this.domElement.classList.remove(ub.a.g9b);this.SKa.classList.remove(ub.a.f9b);this.SKa.classList.add(ub.a.GQe)};O.prototype.vcg=function(){this.SKa.classList.remove(ub.a.GQe);this.SKa.classList.add(ub.a.f9b);this.domElement.classList.add(ub.a.g9b)};O.prototype.q6h=
function(ib){return!!this.M5b&&(3<Math.abs(ib.x-this.M5b.x)||3<Math.abs(ib.y-this.M5b.y))};O.mvb=function(ib){return vb.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?(ib=Ka.a(ib.$)?Ka.a(ib.$).zoom:Wb.a.Q_,Math.round(9/Math.max(ib,1))):9};O.Ovd=0;Object(ia.a)(O,"TouchGrippie",Ab.a,[]);$k(L,B);L.prototype.dispose=function(){ma.a.oc([this.DO,this.dM]);this.DO.LQf(this.iEf);this.DO.KQf(this.Dnc);this.DO.MQf(this.Enc);this.dM.LQf(this.Puf);this.dM.KQf(this.Dnc);this.dM.MQf(this.Enc);
for(var ib=ik(this.gridView.hn),fc=ib.next();!fc.done;fc=ib.next())fc=fc.value,Za.a.instance.Ba(pa.a.sf,fc.domElement,this.tyf),Za.a.instance.Ba(pa.a.oe,fc.domElement,this.syf);this.gridView.view.Gq(this.tw);this.gridView.Wb.vk(this.dKe);this.gridView.qb.WIb(this.Mya);this.gridView.dJd(this.Duf);this.gridView.$.iD(this.wrc);this.gridView.ny(this.wrc);this.ha.zW(this.tg);this.ha.f7(this.ep);this.gridView.yF(this.ap);this.ha.Nsc(this.lyf);Ra.a.UQf(this.dFb);this.Hba&&fa.ULS.sendTraceTag(537159314,0,
15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");(ib=this.gridView.$.da.za(376))&&ib.xej(this.jEf);B.prototype.dispose.call(this)};L.prototype.dSa=function(){if(!this.oba.range||!this.oba.range.equals(this.xcb))return!1;var ib=!this.gridView.yMa();return this.gridView.isEditing&&ib&&(this.xcb.isRow||this.xcb.We)?!1:this.Hba?!0:3===Ra.a.Cb};L.prototype.H4=function(){this.tob&&(this.DO.set_visible(!1),this.dM.set_visible(!1),this.tob=!1)};L.prototype.Tna=function(){if(this.dSa()){this.mUj();
var ib=oa.DOMElementExtensions.getBoundingClientRect(this.Qpb);ib||fa.ULS.shipAssertTag(537159313,0,!1,"grippiesParentBounds is null. IsNamedObjectViewMode: {0}, isNov15: {1}, areGrippiesAttachedToNovFocusPane: {2}GridView.ContainerElement: {3}, Freezepanes: {4}",this.gridView.$.ea.isNamedObjectViewMode,this.wff,this.RWc,this.gridView.Aj,this.gridView.eb.Ji);var fc=oa.DOMElementExtensions.getBoundingClientRect(this.ynj),Ic=new Sys.UI.Bounds(fc.x-ib.x,fc.y-ib.y,fc.width,fc.height),Yc=this.xcb,Mc=Yc.topLeft,
xb=Yc.bottomRight,wc=Yc.isRow||Yc.We;if(Yc.We){var Ob=this.MBh();Yc=Ic.x-2*O.mvb(this.gridView);var nc=Ob;var mb=Ic.x+fc.width}else Yc.isRow?(Yc=mb=this.LBh(),nc=Ic.y-2*O.mvb(this.gridView),Ob=Ic.y+fc.height):(nc=Ic.y,Ob=Ic.y+fc.height,this.gridView.rtl?(Yc=Ic.x+fc.width,mb=Ic.x):(Yc=Ic.x,mb=Ic.x+fc.width));fc=O.Ovd+(wc?0:O.mvb(this.gridView));this.DO.style.left=pb.HelperMethods.nc(Yc-fc);this.DO.style.top=pb.HelperMethods.nc(nc-fc);this.dM.style.left=pb.HelperMethods.nc(mb-fc);this.dM.style.top=
pb.HelperMethods.nc(Ob-fc);this.DO.set_visible(this.Udf(nc,Yc,Mc,wc,ib));this.dM.set_visible(this.Udf(Ob,mb,xb,wc,ib));this.tob=!0}};L.prototype.Udf=function(ib,fc,Ic,Yc,Mc){var xb=oa.DOMElementExtensions.getBoundingClientRect(this.gridView.Gf(this.paneType).domElement);Mc=new Sys.UI.Bounds(xb.x-Mc.x-3,xb.y-Mc.y-3,xb.width+6,xb.height+6);return(this.gridView.eb.dj(Ic)===this.paneType||Yc)&&Ea.a.ZM(Mc,new Sys.UI.Point(fc,ib))};L.prototype.mUj=function(){if(this.wff!==this.RWc){this.Qpb=null;var ib=
this.Aad();this.DO.deg(ib);this.dM.deg(ib)}};L.prototype.MBh=function(){return(this.gridView.view.visibleArea.height+this.gridView.eb.height+O.Ovd-O.mvb(this.gridView))/2};L.prototype.LBh=function(){return(this.gridView.view.visibleArea.width+this.gridView.eb.width+O.Ovd-O.mvb(this.gridView))/2};L.prototype.uCf=function(){this.Tna()};L.prototype.Bii=function(ib){return oa.DOMElementExtensions.ncb(ib.yb,V.a.Mo)&&(this.Aji(ib)||this.Bji(ib))};L.prototype.Bji=function(ib){if(this.gridView.rtl)ib=ib.clientPoint.x;
else{var fc=oa.DOMElementExtensions.getBoundingClientRect(ib.yb);ib=ib.clientPoint.x-(fc.x+fc.width-cb.a.hv)}return 0<ib&&ib<=cb.a.hv};L.prototype.Aji=function(ib){var fc=oa.DOMElementExtensions.getBoundingClientRect(ib.yb);ib=ib.clientPoint.y-(fc.y+fc.height-cb.a.hv);return 0<ib&&ib<=cb.a.hv};L.prototype.uyf=function(ib,fc){this.Hba&&fa.ULS.sendTraceTag(537159312,0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.ha.i_c(ib,fc,this.Hba);this.H4()};L.prototype.$pj=function(){this.Hba||
(fa.ULS.sendTraceTag(537159311,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.Hba=!0,this.DO.QYf(),this.dM.QYf(),this.gridView.ha.sourceRange=this.gridView.ha.sa.Vc,this.Tna())};L.prototype.fYd=function(){this.Hba&&(fa.ULS.sendTraceTag(537159310,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),this.Hba=!1,this.DO.vcg(),this.dM.vcg())};L.prototype.Aad=function(){this.Qpb||(this.RWc=!1,this.Qpb=this.gridView.Aj);return this.Qpb};of.Object.defineProperties(L.prototype,{gridView:{configurable:!0,
enumerable:!0,get:function(){return this.qp}}});Object(ia.a)(L,"SelectionTouchGrippiesBehaviorBase",B,[]);$k(K,L);K.prototype.dSa=function(){var ib=this.gridView.vi||this.gridView.isEditing;return!this.gridView.ha.sa.rg&&!ib&&L.prototype.dSa.call(this)};of.Object.defineProperties(K.prototype,{K4:{configurable:!0,enumerable:!0,get:function(){return 19}},xcb:{configurable:!0,enumerable:!0,get:function(){return this.gridView.ha.sa.activeRange}}});Object(ia.a)(K,"DiscontinuousSelectionTouchGrippiesBehavior",
L,[]);var yb=b(189);$k(I,B);Object(ia.a)(I,"SelectionBorderBehavior",B,[]);G.vwh="ewr-selection-draghandle";G.Awh="ewr-selection-draghandle-grab";G.Lwh="ewr-selection-draghandle-top-ie";G.Mwh="ewr-selection-draghandle-top-ie-enhanced";G.Jwh="ewr-selection-draghandle-top";G.Kwh="ewr-selection-draghandle-top-enhanced";G.ywh="ewr-selection-draghandle-bottom-ie";G.zwh="ewr-selection-draghandle-bottom-ie-enhanced";G.wwh="ewr-selection-draghandle-bottom";G.xwh="ewr-selection-draghandle-bottom-enhanced";
G.Dwh="ewr-selection-draghandle-left-ie";G.Ewh="ewr-selection-draghandle-left-ie-enhanced";G.Bwh="ewr-selection-draghandle-left";G.Cwh="ewr-selection-draghandle-left-enhanced";G.Hwh="ewr-selection-draghandle-right-ie";G.Iwh="ewr-selection-draghandle-right-ie-enhanced";G.Fwh="ewr-selection-draghandle-right";G.Gwh="ewr-selection-draghandle-right-enhanced";G.NQe="ewr-selection-dragtooltip";G.OQe="ewr-selection-dragtooltip-updated";G.Xwh="ewr_selection_rearrangeleft";G.Ywh="ewr_selection_rearrangeright";
G.Zwh="ewr_selection_rearrangetop";G.Wwh="ewr_selection_rearrangebottom";G.selecting="selecting";G.$wh="ewr-selection-resizemarqueehandle";G.cxh="ewr-selection-resizemarqueehandle-topleft";G.dxh="ewr-selection-resizemarqueehandle-topright";G.axh="ewr-selection-resizemarqueehandle-bottomleft";G.bxh="ewr-selection-resizemarqueehandle-bottomright";G.lwh="ewr-marquee-thick";G.pwh="ewr-resizemarqueehandle-thick";Object(ia.a)(G,"CssClassNames",null,[]);var oc=b(260),Jb=b(21);$k(T,I);T.prototype.dispose=
function(){var ib=this;this.Ir.forEach(function(fc){ra.a.instance.Ba(pa.a.pointerDown,fc,ib.onPointerDown)});this.Ir.length=0;this.Cma=this.sourceRange=this.gb=null;fa.ULS.sendTraceTag(537159381,0,50,"DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = "+this.Gra+", EwaControl is null : "+!this.$);this.$&&(this.$.sl(this.Yc),1===this.Gra&&(fa.ULS.sendTraceTag(537159380,0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.Kt(this.vke,this.wke,!1)));
I.prototype.dispose.call(this)};T.prototype.pBd=function(ib){if(5!==this.Uh)return!1;(ib=this.Kya(ib))||this.Ztb(!1);oc.b(this.$,!1);return ib};T.prototype.Dw=function(ib,fc){fa.ULS.shipAssertTag(537159377,0,!this.Gra,"DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected");this.Gra+=1;this.vke=ib;this.wke=fc;this.Wn.Dw(ib,fc,this.NAc())};T.prototype.Hha=function(ib){if(!ib||!this.gb)return fa.ULS.shipAssertTag(537159376,0,!!ib,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),
fa.ULS.shipAssertTag(537159375,0,!!this.gb,"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),null;var fc=this.gb.clone();1!==this.lE&&(fc.left=Math.max(ib.left-this.tec,1),fc.right=fc.left+this.sourceRange.width-1);2!==this.lE&&(fc.top=Math.max(ib.top-this.ZCc,1),fc.bottom=fc.top+this.sourceRange.height-1);return this.$Ya(fc)};T.prototype.Kt=function(ib,fc,Ic,Yc){Ic=void 0===Ic?!0:Ic;Yc=void 0===Yc?!0:Yc;fa.ULS.shipAssertTag(537159374,0,1===this.Gra,"DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration");
--this.Gra;this.Kh||Jb.g(this.$).ig.wo(Ua.a.x4);this.Wn.bYd(ib,fc,this.NAc());Ic&&this.rqb(Yc);this.lE=0;this.JSa=!1};T.prototype.$Ya=function(ib){var fc=Jb.g(this.$),Ic=ib;if(fc.eb.C4){if(!fc.Ub(ib.topLeft)){fc=fc.Xj("DragSelectionClickBehaviorBase.AdjustHiddenRowColumns",fc.YG,this.Cma.top!==ib.top?1:2);try{fc.Wk=this.Cma.top<ib.top||this.Cma.left<ib.left,fc.Xr(ib.topLeft),Ic=fc.$$cu().range}finally{fc&&fc.dispose()}}Ic.right=Ic.left+ib.width-1;Ic.bottom=Ic.top+ib.height-1}return this.Cma=Ic};T.prototype.iwc=
function(ib){this.Ir.forEach(function(fc){oa.DOMElementExtensions.setVisible(fc,ib)})};T.prototype.sTh=function(ib){var fc=ib.yb;ib=ib.clientPoint;if(!fc||!ib)return fa.ULS.shipAssertTag(537159373,0,!!fc,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),fa.ULS.shipAssertTag(537159372,0,!!ib,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),null;ib.y+=fc===this.Ir[T.KIa]?2:fc===this.Ir[T.g7c]?-2:0;ib.x+=fc===this.Ir[T.h7c]?2:fc===this.Ir[T.JIa]?-2:0;return this.ha.Ln(ib,
fc,5,void 0,void 0,!0)};of.Object.defineProperties(T.prototype,{qb:{configurable:!0,enumerable:!0,get:function(){return Jb.g(this.$).qb}},Uh:{configurable:!0,enumerable:!0,get:function(){return this.ha.selectionType},set:function(ib){this.ha.selectionType=ib}}});T.c7c="move";T.U1a="grabbing";T.KIa=0;T.g7c=1;T.h7c=2;T.JIa=3;Object(ia.a)(T,"DragSelectionClickBehaviorBase",I,[]);$k(N,T);N.prototype.ZYa=function(ib){this.Wn.vLb(ib,this.Ir);this.jF.aAa()};N.prototype.ooc=function(ib){fa.ULS.sendTraceTag(537159390,
0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");this.gridView.DLa=!0;this.Ya.dE(!1);this.Uh=5;this.jF.HJe(ib.yb);this.Ya.textBox.removeSelection();this.Ya.TZb(this.O5e);this.Dw(this.xh,this.Ff);this.lE=this.sourceRange.isRow?1:this.sourceRange.We?2:0};N.prototype.Kya=function(){var ib=this.cL();this.Uh=-1;this.Kt(this.xh,this.Ff);return ib};N.prototype.rqb=function(){this.gridView.DLa=!1;this.jF.IJe(this.Ir[0]);this.Ya.textBox.setCaretPositionToEnd();this.Ya.Ysc(this.O5e);
this.Wn.aNf()};N.prototype.Ztb=function(ib){fa.ULS.sendTraceTag(537159389,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate colored references as a fallback in CleanUp.");ib&&this.Kt(this.xh,this.Ff)};N.prototype.scc=function(ib){this.Ya=this.Wn.Fcd();this.XK=this.Wn.h2e(ib);return this.Ya&&this.XK&&this.XK.range?this.XK.range:(fa.ULS.shipAssertTag(537159388,0,!!this.Ya,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),fa.ULS.shipAssertTag(537159387,
0,!!this.XK,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),fa.ULS.shipAssertTag(537159386,0,!!this.XK.range,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),null)};N.prototype.cL=function(){return this.XK?this.coloredReferencesManager.brf(this.Ya,this.XK,this.gb):(fa.ULS.shipAssertTag(537159385,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),
!1)};N.prototype.yy=function(){return this.cL()};N.prototype.NAc=function(){return!0};N.prototype.qoc=function(){return!1};Object(ia.a)(N,"DragMarqueeClickBehavior",T,[]);var dc=b(86),$a=b(109),Ba=b(178),la=b(445),ka=b(14),ca=b(237),Ia=b(24),jb=b(984),nb=b(41),Na=b(572),sa=b(177),Wa=b(928),Hb=b(121),Yb=b(31),Sb=b(298),lb=b(62);Object(ia.a)(J,"MacroRecorderTableRowColumnRearrangedPayload",null,[430]);var wb=b(43);$k(F,T);F.prototype.dispose=function(){this.ha&&(this.ha.f7(this.ep),this.ha.zW(this.tg),
this.ha.JJd(this.QOa),this.ha.ZH(this.Rc));if(this.Gh)for(var ib=1;4>=ib;ib++)oa.DOMElementExtensions.gf(this.Gh[ib.toString()]);this.Gh=this.Bh=null;this.Xt&&this.Goa();this.Kh&&this.Yt&&this.Goa(1);T.prototype.dispose.call(this)};F.prototype.ooc=function(ib){this.Kh&&(this.ww=ib,this.Mz=null,this.wq=this.isRow=this.We=this.xq=!1,$a.KeyInputManager.instance.ra(pa.a.Lb,this.domElement.ownerDocument.body,this.onKeyDown));this.Kp=!0;this.tableRange=this.CZc(this.tableManager.Wm(this.sourceRange.topLeft));
Jb.g(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Kh?(this.Mz=this.tableRange,this.An=1,this.Bh=(this.wq=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.Uh=6,this.Dw(this.AN,this.CN),this.tM=this.tia,this.jO=this.Nna,this.Jz(ib.clientPoint,ib.yb,this.wq?11:12,!0,!0),this.wI(!0)):(this.Bh=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.Uh=
6,this.Dw(this.AN,this.CN),this.Jz(ib.clientPoint,ib.yb,this.isRow?11:12,!0)):(this.tableRange=null,this.Kh?(this.isRow=this.sourceRange.isRow,this.We=this.sourceRange.We,this.isRow||this.We?(this.An=3,this.lE=this.isRow?1:2,this.Uh=6,this.Bh=this.isRow?[11]:[12],this.Dw(this.y6,this.z6),this.tM=this.tia,this.jO=this.Nna,this.Jz(ib.clientPoint,ib.yb,this.isRow?11:12,!0,!0),this.wI(!0)):(this.An=2,this.lE=0,this.Dw(this.xh,this.Ff),this.tM=this.Xsb,this.jO=this.RLb,this.Jz(ib.clientPoint,ib.yb,this.Vaa(),
!1,!0),this.yy(!0))):(this.Dw(this.xh,this.Ff),$a.KeyInputManager.instance.ra(pa.a.Lb,this.domElement.ownerDocument.body,this.onKeyDown),this.lE=this.sourceRange.isRow?1:this.sourceRange.We?2:0,this.Jz(ib.clientPoint,ib.yb,this.Vaa(),!1),this.yy()))};F.prototype.Kya=function(){this.Kp=!1;this.Kh&&(this.An=0);this.qb.fh(this.ZA());if(!this.$.iq([this.gb],!1))return this.Kt(this.xh,this.Ff),this.Uh=-1,!0;if(this.ha.sa.Vc.equals(this.gb)||this.ska(this.gb)||this.ska(this.sourceRange))this.Uh=-1;else{this.cL();
this.ha.sourceRange=this.sourceRange.clone();var ib=this.ha.sourceRange,fc=this.ha.sa.Vc;if(this.Kh){var Ic={};this.$.Cd(-694765314,2,30,(Ic[Ua.a.Xta]=this.Xt,Ic[Ua.a.N3]=ib,Ic[Ua.a.L3]=fc,Ic[Ua.a.Vsb]=this.Yt,Ic))}else Ic={},this.$.Cd(-694765314,2,30,(Ic[Ua.a.Xta]=this.Xt,Ic[Ua.a.N3]=ib,Ic[Ua.a.L3]=fc,Ic))}!this.Kh&&this.tableRange||this.Kt(this.xh,this.Ff);return!0};F.prototype.rqb=function(ib){ib&&($a.KeyInputManager.instance.Ba(pa.a.Lb,this.domElement.ownerDocument.body,this.onKeyDown),this.Kh&&
Jb.g(this.$).ig.wo(Ua.a.x4),this.Kp=!1);for(ib=1;4>=ib;ib++){var fc=this.Gh[ib.toString()];fc&&fc.parentNode.removeChild(fc);this.Gh[ib.toString()]=null}this.Bh=null};F.prototype.qoc=function(ib){var fc=this.ha.Ln(ib.clientPoint,ib.yb,5,void 0,void 0,!0);this.ww=ib;return this.ixb(fc)?(this.gb=this.W2(fc),this.Swb(!0),!0):this.Vid(fc)?(this.gb=this.Hha(fc),this.Twb(!0),!0):!1};F.prototype.ixb=function(ib){return!!this.Mz&&1!==this.An&&!!ib&&this.Mz.contains(ib.topLeft)};F.prototype.Vid=function(ib){return!!this.Mz&&
1===this.An&&!!ib&&!this.Mz.contains(ib.topLeft)};F.prototype.Swb=function(ib){this.tableRange=this.Mz;this.An=1;var fc=!this.Yt;ib?(this.GA(!1),this.Bh=this.wq?[11]:[12],this.Mza(fc),this.wI(fc)):(this.e3(!1),this.VN(fc),this.yy(fc))};F.prototype.Twb=function(ib){this.tableRange=null;this.An=2;var fc=!this.Yt;ib?(this.GA(!1),this.Bh=this.wq?[11]:[12],this.xq=this.wq,this.eQa(fc),this.wI(fc)):(this.C$(!1),this.VN(fc),this.yy(fc))};F.prototype.scc=function(){return this.ha.sa.Vc};F.prototype.cL=function(){this.ha.updateSelection(this.gb,
this.gb.topLeft,0);return!0};F.prototype.yy=function(ib){ib=void 0===ib?!1:ib;this.qb.Ti(this.gb,this.ZA());this.qb.sn(this.ZA());this.vy(ib);return!0};F.prototype.wI=function(ib){ib=void 0===ib?!1:ib;this.qb.Ti(this.gb,this.Bh);this.qb.sn(this.Bh);this.vy(ib)};F.prototype.Ztb=function(){fa.ULS.sendTraceTag(537159384,0,15,"DragSelectionClickBehavior.FailureFallback: this function was not implemented for dragging selection")};F.prototype.NAc=function(){return!1};F.prototype.Bxc=function(){if(!Jb.g(this.$).ha.sa.rg)return!1;
var ib=Jb.g(this.$).getRangeInformation(this.ha.sa.Vc);ib=ik(ib);for(var fc=ib.next();!fc.done;fc=ib.next())if(Object(la.a)(ca.PivotTableRange,fc.value))return!1;return!0};F.prototype.CZc=function(ib){if(ib&&ib.contains(this.sourceRange)&&!ib.equals(this.sourceRange)){if(ib.lba&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===ib.top){var fc=new Ia.Range(this.sourceRange.top,this.sourceRange.left,ib.bottom,this.sourceRange.right,!1,!1);if(!fc.equals(ib))return this.sourceRange=
fc,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),ib}this.Kh?this.wq=ib.left===this.sourceRange.left&&ib.right===this.sourceRange.right:this.isRow=ib.left===this.sourceRange.left&&ib.right===this.sourceRange.right;if(ib.top===this.sourceRange.top&&ib.bottom===this.sourceRange.bottom||this.Vx())return ib}return null};F.prototype.W2=function(ib){var fc=ib.clone();this.Vx()?fc.left=Math.max(ib.left-this.tec,1):fc.top=Math.max(ib.top-this.ZCc,1);fc.right=fc.left+this.sourceRange.width-
1;fc.bottom=fc.top+this.sourceRange.height-1;return this.$Ya(fc)};F.prototype.aAb=function(){var ib=this.gb.topLeft.xd(this.sourceRange);return ib||this.Kh&&!this.tableRange?ib:this.Vx()?this.gb.top===this.sourceRange.bottom+1:this.gb.left===this.sourceRange.right+1};F.prototype.dHd=function(){if(this.Vx()&&this.gb.left!==this.tableRange.left||!this.Vx()&&this.gb.top!==this.tableRange.top){var ib=Yb.a.Xc(1,1,0,910,0,2065438552,"RearrangeInvalidDest");wb.a(this.$).pr([ib]);return!0}return!1};F.prototype.DFd=
function(){var ib=this,fc=this.$.Fb.sc("UserAction","RearrangeRowColumnClientSide"),Ic={},Yc=(Ic.CopyPasteTargetType=1,Ic.OperationId=Ba.a.create().toString(),Ic.Stopwatch=fc,Ic.DragDropIsShiftKeyDown=this.Yt,Ic.EncounteredDeploymentErrors=!1,Ic),Mc=this.Xt?2:1,xb=this.$.da.za(254);(new Promise(function(wc,Ob){ib.Utb(function(nc){nc.Errors&&0<nc.Errors.length?Ob(new jb.a(22,nc.Errors)):wc(!0)},function(nc){nc=Hb.a.xf(nc.data);Ob(new jb.a(22,nc))})})).then(function(){fa.ULS.sendTraceTag(537159383,
0,50,'DragSelectionClickBehavior.RearrangeRowColumn: success. copyPasteTargetType="1"');xb&&xb.Gmf(Yc,Mc,ib.sourceRange,ib.gb);return Promise.resolve(!0)},function(wc){fa.ULS.sendTraceTag(537159382,0,10,"DragSelectionClickBehavior.RearrangeRowColumn: "+(wc?copyPasteInfra.getStringifiedError(wc):"null")+', copyPasteTargetType="1"');return xb?xb.ABf(wc,Yc,Mc,ib.sourceRange,ib.gb):Promise.reject(wc)})};F.prototype.Utb=function(ib,fc){function Ic(){return new J(wc,xb)}function Yc(Ob,nc,mb){return S(Mc.$.oa.va,
wc,xb,ib?Sb.b(Ob,ib):Ob,fc?Sb.a(nc,fc):nc,mb,null)}var Mc=this;ib=void 0===ib?null:ib;fc=void 0===fc?null:fc;var xb={};this.Vx()?(xb.FirstRow=this.gb.top-1,xb.FirstColumn=0,xb.DeltaColumn=0,xb.DeltaRow=this.gb.bottom-this.gb.top+1):(xb.FirstRow=0,xb.FirstColumn=this.gb.left-1,xb.DeltaColumn=this.gb.right-this.gb.left+1,xb.DeltaRow=0);xb.LastRow=Wb.a.Xx;xb.LastColumn=Wb.a.Zu;xb.SheetName=this.$.xa.pa?this.$.xa.pa.name:this.$.vb.getItemByName(this.$.vb.pa.name).sheetName;var wc=nb.v(this.sourceRange,
this.$);vb.EwaSettings.Zb()?this.$.userOperationManager.Sb(new sa.a(514,0,Yc,64,Ic),null):this.$.userOperationManager.Sb(new Na.a(514,0,Yc,void 0,Ic),null)};F.prototype.ska=function(ib){ib=Jb.g(this.$).getRangeInformation(ib);for(var fc=0,Ic=ib.length;fc<Ic;++fc)if(Object(la.a)(ca.PivotTableRange,ib[fc]))return ib=Yb.a.Xc(1,0,0,898,0,2105176604,"InsDelCellsPivotTable"),wb.a(this.$).pr([ib]),!0;return!1};F.prototype.Jz=function(ib,fc,Ic,Yc,Mc){Mc=void 0===Mc?!1:Mc;var xb=oa.DOMElementExtensions.getBoundingClientRect(fc),
wc=fc===this.Ir[T.KIa]||fc===this.Ir[T.g7c];if(this.Kh){var Ob=fc===this.Ir[T.h7c]||fc===this.Ir[T.JIa];this.isRow&&Ob||this.We&&wc?Ob="100px":(wc=this.isRow||wc,Ob=(wc?Mc?F.wWd:F.CWd:Mc?F.vWd:F.zWd)+"px");fc=wc?fc===this.Ir[T.KIa]?"top":"bottom":fc===this.Ir[T.JIa]?"right":"left";ib=100*(wc?ib.x-xb.x:ib.y-xb.y)/(wc?xb.width:xb.height);for(xb=1;4>=xb;xb++){Yc=document.createElement("div");var nc=document.createElement("div"),mb=document.createElement("div");Yc.appendChild(nc);Yc.appendChild(mb);Mc&&
(nc=document.createElement("div"),Yc.appendChild(nc),mb.style.fontWeight="bold");Yc.className=G.OQe;this.Gh[xb.toString()]=Yc;this.qb.ew(Ic,xb).mf.appendChild(Yc);Yc=this.Gh[xb.toString()];Yc.style[fc]=Ob;Yc.style[wc?"left":"top"]=ib+"%"}}else for(Mc=(wc?-F.BWd:-F.yWd)+"px",Ob=wc?fc===this.Ir[T.KIa]?"top":"bottom":fc===this.Ir[T.JIa]||Yc?"right":"left",fc=100*(wc?Yc?0:ib.x-xb.x:ib.y-xb.y)/(wc?xb.width:xb.height),ib=1;4>=ib;ib++)xb=document.createElement("div"),xb.className=G.NQe,this.Gh[ib.toString()]=
xb,this.qb.ew(Ic,ib).mf.appendChild(xb),xb=this.Gh[ib.toString()],xb.style[Ob]=Mc,xb.style[wc?"left":"top"]=fc+"%"};F.prototype.vy=function(ib){ib=void 0===ib?!1:ib;var fc=this.gb.toString();if(this.Kh)for(var Ic=1;4>=Ic;Ic++)this.Gh[Ic.toString()].childNodes[0].innerText=fc,this.Gh[Ic.toString()].childNodes[1].innerText=this.tM,ib&&(this.Gh[Ic.toString()].childNodes[2].innerText=this.jO);else for(ib=1;4>=ib;ib++)this.Gh[ib.toString()].innerText=fc};F.prototype.Goa=function(ib){ib=void 0===ib?0:ib;
0===ib?this.Xt=!1:1===ib&&(this.Yt=!1);this.Kh&&(this.Xt||this.Yt)||($a.KeyInputManager.instance.Ba(pa.a.Fd,this.domElement.ownerDocument.body,this.onKeyUp),this.vMa=!1)};F.prototype.GA=function(ib){this.qb.fh(this.ZA());this.Kt(this.xh,this.Ff,void 0,ib)};F.prototype.e3=function(ib){this.qb.fh(this.Bh);this.Kt(this.y6,this.z6,void 0,ib)};F.prototype.C$=function(ib){this.qb.fh(this.Bh);this.Kt(this.AN,this.CN,void 0,ib)};F.prototype.VN=function(ib){ib=void 0===ib?!1:ib;this.Uh=5;this.Dw(this.xh,this.Ff);
this.tM=this.Xsb;this.jO=this.RLb;this.Jz(this.ww.clientPoint,this.ww.yb,this.Vaa(),!1,ib)};F.prototype.eQa=function(ib){ib=void 0===ib?!1:ib;this.Uh=6;this.Dw(this.y6,this.z6);this.tM=this.tia;this.jO=this.Nna;this.Jz(this.ww.clientPoint,this.ww.yb,this.isRow||this.wq?11:12,!0,ib)};F.prototype.Mza=function(ib){ib=void 0===ib?!1:ib;this.Uh=6;this.Dw(this.AN,this.CN);this.tM=this.tia;this.jO=this.Nna;this.Jz(this.ww.clientPoint,this.ww.yb,this.Vx()?11:12,!0,ib)};F.prototype.yka=function(ib){return ib.Ca.keyCode===
dc.a.l8||bb.a.isMac&&ib.Ca.keyCode===dc.a.Poa};F.prototype.Vx=function(){return!this.Kh&&this.isRow||this.Kh&&this.wq};F.prototype.Vaa=function(){return this.Kh?47:6};F.prototype.ZA=function(){return this.Kh?F.e7c:F.i7c};F.yWd=50;F.BWd=25;F.zWd=-85;F.CWd=-40;F.vWd=-120;F.wWd=-50;F.prb="copy";F.i7c=[6];F.e7c=[47];Object(ia.a)(F,"DragSelectionClickBehavior",T,[]);var wa=b(83);$k(H,T);H.prototype.dispose=function(){this.ha&&(this.ha.f7(this.ep),this.ha.zW(this.tg),this.ha.JJd(this.QOa),this.ha.ZH(this.Rc));
if(this.Gh)for(var ib=1;4>=ib;ib++)oa.DOMElementExtensions.gf(this.Gh[ib.toString()]);this.Gh=this.Bh=null;T.prototype.dispose.call(this)};H.prototype.rqb=function(ib){ib&&(this.Kh&&Jb.g(this.$).ig.wo(Ua.a.x4),this.Kp=!1);for(ib=1;4>=ib;ib++){var fc=this.Gh[ib.toString()];fc&&fc.parentNode.removeChild(fc);this.Gh[ib.toString()]=null}this.Bh=null};H.prototype.scc=function(){return this.ha.sa.Vc};H.prototype.cL=function(){this.ha.updateSelection(this.gb,this.gb.topLeft,0);return!0};H.prototype.yy=function(ib){ib=
void 0===ib?!1:ib;this.qb.Ti(this.gb,this.ZA());this.qb.sn(this.ZA());this.vy(ib);return!0};H.prototype.wI=function(ib){ib=void 0===ib?!1:ib;this.qb.Ti(this.gb,this.Bh);this.qb.sn(this.Bh);this.vy(ib)};H.prototype.Ztb=function(){fa.ULS.sendTraceTag(523638490,0,15,"DragSelectionClickBehaviorTemporary.FailureFallback: this function was not implemented for dragging selection")};H.prototype.NAc=function(){return!1};H.prototype.Jz=function(ib,fc,Ic,Yc,Mc){Mc=void 0===Mc?!1:Mc;var xb=oa.DOMElementExtensions.getBoundingClientRect(fc),
wc=fc===this.Ir[T.KIa]||fc===this.Ir[T.g7c];if(this.Kh){var Ob=fc===this.Ir[T.h7c]||fc===this.Ir[T.JIa];this.isRow&&Ob||this.We&&wc?Ob="100px":(wc=this.isRow||wc,Ob=(wc?Mc?H.wWd:H.CWd:Mc?H.vWd:H.zWd)+"px");fc=wc?fc===this.Ir[T.KIa]?"top":"bottom":fc===this.Ir[T.JIa]?"right":"left";ib=100*(wc?ib.x-xb.x:ib.y-xb.y)/(wc?xb.width:xb.height);for(xb=1;4>=xb;xb++){Yc=document.createElement("div");var nc=document.createElement("div"),mb=document.createElement("div");Yc.appendChild(nc);Yc.appendChild(mb);Mc&&
(nc=document.createElement("div"),Yc.appendChild(nc),mb.style.fontWeight="bold");Yc.className=G.OQe;this.Gh[xb.toString()]=Yc;this.qb.ew(Ic,xb).mf.appendChild(Yc);Yc=this.Gh[xb.toString()];Yc.style[fc]=Ob;Yc.style[wc?"left":"top"]=ib+"%"}}else for(Mc=(wc?-H.BWd:-H.yWd)+"px",Ob=wc?fc===this.Ir[T.KIa]?"top":"bottom":fc===this.Ir[T.JIa]||Yc?"right":"left",fc=100*(wc?Yc?0:ib.x-xb.x:ib.y-xb.y)/(wc?xb.width:xb.height),ib=1;4>=ib;ib++)xb=document.createElement("div"),xb.className=G.NQe,this.Gh[ib.toString()]=
xb,this.qb.ew(Ic,ib).mf.appendChild(xb),xb=this.Gh[ib.toString()],xb.style[Ob]=Mc,xb.style[wc?"left":"top"]=fc+"%"};H.prototype.Xdg=function(ib,fc,Ic){var Yc=Jb.g(this.$),Mc=Yc.gg(ib),xb=Yc.Gf(this.paneType);Ic=Wa.a.ns(xb.view.Hh,this.domElement.parentNode,Ic,Yc.rtl);xb=!1;var wc=2;fc&&Ic.y-Mc.topLeft.y>Mc.height/2?(xb=!0,wc=1):!fc&&Ic.x-Mc.topLeft.x>Mc.width/2&&(xb=!0);if(xb){fc=Yc.Xj("DragSelectionClickBehaviorTemporary.updateMouseSelectionRange",Yc.YG,wc);try{fc.Xr(ib),fc.$$mn(),fc.$$cu()}finally{fc&&
fc.dispose()}}};H.prototype.C$=function(ib){this.qb.fh(this.Bh);this.Kt(this.AN,this.CN,void 0,ib)};H.prototype.GA=function(ib){this.qb.fh(this.ZA());this.Kt(this.xh,this.Ff,void 0,ib)};H.prototype.Vaa=function(){return this.Kh?47:6};H.prototype.ZA=function(){return this.Kh?H.e7c:H.i7c};H.yWd=50;H.BWd=25;H.zWd=-85;H.CWd=-40;H.vWd=-120;H.wWd=-50;H.i7c=[6];H.e7c=[47];Object(ia.a)(H,"DragSelectionClickBehaviorTemporary",T,[]);$k(D,H);D.prototype.dispose=function(){this.Xt&&this.Goa();this.Kh&&this.Yt&&
this.Goa(1);H.prototype.dispose.call(this)};D.prototype.ooc=function(ib){this.Kh&&(this.ww=ib,this.Mz=null,this.wq=this.isRow=this.We=this.xq=!1,$a.KeyInputManager.instance.ra(pa.a.Lb,this.domElement.ownerDocument.body,this.onKeyDown));this.Kp=!0;this.tableRange=this.CZc(this.tableManager.Wm(this.sourceRange.topLeft));Jb.g(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Kh?(this.Mz=this.tableRange,this.An=1,this.Bh=(this.wq=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===
this.sourceRange.right)?[11]:[12],this.Uh=6,this.Dw(this.AN,this.CN),this.tM=this.tia,this.jO=this.Nna,this.Jz(ib.clientPoint,ib.yb,this.wq?11:12,!0,!0),this.wI(!0)):(this.Bh=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.Uh=6,this.Dw(this.AN,this.CN),this.Jz(ib.clientPoint,ib.yb,this.isRow?11:12,!0)):(this.tableRange=null,this.Kh?(this.isRow=this.sourceRange.isRow,this.We=this.sourceRange.We,this.isRow||this.We?(this.An=3,
this.lE=this.isRow?1:2,this.Uh=6,this.Bh=this.isRow?[11]:[12],this.Dw(this.y6,this.z6),this.tM=this.tia,this.jO=this.Nna,this.Jz(ib.clientPoint,ib.yb,this.isRow?11:12,!0,!0),this.wI(!0)):(this.An=2,this.lE=0,this.Dw(this.xh,this.Ff),this.tM=this.Xsb,this.jO=this.RLb,this.Jz(ib.clientPoint,ib.yb,this.Vaa(),!1,!0),this.yy(!0))):(this.Dw(this.xh,this.Ff),$a.KeyInputManager.instance.ra(pa.a.Lb,this.domElement.ownerDocument.body,this.onKeyDown),this.lE=this.sourceRange.isRow?1:this.sourceRange.We?2:0,
this.Jz(ib.clientPoint,ib.yb,this.Vaa(),!1),this.yy()))};D.prototype.Kya=function(){this.Kp=!1;this.Kh&&(this.An=0);this.qb.fh(this.ZA());if(!this.$.iq([this.gb],!1))return this.Kt(this.xh,this.Ff),this.Uh=-1,!0;if(this.ha.sa.Vc.equals(this.gb)||this.ska(this.gb)||this.ska(this.sourceRange))this.Uh=-1;else{this.cL();this.ha.sourceRange=this.sourceRange.clone();var ib=this.ha.sourceRange,fc=this.ha.sa.Vc;if(this.Kh){var Ic={};this.$.Cd(-694765314,2,30,(Ic[Ua.a.Xta]=this.Xt,Ic[Ua.a.N3]=ib,Ic[Ua.a.L3]=
fc,Ic[Ua.a.Vsb]=this.Yt,Ic))}else Ic={},this.$.Cd(-694765314,2,30,(Ic[Ua.a.Xta]=this.Xt,Ic[Ua.a.N3]=ib,Ic[Ua.a.L3]=fc,Ic))}!this.Kh&&this.tableRange||this.Kt(this.xh,this.Ff);this.Ytd&&this.Xtd();return!0};D.prototype.rqb=function(ib){ib&&$a.KeyInputManager.instance.Ba(pa.a.Lb,this.domElement.ownerDocument.body,this.onKeyDown);H.prototype.rqb.call(this,ib)};D.prototype.qoc=function(ib){var fc=this.ha.Ln(ib.clientPoint,ib.yb,5,void 0,void 0,!0);this.ww=ib;return this.ixb(fc)?(this.gb=this.W2(fc),this.Swb(!0),
!0):this.Vid(fc)?(this.gb=this.Hha(fc),this.Twb(!0),!0):!1};D.prototype.vy=function(ib){ib=void 0===ib?!1:ib;var fc=this.gb.toString();if(this.Kh)for(var Ic=1;4>=Ic;Ic++)this.Gh[Ic.toString()].childNodes[0].innerText=fc,this.Gh[Ic.toString()].childNodes[1].innerText=this.tM,ib&&(this.Gh[Ic.toString()].childNodes[2].innerText=this.jO);else for(ib=1;4>=ib;ib++)this.Gh[ib.toString()].innerText=fc};D.prototype.ixb=function(ib){return!!this.Mz&&1!==this.An&&!!ib&&this.Mz.contains(ib.topLeft)};D.prototype.Vid=
function(ib){return!!this.Mz&&1===this.An&&!!ib&&!this.Mz.contains(ib.topLeft)};D.prototype.Swb=function(ib){this.tableRange=this.Mz;this.An=1;var fc=!this.Yt;ib?(this.GA(!1),this.Bh=this.wq?[11]:[12],this.Mza(fc),this.wI(fc)):(this.e3(!1),this.VN(fc),this.yy(fc))};D.prototype.Twb=function(ib){this.tableRange=null;this.An=2;var fc=!this.Yt;ib?(this.GA(!1),this.Bh=this.wq?[11]:[12],this.xq=this.wq,this.eQa(fc),this.wI(fc)):(this.C$(!1),this.VN(fc),this.yy(fc))};D.prototype.Bxc=function(){if(!Jb.g(this.$).ha.sa.rg)return!1;
var ib=Jb.g(this.$).getRangeInformation(this.ha.sa.Vc);ib=ik(ib);for(var fc=ib.next();!fc.done;fc=ib.next())if(Object(la.a)(ca.PivotTableRange,fc.value))return!1;return!0};D.prototype.CZc=function(ib){if(ib&&ib.contains(this.sourceRange)&&!ib.equals(this.sourceRange)){if(ib.lba&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===ib.top){var fc=new Ia.Range(this.sourceRange.top,this.sourceRange.left,ib.bottom,this.sourceRange.right,!1,!1);if(!fc.equals(ib))return this.sourceRange=
fc,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),ib}this.Kh?this.wq=ib.left===this.sourceRange.left&&ib.right===this.sourceRange.right:this.isRow=ib.left===this.sourceRange.left&&ib.right===this.sourceRange.right;if(ib.top===this.sourceRange.top&&ib.bottom===this.sourceRange.bottom||this.Vx())return ib}return null};D.prototype.W2=function(ib){var fc=ib.clone();this.Vx()?fc.left=Math.max(ib.left-this.tec,1):fc.top=Math.max(ib.top-this.ZCc,1);fc.right=fc.left+this.sourceRange.width-
1;fc.bottom=fc.top+this.sourceRange.height-1;return this.$Ya(fc)};D.prototype.aAb=function(){var ib=this.gb.topLeft.xd(this.sourceRange);return ib||this.Kh&&!this.tableRange?ib:this.Vx()?this.gb.top===this.sourceRange.bottom+1:this.gb.left===this.sourceRange.right+1};D.prototype.dHd=function(){if(this.Vx()&&this.gb.left!==this.tableRange.left||!this.Vx()&&this.gb.top!==this.tableRange.top){var ib=Yb.a.Xc(1,1,0,910,0,2065438552,"RearrangeInvalidDest");wb.a(this.$).pr([ib]);return!0}return!1};D.prototype.DFd=
function(){var ib=this,fc=this.$.Fb.sc("UserAction","RearrangeRowColumnClientSide"),Ic={},Yc=(Ic.CopyPasteTargetType=1,Ic.OperationId=Ba.a.create().toString(),Ic.Stopwatch=fc,Ic.DragDropIsShiftKeyDown=this.Yt,Ic.EncounteredDeploymentErrors=!1,Ic),Mc=this.Xt?2:1,xb=this.$.da.za(254);(new Promise(function(wc,Ob){ib.Utb(function(nc){nc.Errors&&0<nc.Errors.length?Ob(new jb.a(22,nc.Errors)):wc(!0)},function(nc){nc=Hb.a.xf(nc.data);Ob(new jb.a(22,nc))})})).then(function(){fa.ULS.sendTraceTag(520747156,
0,50,'DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: success. copyPasteTargetType="1"');xb&&xb.Gmf(Yc,Mc,ib.sourceRange,ib.gb);return Promise.resolve(!0)},function(wc){fa.ULS.sendTraceTag(520747155,0,10,"DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: "+(wc?copyPasteInfra.getStringifiedError(wc):"null")+', copyPasteTargetType="1"');return xb?xb.ABf(wc,Yc,Mc,ib.sourceRange,ib.gb):Promise.reject(wc)})};D.prototype.Utb=function(ib,fc){function Ic(){return new J(wc,xb)}
function Yc(Ob,nc,mb){return S(Mc.$.oa.va,wc,xb,ib?Sb.b(Ob,ib):Ob,fc?Sb.a(nc,fc):nc,mb,null)}var Mc=this;ib=void 0===ib?null:ib;fc=void 0===fc?null:fc;var xb={};this.Vx()?(xb.FirstRow=this.gb.top-1,xb.FirstColumn=0,xb.DeltaColumn=0,xb.DeltaRow=this.gb.bottom-this.gb.top+1):(xb.FirstRow=0,xb.FirstColumn=this.gb.left-1,xb.DeltaColumn=this.gb.right-this.gb.left+1,xb.DeltaRow=0);xb.LastRow=Wb.a.Xx;xb.LastColumn=Wb.a.Zu;xb.SheetName=this.$.xa.pa?this.$.xa.pa.name:this.$.vb.getItemByName(this.$.vb.pa.name).sheetName;
var wc=nb.v(this.sourceRange,this.$);vb.EwaSettings.Zb()?this.$.userOperationManager.Sb(new sa.a(514,0,Yc,64,Ic),null):this.$.userOperationManager.Sb(new Na.a(514,0,Yc,void 0,Ic),null)};D.prototype.ska=function(ib){ib=Jb.g(this.$).getRangeInformation(ib);for(var fc=0,Ic=ib.length;fc<Ic;++fc)if(Object(la.a)(ca.PivotTableRange,ib[fc]))return ib=Yb.a.Xc(1,0,0,898,0,2105176604,"InsDelCellsPivotTable"),wb.a(this.$).pr([ib]),!0;return!1};D.prototype.Goa=function(ib){ib=void 0===ib?0:ib;0===ib?this.Xt=!1:
1===ib&&(this.Yt=!1);this.Kh&&(this.Xt||this.Yt)||($a.KeyInputManager.instance.Ba(pa.a.Fd,this.domElement.ownerDocument.body,this.onKeyUp),this.vMa=!1)};D.prototype.VN=function(ib){ib=void 0===ib?!1:ib;this.Uh=5;this.Dw(this.xh,this.Ff);this.tM=this.Xsb;this.jO=this.RLb;this.Jz(this.ww.clientPoint,this.ww.yb,this.Vaa(),!1,ib)};D.prototype.eQa=function(ib){ib=void 0===ib?!1:ib;this.Uh=6;this.Dw(this.y6,this.z6);this.tM=this.tia;this.jO=this.Nna;this.Jz(this.ww.clientPoint,this.ww.yb,this.isRow||this.wq?
11:12,!0,ib)};D.prototype.Mza=function(ib){ib=void 0===ib?!1:ib;this.Uh=6;this.Dw(this.AN,this.CN);this.tM=this.tia;this.jO=this.Nna;this.Jz(this.ww.clientPoint,this.ww.yb,this.Vx()?11:12,!0,ib)};D.prototype.yka=function(ib){return ib.Ca.keyCode===dc.a.l8||bb.a.isMac&&ib.Ca.keyCode===dc.a.Poa};D.prototype.Vx=function(){return!this.Kh&&this.isRow||this.Kh&&this.wq};D.prototype.e3=function(ib){this.qb.fh(this.Bh);this.Kt(this.y6,this.z6,void 0,ib)};D.prototype.Xtd=function(){var ib=wa.a.instance.Tb("Common.ISystemInitiatedFeedback");
ib&&ib.execute(function(fc){fc.logActivity("DragDrop",null)})};D.prb="copy";Object(ia.a)(D,"DragSelectionClickBehaviorCellRangeAndTable",H,[]);var Oa=b(334);$k(w,H);w.prototype.ooc=function(ib){this.ww=ib;this.isRow=this.We=!1;this.Kp=!0;this.rc=this.tableManager.wva(this.sourceRange);Jb.g(this.$);Jb.g(this.$).ig.wo(T.U1a);this.Vpd(this.gb)?(this.isRow=this.hni(),this.We=this.fhi(),this.isRow||this.We?(this.Dhc=!1,this.Mza(ib),this.gb=this.W2(this.gb),this.wI()):(this.Dhc=!0,this.VN(ib),this.yy())):
(this.Dhc=!0,this.VN(ib),this.yy())};w.prototype.Kya=function(){return 5==this.Uh?(this.GA(!0),this.Dhc=!1,this.YAj(),this.Uh=-1,!0):!1};w.prototype.qoc=function(ib){var fc=this.ha.Ln(ib.clientPoint,ib.yb,5,void 0,void 0,!0);this.ww=ib;return this.Dhc?!1:this.Vpd(fc)?(this.p3h(ib),!0):!1};w.prototype.vy=function(){var ib=new Ia.Range(this.gb.top,this.gb.left,this.gb.bottom,this.gb.right,!1,!0);6==this.Uh&&(this.isRow?(--ib.top,ib.bottom=ib.top+this.gb.height-1):(--ib.left,ib.right=ib.left+this.gb.width-
1));for(var fc=1;4>=fc;fc++)this.Gh[fc.toString()].childNodes[0].innerText=ib.toString()};w.prototype.Bxc=function(){if(!Jb.g(this.$).ha.sa.rg)return!1;var ib=Jb.g(this.$).getRangeInformation(this.ha.sa.Vc);ib=ik(ib);for(var fc=ib.next();!fc.done;fc=ib.next())if(Object(la.a)(ca.PivotTableRange,fc.value))return!0;return!1};w.prototype.W2=function(ib){ib=ib.clone();this.isRow?(ib.left=this.sourceRange.left,ib.right=this.rc.right,ib.bottom=ib.top+this.sourceRange.height-1):this.We&&(ib.top=this.sourceRange.top,
ib.bottom=this.rc.RW.bottom,ib.right=ib.left+this.sourceRange.width-1);return this.$Ya(ib)};w.prototype.z2i=function(){var ib={},fc=nb.v(this.sourceRange,this.$);Jb.g(this.$).getRangeInformation(this.gb);if(this.isRow){fc.FirstColumn=ib.FirstColumn=this.gb.left-1;fc.LastColumn=ib.LastColumn=this.gb.right-1;if(this.sourceRange.top<=this.gb.top&&this.sourceRange.bottom>=this.gb.top-1)return;this.sourceRange.top>this.gb.top?ib.LastRow=ib.FirstRow=this.gb.top-1:(ib.FirstRow=this.gb.top-this.sourceRange.height-
1,ib.LastRow=ib.FirstRow+this.sourceRange.height-1)}else{ib.FirstRow=this.gb.top;ib.LastRow=this.gb.bottom-1;if(this.sourceRange.left<=this.gb.left&&this.sourceRange.right>=this.gb.left-1)return;ib.LastColumn=this.sourceRange.left>this.gb.left?ib.FirstColumn=this.gb.left-1:ib.FirstColumn=this.gb.left-this.sourceRange.width-1}var Ic={};Ic.SheetName=this.$.xa.pa?this.$.xa.pa.name:this.$.vb.getItemByName(this.$.vb.pa.name).sheetName;Ic.Ranges=Array(2);Ic.Ranges[0]=fc;Ic.Ranges[1]=ib;this.ryh(Ic)};w.prototype.ryh=
function(ib){function fc(Yc,Mc,xb){var wc=Ic.$.oa.va;Yc=Ic.gAf?Sb.b(Yc,Ic.gAf):Yc;Mc=Ic.fAf?Sb.a(Mc,Ic.fAf):Mc;var Ob=wc.Na(1,null);Ob.moveRange=ib;return lb.g(wc,"MoveLineItems",Ob,Yc,Mc,xb,null,0)}var Ic=this;vb.EwaSettings.Zb()?this.$.userOperationManager.Sb(new sa.a(265,0,fc,64),null):this.$.userOperationManager.Sb(new Na.a(265,0,fc,void 0),null)};w.prototype.Vpd=function(ib){return ib.left>=this.rc.RW.left&&ib.right<=this.rc.nM.right&&ib.top>=this.rc.nM.top&&ib.bottom<=this.rc.RW.bottom};w.prototype.hni=
function(){return this.rc.RW.top<=this.gb.top&&this.rc.RW.left<=this.gb.left&&this.rc.RW.right>=this.gb.left};w.prototype.fhi=function(){return this.rc.nM.top==this.gb.top&&this.rc.nM.left<=this.gb.left&&this.rc.nM.right>=this.gb.right};w.prototype.Mza=function(ib){this.Uh=6;this.Bh=this.isRow?[11]:[12];this.Dw(this.AN,this.CN);this.Jz(ib.clientPoint,ib.yb,this.isRow?11:12,!0,!1)};w.prototype.VN=function(ib){this.Uh=5;this.Dw(this.xh,this.Ff);this.Jz(ib.clientPoint,ib.yb,this.Vaa(),!1,!1)};w.prototype.p3h=
function(ib){this.GA(!0);this.Mza(ib);this.gb=this.W2(this.gb);this.wI()};w.prototype.o3h=function(ib){this.C$(!0);this.VN(ib);this.yy()};w.prototype.YAj=function(){var ib=Yb.a.Xc(1,0,900,899,0,2069074184,"PivotTableInvalidMove");ib.HelpTopicId=Oa.a.HEj;ib.HelpDescription=ka.a.instance.ga(905);wb.a(this.$).pr([ib])};Object(ia.a)(w,"DragSelectionClickBehaviorPivotTableRange",H,[]);var Ub=b(395);$k(y,I);y.prototype.dispose=function(){ra.a.instance.Ba(pa.a.pointerDown,this.Eaa,this.onPointerDown);Sa.a.instance.Ba(pa.a.$j,
this.Eaa,this.Bca);this.gridView.$&&(this.gridView.ha.f7(this.ep),this.gridView.ha.zW(this.tg),this.gridView.$.sl(this.Yc),this.gridView.$.ob.ntc(this.G6),this.gridView.$.ob.mtc(this.E6),this.gridView.sQf(this.KEb),this.gridView.$b.vk(this.nyf),this.gridView.$b.Nl(this.myf));I.prototype.dispose.call(this)};Object(ia.a)(y,"FillHandleClickBehavior",I,[]);$k(z,B);of.Object.defineProperties(z.prototype,{Jva:{configurable:!0,enumerable:!0,get:function(){return this.Bqg}}});z.sxe=[1,2,32,256,128,64];Object(ia.a)(z,
"IPadSelectionClickThroughBehavior",B,[]);var hb=b(22);A.prototype.dispose=function(){this.gridView.ha.f7(this.ep);this.gridView.ha.zW(this.tg);this.gridView.ha.JJd(this.tg)};A.prototype.aAa=function(){this.u5a=0;this.Xgc=!1;this.I5=Number.NaN};A.prototype.HJe=function(ib){this.Xgc=!0;this.PBc(ib,1)};A.prototype.IJe=function(ib){this.Xgc=!1;this.PBc(ib,-1)};A.prototype.PBc=function(ib,fc){if(ib)if(ib.parentNode)if(this.Iod)isNaN(this.I5)||(this.dCc(this.I5,!1),this.I5=Number.NaN);else if(ib=parseInt(ib.parentNode.getAttribute(Ua.a.oyb),
10),isNaN(ib))fa.ULS.shipAssertTag(537159366,0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");else{if(!isNaN(this.I5)&&ib!==this.I5){if(this.Xgc)return;this.dCc(this.I5,!1)}if(isNaN(this.I5)||ib!==this.I5)this.I5=ib,this.u5a=0;!this.u5a&&0<fc&&this.dCc(ib,!0);this.u5a=Math.max(this.u5a+fc,0);!this.u5a&&0>fc&&(this.dCc(ib,!1),this.I5=Number.NaN)}else fa.ULS.shipAssertTag(537159367,0,!!ib.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");
else fa.ULS.shipAssertTag(537159368,0,!!ib,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.")};A.prototype.dCc=function(ib,fc){for(var Ic=1;4>=Ic;Ic++){var Yc=this.gridView.qb.ew(3,Ic,ib).mf;oa.DOMElementExtensions.toggleCssClass(Yc,G.lwh,fc);for(Yc=Yc.firstChild;Yc;Yc=Yc.nextSibling)hb.a.contains(Yc.className,"resizemarqueehandle",!0)&&oa.DOMElementExtensions.toggleCssClass(Yc,G.pwh,fc)}};Object(ia.a)(A,"MarqueeHoveringManager",null,[]);var Xb=b(199),Gc=b(85),uc=b(1041),Nc=b(1449);$k(u,
B);u.prototype.dispose=function(){ra.a.instance.Ba(pa.a.iW,this.WJ,this.$Af);ra.a.instance.Ba(pa.a.jy,this.WJ,this.Fca);ra.a.instance.Ba(pa.a.pointerDown,this.WJ,this.onPointerDown);Xb.a.instance.Ba(pa.a.click,this.WJ,this.iFb);Xb.a.instance.Ba(pa.a.$j,this.WJ,this.onDoubleClick);oa.DOMElementExtensions.gf(this.oH);this.oH=null;oa.DOMElementExtensions.gf(this.WJ);this.Tu=this.WJ=null;B.prototype.dispose.call(this)};u.prototype.ZYa=function(ib){this.Tu=Object(Gc.a)(Nc.a,ib.metadata)};Object(ia.a)(u,
"RangeCatchUpActivityHighlightBehavior",B,[]);$k(l,L);l.prototype.dSa=function(){return(this.gridView.inRangePicker||this.gridView.vi)&&L.prototype.dSa.call(this)};of.Object.defineProperties(l.prototype,{K4:{configurable:!0,enumerable:!0,get:function(){return 16}},xcb:{configurable:!0,enumerable:!0,get:function(){return this.gridView.ha.rangePicker.Icd(!1)}}});Object(ia.a)(l,"RangePickerTouchGrippiesBehavior",L,[]);$k(x,B);Object(ia.a)(x,"RearrangeHighlightBehavior",B,[]);var Fb;(function(ib){ib[ib.topLeft=
0]="topLeft";ib[ib.topRight=1]="topRight";ib[ib.bottomLeft=2]="bottomLeft";ib[ib.bottomRight=3]="bottomRight";ib[ib.error=4]="error"})(Fb||(Fb={}));Object(ia.b)("Corner",Fb);$k(m,B);m.prototype.dispose=function(){var ib=this;this.RK.forEach(function(fc){ra.a.instance.Ba(pa.a.pointerDown,fc,ib.onPointerDown)});this.RK.length=0;B.prototype.dispose.call(this)};m.prototype.ZYa=function(ib){this.oba=ib;this.Xoe(ib);this.Wn.vLb(ib,this.RK,this.zRd());this.jF.aAa()};m.prototype.Y_e=function(ib,fc){var Ic=
ib.yb;ib=ib.clientPoint;if(!Ic||!ib)return fa.ULS.shipAssertTag(537159324,0,!!Ic,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),fa.ULS.shipAssertTag(537159323,0,!!ib,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),null;fc&&(ib=this.crf(ib));fc=this.ha.Ln(ib,Ic,0,!0,!1,!0);fc||(ib=this.crf(ib),fc=this.ha.Ln(ib,Ic,0,!0,!1,!0));return fc};m.prototype.crf=function(ib){ib.y+=0===this.t3||1===this.t3?2:-2;ib.x+=0===this.t3||2===this.t3?2:-2;return ib};m.prototype.mEe=
function(ib){if(!ib||!this.sourceRange)return fa.ULS.shipAssertTag(537159322,0,!!ib,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),fa.ULS.shipAssertTag(537159321,0,!!this.sourceRange,"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),null;if(0===this.t3)return new Ia.Range(ib.top,ib.left,this.sourceRange.bottom,this.sourceRange.right,!0,!1);if(1===this.t3)return new Ia.Range(ib.top,this.sourceRange.left,this.sourceRange.bottom,ib.right,!0,!1);if(2===this.t3)return new Ia.Range(this.sourceRange.top,
ib.left,ib.bottom,this.sourceRange.right,!0,!1);if(3===this.t3)return new Ia.Range(this.sourceRange.top,this.sourceRange.left,ib.bottom,ib.right,!0,!1);fa.ULS.shipAssertTag(537159320,0,!1,"ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: "+Fb[this.t3]);return null};m.prototype.cL=function(){return this.coloredReferencesManager.brf(this.Ya,this.XK,this.gb)};m.prototype.yy=function(){return this.cL()};m.prototype.h$b=function(ib){ib&&fa.ULS.sendTraceTag(537159319,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate colored references as a fallback.");
this.jF.IJe(this.RK[0]);this.Wn.jLf(!1,this.oba.K$);this.Ya.textBox.setCaretPositionToEnd();this.Ya.Ysc(this.P5e);this.pcg();this.JSa=this.gridView.DLa=!1;oc.b(this.$,!1);this.Wn.aNf()};Object(ia.a)(m,"ResizeMarqueeBehaviorBase",B,[]);$k(v,m);v.prototype.LTf=function(){return[G.cxh,G.dxh,G.axh,G.bxh]};v.prototype.Ooe=function(){return[G.$wh]};v.prototype.mZe=function(ib){ib=ib.yb;if(ib===this.RK[0])return 0;if(ib===this.RK[1])return 1;if(ib===this.RK[2])return 2;if(ib===this.RK[3])return 3;fa.ULS.shipAssertTag(537159318,
0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4};v.prototype.BOf=function(){this.Wn.Dw(this.xh,this.Ff,!0)};v.prototype.pcg=function(){this.Wn.bYd(this.xh,this.Ff,!0)};v.prototype.s2f=function(ib){return 2===(Ra.a.Cb=ib.nb)&&ib.Jn===Sys.UI.MouseButton.leftButton};v.prototype.zRd=function(){return!0};v.prototype.Wmf=function(){fa.ULS.sendTraceTag(537159317,0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")};
v.prototype.Xoe=function(ib){for(var fc=ik(this.RK),Ic=fc.next();!Ic.done;Ic=fc.next())Ic.value.style.backgroundColor=ib.mf.style.borderColor};Object(ia.a)(v,"ResizeMarqueeMouseBehavior",m,[]);$k(f,m);f.prototype.dispose=function(){Ra.a.UQf(this.dFb);m.prototype.dispose.call(this)};f.prototype.LTf=function(){return[ub.a.ewh,ub.a.dwh]};f.prototype.Ooe=function(){var ib=!vb.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");return[ib?ub.a.FQe:ub.a.EQe,ub.a.g9b,ib?ub.a.cwh:ub.a.f9b]};
f.prototype.mZe=function(ib){ib=ib.yb;if(ib===this.RK[0])return 0;if(ib===this.RK[1])return 3;fa.ULS.shipAssertTag(537159316,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4};f.prototype.BOf=function(){bb.a.Xu?this.Wn.Dw(this.xh,this.Ff,!1):this.Wn.J9i(this.xh,this.Ff)};f.prototype.pcg=function(){bb.a.Xu?this.Wn.bYd(this.xh,this.Ff,!1):this.Wn.OQj(this.xh,this.Ff)};f.prototype.s2f=function(ib){return 3===(Ra.a.Cb=ib.nb)};f.prototype.zRd=function(){return 3===
Ra.a.Cb};f.prototype.Wmf=function(){fa.ULS.sendTraceTag(537159315,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")};f.prototype.Xoe=function(){};Object(ia.a)(f,"ResizeMarqueeTouchBehavior",m,[]);$k(n,B);n.Brb=function(ib,fc){var Ic=document.createElement("div");Ic.className=fc;ib.appendChild(Ic)};Object(ia.a)(n,"SelectionCutCopyBehavior",B,[]);$k(k,B);Object(ia.a)(k,"SelectionPasteBehavior",B,[]);$k(h,B);h.Qrb=function(ib,fc){var Ic=document.createElement("div");
Ic.className=fc;ib.appendChild(Ic)};Object(ia.a)(h,"SelectionRangePickerBehavior",B,[]);$k(e,L);e.prototype.dSa=function(){var ib=this.gridView.vi||this.gridView.isEditing;return this.gridView.ha.sa.rg&&!ib&&L.prototype.dSa.call(this)};of.Object.defineProperties(e.prototype,{K4:{configurable:!0,enumerable:!0,get:function(){return 0}},xcb:{configurable:!0,enumerable:!0,get:function(){return this.gridView.ha.sa.Vc}}});Object(ia.a)(e,"SelectionTouchGrippiesBehavior",L,[]);var ob=ba.a;$k(d,ob);d.prototype.dispose=
function(){this.gridView.qb.Pcj(this.Pob);this.jF&&(this.jF.dispose(),this.jF=null);ob.prototype.dispose.call(this)};Object(ia.a)(d,"GridHighlightsBehaviorManager",ba.a,[]);var zb=da.a;$k(c,zb);c.prototype.create=function(){var ib=this;va.TaskExtensions.Aa(ya.GetServiceTaskFactory.create(this.$.da,134,this.la,this.hb),function(fc){ib.pb(ib.$.da.za(64)||new d(ib.$,fc.result))},this.la,3)};c.ka=function(ib){ib.da.Ga(149,new c(ib))};Object(ia.a)(c,"GridHighlightsBehaviorManagerFactory",da.a,[]);b.d(E,
"a",function(){return a})},1358:function(t,E,b){function a(){J.a.Fa(function(Fb){c.ka(Fb);H.ka(Fb)})}function c(Fb){var ob=Nc.call(this)||this;ob.$=Fb;ob.Eb();return ob}function d(Fb,ob,zb){zb=void 0===zb?null:zb;var ib=uc.call(this,ob)||this;ib.sheetTabActivatePreviousHidden=ra.a.instance.ga(725);ib.sheetTabActivateNextHidden=ra.a.instance.ga(727);ib.svgIconProvider=null;ib.mh=[];ib.sK=Array(6);ib.xxd=Array(6);ib.Qk=null;ib.JQd=null;ib.axc=null;ib.mdb=null;ib.Zwc=null;ib.rH=null;ib.Eyb=null;ib.VRa=
null;ib.isRtl=!1;ib.Ku=0;ib.hK=0;ib.vtc=!1;ib.C7b=!1;ib.lna=0;ib.gqc=0;ib.K7b=null;ib.laa=null;ib.P3=null;ib.uM=null;ib.BC=0;ib.Zcc=0;ib.qNb=null;ib.tBb=-1;ib.ZY=null;ib.mpc=0;ib.Pyc=-1;ib.Gma=0;ib.Lta=new D;ib.yLc=!1;ib.L_=null;ib.Ege=null;ib.KQd=null;ib.LQd=null;ib.wtc=null;ib.U9d=!1;ib.gld=null;ib.Pwd=!1;ib.Dge=null;ib.VC=function(fc,Ic){ib.fDf(Ic.item)};ib.Qya=function(fc,Ic){fc=ib.$.xa.pa.index;for(var Yc=0,Mc=ib.mh.length;Yc<Mc;Yc++){var xb=ib.AQ(Yc);if(xb.name===Ic.oldName){xb.name=Ic.newName;
ib.m0();Yc===fc&&ib.y0(6);break}}};ib.kDf=function(fc,Ic){(fc=ib.T2a(Ic.item))&&fc.Efb()};ib.lDf=function(fc,Ic){Ic.visible?(ib.LRa(!1),ib.hDf(Ic.item)):ib.fDf(Ic.item)};ib.sN=function(fc){ib.cF?(ib.ZY=fc,ib.LOb()):(ib.ZY&&(ib.gqc+=ib.ZY.clientPoint.x-fc.clientPoint.x),ib.ZY=fc,Math.abs(ib.gqc)>=ib.ljh&&ib.LOb());return!0};ib.FN=function(fc){fc.Ca.preventDefault();return!1};ib.fXf=function(fc){ib.bXf(fc,!0)};ib.eXf=function(fc){ib.bXf(fc,!1)};ib.q6=function(fc){if(ib.cF&&(ib.mz||ib.mhf(fc)))if(ib.C7b=
ib.fdf(fc),ib.mz){var Ic;fc=(Ic=ib.AQ(ib.BC+1))?Ic.sheet:null;ib.reorderSheets(fc,ib.BC+1===ib.HQd,!0)}else fc=ib.Pwd?null:ib.gld,ib.reorderSheets(fc,ib.Pwd,!0);ib.hQ();return!0};ib.wh=function(fc,Ic){Ic.sF&&ib.kZd(Ic.sF);ib.hwc(!1);ib.m0();Ic.pa&&(ib.kZd(Ic.pa),ib.y0(6),ib.ea.mma())};ib.Vtf=function(fc,Ic){ib.uCc(Ic.item)};ib.Wtf=function(fc,Ic){ib.uCc(Ic.item)};ib.Xtf=function(fc,Ic){ib.uCc(Ic.item)};ib.IOa=function(fc,Ic){ib.uCc(Ic.item)};ib.wya=function(){ib.I0c()};ib.Yc=function(){ib.isVisible=
!ib.ea.isNamedObjectViewMode;ib.I0c();ib.v4c();X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&(Gc.d(ib.$)||Gc.e(ib.$))&&(Xb.PageLoadTrackingInfo.instance.FW(B.a.HAa,["sheetTabBar"]),Xb.PageLoadTrackingInfo.instance.EW(B.a.HAa,["sheetTabBar"]));ib.d4c();ib.m0();ib.LRa(!0);ib.y0(6)};ib.Ni=function(){ib.isVisible&&(ib.m0(),ib.y0(6))};ib.Sf=function(){Object(ba.a)(z,ib.rH)===ta.k(ib.$.mg)&&ib.d4c();for(var fc=ik(ib.mh),Ic=fc.next();!Ic.done;Ic=fc.next())Ic.value.Qpj(!ta.k(ib.$.mg))};
ib.jDf=function(fc,Ic){ib.cfj(Ic.item,Ic.isUserOperation)};ib.DFb=function(fc,Ic){ib.hDf(Ic.item)};ib.onKeyDown=function(fc){switch(fc.keyCode){case 9:var Ic=ib.domElement.querySelectorAll(La.DOMElementExtensions.dr),Yc=La.DOMElementExtensions.Cl(Ic);Ic=La.DOMElementExtensions.fz(Ic);La.DOMElementExtensions.zna(fc,Yc,Ic);break;case 39:case 37:La.DOMElementExtensions.c_f(fc,ib.domElement.querySelectorAll(La.DOMElementExtensions.dr),39===fc.keyCode?!ib.isRtl:ib.isRtl)}P.ULS.sendTraceTag(537153691,0,
50,"SheetTabBarControl.OnKeyDown: Press on "+fc.keyCode)};ib.onScroll=function(){ib.Qk.scrollLeft!==ib.lna&&ib.xKj()};ib.v6=function(fc){if(fc.ctrlKey||fc.i3)return!1;ib.Qk.scrollLeft+=Math.floor(30*fc.jCa);if(ib.mz&&ib.cF){var Ic=ib.DZe("OnMouseWheel");Ic&&ib.XUd(0<fc.jCa,Ic.x+Ic.width/2)}return!0};ib.pF=function(fc,Ic){if(ib.Lta)ib.d6e("PartialInteractivity",Ic.TL?3:0);else{ib.hQ(!1);ib.kPd(Ic.TL);fc=ik(ib.ute);for(var Yc=fc.next();!Yc.done;Yc=fc.next())(Yc=Yc.value)&&Yc.mX(Ic.TL);fc=ik(ib.mh);
for(Yc=fc.next();!Yc.done;Yc=fc.next())(Yc=Yc.value)&&Yc.mX(Ic.TL)}};ib.KEb=function(fc,Ic){fc=0;Ic.zke&&(fc=2|(Ic.Pwj?1:0));ib.d6e("ComponentRangePicker",fc)};ib.$=Fb;ib.ea=ib.$.ea;ib.mz=U.a.eff();ib.S7b=ib.mz&&!X.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");ib.fm=X.EwaSettings.ma(502);ib.kw=U.a.mqd();ib.khf=ib.fm&&!(X.EwaSettings.isChangeGateEnabled("OfficeVSO:6179307_hideSheetDropDownMenuForMobileMeetings")&&ib.$.JC);ib.mz&&(ib.U9d=ib.fm&&
!ea.a.Xu);ib.FDi=ib.$.ya.SheetTabNavigateButtonLongKeyPressPeriodMS;ib.EDi=ib.$.ya.SheetTabNavigateButtonIntervalPeriodMS;ib.ljh=ib.$.ya.SheetTabDragStartPixelThreshold;ib.vPa=-1;ib.uPa=-1;ib.C2c=!1;ib.kw&&(ib.svgIconProvider=zb);ib.aC=new Aa.a(ib.domElement,3);ib.fm&&ib.domElement.classList.add(w.nth);ib.l9g();ib.L6g();ib.m9g();ib.o$g();ib.hwc(!0);ib.Yc(null,null);Fb=ib.$.xa;Fb.Mf(ib.wh);Fb.ZUc(ib.wya);Fb.pY(ib.VC);Fb.Uga(ib.DFb);Fb.SFa(ib.Qya);Fb.Jne(ib.jDf);Fb.NYa(ib.lDf);Fb.FGg(ib.kDf);Fb.iVc(ib.Vtf);
Fb.Gne(ib.Wtf);Fb.Hne(ib.Xtf);Fb.Ine(ib.IOa);ib.$.Uk(ib.Yc);ib.$.rA(ib.Ni);ja.a(ib.$).Nh(ib);ib.$.da.Ga(32,ib);X.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport")&&ib.$.ea.Bu(ib.Sf);ib.$wc=ib.je.Td(ib.domElement);ib.$wc.ka("keydown",ib.onKeyDown);Ka.a(ib.$).Lp()&&ib.pF(null,new vb.a(!0));Ka.a(ib.$).Tf.U9(ib.pF);Ab.g(ib.$).dne(ib.KEb);X.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&ib.$wc.ka("mousedown",function(fc){fc.preventDefault()});
ia.a.instance.ra(da.a.NC,ib.domElement,ib.v6);ib.IQd=ib.je.Td(ib.Qk);ib.IQd.ka("scroll",ib.onScroll);ib.xKj=pb.a(function(){ib.m0()},200,ib.$.la,Ha.a.Uwj,!0);ib.$.FC(B.a.DDj);ib.khf&&(ib.Dge=new l(ib.$,ib.VRa.domElement));X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&Xb.PageLoadTrackingInfo.instance.h7(B.a.HAa,["sheetTabBar"]);return ib}function e(Fb,ob,zb){ob=y.call(this,document.createElement("a"),ob)||this;ob.Cha=X.EwaSettings.ma(502)?oa.a.s9c:oa.a.luh;zb.lb(ob.domElement,
ra.a.instance.ga(716),0,ob.Cha,ra.a.instance.ga(716),Jb.a.S1c,!0);Fb.appendChild(ob.domElement);ob.zc.ka("contextmenu",function(ib){Ra.g(ib)});return ob}function h(Fb,ob,zb,ib,fc,Ic,Yc){var Mc=y.call(this,document.createElement("li"),Fb)||this;Mc.O1f=0;Mc.P1f=0;Mc.r1c=0;Mc.s1c=0;Mc.J4c=.5;Mc.CQd=!1;Mc.UU=!1;Mc.yO=null;Mc.GDb=null;Mc.mE=null;Mc.zHc=null;Mc.color=null;Mc.Mef=!1;Mc.Phc=!1;Mc.R5b="#BEBBB8";Mc.YEc=null;Mc.onKeyDown=function(xb){return 13!==xb.Ca.keyCode||Mc.disabled?!1:(Mc.activateSheet(1),
!0)};Mc.wz=function(xb){return 32!==xb.Ca.charCode||Mc.disabled?!1:(Mc.activateSheet(1),!0)};Mc.yN=function(){Mc.disabled||(Mc.cS.lTi(Mc),Mc.cS.cF||Mc.Fna(!0,void 0,"OnMouseOver"))};Mc.xN=function(){Mc.disabled||Mc.Fna(!1,void 0,"OnMouseOut")};Mc.Hya=function(){Mc.cS.cF||(Mc.XFj(),Mc.sheet.B7||Ab.g(Mc.$).rJb(Mc.sheet.sheetName));return!1};Mc.u6=function(){Mc.mLe(!1);return!1};Mc.Zc=function(xb){if(Mc.disabled)return!0;var wc=Ab.g(Mc.$);Mc.sheet.active||3!==xb.nb?Mc.fm?Mc.activateSheet(xb.nb):U.a.$qd()&&
wc.focus():(!U.a.VMa(Mc.$)&&!Mc.XAb||wc.isEditing||wc.vi||wc.Hsb(),Mc.activateSheet(xb.nb));return 3!==xb.nb};Mc.onPointerDown=function(xb){if(Mc.disabled)return!0;Mc.mLe(!0);Ab.g(Mc.$).inRangePicker&&P.ULS.sendTraceTag(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula).");var wc=3===xb.nb;if(2===xb.nb||wc&&Mc.exa)Mc.fm?(Mc.Fna(!0,!wc,"OnPointerDown"),wc=K.Task.delay(wc?Mc.P1f:Mc.O1f).Jo(function(){return!0})):wc=Mc.activateSheet(xb.nb),
Mc.uAb&&(Mc.Phc=!0,Mc.cS.wtc=G.TaskExtensions.Aa(wc,function(){Mc.Phc&&Mc.cS.nTi(Mc,xb)},Mc.la,11));return!1};Mc.Ff=function(xb){if(Mc.disabled||!Mc.uAb&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))return!0;var wc=Mc.cS.cF&&!U.a.eff();Mc.Phc=!1;Mc.fm&&Mc.Fna(2===xb.nb,void 0,"OnPointerUp");Mc.cS.wtc&&(G.TaskExtensions.Aa(Mc.cS.wtc,function(){Mc.cS.mTi(Mc)},Mc.la,11),Mc.cS.wtc=null);return wc};Mc.FN=function(){Mc.Phc=!1;Mc.CQd||Mc.Fna(!1,void 0,"OnTouchMove");
return!1};Mc.fze=new k(Mc,Fb);Mc.fm=Ic;Mc.kw=Yc;Mc.XAb=U.a.XAb(Fb);Mc.und=X.EwaSettings.isChangeGateEnabled("OfficeVSO:3843903_DelayLoadSheetViewIcon")&&!Mc.kw;Mc.fm?(Mc.O1f=Fb.ya.SheetDragReorderDelayInMilliseconds,Mc.P1f=Fb.ya.SheetDragReorderDelayInMillisecondsForTouch,Mc.r1c=18,Mc.s1c=20):(Mc.r1c=19,Mc.s1c=22);Mc.$=Fb;Mc.XWb=ib;Mc.cS=fc;Mc.uAb=fc.Bpe();Mc.Bah();Mc.x5g();Mc.kkd=Fb.Fb.Mg("UserAction",Mc.name);Mc.Bod=!1;La.DOMElementExtensions.iu(Mc.domElement,B.a.Ks,null,null);Mc.domElement.appendChild(Mc.anchor);
Mc.anchor.appendChild(Mc.mE);Mc.Kna=new Ia.a;Fb=new v(Mc.sheet,Mc.fm,Mc.kw);Mc.Kna.add(new n(Mc.$,Fb));Mc.$.ea.NLb&&(Fb=new m(Mc.sheet,Mc.fm,Mc.kw),Mc.Kna.add(new n(Mc.$,Fb)));Mc.und||(Fb=new f(Mc.sheet,Mc.cS.Wwc,function(){return Mc.color?h.LRd(Mc.color):!1},Mc.kw),Mc.GDb=new n(Mc.$,Fb),Mc.Kna.add(Mc.GDb));Mc.exa=Mc.cS.exa;Mc.Efb();Mc.F$i();Mc.vue=new Aa.a(Mc.domElement,1);ob.insertBefore(Mc.domElement,zb);ub.a(Mc.$)&&Mc.Aeg(!0);return Mc}function k(Fb,ob){var zb=Oa.call(this,Fb.domElement)||this;
zb.onKeyDown=function(ib){121===ib.keyCode&&ib.shiftKey&&!zb.Mna.disabled&&(zb.showContextMenu(new Sys.UI.Point(0,0),1,zb.Mna.anchor),Ra.g(ib))};zb.Bca=function(ib){if(!zb.$.isEditMode||zb.Mna.disabled)return!0;zb.rename(!1,ib.nb);return!0};zb.Il=function(ib){return zb.Mna.disabled?!0:zb.showContextMenu(ib.clientPoint,ib.nb,ib.yb)};zb.Ige=Fb;zb.$=ob;eb.a.instance.ra(da.a.$j,Fb.domElement,zb.Bca);lb.a.instance.ra(Fb.domElement,zb.Il);zb.zc.ka("keydown",zb.onKeyDown);return zb}function n(Fb,ob){var zb=
this;this.Aqa=this.G1=this.eBa=this.pl=null;this.Zff=!1;this.wRc=this.joa=this.Lsa=this.Mha=this.Ksa=null;this.yN=function(){zb.dataSource.aN()&&G.TaskExtensions.Aa(zb.pCb,function(){dialogControls.renderToolTip(zb.dataSource.ms(),"SheetIconTooltip",zb.dataSource.tWd(),zb.oI,10,!1,!1,1)},zb.$.la,3)};this.xN=function(){zb.dataSource.aN()&&zb.clearToolTip()};this.$=Fb;this.dataSource=ob;this.kw=U.a.mqd()}function f(Fb,ob,zb,ib){this.sheet=Fb;this.altText=ra.a.instance.ga(1895);this.rMj=ob;this.n3f=
zb;this.kw=ib}function v(Fb,ob,zb){this.fm=ob;this.kw=zb;this.sheet=Fb;this.altText=ra.a.instance.ga(1975)}function m(Fb,ob,zb){this.fm=ob;this.kw=zb;this.sheet=Fb;this.altText=ra.a.instance.ga(1976)}function x(Fb,ob,zb){var ib=y.call(this,document.createElement("a"),Fb,!0)||this;ib.sg=function(){ib.mX(!1);ib.$.ea.pn(ib.sg)};ib.Zc=function(fc){ib.B$f(fc.nb);return!0};ib.onKeyDown=function(fc){return 13===fc.Ca.keyCode||32===fc.Ca.keyCode?(ib.B$f(fc.nb),!0):!1};ib.wsa=ob.lb(ib.domElement,ra.a.instance.ga(516),
0,oa.a.Ush,ra.a.instance.ga(516),Jb.a.M2h,ib.disabled);ib.domElement.classList.add(w.Xsh);zb.appendChild(ib.domElement);ib.$.ea.jl(ib.sg);ib.r9i();return ib}function l(Fb,ob){var zb=$a.call(this,document.createElement("div"))||this;zb.pR=function(){P.ULS.sendTraceTag(537153794,0,50,"SheetDropdownMenu.OnSheetsChanges");zb.SRf(!1,"OnSheetsChanged")};zb.FKi=function(){zb.Pi()};zb.EKi=function(){zb.Tj()};zb.$=Fb;zb.sJj=ob;zb.UU=!1;zb.YNb=0;return zb}function u(Fb,ob){this.sheetName=null;this.newSheetIndex=
0;this.sheetName=Fb;this.newSheetIndex=ob}function A(Fb,ob,zb){var ib=y.call(this,document.createElement("a"),ob)||this;ib.Zc=function(fc){ib.$.Cd(-684145703,fc.nb,0,null);return!0};ib.jFb=function(fc){cb.HelperMethods.jWd(ib.lve,ib.Cha,ib.Cha+B.a.Aec,("mouseover"===fc.type||"focus"===fc.type)&&!Ab.g(ib.$).inRangePicker)};ib.$=ob;ib.Cha=X.EwaSettings.ma(502)?oa.a.s9c:oa.a.ePe;ib.lve=zb.lb(ib.domElement,ra.a.instance.ga(514),0,ib.Cha,ra.a.instance.ga(515),Jb.a.S1c);Fb.appendChild(ib.domElement);ib.zc.ka("contextmenu",
function(fc){Ra.g(fc)});ib.zc.ka("mouseover",ib.jFb);ib.zc.ka("mouseout",ib.jFb);eb.a.instance.ra(da.a.click,ib.domElement,ib.Zc);ib.bNa=va.KeyInputManager.instance.ds(ib.domElement,ib.Zc,yb.a.Qh,yb.a.l1);return ib}function z(Fb,ob,zb,ib){ib=void 0===ib?!1:ib;var fc=y.call(this,document.createElement("a"),ob,ib)||this;fc.Zc=function(Ic){fc.disabled||fc.$.Cd(-1935155518,Ic.nb,30,null);return!0};fc.jFb=function(Ic){Ic="mouseover"===Ic.type||"focus"===Ic.type;var Yc=ub.a(fc.$)?fc.jab:fc.wsa;cb.HelperMethods.jWd(Yc,
fc.Cha,fc.Cha+B.a.Aec,Ic&&!Ab.g(fc.$).inRangePicker)};fc.Fh=function(){fc.mX(!0)};fc.Ef=function(){fc.mX(!1)};fc.Cha=X.EwaSettings.ma(502)?oa.a.s9c:oa.a.ePe;fc.wsa=zb.lb(fc.domElement,ra.a.instance.ga(512),0,fc.Cha,ra.a.instance.ga(513),Jb.a.S1c,ib);Fb.appendChild(fc.domElement);fc.zc.ka("contextmenu",function(Ic){Ra.g(Ic)});X.EwaSettings.ma(502)||(fc.zc.ka("mouseover",fc.jFb),fc.zc.ka("mouseout",fc.jFb));eb.a.instance.ra(da.a.click,fc.domElement,fc.Zc);fc.bNa=va.KeyInputManager.instance.ds(fc.domElement,
fc.Zc,yb.a.Qh,yb.a.l1);X.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&(Ab.g(fc.$).$b.Ak(fc.Fh),Ab.g(fc.$).$b.um(fc.Ef));return fc}function y(Fb,ob,zb){zb=void 0===zb?!1:zb;Fb=oc.call(this,Fb)||this;Fb.wsa=null;Fb.jab=null;Fb.$=ob;Fb.IX=zb;return Fb}function w(){}function D(){this.nIe=new pa.a(!0);this.NHc=0}function H(Fb){return L.call(this,Fb)||this}function F(Fb){this.zjh=Fb}var J=b(10),S=b(0),N=b(915),T=b(50),G=b(37),I=b(187),K=b(58);F.prototype.Nc=function(){return!1};
F.prototype.executeCommand=function(Fb,ob){Fb=ob.command;ob=null;switch(Fb){case 1243860697:this.zjh.bMj();break;default:ob=I.a(Fb)}return ob||K.Task.Ua(!0)};F.prototype.Ac=function(Fb,ob){return 1243860697===ob.command};F.prototype.Tc=function(){return!1};Object(S.a)(F,"SheetDropdownMenuCommandHandler",null,[401]);var L=N.a;$k(H,L);H.prototype.zd=function(){var Fb=this;this.$.bB(function(ob){ob.Wec().then(function(){G.TaskExtensions.Aa(T.GetServiceTaskFactory.Ra(Fb.$.da,32,33,Fb.hb),function(zb){Fb.jd([new F(zb.result.Nwj)])},
Fb.$.la)})})};H.ka=function(Fb){N.a.Pd(392,new H(Fb))};Object(S.a)(H,"SheetDropdownMenuCommandHandlerFactory",N.a,[]);var O=b(235),B=b(5),Q=b(78),U=b(36),X=b(1),P=b(15),ea=b(27),ia=b(199),da=b(13),xa=b(87),Z=b(44),ha=b(249),ya=b(161),va=b(109),bb=b(39),ba=b(445),fa=b(85),ra=b(14),pa=b(34);D.prototype.KLg=function(Fb,ob){this.nIe.add(Fb,ob);this.sS()};D.prototype.sS=function(){var Fb=this;this.NHc=0;pa.a.forEach(this.nIe.au,function(ob){Fb.NHc=Fb.z6c|ob.value})};of.Object.defineProperties(D.prototype,
{z6c:{configurable:!0,enumerable:!0,get:function(){return this.NHc}},navigationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!(this.z6c&1)}},operationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!(this.z6c&2)}}});Object(S.a)(D,"SheetTabBarDisabledStateManager",null,[]);var Za=b(248),Ua=b(30);w.nth="ewa-stb-uir";w.jOe="ewa-stb-drag";w.Ysh="ewa-stb-navarea";w.Zsh="ewa-stb-navarea-dimensions";w.ath="ewa-stb-navbutton";w.qU="cui-disabled";w.$sh="ewa-stb-navareaextra";
w.iia="cui-img-container";w.Vsh="ewa-stb-contentarea";w.kOe="ewa-stb-left-scrollable";w.vOe="ewa-stb-right-scrollable";w.lth="ewa-stb-tabarea";w.kth="ewa-stb-sheettabmoveindicator";w.xOe="ewa-stb-tabs";w.LIj="tab-active";w.TIj="tab-inactive";w.SIj="tab-hover";w.mth="ewa-stb-tabs-ghost";w.NIj="tab-anchor-text";w.dark="dark";w.light="light";w.MIj="tab-active-text";w.QIj="tab-content-container";w.VIj="tab-text";w.dth="ewa-stb-nsv-inactive";w.eth="ewa-stb-nsv-inactive-svg";w.bth="ewa-stb-nsv-active";
w.cth="ewa-stb-nsv-active-svg";w.Krh="ewa_nsv_margin";w.Wsh="ewa-stb-disable-scrollbar";w.Zsi="leave-size-fixed-on-tab-hover-old";w.Ysi="leave-size-fixed-on-tab-hover";w.oOe="ewa-stb-locked-sheet";w.pOe="ewa-stb-locked-sheet-svg-16px";w.Xsh="ewa-stb-dropdown-menu-button";w.Jnh="ewa-active-sheet-menu-item";Object(S.a)(w,"CssClassNames",null,[]);var Ma=b(627),oa=b(19),ja=b(274),ta=b(103),aa=b(572),ma=b(177),Ea=b(257),Ha=b(45),Aa=b(302),V=b(53),La=b(12),Ra=b(69),pb=b(333),cb=b(11),Sa=b(101),Db=b(363),
Ab=b(21),Wb=b(200),ub=b(395),vb=b(392),Ka=b(43),eb=b(236),yb=b(86),oc=Za.a;$k(y,oc);y.prototype.dispose=function(){this.jab=this.wsa=this.$=null;oc.prototype.dispose.call(this)};y.prototype.mX=function(Fb){this.IX=Fb;this.domElement.setAttribute(B.a.dsa,Fb.toString());La.DOMElementExtensions.toggleCssClass(this.domElement,Ma.a.qU,Fb)};of.Object.defineProperties(y.prototype,{disabled:{configurable:!0,enumerable:!0,get:function(){return this.IX}}});Object(S.a)(y,"SheetBarButton",Za.a,[]);var Jb=b(931);
$k(z,y);z.prototype.dispose=function(){eb.a.instance.Ba(da.a.click,this.domElement,this.Zc);va.KeyInputManager.instance.sv(this.domElement,this.bNa);X.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&Ab.g(this.$)&&Ab.g(this.$).$b&&(Ab.g(this.$).$b.vk(this.Fh),Ab.g(this.$).$b.Nl(this.Ef));y.prototype.dispose.call(this)};z.prototype.mX=function(Fb){var ob=z.q2f(this.$);y.prototype.mX.call(this,Fb||ob)};z.q2f=function(Fb){return!Fb.isEditMode||!Fb.xa.count};Object(S.a)(z,
"InsertSheetButton",y,[]);$k(A,y);A.prototype.dispose=function(){eb.a.instance.Ba(da.a.click,this.domElement,this.Zc);va.KeyInputManager.instance.sv(this.domElement,this.bNa);this.lve=null;y.prototype.dispose.call(this)};Object(S.a)(A,"InsertTemplateButton",y,[]);u.prototype.getSheetName=function(){return this.sheetName};Object(S.a)(u,"MacroRecorderSheetReorderedPayload",null,[430]);var dc=b(91),$a=Za.a;$k(l,$a);l.prototype.dispose=function(){this.Tj();$a.prototype.dispose.call(this)};l.prototype.bMj=
function(){this.SRf(!0,"TogglerSheetDropdownMenu")};l.prototype.SRf=function(Fb,ob){P.ULS.sendTraceTag(537153795,0,50,"SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: "+ob+", toggle: "+Fb+", toggleStateId: "+this.YNb);Fb&&(this.YNb+=1);var zb=this.$.Fb.sc("UserAction","SheetDropdownMenu.RenderSheetMenuInternal: caller: "+ob+", toggle: "+Fb+", toggleStateId: "+this.YNb+", sheetCount: "+this.$.xa.count);Fb=this.qah();appChrome.renderSheetDropdownMenu(this.domElement,this.sJj,Fb,this.YNb,
this.FKi,this.EKi,function(){zb.stop()},ub.a(this.$))};l.prototype.qah=function(){for(var Fb=this.$.xa,ob=[],zb=0;zb<Fb.count;zb++){var ib=Object(fa.a)(Sa.a,Fb.getItem(zb));0===ib.uy&&(ib=this.pah(ib),ob.push(ib))}return ob};l.prototype.pah=function(Fb){var ob={};ob.key=Fb.name;ob.text=Fb.name;ob.onClick=this.rah(Fb);Fb.active&&(ob.className=ub.a(this.$)?"ewa-active-sheet-menu-item-present-mode":w.Jnh);return ob};l.prototype.rah=function(Fb){var ob=this;return function(){var zb=new dc.a(-1876836819,
0,ob.$.Jc,30,null),ib={};ob.$.Ka.Kb(zb,(ib[B.a.EQd]=Fb.name,ib))}};l.prototype.Pi=function(){if(!this.UU){var Fb=this.$.xa;Fb.Mf(this.pR);Fb.ZUc(this.pR);Fb.pY(this.pR);Fb.Uga(this.pR);Fb.SFa(this.pR);Fb.Jne(this.pR);Fb.NYa(this.pR);this.UU=!0}};l.prototype.Tj=function(){if(this.UU){var Fb=this.$.xa;Fb.ug(this.pR);Fb.fJd(this.pR);Fb.e7(this.pR);Fb.Vma(this.pR);Fb.qQa(this.pR);Fb.SQf(this.pR);Fb.NIb(this.pR);this.UU=!1}};Object(S.a)(l,"SheetDropdownMenu",Za.a,[524,6]);var Ba=b(371);$k(x,y);x.prototype.dispose=
function(){this.KQj();y.prototype.dispose.call(this)};x.prototype.mX=function(Fb){y.prototype.mX.call(this,Fb||!this.$.ea.Bwa)};x.prototype.B$f=function(Fb){this.disabled||(P.ULS.sendTraceTag(537153793,0,50,"SheetDropdownMenuAnchor.ToggleMenu: inputMethod: "+Ba.a[Fb]),this.$.Ka.Kb(new dc.a(1243860697,Fb,this.$.Jc,30,null)))};x.prototype.r9i=function(){eb.a.instance.ra(da.a.click,this.domElement,this.Zc);va.KeyInputManager.instance.ra(da.a.Lb,this.domElement,this.onKeyDown)};x.prototype.KQj=function(){eb.a.instance.Ba(da.a.click,
this.domElement,this.Zc);va.KeyInputManager.instance.Ba(da.a.Lb,this.domElement,this.onKeyDown)};Object(S.a)(x,"SheetDropdownMenuAnchor",y,[]);var la=b(62),ka=b(209),ca=b(130),Ia=b(192),jb=b(133),nb=b(59),Na=b(220),sa=b(208),Wa=b(173),Hb=b(134);m.prototype.aN=function(){return this.sheet.active};m.prototype.Cod=function(){return this.sheet.isLockPausedInSession};m.prototype.Ksa=function(){return this.fm?oa.a.nOe:this.aN()?oa.a.mOe:oa.a.lOe};m.prototype.joa=function(){return this.sheet.fj?Jb.a.hKf:
Jb.a.wQj};m.prototype.UUd=function(){return 16};m.prototype.Mha=function(){return null};m.prototype.Lsa=function(){return this.fm?this.kw?w.pOe:w.oOe:null};m.prototype.tWd=function(){return null};m.prototype.ms=function(){return null};m.prototype.Jkd=function(){return 0};m.prototype.zWc=function(){return!0};Object(S.a)(m,"LockPausedSheetIconDataSource",null,[536]);v.prototype.aN=function(){return this.sheet.active};v.prototype.Cod=function(){return this.sheet.fj};v.prototype.Ksa=function(){return this.fm?
oa.a.nOe:this.aN()?oa.a.mOe:oa.a.lOe};v.prototype.joa=function(){return Jb.a.hKf};v.prototype.UUd=function(){return 16};v.prototype.Mha=function(){return null};v.prototype.Lsa=function(){return this.fm?this.kw?w.pOe:w.oOe:null};v.prototype.tWd=function(){return null};v.prototype.ms=function(){return null};v.prototype.Jkd=function(){return 0};v.prototype.zWc=function(){return!0};Object(S.a)(v,"LockedSheetIconDataSource",null,[536]);f.prototype.aN=function(){return this.sheet.active};f.prototype.Cod=
function(){return this.sheet.Kd.Ux};f.prototype.Mha=function(){return this.kw?this.aN()?w.cth:w.eth:this.aN()?w.bth:w.dth};f.prototype.Ksa=function(){return!this.aN()&&this.n3f()?oa.a.Uuh:oa.a.Tuh};f.prototype.joa=function(){return!this.aN()&&this.n3f()?Jb.a.Xwj:Jb.a.Wwj};f.prototype.UUd=function(){return 14};f.prototype.Lsa=function(){return w.Krh};f.prototype.tWd=function(){return this.sheet.Kd.Xmb};f.prototype.ms=function(){return this.rMj};f.prototype.Jkd=function(){return 8};f.prototype.zWc=
function(){return!1};Object(S.a)(f,"NamedSeetViewSheetIconDataSource",null,[536]);var Yb=b(162),Sb=b(129);n.prototype.Kdg=function(){if(this.oI&&(this.pl||this.eBa)){if(this.kw){var Fb=this.dataSource.joa();this.joa!==Fb&&(this.eBa&&this.eBa.parentNode.removeChild(this.eBa),this.iaf(),this.joa=Fb)}else Fb=this.dataSource.Ksa(),this.Ksa!==Fb&&(this.mKd(this.pl,this.Ksa,Fb),this.Ksa=Fb);Fb=this.dataSource.Mha();this.Mha!==Fb&&(this.kw?this.lfj(this.eBa,this.Mha,Fb):this.mKd(this.pl,this.Mha,Fb),this.Mha=
Fb);Fb=this.dataSource.Lsa();this.Lsa!==Fb&&(this.mKd(this.oI,this.Lsa,Fb),this.Lsa=Fb);this.dataSource.ms()&&!this.dataSource.aN()&&this.clearToolTip()}};n.prototype.xBj=function(Fb,ob,zb){this.mci(Fb,ob,zb);La.DOMElementExtensions.setVisible(this.oI,this.dataSource.Cod())};n.prototype.clearToolTip=function(){var Fb=this;G.TaskExtensions.Aa(this.pCb,function(){dialogControls.clearToolTip(Fb.dataSource.ms())},this.$.la,3)};n.prototype.mci=function(Fb,ob,zb){this.oI&&this.Zff!==Fb&&(this.oI.parentNode.removeChild(this.oI),
this.Lsa=this.Mha=this.joa=this.Ksa=this.wRc=null,this.dataSource.ms()&&(this.zc.detach("mouseover",!0),this.zc.detach("mouseout",!0)));this.oI||(this.wRc=document.createElement("span"),Sys.UI.DomElement.addCssClass(this.oI,Ma.a.iia),Sys.UI.DomElement.addCssClass(this.oI,oa.a.HA),X.EwaSettings.ma(502)?Fb===this.dataSource.zWc()?ob.appendChild(this.oI):ob.insertBefore(this.oI,zb):Fb?ob.insertBefore(this.oI,zb):ob.appendChild(this.oI),this.kw?this.iaf():(this.pl=document.createElement("img"),this.pl.tabIndex=
-1,this.pl.alt=this.dataSource.altText,this.oI.appendChild(this.pl),this.pl.src=V.a.df(this.dataSource.Jkd())),this.dataSource.ms()&&(this.zc.ka("mouseover",this.yN,!0),this.zc.ka("mouseout",this.xN,!0)),this.Zff=Fb)};n.prototype.lfj=function(Fb,ob,zb){Fb&&(Sys.UI.DomElement.removeCssClass(Fb,ob),Sys.UI.DomElement.addCssClass(Fb,zb))};n.prototype.mKd=function(Fb,ob,zb){ob&&Sys.UI.DomElement.removeCssClass(Fb,ob);zb&&Sys.UI.DomElement.addCssClass(Fb,zb)};n.prototype.dispose=function(){xa.a.Ia(this.G1)};
n.prototype.iaf=function(){var Fb=this.$.da.za(388);Fb?(this.eBa=Fb.Cva(this.dataSource.joa(),this.dataSource.UUd()))?this.oI.appendChild(this.eBa):P.ULS.shipAssertTag(537153763,0,!1,"Sheeticon.InsertCurrentSvgIcon: Svg with id "+this.dataSource.joa()+" was not found."):P.ULS.shipAssertTag(537153792,0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to recieve SvgIconProvider service.")};of.Object.defineProperties(n.prototype,{zc:{configurable:!0,enumerable:!0,get:function(){return this.G1||(this.G1=Sb.a.instance.Td(this.oI))}},
pCb:{configurable:!0,enumerable:!0,get:function(){var Fb=this;if(this.Aqa)return this.Aqa;var ob=new Yb.a;this.$.bB(function(zb){G.TaskExtensions.Aa(zb.Atd(),function(){ob.setResult(!0)},Fb.$.la,3)});return this.Aqa=ob.task}},oI:{configurable:!0,enumerable:!0,get:function(){return this.wRc}}});Object(S.a)(n,"SheetIcon",null,[6]);var lb=b(372),wb=b(94),wa=b(159),Oa=wb.a;$k(k,Oa);k.prototype.dispose=function(){this.Mna&&(eb.a.instance.Ba(da.a.$j,this.Mna.domElement,this.Bca),lb.a.instance.Ba(this.Mna.domElement,
this.Il),this.Ige=null);this.$=null;Oa.prototype.dispose.call(this)};k.prototype.showContextMenu=function(Fb,ob,zb){this.Mna.activate(ob,U.a.$qd());ob=new dc.a(-1075099431,ob,this.$.Jc,30,null);var ib,fc={};return!wa.a(ib=this.$.Ka.Kb(ob,(fc[B.a.S1f]=Fb,fc[k.Owj]=this.Mna.sheet,fc[B.a.T1f]=zb,fc)))&&(6!==ib.status||ib.result)};k.prototype.rename=function(Fb,ob){this.$.Cd(817296323,ob,Fb?19:0,null)};of.Object.defineProperties(k.prototype,{Mna:{configurable:!0,enumerable:!0,get:function(){return this.Ige}}});
k.Owj="Sheet";Object(S.a)(k,"SheetOpsSheetClickHelper",wb.a,[]);var Ub=b(42);$k(h,y);h.prototype.WPh=function(){return La.DOMElementExtensions.canReceiveFocus(this.anchor)?this.anchor:null};h.prototype.dispose=function(){if(this.UU){ha.a.instance.Ba(da.a.pointerDown,this.domElement,this.onPointerDown);va.KeyInputManager.instance.Ba(da.a.Lb,this.domElement,this.onKeyDown);va.KeyInputManager.instance.Ba(da.a.Yo,this.domElement,this.wz);eb.a.instance.Ba(da.a.click,this.domElement,this.Zc);ha.a.instance.Ba(da.a.iW,
this.domElement,this.Hya);ha.a.instance.Ba(da.a.jy,this.domElement,this.u6);if(this.uAb||X.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))ha.a.instance.Ba(da.a.Hf,this.domElement,this.Ff),this.exa&&(ya.a.instance.Ba(da.a.oe,this.domElement,this.Ff),ya.a.instance.Ba(da.a.Vf,this.domElement,this.FN));this.UU=!1;this.R5b="#BEBBB8"}xa.a.oc([this.fze,this.vue]);this.yO=this.mE=this.YEc=this.cS=this.vue=this.fze=null;if(this.Kna){for(var Fb=ik(this.Kna),ob=Fb.next();!ob.done;ob=
Fb.next())ob.value.dispose();this.Kna=null}this.color=this.XWb=null;y.prototype.dispose.call(this)};h.prototype.mX=function(Fb){Fb&&this.Fna(!1,!1);y.prototype.mX.call(this,Fb)};h.prototype.sSd=function(Fb){if(nb.a.pg.VQ){this.vIe();var ob=T.GetServiceTaskFactory.Ra(this.$.da,322,323,1);G.TaskExtensions.Aa(ob,function(zb){ka.UISurfaces.zQ().then(function(ib){var fc=zb.result;fc.Vsj(ib);fc.show(Fb);return null},function(ib){P.ULS.sendTraceTag(537153688,0,15,"SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: "+
ib);return null})},this.la,3)}};h.prototype.jme=function(){var Fb=this;if(this.sheet.active&&this.$.Sq){var ob=this.$.Sq,zb=Ab.g(this.$),ib=zb.ek;if(this.sheet.Kd.Ux){if(!this.GDb){var fc=new f(this.sheet,this.cS.Wwc,function(){return Fb.color?h.LRd(Fb.color):!1},this.kw);this.GDb=new n(this.$,fc);this.Kna.add(this.GDb)}ib?zb.ufb(1):ob.classList.add(oa.a.JQe);ob=h.qfd(B.a.Hrf);zb=h.qfd(B.a.nxd);ib=h.qfd(B.a.yrf);fc=this.sheet.Kd.xRd;this.sheet.Kd.xRd=!1;"true"===ib&&fc&&this.$.ea.ARd?(ca.a.Kw(B.a.yrf,
"false",ca.a.RV),this.$.ea.ARd=!1,this.sSd(3)):"true"===ob&&"true"===zb&&"true"===ib?this.$.ea.BRd&&this.$.ea.gMb&&(this.sheet.Kd.eK?(ob=1,ca.a.Kw(B.a.nxd,"false",ca.a.RV),this.$.ea.gMb=!1):ob=0,ca.a.Kw(B.a.Hrf,"false",ca.a.RV),this.$.ea.BRd=!1,this.sSd(ob)):this.sheet.Kd.eK&&"true"===zb&&"true"===ib&&this.$.ea.gMb&&(ca.a.Kw(B.a.nxd,"false",ca.a.RV),this.$.ea.gMb=!1,this.sSd(2))}else this.vIe(),ib?zb.ufb(0):ob.classList.remove(oa.a.JQe)}};h.prototype.vIe=function(){if(X.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC")){var Fb=
this.$.da.za(322);Fb&&Fb.dismiss()}else this.$.Jqd&&(Fb=T.GetServiceTaskFactory.Ra(this.$.da,322,323,0),G.TaskExtensions.Aa(Fb,function(ob){ob.result.dismiss()},this.$.la,3))};h.prototype.Efb=function(){this.name=this.sheet.name;this.domElement.className=this.sheet.active||this.O6a()?w.LIj:w.TIj;X.EwaSettings.isChangeGateEnabled("OfficeVSO:5262355_SheetTabFocusBugFix")?this.yO.parentNode.classList.add(w.Ysi):this.yO.parentNode.classList.add(w.Zsi);this.Beg();this.und&&this.jme();this.yBj();this.Heg();
this.CBc();this.und||this.jme()};h.prototype.jTi=function(){this.CQd=!0;this.Fna(!0,!0,"OnSheetReorderStarted")};h.prototype.iTi=function(){this.CQd=!1;this.Fna(!1,void 0,"OnSheetReorderEnded")};h.prototype.activate=function(Fb,ob){Fb=void 0===Fb?0:Fb;ob=void 0===ob?!1:ob;this.F2b()||(this.sheet.activate(),ob&&Ab.g(this.$).focus(),ob={},Fb=(ob.InputMethod=Ba.a[Fb],ob.AppMode=this.$.Jc,ob.Location="canvas",ob),Hb.b(this.$).yd(jb.a.Kwj,Fb))};h.prototype.Aeg=function(Fb){this.R5b=Fb?"#797775":"#BEBBB8";
this.J4c=Fb?-.5:.5;this.zHc=Fb?sa.a.Po("#3B3A39"):sa.a.Po("#F5F5F5");this.Heg()};h.prototype.Qpj=function(Fb){this.uAb=Fb};h.prototype.Qzd=function(Fb){Fb.g2c();this.Cxe(Fb)};h.prototype.Cxe=function(Fb){Fb.t0a();this.sheet.activate()};h.prototype.SAg=function(Fb){Fb=new dc.a(-1876836819,Fb,this.$.Jc,30,null);var ob={};return this.$.Ka.Kb(Fb,(ob[B.a.EQd]=this.sheet.name,ob))};h.prototype.Beg=function(){this.yO.parentNode.setAttribute("sheet-title",this.yO.innerText)};h.prototype.CBc=function(){var Fb=
this.zJh();this.anchor.setAttribute(B.a.Ft,Fb);this.anchor.setAttribute(B.a.hha,this.sheet.active.toString())};h.prototype.zJh=function(){var Fb=this.sheet.Kd.Ux,ob=this.sheet.Kd.Xmb,zb=this.sheet.fj,ib=this.sheet.isLockPausedInSession;return Fb&&zb?String.format(ra.a.instance.mb(20),this.name,ob):Fb&&ib?String.format(ra.a.instance.mb(22),this.name,ob):Fb?String.format(ra.a.instance.mb(19),this.name,ob):zb?String.format(ra.a.instance.mb(18),this.name):ib?String.format(ra.a.instance.mb(21),this.name):
this.name};h.prototype.activateSheet=function(Fb){Fb=void 0===Fb?0:Fb;if(U.a.$qd()){if(X.EwaSettings.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&this.F2b())return K.Task.Ua(!1);Wa.a.current.UW="ActivateSheet";this.sheet.activate();return K.Task.Ua(!0)}return this.SAg(Fb)};h.prototype.Heg=function(){var Fb=this.sheet.tabColor;this.color=Fb?sa.a.Po(Fb):this.beh;this.Mef=h.LRd(this.color);this.Fna(!1,void 0,"UpdateTabColor")};h.prototype.Fna=function(Fb,ob,zb){ob=void 0===
ob?!1:ob;zb=void 0===zb?null:zb;if(this.sheet){zb=this.sheet.active;var ib=this.O6a(),fc=!!this.sheet.tabColor,Ic=sa.a.UF(zb||ib?Na.a.white:this.color);this.mE.style.background="";zb||ib?(fc?X.EwaSettings.isChangeGateEnabled("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&this.$.mLa?this.Nuj():this.fm?this.Muj():this.Luj():this.fm||(this.mE.style.backgroundColor=Ic),this.mE.style.height=this.r1c.toString()+"px"):(this.mE.style.filter="",this.mE.style.backgroundColor=Ic,this.mE.style.height=
this.s1c.toString()+"px");this.yO.className=zb?w.MIj:ib?w.dark:this.Mef?w.light:w.dark;Ic=ik(this.Kna);for(var Yc=Ic.next();!Yc.done;Yc=Ic.next())Yc.value.Kdg();this.fm&&(Fb&&!fc&&(this.mE.style.backgroundColor="#E1DFDD"),La.DOMElementExtensions.toggleCssClass(this.domElement,w.SIj,Fb),ob?(fc||(this.mE.style.backgroundColor=this.R5b),this.domElement.style.backgroundColor=this.R5b):(fc||(this.mE.style.backgroundColor=""),this.domElement.style.backgroundColor=""));this.yO.style.fontWeight=zb||ib||!this.fm&&
Fb?this.fm?"600":"bold":""}else P.ULS.sendTraceTag(537153687,0,15,"SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, whihc means its not rendered. caller: "+zb)};h.prototype.Muj=function(){var Fb=this.mE.style,ob=sa.a.UF(h.I_c(this.color,this.J4c));Fb.background=ob};h.prototype.Luj=function(){var Fb=this.mE.style,ob=sa.a.UF(h.I_c(this.color,1)),zb=sa.a.UF(h.I_c(this.color,this.J4c));Fb.background="$linear-gradient("+ob+", "+zb+")"};h.prototype.Nuj=function(){this.mE.style.background=
"transparent"};h.prototype.x5g=function(){this.YEc=document.createElement("a");this.anchor.removeAttribute("Href");this.anchor.className=w.NIj;La.DOMElementExtensions.iu(this.anchor,B.a.Cob,null,null);this.tabIndex=-1};h.prototype.Bah=function(){this.mE=document.createElement("span");this.mE.className=w.QIj;this.yO=document.createElement("span");this.yO.className=w.VIj;this.yO.dir=this.sheet.rtlName?"rtl":"ltr";this.mE.appendChild(this.yO)};h.prototype.yBj=function(){for(var Fb=this.$.cJ,ob=ik(this.Kna),
zb=ob.next();!zb.done;zb=ob.next())zb.value.xBj(Fb,this.mE,this.yO)};h.prototype.O6a=function(){return Ab.g(this.$).O6a(this.sheet)};h.prototype.XFj=function(){this.kkd.start();this.Bod=!0};h.prototype.mLe=function(Fb){if(this.Bod){this.kkd.stop();var ob={};Fb=(ob["Sheet index"]=this.sheet.index,ob["Active Sheet"]=this.sheet.active,ob["Hovering time"]=this.kkd.qc,ob["Has been clicked"]=Fb,ob);P.ULS.sendTraceTag(537153686,0,50,Ub.c(Fb));this.Bod=!1}};h.prototype.F$i=function(){ha.a.instance.ra(da.a.pointerDown,
this.domElement,this.onPointerDown);va.KeyInputManager.instance.ra(da.a.Lb,this.domElement,this.onKeyDown);va.KeyInputManager.instance.ra(da.a.Yo,this.domElement,this.wz);this.zc.ka("mouseover",this.yN);this.zc.ka("mouseout",this.xN);ha.a.instance.ra(da.a.iW,this.domElement,this.Hya);ha.a.instance.ra(da.a.jy,this.domElement,this.u6);if(this.uAb||X.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))ha.a.instance.ra(da.a.Hf,this.domElement,this.Ff),this.exa&&(ya.a.instance.ra(da.a.oe,
this.domElement,this.Ff),ya.a.instance.ra(da.a.Vf,this.domElement,this.FN));eb.a.instance.ra(da.a.click,this.domElement,this.Zc);this.UU=!0};h.prototype.F2b=function(){var Fb=this.$.da.za(65);return Fb&&Fb.Aba()?(Fb.dKb(),this.Cxe(Fb),!0):!1};h.qfd=function(Fb){var ob=ca.a.get(Fb);ob||(ca.a.Kw(Fb,"true",ca.a.RV),ob=ca.a.get(Fb));return ob};h.I_c=function(Fb,ob){if(1<ob||-1>ob)return Fb;var zb=Fb.r,ib=Fb.g;Fb=Fb.b;0<ob?(zb=zb*(1-ob)+255*ob,ib=ib*(1-ob)+255*ob,Fb=Fb*(1-ob)+255*ob):(zb*=1+ob,ib*=1+ob,
Fb*=1+ob);return Na.a.Nub(Math.round(zb),Math.round(ib),Math.round(Fb))};h.LRd=function(Fb){return 128>=(222*Fb.r+707*Fb.g+71*Fb.b)/1E3};of.Object.defineProperties(h.prototype,{beh:{configurable:!0,enumerable:!0,get:function(){return this.zHc||(this.zHc=sa.a.Po("#F5F5F5"))}},name:{configurable:!0,enumerable:!0,get:function(){return this.yO.innerText},set:function(Fb){this.yO&&(this.yO.innerText=Fb,this.CBc(),this.Beg())}},sheet:{configurable:!0,enumerable:!0,get:function(){return this.XWb}},anchor:{configurable:!0,
enumerable:!0,get:function(){return this.YEc}},tabIndex:{configurable:!0,enumerable:!0,get:function(){return this.anchor.tabIndex},set:function(Fb){this.anchor.tabIndex=Fb}}});Object(S.a)(h,"SheetTabButton",y,[]);$k(e,y);Object(S.a)(e,"WorkbookProtectionButton",y,[]);var hb=b(51),Xb=b(46),Gc=b(57),uc=Za.a;$k(d,uc);d.prototype.lb=function(Fb,ob,zb,ib,fc,Ic,Yc){Yc=void 0===Yc?!1:Yc;Fb.removeAttribute("Href");Fb.setAttribute(B.a.Gd,B.a.Js);Fb.className=w.ath;Fb.title=ob;Fb.tabIndex=0;this.kw&&Ic?zb=
this.svgIconProvider.vba(Ic,12,12,Fb,24,24):(ob=document.createElement("span"),ob.className=this.fm?oa.a.h_g:oa.a.HA,ob.classList.add(Ma.a.iia),ob.tabIndex=-1,Fb.appendChild(ob),Ic=document.createElement("img"),Ic.src=V.a.df(zb),Ic.className=ib,Ic.alt=fc,Ic.tabIndex=-1,ob.appendChild(Ic),zb=Ic);Yc&&Fb.classList.add(Ma.a.qU);return zb};d.prototype.dispose=function(){if(this.$){var Fb=this.$.xa;Fb.ug(this.wh);Fb.fJd(this.wya);Fb.e7(this.VC);Fb.Vma(this.DFb);Fb.qQa(this.Qya);Fb.SQf(this.jDf);Fb.NIb(this.lDf);
Fb.Wcj(this.kDf);Fb.sJd(this.Vtf);Fb.PQf(this.Wtf);Fb.QQf(this.Xtf);Fb.RQf(this.IOa);this.$.sl(this.Yc);this.$.iD(this.Ni);Ka.a(this.$)&&Ka.a(this.$).Tf.tda(this.pF);this.Lta&&Ab.g(this.$).sQf(this.KEb);ia.a.instance.Ba(da.a.NC,this.domElement,this.v6)}xa.a.oc(this.xxd);this.xxd=null;if(this.sK)for(Fb=0;Fb<this.sK.length;Fb++){var ob=La.DOMElementExtensions.QJ(this.sK[Fb],this.domElement,!1,"a");ob&&Z.a.Oma(ob)}xa.a.Ia(this.aC);xa.a.Ia(this.$wc);xa.a.Ia(this.IQd);this.IQd=this.$wc=this.Eyb=this.rH=
this.aC=null;this.$&&this.mz&&this.hQ(!1);this.laa=null;this.DOd(null,"Dispose");this.qNb=this.uM=this.K7b=null;this.I0c();this.mdb=this.axc=this.JQd=this.Qk=this.sK=this.$=this.ea=null;uc.prototype.dispose.call(this)};d.prototype.Uf=function(Fb,ob){if(!ob){P.ULS.shipAssertTag(537153760,0,0<this.mh.length,"There is no sheet tab button.");if(!this.mh.length)return!1;Fb=null;for(var zb=ik(this.mh),ib=zb.next();!ib.done&&!(Fb=ib.value.WPh());ib=zb.next());if(!Fb)return P.ULS.shipAssertTag(537153759,
0,!1,"There is no focusable tab element."),!1;La.DOMElementExtensions.setFocus(Fb)}return!ob};d.prototype.ah=function(Fb){return La.DOMElementExtensions.nf(this.hc,Fb)};d.prototype.ej=function(){};d.prototype.Dj=function(){};d.prototype.reorderSheets=function(Fb,ob,zb){if(this.L_&&this.L_!==Fb){var ib=this.L_.index;this.bfj(this.L_,Fb,ob);Fb=Fb?Fb.index-1:ob?this.$.xa.count-1:0;ib!==Fb&&(this.ixi(ib,Fb,zb),this.gmh(this.L_.name,Fb))}};d.prototype.V0h=function(Fb){Fb=this.Via(Fb);return-1!==Fb&&this.Ku<=
Fb&&Fb<=this.hK?this.mh[Fb].domElement:null};d.prototype.XUj=function(Fb){if(this.kw){for(var ob=0;ob<this.sK.length;ob++){var zb=this.sK[ob];if(zb&&this.svgIconProvider){var ib=zb.parentNode;this.VPf(zb);ib&&(this.sK[ob]=this.svgIconProvider.vba(Fb?this.GIf[ob]:this.yxd[ob],12,12,ib,24,24))}}for(ob=0;ob<this.mh.length;ob++)this.mh[ob].Aeg(Fb);this.VRa&&this.VRa.wsa&&this.zeg(Jb.a.N2h,this.VRa,Fb);this.rH&&this.rH.wsa&&this.zeg(Jb.a.p1g,this.rH,Fb)}};d.prototype.zeg=function(Fb,ob,zb){ob.jab||(ob.jab=
this.svgIconProvider.vba(Fb,12,12,ob.wsa.parentNode,24,24));ob.jab&&(La.DOMElementExtensions.setVisible(ob.wsa,!zb),La.DOMElementExtensions.setVisible(ob.jab,zb))};d.prototype.nTi=function(Fb,ob){var zb=Ab.g(this.$),ib=zb.inRangePicker,fc=cb.HelperMethods.Fn(ob);if(zb.isEditing&&!ib){var Ic=zb.pj?"formulaBar_end_edit_sheet_changed":"cell_text_end_edit_sheet_changed",Yc=void 0;X.EwaSettings.Q6a&&(Yc=[Object(Wb.a)(zb.$b.textBox.nBa)]);Wb.b(this.$).sTa(fc.rawEvent,Ic,Yc);zb.endEdit(!0,"SheetTabBar.OnSheetTabMouseDown")}zb=
this.exa&&3===ob.nb;!(2===ob.nb&&fc.button===Sys.UI.MouseButton.leftButton||zb)||ib||this.cF||Ka.a(this.$).Lp()||(zb&&Fb.jTi(),this.tBb=ob.clientPoint.x,this.ZY=ob,this.jPg(Fb))};d.prototype.lTi=function(Fb){!this.mz&&this.cF&&this.BSd(Fb.sheet,!1)};d.prototype.mTi=function(Fb){this.mz||(this.cF&&this.reorderSheets(Fb.sheet,!1,!0),this.hQ());this.m0()};d.prototype.Bpe=function(){return this.$.isEditMode&&!ta.k(this.$.mg)};d.prototype.m0=function(){var Fb=this,ob=cb.HelperMethods.sca(function(){Fb.VSj();
Fb.fm&&Fb.muj();Fb.kPd()});P.ULS.sendTraceTag(537153757,0,50,"SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = "+ob)};d.prototype.muj=function(){var Fb=this.hK===this.mh.length-1;La.DOMElementExtensions.toggleCssClass(this.mdb,this.$.cJ?w.vOe:w.kOe,!!this.Ku);La.DOMElementExtensions.toggleCssClass(this.mdb,this.$.cJ?w.kOe:w.vOe,!Fb)};d.prototype.kPd=function(Fb){Fb=void 0===Fb?!1:Fb;var ob=!this.Ku,zb=this.hK===this.mh.length-1;this.I_f(4,this.sheetTabActivatePreviousHidden,!ob);
this.I_f(5,this.sheetTabActivateNextHidden,!zb);this.wwc(0,ob||Fb);this.wwc(1,ob||Fb);this.wwc(2,zb||Fb);this.wwc(3,zb||Fb)};d.prototype.I_f=function(Fb,ob,zb){if(Fb=this.sK[Fb]){La.DOMElementExtensions.setVisible(Fb,zb);var ib=this.h0e(Fb);ib.title="img"===Fb.nodeName?Fb.alt=0<this.mh.length&&zb?ob:"":Fb.title=0<this.mh.length&&zb?ob:"";ib.tabIndex=zb?0:-1}};d.prototype.h0e=function(Fb){return this.kw?Fb.parentNode:Fb.parentNode.parentNode};d.prototype.wwc=function(Fb,ob){if(Fb=this.sK[Fb])Fb=this.h0e(Fb),
void 0!==Fb&&null!==Fb&&(!this.mh.length||ob?(Fb.classList.add(Ma.a.qU),Fb.setAttribute(B.a.dsa,"true")):(Fb.classList.remove(Ma.a.qU),Fb.setAttribute(B.a.dsa,"false")))};d.prototype.LRa=function(Fb){var ob=this.$.cJ?this.mh.length-1:0,zb=this.z2e(this.$.cJ?0:this.mh.length-1);zb&&(zb.borderRightWidth=Fb?"1px":"0");this.Ku!==this.hK&&(zb=this.z2e(ob))&&(zb.borderRightWidth="0")};d.prototype.wme=function(Fb,ob){this.mh||(this.mh=[]);-1===ob?this.mh.push(Fb):this.mh.splice(ob,0,Fb)};d.prototype.i5b=
function(Fb,ob){var zb=-1,ib=null;ob||(zb=this.VTh(Fb.index),-1!==zb&&(ib=this.EKa(zb)));Fb=new h(this.$,this.Qk,ib,Fb,this,this.fm,this.kw);this.wme(Fb,zb);La.DOMElementExtensions.setVisible(Fb.domElement,!0)};d.prototype.BSd=function(Fb,ob){var zb=this.T2a(Fb);if(zb){this.gld=Fb;this.Pwd=ob;Fb=zb.domElement;zb=this.isRtl?Fb.offsetLeft+(this.Qk.scrollWidth-this.Qk.clientWidth-this.Qk.scrollLeft):Fb.offsetLeft-this.Qk.scrollLeft;if(!this.isRtl&&ob||this.isRtl&&!ob)zb+=Fb.offsetWidth;this.Zwc.style.left=
cb.HelperMethods.nc(zb-4);La.DOMElementExtensions.setVisible(this.Zwc,!0)}};d.prototype.l8e=function(){La.DOMElementExtensions.setVisible(this.Zwc,!1)};d.prototype.y0=function(Fb){var ob=this,zb=cb.HelperMethods.sca(function(){switch(Fb){case 0:ob.bvc(0);break;case 1:ob.bvc(ob.Ku-1);break;case 2:ob.bvc(ob.Ku+1);break;case 3:ob.scrollIntoView(ob.mh.length-1);break;case 4:ob.Ku&&1<=ob.mh.length&&(ob.jke(ob.Ku-1),ob.aNd());break;case 5:ob.hK!==ob.mh.length-1&&1<=ob.mh.length&&(ob.jke(ob.hK+1),ob.aNd());
break;case 6:ob.aNd()}});this.S7b&&this.cF&&this.LOb();P.ULS.sendTraceTag(537153755,0,50,"SheetTabBarControl.ScrollSheetTabs: operation = "+Fb+", duration = "+zb)};d.prototype.jke=function(Fb){(Fb=this.AQ(Fb))&&Fb.activate()};d.prototype.kCh=function(Fb){if(0===Fb.uy)for(var ob=this.$.xa,zb=0,ib=0,fc=ob.count;ib<fc;ib++){var Ic=Object(fa.a)(Sa.a,ob.getItem(ib));if(Ic===Fb)return zb;0===Ic.uy&&zb++}return-1};d.prototype.YBh=function(Fb){var ob=this.$.xa;Fb=Fb.index+1;for(var zb=ob.count;Fb<zb;Fb++){var ib=
Object(fa.a)(Sa.a,ob.getItem(Fb));if(0===ib.uy)return ib}return null};d.prototype.Via=function(Fb){for(var ob=0;ob<this.mh.length;ob++){var zb=this.AQ(ob);if(!zb)P.ULS.sendTraceTag(537153754,0,15,"SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton["+ob+"] is null even though index is not out of bounds!");else if(zb.sheet===Fb)return ob}return-1};d.prototype.T2a=function(Fb){Fb=this.Via(Fb);return this.AQ(Fb)};d.prototype.ixi=function(Fb,ob,zb){var ib={};ib.a=this.$.ya.UserSessionId;ib.b=
zb;ib.c=this.C7b;ib.d=Fb;ib.e=ob;ib.f=this.$.xa.count;hb.b().Ce(2,ib,zb)};d.prototype.bfj=function(Fb,ob,zb){var ib=Object(fa.a)(Db.a,this.$.xa);ob?(ob=ob.index,ob=Fb.index<ob?ob-1:ob):ob=zb?ib.count-1:0;ib.reorderSheet(Fb,ob,!0)};d.prototype.g_f=function(Fb){Ab.g(this.$).ig.wo(Fb)};d.prototype.jPg=function(Fb){if(!this.vtc){var ob=this.domElement.ownerDocument.body;this.mz?(ha.a.instance.ra(da.a.sj,document.documentElement,this.sN),this.exa&&(ya.a.instance.ra(da.a.Vf,document.documentElement,this.sN),
ya.a.instance.ra(da.a.Vf,this.domElement,this.FN))):(ha.a.instance.ra(da.a.sj,ob,this.sN),ya.a.instance.ra(da.a.Vf,ob,this.sN));ha.a.instance.ra(da.a.Hf,document.documentElement,this.q6);ya.a.instance.ra(da.a.oe,ob,this.q6);this.vtc=!0}this.L_=Fb.sheet;this.C7b=!1;this.mz?(this.uM=null,this.K7b=Fb,this.laa=Fb.domElement,this.DOd(La.DOMElementExtensions.getBoundingClientRect(this.laa),"BeginSheetTabButtonDrag")):(P.ULS.sendTraceTag(537153752,0,50,"SheetTabBarControl.BeginSheetTabButtonDrag: Starting legacy sheet tab drag and drop."),
this.domElement.classList.add(w.jOe),this.domElement.style.cursor="",this.g_f("pointer"))};d.prototype.hQ=function(Fb){Fb=void 0===Fb?!0:Fb;if(this.vtc){this.g_f(B.a.x4);var ob=this.domElement.ownerDocument.body;this.mz?(ha.a.instance.Ba(da.a.sj,document.documentElement,this.sN),this.exa&&(ya.a.instance.Ba(da.a.Vf,document.documentElement,this.sN),ya.a.instance.Ba(da.a.Vf,this.domElement,this.FN))):(ha.a.instance.Ba(da.a.sj,ob,this.sN),ya.a.instance.Ba(da.a.Vf,ob,this.sN));ha.a.instance.Ba(da.a.Hf,
document.documentElement,this.q6);ya.a.instance.Ba(da.a.oe,ob,this.q6);this.yLc=this.vtc=!1}this.gqc=0;this.C7b=!1;this.gld=this.L_=null;this.mz?(this.laa&&(this.laa.style.visibility="visible",this.laa=null),this.K7b=null,this.DOd(null,"EndSheetTabButtonDrag"),this.uM&&(this.uM.parentNode&&this.uM.parentNode.removeChild(this.uM),this.uM=null),this.mhj(Fb)):(this.domElement.classList.remove(w.jOe),this.l8e())};d.prototype.mhj=function(Fb){this.lUd(Fb);this.BC=this.tBb=-1};d.prototype.gmh=function(Fb,
ob){function zb(Yc,Mc,xb){var wc=Ic.Na(9,null);wc.sheetName=Fb;wc.newSheetIndex=ob;return la.g(Ic,"ReorderSheets",wc,Yc,Mc,xb,null,0)}function ib(){return new u(Fb,ob)}var fc=this.$.oa,Ic=fc?fc.va:null;X.EwaSettings.Zb()?this.$.userOperationManager.Sb(new ma.a(557,0,zb,64,ib),null):this.$.userOperationManager.Sb(new aa.a(557,0,zb,void 0,ib),null)};d.prototype.AQ=function(Fb){return 0<=Fb&&Fb<this.mh.length?this.mh[Fb]:null};d.prototype.y2e=function(Fb){return(Fb=this.AQ(Fb))?Fb.sheet:null};d.prototype.EKa=
function(Fb){return(Fb=this.AQ(Fb))?Fb.domElement:null};d.prototype.z2e=function(Fb){return(Fb=this.EKa(Fb))?Fb.style:null};d.prototype.VTh=function(Fb){var ob=this.$.xa;Fb+=1;for(var zb=-1,ib=this.mh?this.mh.length:0;Fb<ob.count;){var fc=Object(fa.a)(Sa.a,ob.getItem(Fb));if(0===fc.uy){for(zb=0;zb<ib&&this.y2e(zb)!==fc;zb++);break}Fb++}return-1===zb||zb===ib?-1:zb};d.prototype.fDf=function(Fb){var ob=this.T2a(Fb);ob&&(this.mz&&this.cF&&(P.ULS.sendTraceTag(537153751,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),
X.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.hQ()),this.Qk.removeChild(ob.domElement),ob=Array.indexOf(this.mh,ob),this.mh.splice(ob,1),this.m0(),(!this.isRtl&&ob===this.mh.length||this.isRtl&&!ob)&&this.LRa(!0),this.S7b&&this.cF?Fb===this.L_?(this.hQ(),this.y0(6)):this.LOb():this.y0(6))};d.prototype.hDf=function(Fb){var ob=Object(fa.a)(Sa.a,Fb);this.mz&&this.cF&&(P.ULS.sendTraceTag(537153750,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),
X.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.hQ());if(0===ob.uy){this.LRa(!1);var zb=this.Via(Fb);-1===zb&&(P.ULS.sendTraceTag(537153749,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),this.i5b(ob,!1),zb=this.Via(Fb));this.m6e(zb,!0)}};d.prototype.cfj=function(Fb,ob){var zb=this.T2a(Fb);zb&&(this.mz&&this.cF&&!ob&&(P.ULS.sendTraceTag(537153748,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),
X.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.hQ()),Fb=this.HIj(Fb,zb),!X.EwaSettings.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&this.mz&&Fb&&ob&&Fb.iTi())};d.prototype.HIj=function(Fb,ob){var zb=Array.indexOf(this.mh,ob),ib=this.kCh(Object(fa.a)(Sa.a,Fb));if(-1===ib||-1===zb)return null;zb!==ib||this.mz?(this.LRa(!1),ib=d.Zej(zb,ib,this.Ku,this.hK),this.Ku=ib.KCh,this.hK=ib.Xri,ob&&ob.domElement.parentNode===
this.Qk&&(this.Qk.removeChild(ob.domElement),this.mh.splice(zb,1)),ob=this.YBh(Fb),zb=this.Via(ob),ob=new h(this.$,this.Qk,this.EKa(zb),Object(fa.a)(Sa.a,Fb),this,this.fm,this.kw),this.wme(ob,zb),zb=this.Via(Fb),this.m6e(zb,!1,!this.fm)):ob=null;return ob};d.prototype.Smh=function(){for(var Fb=this.mh?this.mh.length:0,ob=this.Ku,zb=this.hK,ib=0;ib<Fb;ib++){var fc=this.AQ(ib),Ic=ib>=ob;fc&&(fc.tabIndex=Ic&&ib<=zb?0:-1)}};d.prototype.GRj=function(){for(var Fb=this.mh?this.mh.length:0,ob=0;ob<Fb;ob++){var zb=
this.AQ(ob);zb&&zb.Efb()}};d.prototype.m6e=function(Fb,ob,zb){zb=void 0===zb?!0:zb;ob&&Fb<=this.Ku&&this.Ku++;this.Smh();this.LRa(!0);this.m0();this.S7b&&this.cF?this.LOb():zb&&this.y0(6)};d.prototype.hwc=function(Fb){var ob=this.$.cJ;if(Fb||this.isRtl!==ob)this.isRtl=ob,this.domElement.classList.remove(this.isRtl?oa.a.qOe:oa.a.wOe),this.domElement.classList.add(this.isRtl?oa.a.wOe:oa.a.qOe),this.domElement.dir=this.isRtl?"rtl":"ltr",this.GRj();Fb||this.LRa(!0);for(Fb=0;Fb<this.sK.length;Fb++)0!==
Fb&&3!==Fb&&(!this.fm||4!==Fb&&5!==Fb)&&this.J_f(Fb)};d.prototype.l9g=function(){var Fb=this.JQd=document.createElement("div");Fb.className=w.Ysh;this.fm&&Fb.classList.add(w.Zsh);this.domElement.appendChild(Fb);this.c5b(Fb,1,720,719);this.c5b(Fb,2,722,721);this.khf&&(this.VRa=new x(this.$,this,Fb));this.fm||this.c5b(Fb,4,726,725)};d.prototype.m9g=function(){var Fb=this.axc=document.createElement("div");Fb.className=w.$sh;this.domElement.appendChild(Fb);this.fm||this.c5b(Fb,5,728,727);this.d4c()};
d.prototype.o$g=function(){var Fb=document.getElementById(B.a.Lwj),ob=document.getElementById(B.a.Mwj);Fb&&!ob&&P.ULS.sendTraceTag(537153746,0,50,"CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: "+Fb.parentNode.id+". progressBar div has child: "+!!Fb.firstChild+". ProgressBarMessage div exists: "+!!document.getElementById(B.a.zQd));if(U.a.qhf(this.$)&&Fb&&ob)this.domElement.appendChild(Fb),this.KQd=Fb.firstChild,this.LQd=document.getElementById(B.a.zQd),
ob.style.visibility="visible";else{Fb=document.createElement("div");ob=document.createElement("div");Fb.className=oa.a.ith;ob.className=oa.a.gth;ob.style.display="none";var zb=document.createElement("div");zb.className=oa.a.jth;var ib=document.createElement("div");ib.className=oa.a.hth;var fc=document.createElement("div");fc.className=oa.a.fth;ob.appendChild(zb);ob.appendChild(ib);ob.appendChild(fc);Fb.appendChild(ob);this.domElement.appendChild(Fb);this.KQd=ob;this.LQd=ib}};d.prototype.J_f=function(Fb){var ob=
this.sK[Fb];if(ob)if(this.kw){var zb=ob.parentNode;this.VPf(ob);ob=ub.a(this.$)?this.GIf[Fb]:this.yxd[Fb];this.sK[Fb]=this.svgIconProvider.vba(ob,12,12,zb,24,24)}else ob.className=this.wxd[Fb]};d.prototype.VPf=function(Fb){(null===Fb||void 0===Fb?0:Fb.parentNode)&&Fb.parentNode.removeChild(Fb)};d.prototype.L6g=function(){var Fb=this.mdb=document.createElement("div");Fb.className=w.Vsh;this.domElement.appendChild(Fb);this.sah(Fb)};d.prototype.sah=function(Fb){var ob=document.createElement("div");ob.className=
w.lth;ob.classList.add(w.Wsh);this.$.printingEnabled||ob.classList.add(Ua.a.DQe);Fb.appendChild(ob);this.Qk=document.createElement("ul");La.DOMElementExtensions.iu(this.Qk,B.a.eXc,null,null);this.Qk.className=Ua.a.xOe;ob.appendChild(this.Qk);this.e9g();this.Ege=document.createElement("div");this.Wwc.id="SheetIconTooltipContainer";ob.appendChild(this.Wwc)};d.prototype.e9g=function(){var Fb=document.createElement("div"),ob="<div class='"+oa.a.l_g+"'>{0}</div>",zb=V.a.kdd(oa.a.kuh,0,"55_16_N","");Fb.innerHTML=
String.format(ob,zb);Fb.className=w.kth;La.DOMElementExtensions.setVisible(Fb,!1);this.Zwc=Fb;this.Qk.appendChild(Fb)};d.prototype.v4c=function(){for(var Fb=this.$.xa,ob=0,zb=Fb.count;ob<zb;ob++){var ib=Object(fa.a)(Sa.a,Fb.getItem(ob));0===ib.uy&&(this.i5b(ib,!0),ib.active&&ib.activate())}};d.prototype.I0c=function(){xa.a.oc(this.mh);this.mh=[];this.hK=this.Ku=0};d.prototype.c5b=function(Fb,ob,zb,ib){function fc(xb){"mouseup"===xb.type&&Ic.mz&&Ic.cF||Ra.g(xb);Yc.classList.contains(Ma.a.qU)||(Mc?
Ic.XPi(xb,ob):Ic.fm||Ic.pAf(xb,ob))}var Ic=this,Yc=document.createElement("a");Fb.appendChild(Yc);Fb=this.yxd[ob];this.sK[ob]=this.lb(Yc,ra.a.instance.ga(ib),0,this.wxd[ob],ra.a.instance.ga(zb),Fb);if(5===ob||4===ob)La.DOMElementExtensions.QJ(this.sK[ob],Yc,!1,"span").style.marginTop="10px";this.J_f(ob);zb=this.xxd[ob]=this.je.Td(Yc);ha.a.instance.ra(da.a.pointerDown,Yc,function(xb){return xb.ctrlKey&&Ic.WJi(ob)?!0:Ic.nAf(ob)});ha.a.instance.ra(da.a.Hf,Yc,function(){return Ic.oAf()});ya.a.instance.ra(da.a.oe,
Yc,function(){return Ic.oAf()});ha.a.instance.ra(da.a.pointerOut,Yc,function(){return Ic.A0c()});va.KeyInputManager.instance.ra(da.a.Lb,Yc,function(xb){return 13!==xb.Ca.keyCode&&32!==xb.Ca.keyCode||Ic.C2c?!1:(Ic.C2c=!0,Ic.nAf(ob))});va.KeyInputManager.instance.ra(da.a.Fd,Yc,function(xb){return 13===xb.Ca.keyCode||32===xb.Ca.keyCode?(Ic.C2c=!1,Ic.A0c()):!1});var Mc=this.Bpe();zb.ka("mouseover",fc);zb.ka("mouseout",fc);zb.ka("focus",fc);zb.ka("blur",fc);Mc&&zb.ka("mouseup",fc)};d.prototype.fdf=function(Fb){var ob=
!1,zb=this.$.uf;zb&&(ob=bb.a.ZM(La.DOMElementExtensions.getBoundingClientRect(zb),Fb.clientPoint));return ob};d.prototype.mhf=function(Fb){return bb.a.ZM(La.DOMElementExtensions.getBoundingClientRect(this.domElement),Fb.clientPoint)||this.fdf(Fb)};d.prototype.gCh=function(Fb){var ob=null,zb=Fb.clientPoint,ib=this.Ku;if(this.mhf(Fb))for(ib=this.Ku;ib<=this.hK;ib++)if(ob=this.AQ(ib))if(Fb=La.DOMElementExtensions.getBoundingClientRect(ob.domElement),!this.isRtl&&zb.x<Fb.x+Fb.width||this.isRtl&&zb.x>
Fb.x)break;return{returnValue:ob,mAj:ib>this.hK}};d.prototype.LOb=function(){if(this.mz){if(!this.uM){P.ULS.sendTraceTag(537153743,0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop.");this.uM=this.laa.cloneNode(!0);if(!this.zVf(this.uM,this.laa,!0,"UpdateDragAndDropState"))return;this.laa.style.visibility="hidden";this.uM.classList.add(w.mth);this.uM.style.borderRightWidth="";this.Zcc=this.ZY.clientPoint.x-this.P3.width/2;this.uM.style.left=this.Zcc+"px";this.BC=
this.Via(this.L_);0>this.BC&&P.ULS.sendTraceTag(537153742,0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.S7b&&(this.BC=this.Via(this.L_));var Fb=La.DOMElementExtensions.getBoundingClientRect(this.Qk),ob=Fb.x;Fb=Fb.x+Fb.width;var zb=this.ZY.clientPoint.x-this.P3.width/2;zb=Math.min(zb,Fb-this.P3.width);zb=Math.max(zb,ob);this.uM.style.transform="translateX("+Math.abs(zb-this.Zcc)*(this.Zcc<zb?1:-1)+"px)";var ib=this.ZY.clientPoint.x>this.tBb,fc=this.ZY.clientPoint.x;zb>=Fb-
this.P3.width?(fc=Fb-this.P3.width/2,this.YMd()||this.Gma||(P.ULS.sendTraceTag(537153741,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),this.mpc=this.Qk.scrollLeft,this.Gma=window.requestAnimationFrame(this.fXf))):zb<=ob?(fc=ob+this.P3.width/2,this.XMd()||this.Gma||(P.ULS.sendTraceTag(537153740,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),this.mpc=this.Qk.scrollLeft,
this.Gma=window.requestAnimationFrame(this.eXf))):this.Gma&&(P.ULS.sendTraceTag(537153739,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),this.lUd());this.ZY.clientPoint.x!==this.tBb&&(this.XUd(ib,fc),this.tBb=this.ZY.clientPoint.x)}else Fb=this.gCh(this.ZY),ob=Fb.mAj,(Fb=Fb.returnValue)?this.BSd(Fb.sheet,ob):this.l8e();this.yLc=!0};d.prototype.XUd=function(Fb,ob){for(var zb=this,ib;function(){var fc=zb.mjh(ob,Fb);ib=fc.e2b;return fc}().returnValue;)this.qNb=
ib,this.FKg(Fb)};d.prototype.FKg=function(Fb){if(this.qNb){var ob=(Fb?1:-1)*this.P3.width;if(Fb&&!this.$.cJ||!Fb&&this.$.cJ){var zb=this.laa;var ib=this.BC+1;var fc=!0}else zb=(ib=this.AQ(this.BC+1))?ib.domElement:null,ib=this.BC-1,fc=!1;if(this.zVf(this.qNb,zb,fc,"AnimateSheetSwap")){P.ULS.sendTraceTag(537153738,0,50,"SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index "+this.BC+" and other sheet-index "+ib+". amount of sheets in the bar: "+this.HQd+" isMovingRight: "+Fb);0<=this.BC&&
this.BC<this.mh.length&&0<=ib&&ib<this.mh.length?(Fb=this.mh[ib],this.mh[ib]=this.mh[this.BC],this.mh[this.BC]=Fb):(P.ULS.sendTraceTag(537153737,0,15,"SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: "+this.mh.length+", ghostIndex: "+this.BC+", swappedSheetIndex: "+ib),this.hQ());this.BC=ib;var Ic=this.qNb;Ic.style.transform="translateX("+ob+"px)";window.requestAnimationFrame(function(){Ic.style.transform="translateX(0px)"})}}};d.prototype.zVf=function(Fb,ob,zb,ib){function fc(Ic){return Ic?
"Node ID: "+Ic.id+" , Node class: "+Ic.className+", Node name: "+Ic.nodeName+",":null}try{return this.Qk.insertBefore(Fb,ob),!0}catch(Ic){return Fb=this.T2a(this.L_),P.ULS.sendTraceTag(537153736,0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",
Fb?Fb!==this.K7b?"Changed":"NoChange":"Removed",ib,fc(ob),fc(ob.parentNode),fc(this.Qk),zb,this.BC,this.HQd,Ic),this.hQ(),!1}};d.prototype.mjh=function(Fb,ob){var zb=this.$.cJ===ob?this.AQ(this.BC-1):this.AQ(this.BC+1);if(!zb)return{returnValue:!1,e2b:null};zb=zb.domElement;var ib=La.DOMElementExtensions.getBoundingClientRect(zb);return this.P3?ob?{returnValue:Fb+this.P3.width/2>=ib.x+.5*ib.width,e2b:zb}:{returnValue:Fb-this.P3.width/2<=ib.x+.5*ib.width,e2b:zb}:(P.ULS.sendTraceTag(537153735,0,50,
"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),this.hQ(),{returnValue:!1,e2b:zb})};d.prototype.bXf=function(Fb,ob){var zb=ob?this.fXf:this.eXf;if(-1===this.Pyc)this.Pyc=Fb,this.Gma=window.requestAnimationFrame(zb);else{Fb=Math.floor((Fb-this.Pyc)/1E3*300);var ib=this.KJb>this.aCb?1:-1;this.scrollLeft(Math.abs(this.Qk.scrollLeft-(ob?this.mpc+Fb*ib:this.mpc-Fb*ib))*(ob?-1:1));if(Fb=this.DZe("ScrollStep"))this.XUd(ob,
Fb.x+Fb.width/2),ob&&!this.YMd()||!ob&&!this.XMd()?this.Gma=window.requestAnimationFrame(zb):(P.ULS.sendTraceTag(537153734,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),this.lUd())}};d.prototype.YMd=function(){var Fb=this.KJb>this.aCb;return Fb&&this.lna>=this.KJb||!Fb&&this.lna<=this.KJb};d.prototype.XMd=function(){var Fb=this.KJb>this.aCb;return Fb&&this.lna<=this.aCb||!Fb&&this.lna>=this.aCb};d.prototype.lUd=function(Fb){Fb=void 0===Fb?!0:Fb;this.Qk&&
(this.lna=this.Qk.scrollLeft);window.cancelAnimationFrame(this.Gma);this.Gma=0;this.Pyc=-1;Fb&&this.m0()};d.prototype.DOd=function(Fb,ob){Fb||P.ULS.sendTraceTag(537153733,0,50,"SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by "+ob);this.P3=Fb};d.prototype.WJi=function(Fb){return 2===Fb?(this.y0(3),!0):1===Fb?(this.y0(0),!0):!1};d.prototype.nAf=function(Fb){var ob=this;P.ULS.shipAssertTag(537153732,0,-1===this.vPa&&-1===this.uPa,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");
-1!==this.vPa&&(window.clearTimeout(this.vPa),this.vPa=-1);-1!==this.uPa&&(window.clearInterval(this.uPa),this.uPa=-1);this.y0(Fb);this.vPa=window.setTimeout(function(){ob.mGj(Fb)},this.FDi);return!0};d.prototype.mGj=function(Fb){var ob=this;this.uPa=window.setInterval(function(){ob.y0(Fb)},this.EDi)};d.prototype.oAf=function(){this.A0c();return!this.mz||!this.cF};d.prototype.A0c=function(){window.clearTimeout(this.vPa);window.clearInterval(this.uPa);this.uPa=this.vPa=-1;return!0};d.prototype.pAf=
function(Fb,ob){var zb=this.wxd[ob];cb.HelperMethods.jWd(this.sK[ob],zb,zb+B.a.Aec,"mouseover"===Fb.type||"focus"===Fb.type)};d.prototype.XPi=function(Fb,ob){var zb=this.Vgc(ob),ib=5===ob;if("mouseup"===Fb.type){if(ib||4===ob)zb||this.reorderSheets(null,ib,!1),this.hQ()}else!this.mz&&this.cF?(zb||this.BSd(this.y2e(ib?this.hK:this.Ku),ib),this.y0(ib?2:1)):this.fm||this.pAf(Fb,ob)};d.prototype.Vgc=function(Fb){return!!La.DOMElementExtensions.hed(this.sK[Fb],"a").title};d.prototype.uCc=function(Fb){this.kZd(Fb);
this.m0()};d.prototype.kZd=function(Fb){(Fb=this.T2a(Fb))&&Fb.Efb()};d.prototype.aNd=function(){var Fb=this.$.xa;if(Fb.pa&&(!Gc.e(this.$)||Fb.count))if(Fb=this.Via(Fb.pa),-1===Fb)P.ULS.sendTraceTag(537153729,0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");else{var ob=this.EKa(Fb);Fb<this.Ku?this.bvc(Fb):Fb>this.Ku&&!this.ard(ob)&&this.scrollIntoView(Fb)}};d.prototype.VSj=function(){this.Ku=0;this.hK=this.mh.length-1;for(var Fb=!1,ob=0;ob<this.mh.length;ob++){var zb=
this.AQ(ob);if(!zb)break;var ib=this.ard(zb.domElement);zb.tabIndex=ib?0:-1;if(!Fb&&ib)this.Ku=ob,Fb=!0;else if(Fb&&!ib){this.hK=ob-1;break}}};d.prototype.bvc=function(Fb){this.$.xa.count&&(this.mh.length||this.v4c(),this.UYf(this.EKa(Math.max(0,Math.min(Fb,this.mh.length-1)))),this.m0())};d.prototype.scrollIntoView=function(Fb){P.ULS.shipAssertTag(537153697,0,Fb>=this.Ku,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visisble sheet tab index!");if(this.$.xa.count){this.mh.length||
this.v4c();var ob=this.EKa(Math.max(0,Math.min(Fb,this.mh.length-1))),zb=this.EKa(this.Ku);if(!this.ard(ob)){ob=La.DOMElementExtensions.getBoundingClientRect(ob);var ib=La.DOMElementExtensions.getBoundingClientRect(this.mdb);ob=this.isRtl?ib.x-ob.x:ob.x+ob.width-(ib.x+ib.width);for(ib=0;zb&&ib<ob;){var fc=La.DOMElementExtensions.getBoundingClientRect(zb);ib+=fc.width;zb=zb.nextSibling}zb?this.UYf(zb):P.ULS.sendTraceTag(537153696,0,15,"SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = "+
this.Ku+", lastVisibleSheetTabIndex = "+this.hK+", scroll to index: "+Fb)}this.m0()}};d.prototype.UYf=function(Fb){var ob=La.DOMElementExtensions.getBoundingClientRect(this.Qk);Fb=La.DOMElementExtensions.getBoundingClientRect(Fb);this.isRtl?this.scrollLeft(Math.floor(ob.x+ob.width-(Fb.x+Fb.width+.5))):this.scrollLeft(Math.ceil(ob.x-Fb.x-.5))};d.prototype.scrollLeft=function(Fb){(0>Fb&&this.YMd()||0<Fb&&this.XMd())&&P.ULS.sendTraceTag(537153695,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");
var ob=this.Qk.scrollLeft;if(this.isRtl){if(ea.a.eF||ea.a.Pf){this.Qk.scrollLeft=this.lna=ob-Fb;return}if(ea.a.xH){this.Qk.scrollLeft=this.lna=ob+Fb;return}P.ULS.sendTraceTag(537153694,0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.Qk.scrollLeft=this.lna=ob-Fb};d.prototype.ard=function(Fb){Fb=La.DOMElementExtensions.getBoundingClientRect(Fb);var ob=La.DOMElementExtensions.getBoundingClientRect(this.mdb);return Fb&&ob?Fb.x>=ob.x-1&&Fb.x+Fb.width<=ob.x+ob.width+1:(P.ULS.sendTraceTag(537153693,
0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1)};d.prototype.G9g=function(){var Fb=this.axc;if(z.q2f(this.$))this.fm?(xa.a.Ia(this.rH),this.rH=new z(Fb,this.$,this,!0)):(xa.a.Ia(this.rH),this.rH=null);else if(!this.rH||this.fm)xa.a.Ia(this.rH),ta.k(this.$.mg)?this.rH=new e(Fb,this.$,this):this.rH=new z(Fb,this.$,this)};d.prototype.sEe=function(Fb,ob){var zb=this.$.xa;if(!this.$.isEditMode||!zb.count)xa.a.Ia(ob),ob=null;else if(!ob)if(zb=this.fm?
this.JQd:this.axc,ta.k(this.$.mg))ob=new e(zb,this.$,this);else switch(Fb){case 0:ob=new z(zb,this.$,this);break;case 1:ob=new A(zb,this.$,this);break;default:P.ULS.sendTraceTag(537153692,0,10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}return ob};d.prototype.d4c=function(){X.EwaSettings.ma(426)?(this.rH=this.sEe(0,this.rH),this.Eyb=this.sEe(1,this.Eyb)):
this.G9g()};d.prototype.DZe=function(Fb){var ob=La.DOMElementExtensions.getBoundingClientRect(this.uM);ob||(P.ULS.sendTraceTag(537153689,0,50,"SheetTabBarControl."+Fb+": GetBoundingClientRect returned null for the dragged sheet."),this.hQ());return ob};d.prototype.d6e=function(Fb,ob){this.Lta.KLg(Fb,ob);this.hQ(!1);this.kPd(this.navigationButtonsDisabled);Fb=ik(this.UIj);for(ob=Fb.next();!ob.done;ob=Fb.next())(ob=ob.value)&&ob.mX(this.navigationButtonsDisabled);Fb=ik(this.ute);for(ob=Fb.next();!ob.done;ob=
Fb.next())(ob=ob.value)&&ob.mX(this.operationButtonsDisabled)};d.Zej=function(Fb,ob,zb,ib){Fb<zb?(ob>zb&&zb--,ob>ib&&ib--):Fb>ib?(ob<zb&&zb++,ob<ib&&ib++):ob<zb&&zb++;return{KCh:zb,Xri:ib}};of.Object.defineProperties(d.prototype,{hc:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},Yd:{configurable:!0,enumerable:!0,get:function(){return Ea.a.GQd}},cF:{configurable:!0,enumerable:!0,get:function(){return this.yLc}},
HQd:{configurable:!0,enumerable:!0,get:function(){return this.mh.length}},Wwc:{configurable:!0,enumerable:!0,get:function(){return this.Ege}},exa:{configurable:!0,enumerable:!0,get:function(){return this.U9d}},navigationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!this.Lta&&this.Lta.navigationButtonsDisabled}},operationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!this.Lta&&this.Lta.operationButtonsDisabled}},wxd:{configurable:!0,enumerable:!0,get:function(){return this.fm?
this.$.cJ?[oa.a.P8b,oa.a.sOe,oa.a.uOe,oa.a.O8b,oa.a.qua,oa.a.qua]:[oa.a.O8b,oa.a.uOe,oa.a.sOe,oa.a.P8b,oa.a.qua,oa.a.qua]:this.$.cJ?[oa.a.P8b,oa.a.rOe,oa.a.tOe,oa.a.O8b,oa.a.qua,oa.a.qua]:[oa.a.O8b,oa.a.tOe,oa.a.rOe,oa.a.P8b,oa.a.qua,oa.a.qua]}},yxd:{configurable:!0,enumerable:!0,get:function(){return this.$.cJ?[null,Jb.a.QAe,Jb.a.OAe]:[null,Jb.a.OAe,Jb.a.QAe]}},GIf:{configurable:!0,enumerable:!0,get:function(){return this.$.cJ?[null,Jb.a.RAe,Jb.a.PAe]:[null,Jb.a.PAe,Jb.a.RAe]}},aCb:{configurable:!0,
enumerable:!0,get:function(){if(this.isRtl){if(ea.a.eF)return 0;if(ea.a.Pf)return-1*(this.Qk.scrollWidth-this.Qk.clientWidth);if(ea.a.Xu)return this.Qk.scrollWidth-this.Qk.clientWidth;P.ULS.sendTraceTag(537153762,0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0}},KJb:{configurable:!0,enumerable:!0,get:function(){if(this.isRtl){if(ea.a.eF)return this.Qk.scrollWidth-this.Qk.clientWidth;if(ea.a.Pf||ea.a.Xu)return 0;P.ULS.sendTraceTag(537153761,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.Qk.scrollWidth-
this.Qk.clientWidth}},ute:{configurable:!0,enumerable:!0,get:function(){return this.Lta?[this.rH,this.Eyb]:[this.rH,this.Eyb,this.VRa]}},UIj:{configurable:!0,enumerable:!0,get:function(){return this.mh.concat(this.VRa)}},Nwj:{configurable:!0,enumerable:!0,get:function(){return this.Dge}}});Object(S.a)(d,"SheetTabBarControl",Za.a,[496,6,429]);var Nc=O.a;$k(c,Nc);c.prototype.create=function(){var Fb=this,ob=this.$.zb;if(Q.a(this.$.ya,1))Xb.PageLoadTrackingInfo.instance.xda(B.a.HAa,["sheetTabBar"]);
else{var zb=document.getElementById(ob+B.a.y5c);zb?(X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&Xb.PageLoadTrackingInfo.instance.vAa(B.a.HAa),U.a.mqd()?G.TaskExtensions.Aa(T.GetServiceTaskFactory.Ra(this.$.da,388,387,this.hb),function(ib){Fb.pb(Fb.$.da.za(32)||new d(Fb.$,zb,ib.result))},this.$.la,3):this.pb(this.$.da.za(32)||new d(this.$,zb))):Xb.PageLoadTrackingInfo.instance.xda(B.a.HAa,["sheetTabBar"])}};c.ka=function(Fb){Fb.da.Ga(33,new c(Fb))};Object(S.a)(c,
"SheetTabBarFactory",O.a,[]);b.d(E,"a",function(){return a})},1367:function(t,E,b){function a(){w.a.Fa(function(oa){u.ka(oa);D.EwaSettings.tb()?x.ka(oa):l.ka(oa);k.ka(oa);c.ka(oa)})}function c(oa){var ja=Ma.call(this)||this;ja.$=oa;ja.Eb();return ja}function d(oa,ja){var ta=this;this.YV=function(){ta.Ad||ta.dqe()};this.Ad=!1;this.aZ=ja.rU;this.ariaLiveNotifier=oa;this.Z_d=new h(oa,ja);this.aZ&&this.aZ.MQ?this.dqe():this.Pi()}function e(oa,ja,ta){var aa=this;this.jzf=function(){aa.Z_d.EMf();aa.ariaLiveNotifier.setEnabled(!0)};
this.$=ja;this.ariaLiveNotifier=oa;this.Z_d=new h(oa,ja);this.E$b=ta.Gfd(this.$);this.E$b.LGg(this.jzf)}function h(oa,ja){this.$=ja;this.ariaLiveNotifier=oa}function k(oa){var ja=Ua.call(this)||this;ja.$=oa;ja.Eb();return ja}function n(oa,ja,ta,aa,ma){var Ea=this;this.gridReadoutNotifier=null;this.Nab=!1;this.ysa=this.Job=null;this.dda=function(){D.EwaSettings.isChangeGateEnabled("OfficeVSO:5963256_DoNotReadActiveItemIfDisposed")&&!Ea.$?F.ULS.sendTraceTag(526235470,0,15,"calling readActiveItemDescription after dispose, ignoring."):
K.g(Ea.$).isEditing||Ea.w0b.Iq()};this.$Gi=function(){if(!K.g(Ea.$).ha.Oa.ypd){var Ha=Ea.uIh();Ea.readText(Ha.returnValue,Ha.activeCell)}};this.cp=function(){var Ha=Ea.activeCell;Ea.readText("Editing",Ha);D.EwaSettings.isChangeGateEnabled("OfficeVSO:5190952_removePhoneticErrorDialog2")||Ha&&Ha.Ldc&&!K.g(Ea.$).M6e||Ea.w0b.cancel()};this.Rc=function(){D.EwaSettings.isChangeGateEnabled("OfficeVSO:6053639_DoNotHandleSelectionChangedIfDisposed")&&!Ea.$?F.ULS.sendTraceTag(525366409,0,15,"calling onSelectionChanged after dispose, ignoring."):
(Ea.dda(),Ea.Nab&&K.g(Ea.$).inRangePicker&&1===ra.a.Cb&&(null===Ea.Job?Ea.Job=bb.a.instance.create(Ea.WGd,n.GTc,"readSelectedRanges"):Ea.Job.Iq()))};this.$=ja;this.ariaLiveNotifier=oa;this.sparklineManager=aa;this.tableManager=ta;this.eD=new f;this.u6a=l.u6a();this.Nab=D.EwaSettings.isChangeGateEnabled("OfficeVSO:5888244_FixCellReadoutInRangePicking");this.u6a&&(D.EwaSettings.tb()?this.gridReadoutNotifier=ma:this.gridReadoutNotifier=ja.da.za(244),F.ULS.shipAssertTag(537153937,0,!!this.gridReadoutNotifier,
"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),n.GTc=700);this.w0b=bb.a.instance.create(this.$Gi,n.GTc,ba.a.Nnj,!1);this.Pi()}function f(){this.activeItemName=null;this.Wgf=!1;this.tableName=null;this.k0a=0;this.Dzc=!1}function v(){}function m(oa){switch(oa){case 1:return 1449;case 2:return 1450;case 3:return 1451;case 4:return 1452;case 5:return 1453;case 6:return 1454;case 7:return 1455;case 8:return 1456;case 9:return 1457;case 10:return 1458;case 11:return 1459;case 12:return 1460;
case 13:return 1461;case 14:return 1462;case 15:return 1463;case 16:return 1464;case 17:return 1465;case 18:return 1466;case 19:return 1467;case 20:return 1468;case 21:return 1469;case 22:return 1472;case 23:return 1470;case 24:return 1471;case 25:return 1473;case 26:return 1474;case 27:return 1475;case 28:return 1476;default:return 1477}}function x(oa){var ja=P.call(this)||this;ja.$=oa;ja.Eb();return ja}function l(oa,ja){this.l0=this.wW=this.SN=null;this.eja=ja;this.F$g(oa);this.R0i();D.EwaSettings.tb()&&
oa.da.Ga(244,this)}function u(oa){var ja=O.call(this)||this;ja.$=oa;ja.Eb();return ja}function A(oa,ja,ta){var aa=this;this.Hvf=function(ma,Ea){aa.vMf(Ea.Ed.command)};this.$=oa;this.bfa=document.createElement("div");this.bfa.setAttribute(S.a.uP,S.a.Wj);this.bfa.className=J.a.k9c;ja.insertBefore(this.bfa,ta);this.lga=document.createElement("div");this.lga.setAttribute(S.a.uP,S.a.Wj);this.lga.className=J.a.k9c;ja.insertBefore(this.lga,this.bfa);this.utg=G.a.instance.Xa(2);this.oha=document.createElement("div");
this.oha.setAttribute(S.a.Gd,S.a.csa);this.oha.setAttribute(S.a.esa,S.a.zob);this.oha.className=J.a.k9c;ja.insertBefore(this.oha,this.lga);this.register();this.$.da.Ga(211,this)}function z(oa,ja){ja&&(oa.append(ja),oa.append(y.Oud))}function y(oa){this.Juc=oa||""}var w=b(10),D=b(1);t=b(0);var H=b(235),F=b(15),J=b(30),S=b(5),N=b(12),T=b(22),G=b(14),I=b(268),K=b(21),L=b(29);y.p3a=function(oa){oa=L.a.yg(oa||"");return new y(oa)};y.V$b=function(oa){return y.p3a(G.a.instance.ga(oa))};y.Xbd=function(oa){return new y(G.a.instance.Xa(oa))};
y.oFh=function(oa,ja){for(var ta=[],aa=1;aa<arguments.length;++aa)ta[aa-1]=arguments[aa];return y.nFh.apply(y,[G.a.instance.mb(oa)].concat(kk(ta)))};y.nFh=function(oa,ja){for(var ta=[],aa=1;aa<arguments.length;++aa)ta[aa-1]=arguments[aa];aa=ta.length;for(var ma=Array(aa),Ea=0;Ea<aa;Ea++)ma[Ea]=(ta[Ea]||y.XKe).Juc;return new y(String.format(oa,ma))};of.Object.defineProperties(y,{XKe:{configurable:!0,enumerable:!0,get:function(){return y.S5d||(y.S5d=new y(""))}},Oud:{configurable:!0,enumerable:!0,get:function(){return y.Lae||
(y.Lae=y.Xbd(2).Juc)}}});y.S5d=null;y.Lae=null;Object(t.a)(y,"SafeHtml",null,[638]);A.prototype.dispose=function(){this.$&&this.unregister();N.DOMElementExtensions.gf(this.oha);N.DOMElementExtensions.gf(this.bfa);N.DOMElementExtensions.gf(this.lga);this.lga=this.bfa=this.oha=this.$=null};A.prototype.setEnabled=function(oa){this.GZf(this.lga,oa)};A.prototype.jrj=function(){this.GZf(this.bfa,!0)};A.prototype.readText=function(oa){this.MHb(y.p3a(oa),!0)};A.prototype.TPa=function(oa){this.MHb(y.p3a(oa),
!1)};A.prototype.yMf=function(oa,ja){if(1>ja||!oa)F.ULS.shipAssertTag(537153954,0,!1,"Skiping listbox description readout");else{var ta=new Sys.StringBuilder;oa=String.format(G.a.instance.mb(34),ja,oa);z(ta,oa);z(ta,G.a.instance.ga(855));this.MHb(y.p3a(ta.toString()),!1)}};A.prototype.T6i=function(oa,ja,ta){if(1>ta||1>ja||ja>ta||!oa)F.ULS.shipAssertTag(537153952,0,!1,"Skipping listbox item readout");else{var aa=new Sys.StringBuilder;z(aa,oa);aa.append(String.format(G.a.instance.mb(55),ja,ta));this.MHb(y.p3a(aa.toString()),
!1)}};A.prototype.vMf=function(oa){oa=this.qXh(oa);this.MHb(oa,!1)};A.prototype.MHb=function(oa,ja){if(oa=oa?oa.Juc:null)ja=ja?this.lga:this.bfa,T.a.equals(ja.innerHTML,oa,!1)&&(oa+=y.Oud),ja.innerHTML=oa};A.prototype.Sab=function(oa,ja){this.oha.getAttribute(S.a.esa)!==ja&&this.oha.setAttribute(S.a.esa,ja);oa=oa?y.p3a(oa).Juc:"";this.oha.innerHTML=oa};A.prototype.U6i=function(oa,ja,ta,aa){var ma=!0;ma=void 0===ma?!1:ma;var Ea=G.a.instance.mb(54);F.ULS.shipAssertTag(537153949,0,!(void 0===oa||null===
oa));F.ULS.shipAssertTag(537153948,0,!(void 0===ja||null===ja));F.ULS.shipAssertTag(537153947,0,!(void 0===ta||null===ta));F.ULS.shipAssertTag(537153946,0,!(void 0===aa||null===aa));F.ULS.shipAssertTag(537153945,0,!(void 0===Ea||null===Ea));oa=String.format(Ea,oa||"",ja||"",ta||"",aa||"");ma?this.Sab(oa,S.a.AZa):this.readText(oa)};A.prototype.KRj=function(oa){var ja=this.lga.style;oa?(oa=I.a.w1b(oa.cell,ja),ja=oa.AB,ja.top=ja.left=ja.bottom=ja.right=null,oa.L2()):ja.cssText=""};A.prototype.qXh=function(oa){switch(oa){case -1985798686:return y.V$b(12);
case -911352779:return y.V$b(11);case 237279923:return y.V$b(13);case -1502853784:return y.Xbd(81);case -111689794:return y.Xbd(78);case -287251124:return this.jgd(1326,function(ja){return ja.bold});case -1925065947:return this.jgd(1327,function(ja){return ja.italic});case 1764140053:return this.jgd(1328,function(ja){return ja.underline})}return null};A.prototype.register=function(){F.ULS.shipAssertTag(537153944,0,!!this.$,"Can't register to ewaControl's events");this.$&&(F.ULS.shipAssertTag(537153943,
0,!!this.$.Ka,"Can't register to CommandHandlerManager's event"),this.$.Ka&&this.$.Ka.RFa(this.Hvf))};A.prototype.unregister=function(){this.$&&this.$.Ka.Sza(this.Hvf)};A.prototype.GZf=function(oa,ja){var ta=oa===this.bfa;ja?(oa.setAttribute(S.a.esa,S.a.AZa),ta&&oa.setAttribute(S.a.Gd,S.a.csa),oa.setAttribute(S.a.uP,S.a.Uq),oa.removeAttribute(S.a.uP),oa.innerHTML+=" "):(oa.removeAttribute(S.a.esa),ta&&oa.removeAttribute(S.a.Gd),oa.setAttribute(S.a.uP,S.a.Wj))};A.prototype.jgd=function(oa,ja){var ta=
this.activeCell;if(!ta)return null;ja=ja(ta)?7:8;return y.oFh(ja,y.V$b(oa))};of.Object.defineProperties(A.prototype,{Mxa:{configurable:!0,enumerable:!0,get:function(){return this.utg}},isActive:{configurable:!0,enumerable:!0,get:function(){return!0}},activeCell:{configurable:!0,enumerable:!0,get:function(){return K.g(this.$).Ub(null)}}});Object(t.a)(A,"AriaLiveNotifier",null,[609,574,6]);var O=H.a;$k(u,O);u.prototype.create=function(){this.pb(this.$.da.za(211)||new A(this.$,this.$.Rv,this.$.uf))};
u.ka=function(oa){oa.da.Ga(212,new u(oa))};Object(t.a)(u,"AriaLiveNotifierFactory",H.a,[]);var B=b(27),Q=b(227),U=b(143),X=b(67);l.prototype.readText=function(oa){oa=String.format(G.a.instance.mb(30),oa);this.SN.setAttribute(S.a.Ft,oa);this.wW.setAttribute(S.a.Ft,oa);this.EIj()};l.prototype.dispose=function(){this.l0&&this.l0.parentNode&&this.l0.parentNode.removeChild(this.l0);this.wW=this.SN=this.l0=this.eja=null};l.prototype.F$g=function(oa){var ja=oa.zb+"readoutElementWrapper",ta=oa.zb+"readoutElement1",
aa=oa.zb+"readoutElement2";this.l0=document.getElementById(ja);this.l0||(this.l0=document.createElement(Q.a.div),this.l0.id=ja,this.SN=document.createElement(Q.a.label),this.SN.id=ta,this.SN.setAttribute(U.a.contentEditable,X.a.xPb),this.SN.setAttribute(S.a.Gd,S.a.BZa),this.wW=document.createElement(Q.a.label),this.wW.id=aa,this.wW.setAttribute(U.a.contentEditable,X.a.xPb),this.wW.setAttribute(S.a.Gd,S.a.BZa),this.SN.style.width="0px",this.SN.style.height="0px",this.wW.style.width="0px",this.wW.style.height=
"0px",this.SN.tabIndex=-1,this.wW.tabIndex=-1,this.l0.appendChild(this.SN),this.l0.appendChild(this.wW),oa=oa.zb+S.a.v2c,ja=document.getElementById(oa),F.ULS.shipAssertTag(537153942,3,!!ja,"FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: "+oa),ja&&ja.appendChild(this.l0))};l.prototype.R0i=function(){this.eja&&this.SN&&this.wW&&(this.eja.setAttribute(S.a.P2,this.SN.id),this.eja.setAttribute(S.a.bXc,this.SN.id+" "+this.wW.id))};l.prototype.EIj=function(){if(this.isActive){var oa=
"";N.DOMElementExtensions.hasAttribute(this.eja,S.a.P2)&&(oa=this.eja.getAttribute(S.a.P2).toString());this.eja.setAttribute(S.a.P2,oa===this.SN.id?this.wW.id:this.SN.id)}else F.ULS.shipAssertTag(537153941,0,!1,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")};l.u6a=function(){if(null==l.Aub)if(D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ActiveDescendantGridReadout",!1)&&!B.a.JMa)l.Aub=!0,F.ULS.sendTraceTag(537153940,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: ActiveDescendantGridReadout Flight is enabled");
else if(l.Aub=!1,B.a.xH||B.a.Pf)l.Aub=!0,F.ULS.sendTraceTag(537153939,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: The FocusBasedCellReadout BRS is on");return l.Aub};l.ka=function(oa){l.u6a()&&oa.da.Ga(244,new l(oa,K.g(oa).$b.textBox.Oe))};of.Object.defineProperties(l.prototype,{isActive:{configurable:!0,enumerable:!0,get:function(){return!!this.eja&&document.activeElement===this.eja}}});l.Aub=null;Object(t.a)(l,"FocusBasedReadout",null,[574,6]);var P=H.a;$k(x,P);x.prototype.create=function(){var oa=
this;l.u6a()?K.g(this.$).$b.textBox.dU(function(){var ja=oa.$.da.za(244)||new l(oa.$,K.g(oa.$).$b.textBox.Oe);oa.pb(ja)}):this.pb(null)};x.ka=function(oa){oa.da.Ga(315,new x(oa))};Object(t.a)(x,"FocusBasedReadoutFactory",H.a,[]);var ea=b(50),ia=b(37),da=b(7),xa=b(87),Z=b(85),ha=b(24),ya=b(41),va=b(252),bb=b(47),ba=b(45),fa=b(122);v.Zfd=function(oa){return v.t1e(oa.toString())};v.t1e=function(oa){return v.mYg.test(oa)?oa.replace(v.J5i,"$1 ").replace(v.I5i,' "$1"').trim():oa};v.vfj=function(oa){var ja=
oa.lastIndexOf("!");return oa.substring(0,-1<ja?ja+1:0)+v.t1e(oa.substring(-1<ja?ja+1:0,oa.length))};of.Object.defineProperties(v,{J5i:{configurable:!0,enumerable:!0,get:function(){return v.see||(v.see=RegExp("([A-Z]+)","g"))}},I5i:{configurable:!0,enumerable:!0,get:function(){return v.ree||(v.ree=RegExp("([A-Z])","g"))}},mYg:{configurable:!0,enumerable:!0,get:function(){return v.p3d||(v.p3d=RegExp("^\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+\\$?[0-9]+:\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+:\\$?[A-Z]+$|^\\$?[0-9]+:\\$?[0-9]+$"))}}});
v.see=null;v.ree=null;v.p3d=null;Object(t.a)(v,"RangeAriaExtensions",null,[]);Object(t.a)(f,"SelectionReadoutState",null,[]);b(64);var ra=b(76);n.prototype.dispose=function(){this.$&&this.Tj();xa.a.Ia(this.w0b);this.sparklineManager=this.$=this.w0b=null};n.prototype.qXe=function(oa,ja,ta){ta=void 0===ta?!0:ta;if(!oa)return"";var aa=this.$.da,ma=new Sys.StringBuilder;this.zLg(ma,oa,ja);if(D.EwaSettings.isChangeGateEnabled("OfficeVSO:4124702_ColumnHeaderReadout")){var Ea=this.tableManager.wva(oa.range);
(null===Ea||void 0===Ea?0:Ea.WRd)&&this.Dqe(ma,Ea);Ea=this.tableManager.Wm(oa.range);(null===Ea||void 0===Ea?0:Ea.lba)&&this.Dqe(ma,Ea)}Ea=oa.kba?this.$Ze(oa):oa.text;z(ma,Ea);Ea=this.$.activeItemName;this.eD.activeItemName!==Ea&&(z(ma,Ea),this.eD.activeItemName=Ea);Ea=1===ja.length?ya.K(ja).isSingle?"":G.a.instance.ga(851):String.format(G.a.instance.mb(31),ja.length);z(ma,Ea);Ea=ik(ja);for(var Ha=Ea.next();!Ha.done;Ha=Ea.next())Ha=Ha.value,z(ma,v.Zfd(Ha)),1===ja.length&&n.hpi(Ha)&&(Ha=K.g(this.$).Ea.Lr(Ha.bottomRight),
void 0!==Ha&&null!==Ha&&Ha.text&&(Ha=Ha.kba?this.ZZe(Ha,Ha.text):Ha.text,z(ma,Ha)));Ea=oa.cell;Ea=this.LUh(Ea.$jj,Ea.p0g);z(ma,Ea);this.iLg(ma,oa);ta&&(oa.U6a?z(ma,G.a.instance.ga(839)):oa.axa&&z(ma,G.a.instance.ga(840)));if(oa.hasAutoFilter||oa.D4)this.ALg(ma,oa.hasAutoFilter?oa.cell.autoFilterType:oa.cell.sZi),ta&&z(ma,G.a.instance.ga(842));va.c(this.$,oa.range)&&z(ma,G.a.instance.ga(846));this.fLg(ma,oa);ta=(ta=aa.za(14))?ta.yJh():"";z(ma,ta);oa.PE&&(ta=K.g(this.$).Ea.Lr(oa.range),ta=!!ta&&ta.a7e,
n.jxj(oa)?n.gLg(ma,oa):D.EwaSettings.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&ta?z(ma,G.a.instance.ga(844)):z(ma,G.a.instance.ga(843)));oa.jba&&(z(ma,G.a.instance.ga(845)),oa.hxb&&z(ma,String.format(G.a.instance.mb(16),oa.Rch)),z(ma,oa.iconName));oa.hasRichValueIcon&&(Ea=this.$.da.za(271),ta="",Ea&&oa.cell.Skf&&(Ea=Ea.cQ(oa.cell.Skf))&&Ea.DomainId.Id!==n.WYj&&(ta=Ea.Name),oa.cell.Pfi?(z(ma,String.format(G.a.instance.mb(182),ta)),z(ma,G.a.instance.ga(1799))):(z(ma,String.format(G.a.instance.mb(180),
ta)),z(ma,G.a.instance.ga(1798))));this.g6h(oa)&&z(ma,n.pQh(oa));(aa=aa.za(231))&&z(ma,aa.n_e(ja,!0));1===ja.length&&ja[0].isSingle&&n.ixj(oa,ja[0],this.$)&&(ja=this.$.da.za(271))&&z(ma,ja.LJh());oa.aOb&&oa.bOb&&z(ma,oa.bOb);(ja=oa.cell.ZWg)&&z(ma,ja);oa.$wa&&oa.GGb&&(oa=oa.BDd)&&(z(ma,G.a.instance.ga(1967)),z(ma,oa));return ma.toString()};n.prototype.Bve=function(oa){this.ysa=this.eD;this.eD=Object(da.a)(new f,{activeItemName:this.ysa.activeItemName,Dzc:oa?this.ysa.Dzc:!1,tableName:oa?this.ysa.tableName:
"",k0a:oa?this.ysa.k0a:-1})};n.prototype.eUf=function(){this.ysa&&(this.eD=this.ysa,this.ysa=null)};n.prototype.LUh=function(oa,ja){return 2===oa||2===ja?G.a.instance.ga(872):1===oa||1===ja?G.a.instance.ga(873):""};n.prototype.$Ze=function(oa){return this.ZZe(oa.cell,oa.text)};n.prototype.zLg=function(oa,ja,ta){if(ta&&1===ta.length&&ta[0].isSingle){ta="";var aa=this.tableManager.wva(ja.range);if(aa){ta=aa.pivotTableName;this.AWc(oa,ta);var ma=aa.Egc?G.a.instance.ga(834):"";D.EwaSettings.isChangeGateEnabled("OfficeVSO:6154754_NarratorReadoutForPivotTableAltText")&&
(ma+=(aa.altText?aa.altText+" . ":"")+(aa.altTextSummary?aa.altTextSummary:""));this.Fqe(oa,!0,ta,ma);z(oa,this.tableManager.fni(aa,ja.range)?G.a.instance.ga(836):"");z(oa,this.tableManager.ehi(aa,ja.range)?G.a.instance.ga(835):"")}else if(aa=this.tableManager.Wm(ja.range)){ta=(ma=K.g(this.$).Ab.dk(ja.range))?ma.name:"";this.AWc(oa,ta);var Ea="";ma&&D.EwaSettings.isChangeGateEnabled("OfficeVSO:6680193_FlighRemovalTableAltText")&&(Ea=(ma.VSa?ma.VSa+" . ":"")+(ma.WSa?ma.WSa:""));this.Fqe(oa,!1,ta,Ea);
z(oa,this.tableManager.Wdf(aa,ja.range)?G.a.instance.ga(835):"")}else this.AWc(oa,ta),this.eD.tableName="",this.eD.k0a=-1}};n.prototype.AWc=function(oa,ja){ja!==this.eD.tableName&&this.eD.tableName&&(oa.append(G.a.instance.ga(this.eD.Dzc?833:832)),z(oa," "+this.eD.tableName))};n.prototype.Fqe=function(oa,ja,ta,aa){ta!==this.eD.tableName&&(oa.append(G.a.instance.ga(ja?831:830)),z(oa," "+ta),z(oa,aa),this.eD.tableName=ta,this.eD.Dzc=ja,this.eD.k0a=-1)};n.prototype.Dqe=function(oa,ja){var ta=K.g(this.$).ha.sa.activeCell;
if(ta.top!==ja.top&&ta.left!==this.eD.k0a){oa.append(G.a.instance.ga(835));ja=new ha.Range(ja.top,ta.left,ja.top,ta.left,!0,!0);z(oa,v.Zfd(ja));if(ja=K.g(this.$).Ub(ja))ja=ja.kba?this.$Ze(ja):ja.text,z(oa,ja);this.eD.k0a=ta.left}};n.prototype.ZZe=function(oa,ja){var ta=oa.w5a;return oa.kxb?String.format(G.a.instance.mb(14),ja,ta):String.format(G.a.instance.mb(13),ja,v.vfj(ta))};n.prototype.Pi=function(){F.ULS.shipAssertTag(537153930,0,!!this.$,"Can't register to ewaControl's events");if(this.$){var oa=
K.g(this.$);F.ULS.shipAssertTag(537153929,0,!!oa,"Can't register to grid's events");oa&&(oa.Wb.Ak(this.cp),oa.Ea.lx(this.dda),oa.UD(this.dda),this.Nab&&oa.Wb.um(this.Ef.bind(this)),oa=oa.ha,F.ULS.shipAssertTag(537153928,0,!!oa,"Can't register to selectionManager's events"),oa&&(oa.wG(this.Rc),oa.hJ(this.dda),oa.Oa.D2(this.dda),this.Nab&&(this.WGd=this.WGd.bind(this))))}};n.prototype.Tj=function(){if(this.$){var oa=K.g(this.$);oa&&(oa.Wb.vk(this.cp),oa.Ea.gv(this.dda),oa.yF(this.dda),this.Nab&&oa.Wb.Nl(this.Ef),
oa=oa.ha)&&(oa.zF(this.dda),oa.IK(this.dda),oa.Oa.Uma(this.dda))}};n.prototype.readText=function(oa,ja){this.u6a&&this.gridReadoutNotifier&&this.gridReadoutNotifier.isActive?this.gridReadoutNotifier.readText(oa):(D.EwaSettings.isChangeGateEnabled("OfficeVSO:5033038_Embed_Mode_Grid_Narrator_Fix")&&this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(oa),this.Nab&&!ja||this.ariaLiveNotifier.KRj(ja))};n.prototype.Ef=function(){this.Job&&this.Job.cancel()};n.prototype.WGd=function(){this.readText(this.bYh())};
n.prototype.bYh=function(){var oa="";K.g(this.$).ha.rangePicker.CK.forEach(function(){oa+=void 0});return oa+=" selected"};n.prototype.uIh=function(){var oa=null;var ja=K.g(this.$).ha;if(1!==ja.Re&&!ja.Oa.Yb)return F.ULS.sendTraceTag(537153927,0,15,"selectionManager.CommandSelectionMode="+ja.Re+" and selectionManager.SelectedFloatingObjectControl is null"),{returnValue:"",activeCell:oa};switch(ja.Re){case 2:return{returnValue:this.vLh(ja),activeCell:oa};case 64:var ta=ja.Oa.Yb.floatingObject,aa="";
if(ja=ja.Oa.Yb.rs||ja.Oa.Yb.Dd)aa=(aa=ja.firstChild)?N.DOMElementExtensions.getTextContent(aa):"";return{returnValue:String.format(G.a.instance.mb(53),n.jac(ta.altText,ta.altTextDescription,ta.name),aa,ta.altTextDescription),activeCell:oa};case 4:return{returnValue:n.sKg(ja.Oa.Yb.floatingObject),activeCell:oa};case 512:return{returnValue:fa.a.NYe(ja.Oa.Yb.floatingObject.t7c),activeCell:oa};case 8:return ta=ja.Oa.Yb.floatingObject,{returnValue:String.format(G.a.instance.mb(51),ta?ta.name:""),activeCell:oa};
case 1:return oa=this.activeCell,{returnValue:this.qXe(oa,ja.sa.selectedRanges),activeCell:oa}}return{returnValue:"",activeCell:oa}};n.prototype.vLh=function(oa){var ja=new Sys.StringBuilder;ja.append(n.EXg(oa));var ta=this.$.da.za(231);ta&&z(ja,ta.n_e(oa.Oa.Yb.floatingObject,!1));return ja.toString()};n.prototype.g6h=function(oa){oa=oa.Ybf();var ja=!1;this.eD.Wgf!==oa&&(this.eD.Wgf=oa,ja=!0);return ja};n.prototype.iLg=function(oa,ja){if(ja.uxb)if(ja=this.sparklineManager.$Yh(ja)){var ta=G.a.instance,
aa=ta.ga;a:switch(ja.type){case 0:var ma=827;break a;case 1:ma=828;break a;default:ma=829}ta=aa.call(ta,ma);z(oa,String.format(G.a.instance.mb(25),ta));ja=String.format(G.a.instance.mb(24),v.Zfd(ja.$Ej));z(oa,ja)}else F.ULS.sendTraceTag(537153925,0,15,"No sparkline range was found on a cell with sparkline."),z(oa,String.format(G.a.instance.mb(25),""))};n.prototype.ALg=function(oa,ja){switch(ja){case 1:case 11:z(oa,G.a.instance.ga(847));break;case 6:z(oa,G.a.instance.ga(847));z(oa,G.a.instance.ga(849));
break;case 7:z(oa,G.a.instance.ga(847));z(oa,G.a.instance.ga(850));break;case 2:z(oa,G.a.instance.ga(848));z(oa,G.a.instance.ga(849));break;case 3:z(oa,G.a.instance.ga(848));z(oa,G.a.instance.ga(850));break;default:z(oa,G.a.instance.ga(848))}};n.prototype.fLg=function(oa,ja){var ta,aa=this.$.da.za(65);ja=aa?aa.aKa(ja.range):null;var ma="",Ea=Object(Z.a)(601,ja);if(ja)ma=!ja.D6a&&Ea&&Ea.Hoi?String.format(G.a.instance.mb(29),Ea.uJj):String.format(G.a.instance.mb(23),ja.author);else if(null===(ta=null===
aa||void 0===aa?void 0:aa.Cm)||void 0===ta?0:ta.QE)ma=String.format(G.a.instance.mb(28),aa.Cm.mN.author);z(oa,ma)};n.sKg=function(oa){return String.format(G.a.instance.mb(52),n.jac(oa.altText,oa.altTextDescription,oa.name),oa.altTextDescription)};n.pQh=function(oa){return G.a.instance.ga(oa.Ybf()?837:838)};n.jac=function(oa,ja,ta){return oa||ja?oa:ta};n.EXg=function(oa){var ja=oa.Oa.Yb;oa=ja.floatingObject;var ta=oa.Pc,aa=ta.ChartTitle,ma=oa.altText,Ea=oa.altTextDescription,Ha=!!(ta.Attributes&4);
return(ja=ja.getSelectionDescription())?ja:ta.DataRangeForDisplay?String.format(G.a.instance.mb(Ha?49:47),n.jac(ma,Ea,oa.name),Ea,aa,G.a.instance.ga(m(ta.ChartCategory)),ta.DataRangeForDisplay):String.format(G.a.instance.mb(Ha?50:48),n.jac(ma,Ea,oa.name),Ea,aa,G.a.instance.ga(m(ta.ChartCategory)))};n.jxj=function(oa){return D.EwaSettings.ma(103)&&(oa.l6a||oa.Cgc)};n.gLg=function(oa,ja){ja.CSa?ja.l6a?z(oa,String.format(G.a.instance.mb(26),ja.CSa.topLeft.toString())):ja.Cgc&&(ja=ja.CSa.pS(),z(oa,String.format(G.a.instance.mb(27),
(ja.LastColumn-ja.FirstColumn+1).toString(),(ja.LastRow-ja.FirstRow+1).toString()))):F.ULS.shipAssertTag(537153924,0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.")};n.ixj=function(oa,ja,ta){return oa.PE||!D.EwaSettings.ma(139)?!1:(oa=ta.da.za(271))?oa.$fc(ja):!1};n.hpi=function(oa){return oa.top===oa.bottom&&oa.left+1===oa.right||oa.top+1===oa.bottom&&oa.left===oa.right};of.Object.defineProperties(n.prototype,
{activeCell:{configurable:!0,enumerable:!0,get:function(){return K.g(this.$).Ub(null)}}});n.WYj=268435712;n.GTc=500;Object(t.a)(n,"SelectionReadoutHandler",null,[602,6]);var pa=b(58),Za=b(921),Ua=H.a;$k(k,Ua);k.prototype.create=function(){var oa=this,ja=this.$.da,ta=ea.GetServiceTaskFactory.Ra(ja,211,212,this.hb),aa=ea.GetServiceTaskFactory.Ra(ja,66,134,this.hb),ma=ea.GetServiceTaskFactory.Ra(ja,240,239,this.hb),Ea=pa.Task.Ua(null);D.EwaSettings.tb()&&(Ea=ea.GetServiceTaskFactory.Ra(ja,244,315,this.hb));
ia.TaskExtensions.Aa(ia.TaskExtensions.Vd([ta,aa,ma,Ea],this.la),function(){var Ha=Object(Za.a)(oa.$.da,226,function(){return new n(ta.result,oa.$,aa.result,ma.result,Ea.result)});oa.pb(Ha)},this.$.la,3)};k.ka=function(oa){oa.da.Ga(227,new k(oa))};Object(t.a)(k,"SelectionReadoutHandlerFactory",H.a,[]);h.prototype.EMf=function(){var oa=this.AJh();this.ariaLiveNotifier.Sab(oa,S.a.zob)};h.prototype.AJh=function(){var oa=new Sys.StringBuilder;this.$.workbookContext&&z(oa,this.$.workbookContext.WorkbookFileName);
z(oa,G.a.instance.ga(853));z(oa,this.CJh());z(oa,this.BJh());z(oa,G.a.instance.ga(854));return oa.toString()};h.prototype.CJh=function(){return this.$.isEditMode?G.a.instance.ga(858):G.a.instance.ga(859)};h.prototype.BJh=function(){var oa=this.gYj(),ja=this.$.xa.pa;oa=1!==oa?String.format(G.a.instance.mb(32),oa):G.a.instance.ga(852);oa=new Sys.StringBuilder(oa);ja&&ja.sheetName&&(oa.append(y.Oud),oa.append(String.format(G.a.instance.mb(33),ja.sheetName)));return oa.toString()};h.prototype.gYj=function(){for(var oa=
0,ja=ik(this.$.xa.items),ta=ja.next();!ta.done;ta=ja.next())ta.value.visible&&oa++;return oa};Object(t.a)(h,"WorkbookReadout",null,[]);e.prototype.dispose=function(){this.E$b&&this.E$b.bdj(this.jzf);this.E$b=this.ariaLiveNotifier=this.$=null};Object(t.a)(e,"EmbeddedWorkbookReadoutHandler",null,[6]);d.prototype.dispose=function(){this.Tj();this.ariaLiveNotifier=this.aZ=null;this.Ad=!0};d.prototype.Pi=function(){if(this.aZ){this.aZ.Au(this.YV);this.aZ.Ea.lx(this.YV);this.aZ.UD(this.YV);var oa=Object(Z.a)(424,
this.aZ);oa&&(oa.Wb.Ak(this.YV),oa.ha.wG(this.YV),oa.ha.hJ(this.YV),oa.ha.Oa.D2(this.YV))}else F.ULS.sendTraceTag(537153923,0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events")};d.prototype.Tj=function(){if(this.aZ){this.aZ.Ea.gv(this.YV);this.aZ.yF(this.YV);var oa=Object(Z.a)(424,this.aZ);oa&&(oa.Wb.vk(this.YV),oa.ha.zF(this.YV),oa.ha.IK(this.YV),oa.ha.Oa.Uma(this.YV))}};d.prototype.dqe=function(){this.Z_d.EMf();this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.jrj();
this.dispose()};Object(t.a)(d,"WorkbookReadoutHandler",null,[6]);var Ma=H.a;$k(c,Ma);c.prototype.create=function(){var oa=this,ja=ea.GetServiceTaskFactory.Ra(this.$.da,211,212,this.hb);if(this.$.$M){var ta=ea.GetServiceTaskFactory.Ra(this.$.da,12,477,this.hb);ia.TaskExtensions.Aa(ia.TaskExtensions.Vd([ja,ta],this.$.la),function(){var aa=Object(Za.b)(oa.$.da,228,function(){return new e(ja.result,oa.$,ta.result)});oa.pb(aa)},this.$.la,3)}else ia.TaskExtensions.Aa(ja,function(aa){var ma=Object(Za.b)(oa.$.da,
228,function(){return new d(aa.result,oa.$)});oa.pb(ma)},this.$.la,3)};c.ka=function(oa){oa.da.Ga(229,new c(oa))};Object(t.a)(c,"WorkbookReadoutHandlerFactory",H.a,[]);b.d(E,"a",function(){return a})},1368:function(t,E,b){function a(){D.a.Fa(function(Sa){c.ka(Sa)})}function c(Sa){return cb.call(this,Sa)||this}function d(Sa,Db,Ab,Wb){var ub=this;this.menuId=null;this.kRa=-1;this.QDf=function(){ub.lda()};this.EUi=function(vb){if(!(ub.sa.QLa()||(!ha.EwaSettings.isChangeGateEnabled("OfficeVSO:4124510_JsCrashOnToggleTableStyleOptionSuccessful")||
Z.a(vb)||ub.hMa())&&Z.a(vb)&&ub.hMa())){vb=ub.sa.activeCell;var Ka=ub.sa.activeRange,eb=ub.tableManager.Fg.usedRange;2===ub.kRa&&P.g(ub.tableManager.Fg)&&vb.bottom===eb.bottom&&(Ka=Ka.x5?new I.Range(Ka.top-1,Ka.left,Ka.bottom-1,Ka.right,!1,!0):new I.Range(Ka.top,Ka.left,Ka.bottom-1,Ka.right,!1,!0),vb=Ka.contains(vb)?vb:I.Range.Qc(Ka.bottom,vb.left),ba.g(ub.$).ha.updateSelection(Ka,vb,0,3))}};this.WTi=function(vb){Z.a(vb)?(S.ULS.sendTraceTag(594130062,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename failed due invalid user input"),
ub.$.hf()):S.ULS.sendTraceTag(594130061,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename successful")};this.VTi=function(){S.ULS.sendTraceTag(594130060,0,15,"TableManager.OnTableRenameFailure-Rename table failed");ub.$.hf()};this.XTi=function(vb,Ka){Ka&&ub.nL(Ka);Z.b(vb,-569193796)&&(La.a(ub.$).dd.eJ(-569193796),ub.Msi(vb.Errors[0]))};this.$=Sa;this.tableManager=Db;this.namedSheetViewPublic=Ab;this.frame=this.$.frame;this.ha=ba.g(this.$).ha;this.sa=this.ha.sa;this.Sx=ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");
this.tableStyleManager=Wb;this.tableStyleManager.THg(this.QDf)}function e(Sa){Sa=Ea.call(this,Sa)||this;var Db=ba.g(Sa.$);Db=Db.Ab.dk(Db.ha.sa.activeCell);va.a.gh(Db.VSa)?Sa.zCd="":Sa.zCd=Db.VSa;va.a.gh(Db.WSa)?Sa.xCd="":Sa.xCd=Db.WSa;Db=Sa.JM(Sa.zCd,Sa.xCd);Sa.initializeAndShow(oa.a.instance.ga(745),Sa.ZIj,Db);return Sa}function h(Sa){var Db=ma.call(this,Sa)||this;Db.iJj=function(Ab,Wb){1===Ab&&Db.VNj(B.D(Db.nGf(Wb[h.OLf])))};Db.Rvb=function(Ab){Ab=Db.Xed(Ab);return Db.ocd(Ab)};Db.gridView=ba.g(Sa);
Db.sa=Db.gridView.ha.sa;Db.npc=Db.gridView.Ab.dk(Db.sa.activeCell).usedRange;Sa=Db.JM(Db.npc.toString());Db.initializeAndShow(oa.a.instance.ga(736),Db.iJj,Sa);return Db}function k(Sa,Db){Sa=ta.call(this,Sa)||this;Sa.hBa=Db;return Sa}function n(Sa,Db){Sa=ja.call(this,Sa,oa.a.instance.ga(735))||this;Sa.hBa=Db;return Sa}function f(Sa,Db,Ab){this.Rpd=!1;this.sharedSheetRange=Db;this.$=Sa;this.Oh=this.$.Fb.Mg("UserAction","ConvertToRangeManager");this.tableName=Ab}function v(Sa){this.tableName=null;this.tableName=
Sa}function m(Sa,Db,Ab){this.isPivotTable=!1;this.tableRange=null;this.optionType=0;this.tableRange=Sa;this.optionType=Db;this.isPivotTable=Ab}function x(Sa){this.originalRange=null;this.originalRange=Sa}function l(Sa,Db){this.newName=this.oldName=null;this.oldName=Sa;this.newName=Db}function u(Sa,Db,Ab){this.description=this.title=this.tableRange=null;this.tableRange=Sa;this.title=Db;this.description=Ab}function A(Sa,Db,Ab,Wb){Sa=z.call(this,Sa,Ab)||this;Sa.hasHeaders=!1;Sa.isCreation=!1;Sa.hasHeaders=
Db;Sa.isCreation=Wb;return Sa}function z(Sa,Db){this.tableRange=this.tableRanges=null;this.styleIndex=0;this.tableRanges=Sa;this.tableRange=B.l(Sa.Ranges[0],Sa.SheetName);this.styleIndex=Db}function y(Sa){this.autoFilterOptions=null;this.autoFilterOptions=Sa}function w(Sa,Db){this.autoFilterOptions=null;this.sortType=0;this.autoFilterOptions=Sa;this.sortType=Db}var D=b(10);t=b(0);var H=b(915),F=b(50),J=b(37),S=b(15),N=b(4),T=b(30),G=b(5),I=b(24),K=b(76),L=b(54);w.prototype.aV=function(){return this.autoFilterOptions};
Object(t.a)(w,"MacroRecorderRangeColumnSortedOrFilteredPayload",null,[430]);y.prototype.aV=function(){return this.autoFilterOptions};Object(t.a)(y,"MacroRecorderRangeItemFilteredPayload",null,[430]);var O=b(1146),B=b(41),Q=b(394),U=b(177),X=b(62),P=b(169),ea=b(252),ia=b(47),da=b(45),xa=b(12),Z=b(299),ha=b(1),ya=b(187),va=b(22),bb=b(298),ba=b(21);Object(t.a)(z,"MacroRecorderTableStyleAppliedPayload",null,[430]);$k(A,z);Object(t.a)(A,"MacroRecorderRangeFormatedAsTablePayload",z,[]);u.prototype.Wm=function(){return this.tableRange};
u.prototype.getTitle=function(){return this.title};u.prototype.getDescription=function(){return this.description};Object(t.a)(u,"MacroRecorderTableAltTextEditedPayload",null,[430]);Object(t.a)(l,"MacroRecorderTableRenamedPayload",null,[430]);Object(t.a)(x,"MacroRecorderTableResizedPayload",null,[430]);Object(t.a)(m,"MacroRecorderTableStyleOptionToggledPayload",null,[430]);var fa=b(31),ra=b(43);Object(t.a)(v,"MacroRecorderTableConvertedToRangePayload",null,[430]);var pa=b(965);f.prototype.V$a=function(){var Sa=
this;this.Oh.start();var Db=this.$.oa.va.Pb();return pa.h(this.$.oa.va,this.sharedSheetRange,function(Ab){Sa.showDialog(Ab)},null,null,null,Db)};f.prototype.showDialog=function(Sa){var Db=this;S.ULS.sendTraceTag(537151193,0,50,"ConvertToRangeManager.ShowDialog: Time taken to show Get IsRangeQueryTable is "+this.Oh.qc+" milliseconds");Sa&&!Z.a(Sa)&&((this.Rpd=Sa.Result)?(Sa=fa.a.Xc(3,2,0,741,0,-66108047,"ConvertToRange"),J.TaskExtensions.Aa(ra.a(this.$).gj(Sa),function(Ab){S.ULS.sendTraceTag(537151192,
0,50,"ConvertToRangeManager.ShowDialog: Time taken for User Input is "+Db.Oh.qc+" milliseconds");0===Ab.result&&Db.B4g()},this.$.la,11)):this.C4g());this.Oh.stop();S.ULS.sendTraceTag(537151191,0,50,"ConvertToRangeManager.ShowDialog: Total Time taken for complete operation is "+this.Oh.qc+" milliseconds")};f.prototype.Fue=function(){var Sa={};Sa.IsQueryTable=this.Rpd;Sa.Range=this.sharedSheetRange;return Sa};f.prototype.B4g=function(){var Sa=this,Db=this.$.oa.va;S.ULS.sendTraceTag(537151190,0,50,"Convert To Range initiated for Query Table");
this.jbf(194,function(Ab,Wb,ub){return pa.d(Db,Sa.Fue(),Ab,Wb,ub,null)});S.ULS.sendTraceTag(537151189,0,50,"Convert To Range completed for Query Table")};f.prototype.C4g=function(){var Sa=this,Db=this.$.oa.va;S.ULS.sendTraceTag(537151188,0,50,"Convert To Range initiated for Normal Table");this.jbf(193,function(Ab,Wb,ub){return pa.c(Db,Sa.Fue(),Ab,Wb,ub,null)},function(){return new v(Sa.tableName)});S.ULS.sendTraceTag(537151187,0,50,"Convert To Range completed for Normal Table")};f.prototype.jbf=function(Sa,
Db,Ab){Ab=void 0===Ab?null:Ab;Q.a(this.$.userOperationManager,Db,function(Wb){return new U.a(Sa,0,Wb,void 0,Ab)},null)};Object(t.a)(f,"ConvertToRangeManager",null,[]);var Za=b(1340),Ua=b(1339),Ma=b(1472),oa=b(14),ja=Ma.a;$k(n,ja);n.prototype.Zi=function(){var Sa=this,Db=B.s(this.mC.TableRange);return function(){return new A(Db,Sa.e5a.checked,Sa.hBa,!0)}};n.prototype.Ny=function(){var Sa=this,Db=B.s(this.mC.TableRange);return function(Ab,Wb,ub){return pa.g(Sa.$.oa.va,Db,Sa.e5a.checked,!1,Sa.mC.HasTotalRow,
Sa.hBa,Ab,Wb,ub,null)}};n.prototype.ay=function(Sa,Db,Ab){ja.prototype.ay.call(this,Sa,Db,Ab)};of.Object.defineProperties(n.prototype,{mc:{configurable:!0,enumerable:!0,get:function(){return"FormatAsTableDialog"}},vv:{configurable:!0,enumerable:!0,get:function(){return 215}}});Object(t.a)(n,"FormatAsTableDialogDeprecated",Ma.a,[]);Ma=b(1167);var ta=Ma.a;$k(k,ta);k.prototype.Zi=function(){var Sa=this,Db=B.s(this.mC.TableRange);return function(){return new A(Db,Sa.hasHeaders,Sa.hBa,!0)}};k.prototype.Ny=
function(){var Sa=this,Db=B.s(this.mC.TableRange),Ab=this.mC.HasTotalRow;return function(Wb,ub,vb){return pa.g(Sa.$.oa.va,Db,Sa.hasHeaders,!1,Ab,Sa.hBa,Wb,ub,vb,null)}};of.Object.defineProperties(k.prototype,{mc:{configurable:!0,enumerable:!0,get:function(){return"FormatAsTableDialog"}},vv:{configurable:!0,enumerable:!0,get:function(){return 215}},zl:{configurable:!0,enumerable:!0,get:function(){return oa.a.instance.ga(735)}}});Object(t.a)(k,"FormatAsTableReactDialog",Ma.a,[]);Ma=b(300);var aa=b(98),
ma=Ma.a;$k(h,ma);h.prototype.nGf=function(Sa){Sa=Sa.startsWith("=")?Sa.substring(1,Sa.length):Sa;var Db=B.Z(Sa,this.$.xa);Sa=Db.sheetName;var Ab=Db.range;return Db.returnValue&&Ab?(Ab=B.v(Ab,this.$),Ab.SheetName=va.a.equals(Sa,"",!0)?this.$.pa.name:Sa,Ab):null};h.prototype.JM=function(Sa){var Db={};return Db[h.O4]="ResizeTableDialog",Db[h.OLf]=Sa,Db.getInputErrorIfInvalid=this.Rvb,Db};h.prototype.Xed=function(Sa){Sa=this.nGf(Sa);if(!Sa)return 1;var Db=B.D(Sa);return va.a.equals(Sa.SheetName,this.$.pa.sheetName,
!0)&&this.npc.top===Db.top&&this.npc.xd(Db)?0:2};h.prototype.ocd=function(Sa){var Db="";switch(Sa){case 1:Db=oa.a.instance.ga(75);break;case 2:Db=aa.a.rh(oa.a.instance.ga(74))}return Db};h.prototype.VNj=function(Sa){var Db={};Sa=(Db.ResizeTableRange=Sa,Db.OriginalTableRange=this.npc,Db);this.$.Cd(-1400250766,K.a.Cb,8,Sa)};of.Object.defineProperties(h.prototype,{mc:{configurable:!0,enumerable:!0,get:function(){return"ResizeTableDialog"}}});h.O4="id";h.OLf="range";Object(t.a)(h,"ResizeTableDialog",
Ma.a,[]);var Ea=Ma.a;$k(e,Ea);e.prototype.ZIj=function(Sa,Db){if(1===Sa&&(Sa=Db[e.CLj],Db=Db[e.Yeh],Sa!==this.zCd||Db!==this.xCd)){var Ab={};Sa=(Ab.Title=Sa,Ab.Description=Db,Ab);this.$.Cd(868579142,K.a.Cb,8,Sa)}};e.prototype.JM=function(Sa,Db){var Ab={};return Ab.id="AltTextDialog",Ab.title=Sa,Ab.description=Db,Ab};of.Object.defineProperties(e.prototype,{mc:{configurable:!0,enumerable:!0,get:function(){return"TableAltTextDialog"}}});e.O4="id";e.CLj="title";e.Yeh="description";Object(t.a)(e,"TableAltTextDialog",
Ma.a,[]);var Ha=b(993),Aa=b(994),V=b(112),La=b(68),Ra=b(58),pb=b(36);d.prototype.Nc=function(Sa,Db){switch(Db){case -544558380:return!(this.tableManager&&this.sa.$J()&&!this.hMa()&&P.d(this.tableManager.Fg));case 1544516694:return!(this.tableManager&&(this.sa.$J()?!this.hMa():this.sa.QLa()));case -697806646:case 323142015:return!this.sa.$J();case 341449783:case 2128797448:return ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6083078_HeaderAndTotalRowDisabledFix")?!(this.tableManager&&(this.sa.$J()?
!this.hMa():this.sa.QLa())):!(this.tableManager&&this.tableManager.brd(this.sa.activeCell));case -123538519:return!(this.sa.$J()&&this.tableStyleManager&&this.tableStyleManager.Bic());case 756677940:return!(ha.EwaSettings.ma(409)&&this.jfi());case 753331043:case 2105103744:case -585683120:return!(this.tableStyleManager&&this.kfi());case 844144422:return!this.sa.$J();case -723113214:return!(ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6680193_FlighRemovalTableAltText")&&this.sa.$J())}return!1};d.prototype.executeCommand=
function(Sa,Db,Ab){var Wb=this,ub;Sa=J.TaskExtensions.kk();var vb=this.$.oa.va,Ka=null,eb=1,yb=Db.command,oc=this.$.oa.va.Pb(),Jb=null;switch(yb){case -2058042992:var dc=L.a.Wh(Ab[K.a.Wf]);ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6709953_Fix_MacroRecording_ClearFilterInAFMenu")&&(dc.CriteriaType=0);d.RYf(this.$,dc);Ka=function(hb,Xb,Gc){return pa.a(vb,dc,null,null,!1,!1,!1,Ha.a.Bva(V.a.ksa,Aa.a.clearAutoFilter,hb),Xb,Gc,null)};eb=176;Jb=function(){return new y(dc)};break;case 504133448:case -798968736:case 477776686:var $a=
L.a.Wh(Ab[K.a.Wf]),Ba=Ab.TopCellAddress;d.RYf(this.$,$a);var la=504133448===Db.command?1:-798968736===Db.command?2:3;if(ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6516289_SheetProtectionSettings")&&Ba){Ab=this.tableManager.Wm(Ba);if(!Ab&&ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")){var ka=this.$.xa.pa;(null===(ub=B.D(ka.L0))||void 0===ub?0:ub.contains(Ba))?Ab=B.D(ka.L0):S.ULS.sendTraceTag(527700033,0,15,"TableCommandHandler.executeCommand: unknown sort range; unable to check for protected ranges")}if(!this.$.isEditMode){if(!ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")||
Ab&&!this.$.VWc([Ab],!0,1))break}else if(Ab&&!this.$.iq([Ab],!0,1))break}Ka=function(hb,Xb,Gc){return X.I(vb,$a,la,bb.b(hb,Wb.XTi),Xb,Gc,Ba,oc)};eb=177;Jb=function(){return new w($a,la)};break;case 341449783:case 2128797448:this.kRa=341449783===yb?0:2;ub=this.toggleTableStyleOption(vb,oc);Ka=ub.gCa;eb=ub.operationName;Jb=ub.Zi;break;case -712419744:this.Sx?this.Vaf(Ab[G.a.event]):this.Vaf(null);break;case 1868184698:if(ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6224451_CreateTableInEmptyCell")&&
(Ab=this.Kag(null,oc),ub=Ab.dzb,Ka=Ab.gCa,Jb=Ab.Zi,ub)){eb=206;break}ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TablesReactDialog",!1)?new Ua.a(this.$):(ub=new Za.a(this.$),ub.initialize(),ub.qf());break;case 844144422:new h(this.$);break;case 1544516694:case -544558380:if(ub=Ab[K.a.Mc])this.kRa=this.VZh(ub),-1!==this.kRa&&(ub=this.toggleTableStyleOption(vb,oc),Ka=ub.gCa,eb=ub.operationName,Jb=ub.Zi);break;case 756677940:if(this.hMa()&&this.$ff()){S.ULS.sendTraceTag(537151177,0,
15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while executing rename command");break}var ca=Ab.Text,Ia=this.fSh();if(Ia){Ka=function(hb,Xb,Gc){return pa.i(vb,ca,Ia,bb.b(hb,Wb.WTi),bb.a(Xb,Wb.VTi),Gc,oc)};eb=217;var jb=null;this.tableManager.Fg?jb=this.tableManager.Fg.name:this.tableManager.dFd?jb=this.tableManager.dFd.name:S.ULS.sendTraceTag(537151176,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while fetching oldName during executing rename command");
jb&&(Jb=function(){return new l(jb,ca)})}else return S.ULS.sendTraceTag(537151175,0,10,"TableCommandHandler.RenameTable: Selected Table Range is null"),Ra.Task.Ua(!1);break;case 323142015:if(this.hMa())break;return(new f(this.$,this.Gcd(),this.tableManager.Fg.name)).V$a();case -1400250766:eb=211;Ka=this.aij(Ab,vb,oc);var nb=B.m(Ab.OriginalTableRange,this.$.xa.pa);Jb=function(){return new x(nb)};break;case 1872288872:this.tableManager.t4i();break;case -123538519:var Na=this.UZh(Ab);ub=va.a.contains(Ab[K.a.Mc],
G.a.bHb,!0)||va.a.contains(Ab[G.a.NF],"TableStyleIcon",!0)?"Preview Gallery":"Pop-out Gallery";S.ULS.sendTraceTag(51181323,0,50,"TableStyleManager.ApplyTableStyleWebInvocation - Apply Table Style Invoked from "+ub+" with style index "+Na.toString());var sa=this.l2e();sa&&(Ka=function(hb,Xb,Gc){return pa.b(vb,sa,Na,hb,Xb,Gc,null,oc)},Jb=function(){return new z(sa,Na)},eb=212);break;case 753331043:ub=Ab[K.a.Mc];if(!ub)break;var Wa=Number.parseInvariant(ub);if(this.sa.$J()){S.ULS.sendTraceTag(51181321,
0,50,"TableCommandHandler.FormatAsTable invoked on existing table with style index: "+Wa);var Hb=this.l2e();Hb&&(Ka=function(hb,Xb,Gc){return pa.g(vb,Hb,!1,!1,!1,Wa,hb,Xb,Gc,null,oc)},Jb=function(){return new A(Hb,!1,Wa,!1)},eb=215);break}if(ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6224451_CreateTableInEmptyCell")&&(ka=this.Kag(Wa,oc),Ab=ka.dzb,Ka=ka.gCa,Jb=ka.Zi,Ab)){eb=215;break}S.ULS.sendTraceTag(51181322,0,50,"TableCommandHandler.FormatAsTable invoked on newly created table with style index: "+
Wa);ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TablesReactDialog",!1)?new k(this.$,Number.parseInvariant(ub)):(ub=new n(this.$,Number.parseInvariant(ub)),ub.initialize(),ub.qf());break;case 71074531:var Yb=Ab.HasHeader,Sb=Ab.TableRange;Ka=function(hb,Xb,Gc){return pa.e(vb,Sb,Yb,!1,!1,hb,Xb,Gc,null)};Jb=function(){return new O.a(Yb,Sb)};eb=206;break;case -723113214:new e(this.$);break;case 868579142:S.ULS.sendTraceTag(526463700,0,50,"AltText on table changed.");eb=1022;var lb=Ab.Title,
wb=Ab.Description,wa=this.Gcd();Ka=function(hb,Xb,Gc){return pa.f(vb,lb,wb,wa,hb,Xb,Gc,null)};if(this.tableManager.Fg){ka=va.a.gh(this.tableManager.Fg.VSa)?"":this.tableManager.Fg.VSa;var Oa=va.a.gh(this.tableManager.Fg.WSa)?"":this.tableManager.Fg.WSa}Jb=lb==ka?function(){return new u(wa,void 0,wb)}:wb==Oa?function(){return new u(wa,lb,void 0)}:function(){return new u(wa,lb,wb)};break;default:return ya.a(yb)}if(Ka){var Ub=function(hb){return new U.a(eb,0,hb,void 0,Jb)};Sa=!this.namedSheetViewPublic||
-2058042992!==yb&&504133448!==yb&&-798968736!==yb&&477776686!==yb?Q.a(this.$.userOperationManager,Ka,Ub,Db):this.namedSheetViewPublic.RAa().continueWith(function(hb){hb.result&&Q.a(Wb.$.userOperationManager,Ka,Ub,Db)})}return Sa};d.prototype.toggleTableStyleOption=function(Sa,Db){var Ab=this,Wb=this.sa.QLa();S.ULS.sendTraceTag(41996800,0,50,"TableCommandHandler: The selected "+(Wb?"PivotTable":"table")+" style option "+this.kRa+" was toggled.");var ub=this.Gcd();return{gCa:function(vb,Ka,eb){return pa.k(Sa,
ub,Ab.kRa,bb.b(vb,Ab.EUi),Ka,eb,null,Db)},operationName:196,Zi:function(){return new m(ub,Ab.kRa,Wb)}}};d.prototype.aij=function(Sa,Db,Ab){function Wb(yb){yb.Errors&&vb.tableManager.L8f(Ka)}function ub(){vb.tableManager.L8f(Ka)}var vb=this,Ka=Sa.OriginalTableRange,eb=B.m(Sa.ResizeTableRange,this.$.xa.pa);return function(yb,oc,Jb){return pa.j(Db,eb,bb.b(yb,Wb),bb.a(oc,ub),Jb,null,Ab)}};d.prototype.UZh=function(Sa){var Db=-1;Sa[K.a.Mc]&&(Db=Sa[K.a.Mc],Db=va.a.contains(Db,G.a.bHb,!0)?this.tableStyleManager.Qvb(Db):
Number.parseInvariant(Sa[K.a.Mc]));return Db};d.prototype.Ac=function(Sa,Db){Sa=!1;switch(Db.command){case -2058042992:case 504133448:case -798968736:case 477776686:case 341449783:case 2128797448:case -712419744:case 1868184698:case 1872288872:case 323142015:case 1544516694:case -544558380:case -1400250766:case -123538519:case 753331043:case 844144422:case 71074531:Sa=!0;break;case 756677940:Sa=ha.EwaSettings.ma(409);break;case -723113214:case 868579142:Sa=ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6680193_FlighRemovalTableAltText")}return Sa};
d.prototype.Tc=function(Sa,Db,Ab){Sa=!1;switch(Db){case "PopulateTableMoreStylesMenu":this.menuId=Ab.MenuId;this.tableStyleManager.Bic()||this.tableStyleManager.GKa("formatAsTableMenu");Sa=this.tableStyleManager.JHf(Db,Ab);break;case "PopulateTableAccessibleStylesMenu":this.menuId=Ab.MenuId,this.tableStyleManager.Bic()||this.tableStyleManager.GKa("accessibilityTab"),Sa=this.tableStyleManager.JHf(Db,Ab)}return Sa};d.prototype.dispose=function(){this.tableStyleManager.Vdj(this.QDf)};d.prototype.lda=
function(){(va.a.contains(this.menuId,"Format",!0)||va.a.contains(this.menuId,"Accessible",!0))&&this.menuId&&this.frame.Pw(this.menuId)};d.prototype.Gcd=function(){return B.v(this.sa.activeCell,this.$)};d.prototype.fSh=function(){var Sa=this.tableManager.qsd;return Sa?B.v(Sa,this.$):null};d.prototype.Vaf=function(Sa){if(this.tableManager){var Db=ba.g(this.$),Ab=this.sa.activeCell,Wb=this.tableManager.Wm(Ab),ub=null;if(!Wb||Wb.Zna)for(Db=ik(Db.NY),Wb=Db.next();!Wb.done;Wb=Db.next()){Wb=ik(Wb.value);
for(var vb=Wb.next();!vb.done;vb=Wb.next()){vb=vb.value;var Ka=vb.Gn;Ab.left>=Ka[0]&&Ab.left<=Ka[Ka.length-1]&&(ub=(vb=vb.Mr(Ab).QJ())?xa.DOMElementExtensions.Bj(vb,T.a.mpe):null)}}else{var eb=Db.Ub(I.Range.Qc(Wb.top,Ab.left));if(this.Sx){ia.a.instance.create(function(){eb.invoke(8,Sa)},0,da.a.E8f,!0,!0);return}ub=eb.pKa(56).Q5a}ub&&ia.a.instance.create(function(){xa.DOMElementExtensions.zfc(ub,null)},0,da.a.E8f,!0,!0)}};d.prototype.VZh=function(Sa){Sa=Number.parseInvariant(Sa);return-1<Sa&&8>=Sa?
Sa:-1};d.prototype.hMa=function(){return!this.tableManager.Fg};d.prototype.$ff=function(){return this.tableManager.dFd?!1:(S.ULS.sendTraceTag(537151173,0,15,"TableCommandHandler.IsPreviousSelectedTableObjectNull PreviousSelectedTableObject is null"),!0)};d.prototype.kfi=function(){var Sa=this.sa.$J(),Db=this.sa.rg&&!ba.g(this.$).Ab.p5(this.sa.Vc);return Sa||Db};d.prototype.jfi=function(){return this.sa.$J()||!this.$ff()};d.prototype.XZh=function(Sa){var Db=[];Sa=ik(Sa);for(var Ab=Sa.next();!Ab.done;Ab=
Sa.next())if(Ab=ea.b(this.$,Ab.value),null===Ab||void 0===Ab?0:Ab.length){Ab=ik(Ab);for(var Wb=Ab.next();!Wb.done;Wb=Ab.next())Wb=Wb.value,Wb.usedRange&&!Db.includes(Wb.usedRange)&&Db.push(Wb.usedRange)}return Db};d.prototype.l2e=function(){var Sa=this.sa.selectedRanges,Db=[];if(ha.EwaSettings.isChangeGateEnabled("OfficeVSO:3987000_ApplyTableStylesOnMultipleTablesInSingleRange"))Db=this.XZh(Sa);else{Sa=ik(Sa);for(var Ab=Sa.next();!Ab.done;Ab=Sa.next())Ab=Ab.value,ba.g(this.$).Ab.p5(Ab)&&Db.push(Ab)}return Db&&
Db.length?B.r(Db,this.$):null};d.prototype.nL=function(Sa){pb.a.Oba(this.$)&&J.TaskExtensions.Aa(F.GetServiceTaskFactory.Ra(this.$.da,430,431,1),function(Db){Db.result.vea(Sa);S.ULS.sendTraceTag(537151172,306,50,"TableCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.la,3)};d.prototype.Msi=function(Sa){var Db=this;J.TaskExtensions.Aa(F.GetServiceTaskFactory.Ra(this.$.da,446,447,0),function(Ab){Ab.result.Aah(Db.$,Sa)},this.$.la,3)};d.RYf=function(Sa,Db){Db.SheetName=
Sa.pa.name;Db.NamedObjectView=Sa.ea.isNamedObjectViewMode};d.prototype.Kag=function(Sa,Db){var Ab=this;if(!this.sa.rg||1!=this.sa.Vc.FG)return{dzb:!1,gCa:Ka,Zi:eb};var Wb=B.v(this.sa.Vc,this.$);Wb.LastColumn=Wb.FirstColumn+3-1;Wb.LastRow=Wb.FirstRow+4-1;var ub=B.D(Wb),vb=ba.g(this.$);if(!ub.isValidRange||!vb.Ab.bxa(ub))return{dzb:!1,gCa:Ka,Zi:eb};N.AFrameworkApplication.A_("XLS-CreateTableInEmptyCell-Treatment;XLS-CreateTableInEmptyCell-Control");if(!ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateTableInEmptyCell",
!1))return{dzb:!1,gCa:Ka,Zi:eb};if(null==Sa){var Ka=function(oc,Jb,dc){return pa.e(Ab.$.oa.va,Wb,!1,!1,!1,oc,Jb,dc,Db)};var eb=function(){return new O.a(!1,Wb)}}else{var yb=B.s(Wb);Ka=function(oc,Jb,dc){return pa.g(Ab.$.oa.va,yb,!1,!1,!1,Sa,oc,Jb,dc,Db)};eb=function(){return new A(yb,!1,Sa,!0)}}return{dzb:!0,gCa:Ka,Zi:eb}};Object(t.a)(d,"TableCommandHandler",null,[401]);var cb=H.a;$k(c,cb);c.prototype.dispose=function(){cb.prototype.dispose.call(this)};c.prototype.zd=function(){var Sa=this,Db=F.GetServiceTaskFactory.create(this.$.da,
134,this.la,this.hb),Ab=F.GetServiceTaskFactory.create(this.$.da,330,this.la,this.hb),Wb=F.GetServiceTaskFactory.Ra(this.$.da,309,310,this.hb);J.TaskExtensions.Aa(Ra.Task.uL(Db,Wb,Ab),function(){Sa.jd([new d(Sa.$,Db.result,Wb.result,Ab.result)],[2128797448,341449783,1544516694,-544558380,-123538519,753331043,756677940])},this.$.la,3)};c.ka=function(Sa){H.a.Pd(86,new c(Sa))};Object(t.a)(c,"TableCommandHandlerFactory",H.a,[]);b.d(E,"a",function(){return a})},1370:function(t,E,b){function a(){Type.registerNamespace("Common.App.NewAndOpen.Core");
ya.a.instance.Qi(new c)}function c(){this.vmb=this.Cee=this.fb=null;this.om=!1}function d(va,bb,ba,fa,ra,pa,Za){this.Hgb={};this.Z1=va;this.ktg=bb;this.bra=new h(D.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),D.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.uw.dmc);this.Dra=new h(D.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),D.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",
3),this.uw.dmc);this.Hvg=ba;this.Hje=fa;this.$zg={};this.eT=new k;this.dqg=ra;this.ZUb="";this.Av=pa;this.V5d=Za;this.Ivg=D.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.WordOnline.recentLinksCount",25);return this}function e(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}function h(va,bb,ba){this.task=null;this.bfc=va;this.KAi=bb;this.taskManager=ba;this.retryCount=this.Hyb=0;this.dPc=this.CBb=null}function k(){this._state=0;this.Cbe=
this.Ebe=this.Dbe=null;this.state=this.tie=0;this.EKc=!1;return this}function n(va,bb,ba,fa,ra){this.mrg=6E4;this.R9e="inactive";this.nke="active";this.aT=!0;this.ae=va;this.hqg=bb;this.jJc=ba;this.OXb=fa;this.$a=new U.a;ra&&this.ZFj();this.x$d=this.y_e()}function f(va,bb){this.Hgb={};this.Z1=va;this.ylb=new v(bb,this.rDb.dmc,"GetMoreInfo");this.Bo=new x;return this}function v(va,bb,ba){this.OWb=this.Di=null;this.WPc=0;this.Pwg=va;this.ae=bb;this.X4d=ba}function m(va,bb,ba,fa,ra,pa,Za,Ua){this.La=
va;this.Qg=bb;this.Glg=ba;this.s1=fa;this.ae=ra;this.jJc=pa;this.Gqg=Za;this.BXb=Ua}function x(){this._state=0;this.IRc=this.Ykb=null;this.state=0;this.EKc=this.A8d=!1;return this}function l(){this._state=0}function u(){this.Hgb={}}t=b(0);var A=b(84),z=b(624),y=b(15);u.prototype.JAg=function(va){this.Hgb[va.id.toString()]=va};u.prototype.eFi=function(va){var bb=this.Hgb,ba;for(ba in bb)bb[ba].notify(va,!1);this.Hgb={}};u.prototype.H3i=function(va,bb){bb&&this.JAg(bb);return this.WBf(va,bb)};u.prototype.R7c=
function(va){this.eFi(va)};u.prototype.SKe=function(va,bb){va.notify(bb,!0)};Object(t.a)(u,"AEventEmitter",null,[634]);var w;(function(va){va[va.notStarted=0]="notStarted";va[va.waiting=1]="waiting";va[va.shouldRetry=2]="shouldRetry";va[va.complete=3]="complete"})(w||(w={}));Object(t.b)("EventResultState",w);of.Object.defineProperties(l.prototype,{state:{configurable:!0,enumerable:!0,get:function(){return this._state},set:function(va){var bb={};y.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",
(bb.OldState=w[this._state],bb.NewState=w[va],bb),"ResultType",this.O1e());this._state=va}}});Object(t.a)(l,"AEventResult",null,[655]);$k(x,l);x.prototype.O1e=function(){return"GetMoreInfo Result"};of.Object.defineProperties(x.prototype,{tR:{configurable:!0,enumerable:!0,get:function(){return this.Ykb}},foa:{configurable:!0,enumerable:!0,get:function(){return this.IRc}},Fdi:{configurable:!0,enumerable:!0,get:function(){return this.A8d}}});Object(t.a)(x,"GetMoreInfoResult",l,[654,655]);var D=b(4),
H=b(81),F=b(39),J=b(907),S=b(396),N=b(170),T=b(749),G=b(649),I=b(107),K=b(25);m.prototype.e9i=function(){this.i9a.Mb(K.a.openUrlInNewTab,I.a.frame,Object(A.a)(this,this.openUrlInNewTab,"openUrlInNewTab"));this.i9a.Mb(K.a.$Oa,I.a.frame,Object(A.a)(this,this.$Oa,"openDocumentUrl"));D.AFrameworkApplication.bQ?this.vmf():this.i9a.He(K.a.B7b,I.a.frame,Object(A.a)(this,this.B7b,"documentLoaded"),96)};m.prototype.openUrlInNewTab=function(va,bb,ba,fa,ra){ra&&ra.MenuItemId&&(va={},y.ULS.sendTraceTag(5849678,
202,50,"Opening new tab {0}",(va.Id=ra.SourceControlId,va.AppType=G.a[this.uca],va)),F.a.Te(ra.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32};m.prototype.$Oa=function(va,bb,ba,fa,ra){if(ra&&ra.MenuItemId){var pa=D.AFrameworkApplication.fa.qa("WacInTabOpenMRUIsEnabledForUiHost"),Za=D.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures");y.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",
pa,Za);if(pa&&Za){va={};y.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",(va.Id=ra.SourceControlId,va.AppType=G.a[this.uca],va));ra=ra.MenuItemId.toString();var Ua={};Ua[S.a.XPa]="1";Ua[S.a.documentUrl]=ra;Ua[S.a.reason]=T.a.open;y.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");D.AFrameworkApplication.iV().execute(function(Ma){Ma.wj(N.a.Sta,Ua)})}else this.openUrlInNewTab(va,bb,ba,fa,ra)}return 32};m.prototype.B7b=function(){this.vmf();return 32};
m.prototype.lca=function(va,bb,ba){ba=void 0===ba?"":ba;if(bb&&bb.ZE){var fa=J.a[bb.status];bb=bb.ZE.getTime();var ra=this.dw()-bb,pa={};y.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",(pa.Caller=va,pa.RequestStatus=fa,pa.ElapsedMs=ra,pa.StartTime=bb,pa.Notes=ba,pa))}else ba={},y.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",(ba.Caller=va,ba))};m.prototype.vmf=function(){var va=D.AFrameworkApplication.fa.qa("QPGVCI"),
bb=H.a.$A(document.URL,"wdNewAndOpenCt",va);if(bb){bb=parseInt(bb);var ba=H.a.$A(document.URL,"wdPreviousSession",va);va=H.a.$A(document.URL,"wdPreviousCorrelation",va);var fa=D.AFrameworkApplication.fa.qa("NAOPLP");if(D.AFrameworkApplication.bQ){var ra=D.AFrameworkApplication.bQ.getTime();if(!bb||bb>ra)fa={},y.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",(fa.ClickTimestamp=bb,fa.DocumentLoadedTime=ra,fa.SessionId=ba,fa.Correlation=va,fa));
else{var pa={};y.ULS.sendTraceTag(5849683,202,fa?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",(pa.ClickToLoadTime=ra-bb,pa.ClickTimestamp=bb,pa.SessionId=ba,pa.Correlation=va,pa))}}else ra={},y.ULS.sendTraceTag(5849681,202,fa?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",(ra.ClickTimestamp=bb,ra.SessionId=ba,ra.Correlation=va,ra))}};m.DM=function(){return new m(new z.a(function(){return D.AFrameworkApplication.ub}),
new z.a(function(){return D.AFrameworkApplication.nd}),new z.a(function(){return D.AFrameworkApplication.ta}),new z.a(function(){return D.AFrameworkApplication.ta.Qa.rj}),new z.a(function(){return D.AFrameworkApplication.zi}),function(){return(new Date).getTime()},new z.a(function(){return D.AFrameworkApplication.ta.Qa.TV}),new z.a(function(){return D.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage}))};of.Object.defineProperties(m.prototype,{i9a:{configurable:!0,enumerable:!0,get:function(){return this.La.value}},
MDb:{configurable:!0,enumerable:!0,get:function(){return this.Qg.value}},Urf:{configurable:!0,enumerable:!0,get:function(){return this.Glg.value}},uca:{configurable:!0,enumerable:!0,get:function(){return this.s1.value}},dmc:{configurable:!0,enumerable:!0,get:function(){return this.ae.value}},dw:{configurable:!0,enumerable:!0,get:function(){return this.jJc}},TV:{configurable:!0,enumerable:!0,get:function(){return this.Gqg.value}},supportsGetMoreInfoForPersonalStorage:{configurable:!0,enumerable:!0,
get:function(){return this.BXb.value}}});of.Object.defineProperties(m,{instance:{configurable:!0,enumerable:!0,get:function(){return m.Ma||(m.Ma=m.DM())}}});m.Ma=null;Object(t.a)(m,"NewAndOpenCommonHelpers",null,[633]);var L=b(108);v.prototype.FJg=function(){this.WPc=this.dcb+1};v.prototype.pLd=function(va){this.Di&&(this.ae.Ep(this.Di),this.Di=null);va&&(this.WPc=0)};v.prototype.gGj=function(va){var bb=this.sLj;0<=bb?(this.FJg(),this.pLd(!1),this.Di=new L.a(4,1,bb,va,107),this.ae.Cg(this.Di)):(this.pLd(!0),
va={},y.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",(va.Action=this.X4d,va)))};of.Object.defineProperties(v.prototype,{dcb:{configurable:!0,enumerable:!0,get:function(){return this.WPc}},sLj:{configurable:!0,enumerable:!0,get:function(){return this.dcb>=this.vYf.length?-1:this.vYf[this.dcb]}},vYf:{configurable:!0,enumerable:!0,get:function(){if(!this.OWb){var va=(this.Pwg.value||"0").split(",");this.OWb=[];for(var bb=0;bb<va.length;bb++){var ba=parseInt(va[bb]);isNaN(ba)?(ba={},y.ULS.sendTraceTag(5849677,
202,15,"Retry interval list contains non-number element {0}",(ba.Action=this.X4d,ba.Entry=va[bb],ba))):Array.add(this.OWb,ba)}}return this.OWb}}});Object(t.a)(v,"RetryHelper",null,[]);var O=b(42),B=b(29);$k(f,u);f.prototype.hzi=function(){this.Gvd("Document opened")};f.prototype.V8g=function(va){var bb=this;return function(){bb.Gvd(va,!0)}};f.prototype.WBf=function(va,bb){bb=void 0===bb?null:bb;var ba={};y.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",(ba.Trigger=
va,ba));3===this.Bo.state?(bb&&this.SKe(bb,this.Bo),bb={},y.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",(bb.Trigger=va,bb))):this.Gvd(va);return this.Bo};f.prototype.Gvd=function(va,bb){this.ylb.pLd(!(void 0===bb?0:bb));1===this.Bo.state?(bb={},y.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",(bb.Trigger=va,bb.RetryIndex=this.ylb.dcb,bb))):(bb={},y.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",(bb.Trigger=
va,bb.RetryIndex=this.ylb.dcb,bb)),this.Bo.state=1,bb=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.rDb.TV,D.AFrameworkApplication.Yi),this.rDb.MDb.P9(bb,1,null,null,[f.Cde,f.Ahe],!1,5,this.Z7g(),this.Y7g(va),null))};f.prototype.Z7g=function(){var va=this;return function(bb){var ba=!1,fa=!1,ra=!1;if(D.AFrameworkApplication.fa.qa("GetMoreInfoDataFromResponseBody"))if(bb.data.Rd){var pa=O.d(bb.data.Rd);var Za=pa.Ot;pa.returnValue?Za?(ra=!0,va.Bo.IRc=Za.StorageServiceDisplayName,va.Bo.Ykb=f.tif(Za.PersonalFileStorageUrl)?
Za.PersonalFileStorageUrl:"",""===va.Bo.tR&&"SharePointOnlineConsumer"===D.AFrameworkApplication.fa.Wa("FileSource")&&(va.Bo.Ykb=H.a.nda(D.AFrameworkApplication.breadcrumbFolderUrl)),ba=""===va.Bo.tR&&""!==va.Bo.foa):y.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):y.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers")}else y.ULS.sendTraceTag(25298083,
202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers");ra||((Za=bb.data.responseHeaders)?(va.Bo.IRc=(Za[f.Ahe]||"").toString(),ba=(Za[f.Cde]||"").toString(),va.Bo.Ykb=f.tif(ba)?ba:"",""===va.Bo.tR&&"SharePointOnlineConsumer"===D.AFrameworkApplication.fa.Wa("FileSource")?(va.Bo.Ykb=H.a.nda(D.AFrameworkApplication.breadcrumbFolderUrl),ba=""===va.Bo.tR&&""!==va.Bo.foa):ba=""===ba&&""!==va.Bo.foa):(y.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),
fa=!0));ra=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",va.ylb.dcb,fa,ba,ra);va.rDb.lca("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",bb.data,ra);va.LYf(3,ba,fa)}};f.prototype.Y7g=function(va){var bb=this;return function(ba){bb.rDb.lca("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",ba.data,"Failure");bb.LYf(2);bb.ylb.gGj(bb.V8g(va))}};f.prototype.LYf=function(va,bb,ba){this.Bo.state=
va;this.Bo.A8d=void 0===bb?!1:bb;this.Bo.EKc=void 0===ba?!1:ba;this.R7c(this.Bo)};f.DM=function(){return new f(new z.a(function(){return m.instance}),new z.a(function(){return D.AFrameworkApplication.qTh}))};f.tif=function(va){if(!va)return y.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(B.a.cl(va).startsWith("https://"))return!0;y.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1};of.Object.defineProperties(f.prototype,
{rDb:{configurable:!0,enumerable:!0,get:function(){return this.Z1.value}}});of.Object.defineProperties(f,{instance:{configurable:!0,enumerable:!0,get:function(){return f.Ma||(f.Ma=f.DM())}}});f.Cde="PersonalFileStorageUrl";f.Ahe="StorageServiceDisplayName";f.Ma=null;Object(t.a)(f,"GetMoreInfoActor",u,[]);var Q=b(104),U=b(97);n.prototype.gUc=function(va){this.$a.addHandler(this.nke,va)};n.prototype.eDg=function(va){this.$a.addHandler(this.R9e,va)};n.prototype.ZFj=function(){var va=new L.a(5,2,this.mrg,
Object(A.a)(this,this.J9h,"inactiveLoop"),108);this.K9h.Cg(va)};n.prototype.J9h=function(){var va=this.y_e(),bb=this.dw()-va;if(bb>this.nAc&&this.aT){var ba={};y.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",(ba.TimeSinceLastActive=bb,ba));this.aT=!1;this.$a.raiseEvent(this.R9e)}va-this.x$d>this.nAc&&(this.aT=!0,this.$a.raiseEvent(this.nke));this.x$d=va};n.DM=function(){return new n(new z.a(function(){return Q.a.instance}),function(){return D.AFrameworkApplication.okf.getTime()},function(){return(new Date).getTime()},
new z.a(function(){return D.AFrameworkApplication.nAc}),!0)};of.Object.defineProperties(n.prototype,{K9h:{configurable:!0,enumerable:!0,get:function(){return this.ae.value}},y_e:{configurable:!0,enumerable:!0,get:function(){return this.hqg}},dw:{configurable:!0,enumerable:!0,get:function(){return this.jJc}},nAc:{configurable:!0,enumerable:!0,get:function(){return this.OXb.value}}});of.Object.defineProperties(n,{instance:{configurable:!0,enumerable:!0,get:function(){return n.Ma||(n.Ma=n.DM())}}});
n.Ma=null;Object(t.a)(n,"InactivityManager",null,[]);var X=b(85),P=b(1124);$k(k,l);k.prototype.O1e=function(){return"MruActor Result"};of.Object.defineProperties(k.prototype,{Ywd:{configurable:!0,enumerable:!0,get:function(){return this.Dbe}},grf:{configurable:!0,enumerable:!0,get:function(){return this.Ebe}},Xwd:{configurable:!0,enumerable:!0,get:function(){return this.Cbe}},xLj:{configurable:!0,enumerable:!0,get:function(){return this.tie}}});Object(t.a)(k,"MruResult",l,[656,655]);var ea=b(250);
h.prototype.Mli=function(va,bb){return va===ea.a.xbd||20===bb||18===bb||3===bb};h.prototype.Ymi=function(va){return 3===va||5===va||6===va||7===va||9===va||10===va||11===va||12===va||13===va||14===va||15===va||16===va||23===va||26===va||27===va||28===va};h.prototype.reset=function(){this.Hyb=this.retryCount=0;this.dPc=this.CBb=null;this.task&&(this.taskManager.Ep(this.task),this.task=null)};h.prototype.Hci=function(va,bb,ba,fa){this.dPc=String.format("{0}_{1}",ba,fa);if(this.retryCount>=this.KAi)return y.ULS.sendTraceTag(562656907,
202,50,"Max retries exceeded"),!1;if(this.Mli(ba,fa))return y.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.Ymi(fa)&&1<=this.Hyb)return this.CBb=ba,!1;bb=Math.max(bb,this.bfc*Math.pow(2,this.Hyb));if(26===fa)bb=Math.max(bb,3E4);else if(27===fa||28===fa)bb=Math.max(bb,6E4);9===fa||412===ba&&(null==this.CBb||412!==this.CBb)?bb=500:this.Hyb+=1;this.CBb=ba;this.retryCount+=1;this.task&&this.taskManager.Ep(this.task);y.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",
bb);this.task=new L.a(2,1,bb,va,107);this.taskManager.Cg(this.task);return!0};of.Object.defineProperties(h.prototype,{Pqc:{configurable:!0,enumerable:!0,get:function(){return this.dPc}}});Object(t.a)(h,"RetryManager",null,[]);var ia=b(99),da=b(136),xa=b(167);Object(t.a)(e,"WriteOptions",null,[]);var Z=b(628),ha=b(193);$k(d,u);d.prototype.U$i=function(){this.uw.i9a.Mb(K.a.renameMostRecentlyUsedFileEntry,I.a.frame,Object(A.a)(this,this.Mej,"renameMruEntry"))};d.prototype.Mej=function(){return this.e0d("Rename")};
d.prototype.rzi=function(){this.dpf("File Opened")};d.prototype.szi=function(){this.dpf("IntervalUpdate")};d.prototype.dpf=function(va){var bb={};y.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",(bb.Trigger=va,bb));this.e0d(va)};d.prototype.l4=function(va){(va=B.a.l4(va))&&va.startsWith(".")&&(va=va.substring(1,va.length));return va};d.prototype.NWe=function(){switch(this.uw.uca){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";
default:return"Unknown"}};d.prototype.E0h=function(va){var bb=this.dqg();if(!bb)return null;var ba=new e;ba.documentUrl=this.V5d.value?encodeURI(bb):bb;ba.mruItemId=this.ZUb;ba.app=this.NWe();if(bb=this.Av())ba.folderName=bb.breadcrumbFolderName,bb=bb.Pm,ba.documentName=B.a.oq(bb),ba.documentExt=this.l4(bb);va&&(ba.documentName?ba.documentName.length?255<=ba.documentName.length?va.set("DocumentNameLength","Long"):2084<=ba.documentName.length&&va.set("DocumentNameLength","VeryLong"):va.set("DocumentNameLength",
"0"):va.set("DocumentNameLength","Null"));return JSON.stringify(ba)};d.prototype.e0d=function(va,bb){bb=void 0===bb?!1:bb;if(4===this.uw.uca&&!D.AFrameworkApplication.Rta)return 2;var ba=da.a.Er();ba&&(ba.set("Trigger",va),ba.set("IsRetry",bb?"true":"false"),ba.set("MruIdSent",this.ZUb?"true":"false"),ba.set("URLEncoded",this.V5d.value?"true":"false"));ia.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",ba);va=this.E0h(ba);if(!va)return bb=!D.AFrameworkApplication.webEditingEnabled,ba&&(ba.set("WebEditingIsEnabled",
D.AFrameworkApplication.webEditingEnabled?"true":"false"),ba.set("ProtectedFile",D.AFrameworkApplication.Zqc?"true":"false")),ia.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",bb,!1,Object.assign(new ha.a,{extendedProperties:ba})),2;this.Dra&&!bb&&this.Dra.reset();ba=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.uw.TV,this.localeName);this.Hje?this.DDc["X-FileId"]=D.AFrameworkApplication.Yi:ba+=String.format("&{0}",D.AFrameworkApplication.Yi);D.AFrameworkApplication.Ob&&
(this.DDc["X-Office-AudienceGroup"]=Object(X.a)(String,D.AFrameworkApplication.Ob.AudienceGroup)||"");this.DDc["X-Timeout"]=15E3;return this.uw.MDb.Zl(ba,2,va,this.DDc,!0,5,Object(A.a)(this,this.DZj,"writeMruV2EntryOnServerSuccessCallback"),Object(A.a)(this,this.Bbh,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")};d.prototype.DZj=function(va){this.U5e(va.data)};d.prototype.U5e=function(va){var bb=da.a.Er();this.Dra&&(bb&&this.Dra.Pqc&&(bb.set("LastError",this.Dra.Pqc),
bb.set("NumRetries",this.Dra.retryCount.toString())),this.Dra.reset());var ba=P.c(va.Rd);ba&&ba.diagnostics_data&&(this.ZUb=ba.diagnostics_data.mru_id);va=+va.l3-+va.ZE;bb&&bb.set("RequestDuration",va.toString());ia.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new ha.a,{extendedProperties:bb}))};d.prototype.Bbh=function(va){if(va.data.httpStatus===ea.a.Wrb)this.U5e(va.data);else{var bb=va.data.httpStatus===ea.a.WGb,ba=da.a.Er();this.g6e(this.Dra,va,this.qbh(),ba);ba&&(ba.set("StatusCode",
va.data.httpStatus.toString()),bb||this.oUc(va.data,ba));ia.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",va.data.httpStatus),bb,!1,Object.assign(new ha.a,{extendedProperties:ba}))}};d.prototype.qbh=function(){var va=this;return function(){va.e0d("Retry",!0)}};d.prototype.xTh=function(){this.M8a("Polling")};d.prototype.wTh=function(){this.M8a("Retry",!0)};d.prototype.lzi=function(){this.M8a("Open")};d.prototype.kzi=function(){this.M8a("Activity")};d.prototype.jzi=function(){this.M8a("OpenRecentLinks",
!1,!0)};d.prototype.izi=function(){this.M8a("ActivityRecentLinks",!1,!0)};d.prototype.M8a=function(va,bb,ba){bb=void 0===bb?!1:bb;ba=void 0===ba?!1:ba;var fa={};y.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",(fa.Trigger=va,fa));if(fa=da.a.Er())fa.set("Trigger",va),fa.set("IsRetry",bb?"true":"false"),ba&&fa.set("RecentLinks","true");ia.Health.instance.recordKpiUsage("GetMru",0,"smartfio",fa);this.bra&&!bb&&this.bra.reset();ba?this.TDe(Object(A.a)(this,this.yTh,"getMruV2ForRecentLinksFromServerSuccessCallback"),
Object(A.a)(this,this.uTh,"getMruForRecentLinksFromServerFailureCallback"),!0):this.TDe(Object(A.a)(this,this.zTh,"getMruV2FromServerSuccessCallback"),Object(A.a)(this,this.vTh,"getMruFromServerFailureCallback"))};d.prototype.oUc=function(va,bb){va&&va.responseHeaders&&(va=va.responseHeaders["X-CorrelationId"])&&bb.set("ServerCorrelationId",va)};d.prototype.ewi=function(va,bb){va&&(bb&&bb.set("RequestDuration",(+va.l3-+va.ZE).toString()),ia.Health.instance.recordKpiSuccess("GetMru",Object.assign(new ha.a,
{extendedProperties:bb})))};d.prototype.zTh=function(va){this.$_e(va)};d.prototype.$_e=function(va,bb){bb=void 0===bb?!1:bb;var ba="",fa=null,ra=null,pa=null,Za=P.c(va.data.Rd);Za&&(fa=Za.places?Za.places.items:[],ra=Za.documents?Za.documents.items:[],(pa=P.a(Za,bb))&&(ba=O.c(pa)));D.AFrameworkApplication.ta&&D.AFrameworkApplication.ta.Qa.k_&&xa.c()&&!bb&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(ba,!0));ba=da.a.Er();this.bra&&(ba&&this.bra.Pqc&&(ba.set("LastError",this.bra.Pqc),
ba.set("NumRetries",this.bra.retryCount.toString())),this.bra.reset());bb&&ba&&ba.set("RecentLinks","true");pa||fa||ra?(bb?this.uw.lca("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",va.data,"Success"):this.uw.lca("MruActor.GetMruV2FromServerSuccessCallback",va.data,"Success"),this.jCc(3,pa,fa,ra),this.ewi(va.data,ba)):(bb?this.uw.lca("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",va.data,"Failure: Invalid JSON"):this.uw.lca("MruActor.GetMruV2FromServerSuccessCallback",va.data,
"Failure: Invalid JSON"),ba&&this.oUc(va.data,ba),ia.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new ha.a,{extendedProperties:ba})),this.jCc(3,null,null,null,!0));this.R7c(this.eT)};d.prototype.yTh=function(va){this.$_e(va,!0)};d.prototype.g6e=function(va,bb,ba,fa){var ra=0,pa=0,Za=P.c(bb.data.Rd);Za&&(null!=Za.response_code&&(ra=Za.response_code,fa&&fa.set("MruResponseCode",ra.toString()),9===ra&&(this.ZUb="")),Za.error_data&&null!=Za.error_data.retry_after_ms&&
(pa=Za.error_data.retry_after_ms,fa&&fa.set("ExpectedRetryAfter",pa.toString())));va&&(bb=va.Hci(ba,pa,bb.data.httpStatus,ra),fa&&(fa.set("CurrentRetryCount",va.retryCount.toString()),fa.set("RetryScheduled",bb?"true":"false")))};d.prototype.vTh=function(va){this.Z_e(va)};d.prototype.Z_e=function(va,bb){bb=void 0===bb?!1:bb;var ba=va.data.httpStatus===ea.a.WGb,fa=da.a.Er();fa&&(fa.set("StatusCode",va.data.httpStatus.toString()),bb&&fa.set("RecentLinks","true"),ba||this.oUc(va.data,fa));bb?this.uw.lca("MruActor.GetMruForRecentLinksFromServerFailureCallback",
va.data,"Failure"):this.uw.lca("MruActor.GetMruFromServerFailureCallback",va.data,"Failure");this.jCc(2);this.g6e(this.bra,va,Object(A.a)(this,this.wTh,"getMruFromServerRetryTask"),fa);ia.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",va.data.httpStatus),ba,!1,Object.assign(new ha.a,{extendedProperties:fa}));this.R7c(this.eT);D.AFrameworkApplication.ta&&D.AFrameworkApplication.ta.Qa.k_&&xa.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),bb||appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",
!1)))};d.prototype.uTh=function(va){this.Z_e(va,!0)};d.prototype.jCc=function(va,bb,ba,fa,ra){if(3!==this.eT.state||3===va)this.eT.Dbe=void 0===bb?null:bb,this.eT.Ebe=void 0===ba?null:ba,this.eT.Cbe=void 0===fa?null:fa,this.eT.state=va,this.eT.EKc=void 0===ra?!1:ra,this.eT.tie=this.uw.dw()};d.prototype.WBf=function(va,bb){var ba={};y.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",(ba.Trigger=va,ba.ResultState=this.eT.state,ba));bb&&3===this.eT.state&&this.SKe(bb,this.eT);return this.eT};
d.prototype.TDe=function(va,bb,ba){ba=void 0===ba?!1:ba;this.jCc(1);var fa={};var ra=ba?String.format(this.uw.TV+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",this.Ivg,"OfficeSuite",this.localeName,"ClassicMru"):String.format(this.uw.TV+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.NWe(),this.localeName);this.Hvg.value||(ra+="&entity=docs");D.AFrameworkApplication.Ob&&(fa["X-Office-AudienceGroup"]=Object(X.a)(String,D.AFrameworkApplication.Ob.AudienceGroup)||
"");ba&&(fa["X-Office-Application"]="147");this.Hje?fa["X-FileId"]=D.AFrameworkApplication.Yi:ra+=String.format("&{0}",D.AFrameworkApplication.Yi);this.uw.MDb.Zl(ra,1,null,fa,!0,5,va,bb,null)};d.DM=function(){return new d(new z.a(function(){return m.instance}),new z.a(function(){return Z.a.aH(D.AFrameworkApplication.lcid).name}),new z.a(function(){return D.AFrameworkApplication.ta.Qa.Yu}),D.AFrameworkApplication.fa.qa("MruWriteFileIdInHeader"),function(){return D.AFrameworkApplication.ta.Qa.tx},function(){return D.AFrameworkApplication.cm},
new z.a(function(){return D.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled")}))};of.Object.defineProperties(d.prototype,{DDc:{configurable:!0,enumerable:!0,get:function(){return this.$zg}},uw:{configurable:!0,enumerable:!0,get:function(){return this.Z1.value}},localeName:{configurable:!0,enumerable:!0,get:function(){return this.ktg.value}}});of.Object.defineProperties(d,{instance:{configurable:!0,enumerable:!0,get:function(){return d.Ma||(d.Ma=d.DM())}}});d.Ma=null;Object(t.a)(d,"MruActor",u,
[]);c.prototype.Sh=function(va){this.fb=va;va.register(633,"Common.INewAndOpenCommonHelpers").tc().Dc(function(){return m.instance});va.register(634,"Common.IEventEmitter<Common.IGetMoreInfoResult>").tc().Dc(function(){return f.instance});va.register(634,"Common.IEventEmitter<Common.IMruResult>").tc().Dc(function(){return d.instance})};c.prototype.init=function(){var va=this;D.AFrameworkApplication.fa.Vu(function(){va.ryb()})};c.prototype.ryb=function(){this.fb.resolve("Common.INewAndOpenCommonHelpers");
this.fb.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.fb.resolve("Common.IEventEmitter<Common.IMruResult>");var va=!1;m.instance.e9i();D.AFrameworkApplication.Fla&&(va=!0);D.AFrameworkApplication.xMf&&(d.instance.lzi(),D.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&d.instance.jzi(),0<D.AFrameworkApplication.hrf&&this.Ile(),this.cwj(),va=!0);D.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage&&va&&f.instance.hzi();
D.AFrameworkApplication.TTj&&(va=d.instance,va.U$i(),va.rzi(),Q.a.instance.Cg(this.UTj))};c.prototype.cwj=function(){n.instance.gUc(Object(A.a)(d.instance,d.instance.kzi,"makeGetMruRequestActivityTrigger"));D.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&n.instance.gUc(Object(A.a)(d.instance,d.instance.izi,"makeGetMruForRecentLinksRequestActivityTrigger"));n.instance.gUc(Object(A.a)(this,this.Ile,"addGetMruFromServerTask"));n.instance.eDg(Object(A.a)(this,
this.Feh,"deleteGetMruFromServerTask"))};c.prototype.Feh=function(){Q.a.instance.Ep(this.irf)};c.prototype.Ile=function(){Q.a.instance.Cg(this.irf)};c.prototype.dispose=function(){this.om||(this.om=!0,this.vmb&&(Q.a.instance.Ep(this.vmb),this.vmb=null))};of.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.NewAndOpen.Core"}},irf:{configurable:!0,enumerable:!0,get:function(){return this.Cee||(this.Cee=new L.a(5,2,D.AFrameworkApplication.hrf,Object(A.a)(d.instance,
d.instance.xTh,"getMruFromServerTask"),109))}},UTj:{configurable:!0,enumerable:!0,get:function(){return this.vmb||(this.vmb=new L.a(2,2,6E4*D.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(A.a)(d.instance,d.instance.szi,"makeUpdateMruTask"),197))}}});Object(t.a)(c,"CorePackageManager",null,[10,11,6]);var ya=b(258);b.d(E,"a",function(){return a})},1377:function(t,E,b){function a(){Aa.a.Fa(c.ka)}function c(V){var La=Ha.call(this)||
this;La.$=V;La.Eb();return La}function d(){this.ULd=z.AFrameworkApplication.fZj;this.MAi=z.AFrameworkApplication.dZj;this.BO=z.AFrameworkApplication.M1h();this.priority=z.AFrameworkApplication.W_d;this.dfe=this.Jtj();this.hTc=z.AFrameworkApplication.L1h()}function e(V,La,Ra,pb,cb,Sa,Db){var Ab=this;pb=void 0===pb?null:pb;cb=void 0===cb?!1:cb;Sa=void 0===Sa?null:Sa;Db=void 0===Db?!1:Db;this.gra=0;this.vga=this.Di=null;this.RXb=new pa.a;this.YS=new pa.a;this.Xl=null;this.rUb=!1;this.ae=V;this.Rde=La;
this.Rde.execute(function(Wb){Wb.Ml(ta.a.hkd,Object(D.a)(Ab,Ab.bOi,"onHostResponseReceived"))});this.t9=Ra;this.uie=new aa.a("WebServiceCall","TokenRefresh");this.Wi=pb||new h(V);this.Nwg=cb;this.oT=Sa?Sa:oa.SessionStatusManager.instance;this.U5d=Db}function h(V){this.Ao={};this.CX={};this.$ug={};this.pmf=15;this.d$d=!1;this.Twg=new Date;this.xUb=new Date;this.ae=V;this.HXb=new Ua.a(2,2,6E4*this.pmf,Object(D.a)(this,this.Dhg,"writeMeasures"),135,"SL",!1);this.ae.Cg(this.HXb);this.Hbi()}function k(){}
function n(V,La){var Ra=this;this.documentVisibilityObserver=null;this.Pa=new S.a;this.qx=null;this.feb=this.qlb=!1;this.Zrc=null;this.hIb=!1;this.Kud=!0;this.I$d=this.i$d=this.TG=this.rmb=!1;this.PS=null;this.V5e=function(){if(!Ra.u$b||Ra.u$b&&Ra.$.ea.dc)Ra.v6e(!1);else if(Ra.Kud){Ra.Kud=!1;var pb=B.a(Ra.$);w.ULS.sendTraceTag(537170709,0,50,"EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity ["+(pb.ii?pb.ii.activityName:"None")+
"] TimeUntilTokenExpirationInMin ["+Ra.d$f()+"]")}};this.Uc=function(pb,cb){Ra.context&&(pb=Ra.$.ea,cb.sH&&Ra.context.bIb&&!Ra.context.yAc?(Ra.context.yAc=!0,cb={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect"},cb.IsUserActive=pb.ef.Ur,cb.RefreshAccessTokenCorrelationID=Ra.context.correlationID,cb=ia.a.xc(cb),w.ULS.sendTraceTag(537170708,0,50,cb)):Ra.u$b&&Ra.qlb&&!pb.dc&&!Ra.context.E4c&&(cb={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen"},
Ra.qx&&(Ra.qx.cancel(),cb.Aborted=!0,va.EwaSettings.isChangeGateEnabled("OfficeVSO:4877031_allowRefreshExpiringAfterAbort")&&(cb.ResetStopRefreshRetriesUntilTokenExpired=!0,Ra.feb=!1)),cb.TimeUntilTokenExpirationInMin=Ra.d$f(),cb.RefreshAccessTokenCorrelationID=Ra.context.correlationID,cb=ia.a.xc(cb),w.ULS.sendTraceTag(572019856,0,50,cb)))};this.Jya=function(){if(Ra.context&&Ra.context.bIb&&!Ra.context.yAc){var pb={Name:"EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed"};pb.CreatedForExpired=
Ra.context.E4c;pb.RefreshAccessTokenCorrelationID=Ra.context.correlationID;pb.OpenWorkbookErrors=N.a.Cc(Ra.$.ea.rF);pb.ExecutionContextErrors=N.a.Cc(B.a(Ra.$).dd.errors);pb.accesstokenTTL=z.AFrameworkApplication.nk;pb=ia.a.xc(pb);w.ULS.sendTraceTag(537170707,0,15,pb)}};this.u6e=function(){Ra.feb=!1;Ra.v6e(!0)};this.$Bd=function(){Ra.hIb&&(Ra.$.ea.ef.sQa(Ra.$Bd),Ra.hIb=!1);Ra.A6f()};this.$=V;this.nWd=La;this.KHd=V.Fb.Mg("WebServiceCall","refreshToken");this.u$b=va.EwaSettings.isChangeGateEnabled("OfficeVSO:4874136_fixRaceOpenWorkbookRefreshExpiringToken");
F.a.instance.BVc(this.u6e);F.a.instance.zVc(this.V5e);La=this.$.ea;La.Vj(this.Uc);La.a_b(this.Jya);this.OBi=this.$.ya.MinTokenLifetimeForRegularExpirationPromptInMin;this.W1f=this.$.ya.ShortAccessTokenExpirationPromptSeconds;this.KNf=this.$.ya.RefreshAccessTokenDurationLimitInSec;this.Keg(V.ea.OFf,z.AFrameworkApplication.nk);V=new Date;La={};w.ULS.sendTraceTag(537170714,217,50,"Initializing EwaAccessTokenExpirationRefreshManager. "+(La.AccessTokenTtl=z.AFrameworkApplication.nk,La.NowGetTime=V.getTime(),
La.BootTime=z.AFrameworkApplication.uha,La.WopiTokenExpiresAfterMinutes=z.AFrameworkApplication.U_d,La.WopiTokenTaskItemPriority=z.AFrameworkApplication.W_d,La));this.$.da.Za(291,function(pb){Ra.documentVisibilityObserver=pb})}function f(V,La){this.RXb=V;this.YS=La}function v(){return m.apply(this,arguments)||this}function m(){}function x(){}function l(V,La){this.bIb=!1;this.correlationID=V;this.E4c=La;this.yAc=!1;this.creationTime=ea.a.Ta.Jb}function u(V){var La=A.call(this)||this;La.Pa=new S.a;
La.rmb=!1;La.TG=!1;La.$=V;return La}function A(){this.rge=this.NQc=!1;var V=z.AFrameworkApplication.nk;if(!(0>=V)){this.nk=V;V=new Date;var La={};w.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",(La.AccessTokenTtl=this.nk,La.NowGetTime=V.getTime(),La.BootTime=z.AFrameworkApplication.uha,La));F.a.instance.BVc(Object(D.a)(this,this.ROa,"onSessionExpiredDetected"));F.a.instance.zVc(Object(D.a)(this,this.SCf,"onSessionExpiringDetected"))}}t=b(0);var z=b(4),y=b(235),w=b(15),
D=b(84),H=b(52),F=b(204);A.prototype.ROa=function(){F.a.instance.NJd(Object(D.a)(this,this.ROa,"onSessionExpiredDetected"));w.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.k5h()};A.prototype.SCf=function(){F.a.instance.MJd(Object(D.a)(this,this.SCf,"onSessionExpiringDetected"));this.rge||this.NQc||(w.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.rge=!0,this.OCj())};A.prototype.k5h=function(){this.NQc||(z.AFrameworkApplication.DF(H.a.Nvc),
this.NQc=!0,this.NCj())};Object(t.a)(A,"ASessionExpirationManager",null,[]);var J=b(87),S=b(38),N=b(31),T=b(14),G=b(43),I=b(261),K=b(6),L=b(82),O=b(264),B=b(68);$k(u,A);u.prototype.foe=function(V){this.Pa.addHandler("SessionExpired",V)};u.prototype.ZZb=function(V){this.Pa.addHandler("TokenRefreshed",V)};u.prototype.AJd=function(V){this.Pa.removeHandler("TokenRefreshed",V)};u.prototype.Ndc=function(){return F.a.instance.XQ(z.AFrameworkApplication.nk)};u.prototype.dispose=function(){J.a.Ia(this.Pa);
this.$=null};u.prototype.OCj=function(){this.$.isEditMode&&this.mdc(!1)};u.prototype.NCj=function(){this.rmb=!0;this.mdc(!0);this.Pa.raiseEvent("SessionExpired")};u.prototype.mdc=function(V){var La=this;w.ULS.sendTraceTag(537170715,0,15,"EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired "+V+", GotDeploymentOrTimedOutError "+this.$.ea.u4);var Ra=this.$.ob.Dp;V&&Ra&&Ra.isVisible&&1299163859===Ra.error.MessageId&&this.$.ob.Dp.Lt();var pb=this.Xc(V);G.a(this.$).cs(new I.a(K.a.Jx,
5,function(){var cb=B.a(La.$),Sa=cb.dd.activityState;Sa[L.a.t2]=La.$.zpb(La.$.isEditMode);Sa[L.a.VL]=L.a.g9a;Sa[O.a.fq]=K.a.accessTokenExpiringWarning;cb.dd.Bt([pb])}))};u.prototype.Xc=function(V){return V?N.a.VEe():this.mah()};u.prototype.mah=function(){var V=N.a.Xc(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");V.Description=this.accessTokenExpiringMessage;return V};of.Object.defineProperties(u.prototype,{accessTokenExpiringMessage:{configurable:!0,enumerable:!0,get:function(){var V=(new Date(this.nk)).format(this.$.ya.ShortTimeFormat);
return String.format(T.a.instance.mb(78),V)}},tokenExpired:{configurable:!0,enumerable:!0,get:function(){return this.rmb}},qdb:{configurable:!0,enumerable:!0,get:function(){return!1}},Uba:{configurable:!0,enumerable:!0,get:function(){return!1}},MHd:{configurable:!0,enumerable:!0,get:function(){return!1}},G5:{configurable:!0,enumerable:!0,get:function(){return!1}}});Object(t.a)(u,"EwaAccessTokenExpirationManager",A,[588,313,6]);var Q=b(7),U=b(178),X=b(81),P=b(747),ea=b(28);Object(t.a)(l,"RefreshAccessTokenContext",
null,[]);var ia=b(54),da=b(62),xa=b(179),Z=b(45),ha=b(111),ya=b(119),va=b(1),bb=b(22),ba=b(147),fa=b(35),ra=b(116);Object(t.a)(x,"Error",null,[]);Object(t.a)(m,"NamedResult",null,[]);$k(v,m);Object(t.a)(v,"ErrorInfo",m,[]);of.Object.defineProperties(f.prototype,{BO:{configurable:!0,enumerable:!0,get:function(){return this.RXb}},errors:{configurable:!0,enumerable:!0,get:function(){return this.YS}}});Object(t.a)(f,"TokenRefreshArgs",null,[635]);n.prototype.foe=function(V){this.Pa.addHandler("SessionExpired",
V)};n.prototype.ZZb=function(V){this.Pa.addHandler("TokenRefreshed",V)};n.prototype.AJd=function(V){this.Pa.removeHandler("TokenRefreshed",V)};n.prototype.Ndc=function(){return F.a.instance.XQ(z.AFrameworkApplication.nk)};n.prototype.dispose=function(){F.a.instance.NJd(this.u6e);F.a.instance.MJd(this.V5e);var V=this.$.ea;V&&(V.wk(this.Uc),V.etc(this.Jya));J.a.Ia(this.Pa);this.documentVisibilityObserver=this.$=null};n.prototype.d$f=function(){return this.Ndc()?0:(z.AFrameworkApplication.nk-(new Date).getTime())/
6E4};n.prototype.Keg=function(V,La){if(0<La&&!this.Ndc()){var Ra=z.AFrameworkApplication.fa.kd("AccessTokenExpirationPromptSeconds",z.AFrameworkApplication.gY),pb=(La-V.getTime())/6E4;w.ULS.shipAssertTag(537170713,0,0<=pb,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL ["+La+"] creationTime ["+V.getTime()+"] tokenLifetimeInMin ["+pb+"]");pb<this.OBi?(w.ULS.sendTraceTag(537170712,0,15,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to ["+
this.W1f+"] tokenLifetimeInMin ["+pb+"]"),z.AFrameworkApplication.gY=this.W1f):z.AFrameworkApplication.gY!==Ra&&(w.ULS.sendTraceTag(537170711,0,15,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to ["+Ra+"] tokenLifetimeInMin ["+pb+"]"),z.AFrameworkApplication.gY=Ra)}};n.prototype.G5g=function(V){return!this.context||this.context.bIb||this.context.E4c!==V?(V=new l(U.a.create().toString(),V),this.context&&!this.context.yAc&&w.ULS.sendTraceTag(537170710,
0,15,"TokenManager.InitContext: creating new context ["+V.correlationID+"] although previeous one ["+this.context.correlationID+"] not used successfully, isPreviousOneRefreshedSuccessfully ["+this.context.bIb+"] "),this.PS=V,!0):!1};n.prototype.ohj=function(V){V&&this.TG&&!this.Uba&&this.$.ea.ef.Ur&&!this.G5&&(this.TG=!1)};n.prototype.v6e=function(V){var La=this;this.ohj(V);if(!(this.qlb||this.feb&&!V||this.TG)&&this.qdb){this.qlb=!0;var Ra=this.context?this.context.creationTime:null,pb=this.G5g(V);
this.Kud=!0;var cb=this.$.ea,Sa={Name:"EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh",newContextCreated:pb};Sa.IsUserActive=cb.ef.Ur;Sa.IsSessionActive=cb.dc;Sa.ContainsChangesWorkbookOperations=this.$.userOperationManager.BHa();Sa.isSessionExpired=V;Sa.stopRefreshRetriesUntilTokenExpired=this.feb;Sa.FailedToRefreshExpiredToken=this.TG;Sa.numOfFailuresWhileUserIsActive=ra.a.g6;Sa.numOfFailuresWhileUserIsInActive=ra.a.h6;Sa.numOfFailuresWhileOffline=ra.a.pya;Sa.RefreshAccessTokenCorrelationID=
this.context.correlationID;pb&&Ra&&(Sa.TimeInMinFromPreviosContextCreation=Math.round(ya.b(ea.a.Ta,Ra)/60));Ra=ia.a.xc(Sa);w.ULS.sendTraceTag(40416199,0,50,Ra);this.KHd.start();this.i$d=cb.ef.Ur;this.qx=new P.a;this.xti(V);var Db=this.nWd.N8i(!V,this.qx?this.qx.token:null);Db.continueWith(function(){La.lZg();var Ab=La.nWd.Q2i(Db);La.KHd.stop();var Wb=La.Ndc();if(!Ab||va.EwaSettings.isChangeGateEnabled("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&Wb){var ub=Db.result.errors;Ab&&Wb&&La.lCg(ub);
La.S4h(ub,V)}else La.feb=!1,La.U4h(Db.result.BO,V);La.qlb=!1},this.u$b?8:0)}};n.prototype.lCg=function(V){var La=[Object(Q.a)(new x,{Id:"200",Details:"Expired accesstoken recieved on successful token request."})];V.add(Object(Q.a)(new v,{Name:"ExpiredTokenAfterSuccessfulRefresh",Errors:La}))};n.prototype.xti=function(V){V&&(this.$.ea.ef.Ur?this.A6f():(this.$.ea.ef.Rra(this.$Bd),this.hIb=!0))};n.prototype.A6f=function(){var V=this;this.Zrc=xa.AsyncMethodContext.Zq(function(){V.M8i()},1E3*this.KNf,
Z.a.s8i,this.Zrc)};n.prototype.lZg=function(){this.Zrc&&this.Zrc.cancel();this.hIb&&(this.$.ea.ef.sQa(this.$Bd),this.hIb=!1);this.qx=null};n.prototype.M8i=function(){w.ULS.sendTraceTag(537170706,0,15,"EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec ["+this.KNf+"]");this.qx.cancel()};n.prototype.S4h=function(V,La){this.feb=!0;La&&(this.TG||(this.rmb=this.TG=!0),this.nWd.Ihc(V)&&(this.I$d=!0));var Ra=!La||this.qdb&&!ra.a.uxc?40380379:39982555;La=this.xDe(La);
La.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";La.FailedToRefreshExpiredToken=this.TG;La.LastErrorIsPermanent=this.G5;if(0<V.count){var pb=V.na(0);La.errorName=pb.Name;0<pb.Errors.length&&(La.ErrorId=pb.Errors[0].Id,pb=pb.Errors[0].Details,La.ErrorDetails=this.Mih(pb.toString())?"PiiScrubbed":pb)}La=ia.a.xc(La);w.ULS.sendTraceTag(Ra,0,15,La);this.Pa.raiseEvent("TokenRefreshed",new f(null,V))};n.prototype.Mih=function(V){return bb.a.contains(V,"makes the internet safe for businesses",
!0)};n.prototype.xDe=function(V){var La={},Ra=this.$.ea;La.Name="";La.IsUserActive=Ra.ef.Ur;La.IsSessionActive=Ra.dc;La.GotDeploymentOrTimedOutError=Ra.u4;La.TimeInSecFromLastStatefulSuccessfulRequest=Ra.$0;La.TimeFromLastUserActivityInMs=Ra.ef.ONb;La.calledFromSessionExpiredFlow=V;La.RefreshTokenDurationInMS=this.KHd.qc;La.numOfFailuresWhileUserIsActive=ra.a.g6;La.numOfFailuresWhileUserIsInActive=ra.a.h6;La.numOfFailuresWhileOffline=ra.a.pya;La.RefreshAccessTokenCorrelationID=this.context.correlationID;
La.accessTokenTTL=z.AFrameworkApplication.nk;La.ContainsChangesWorkbookOperations=this.$.userOperationManager.BHa();La.IsDocumentHidden=this.documentVisibilityObserver?this.documentVisibilityObserver.Mi.toString():"Unknown";La.TimeFromFirstOpenInHr=Math.floor(ya.b(ea.a.Ta,ha.toUtc(Ra.OFf))/3600);return La};n.prototype.U4h=function(V,La){this.TG=!1;this.zVj();this.Keg(new Date,z.AFrameworkApplication.nk);var Ra=this.$.ea,pb=!La&&Ra.ef.Ur,cb=!this.$.isEditMode&&Ra.Wab;La=this.xDe(La);La.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess";
La.shouldTriggerSilentReloadAfterExpiring=pb;La.WopiTokenTaskItemPriority=z.AFrameworkApplication.W_d;La.isDirtyViewSession=cb;La=ia.a.xc(La);w.ULS.sendTraceTag(39982556,0,15,La);this.Pa.raiseEvent("TokenRefreshed",new f(V,null));cb?Ra.ef.Ur&&(w.ULS.sendTraceTag(537170705,0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),Ra.Cbd()):Ra.ef.Ur?pb&&(V=B.a(this.$).dd.activityState,V[ra.a.Yeb]=!0,
V[ba.a.kY]=!0,V[fa.a.Es]=this.$.isEditMode,G.a(this.$).cs(new I.a(K.a.vna,2,null))):Ra.dc&&da.j(this.$.oa.va,!0,!1,!1,null,null,null,null,null)};n.prototype.zVj=function(){void 0!==this.$.ea.workbookContext.WorkbookUri&&null!==this.$.ea.workbookContext.WorkbookUri?(this.$.ea.workbookContext.WorkbookUri=X.a.zT(this.$.ea.workbookContext.WorkbookUri,z.AFrameworkApplication.mP,z.AFrameworkApplication.accessToken),this.$.ea.workbookContext.WorkbookUri=X.a.zT(this.$.ea.workbookContext.WorkbookUri,z.AFrameworkApplication.hY,
z.AFrameworkApplication.nk.toString()),this.$.ea.apc()):w.ULS.sendTraceTag(537170704,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null");this.$.ya.AccessToken=z.AFrameworkApplication.accessToken;this.$.ya.AccessTokenValidTo=z.AFrameworkApplication.nk;void 0!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&null!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=X.a.zT(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,
z.AFrameworkApplication.mP,z.AFrameworkApplication.accessToken),this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=X.a.zT(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,z.AFrameworkApplication.hY,z.AFrameworkApplication.nk.toString()));void 0!==this.$.ya.EmbedConfiguratorUrl&&null!==this.$.ya.EmbedConfiguratorUrl&&(this.$.ya.EmbedConfiguratorUrl=X.a.zT(this.$.ya.EmbedConfiguratorUrl,z.AFrameworkApplication.mP,z.AFrameworkApplication.accessToken),this.$.ya.EmbedConfiguratorUrl=X.a.zT(this.$.ya.EmbedConfiguratorUrl,
z.AFrameworkApplication.hY,z.AFrameworkApplication.nk.toString()));this.context.bIb=!0};of.Object.defineProperties(n.prototype,{tokenExpired:{configurable:!0,enumerable:!0,get:function(){return this.rmb}},Uba:{configurable:!0,enumerable:!0,get:function(){return this.i$d}},G5:{configurable:!0,enumerable:!0,get:function(){return this.I$d}},context:{configurable:!0,enumerable:!0,get:function(){return this.PS}},qdb:{configurable:!0,enumerable:!0,get:function(){return this.G5?!1:this.$.ea.ef.Ur?1>ra.a.g6:
6>ra.a.h6}},MHd:{configurable:!0,enumerable:!0,get:function(){return this.qlb}}});Object(t.a)(n,"EwaAccessTokenExpirationRefreshManager",null,[588,313,6]);var pa=b(192),Za=b(162);k.UYb="ActivityDuration";k.error="Error";k.mnh="Errors";k.failed="Failed";k.xCh="FirstActivity";k.initialized="Initialized";k.Hri="LastActivity";k.bjj="RetryOverride";k.Ogj="RequestGroups";k.requests="Requests";k.aUf="Responses";k.Ovc="SessionDuration";k.status="Status";k.success="Success";k.hoa="Successful";k.BO="Tokens";
Object(t.a)(k,"SessionExpirationStrings",null,[]);var Ua=b(108);h.prototype.Dhg=function(){var V={};w.ULS.sendTraceTag(41964821,217,50,w.ULS.xc((V.Aggregate=this.CX,V.Current=this.Ao,V)))};h.prototype.Hbi=function(){this.CX[k.Ogj]=0;this.CX[k.requests]=0;this.CX[k.aUf]=0;this.CX[k.status]=k.initialized;this.CX[k.xCh]=new Date;this.CX[k.Ovc]=0;this.CX[k.UYb]=0;this.CX[k.Ovc]=0;this.Ao[k.Ovc]=0;this.CX[k.UYb]=0;this.Ao[k.UYb]=0};h.prototype.bld=function(V,La){var Ra=V[La];Ra=Ra?Ra:0;Ra++;V[La]=Ra;this.$Od(V)};
h.prototype.$Od=function(V){var La=new Date;V[k.UYb]=+La-+this.xUb;this.xUb=La;V[k.Ovc]=+this.xUb-+this.Twg;V[k.Hri]=this.xUb};h.prototype.Wcb=function(V,La){this.Ao[V]=La;this.$Od(this.Ao)};h.prototype.tZf=function(V,La){this.Ao[V]=La;this.$Od(this.Ao)};h.prototype.incrementCounter=function(V){this.bld(this.Ao,V);this.bld(this.CX,V);this.bld(this.$ug,V)};h.prototype.flush=function(){this.d$d||(this.CX[k.status]=this.Ao[k.status],this.Dhg(this.HXb),this.ae.bna(this.HXb,6E4*this.pmf))};h.prototype.stop=
function(){w.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.d$d=!0;this.ae.Ep(this.HXb)};Object(t.a)(h,"SessionLogger",null,[665]);var Ma=b(99),oa=b(748),ja=b(396),ta=b(170),aa=b(1157),ma=b(193),Ea=b(172);e.prototype.bOi=function(V){if(V.MessageId!==ta.a.hkd)Ea.a(39408099,306,15,"Unexpected message.");else{var La=new pa.a,Ra=new pa.a;this.Wi.incrementCounter(k.aUf);var pb=V.Values[ja.a.BYf];if(!pb||0>=pb.length)Ea.a(40122317,306,15,"Found no tokens in the dictionary"),
pb=V.Values;Ea.a(40122318,306,100,"The Tokens array contains {0} tokens",pb.length);this.Wi.Wcb("Correlation",V.CorrelationId);for(var cb="",Sa=0;Sa<pb.length;Sa++){this.Wi.tZf(k.BO,pb.length);var Db=pb[Sa],Ab=Db;if(Ab&&Ab.Name){this.Wi.incrementCounter(Ab.Name);var Wb=Db;if(Wb&&Wb.Value)Ea.a(39408128,306,100,"Received token with name: {0}",Wb.Name),La.add(Wb),this.RXb.add(Wb),this.Wi.Wcb(k.status,k.success),this.U5d&&this.oT&&this.oT.Nhj();else if(Db=this.VXh(Db),Ea.a(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",
Ab.Name,JSON.stringify(Db),this.vga),Ra.add(Db),this.YS.add(Db),cb=JSON.stringify(Db),this.Wi.Wcb(k.error,JSON.stringify(Db)),this.Wi.Wcb(k.status,k.failed),this.U5d)for(Ab=ik(Db.Errors),Db=Ab.next();!Db.done;Db=Ab.next())Db=this.QOh(Db.value),this.oT&&this.oT.FEg(Db)}}0<Ra.count&&""!==cb?(pb=Object.assign(new ma.a,{extendedProperties:new Map}),pb.extendedProperties.set("Errors",cb),Ma.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,pb)):Ma.Health.instance.recordKpiSuccess("WACTokenRefresh",
null);Ea.a(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",La.count,Ra.count,V.CorrelationId,this.vga);0<Ra.count&&!this.Ihc(Ra)?(V=this.t9.oXh(Ra),V!==this.t9.ULd&&(this.Wi.tZf(k.bjj,V),this.ae.bna(this.Di,V))):(this.Wi.flush(),this.Di&&(Ea.a(39408131,306,100,"Deleting task {0} from task manager",this.Di.name),this.ae.Ep(this.Di)),this.Xl&&!this.Xl.task.isCompleted&&this.Xl.setResult(new f(La,Ra)))}};e.prototype.VXh=function(V){if(!V)return null;
var La=Object.assign(new v,{Name:V.Name,Errors:[]});V=ik(V.Errors);for(var Ra=V.next();!Ra.done;Ra=V.next()){Ra=Ra.value;var pb=new x;pb.Id=Ra.Id;pb.Details=this.UXh(Ra.Details);La.Errors.push(pb)}return La};e.prototype.UXh=function(V){if(!V)return"";var La=V.toString().toLowerCase();return 0<La.indexOf("<!doctype")?this.egd("Seems to contain HTML - Contains <!DOCTYPE"):0<La.indexOf("<html")?this.egd("Seems to contain HTML - Contains <html>"):500<La.length?this.egd(String.format("Error details content too long: Length: {0}",
La.length)):V};e.prototype.egd=function(V){return String.format("{0} - Reason: [{1}]","### REDACTED ###",V)};e.prototype.requestTokensOnce=function(){this.jTf()};e.prototype.jTf=function(){z.AFrameworkApplication.Bkc("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.gra>=this.t9.MAi?(Ea.a(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.vga),this.DDe(this.Xl,"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts")):
(Ma.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.Rnj())};e.prototype.Rnj=function(){var V={};V[ja.a.BYf]=this.t9.BO;var La=U.a.create().toString();Ea.a(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.t9.BO),this.gra+1,La,this.vga);this.Rde.execute(function(Ra){Ra.wj(ta.a.sqe,V,La)});this.gra++;this.Wi.incrementCounter(k.requests)};e.prototype.DDe=function(V,La,Ra){for(var pb=new pa.a,cb=0;cb<this.t9.BO.length;cb++){var Sa=
Object.assign(new v,{Name:this.t9.BO[cb],Errors:[Object.assign(new x,{Id:La,Details:Ra})]});pb.add(Sa);this.YS.add(Sa)}this.ae.Ep(this.Di);this.Wi.Wcb(k.mnh,JSON.stringify(this.YS));this.Wi.Wcb(k.status,k.failed);V&&!V.task.isCompleted&&V.setResult(new f(new pa.a,this.YS))};e.prototype.N8i=function(V,La){var Ra=this;La=void 0===La?null:La;this.uie.start();this.rUb=V;this.vga=U.a.create().toString();Ea.a(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.vga,this.rUb);
this.gra=0;this.YS.clear();this.RXb.clear();var pb=new Za.a;this.Xl=pb;La&&La.R(function(){var cb=!!pb&&!pb.task.isCompleted;Ea.a(588096223,306,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",Ra.vga,Ra.rUb,cb);cb&&Ra.DDe(pb,"ABORTED_BY_CALLER","The refresh was aborted by the caller")});this.Di=new Ua.a(this.t9.priority,2,this.t9.ULd,Object(D.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,ta.a.sqe,!0);this.Nwg&&this.jTf();this.ae.Cg(this.Di);return this.Xl.task};
e.prototype.Q2i=function(V){this.uie.stop();var La=this.c6h(V.result.errors);w.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!La,this.vga,this.rUb,this.gra,this.YS.count,0<V.result.errors.count?V.result.errors.na(0).Name:"",0<V.result.errors.count&&0<V.result.errors.na(0).Errors.length?V.result.errors.na(0).Errors[0].Id:"",0<V.result.errors.count&&
0<V.result.errors.na(0).Errors.length?V.result.errors.na(0).Errors[0].Details:"");return La?!1:this.P2i(V.result.BO)};e.prototype.Ihc=function(V){return this.t9.Ihc(V)};e.prototype.P2i=function(V){for(var La=0;La<V.count;La++){var Ra=V.na(La);if(Ra.Name===ja.a.accessToken){var pb=(new Date).getTime();if(Ra.Expiry>z.AFrameworkApplication.nk){var cb={};w.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",(cb.AccessTokenTtl=Ra.Expiry,cb.NowGetTime=pb,cb.BootTime=z.AFrameworkApplication.uha,
cb),"PreviousAccessTokenTtl",z.AFrameworkApplication.nk);z.AFrameworkApplication.accessToken=Ra.Value;z.AFrameworkApplication.nk=Math.floor(Ra.Expiry);z.AFrameworkApplication.V_d=pb;z.AFrameworkApplication.gYa=Math.floor(Ra.Expiry)}else cb={},w.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",(cb.AccessTokenTtl=Ra.Expiry,cb.NowGetTime=pb,cb.BootTime=z.AFrameworkApplication.uha,cb),"PreviousAccessTokenTtl",z.AFrameworkApplication.nk)}}return!0};
e.prototype.c6h=function(V){for(var La=!1,Ra=0;Ra<V.count;Ra++){La=!0;var pb=V.na(Ra);w.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",pb.Name,JSON.stringify(pb.Errors),this.vga)}return La};e.prototype.QOh=function(V){var La=H.a.Nvc;V=parseInt(V.Id);if(isNaN(V))La=H.a.$Yj;else{switch(V){case 401:La=H.a.cZj;break;case 403:La=H.a.YYj;break;case 500:La=H.a.ZYj;break;case 503:La=H.a.bZj}La===H.a.Nvc&&(La=500<V?H.a.aZj:H.a.XYj)}return La};Object(t.a)(e,"TokenRefreshManager",
null,[586]);d.prototype.Ihc=function(V){V=JSON.stringify(V);if(this.hTc&&0<this.hTc.length)for(var La=ik(this.hTc),Ra=La.next();!Ra.done;Ra=La.next())if(Ra=Ra.value,0<Ra.length&&0<=V.indexOf(Ra))return!0;return!1};d.prototype.oXh=function(V){try{if(V)for(var La=ik(V),Ra=La.next();!Ra.done;Ra=La.next()){var pb=Ra.value;if(pb.Errors)for(var cb=ik(pb.Errors),Sa=cb.next();!Sa.done;Sa=cb.next()){var Db=Sa.value;if(Db.Id in this.dfe)return Number.parseInvariant(this.dfe[Db.Id].toString())}}}catch(Ab){w.ULS.sendTraceTag(41501720,
217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",Ab.toString())}return this.ULd};d.prototype.Jtj=function(){var V={};try{if(!z.AFrameworkApplication.Ycc()||0>=z.AFrameworkApplication.Ycc().length||""===z.AFrameworkApplication.Ycc()[0])return V;for(var La=ik(z.AFrameworkApplication.Ycc()),Ra=La.next();!Ra.done;Ra=La.next()){var pb=Ra.value;0<pb.length&&(V[pb]=z.AFrameworkApplication.eZj)}}catch(cb){w.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",
cb.toString())}return V};Object(t.a)(d,"TokenRefreshPolicy",null,[582]);var Ha=y.a;$k(c,Ha);c.prototype.create=function(){z.AFrameworkApplication.gN("Microsoft.Office.Excel.Server.Flighting.IDenyListRefreshAccessTokenSilentlyV2_ManagerCreated");z.AFrameworkApplication.fa.qa("RefreshAccessTokenSilently")?this.pb(this.B7g()):this.pb(this.$.da.za(38)||this.$.da.Ga(38,new u(this.$)))};c.prototype.B7g=function(){var V=this.$.da.za(38);if(V)return V;V=new e(z.AFrameworkApplication.zi,z.AFrameworkApplication.iV(),
new d);return this.$.da.Ga(38,new n(this.$,V))};c.ka=function(V){V.da.Ga(39,new c(V))};Object(t.a)(c,"AccessTokenExpirationManagerFactory",y.a,[]);var Aa=b(10);b.d(E,"a",function(){return a})},1405:function(t,E,b){function a(){Type.registerNamespace("Common.App.AccessibilitySettings");c.main()}function c(){this.fb=null}function d(){this.dWa=null}function e(D){return String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",A.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||
"",D,A.AFrameworkApplication.Yi)}function h(D){var H=new u.a;A.AFrameworkApplication.nd.Zl(e(D),1,null,null,!0,2,function(F){200===F.data.httpStatus?H.setResult("true"===F.data.Rd.toLowerCase()):H.setResult(!1)},function(){H.setResult(!1)},null,void 0,void 0,void 0,void 0,"7");return H.task}function k(D,H){this.La=D;this.MQb=H}function n(D){var H=m.call(this,!1,!1,!0)||this;H.MQb=D;return H}t=b(0);var f=b(84),v=b(150),m=v.a;$k(n,m);n.prototype.start=function(){var D={},H={};D=(H.id="AccessibilitySettingsDialog",
H.bodyControls=(D.tooltipPersistenceEnabled=this.MQb.$8e,D),H);this.initializeAndShow("",Object(f.a)(this,this.Mij,"resultHandler"),D)};n.prototype.Mij=function(D,H){1===D&&(this.MQb.$8e=H.tooltipPersistenceEnabled)};Object(t.a)(n,"AccessibilitySettingsDialog",v.a,[]);var x=b(107),l=b(25);k.prototype.Ag=function(){this.La.Mb(l.a.iAj,x.a.frame,Object(f.a)(this,this.jAj,"showAccessibilitySettingsDialogHandler"))};k.prototype.jAj=function(){(new n(this.MQb)).start();return 32};Object(t.a)(k,"AccessibilitySettingsDialogActor",
null,[543]);var u=b(162),A=b(4),z=b(167);d.prototype.bui=function(){var D=this,H=new u.a;if(this.dWa)H.setResult(this.dWa);else if(this.Igf()){var F=h("getHoverableRibbonTooltipIsEnabled");F.continueWith(function(){D.dWa=F.result;z.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(F.result);H.setResult(F.result)},8)}else H.setResult(!1)};d.prototype.Igf=function(){var D=A.AFrameworkApplication.fa.qa("IsRoamingServiceEnabled"),H=A.AFrameworkApplication.fa.qa("IsAnonymousUser");
return D&&!H};of.Object.defineProperties(d.prototype,{$8e:{configurable:!0,enumerable:!0,get:function(){return!!this.dWa},set:function(D){D!==this.dWa&&(this.dWa=D,z.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(D),this.Igf()&&A.AFrameworkApplication.nd.Zl(e("saveHoverableRibbonTooltipIsEnabled"),2,D.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}}});Object(t.a)(d,"AccessibilitySettingsInfo",null,[542]);var y=b(258),w=b(172);
c.prototype.Sh=function(D){var H=this;this.fb=D;this.fb.register(d,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Dc(function(){return new d}).tc();this.fb.register(k,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Dc(function(){return new k(A.AFrameworkApplication.ub,H.fb.nh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))}).tc()};
c.prototype.init=function(){var D=this.fb.nh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),H=this.fb.nh("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");D&&H?(H.Ag(),D.bui()):w.a(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")};c.prototype.dispose=function(){};c.main=function(){y.a.instance.Qi(new c)};of.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,
get:function(){return"Common.App.AccessibilitySettings"}}});Object(t.a)(c,"AccessibilitySettingsPackage",null,[10,11]);b.d(E,"a",function(){return a})},1411:function(t,E,b){function a(){n.a.Fa(function(ma){ma.da.Ga(134,new c(ma));ma.da.Ga(330,new aa.a(ma))})}function c(ma){var Ea=ta.call(this)||this;Ea.tableManager=null;Ea.$=ma;Ea.Eb();return Ea}function d(ma){var Ea=ja.call(this,O.g(ma))||this;Ea.Spb=null;Ea.Izc=null;Ea.X0=null;Ea.Upb=null;Ea.kqe=!1;Ea.w$d=null;Ea.lSb=0;Ea.T5b=null;Ea.I0b=function(){var Ha=
{},Aa=Ea.cgd(),V;for(V in Aa){var La=Aa[V];if(La){var Ra=Ea.SZh(La);if(Ra){if(Ra in Ea.GFa){var pb=Ea.GFa[Ra];if(pb.gB){pb.Rl.equals(La)||(pb.Rl=La);delete Ea.GFa[Ra];Ha[Ra]=pb;continue}}(pb=k.createInstance(O.g(Ea.$),La,Ea.XIh(),Ea))?Ha[Ra]=pb:v.ULS.sendTraceTag(537151239,0,15,"TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range "+La.aB(!1))}}}Ea.K2b(null,null);Ea.QQb=Ha};Ea.K2b=function(){var Ha=Ea.GFa,Aa;for(Aa in Ha){var V=Aa,La=Ha[Aa];La&&(La.dispose(),delete Ea.GFa[V])}Ea.QQb=
{}};Ea.SLf=function(){Ea.K2b(null,null);Ea.I0b(null,null)};Ea.onFocus=function(){Ea.w$d=O.g(Ea.$).ha.sa.activeCell};Ea.m6=function(){Ea.$.isEditMode&&Ea.vh(null,null)};Ea.vh=function(){!Ea.kqe&&J.c(Ea.$,Ea.gridView.ha.sa.activeCell)&&Ea.mui()};Ea.VV=function(){Ea.xyb(1);Ea.$.ea.pn(Ea.VV)};Ea.SGb=function(){Ea.kqe=!0;Ea.Izc=new e(Ea.$)};Ea.$=ma;Ea.gridView=O.g(Ea.$);Ea.$.da.Ga(66,Ea);Ea.QQb={};Ea.I0b(null,null);Ea.$.xa&&Ea.$.xa.Mf(Ea.SLf);Ea.ioe(Ea.I0b);Ea.$.ea.B2(Ea.m6);Ea.gridView.ha.hJ(Ea.vh);Ea.$.isEditMode&&
Ea.vh(null,null);return Ea}function e(ma){var Ea=oa.call(this,document.createElement("div"))||this;Ea.CQ=!1;Ea.iGf=!1;Ea.Ind=!1;Ea.JTc=!1;Ea.AKb=null;Ea.vh=function(){J.c(Ea.$,Ea.gridView.ha.sa.activeCell)?(Ea.RLa=!0,Ea.xrb(!1)):(Ea.RLa=!1,Ea.Y4=!1,Ea.Acg())};Ea.$s=function(){Ea.RLa?Ea.xrb(!0):Ea.Y4=!1};Ea.bvf=function(){Ea.JTc=!0;Ea.RLa&&(Ea.Y4=!1)};Ea.onContentReady=function(){Ea.$.isEditMode?J.c(Ea.$,Ea.gridView.ha.sa.activeCell)&&(Ea.RLa=!0,Ea.xrb(!1)):Ea.Y4=!1};Ea.AEb=function(){Ea.JTc=!1;Ea.RLa?
Ea.xrb(!1):Ea.Y4=!1};Ea.ff=function(Ha,Aa){Ea.RLa&&(Ha=Ea.gridView.ypc(Aa.ed.block.ie.BlockCachePosition.PaneType).cG(Aa.ed.hash))&&(Ha.UJd(Ea.cLa),Ha.JVc(Ea.cLa))};Ea.cLa=function(){Ea.NRf()};Ea.$=ma;Ea.gridView=O.g(Ea.$);Ea.parentElement=Ea.domElement;Ea.parentElement.className=h.zth;Ea.NKa=Ea.gridView.Aj;Ea.RLa=!0;Ea.obi();Ea.qNg();Ea.xrb(!1);v.ULS.sendTraceTag(537151201,0,50,"TableTotalRowOptions - React Component Created ");return Ea}function h(){}function k(ma,Ea,Ha,Aa){var V=ya.call(this,ma)||
this;V.M8f=[6];V.G8f=[26];V.Cr=null;V.Kic=!1;V.Zzb=!1;V.hba=null;V.Rr=null;V.j5=!1;V.onPointerDown=function(La){if(1!==V.$.Ka.bH())return!0;La=ha.a(V.$).Sd(La);if(V.gB)return!0;var Ra=Z.a(V.$).Eod||Z.a(V.$).Lp();if(V.Cqd||Ra)return V.Rbb(),!0;V.Rr=V.Rl;V.AId();V.Sjd();Ra=2===La.nb&&La.Jn===Sys.UI.MouseButton.leftButton;var pb=3===La.nb;if(Ra||pb)La=V.ha.Ln(La.clientPoint,La.yb,5,void 0,void 0,!0),La||(La=V.Rr),V.Zzb=Ra,V.Kic=pb,V.Rr=V.J3e(La),V.Sjd(),Ra?V.Z9i():pb&&V.O$i(),ia.b(V.$,!0);return!0};
V.xh=function(La){La=ha.a(V.$).Sd(La);if(!V.gB)return!1;var Ra=V.Zzb?V.ha.Ln(La.clientPoint,La.yb,5,void 0,void 0,!0):V.ha.Ln(La.clientPoint,La.yb,5,!0,!1,!0);V.j5&&!Ra&&(Ra=V.ha.qob(La.clientPoint,La.yb,5));Ra&&(La=V.J3e(V.$Ya(Ra)),V.o1b(La.bottomRight),V.Rr.equals(La)||(V.Rr=La,V.uIb(!1),V.AId(!1),V.Sjd(!1),V.V7h(),V.qb.update(!1)),V.CSj(V.Rr));return!0};V.Ff=function(La){ha.a(V.$).Sd(La);if(!V.gB)return!1;V.resizeTable();V.Rbb();return!0};V.NFb=function(La){ha.a(V.$).Sd(La);if(!V.gB)return v.ULS.shipAssertTag(537151233,
0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),!1;V.resizeTable();V.Rbb();return!0};V.Fca=function(La){ha.a(V.$).Sd(La);V.Rbb();return!0};V.Yuf=function(){V.gB&&V.Rbb()};V.gridView=Ea;V.$=Ea.$;V.tableManager=Aa;V.ha=Ea.ha;V.qb=Ea.qb;V.parentElement=ma;V.$Sg();x.a.Wo||x.a.Ika||Q.a.instance.ra(U.a.pointerDown,V.hba,V.onPointerDown);V.Rl=Ha;V.Cqd=!1;V.KLc=!1;V.tableManager.mFg(V.Yuf);V.j5=K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NewTableResizeExperience",
!1);return V}var n=b(10);t=b(0);var f=b(235),v=b(15),m=b(87),x=b(27),l=b(445),u=b(1337),A=b(578),z=b(191),y=b(237),w=b(24),D=b(64),H=b(41),F=b(169),J=b(252),S=b(47),N=b(45),T=b(12),G=b(69),I=b(129),K=b(1),L=b(11),O=b(21),B=b(359),Q=b(249),U=b(13),X=b(161),P=b(94),ea=b(5),ia=b(260),da=b(76),xa=b(95),Z=b(43),ha=b(33),ya=P.a;$k(k,ya);k.prototype.dispose=function(){this.Rbb();this.tableManager.Rbj(this.Yuf);this.Jhf||x.a.Wo||x.a.Ika||Q.a.instance.Ba(U.a.pointerDown,this.hba,this.onPointerDown);if(this.gB){ia.b(this.$,
!1);try{this.tv()}catch(ma){v.ULS.sendTraceTag(537151236,0,10,"TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception "+ma)}}this.parentElement&&this.parentElement.contains(this.hba)&&this.parentElement.removeChild(this.hba);this.hba=this.parentElement=null;ya.prototype.dispose.call(this)};k.prototype.J3e=function(ma){var Ea=ma.bottom-this.Rl.topLeft.bottom-1;return 0<=ma.right-this.Rl.topLeft.right+1&&0<=Ea&&ma.bottom>=this.Rl.top&&ma.right>=this.Rl.left?new w.Range(this.Rl.top,
this.Rl.left,ma.bottom,ma.right,!1,!1):this.Rr};k.prototype.Sjd=function(ma){this.pwc([this.Rr],6,void 0===ma?!0:ma);this.qb.sn(this.M8f)};k.prototype.uIb=function(ma){ma=void 0===ma?!0:ma;this.qb.fh(this.M8f);this.pwc([null],6,ma)};k.prototype.AId=function(ma){ma=void 0===ma?!0:ma;this.qb.fh(this.G8f);this.pwc([null],26,ma)};k.prototype.V7h=function(){var ma=!1;ma=void 0===ma?!0:ma;var Ea=this.hJj();0<Ea.length&&(this.pwc(Ea,26,ma),this.qb.sn(this.G8f))};k.prototype.hJj=function(){var ma=[];this.Rl.contains(this.Rr)&&
(this.Rl.right!==this.Rr.right&&ma.push(new w.Range(this.Rl.top,this.Rr.right+1,this.Rr.bottom,this.Rl.right,!1,!1)),this.Rl.bottom!==this.Rr.bottom&&ma.push(new w.Range(this.Rr.bottom+1,this.Rl.left,this.Rl.bottom,this.Rl.right,!1,!1)));return ma};k.prototype.resizeTable=function(){if(!this.Rr.equals(this.Rl)){var ma=new w.Range(this.Rl.top,this.Rl.left,this.Rr.bottom,this.Rr.right,!1,!1);this.aOj(ma);this.Cqd=!0}};k.prototype.onKeyDown=function(ma){ha.a(this.$).Sd(ma);return!0};k.prototype.N9a=
function(){this.Jhf&&(x.a.Wo||x.a.Ika||(Q.a.instance.ra(U.a.pointerDown,this.hba,this.onPointerDown),this.hba.classList.remove("ewr-table-resize-default-cursor"),this.KLc=this.hba.disabled=!1),this.KLc=!1)};k.prototype.$Sg=function(){var ma=document.createElement("div");ma.className="ewr-table-resize-handle";var Ea=document.createElement("div");Ea.className="ewr-table-resize-fillhandle-higher";var Ha=document.createElement("div");Ha.className="ewr-table-resize-fillhandle-broader";ma.appendChild(Ea);
ma.appendChild(Ha);this.hba=ma;this.parentElement.appendChild(this.hba)};k.prototype.o1b=function(ma){var Ea=this,Ha=this.j5?2:5,Aa=60,V=this.Rr.contains(ma),La=ma.top,Ra=ma.bottom,pb=ma.left,cb=ma.right,Sa=null;if(V){if(this.gridView.UQ(this.Rl.topLeft)&&!this.Rl.Zna)return;this.j5?ma.bottom<this.Rr.bottom?(La=Math.max(1,Ra-Ha,this.Rl.top),Aa=16):(pb=Math.max(1,cb-Ha,this.Rl.left),Aa=4):(La=Math.max(1,Ra-Ha,this.Rl.top),pb=Math.max(1,cb-Ha,this.Rl.left));Ra=La;cb=pb;Sa=new w.Range(La,pb,La,pb,!1,
!1)}else this.j5?ma.right>=this.Rl.right?(cb+=Ha,Aa=8):ma.bottom>=this.Rl.bottom&&(Ra+=Ha,Aa=32):(Ra+=Ha,cb+=Ha),La=Ra,pb=cb,Sa=new w.Range(Ra,cb,Ra,cb,!1,!1),Aa=16;this.gridView.UQ(Sa)||(this.Cr?this.Cr.Mp||(this.Cr=S.a.instance.create(function(){Ea.gridView.er(Sa,Aa,xa.a.J8f)},40,N.a.K8f)):this.Cr=S.a.instance.create(function(){Ea.gridView.er(Sa,Aa,xa.a.J8f)},40,N.a.K8f))};k.prototype.$Ya=function(ma){var Ea=ma;if(this.gridView.eb.C4){if(!this.gridView.Ub(ma.topLeft)){var Ha=this.gridView.Xj("TableResizeBehavior.AdjustHiddenRowColumns",
this.gridView.YG,this.Rr.top!==ma.top?1:2);try{Ha.Wk=this.Rr.top<ma.top||this.Rr.left<ma.left,Ha.Xr(ma.topLeft),Ea=Ha.$$cu().range}finally{Ha&&Ha.dispose()}}Ea.right=Ea.left+ma.width-1;Ea.bottom=Ea.top+ma.height-1}return Ea};k.prototype.pwc=function(ma,Ea,Ha){Ha=void 0===Ha?!0:Ha;var Aa=[];ma=ik(ma);for(var V=ma.next();!V.done;V=ma.next())Aa.push(new B.a(V.value,D.d(this.$.pa)));this.qb.Iw(Aa,[Ea],!0,void 0,Ha)};k.prototype.Z9i=function(){this.j5&&Q.a.instance.ra(U.a.sj,document.documentElement,this.xh);
for(var ma=ik(this.gridView.hn),Ea=ma.next();!Ea.done;Ea=ma.next())Q.a.instance.ra(U.a.sj,Ea.value.domElement,this.xh);Q.a.instance.ra(U.a.Hf,document.documentElement,this.Ff);this.gIe()};k.prototype.O$i=function(){this.j5&&X.a.instance.ra(U.a.Vf,document.documentElement,this.xh);for(var ma=ik(this.gridView.hn),Ea=ma.next();!Ea.done;Ea=ma.next())X.a.instance.ra(U.a.Vf,Ea.value.domElement,this.xh);X.a.instance.ra(U.a.oe,document.documentElement,this.NFb);this.gIe()};k.prototype.tv=function(){this.Zzb&&
this.SQj();this.Kic&&this.cRj()};k.prototype.SQj=function(){this.j5&&Q.a.instance.Ba(U.a.sj,document.documentElement,this.xh);for(var ma=ik(this.gridView.hn),Ea=ma.next();!Ea.done;Ea=ma.next())Q.a.instance.Ba(U.a.sj,Ea.value.domElement,this.xh);Q.a.instance.Ba(U.a.Hf,document.documentElement,this.Ff);this.INf()};k.prototype.cRj=function(){this.j5&&X.a.instance.Ba(U.a.Vf,document.documentElement,this.xh);for(var ma=ik(this.gridView.hn),Ea=ma.next();!Ea.done;Ea=ma.next())X.a.instance.Ba(U.a.Vf,Ea.value.domElement,
this.xh);X.a.instance.Ba(U.a.oe,document.documentElement,this.NFb);this.INf()};k.prototype.gIe=function(){this.j5||Q.a.instance.ra(U.a.jy,document.documentElement,this.Fca);this.gridView.$b.e8b(!0)};k.prototype.INf=function(){this.j5||Q.a.instance.Ba(U.a.jy,document.documentElement,this.Fca);this.gridView.$b.e8b(!1)};k.prototype.aOj=function(ma){var Ea={};ma=(Ea.ResizeTableRange=ma,Ea.OriginalTableRange=this.Rl,Ea);this.$.Cd(-1400250766,da.a.Cb,30,ma)};k.prototype.CSj=function(ma){if(!this.Rl.contains(ma)){ma=
this.gJj();ma=ik(ma);for(var Ea=ma.next();!Ea.done;Ea=ma.next())if(this.tableManager.brd(Ea.value)){this.gridView.ig.wo(ea.a.UEi);return}}this.gridView.rtl?this.gridView.ig.wo(ea.a.YDi):this.gridView.ig.wo(ea.a.iGi)};k.prototype.Rbb=function(){if(this.gB){ia.b(this.$,!1);try{this.tv()}catch(ma){v.ULS.sendTraceTag(537151232,0,10,"TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception "+ma)}}this.Cr&&(this.Cr.cancel(),this.Cr.dispose());this.Kic=this.Zzb=!1;this.uIb();this.AId();
ia.b(this.$,!1);this.gridView.ig.wo(ea.a.x4)};k.prototype.gJj=function(){var ma=[];this.Rl.right!==this.Rr.right&&ma.push(new w.Range(this.Rl.top,this.Rl.right+1,this.Rr.bottom,this.Rr.right,!1,!1));this.Rl.bottom!==this.Rr.bottom&&ma.push(new w.Range(this.Rl.bottom+1,this.Rl.left,this.Rr.bottom,this.Rl.right,!1,!1));return ma};k.createInstance=function(ma,Ea,Ha,Aa){if(!Ea)return null;var V=ma.qb;V.Iw(Ha,[27],!0);V.sn(k.bJj);Ha=V.ew(27,ma.eb.dj(Ea.bottomRight),k.gOh(Ea,Ha)).mf;return new k(Ha,ma,
Ea,Aa)};k.gOh=function(ma,Ea){for(var Ha,Aa=0;Aa<Ea.length;Aa++)if((null===(Ha=Ea[Aa])||void 0===Ha?0:Ha.range)&&Ea[Aa].range.equals(ma))return Aa;return 0};of.Object.defineProperties(k.prototype,{gB:{configurable:!0,enumerable:!0,get:function(){return this.Zzb||this.Kic}},Jhf:{configurable:!0,enumerable:!0,get:function(){return this.KLc}}});k.bJj=[27];Object(t.a)(k,"TableResizeBehavior",P.a,[]);var va=b(7);P=b(248);h.zth="ewa-ttrd-buttonarea";Object(t.a)(h,"CssClassNames",null,[]);var bb=b(48),ba=
b(133),fa=b(91),ra=b(22),pa=b(14),Za=b(268),Ua=b(134),Ma=b(277),oa=P.a;$k(e,oa);e.prototype.dispose=function(){this.$&&this.sfh();this.$=this.gridView=this.parentElement=this.NKa=null;oa.prototype.dispose.call(this)};e.prototype.YLh=function(ma){var Ea=this.S_h(this.gridView.Ub(null).range);return Ea?"=SUBTOTAL("+ma+","+Ea+")":null};e.prototype.S_h=function(ma){var Ea=O.g(this.$).Ab.dk(ma);if(!Ea)return null;Ea=F.a(Ea,!1);Ea.right=Ea.left=ma.left;return Ea.toString()};e.prototype.obi=function(){e.$L=
{};e.$L["100"]=pa.a.instance.ga(1094);e.$L["101"]=pa.a.instance.ga(1097);e.$L["102"]=pa.a.instance.ga(1096);e.$L["103"]=pa.a.instance.ga(1101);e.$L["104"]=pa.a.instance.ga(1098);e.$L["105"]=pa.a.instance.ga(1099);e.$L["109"]=pa.a.instance.ga(1095);e.$L["107"]=pa.a.instance.ga(1102);e.$L["110"]=pa.a.instance.ga(1104);e.$L["111"]=pa.a.instance.ga(1155)};e.prototype.LXi=function(){var ma=this.gridView.Ub(null);if(ma&&(ma=ma.PE?ma.formulaBarText:null))if("=SUBTOTAL("===ma.substring(0,10)){if(ma=ma.substring(10,
13),ma in e.$L)return ma}else return"111";return"100"};e.prototype.qNg=function(){this.gridView.Ea.Hs(this.ff);this.gridView.ha.hJ(this.vh);this.gridView.Au(this.onContentReady);this.gridView.$b.Ak(this.bvf);this.gridView.$b.um(this.AEb)};e.prototype.sfh=function(){this.gridView&&(this.gridView.ha&&(this.gridView.ha.IK(this.vh),this.gridView.Ea.Eq(this.ff)),this.gridView.ny(this.onContentReady),this.gridView.$b&&(this.gridView.$b.vk(this.bvf),this.gridView.$b.Nl(this.AEb)),this.Acg())};e.prototype.xrb=
function(ma){this.NSj(ma);this.RAb&&(this.GHj(),this.Rmb?(this.iGf||this.BNg(),this.JTc?this.Y4=!1:(this.Y4=!0,this.NRf())):(v.ULS.sendTraceTag(537151199,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined"),this.Y4=!1))};e.prototype.NRf=function(){var ma=this;appChrome.renderTableTotalRowOptions(this.parentElement,e.$L,e.$L[this.LXi()].toString(),Math.round(ha.a(this.$).hi(17)),function(Ea){v.ULS.sendTraceTag(537151198,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : "+
Ea);var Ha={};Ha=(Ha.SelectedOption=e.$L[Ea],Ha.FunctionKeyCode=Ea,Ha.Location="canvas",Ha);Ua.b(ma.$).yd(ba.a.lJj,Ha,null,!0);if("111"===Ea)return ma.Pei(),!0;if("100"!==Ea){ma.AKb=ma.YLh(Ea);if(!ma.AKb)return v.ULS.sendTraceTag(537151197,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),!0;ma.yRa(ma.AKb)}else ma.yRa("");T.DOMElementExtensions.setFocus(ma.gridView.Wb.textBox.domElement);return!0})};e.prototype.Pei=function(){v.ULS.sendTraceTag(537151196,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");
var ma=new fa.a(753860909,0,this.$.isEditMode?2:1,19,null);this.$.Ka.Kb(ma)};e.prototype.sva=function(ma){if(!ma)return null;var Ea=this.gridView.$b.textBox.domElement;var Ha=0<T.DOMElementExtensions.getHeight(Ea)&&0<T.DOMElementExtensions.getWidth(Ea)&&0<=Ea.offsetTop&&0<=Ea.offsetLeft;if(Ha)Ea=T.DOMElementExtensions.sva(Ea,this.gridView.Aj);else{Ea=this.gridView.getCellBounds(ma.cell);var Aa=T.DOMElementExtensions.getBoundingClientRect(this.gridView.Aj);Ea=new Sys.UI.Bounds(Ea.x-Aa.x,Ea.y-Aa.y,
Ea.width,Ea.height)}if(Ea)if(Ha)2<Ea.height&&2<Ea.height&&(Ea.x+=1,Ea.y+=1,Ea.height-=2,Ea.width-=2);else if(Ha=O.g(this.$).OJ(ma.cell))Ha=Ha.width,Aa=ra.a.equals(Za.a.uvb(ma.cell,this.gridView.rtl),"right",!0),this.gridView.rtl&&Aa&&(Ea.x=Ea.x+Ea.width-Ha),ma.Ska&&this.gridView.rtl===Aa&&(Ea.width=Ha);else return null;return Ea};e.prototype.NSj=function(ma){var Ea=this.Rmb;if(Ea){var Ha=17>=Ea.height?Ea.y:Ea.y+Ea.height-17-2;Ea=this.vki?this.gridView.rtl?Ea.x:Ea.x+Ea.width-(17<Ea.height?17:Ea.height):
this.gridView.rtl?Ea.x-(17<Ea.height?17:Ea.height):Ea.x+Ea.width;var Aa=ha.a(this.$).Ija(new Sys.UI.Point(Ea,Ha));this.parentElement.style.top=L.HelperMethods.nc(Aa.y);this.parentElement.style.left=L.HelperMethods.nc(Aa.x);ha.a(this.$).ctj(this.parentElement);ma&&(this.Y4=this.gridView.Sic(new bb.a(Ea,Ha)))}else this.Y4=!1};e.prototype.BNg=function(){this.NKa.insertBefore(this.parentElement,this.NKa.firstChild);this.iGf=!0};e.prototype.GHj=function(){this.CQ||(this.gridView.view.Is(this.$s),this.CQ=
!0)};e.prototype.Acg=function(){this.CQ&&this.gridView.view&&(this.gridView.view.Gq(this.$s),this.CQ=!1)};e.prototype.yRa=function(ma){var Ea=this.gridView.Wb,Ha=this.gridView.Ub(null);Ha&&(ma=Object(va.a)(new Ma.a,{Text:ma}),this.gridView.setCell(ma,Ha.range,0,127,null),Ea.endEdit(!0,"TableTotalRowOptions.SetCellContent",0))};of.Object.defineProperties(e.prototype,{Y4:{configurable:!0,enumerable:!0,get:function(){return this.Ind},set:function(ma){this.Ind!==ma&&(this.Ind=this.isVisible=ma)}},RAb:{configurable:!0,
enumerable:!0,get:function(){return!!(this.$.Bd&16)}},vki:{configurable:!0,enumerable:!0,get:function(){var ma=this.gridView.ha.sa.activeCell;return ma.right===ma.maxColumns}},Rmb:{configurable:!0,enumerable:!0,get:function(){var ma=this.gridView.Ub(null);return ma&&this.gridView.o5(ma.range)?this.sva(ma):(ma&&v.ULS.sendTraceTag(537151200,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),null)}}});e.kJj="TableTotalRowDropDownIconButtonId";e.$L=null;Object(t.a)(e,
"TableTotalRowOptions",P.a,[6]);var ja=u.a;$k(d,ja);d.prototype.ioe=function(ma){this.addHandler(u.a.xGd,ma)};d.prototype.eRf=function(ma){this.removeHandler(u.a.xGd,ma)};d.prototype.mFg=function(ma){this.addHandler("tce",ma)};d.prototype.Rbj=function(ma){this.removeHandler("tce",ma)};d.prototype.brd=function(ma){return!!this.S0e(ma)};d.prototype.Wm=function(ma){return this.sWh(this.w1e(ma))};d.prototype.cvb=function(ma){return this.w1e(ma)};d.prototype.K$i=function(ma){ma?(this.Upb?this.Upb!==ma&&
(m.a.Ia(this.X0),this.X0=null,this.Upb=ma):this.Upb=ma,this.X0||(this.X0=I.a.instance.Td(this.Upb)),this.X0.Zm("focusin")||this.X0.ka("focusin",this.onFocus)):v.ULS.sendTraceTag(537151245,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement recieved")};d.prototype.Wdf=function(ma,Ea){return ma?ma.lba&&ma.top===Ea.top:(v.ULS.shipAssertTag(537151244,0,!!ma,"autofilterRange can't be null"),!1)};d.prototype.wva=function(ma){ma=this.Spb?H.I(ma,this.Spb):this.view.getRangeInformation(ma);
return 0<ma.length&&Object(l.a)(y.PivotTableRange,ma[0])?ma[0]:null};d.prototype.ehi=function(ma,Ea){return ma?!ma.Egc&&!!ma.nM&&ma.nM.xd(Ea):(v.ULS.shipAssertTag(537151243,0,!!ma,"Pivot table can't be null"),!1)};d.prototype.fni=function(ma,Ea){return ma?!ma.Egc&&!!ma.RW&&ma.RW.xd(Ea):(v.ULS.shipAssertTag(537151242,0,!!ma,"Pivot table can't be null"),!1)};d.prototype.yZb=function(ma){ja.prototype.yZb.call(this,ma);if((ma=L.HelperMethods.c1e(ma))&&0<ma.length){this.Spb=Array(ma.length);for(var Ea=
0;Ea<ma.length;Ea++)this.Spb[Ea]=z.a.sQ(ma[Ea])}};d.prototype.nIb=function(){ja.prototype.nIb.call(this);this.Spb=null};d.prototype.b5g=function(ma,Ea){return this.HCe(ma,Ea).returnValue};d.prototype.HCe=function(ma,Ea){var Ha=this;var Aa=!1;if(!ma||!Ea)return{returnValue:!1,zY:Aa};ma=ma.clone();ma.right+=1;ma.left=ma.right;if(!ma.isValidRange)return{returnValue:!1,zY:Aa};if(ma.top<Ea.eb.Hi){var V=ma.clone();V.bottom>=Ea.eb.Hi&&(V.bottom=Ea.eb.Hi-1);if(!function(){var Ra=Ha.GCe(V,Ea);Aa=Ra.zY;return Ra}().returnValue)return{returnValue:!1,
zY:Aa}}if(ma.bottom>=Ea.eb.Hi){var La=ma.clone();La.top<=Ea.eb.Hi&&(La.top=Ea.eb.Hi);if(!function(){var Ra=Ha.GCe(La,Ea);Aa=Ra.zY;return Ra}().returnValue)return{returnValue:!1,zY:Aa}}return{returnValue:!0,zY:Aa}};d.prototype.L8f=function(ma){(ma=this.Wm(ma.topLeft))&&ma.toString()in this.GFa&&(this.GFa[ma.toString()].Cqd=!1)};d.prototype.t4i=function(){this.raiseEvent("tce")};d.prototype.Jh=function(ma,Ea){if(!this.Izc)return!1;switch(Ea){case -569786022:case 541421805:if(this.Izc.Y4){var Ha=document.getElementById(e.kJj);
Ha&&S.a.instance.create(function(){T.DOMElementExtensions.zfc(Ha,null)},0,N.a.eJj,!0,!0)}return!0;default:return!1}};d.prototype.dispose=function(){this.K2b(null,null);this.eRf(this.I0b);this.$.xa.ug(this.SLf);this.$.Ol(this.K2b);this.QQb=null;this.$.ea&&this.$.ea.q0(this.m6);this.gridView.ha.IK(this.vh);this.Izc=null;K.EwaSettings.ma(409)&&this.X0&&(m.a.Ia(this.X0),this.X0=null);ja.prototype.dispose.call(this)};d.prototype.z5h=function(ma,Ea,Ha,Aa){var V=this.gridView.Ab.dk(new w.Range(Ea,Ha,Ea,
Ha,!1,!1));if(this.T5b=V){var La=V.usedRange,Ra=ma.ctrlKey||x.a.isMac&&G.b(ma),pb=!ma.shiftKey&&Ra;ma=ma.shiftKey&&!Ra;K.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&(O.g(this.$).ha.selectionType=3);switch(Aa){case 0:this.lSb=0;K.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(Ea=this.A4c(ma,La.top,Ha,La.bottom,Ha),this.CPd(Ea,pb,ma)):this.DPd(La.top,Ha,La.bottom,Ha,F.d(V),F.g(V),pb);break;case 1:this.lSb=1;K.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?
(Ea=this.A4c(ma,Ea,La.left,Ea,La.right),this.CPd(Ea,pb,ma)):this.DPd(Ea,La.left,Ea,La.right,!1,!1,pb);break;case 2:this.lSb=2;K.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(Ea=this.A4c(ma,La.top,La.left,La.bottom,La.right),this.CPd(Ea,pb,ma)):this.DPd(La.top,La.left,La.bottom,La.right,F.d(V),F.g(V),pb);break;default:v.ULS.shipAssertTag(537151240,0,!1,"TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: "+Aa.toString());return}K.EwaSettings.isChangeGateEnabled("OfficeVSO:5501896_TableSelectionDragSelection")&&
(O.g(this.$).ha.selectionType=3);v.ULS.sendTraceTag(527212953,0,50,"TableManager.handleTableSelectorsSelection: A table selector was clicked using hover arrows")}else v.ULS.shipAssertTag(537151241,0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null")};d.prototype.Hxj=function(ma){var Ea=this.T5b.usedRange;return this.fgf(ma)||1!==this.hIa&&this.fgf(new w.Range(Ea.top,ma.left,Ea.bottom,ma.right,!1,!1))?!0:!1};d.prototype.wGd=function(ma){return ma.Autofilters};
d.prototype.GCe=function(ma,Ea){var Ha=!1;var Aa=Ea.eb.dj(ma),V=Ea.Gf(Aa).Vg;if(!V)return v.ULS.sendTraceTag(537151238,0,15,"TableManager.CouldExpandImpl - loadedRange is null. PaneType="+Aa),{returnValue:!1,zY:Ha};if(!V.ze(ma))return{returnValue:!0,zY:Ha};ma=Ea.Xj("TableManager.CouldExpandImpl",ma,2);try{for(;ma.$$mn();){if(ma.$$cu().text||ma.zn.b7e)return Ha=!0,{returnValue:!1,zY:Ha};if(ma.$$cu().aF)return{returnValue:!1,zY:Ha}}}finally{ma&&ma.dispose()}return{returnValue:!0,zY:Ha}};d.prototype.sWh=
function(ma){if(!ma)return null;var Ea=new A.AutofilterRange(ma.top,ma.left,ma.bottom,ma.right,null,null,null,ma.id,ma.lba);Ea.Zna=ma.Zna;if(K.EwaSettings.isChangeGateEnabled("OfficeVSO:6424701_fixIssueWithTheGrippieButton")){var Ha=this.gridView.Ab.dk(ma,!0);if(!Ha)return null;for(var Aa=0,V=this.rangeList.length;Aa<V;Aa++){var La=this.rangeList[Aa],Ra=this.gridView.Ab.dk(La,!0);Ra&&Ra.name===Ha.name&&La!==ma&&this.jgf(La)&&(Ea.union(La),La.Zna&&(Ea.Zna=!0))}}else for(Ha=0,Aa=this.rangeList.length;Ha<
Aa;Ha++)V=this.rangeList[Ha],V.id===ma.id&&V!==ma&&this.jgf(V)&&(Ea.union(V),V.Zna&&(Ea.Zna=!0));return Ea};d.prototype.jgf=function(ma){return!!O.g(this.$).Ab.dk(ma)};d.prototype.XIh=function(){for(var ma=[],Ea=ik(this.rangeList),Ha=Ea.next();!Ha.done;Ha=Ea.next())Ha=new B.a(this.Wm(Ha.value.topLeft),D.d(this.$.pa)),ma.push(Ha);return ma};d.prototype.cgd=function(){for(var ma={},Ea=ik(this.rangeList),Ha=Ea.next();!Ha.done;Ha=Ea.next())if(Ha=Ha.value){var Aa=this.Wm(Ha.topLeft);Aa&&(ma[Aa.toString()]=
this.Wm(Ha.topLeft))}return ma};d.prototype.mui=function(){this.$.ea.Lg?this.xyb(0):this.$.ea.jl(this.VV)};d.prototype.xyb=function(ma){var Ea=this;this.$.bB(function(Ha){Ha.rja(ma).then(Ea.SGb)})};d.prototype.SZh=function(ma){var Ea=this.gridView.Ab.dk(ma);return Ea?Ea.name:ma.toString()};d.prototype.DPd=function(ma,Ea,Ha,Aa,V,La,Ra){var pb=ma+(V?1:0),cb=Ha-(La?1:0),Sa=this.gridView.inRangePicker||this.gridView.vi,Db=!1,Ab=new w.Range(pb,Ea,cb,Aa,!1,!1);if(V||La)for(V=Sa?B.a.Prb(this.gridView.ha.rangePicker.CK):
this.gridView.ha.sa.selectedRanges,V=ik(V),La=V.next();!La.done;La=V.next()){La=La.value;Db=this.Xqb(La,pb,Ea,cb,Aa);var Wb=this.Xqb(La,ma,Ea,Ha,Aa);if(Sa&&Db)break;if(!Sa&&(Db||Wb)){this.gridView.ha.updateSelection(La,La.topLeft,0,1);if(Ra&&Wb)return;break}}Db&&(Ab.top=ma,Ab.bottom=Ha);ma=Ab.topLeft;Ra?this.gridView.ha.updateSelection(Ab,ma,0,1):Sa?this.gridView.ha.Jw([Ab],0,ma,0):this.gridView.ha.updateSelection(Ab,ma,0,3)};d.prototype.CPd=function(ma,Ea,Ha){ma&&(Ha=Ha?O.g(this.$).ha.sa.activeCell:
ma.topLeft,Ea?this.gridView.ha.updateSelection(ma,Ha,0,1):this.gridView.ha.Jw([ma],0,Ha,0))};d.prototype.A4c=function(ma,Ea,Ha,Aa,V){var La=F.d(this.T5b),Ra=F.g(this.T5b),pb=Ea+(1!==this.hIa&&La?1:0),cb=Aa-(1!==this.hIa&&Ra?1:0),Sa=this.gridView.inRangePicker||this.gridView.vi;if(ma){var Db=K.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&Sa&&!B.a.Prb(this.gridView.ha.rangePicker.CK).length?new w.Range(pb,Ha,cb,V,!1,!1):Sa?this.gridView.ha.rangePicker.activeCell:this.gridView.ha.sa.activeCell;
Db=new w.Range(Db.top<pb?Db.top:pb,Db.left<Ha?Db.left:Ha,Db.bottom>cb?Db.bottom:cb,Db.right>V?Db.right:V,!1,!1)}else Db=new w.Range(pb,Ha,cb,V,!1,!1);if(1!==this.hIa&&(La||Ra)&&(!ma||ma&&this.Xqb(Db,pb,Ha,cb,V)))for(ma=Sa?B.a.Prb(this.gridView.ha.rangePicker.CK):this.gridView.ha.sa.selectedRanges,ma=ik(ma),La=ma.next();!La.done;La=ma.next())if(this.Xqb(La.value,pb,Ha,cb,V)){Db.top=Ea;Db.bottom=Aa;break}return Db};d.prototype.fgf=function(ma){var Ea=this.gridView.inRangePicker||this.gridView.vi?B.a.Prb(this.gridView.ha.rangePicker.CK):
this.gridView.ha.sa.selectedRanges;Ea=ik(Ea);for(var Ha=Ea.next();!Ha.done;Ha=Ea.next())if(this.Xqb(Ha.value,ma.top,ma.left,ma.bottom,ma.right))return!0;return!1};d.prototype.Xqb=function(ma,Ea,Ha,Aa,V){return!!ma&&ma.top===Ea&&ma.bottom===Aa&&ma.left===Ha&&ma.right===V};of.Object.defineProperties(d.prototype,{GFa:{configurable:!0,enumerable:!0,get:function(){return this.QQb}},qsd:{configurable:!0,enumerable:!0,get:function(){return this.w$d}},hIa:{configurable:!0,enumerable:!0,get:function(){return this.lSb}},
Fg:{configurable:!0,enumerable:!0,get:function(){var ma=O.g(this.$);return ma.Ab.dk(ma.ha.sa.activeCell,!1)}},dFd:{configurable:!0,enumerable:!0,get:function(){return this.qsd?O.g(this.$).Ab.dk(this.qsd,!1):null}}});Object(t.a)(d,"TableManager",u.a,[580,6]);var ta=f.a;$k(c,ta);c.prototype.create=function(){this.pb(this.tableManager||(this.tableManager=new d(this.$)))};Object(t.a)(c,"TableManagerFactory",f.a,[]);var aa=b(1427);b.d(E,"a",function(){return a})},1427:function(t,E,b){function a(Z){var ha=
xa.call(this)||this;ha.tableStyleManager=null;ha.$=Z;ha.Eb();return ha}function c(Z,ha,ya){var va=ia.call(this)||this;var bb={};va.D1i=(bb.height="100%",bb);va.fIb={};va.Rgd=0;va.$Ha=0;va.lastSyncTime=new Date;va.Mda=-1;va.PN=null;va.Bma={};va.iL=null;va.QF={};va.XSa={};va.Wrc=null;va.Xff=!1;va.isInitialized=!1;va.y6a=!1;va.NAb=!1;va.Xuc=null;va.SUe=!1;va.dNb=!1;va.ezc=!1;va.Xzh=function(){va.Bic()?va.$.ea.iJd(va.Xzh):va.GKa("tableStyleManagerInitialization")};va.gyf=function(ba,fa,ra){var pa=!1,
Za=L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1);if(K.a(ba))-315732528!==ba.Errors[0].MessageId&&(m.ULS.sendTraceTag(42821707,0,10,"TableStyleManager.OnGetTableStyleSuccess - Webservice call failed with Unexpected error : "+I.a.Cc(ba.Errors)),va.AAd(null,fa,ra));else if(m.ULS.sendTraceTag(537151202,0,50,"TableStyleManager.OnGetTableStyleSuccess - Webservice call Success"),(ba=ba.Result)&&ba.TableStyleItems.length){ra=60<ba.TableStyleItems.length;var Ua=!1,
Ma=!1;if(va.iL)for(var oa=0;60>oa;++oa){var ja=ba.TableStyleItems[oa],ta=va.iL.TableStyleItems[oa];if(Za&&ja.HasStyleViolations!==ta.HasStyleViolations){pa=Ma=!0;break}for(var aa=0;9>aa&&!(aa>=ja.TableStyleElementsList.length);aa++)if(!O.a.equals(ja.TableStyleElementsList[aa].BackgroundColor,ta.TableStyleElementsList[aa].BackgroundColor,!1)){pa=Ua=!0;break}}else for(va.$Ha=0,oa=ik(ba.TableStyleItems),ja=oa.next();!ja.done;ja=oa.next())ja=ja.value,ja.TableStyleElementsList&&ja.TableStyleElementsList.sort(e.wnf),
va.QF[ja.Name]=ja;if(Ua||Ma)for(Ua=0;60>Ua;++Ua)Ma=ba.TableStyleItems[Ua],va.QF[Ma.Name]=Ma;if(ra&&va.iL)for(m.ULS.sendTraceTag(42821700,0,50,"TableStyleManager.OnGetTableStyleSuccess, Number Custom Styles present - "+(ba.TableStyleItems.length-60)),pa=!0,ra=60;ra<ba.TableStyleItems.length;++ra)Ua=ba.TableStyleItems[ra],Ua.Name in va.QF||Ua.TableStyleElementsList&&Ua.TableStyleElementsList.sort(e.wnf),va.QF[Ua.Name]=Ua;if(ea.a(va.QF).length!==ba.TableStyleItems.length)for(pa=!0,Ua=ra=60;Ua<va.iL.TableStyleItems.length;)ra>=
ba.TableStyleItems.length?delete va.QF[va.iL.TableStyleItems[Ua].Name]:ra>=ba.TableStyleItems.length||!O.a.equals(ba.TableStyleItems[ra].Name,va.iL.TableStyleItems[Ua].Name,!1)?delete va.QF[va.iL.TableStyleItems[Ua].Name]:++ra,++Ua;va.iL=ba;va.eOf(pa);pa&&va.ZYc();Za&&fa&&("accessibility"===fa?(va.dNb=!1,va.ezc=!0):va.ezc=!1);va.Xff||(va.Doi()&&va.$.hf(),va.Xff=!0);va.Rgd=0;va.NAb||va.SUe?Za&&va.ezc&&va.raiseEvent("RefreshTableStyleGallery"):(va.raiseEvent("RefreshTableStyleGallery"),va.SUe=!0)}};
va.AAd=function(){m.ULS.sendTraceTag(42821712,0,10,"TableStyleManager.OnGetTableStyleFailed - Webservice call failed");va.Rgd++;5>va.Rgd&&S.a.instance.create(function(){va.GKa("getTableStylesFailed")},1E3,N.a.N8f,!0,!0)};va.PDf=function(){va.NAb&&(va.NAb=!1,va.Xuc&&va.Xuc(),S.a.instance.create(function(){va.GKa("galleryMenuClosed")},1E3,N.a.N8f,!0,!0))};va.$=Z;va.Va=ha;va.tableManager=ya;va.$.da.Ga(329,va);va.vZc=va.xvb();va.$.Ka.OYa(va.PDf);return va}function d(Z,ha,ya,va,bb,ba){this.headerRow=Z;
this.totalRow=ha;this.firstCol=ya;this.lastCol=va;this.NR=bb;this.Tha=ba}function e(){}function h(){}t=b(0);var k=b(235),n=b(50),f=b(37),v=b(7),m=b(15),x=b(113),l=b(1035),u=b(1673),A=b(946),z=b(1603),y=b(38),w=b(5),D=b(168),H=b(76),F=b(62),J=b(169),S=b(47),N=b(45),T=b(111);b(28);var G=b(202),I=b(31),K=b(299),L=b(1),O=b(22),B=b(14);b(29);Object(t.a)(h,"TableStyleElement",null,[]);var Q=b(972),U=b(220),X=b(88),P=b(598);e.wnf=function(Z,ha){return e.O8f[Z.Type]-e.O8f[ha.Type]};e.g4a=function(Z,ha){try{return appChrome.buildTableStyleGalleryIconNew(e.fBa,
e.moa,Z,ha)}catch(ya){return null}};e.Lhf=function(Z){return Z&&H.a.Mc in Z&&(Z=Z[H.a.Mc])?O.a.gL(Z,w.a.bHb):!1};e.ata=function(Z){var ha=[],ya=0;Z=ik(Z);for(var va=Z.next();!va.done;va=Z.next()){va=va.value;ha[ya]={};ha[ya].backgroundColor="white";ha[ya].color="black";for(var bb in va){var ba=va[bb];switch(bb){case "background-color":ha[ya].backgroundColor=ba;break;case "color":ha[ya].color=ba;break;case "font-size":ha[ya].fontSize=ba;break;case "border-bottom":ha[ya].borderBottom=ba;break;case "border-right":ha[ya].borderRight=
ba;break;case "border-left":ha[ya].borderLeft=ba;break;case "border-top":ha[ya].borderTop=ba}}ya++}return ha};e.s4b=function(Z,ha){var ya=[];if(null===Z||void 0===Z?0:Z.TableStyleElementsList)for(var va=0===Z.Category,bb=0;bb<e.moa;bb++)ya.push.apply(ya,kk(e.VMh(Z,ha,va,bb)));else{if(e.W5c)return e.W5c;Z={color:"black","background-color":"white"};for(ha=0;ha<e.moa;ha++)for(va=0;va<e.fBa;va++)ya.push(Z);e.W5c=ya}return ya};e.TZh=function(Z,ha){if(!Z.TableStyleElementsList)return"";var ya="";Z=ik(Z.TableStyleElementsList);
for(var va=Z.next();!va.done;va=Z.next())if(va=va.value,va.BackgroundColor&&"#000000"!==va.BackgroundColor)switch(va.Type){case 0:ya=va.BackgroundColor;break;case 5:case 7:if(ha.Tha||ha.NR)ya=va.BackgroundColor;break;case 3:case 4:if(ha.firstCol||ha.lastCol)ya=va.BackgroundColor;break;case 2:ha.totalRow&&(ya=va.BackgroundColor);break;case 1:ha.headerRow&&(ya=va.BackgroundColor)}return ya};e.t3b=function(Z){Z=new U.a(parseInt(String("0x"+Z.substr(1,2)),16),parseInt(String("0x"+Z.substr(3,2)),16),parseInt(String("0x"+
Z.substr(5,2)),16));return Q.a.sKa(Z)};e.g3e=function(Z,ha){if(!Z||!ha)return"";ha=(ha=e.TZh(Z,ha))?e.t3b(ha)+", ":B.a.instance.ga(2052)+", ";switch(Z.Index){case 0:return ha+B.a.instance.ga(1986);case 1:return ha+B.a.instance.ga(1987);case 2:return ha+B.a.instance.ga(1988);case 3:return ha+B.a.instance.ga(1989);case 4:return ha+B.a.instance.ga(1990);case 5:return ha+B.a.instance.ga(1991);case 6:return ha+B.a.instance.ga(1992);case 7:return ha+B.a.instance.ga(1993);case 8:return ha+B.a.instance.ga(1994);
case 9:return ha+B.a.instance.ga(1995);case 10:return ha+B.a.instance.ga(1996);case 11:return ha+B.a.instance.ga(1997);case 12:return ha+B.a.instance.ga(1998);case 13:return ha+B.a.instance.ga(1999);case 14:return ha+B.a.instance.ga(2E3);case 15:return ha+B.a.instance.ga(2001);case 16:return ha+B.a.instance.ga(2002);case 17:return ha+B.a.instance.ga(2003);case 18:return ha+B.a.instance.ga(2004);case 19:return ha+B.a.instance.ga(2005);case 20:return ha+B.a.instance.ga(2006);case 21:return ha+B.a.instance.ga(2007);
case 22:return ha+B.a.instance.ga(2008);case 23:return ha+B.a.instance.ga(2009);case 24:return ha+B.a.instance.ga(2010);case 25:return ha+B.a.instance.ga(2011);case 26:return ha+B.a.instance.ga(2012);case 27:return ha+B.a.instance.ga(2013);case 28:return ha+B.a.instance.ga(2014);case 29:return ha+B.a.instance.ga(2015);case 30:return ha+B.a.instance.ga(2016);case 31:return ha+B.a.instance.ga(2017);case 32:return ha+B.a.instance.ga(2018);case 33:return ha+B.a.instance.ga(2019);case 34:return ha+B.a.instance.ga(2020);
case 35:return ha+B.a.instance.ga(2021);case 36:return ha+B.a.instance.ga(2022);case 37:return ha+B.a.instance.ga(2023);case 38:return ha+B.a.instance.ga(2024);case 39:return ha+B.a.instance.ga(2025);case 40:return ha+B.a.instance.ga(2026);case 41:return ha+B.a.instance.ga(2027);case 42:return ha+B.a.instance.ga(2028);case 43:return ha+B.a.instance.ga(2029);case 44:return ha+B.a.instance.ga(2030);case 45:return ha+B.a.instance.ga(2031);case 46:return ha+B.a.instance.ga(2032);case 47:return ha+B.a.instance.ga(2033);
case 48:return ha+B.a.instance.ga(2034);case 49:return ha+B.a.instance.ga(2035);case 50:return ha+B.a.instance.ga(2036);case 51:return ha+B.a.instance.ga(2037);case 52:return ha+B.a.instance.ga(2038);case 53:return ha+B.a.instance.ga(2039);case 54:return ha+B.a.instance.ga(2040);case 55:return ha+B.a.instance.ga(2041);case 56:return ha+B.a.instance.ga(2042);case 57:return ha+B.a.instance.ga(2043);case 58:return ha+B.a.instance.ga(2044);case 59:return ha+B.a.instance.ga(2045);default:return Z.Name?
Z.Name:""}};e.WTh=function(Z){return(Z+1)%e.R8h};e.Ewb=function(Z,ha,ya){ya=void 0===ya?"":ya;return Z||!ya?e.p9e+", "+Z.Index.toString()+", -version, "+ha.toString():e.p9e+", "+ya+", -version, "+ha.toString()};e.VMh=function(Z,ha,ya,va){for(var bb=[],ba=0;ba<e.fBa;ba++)bb.push(e.Bdd(Z,ha,ya,va,ba));return bb};e.Bdd=function(Z,ha,ya,va,bb){var ba=Z.TableStyleElementsList;Z=new h;var fa={};if(!ba)return fa;for(var ra=ik(ba),pa=ra.next();!pa.done;pa=ra.next())if(pa=pa.value,0===pa.Type){Z=pa;break}ra=
!!Z.BackgroundColor;var Za="";!ya&&Z.TableStyleBorderFromatList&&0<Z.TableStyleBorderFromatList.length&&(Za=Z.TableStyleBorderFromatList[0].Color);fa["background-color"]=ra?Z.BackgroundColor:"#FFFFFF";Z.FontColor||(Z.FontColor="#000000");fa.color=Z.FontColor;e.Qxe(va,bb,fa,Z,Za,ya,ra);ba=ik(ba);for(pa=ba.next();!pa.done;pa=ba.next())(pa=pa.value)&&0!==pa.Type&&(2!==pa.Type||ra||(pa.BackgroundColor=Z.BackgroundColor),e.Uqd(pa,va,bb,ha)&&(pa.BackgroundColor&&(fa["background-color"]=pa.BackgroundColor),
fa.color=pa.FontColor||Z.FontColor,e.Qxe(va,bb,fa,pa,Za,ya,ra)));return fa};e.eV=function(Z,ha,ya,va,bb,ba){ya&&(ya.Color&&!ya.Style&&(ya.Style=1),ya.Style&&!ya.Color&&(ya.Color=bb?"#000000":va?va:ba?"#FFFFFF":"#000000"),ha[e.borders[Z]]="1px "+e.MV[ya.Style]+" "+ya.Color)};e.Uqd=function(Z,ha,ya,va){return-1===Z.Type?!1:e.Vqd(Z,ha,ya,va)||e.noi(Z,ha,ya,va)||e.Wqd(Z,ha,ya,va)};e.noi=function(Z,ha,ya,va){return!ha&&va.headerRow||ha===e.moa-1&&va.totalRow?!1:1===ha%2&&5===Z.Type&&va.NR&&va.headerRow||
1<ha&&!!((ha-1)%(Z.BandSize+1))&&6===Z.Type&&va.NR&&va.headerRow||!(ha%2)&&5===Z.Type&&va.NR&&!va.headerRow||!!(ha%(Z.BandSize+1))&&6===Z.Type&&va.NR&&!va.headerRow||!(ya%2)&&7===Z.Type&&va.Tha||!!(ya%(Z.BandSize+1))&&8===Z.Type&&va.Tha};e.Wqd=function(Z,ha,ya,va){return ha===e.moa-1&&2===Z.Type&&va.totalRow||ya===e.fBa-1&&ha===e.moa-1&&12===Z.Type&&va.totalRow&&va.lastCol||!ya&&ha===e.moa-1&&11===Z.Type&&va.totalRow&&va.firstCol||ya===e.fBa-1&&4===Z.Type&&va.lastCol};e.Vqd=function(Z,ha,ya,va){return!ha&&
1===Z.Type&&va.headerRow||!ya&&3===Z.Type&&va.firstCol||!ya&&!ha&&9===Z.Type&&va.headerRow&&va.firstCol||ya===e.fBa-1&&!ha&&10===Z.Type&&va.headerRow&&va.lastCol};e.Qxe=function(Z,ha,ya,va,bb,ba,fa){if(va.TableStyleBorderFromatList)for(var ra=ik(va.TableStyleBorderFromatList),pa=ra.next();!pa.done;pa=ra.next())if(pa=pa.value,pa.Style)switch(pa.Position){case 0:Z&&12!==va.Type&&11!==va.Type&&2!==va.Type&&5!==va.Type&&6!==va.Type||e.eV(0,ya,pa,bb,ba,fa);break;case 1:Z!==e.moa-1&&1!==va.Type&&10!==va.Type&&
9!==va.Type&&5!==va.Type&&6!==va.Type||e.eV(1,ya,pa,bb,ba,fa);break;case 2:ha&&12!==va.Type&&10!==va.Type&&7!==va.Type&&8!==va.Type&&4!==va.Type||e.eV(2,ya,pa,bb,ba,fa);break;case 3:ha!==e.fBa-1&&9!==va.Type&&11!==va.Type&&3!==va.Type&&7!==va.Type&&8!==va.Type||e.eV(3,ya,pa,bb,ba,fa);break;case 5:ha!==e.fBa-1&&3!==va.Type&&4!==va.Type&&7!==va.Type&&8!==va.Type&&e.eV(3,ya,pa,bb,ba,fa);break;case 6:Z!==e.moa-1&&2!==va.Type&&1!==va.Type&&5!==va.Type&&6!==va.Type&&e.eV(1,ya,pa,bb,ba,fa)}};e.WZh=function(){var Z=
Array(12);Z[0]=0;Z[7]=1;Z[8]=2;Z[5]=3;Z[6]=4;Z[4]=5;Z[3]=6;Z[1]=7;Z[2]=8;Z[9]=9;Z[10]=10;Z[11]=11;Z[12]=13;return Z};e.moa=5;e.fBa=5;e.R8h=5;e.p9e="TableStyleIcon";e.MV=[null,X.a.solid,X.a.dashed,X.a.dotted,X.a.dashed,X.a.dotted,X.a.dashed,X.a.double];e.borders=[P.a.borderTop,P.a.borderBottom,P.a.borderLeft,P.a.borderRight];e.O8f=e.WZh();e.W5c=null;Object(t.a)(e,"TableStyleHelper",null,[]);d.prototype.equals=function(Z){return Z?this.headerRow===Z.headerRow&&this.totalRow===Z.totalRow&&this.firstCol===
Z.firstCol&&this.lastCol===Z.lastCol&&this.Tha===Z.Tha&&this.NR===Z.NR:!1};Object(t.a)(d,"TableStyleOptions",null,[]);var ea=b(1013),ia=y.a;$k(c,ia);c.prototype.r6e=function(Z){var ha=this.tableManager.Fg;if(!ha)return!1;Z=Z[H.a.Mc];if(!Z)return!1;switch(Number.parseInvariant(Z)){case 0:return J.d(ha);case 1:return J.c(ha);case 2:return J.g(ha);case 3:return J.e(ha);case 4:return J.f(ha);case 5:return J.b(ha);case 6:return ha.hasAutoFilter}return!1};c.prototype.JHf=function(Z,ha){if(x.a.isEmpty(this.QF))return!0;
if("PopulateTableMoreStylesMenu"!==Z&&"PopulateTableAccessibleStylesMenu"!==Z)return!1;if(L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)&&"PopulateTableAccessibleStylesMenu"===Z&&!this.ezc)return this.dNb||(this.dNb=!0,this.GKa("accessibilityTab")),!0;this.NAb=!0;var ya=this.Va.kq("TableStylesMenu"),va=this.Va.nC("Ribbon.TableTools.TableStyles.Gallery.Custom",7,"Size48by48"),bb=this.Va.nC("Ribbon.TableTools.TableStyles.Gallery.Dark",7,"Size48by48"),ba=this.Va.nC("Ribbon.TableTools.TableStyles.Gallery.Medium",
7,"Size48by48"),fa=this.Va.nC("Ribbon.TableTools.TableStyles.Gallery.Light",7,"Size48by48"),ra=-123538519;if(ha.MenuId)if(O.a.contains(ha.MenuId,"FormatAsTable",!0))ra=753331043,this.y6a=!0;else{var pa=B.a.instance.ga(1985);var Za=e.Ewb(null,1,"-1");L.EwaSettings.isChangeGateEnabled("OfficeVSO:4185429_NonNullIconNameForSLRGalleryItem")?fa.Dt("-1",ra,"QueryTableStyle",0,"-1",Za,void 0,void 0,pa):fa.Dt("-1",ra,"QueryTableStyle",0,"-1",void 0,void 0,void 0,pa);this.y6a=!1}Za=0;var Ua=this.QF,Ma;for(Ma in Ua){var oa=
Ua[Ma];if(!L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)||"PopulateTableAccessibleStylesMenu"!==Z||!oa.HasStyleViolations){pa=e.g3e(oa,this.xvb());var ja=e.Ewb(oa,this.$Ha);if(oa)switch(oa.Category){case 0:va.Dt(oa.Index.toString(),ra,"QueryTableStyle",0,oa.Index.toString(),ja,void 0,void 0,pa);Za++;break;case 3:bb.Dt(oa.Index.toString(),ra,"QueryTableStyle",0,oa.Index.toString(),ja,void 0,void 0,pa);break;case 2:ba.Dt(oa.Index.toString(),ra,"QueryTableStyle",
0,oa.Index.toString(),ja,void 0,void 0,pa);break;case 1:fa.Dt(oa.Index.toString(),ra,"QueryTableStyle",0,oa.Index.toString(),ja,void 0,void 0,pa)}}}0<Za&&this.z2(ya,va,1953);this.z2(ya,fa,1954);this.z2(ya,ba,1955);this.z2(ya,bb,1956);ha.MenuItems=ya.bE();this.isInitialized||(this.isInitialized=!0);return!0};c.prototype.Iid=function(Z){var ha=this;Z[l.a.On]=!1;var ya=Z[H.a.Mc];if(ya&&!x.a.isEmpty(this.QF)){O.a.contains(Z.ParentMenuId,"FormatAsTable",!0)?this.y6a=!0:this.y6a=!1;this.y6a||this.ldg();
e.Lhf(Z)&&(ya=this.Qvb(ya).toString());var va=this.xvb();Z[l.a.Alt]="-1"===ya?B.a.instance.ga(1985):e.g3e(this.Qgd(ya),va);if(ya in this.XSa&&va.equals(this.vZc))this.LHf(Z,ya,va,!0);else{if(!this.Wrc||this.Wrc&&!this.Wrc.Mp)this.Bma={},this.Wrc=S.a.instance.create(function(){ha.eOf();ha.vZc=ha.xvb()},0,N.a.jJj,!0,!0);this.YDd(va,Z,ya)}}};c.prototype.getTableStyleIndexFromName=function(Z){if(!Z||x.a.isEmpty(this.QF))return-1;if(Z in this.QF)return this.QF[Z].Index;this.GKa("getTableStyleIndexFromName");
return-1};c.prototype.Bic=function(){return!!this.iL};c.prototype.Qvb=function(Z){this.PN||this.ZYc();return Z in this.PN?this.PN[Z]:-1};c.prototype.GKa=function(Z){if(this.$.isEditMode)if(L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)){var ha=new Date;if(30<T.getElapsedSeconds(this.lastSyncTime,ha)||x.a.isEmpty(this.QF)||this.dNb){var ya=this.$.oa.va.Pb();this.lastSyncTime=ha;Z=this.dNb&&"accessibilityTab"===Z||"galleryMenuClosed"===Z;F.n(this.$.oa.va,Z,this.gyf,
this.AAd,null,Z?"accessibility":"normal",ya)}}else if(ya=new Date,30<T.getElapsedSeconds(this.lastSyncTime,ya)||x.a.isEmpty(this.QF))Z=this.$.oa.va.Pb(),this.lastSyncTime=ya,F.m(this.$.oa.va,this.gyf,this.AAd,null,null,Z)};c.prototype.dispose=function(){this.PN=this.XSa=this.iL=this.QF=null;this.$.Ka.QIb(this.PDf);ia.prototype.dispose.call(this)};c.prototype.THg=function(Z){this.addHandler("RefreshTableStyleGallery",Z)};c.prototype.Vdj=function(Z){this.removeHandler("RefreshTableStyleGallery",Z)};
c.prototype.ZYc=function(){var Z={};this.tableManager.Fg&&(this.Mda=this.getTableStyleIndexFromName(this.tableManager.Fg.Hzc));for(var ha=1;7>=ha;ha++)Z["preview"+ha]=this.ZSh(ha);this.PN=Z};c.prototype.ZSh=function(Z){var ha=this.iL.TableStyleItems.length;ha=4>=this.Mda?this.Mda+Z-1:4<this.Mda&&this.Mda<ha-4?4===Z?this.Mda:Math.floor(this.Mda+Z-4):this.Mda+Z-1;-1===ha||ha.toString()in this.XSa||(ha=Z-3);return ha};c.prototype.ldg=function(){if(this.tableManager.Fg){var Z=!1,ha=this.getTableStyleIndexFromName(this.tableManager.Fg.Hzc);
if(ha!==this.Mda){if(this.PN){var ya=this.PN,va;for(va in ya)ya[va]===ha&&(Z=!0)}this.Mda=ha;Z||x.a.isEmpty(this.XSa)||this.ZYc()}}};c.prototype.z2=function(Z,ha,ya){var va=this.Va.Bc();va.Fp="Thin";va.title=B.a.instance.ga(ya);va.buttons.push(ha);Z.pc.push(va)};c.prototype.xvb=function(){var Z=this.tableManager.Fg;return this.y6a||!Z?new d(!0,!1,!1,!1,!0,!1):new d(J.d(Z),J.g(Z),J.c(Z),J.e(Z),J.f(Z),J.b(Z))};c.prototype.eOf=function(Z){Z=void 0===Z?!1:Z;var ha={},ya={},va=this.xvb();if(!x.a.isEmpty(this.QF)&&
(this.tableManager.Fg&&this.ldg(),!va.equals(this.vZc)||Z||x.a.isEmpty(this.XSa))){this.$Ha=e.WTh(this.$Ha);Z=this.QF;for(var bb in Z){var ba=Z[bb],fa=e.Ewb(ba,this.$Ha);ha[ba.Index.toString()]=e.g4a(e.ata(e.s4b(ba,va)),fa);ya[fa]=ha[ba.Index.toString()];this.eIb(ya)}bb=e.Ewb(null,this.$Ha,"-1");ha["-1"]=e.g4a(e.ata(e.s4b(null,va)),bb);ya[bb]=ha["-1"];this.eIb(ya);G.c(this.XSa,ha,!1)}};c.prototype.Doi=function(){var Z=D.a(this.$);return Z?Z.Ql.xB===w.a.Dza:!1};c.prototype.YDd=function(Z,ha,ya){Number.parseInvariant(ya);
"-1"===ya&&O.a.contains(ha.ParentMenuId,"FormatAsTable",!0)||this.LHf(ha,ya,Z,!1)};c.prototype.LHf=function(Z,ha,ya,va){var bb=e.Ewb(null,this.$Ha,ha);e.Lhf(Z)?(bb in this.Bma?ya=this.Bma[bb]:(ya=e.ata(e.s4b(this.Qgd(ha),ya)),this.Bma[bb]=ya),Z[l.a.GalleryButtonProps]=Object(v.a)(new u.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:bb,Alt:Z[l.a.Alt],MenuItemId:ha,TableCellStyles:ya,TableStyles:this.D1i})):(Z[A.a.Icon]=bb,Z[l.a.GalleryButtonProps]=Object(v.a)(new z.a,{Command:"-123538519",
QueryCommand:"QueryTableStyle",Id:bb,Alt:Z[l.a.Alt],MenuItemId:ha}),va||(va=[],this.Qgd(ha),"-1"===ha||O.a.contains(Z.ParentMenuId,"FormatAsTable",!0)||(va=e.s4b(this.iL.TableStyleItems[Number.parseInvariant(ha)],ya)),this.XSa[ha]=e.g4a(e.ata(va),bb)))};c.prototype.eIb=function(Z){var ha=this;if(this.NAb)this.Xuc=function(){ha.eIb(Z)};else{this.Xuc=null;var ya=[],va;for(va in Z){var bb=va;bb in this.fIb?ya.push(bb):this.fIb[bb]=!0}try{0<ya.length&&appChrome.api.unregisterIcons(ya),x.a.isEmpty(Z)||
appChrome.api.registerIconProvider(function(){return Z})}catch(ba){}}};c.prototype.Qgd=function(Z){Z=Number.parseInvariant(Z);if(-1===Z||!this.iL)return null;if(60<Z)for(var ha=60;ha<this.iL.TableStyleItems.length;++ha){var ya=this.iL.TableStyleItems[ha];if(ya.Index===Z)return ya}return this.iL.TableStyleItems[Z]};Object(t.a)(c,"TableStyleManager",y.a,[519,6]);var da=b(58);b.d(E,"a",function(){return a});var xa=k.a;$k(a,xa);a.prototype.create=function(){var Z=this,ha=n.GetServiceTaskFactory.create(this.$.da,
102,this.la,this.hb),ya=n.GetServiceTaskFactory.Ra(this.$.da,66,134,this.hb);f.TaskExtensions.Aa(da.Task.uL(ha,ya),function(){Z.pb(Z.tableStyleManager||(Z.tableStyleManager=new c(Z.$,ha.result,ya.result)))},this.$.la,8)};Object(t.a)(a,"TableStyleManagerFactory",k.a,[])},1444:function(t,E,b){function a(){B.a.Fa(c.ka)}function c(Q){var U=O.call(this)||this;U.$=Q;U.Eb();return U}function d(Q){var U=e.call(this,document.documentElement,Q)||this;U.OB=0;U.TOg=[f.a.vCe,f.a.nyd,f.a.Vdc,f.a.rWd,f.a.GJb,f.a.aZc,
f.a.Lbd,f.a.O4e,f.a.iYc,f.a.Ozc,f.a.MDj,f.a.Nwb,f.a.q_c,f.a.BJa,f.a.GQd,f.a.y_c,f.a.M6f,f.a.alf,f.a.EYc];U.HXj=[f.a.Vdc,f.a.mgg,f.a.lgg,f.a.ngg];U.T1i=[f.a.Vdc,f.a.lJf,f.a.mJf,f.a.pJf];U.TWg=[f.a.bVe,f.a.N4e,f.a.Jbd,f.a.Gbd];U.u1i=[f.a.vCe,f.a.nyd,f.a.aZc,f.a.Lbd,f.a.iYc,f.a.Ozc,f.a.Nwb,f.a.q_c,f.a.BJa,f.a.GQd,f.a.IIf,f.a.y_c,f.a.EYc];U.E1i=[f.a.Nwb,f.a.hVe];var X=L.a.instance.Xa(252);U.Prj=U.$.shortcutKeyManager.nKa(X);U.mode=0;Q.da.Ga(15,U);H.TaskExtensions.Aa(D.GetServiceTaskFactory.Ra(Q.da,21,
137,1),function(P){P=P.result;P.Tn(n.a.Emb);P.Ml(n.a.Emb,U.BJb)},Q.la);return U}function e(Q,U){var X=G.call(this,Q)||this;X.dT=[];X.s$d=null;X.BJb=function(P){var ea="forward";P.Values[v.a.direction]?ea=P.Values[v.a.direction].toLowerCase():k.ULS.sendTraceTag(537166664,0,15,"Didn't find direction in message values");P=0;var ia=!0;"backward"===ea?(P=X.nsd.length-1,ia=!1):"forward"===ea?(P=0,ia=!0):k.ULS.sendTraceTag(537166663,0,15,"Received unknown direction to resume focus: "+ea);X.$qf(ia,P,!1)};
X.izf=function(){X.dT=[]};X.JOa=function(P){if(-411645385===X.$.shortcutKeyManager.Us(P,!0)&&X.Aef()){var ea={};X.$.Ka.Kb(new F.a(-411645385,1,X.$.Jc,6,null),(ea.event=P,ea),P);P.stopPropagation()}};X.XOi=function(P){X.ema(P)};X.ib=U;X.qp=T.g(X.ib);X.zc.ka("keydown",X.XOi);X.zc.ka("keyup",X.JOa);A.a(U).eIg(X.izf);y.a(U.ya,27)&&H.TaskExtensions.Aa(D.GetServiceTaskFactory.Ra(U.da,21,137,1),function(P){P=P.result;P.Tn(n.a.F8e);P.Ml(n.a.F8e,X.BJb)},U.la);return X}t=b(0);var h=b(235),k=b(15),n=b(170),
f=b(257),v=b(396),m=b(4),x=b(750),l=b(89),u=b(94),A=b(274),z=b(168),y=b(78),w=b(399),D=b(50),H=b(37),F=b(91),J=b(69),S=b(1),N=b(646),T=b(21),G=u.a;$k(e,G);e.prototype.dispose=function(){this.$&&A.a(this.$).iej(this.izf);this.ib=null;this.dT.length=0;G.prototype.dispose.call(this)};e.prototype.s2i=function(Q){this.ema(Q)};e.prototype.$qf=function(Q,U,X,P){P=void 0===P?null:P;var ea=this.zIj(Q,U,void 0===X?!0:X,P);if(!ea){X=U;var ia=Q?1:-1,da=this.nsd;do{ea=!1;if(y.a(this.$.ya,27)){if(X+=ia,X>=da.length||
0>X)ea=!0}else X=(X+ia+da.length)%da.length;if(ea){this.gyi(Q,U,P);break}else if(ea=this.t8f(Q,U,X,!1,P))break}while(X!==U)}};e.prototype.zIj=function(Q,U,X,P){P=void 0===P?null:P;var ea=null;0<=U&&(ea=this.dT[U]);return(null===ea||void 0===ea?0:ea.canReceiveFocus)&&ea.Uf(Q,void 0===X?!0:X)?(P&&J.g(P),k.ULS.sendTraceTag(537166669,0,50,"Switched focus inside current section "+ea.Yd+" into a sub region"),ea.ej(),!0):!1};e.prototype.t8f=function(Q,U,X,P,ea){ea=void 0===ea?null:ea;X=this.dT[X];if(S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",
!1)){var ia=A.a(this.ib).cB(f.a.BJa),da=A.a(this.ib).cB(f.a.Nwb),xa=this.qp.ha.Oa.e_;if(X===da&&xa||X===ia&&!P&&!xa)return!1}if((null===X||void 0===X?0:X.canReceiveFocus)&&X.Uf(Q,!1)){ea&&J.g(ea);X.ej();if(Q=this.dT[U])Q.Dj(),k.ULS.sendTraceTag(537166668,0,50,"Switched focus from section "+Q.Yd+" to "+X.Yd);return!0}return!1};e.prototype.gyi=function(Q,U,X){(X=void 0===X?null:X)&&J.g(X);if(U=this.dT[U])U.Dj(),k.ULS.sendTraceTag(537166666,0,50,"Lost focus from section "+U.Yd);H.TaskExtensions.Aa(D.GetServiceTaskFactory.Ra(this.$.da,
21,137,0),function(P){var ea={};P.result.wj(n.a.Emb,(ea[v.a.direction]=Q?"forward":"backward",ea))},this.$.la)};e.prototype.ema=function(Q){var U=this.$.isEditMode?z.a(this.$):null;if(!this.$.ob.Vwa||e.Xji(U))if(117===Q.keyCode&&(Q.ctrlKey||J.b(Q))){U=this.d2e(Q.target);var X=!Q.shiftKey;k.ULS.sendTraceTag(537166662,0,50,"AccessibilityManager.OnKeyDownHandler: Ctrl+F6 loop. The root index section is: "+U);if(S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)){var P=
A.a(this.ib).cB(f.a.GJb);P=this.dT.indexOf(P);m.AFrameworkApplication.ta.Qa.jw&&this.$.v5&&-1!==P&&U===P&&1===this.$.Odb&&x.ShyRibbon.nJ(1,0)}else m.AFrameworkApplication.ta.Qa.jw&&this.$.v5&&1===U&&1===this.$.Odb&&x.ShyRibbon.nJ(1,0);this.$qf(X,U,!0,Q)}else 117!==Q.keyCode||e.cSe?-411645385===this.$.shortcutKeyManager.Us(Q)?this.Aef()&&(U={},this.$.Ka.Kb(new F.a(-411645385,1,this.$.Jc,6,null),(U.event=Q,U),Q),Q.stopPropagation()):1588554917===this.$.shortcutKeyManager.Us(Q)?0===this.mode?(N.a(this.$)||
(U={},this.$.Ka.Kb(new F.a(1588554917,1,this.$.Jc,6,null),(U.event=Q,U),Q)),Q.preventDefault(),Q.stopPropagation()):3===this.mode&&(Q.preventDefault(),Q.stopPropagation()):S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)&&1058684758===this.$.shortcutKeyManager.Us(Q)?(U=this.d2e(Q.target),P=A.a(this.ib).cB(f.a.GJb),X=A.a(this.ib).cB(f.a.BJa),P=this.dT.indexOf(P),X=this.dT.indexOf(X),m.AFrameworkApplication.ta.Qa.jw&&this.$.v5&&-1!==P&&U===P&&1===this.$.Odb&&x.ShyRibbon.nJ(1,
0),-1!==X&&U!==X&&this.t8f(!0,U,X,!0,Q)):this.G3h(Q):(Q=w.a.pA.notificationBar.X$(l.a.bPh(),!1),Q.image=0,w.a.pA.notificationBar.QD(Q),e.cSe=!0)};e.prototype.d2e=function(Q){for(var U=this.nsd,X=0,P=U.length;X<P;++X){var ea=U[X];if(ea&&ea.ah(Q))return X}return-1};e.prototype.u_e=function(){for(var Q=[],U=0,X=this.uxa.length;U<X;U++){var P=A.a(this.$).cB(this.uxa[U]);P&&Q.push(P)}return Q};e.prototype.Aef=function(){return 0===this.mode||4===this.mode};e.Xji=function(Q){return Q?Q.inKeytipMode:!1};
of.Object.defineProperties(e.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.ib}},nsd:{configurable:!0,enumerable:!0,get:function(){this.dT.length||(this.dT=this.u_e());return this.dT}},uxa:{configurable:!0,enumerable:!0,get:function(){return this.s$d},set:function(Q){this.s$d=Q;this.dT=this.u_e()}}});e.cSe=!1;Object(t.a)(e,"AccessibilityManager",u.a,[632,6]);var I=b(155),K=b(22),L=b(14);$k(d,e);d.prototype.ema=function(Q){this.$.Bd&65536&&e.prototype.ema.call(this,Q)};d.prototype.G3h=
function(Q){if(K.a.equals(this.Prj,this.$.shortcutKeyManager.Fed(Q),!1)){var U=I.b(this.$);if(null===U||void 0===U?0:U.canReceiveFocus)J.g(Q),U.Uf(!0,!1)}};of.Object.defineProperties(d.prototype,{mode:{configurable:!0,enumerable:!0,get:function(){return this.OB},set:function(Q){this.OB=Q;switch(Q){case 0:this.uxa=this.TOg;break;case 2:this.uxa=this.HXj;break;case 3:this.uxa=this.T1i;break;case 4:this.uxa=this.TWg;break;case 5:this.uxa=this.u1i;break;case 6:this.uxa=this.E1i;break;default:k.ULS.shipAssertTag(537170759,
0,!0,"Accessibility Mode value is not in allowed values")}}}});Object(t.a)(d,"EwaAccessibilityManager",e,[]);var O=h.a;$k(c,O);c.prototype.create=function(){this.pb(this.$.da.za(15)||new d(this.$))};c.ka=function(Q){Q.da.Ga(157,new c(Q))};Object(t.a)(c,"AccessibilityManagerFactory",h.a,[]);var B=b(10);b.d(E,"a",function(){return a})},1445:function(t,E,b){function a(){h.a.Fa(c.ka)}function c(D){var H=w.call(this)||this;H.$=D;H.Eb();return H}function d(D){var H=this;this.sg=function(){H.flf();H.$.ea.pn(H.sg)};
this.$=D;this.s8f={};this.VUd={};var F=m.EwaSettings.isChangeGateEnabled("OfficeVSO:4431502_UseCommonIconSpriteInEwa")?"excelInitialAppSprite":"excelAppSprite",J=this.b_e(F);J?(this.Ame(J),this.$.ea.Lg?this.flf():D.ea.jl(this.sg),this.$.da.Ga(388,this)):k.ULS.sendTraceTag(537151263,0,15,"window["+F+"].icons returned null.")}function e(){}var h=b(10);t=b(0);var k=b(15),n=b(235),f=b(37),v=b(53),m=b(1),x=b(308),l=b(227);e.yOe="ewa-svg-icon";Object(t.a)(e,"CssClassNames",null,[]);var u=b(50),A=b(12),
z=b(330),y=b(207);d.prototype.dispose=function(){this.VUd=null;this.$.ea.pn(this.sg)};d.prototype.Cva=function(D,H,F,J){F=void 0===F?null:F;J=void 0===J?null:J;var S;(S=this.VUd[D])||(this.VUd[D]=S=this.mYi(this.s8f[D]));if(!S)return k.ULS.shipAssertTag(537151262,0,!1,"SvgIconProvider.GetSvgElement: id "+D+" was not found in loaded SVG sprites."),null;var N=S.cloneNode(!0);if(!N.style){var T=z.b(S),G=z.b(N),I={};I.iconId=D;I.isOriginalNodeStyleNull=void 0===S.style||null===S.style;I.isOriginalNodeCurrentStyleNull=
void 0===S.currentStyle||null===S.currentStyle;I.isClonedNodeCurrentStyleNull=void 0===N.currentStyle||null===N.currentStyle;I.originalNode=T.substring(0,T.indexOf(">")+1);I.clonedNode=G.substring(0,G.indexOf(">")+1);k.ULS.sendTraceTag(537151261,0,10,"SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: "+JSON.stringify(I))}N.setAttribute("style","height: "+H+"px; width: "+H+"px;");J&&(D=document.createElement("title"),D.innerHTML=J,N.insertBefore(D,N.childNodes[0]));if(F)for(F=
ik(F),J=F.next();!J.done;J=F.next())Sys.UI.DomElement.addCssClass(N,J.value);return N};d.prototype.vba=function(D,H,F,J,S,N,T,G){S=void 0===S?0:S;N=void 0===N?0:N;T=void 0===T?null:T;G=void 0===G?null:G;S&&N||(N=A.DOMElementExtensions.getBoundingClientRect(J),S=N.height,N=N.width);if(T=this.Cva(D,H,T,G))J.appendChild(T),(J=A.DOMElementExtensions.vZ(T,"style",null))?T.setAttribute("style",J+(" margin: "+(S-H)/2+"px "+(N-F)/2+"px;")):k.ULS.sendTraceTag(537151260,0,10,'SvgIconProvider.InsertAndCenterSvgElement: svgElement\'s GetAttribte("styl") returned null. Icon ID: '+
D);return T};d.prototype.flf=function(){var D=this;f.TaskExtensions.Aa(u.GetServiceTaskFactory.Ra(this.$.da,283,284,0),function(H){H=y.c(H.result.vn.loadScript("excel-uiSlice20-sprite"));f.TaskExtensions.Aa(H,function(){var F=D.b_e("excelUiSlice20Sprite");F?D.Ame(F):k.ULS.sendTraceTag(537151259,0,15,"window[excelUiSlice20Sprite].icons returned null.")},D.$.la,3)},this.$.da.la,3)};d.prototype.Ame=function(D){D=ik(D);for(var H=D.next();!H.done;H=D.next())H=H.value,H.type===l.a.TUd&&(this.s8f[H.id]=
H)};d.prototype.mYi=function(D){if(!D)return null;var H=D.viewBox;D=D.children;var F=document.createElementNS(x.a.WUd,l.a.TUd);Sys.UI.DomElement.addCssClass(F,e.yOe);F.setAttribute("focusable","false");F.setAttribute("viewBox",H);this.mEg(F,D);return F};d.prototype.mEg=function(D,H){H=ik(H);for(var F=H.next();!F.done;F=H.next()){F=F.value;var J=document.createElementNS(x.a.WUd,F.type),S;for(S in F){var N=S,T=F[S];"className"===N?J.setAttribute("class",T):J.setAttribute(N,T)}D.appendChild(J)}};d.prototype.b_e=
function(D){return(D=window[D])?D.icons:null};Object(t.a)(d,"SvgIconProvider",null,[500,6]);var w=n.a;$k(c,w);c.prototype.create=function(){var D=this;f.TaskExtensions.Aa(v.a.aR([127],4,this.hb,void 0,void 0,void 0,387),function(){var H=m.EwaSettings.isChangeGateEnabled("OfficeVSO:4431502_UseCommonIconSpriteInEwa")?"excelInitialAppSprite":"excelAppSprite";window[H]?D.pb(D.$.da.za(388)||new d(D.$)):k.ULS.sendTraceTag(537151258,0,50,"window.["+H+"] returned null.")},this.la,3)};c.ka=function(D){D.da.Ga(387,
new c(D))};Object(t.a)(c,"SvgIconProviderFactory",n.a,[]);b.d(E,"a",function(){return a})},1466:function(t,E,b){function a(){e.a.Fa(c.ka)}function c(m){var x=v.call(this)||this;x.sparklineManager=null;x.$=m;x.Eb();return x}function d(m,x){m=f.call(this,m)||this;x.Ga(240,m);return m}var e=b(10);t=b(0);var h=b(235),k=b(21),n=b(1337),f=n.a;$k(d,f);d.prototype.$Yh=function(m){for(var x=ik(this.rangeList),l=x.next();!l.done;l=x.next())if(l=l.value,m.range.contains(l))return l;return null};d.prototype.wGd=
function(m){return m.GridBlockModel&&(m=gridRenderer.CanvasRendererFactoryGlobal.getModelAccessor(m.GridBlockModel))?m.getSparklineRanges():null};Object(t.a)(d,"SparklineManager",n.a,[587]);var v=h.a;$k(c,v);c.prototype.create=function(){this.pb(this.sparklineManager||(this.sparklineManager=new d(k.g(this.$),this.$.da)))};c.ka=function(m){m.da.Ga(239,new c(m))};Object(t.a)(c,"SparklineManagerFactory",h.a,[]);b.d(E,"a",function(){return a})},1492:function(t,E,b){function a(){k.a.nl.Ga(141,new c)}function c(){return h.call(this)||
this}t=b(0);var d=b(149),e=b(704),h=e.a;$k(c,h);c.prototype.dispose=function(){d.WacAirSpace.Amd()&&d.WacAirSpace.sAc()};c.prototype.animate=function(n,f,v,m,x){f&&d.WacAirSpace.ZK(n.element,f);d.WacAirSpace.animate(n,m,x);v&&d.WacAirSpace.qaj(n.element,v)};Object(t.a)(c,"AnimationManager",e.a,[6]);var k=b(102);b.d(E,"a",function(){return a})},1663:function(t,E,b){function a(K){var L=S.call(this)||this;L.$=K;L.Eb();return L}function c(K){var L=J.call(this)||this;L.ftd=null;L.$=K;A.ULS.sendTraceTag(537155201,
0,50,"NewAndOpenCoreManager created");return L}b.r(E);t=b(1405);E=b(1370);var d=b(1333),e=b(1334),h=b(1335),k=b(1338);b(1336);var n=b(1444),f=b(1492),v=b(10),m=b(0),x=b(235),l=b(192),u=b(624),A=b(15),z=b(1029),y=b(575),w=b(83),D=b(4),H=b(79),F=b(1124),J=H.a;$k(c,J);c.prototype.Wij=function(){var K=new l.a,L=y.a.Kq(w.a.instance.Tb("Common.IEventEmitter<Common.IMruResult>")),O=new u.a(function(){return L.result});this.ftd=new u.a(function(){return new z.a(O.value,null)});if(!this.ftd)return K;var B=
this.ftd.value.HZ("NewAndOpenCoreManager",!1);if(!B||3!==B.state||!B.Xwd)return B?A.ULS.sendTraceTag(544289226,0,50,"NewAndOpenCoreManager.RetrieveMruFiles - the mruResult state: "+B.state+", mruResult MruDocuments is null: "+!B.Xwd):A.ULS.sendTraceTag(544289227,0,50,"NewAndOpenCoreManager.RetrieveMruFiles: the mruResult is null"),null;B=B.Xwd;for(var Q=["xlsx","xlsb","xlsm"],U=0;U<B.length;U++){var X=B[U];if(!(0>Array.indexOf(Q,X.extension))){var P=X.title+"."+X.extension,ea=F.b(X,D.AFrameworkApplication.isRtl);
X=X.url;if(P&&ea&&X){var ia={};K.add((ia[c.fileName]=P,ia[c.friendlyPath]=ea,ia[c.section]="mru",ia[c.absoluteUrl]=X,ia))}else X||A.ULS.sendTraceTag(537155200,0,50,"ChangeSourceDialog.GetMruFiles: the DAV url of the file is null")}}return K};c.prototype.dispose=function(){J.prototype.dispose.call(this)};c.fileName="FileName";c.friendlyPath="FriendlyPath";c.section="Section";c.absoluteUrl="AbsoluteUrl";Object(m.a)(c,"NewAndOpenCoreManager",H.a,[596,6]);var S=x.a;$k(a,S);a.prototype.create=function(){this.pb(this.$.da.za(451)||
this.$.da.Ga(451,new c(this.$)))};a.ka=function(K){K.da.Ga(164,new a(K))};Object(m.a)(a,"NewAndOpenCoreFactory",x.a,[]);m=b(1367);x=b(1466);H=b(1445);var N=b(1411),T=b(1368),G=b(1358),I=b(1377);b=b(1351);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.GridHighlightsBehavior");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SheetTabBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SvgIconProvider");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Table");
Type.registerNamespace("_Ewa");Object(t.a)();Type.registerNamespace("Common.App.AltTextDialog");Object(E.a)();Object(d.a)();Object(e.a)();Object(h.a)();Object(n.a)();v.a.Fa(a.ka);Object(f.a)();Object(m.a)();Object(x.a)();Object(H.a)();Object(k.a)();Object(N.a)();Object(T.a)();Object(G.a)();Type.registerNamespace("Common.App.SessionExpiration");Object(I.a)();Object(b.a)()}}]);

//# sourceMappingURL=EwaDS.acc.js.map